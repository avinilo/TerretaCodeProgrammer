const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-C8U1dKiA.js","assets/index-BDu9a_vH.js","assets/index-bAaw0M8q.js","assets/index-iVHMzJ5-.js","assets/components-Bw8-jeb5.js","assets/stripIndent-BntaON4O.js","assets/index-BRPR2os5.js","assets/index-90D1X0VZ.js","assets/index-tGDBFCLz.js","assets/index-CPtbUIOt.js","assets/index-DEbcG5AI.js","assets/index-BkqrjoNf.js","assets/index-BtKtWAlO.js","assets/angular-html-GqBVQ6Dm.js","assets/html-DG1TtFnM.js","assets/javascript-DNgb01dh.js","assets/css-u4bm_LMz.js","assets/angular-ts-MKs4dlu_.js","assets/scss-BfMQ58X7.js","assets/apl-C6GBNg32.js","assets/xml-BOQ9RtXF.js","assets/java-BN40hmum.js","assets/json-DWmkr0yC.js","assets/astro-DTSlZd1t.js","assets/typescript-CVESyXxo.js","assets/postcss-DmF4-xLG.js","assets/blade-CPEzV-UE.js","assets/sql-D8nBeWSR.js","assets/bsl-Dgyn0ogV.js","assets/sdbl-BLhTXw86.js","assets/cobol-NX_YbRMJ.js","assets/coffee-CXcjgkhu.js","assets/cpp-IRqjNdQP.js","assets/regexp-DoiKbUTj.js","assets/glsl-bwZ1_LLM.js","assets/c-BhsLqr-4.js","assets/crystal-DFEzbmK1.js","assets/shellscript-HNM5thJl.js","assets/edge-Cq_6DOij.js","assets/html-derivative-CDVwFiY1.js","assets/elixir-BoNJ9vXU.js","assets/elm-CTr_twwF.js","assets/erb-DuefeV9w.js","assets/ruby-C8Yez0Ov.js","assets/lua-B2--UKVN.js","assets/fortran-fixed-form-C9lV_GL-.js","assets/fortran-free-form-B3Z_eaxm.js","assets/fsharp-Vw5t3P44.js","assets/markdown-CNXuF1yM.js","assets/gdresource-D_y5yz_M.js","assets/gdshader-BSHf-0eb.js","assets/gdscript-BIguuW30.js","assets/git-commit-C0WNX4K0.js","assets/diff-Dnfm4U7b.js","assets/git-rebase-3YLVFLpI.js","assets/glimmer-js-D4fdoRWd.js","assets/glimmer-ts-DFoQQgBS.js","assets/graphql-DqgCZ2sd.js","assets/jsx-CM4fc1WH.js","assets/tsx-DqpEK-75.js","assets/hack-BV5LM4CS.js","assets/haml-B1jT_oKV.js","assets/handlebars-HtVeTy3a.js","assets/yaml-CIiI48o2.js","assets/http-CYnz8shJ.js","assets/hxml-BfFmssGd.js","assets/haxe-BgqZeg96.js","assets/imba-C6vdFTm2.js","assets/jinja-BORjBBXU.js","assets/jison-Ct8rtT8R.js","assets/julia-Czdw582_.js","assets/python-CK56Z9cH.js","assets/r-Cqv5JV-q.js","assets/latex-BpoAco4y.js","assets/tex-Dej6pUpk.js","assets/liquid-0snwLfvK.js","assets/marko-BxSrAFJn.js","assets/less-Dk1rBueR.js","assets/mdc-DfEMzj3F.js","assets/nginx-Dw0nYz9L.js","assets/nim-NHYZZDnF.js","assets/perl-DLffUHFU.js","assets/php-D3VTUn6x.js","assets/pug-BbGfWiEl.js","assets/qml-Dhho_E4W.js","assets/razor-CDyaIOPG.js","assets/csharp-D7v6OrNy.js","assets/rst-BtGMdPX_.js","assets/cmake-DbXoA79R.js","assets/sas-K_Wwm3IX.js","assets/shaderlab-CsYUIUcf.js","assets/hlsl-DkpUthgY.js","assets/shellsession-DU_2P5ZA.js","assets/soy-aWhPD8Nq.js","assets/sparql-B5YtT9lV.js","assets/turtle-C0hdQUNN.js","assets/stata-bRt97scT.js","assets/svelte-DK3KTNg_.js","assets/templ-CP2hJ0oK.js","assets/go-Cv7ZOjGq.js","assets/ts-tags-CiO5kd_m.js","assets/twig-DN6YEzOP.js","assets/vue-xldAUJov.js","assets/vue-html-x3hEOujm.js","assets/xsl-BqG2VzO2.js"])))=>i.map(i=>d[i]);
import{r as I,j as T,w as at,x as wT,o as E3,y as hq,z as rs,A as hn,B as x3,C as dq,u as S3,D as fq,q as pq,F as mq}from"./components-Bw8-jeb5.js";import{a as vr,u as wt,t as w0,b as gq,m as rc,c as Fn,d as ET,l as ft,e as Ke,s as _q,r as Xu}from"./stripIndent-BntaON4O.js";const yq=5,mm=6,gm=10;let bq=(t,e,r,n)=>(t.events=t.events||{},t.events[r+gm]||(t.events[r+gm]=n(s=>{t.events[r].reduceRight((i,o)=>(o(i),i),{shared:{},...s})})),t.events[r]=t.events[r]||[],t.events[r].push(e),()=>{let s=t.events[r],i=s.indexOf(e);s.splice(i,1),s.length||(delete t.events[r],t.events[r+gm](),delete t.events[r+gm])}),vq=1e3,wq=(t,e)=>bq(t,n=>{let s=e(n);s&&t.events[mm].push(s)},yq,n=>{let s=t.listen;t.listen=(...o)=>(!t.lc&&!t.active&&(t.active=!0,n()),s(...o));let i=t.off;return t.events[mm]=[],t.off=()=>{i(),setTimeout(()=>{if(t.active&&!t.lc){t.active=!1;for(let o of t.events[mm])o();t.events[mm]=[]}},vq)},()=>{t.listen=s,t.off=i}}),Eq=(t,e,r)=>{Array.isArray(t)||(t=[t]);let n,s=0,i=()=>{let l=t.map(c=>c.get());if(n===void 0||l.some((c,u)=>c!==n[u])){let c=++s;n=l;let u=e(...l);u&&u.then&&u.t?u.then(h=>{c===s&&o.set(h)}):o.set(u)}},o=vr(void 0,Math.max(...t.map(l=>l.l))+1),a=i;return wq(o,()=>{let l=t.map(c=>c.listen(a,-1/o.l));return i(),()=>{for(let c of l)c()}}),o},xT=(t,e)=>Eq(t,e);function xq(){return()=>{}}function Sq(){return I.useSyncExternalStore(xq,()=>!0,()=>!1)}function Ji({children:t,fallback:e=null}){return Sq()?I.createElement(I.Fragment,null,t()):I.createElement(I.Fragment,null,e)}function Tq(t){if(typeof Proxy>"u")return t;const e=new Map,r=(...n)=>t(...n);return new Proxy(r,{get:(n,s)=>s==="create"?t:(e.has(s)||e.set(s,t(s)),e.get(s))})}function Ay(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const W1=t=>Array.isArray(t);function T3(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Wd(t){return typeof t=="string"||Array.isArray(t)}function c2(t){const e=[{},{}];return t?.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function ST(t,e,r,n){if(typeof e=="function"){const[s,i]=c2(n);e=e(r!==void 0?r:t.custom,s,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,i]=c2(n);e=e(r!==void 0?r:t.custom,s,i)}return e}function Ry(t,e,r){const n=t.getProps();return ST(n,e,r!==void 0?r:n.custom,t)}const TT=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],CT=["initial",...TT],bp=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],nc=new Set(bp),Pi=t=>t*1e3,Oi=t=>t/1e3,Cq={type:"spring",stiffness:500,damping:25,restSpeed:10},kq=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Aq={type:"keyframes",duration:.8},Rq={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Iq=(t,{keyframes:e})=>e.length>2?Aq:nc.has(t)?t.startsWith("scale")?kq(e[1]):Cq:Rq;function kT(t,e){return t?t[e]||t.default||t:void 0}const Pq={skipAnimations:!1,useManualTiming:!1},Oq=t=>t!==null;function Iy(t,{repeat:e,repeatType:r="loop"},n){const s=t.filter(Oq),i=e&&r!=="loop"&&e%2===1?0:s.length-1;return!i||n===void 0?s[i]:n}const Jr=t=>t;function Dq(t){let e=new Set,r=new Set,n=!1,s=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function a(c){i.has(c)&&(l.schedule(c),t()),c(o)}const l={schedule:(c,u=!1,h=!1)=>{const f=h&&n?e:r;return u&&i.add(c),f.has(c)||f.add(c),c},cancel:c=>{r.delete(c),i.delete(c)},process:c=>{if(o=c,n){s=!0;return}n=!0,[e,r]=[r,e],r.clear(),e.forEach(a),n=!1,s&&(s=!1,l.process(c))}};return l}const _m=["read","resolveKeyframes","update","preRender","render","postRender"],Lq=40;function C3(t,e){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>r=!0,o=_m.reduce((p,y)=>(p[y]=Dq(i),p),{}),{read:a,resolveKeyframes:l,update:c,preRender:u,render:h,postRender:d}=o,f=()=>{const p=performance.now();r=!1,s.delta=n?1e3/60:Math.max(Math.min(p-s.timestamp,Lq),1),s.timestamp=p,s.isProcessing=!0,a.process(s),l.process(s),c.process(s),u.process(s),h.process(s),d.process(s),s.isProcessing=!1,r&&e&&(n=!1,t(f))},g=()=>{r=!0,n=!0,s.isProcessing||t(f)};return{schedule:_m.reduce((p,y)=>{const b=o[y];return p[y]=(v,w=!1,E=!1)=>(r||g(),b.schedule(v,w,E)),p},{}),cancel:p=>{for(let y=0;y<_m.length;y++)o[_m[y]].cancel(p)},state:s,steps:o}}const{schedule:Mt,cancel:wa,state:Nr,steps:cv}=C3(typeof requestAnimationFrame<"u"?requestAnimationFrame:Jr,!0),k3=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,Nq=1e-7,Mq=12;function Bq(t,e,r,n,s){let i,o,a=0;do o=e+(r-e)/2,i=k3(o,n,s)-t,i>0?r=o:e=o;while(Math.abs(i)>Nq&&++a<Mq);return o}function sc(t,e,r,n){if(t===e&&r===n)return Jr;const s=i=>Bq(i,0,1,t,r);return i=>i===0||i===1?i:k3(s(i),e,n)}const A3=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,R3=t=>e=>1-t(1-e),I3=sc(.33,1.53,.69,.99),AT=R3(I3),P3=A3(AT),O3=t=>(t*=2)<1?.5*AT(t):.5*(2-Math.pow(2,-10*(t-1))),RT=t=>1-Math.sin(Math.acos(t)),D3=R3(RT),L3=A3(RT),N3=t=>/^0[^.\s]+$/u.test(t);function Fq(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||N3(t):!0}let E0=Jr;const M3=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t),B3=t=>e=>typeof e=="string"&&e.startsWith(t),F3=B3("--"),jq=B3("var(--"),IT=t=>jq(t)?Uq.test(t.split("/*")[0].trim()):!1,Uq=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,$q=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Hq(t){const e=$q.exec(t);if(!e)return[,];const[,r,n,s]=e;return[`--${r??n}`,s]}function j3(t,e,r=1){const[n,s]=Hq(t);if(!n)return;const i=window.getComputedStyle(e).getPropertyValue(n);if(i){const o=i.trim();return M3(o)?parseFloat(o):o}return IT(s)?j3(s,e,r+1):s}const wo=(t,e,r)=>r>e?e:r<t?t:r,Zu={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},qd={...Zu,transform:t=>wo(0,1,t)},ym={...Zu,default:1},vp=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Ho=vp("deg"),Di=vp("%"),tt=vp("px"),zq=vp("vh"),Vq=vp("vw"),u2={...Di,parse:t=>Di.parse(t)/100,transform:t=>Di.transform(t*100)},Gq=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),h2=t=>t===Zu||t===tt,d2=(t,e)=>parseFloat(t.split(", ")[e]),f2=(t,e)=>(r,{transform:n})=>{if(n==="none"||!n)return 0;const s=n.match(/^matrix3d\((.+)\)$/u);if(s)return d2(s[1],e);{const i=n.match(/^matrix\((.+)\)$/u);return i?d2(i[1],t):0}},Wq=new Set(["x","y","z"]),qq=bp.filter(t=>!Wq.has(t));function Kq(t){const e=[];return qq.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const _u={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:f2(4,13),y:f2(5,14)};_u.translateX=_u.x;_u.translateY=_u.y;const U3=t=>e=>e.test(t),Yq={test:t=>t==="auto",parse:t=>t},$3=[Zu,tt,Di,Ho,Vq,zq,Yq],p2=t=>$3.find(U3(t)),xl=new Set;let q1=!1,K1=!1;function H3(){if(K1){const t=Array.from(xl).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const s=Kq(n);s.length&&(r.set(n,s),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([i,o])=>{var a;(a=n.getValue(i))===null||a===void 0||a.set(o)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}K1=!1,q1=!1,xl.forEach(t=>t.complete()),xl.clear()}function z3(){xl.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(K1=!0)})}function Xq(){z3(),H3()}class PT{constructor(e,r,n,s,i,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=s,this.element=i,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(xl.add(this),q1||(q1=!0,Mt.read(z3),Mt.resolveKeyframes(H3))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:s}=this;for(let i=0;i<e.length;i++)if(e[i]===null)if(i===0){const o=s?.get(),a=e[e.length-1];if(o!==void 0)e[0]=o;else if(n&&r){const l=n.readValue(r,a);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=a),s&&o===void 0&&s.set(e[0])}else e[i]=e[i-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),xl.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,xl.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const pd=t=>Math.round(t*1e5)/1e5,OT=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function Zq(t){return t==null}const Jq=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,DT=(t,e)=>r=>!!(typeof r=="string"&&Jq.test(r)&&r.startsWith(t)||e&&!Zq(r)&&Object.prototype.hasOwnProperty.call(r,e)),V3=(t,e,r)=>n=>{if(typeof n!="string")return n;const[s,i,o,a]=n.match(OT);return{[t]:parseFloat(s),[e]:parseFloat(i),[r]:parseFloat(o),alpha:a!==void 0?parseFloat(a):1}},Qq=t=>wo(0,255,t),uv={...Zu,transform:t=>Math.round(Qq(t))},ul={test:DT("rgb","red"),parse:V3("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+uv.transform(t)+", "+uv.transform(e)+", "+uv.transform(r)+", "+pd(qd.transform(n))+")"};function eK(t){let e="",r="",n="",s="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),s=t.substring(4,5),e+=e,r+=r,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const Y1={test:DT("#"),parse:eK,transform:ul.transform},Nc={test:DT("hsl","hue"),parse:V3("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+Di.transform(pd(e))+", "+Di.transform(pd(r))+", "+pd(qd.transform(n))+")"},qr={test:t=>ul.test(t)||Y1.test(t)||Nc.test(t),parse:t=>ul.test(t)?ul.parse(t):Nc.test(t)?Nc.parse(t):Y1.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?ul.transform(t):Nc.transform(t)},tK=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function rK(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(OT))===null||e===void 0?void 0:e.length)||0)+(((r=t.match(tK))===null||r===void 0?void 0:r.length)||0)>0}const G3="number",W3="color",nK="var",sK="var(",m2="${}",iK=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Kd(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},s=[];let i=0;const a=e.replace(iK,l=>(qr.test(l)?(n.color.push(i),s.push(W3),r.push(qr.parse(l))):l.startsWith(sK)?(n.var.push(i),s.push(nK),r.push(l)):(n.number.push(i),s.push(G3),r.push(parseFloat(l))),++i,m2)).split(m2);return{values:r,split:a,indexes:n,types:s}}function q3(t){return Kd(t).values}function K3(t){const{split:e,types:r}=Kd(t),n=e.length;return s=>{let i="";for(let o=0;o<n;o++)if(i+=e[o],s[o]!==void 0){const a=r[o];a===G3?i+=pd(s[o]):a===W3?i+=qr.transform(s[o]):i+=s[o]}return i}}const oK=t=>typeof t=="number"?0:t;function aK(t){const e=q3(t);return K3(t)(e.map(oK))}const Ea={test:rK,parse:q3,createTransformer:K3,getAnimatableNone:aK},lK=new Set(["brightness","contrast","saturate","opacity"]);function cK(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(OT)||[];if(!n)return t;const s=r.replace(n,"");let i=lK.has(e)?1:0;return n!==r&&(i*=100),e+"("+i+s+")"}const uK=/\b([a-z-]*)\(.*?\)/gu,X1={...Ea,getAnimatableNone:t=>{const e=t.match(uK);return e?e.map(cK).join(" "):t}},hK={borderWidth:tt,borderTopWidth:tt,borderRightWidth:tt,borderBottomWidth:tt,borderLeftWidth:tt,borderRadius:tt,radius:tt,borderTopLeftRadius:tt,borderTopRightRadius:tt,borderBottomRightRadius:tt,borderBottomLeftRadius:tt,width:tt,maxWidth:tt,height:tt,maxHeight:tt,top:tt,right:tt,bottom:tt,left:tt,padding:tt,paddingTop:tt,paddingRight:tt,paddingBottom:tt,paddingLeft:tt,margin:tt,marginTop:tt,marginRight:tt,marginBottom:tt,marginLeft:tt,backgroundPositionX:tt,backgroundPositionY:tt},dK={rotate:Ho,rotateX:Ho,rotateY:Ho,rotateZ:Ho,scale:ym,scaleX:ym,scaleY:ym,scaleZ:ym,skew:Ho,skewX:Ho,skewY:Ho,distance:tt,translateX:tt,translateY:tt,translateZ:tt,x:tt,y:tt,z:tt,perspective:tt,transformPerspective:tt,opacity:qd,originX:u2,originY:u2,originZ:tt},g2={...Zu,transform:Math.round},LT={...hK,...dK,zIndex:g2,size:tt,fillOpacity:qd,strokeOpacity:qd,numOctaves:g2},fK={...LT,color:qr,backgroundColor:qr,outlineColor:qr,fill:qr,stroke:qr,borderColor:qr,borderTopColor:qr,borderRightColor:qr,borderBottomColor:qr,borderLeftColor:qr,filter:X1,WebkitFilter:X1},NT=t=>fK[t];function Y3(t,e){let r=NT(t);return r!==X1&&(r=Ea),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const pK=new Set(["auto","none","0"]);function mK(t,e,r){let n=0,s;for(;n<t.length&&!s;){const i=t[n];typeof i=="string"&&!pK.has(i)&&Kd(i).values.length&&(s=t[n]),n++}if(s&&r)for(const i of e)t[i]=Y3(r,s)}class X3 extends PT{constructor(e,r,n,s,i){super(e,r,n,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let c=e[l];if(typeof c=="string"&&(c=c.trim(),IT(c))){const u=j3(c,r.current);u!==void 0&&(e[l]=u),l===e.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!Gq.has(n)||e.length!==2)return;const[s,i]=e,o=p2(s),a=p2(i);if(o!==a)if(h2(o)&&h2(a))for(let l=0;l<e.length;l++){const c=e[l];typeof c=="string"&&(e[l]=parseFloat(c))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let s=0;s<e.length;s++)Fq(e[s])&&n.push(s);n.length&&mK(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=_u[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&e.getValue(n,s).jump(s,!1)}measureEndState(){var e;const{element:r,name:n,unresolvedKeyframes:s}=this;if(!r||!r.current)return;const i=r.getValue(n);i&&i.jump(this.measuredOrigin,!1);const o=s.length-1,a=s[o];s[o]=_u[n](r.measureViewportBox(),window.getComputedStyle(r.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([l,c])=>{r.getValue(l).set(c)}),this.resolveNoneKeyframes()}}function Py(t){return typeof t=="function"}let Ug;function gK(){Ug=void 0}const Li={now:()=>(Ug===void 0&&Li.set(Nr.isProcessing||Pq.useManualTiming?Nr.timestamp:performance.now()),Ug),set:t=>{Ug=t,queueMicrotask(gK)}},_2=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Ea.test(t)||t==="0")&&!t.startsWith("url("));function _K(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function yK(t,e,r,n){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=_2(s,e),a=_2(i,e);return!o||!a?!1:_K(t)||(r==="spring"||Py(r))&&n}const bK=40;class Z3{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:o="loop",...a}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Li.now(),this.options={autoplay:e,delay:r,type:n,repeat:s,repeatDelay:i,repeatType:o,...a},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>bK?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&Xq(),this._resolved}onKeyframesResolved(e,r){this.resolvedAt=Li.now(),this.hasAttemptedResolve=!0;const{name:n,type:s,velocity:i,delay:o,onComplete:a,onUpdate:l,isGenerator:c}=this.options;if(!c&&!yK(e,n,s,i))if(o)this.options.duration=0;else{l?.(Iy(e,this.options,r)),a?.(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,r);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:r,...u},this.onPostResolved())}onPostResolved(){}then(e,r){return this.currentFinishedPromise.then(e,r)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const Ll=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n},J3=(t,e,r=10)=>{let n="";const s=Math.max(Math.round(e/r),2);for(let i=0;i<s;i++)n+=t(Ll(0,s-1,i))+", ";return`linear(${n.substring(0,n.length-2)})`};function Q3(t,e){return e?t*(1e3/e):0}const vK=5;function eB(t,e,r){const n=Math.max(e-vK,0);return Q3(r-t(n),e-n)}const nr={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},hv=.001;function wK({duration:t=nr.duration,bounce:e=nr.bounce,velocity:r=nr.velocity,mass:n=nr.mass}){let s,i,o=1-e;o=wo(nr.minDamping,nr.maxDamping,o),t=wo(nr.minDuration,nr.maxDuration,Oi(t)),o<1?(s=c=>{const u=c*o,h=u*t,d=u-r,f=Z1(c,o),g=Math.exp(-h);return hv-d/f*g},i=c=>{const h=c*o*t,d=h*r+r,f=Math.pow(o,2)*Math.pow(c,2)*t,g=Math.exp(-h),_=Z1(Math.pow(c,2),o);return(-s(c)+hv>0?-1:1)*((d-f)*g)/_}):(s=c=>{const u=Math.exp(-c*t),h=(c-r)*t+1;return-hv+u*h},i=c=>{const u=Math.exp(-c*t),h=(r-c)*(t*t);return u*h});const a=5/t,l=xK(s,i,a);if(t=Pi(t),isNaN(l))return{stiffness:nr.stiffness,damping:nr.damping,duration:t};{const c=Math.pow(l,2)*n;return{stiffness:c,damping:o*2*Math.sqrt(n*c),duration:t}}}const EK=12;function xK(t,e,r){let n=r;for(let s=1;s<EK;s++)n=n-t(n)/e(n);return n}function Z1(t,e){return t*Math.sqrt(1-e*e)}const x0=2e4;function MT(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<x0;)e+=r,n=t.next(e);return e>=x0?1/0:e}const SK=["duration","bounce"],TK=["stiffness","damping","mass"];function y2(t,e){return e.some(r=>t[r]!==void 0)}function CK(t){let e={velocity:nr.velocity,stiffness:nr.stiffness,damping:nr.damping,mass:nr.mass,isResolvedFromDuration:!1,...t};if(!y2(t,TK)&&y2(t,SK))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,i=2*wo(.05,1,1-t.bounce)*Math.sqrt(s);e={...e,mass:nr.mass,stiffness:s,damping:i}}else{const r=wK(t);e={...e,...r,mass:nr.mass},e.isResolvedFromDuration=!0}return e}function BT(t=nr.visualDuration,e=nr.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:s}=r;const i=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],a={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:h,velocity:d,isResolvedFromDuration:f}=CK({...r,velocity:-Oi(r.velocity||0)}),g=d||0,_=c/(2*Math.sqrt(l*u)),m=o-i,p=Oi(Math.sqrt(l/u)),y=Math.abs(m)<5;n||(n=y?nr.restSpeed.granular:nr.restSpeed.default),s||(s=y?nr.restDelta.granular:nr.restDelta.default);let b;if(_<1){const w=Z1(p,_);b=E=>{const S=Math.exp(-_*p*E);return o-S*((g+_*p*m)/w*Math.sin(w*E)+m*Math.cos(w*E))}}else if(_===1)b=w=>o-Math.exp(-p*w)*(m+(g+p*m)*w);else{const w=p*Math.sqrt(_*_-1);b=E=>{const S=Math.exp(-_*p*E),x=Math.min(w*E,300);return o-S*((g+_*p*m)*Math.sinh(x)+w*m*Math.cosh(x))/w}}const v={calculatedDuration:f&&h||null,next:w=>{const E=b(w);if(f)a.done=w>=h;else{let S=0;_<1&&(S=w===0?Pi(g):eB(b,w,E));const x=Math.abs(S)<=n,C=Math.abs(o-E)<=s;a.done=x&&C}return a.value=a.done?o:E,a},toString:()=>{const w=Math.min(MT(v),x0),E=J3(S=>v.next(w*S).value,w,30);return w+"ms "+E}};return v}function b2({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:a,max:l,restDelta:c=.5,restSpeed:u}){const h=t[0],d={done:!1,value:h},f=x=>a!==void 0&&x<a||l!==void 0&&x>l,g=x=>a===void 0?l:l===void 0||Math.abs(a-x)<Math.abs(l-x)?a:l;let _=r*e;const m=h+_,p=o===void 0?m:o(m);p!==m&&(_=p-h);const y=x=>-_*Math.exp(-x/n),b=x=>p+y(x),v=x=>{const C=y(x),A=b(x);d.done=Math.abs(C)<=c,d.value=d.done?p:A};let w,E;const S=x=>{f(d.value)&&(w=x,E=BT({keyframes:[d.value,g(d.value)],velocity:eB(b,x,d.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return S(0),{calculatedDuration:null,next:x=>{let C=!1;return!E&&w===void 0&&(C=!0,v(x),S(x)),w!==void 0&&x>=w?E.next(x-w):(!C&&v(x),d)}}}const kK=sc(.42,0,1,1),AK=sc(0,0,.58,1),tB=sc(.42,0,.58,1),rB=t=>Array.isArray(t)&&typeof t[0]!="number",FT=t=>Array.isArray(t)&&typeof t[0]=="number",v2={linear:Jr,easeIn:kK,easeInOut:tB,easeOut:AK,circIn:RT,circInOut:L3,circOut:D3,backIn:AT,backInOut:P3,backOut:I3,anticipate:O3},w2=t=>{if(FT(t)){E0(t.length===4);const[e,r,n,s]=t;return sc(e,r,n,s)}else if(typeof t=="string")return E0(v2[t]!==void 0),v2[t];return t},RK=(t,e)=>r=>e(t(r)),go=(...t)=>t.reduce(RK),Xt=(t,e,r)=>t+(e-t)*r;function dv(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function IK({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let s=0,i=0,o=0;if(!e)s=i=o=r;else{const a=r<.5?r*(1+e):r+e-r*e,l=2*r-a;s=dv(l,a,t+1/3),i=dv(l,a,t),o=dv(l,a,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:n}}function S0(t,e){return r=>r>0?e:t}const fv=(t,e,r)=>{const n=t*t,s=r*(e*e-n)+n;return s<0?0:Math.sqrt(s)},PK=[Y1,ul,Nc],OK=t=>PK.find(e=>e.test(t));function E2(t){const e=OK(t);if(!e)return!1;let r=e.parse(t);return e===Nc&&(r=IK(r)),r}const x2=(t,e)=>{const r=E2(t),n=E2(e);if(!r||!n)return S0(t,e);const s={...r};return i=>(s.red=fv(r.red,n.red,i),s.green=fv(r.green,n.green,i),s.blue=fv(r.blue,n.blue,i),s.alpha=Xt(r.alpha,n.alpha,i),ul.transform(s))},J1=new Set(["none","hidden"]);function DK(t,e){return J1.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function LK(t,e){return r=>Xt(t,e,r)}function jT(t){return typeof t=="number"?LK:typeof t=="string"?IT(t)?S0:qr.test(t)?x2:BK:Array.isArray(t)?nB:typeof t=="object"?qr.test(t)?x2:NK:S0}function nB(t,e){const r=[...t],n=r.length,s=t.map((i,o)=>jT(i)(i,e[o]));return i=>{for(let o=0;o<n;o++)r[o]=s[o](i);return r}}function NK(t,e){const r={...t,...e},n={};for(const s in r)t[s]!==void 0&&e[s]!==void 0&&(n[s]=jT(t[s])(t[s],e[s]));return s=>{for(const i in n)r[i]=n[i](s);return r}}function MK(t,e){var r;const n=[],s={color:0,var:0,number:0};for(let i=0;i<e.values.length;i++){const o=e.types[i],a=t.indexes[o][s[o]],l=(r=t.values[a])!==null&&r!==void 0?r:0;n[i]=l,s[o]++}return n}const BK=(t,e)=>{const r=Ea.createTransformer(e),n=Kd(t),s=Kd(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?J1.has(t)&&!s.values.length||J1.has(e)&&!n.values.length?DK(t,e):go(nB(MK(n,s),s.values),r):S0(t,e)};function sB(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?Xt(t,e,r):jT(t)(t,e)}function FK(t,e,r){const n=[],s=r||sB,i=t.length-1;for(let o=0;o<i;o++){let a=s(t[o],t[o+1]);if(e){const l=Array.isArray(e)?e[o]||Jr:e;a=go(l,a)}n.push(a)}return n}function jK(t,e,{clamp:r=!0,ease:n,mixer:s}={}){const i=t.length;if(E0(i===e.length),i===1)return()=>e[0];if(i===2&&t[0]===t[1])return()=>e[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=FK(e,n,s),a=o.length,l=c=>{let u=0;if(a>1)for(;u<t.length-2&&!(c<t[u+1]);u++);const h=Ll(t[u],t[u+1],c);return o[u](h)};return r?c=>l(wo(t[0],t[i-1],c)):l}function iB(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const s=Ll(0,e,n);t.push(Xt(r,1,s))}}function oB(t){const e=[0];return iB(e,t.length-1),e}function UK(t,e){return t.map(r=>r*e)}function $K(t,e){return t.map(()=>e||tB).splice(0,t.length-1)}function T0({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const s=rB(n)?n.map(w2):w2(n),i={done:!1,value:e[0]},o=UK(r&&r.length===e.length?r:oB(e),t),a=jK(o,e,{ease:Array.isArray(s)?s:$K(e,s)});return{calculatedDuration:t,next:l=>(i.value=a(l),i.done=l>=t,i)}}const HK=t=>{const e=({timestamp:r})=>t(r);return{start:()=>Mt.update(e,!0),stop:()=>wa(e),now:()=>Nr.isProcessing?Nr.timestamp:Li.now()}},zK={decay:b2,inertia:b2,tween:T0,keyframes:T0,spring:BT},VK=t=>t/100;class UT extends Z3{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:r,motionValue:n,element:s,keyframes:i}=this.options,o=s?.KeyframeResolver||PT,a=(l,c)=>this.onKeyframesResolved(l,c);this.resolver=new o(i,a,r,n,s),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:r="keyframes",repeat:n=0,repeatDelay:s=0,repeatType:i,velocity:o=0}=this.options,a=Py(r)?r:zK[r]||T0;let l,c;a!==T0&&typeof e[0]!="number"&&(l=go(VK,sB(e[0],e[1])),e=[0,100]);const u=a({...this.options,keyframes:e});i==="mirror"&&(c=a({...this.options,keyframes:[...e].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=MT(u));const{calculatedDuration:h}=u,d=h+s,f=d*(n+1)-s;return{generator:u,mirroredGenerator:c,mapPercentToKeyframes:l,calculatedDuration:h,resolvedDuration:d,totalDuration:f}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,r=!1){const{resolved:n}=this;if(!n){const{keyframes:x}=this.options;return{done:!0,value:x[x.length-1]}}const{finalKeyframe:s,generator:i,mirroredGenerator:o,mapPercentToKeyframes:a,keyframes:l,calculatedDuration:c,totalDuration:u,resolvedDuration:h}=n;if(this.startTime===null)return i.next(0);const{delay:d,repeat:f,repeatType:g,repeatDelay:_,onUpdate:m}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),r?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const p=this.currentTime-d*(this.speed>=0?1:-1),y=this.speed>=0?p<0:p>u;this.currentTime=Math.max(p,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let b=this.currentTime,v=i;if(f){const x=Math.min(this.currentTime,u)/h;let C=Math.floor(x),A=x%1;!A&&x>=1&&(A=1),A===1&&C--,C=Math.min(C,f+1),!!(C%2)&&(g==="reverse"?(A=1-A,_&&(A-=_/h)):g==="mirror"&&(v=o)),b=wo(0,1,A)*h}const w=y?{done:!1,value:l[0]}:v.next(b);a&&(w.value=a(w.value));let{done:E}=w;!y&&c!==null&&(E=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const S=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&E);return S&&s!==void 0&&(w.value=Iy(l,this.options,s)),m&&m(w.value),S&&this.finish(),w}get duration(){const{resolved:e}=this;return e?Oi(e.calculatedDuration):0}get time(){return Oi(this.currentTime)}set time(e){e=Pi(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=Oi(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=HK,onPlay:r,startTime:n}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),r&&r();const s=this.driver.now();this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=s):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const GK=new Set(["opacity","clipPath","filter","transform"]);function $T(t){let e;return()=>(e===void 0&&(e=t()),e)}const WK={linearEasing:void 0};function qK(t,e){const r=$T(t);return()=>{var n;return(n=WK[e])!==null&&n!==void 0?n:r()}}const C0=qK(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing");function aB(t){return!!(typeof t=="function"&&C0()||!t||typeof t=="string"&&(t in Q1||C0())||FT(t)||Array.isArray(t)&&t.every(aB))}const Jh=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,Q1={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Jh([0,.65,.55,1]),circOut:Jh([.55,0,1,.45]),backIn:Jh([.31,.01,.66,-.59]),backOut:Jh([.33,1.53,.69,.99])};function lB(t,e){if(t)return typeof t=="function"&&C0()?J3(t,e):FT(t)?Jh(t):Array.isArray(t)?t.map(r=>lB(r,e)||Q1.easeOut):Q1[t]}function KK(t,e,r,{delay:n=0,duration:s=300,repeat:i=0,repeatType:o="loop",ease:a="easeInOut",times:l}={}){const c={[e]:r};l&&(c.offset=l);const u=lB(a,s);return Array.isArray(u)&&(c.easing=u),t.animate(c,{delay:n,duration:s,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function S2(t,e){t.timeline=e,t.onfinish=null}const YK=$T(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),k0=10,XK=2e4;function ZK(t){return Py(t.type)||t.type==="spring"||!aB(t.ease)}function JK(t,e){const r=new UT({...e,keyframes:t,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:t[0]};const s=[];let i=0;for(;!n.done&&i<XK;)n=r.sample(i),s.push(n.value),i+=k0;return{times:void 0,keyframes:s,duration:i-k0,ease:"linear"}}const cB={anticipate:O3,backInOut:P3,circInOut:L3};function QK(t){return t in cB}class T2 extends Z3{constructor(e){super(e);const{name:r,motionValue:n,element:s,keyframes:i}=this.options;this.resolver=new X3(i,(o,a)=>this.onKeyframesResolved(o,a),r,n,s),this.resolver.scheduleResolve()}initPlayback(e,r){var n;let{duration:s=300,times:i,ease:o,type:a,motionValue:l,name:c,startTime:u}=this.options;if(!(!((n=l.owner)===null||n===void 0)&&n.current))return!1;if(typeof o=="string"&&C0()&&QK(o)&&(o=cB[o]),ZK(this.options)){const{onComplete:d,onUpdate:f,motionValue:g,element:_,...m}=this.options,p=JK(e,m);e=p.keyframes,e.length===1&&(e[1]=e[0]),s=p.duration,i=p.times,o=p.ease,a="keyframes"}const h=KK(l.owner.current,c,e,{...this.options,duration:s,times:i,ease:o});return h.startTime=u??this.calcStartTime(),this.pendingTimeline?(S2(h,this.pendingTimeline),this.pendingTimeline=void 0):h.onfinish=()=>{const{onComplete:d}=this.options;l.set(Iy(e,this.options,r)),d&&d(),this.cancel(),this.resolveFinishedPromise()},{animation:h,duration:s,times:i,type:a,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:r}=e;return Oi(r)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:r}=e;return Oi(r.currentTime||0)}set time(e){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.currentTime=Pi(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:r}=e;return r.playbackRate}set speed(e){const{resolved:r}=this;if(!r)return;const{animation:n}=r;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:r}=e;return r.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:r}=e;return r.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:r}=this;if(!r)return Jr;const{animation:n}=r;S2(n,e)}return Jr}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:r}=e;r.playState==="finished"&&this.updateFinishedPromise(),r.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:r}=e;r.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:r,keyframes:n,duration:s,type:i,ease:o,times:a}=e;if(r.playState==="idle"||r.playState==="finished")return;if(this.time){const{motionValue:c,onUpdate:u,onComplete:h,element:d,...f}=this.options,g=new UT({...f,keyframes:n,duration:s,type:i,ease:o,times:a,isGenerator:!0}),_=Pi(this.time);c.setWithVelocity(g.sample(_-k0).value,g.sample(_).value,k0)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:r,name:n,repeatDelay:s,repeatType:i,damping:o,type:a}=e;return YK()&&n&&GK.has(n)&&r&&r.owner&&r.owner.current instanceof HTMLElement&&!r.owner.getProps().onUpdate&&!s&&i!=="mirror"&&o!==0&&a!=="inertia"}}const eY=$T(()=>window.ScrollTimeline!==void 0);class uB{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}then(e,r){return Promise.all(this.animations).then(e).catch(r)}getAll(e){return this.animations[0][e]}setAll(e,r){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=r}attachTimeline(e,r){const n=this.animations.map(s=>eY()&&s.attachTimeline?s.attachTimeline(e):r(s));return()=>{n.forEach((s,i)=>{s&&s(),this.animations[i].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let r=0;r<this.animations.length;r++)e=Math.max(e,this.animations[r].duration);return e}runAll(e){this.animations.forEach(r=>r[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}function tY({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:a,from:l,elapsed:c,...u}){return!!Object.keys(u).length}const HT=(t,e,r,n={},s,i)=>o=>{const a=kT(n,t)||{},l=a.delay||n.delay||0;let{elapsed:c=0}=n;c=c-Pi(l);let u={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...a,delay:-c,onUpdate:d=>{e.set(d),a.onUpdate&&a.onUpdate(d)},onComplete:()=>{o(),a.onComplete&&a.onComplete()},name:t,motionValue:e,element:i?void 0:s};tY(a)||(u={...u,...Iq(t,u)}),u.duration&&(u.duration=Pi(u.duration)),u.repeatDelay&&(u.repeatDelay=Pi(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let h=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(h=!0)),h&&!i&&e.get()!==void 0){const d=Iy(u.keyframes,a);if(d!==void 0)return Mt.update(()=>{u.onUpdate(d),u.onComplete()}),new uB([])}return!i&&T2.supports(u)?new T2(u):new UT(u)},rY=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),nY=t=>W1(t)?t[t.length-1]||0:t;function zT(t,e){t.indexOf(e)===-1&&t.push(e)}function Oy(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}class VT{constructor(){this.subscriptions=[]}add(e){return zT(this.subscriptions,e),()=>Oy(this.subscriptions,e)}notify(e,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,r,n);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const C2=30,sY=t=>!isNaN(parseFloat(t));class iY{constructor(e,r={}){this.version="11.12.0",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,s=!0)=>{const i=Li.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=Li.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=sY(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new VT);const n=this.events[e].add(r);return e==="change"?()=>{n(),Mt.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e,r=!0){!r||!this.passiveEffect?this.updateAndNotify(e,r):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Li.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>C2)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,C2);return Q3(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Yd(t,e){return new iY(t,e)}function oY(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,Yd(r))}function aY(t,e){const r=Ry(t,e);let{transitionEnd:n={},transition:s={},...i}=r||{};i={...i,...n};for(const o in i){const a=nY(i[o]);oY(t,o,a)}}const GT=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),lY="framerAppearId",hB="data-"+GT(lY);function dB(t){return t.props[hB]}const Ar=t=>!!(t&&t.getVelocity);function cY(t){return!!(Ar(t)&&t.add)}function eE(t,e){const r=t.getValue("willChange");if(cY(r))return r.add(e)}function uY({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function WT(t,e,{delay:r=0,transitionOverride:n,type:s}={}){var i;let{transition:o=t.getDefaultTransition(),transitionEnd:a,...l}=e;n&&(o=n);const c=[],u=s&&t.animationState&&t.animationState.getState()[s];for(const h in l){const d=t.getValue(h,(i=t.latestValues[h])!==null&&i!==void 0?i:null),f=l[h];if(f===void 0||u&&uY(u,h))continue;const g={delay:r,...kT(o||{},h)};let _=!1;if(window.MotionHandoffAnimation){const p=dB(t);if(p){const y=window.MotionHandoffAnimation(p,h,Mt);y!==null&&(g.startTime=y,_=!0)}}eE(t,h),d.start(HT(h,d,f,t.shouldReduceMotion&&nc.has(h)?{type:!1}:g,t,_));const m=d.animation;m&&c.push(m)}return a&&Promise.all(c).then(()=>{Mt.update(()=>{a&&aY(t,a)})}),c}function tE(t,e,r={}){var n;const s=Ry(t,e,r.type==="exit"?(n=t.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:i=t.getDefaultTransition()||{}}=s||{};r.transitionOverride&&(i=r.transitionOverride);const o=s?()=>Promise.all(WT(t,s,r)):()=>Promise.resolve(),a=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:h,staggerDirection:d}=i;return hY(t,e,u+c,h,d,r)}:()=>Promise.resolve(),{when:l}=i;if(l){const[c,u]=l==="beforeChildren"?[o,a]:[a,o];return c().then(()=>u())}else return Promise.all([o(),a(r.delay)])}function hY(t,e,r=0,n=0,s=1,i){const o=[],a=(t.variantChildren.size-1)*n,l=s===1?(c=0)=>c*n:(c=0)=>a-c*n;return Array.from(t.variantChildren).sort(dY).forEach((c,u)=>{c.notify("AnimationStart",e),o.push(tE(c,e,{...i,delay:r+l(u)}).then(()=>c.notify("AnimationComplete",e)))}),Promise.all(o)}function dY(t,e){return t.sortNodePosition(e)}function fY(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(i=>tE(t,i,r));n=Promise.all(s)}else if(typeof e=="string")n=tE(t,e,r);else{const s=typeof e=="function"?Ry(t,e,r.custom):e;n=Promise.all(WT(t,s,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}const pY=CT.length;function fB(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?fB(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<pY;r++){const n=CT[r],s=t.props[n];(Wd(s)||s===!1)&&(e[n]=s)}return e}const mY=[...TT].reverse(),gY=TT.length;function _Y(t){return e=>Promise.all(e.map(({animation:r,options:n})=>fY(t,r,n)))}function yY(t){let e=_Y(t),r=k2(),n=!0;const s=l=>(c,u)=>{var h;const d=Ry(t,u,l==="exit"?(h=t.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(d){const{transition:f,transitionEnd:g,..._}=d;c={...c,..._,...g}}return c};function i(l){e=l(t)}function o(l){const{props:c}=t,u=fB(t.parent)||{},h=[],d=new Set;let f={},g=1/0;for(let m=0;m<gY;m++){const p=mY[m],y=r[p],b=c[p]!==void 0?c[p]:u[p],v=Wd(b),w=p===l?y.isActive:null;w===!1&&(g=m);let E=b===u[p]&&b!==c[p]&&v;if(E&&n&&t.manuallyAnimateOnMount&&(E=!1),y.protectedKeys={...f},!y.isActive&&w===null||!b&&!y.prevProp||Ay(b)||typeof b=="boolean")continue;const S=bY(y.prevProp,b);let x=S||p===l&&y.isActive&&!E&&v||m>g&&v,C=!1;const A=Array.isArray(b)?b:[b];let M=A.reduce(s(p),{});w===!1&&(M={});const{prevResolvedValues:P={}}=y,D={...P,...M},R=q=>{x=!0,d.has(q)&&(C=!0,d.delete(q)),y.needsAnimating[q]=!0;const re=t.getValue(q);re&&(re.liveStyle=!1)};for(const q in D){const re=M[q],N=P[q];if(f.hasOwnProperty(q))continue;let B=!1;W1(re)&&W1(N)?B=!T3(re,N):B=re!==N,B?re!=null?R(q):d.add(q):re!==void 0&&d.has(q)?R(q):y.protectedKeys[q]=!0}y.prevProp=b,y.prevResolvedValues=M,y.isActive&&(f={...f,...M}),n&&t.blockInitialAnimation&&(x=!1),x&&(!(E&&S)||C)&&h.push(...A.map(q=>({animation:q,options:{type:p}})))}if(d.size){const m={};d.forEach(p=>{const y=t.getBaseTarget(p),b=t.getValue(p);b&&(b.liveStyle=!0),m[p]=y??null}),h.push({animation:m})}let _=!!h.length;return n&&(c.initial===!1||c.initial===c.animate)&&!t.manuallyAnimateOnMount&&(_=!1),n=!1,_?e(h):Promise.resolve()}function a(l,c){var u;if(r[l].isActive===c)return Promise.resolve();(u=t.variantChildren)===null||u===void 0||u.forEach(d=>{var f;return(f=d.animationState)===null||f===void 0?void 0:f.setActive(l,c)}),r[l].isActive=c;const h=o(l);for(const d in r)r[d].protectedKeys={};return h}return{animateChanges:o,setActive:a,setAnimateFunction:i,getState:()=>r,reset:()=>{r=k2(),n=!0}}}function bY(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!T3(e,t):!1}function Wa(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function k2(){return{animate:Wa(!0),whileInView:Wa(),whileHover:Wa(),whileTap:Wa(),whileDrag:Wa(),whileFocus:Wa(),exit:Wa()}}class Ua{constructor(e){this.isMounted=!1,this.node=e}update(){}}class vY extends Ua{constructor(e){super(e),e.animationState||(e.animationState=yY(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Ay(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let wY=0;class EY extends Ua{constructor(){super(...arguments),this.id=wY++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const s=this.node.animationState.setActive("exit",!e);r&&!e&&s.then(()=>r(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const xY={animation:{Feature:vY},exit:{Feature:EY}},pB=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function Dy(t,e="page"){return{point:{x:t[`${e}X`],y:t[`${e}Y`]}}}const SY=t=>e=>pB(e)&&t(e,Dy(e));function ho(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function _o(t,e,r,n){return ho(t,e,SY(r),n)}const A2=(t,e)=>Math.abs(t-e);function TY(t,e){const r=A2(t.x,e.x),n=A2(t.y,e.y);return Math.sqrt(r**2+n**2)}class mB{constructor(e,r,{transformPagePoint:n,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=mv(this.lastMoveEventInfo,this.history),d=this.startEvent!==null,f=TY(h.offset,{x:0,y:0})>=3;if(!d&&!f)return;const{point:g}=h,{timestamp:_}=Nr;this.history.push({...g,timestamp:_});const{onStart:m,onMove:p}=this.handlers;d||(m&&m(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),p&&p(this.lastMoveEvent,h)},this.handlePointerMove=(h,d)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=pv(d,this.transformPagePoint),Mt.update(this.updatePoint,!0)},this.handlePointerUp=(h,d)=>{this.end();const{onEnd:f,onSessionEnd:g,resumeAnimation:_}=this.handlers;if(this.dragSnapToOrigin&&_&&_(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=mv(h.type==="pointercancel"?this.lastMoveEventInfo:pv(d,this.transformPagePoint),this.history);this.startEvent&&f&&f(h,m),g&&g(h,m)},!pB(e))return;this.dragSnapToOrigin=i,this.handlers=r,this.transformPagePoint=n,this.contextWindow=s||window;const o=Dy(e),a=pv(o,this.transformPagePoint),{point:l}=a,{timestamp:c}=Nr;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=r;u&&u(e,mv(a,this.history)),this.removeListeners=go(_o(this.contextWindow,"pointermove",this.handlePointerMove),_o(this.contextWindow,"pointerup",this.handlePointerUp),_o(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),wa(this.updatePoint)}}function pv(t,e){return e?{point:e(t.point)}:t}function R2(t,e){return{x:t.x-e.x,y:t.y-e.y}}function mv({point:t},e){return{point:t,delta:R2(t,gB(e)),offset:R2(t,CY(e)),velocity:kY(e,.1)}}function CY(t){return t[0]}function gB(t){return t[t.length-1]}function kY(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const s=gB(t);for(;r>=0&&(n=t[r],!(s.timestamp-n.timestamp>Pi(e)));)r--;if(!n)return{x:0,y:0};const i=Oi(s.timestamp-n.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-n.x)/i,y:(s.y-n.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function _B(t){let e=null;return()=>{const r=()=>{e=null};return e===null?(e=t,r):!1}}const I2=_B("dragHorizontal"),P2=_B("dragVertical");function yB(t){let e=!1;if(t==="y")e=P2();else if(t==="x")e=I2();else{const r=I2(),n=P2();r&&n?e=()=>{r(),n()}:(r&&r(),n&&n())}return e}function bB(){const t=yB(!0);return t?(t(),!1):!0}function Mc(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}const vB=1e-4,AY=1-vB,RY=1+vB,wB=.01,IY=0-wB,PY=0+wB;function Jn(t){return t.max-t.min}function OY(t,e,r){return Math.abs(t-e)<=r}function O2(t,e,r,n=.5){t.origin=n,t.originPoint=Xt(e.min,e.max,t.origin),t.scale=Jn(r)/Jn(e),t.translate=Xt(r.min,r.max,t.origin)-t.originPoint,(t.scale>=AY&&t.scale<=RY||isNaN(t.scale))&&(t.scale=1),(t.translate>=IY&&t.translate<=PY||isNaN(t.translate))&&(t.translate=0)}function md(t,e,r,n){O2(t.x,e.x,r.x,n?n.originX:void 0),O2(t.y,e.y,r.y,n?n.originY:void 0)}function D2(t,e,r){t.min=r.min+e.min,t.max=t.min+Jn(e)}function DY(t,e,r){D2(t.x,e.x,r.x),D2(t.y,e.y,r.y)}function L2(t,e,r){t.min=e.min-r.min,t.max=t.min+Jn(e)}function gd(t,e,r){L2(t.x,e.x,r.x),L2(t.y,e.y,r.y)}function LY(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?Xt(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?Xt(r,t,n.max):Math.min(t,r)),t}function N2(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function NY(t,{top:e,left:r,bottom:n,right:s}){return{x:N2(t.x,r,s),y:N2(t.y,e,n)}}function M2(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function MY(t,e){return{x:M2(t.x,e.x),y:M2(t.y,e.y)}}function BY(t,e){let r=.5;const n=Jn(t),s=Jn(e);return s>n?r=Ll(e.min,e.max-n,t.min):n>s&&(r=Ll(t.min,t.max-s,e.min)),wo(0,1,r)}function FY(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const rE=.35;function jY(t=rE){return t===!1?t=0:t===!0&&(t=rE),{x:B2(t,"left","right"),y:B2(t,"top","bottom")}}function B2(t,e,r){return{min:F2(t,e),max:F2(t,r)}}function F2(t,e){return typeof t=="number"?t:t[e]||0}const j2=()=>({translate:0,scale:1,origin:0,originPoint:0}),Bc=()=>({x:j2(),y:j2()}),U2=()=>({min:0,max:0}),rr=()=>({x:U2(),y:U2()});function ls(t){return[t("x"),t("y")]}function EB({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function UY({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function $Y(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function gv(t){return t===void 0||t===1}function nE({scale:t,scaleX:e,scaleY:r}){return!gv(t)||!gv(e)||!gv(r)}function tl(t){return nE(t)||xB(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function xB(t){return $2(t.x)||$2(t.y)}function $2(t){return t&&t!=="0%"}function A0(t,e,r){const n=t-r,s=e*n;return r+s}function H2(t,e,r,n,s){return s!==void 0&&(t=A0(t,s,n)),A0(t,r,n)+e}function sE(t,e=0,r=1,n,s){t.min=H2(t.min,e,r,n,s),t.max=H2(t.max,e,r,n,s)}function SB(t,{x:e,y:r}){sE(t.x,e.translate,e.scale,e.originPoint),sE(t.y,r.translate,r.scale,r.originPoint)}const z2=.999999999999,V2=1.0000000000001;function HY(t,e,r,n=!1){const s=r.length;if(!s)return;e.x=e.y=1;let i,o;for(let a=0;a<s;a++){i=r[a],o=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&jc(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,SB(t,o)),n&&tl(i.latestValues)&&jc(t,i.latestValues))}e.x<V2&&e.x>z2&&(e.x=1),e.y<V2&&e.y>z2&&(e.y=1)}function Fc(t,e){t.min=t.min+e,t.max=t.max+e}function G2(t,e,r,n,s=.5){const i=Xt(t.min,t.max,s);sE(t,e,r,i,n)}function jc(t,e){G2(t.x,e.x,e.scaleX,e.scale,e.originX),G2(t.y,e.y,e.scaleY,e.scale,e.originY)}function TB(t,e){return EB($Y(t.getBoundingClientRect(),e))}function zY(t,e,r){const n=TB(t,r),{scroll:s}=e;return s&&(Fc(n.x,s.offset.x),Fc(n.y,s.offset.y)),n}const CB=({current:t})=>t?t.ownerDocument.defaultView:null,VY=new WeakMap;class GY{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=rr(),this.visualElement=e}start(e,{snapToCursor:r=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const s=u=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Dy(u,"page").point)},i=(u,h)=>{const{drag:d,dragPropagation:f,onDragStart:g}=this.getProps();if(d&&!f&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=yB(d),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ls(m=>{let p=this.getAxisMotionValue(m).get()||0;if(Di.test(p)){const{projection:y}=this.visualElement;if(y&&y.layout){const b=y.layout.layoutBox[m];b&&(p=Jn(b)*(parseFloat(p)/100))}}this.originPoint[m]=p}),g&&Mt.postRender(()=>g(u,h)),eE(this.visualElement,"transform");const{animationState:_}=this.visualElement;_&&_.setActive("whileDrag",!0)},o=(u,h)=>{const{dragPropagation:d,dragDirectionLock:f,onDirectionLock:g,onDrag:_}=this.getProps();if(!d&&!this.openGlobalLock)return;const{offset:m}=h;if(f&&this.currentDirection===null){this.currentDirection=WY(m),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",h.point,m),this.updateAxis("y",h.point,m),this.visualElement.render(),_&&_(u,h)},a=(u,h)=>this.stop(u,h),l=()=>ls(u=>{var h;return this.getAnimationState(u)==="paused"&&((h=this.getAxisMotionValue(u).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new mB(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:a,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:CB(this.visualElement)})}stop(e,r){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:s}=r;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&Mt.postRender(()=>i(e,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:s}=this.getProps();if(!n||!bm(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(o=LY(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:r,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;r&&Mc(r)?this.constraints||(this.constraints=this.resolveRefConstraints()):r&&s?this.constraints=NY(s.layoutBox,r):this.constraints=!1,this.elastic=jY(n),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&ls(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=FY(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!Mc(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=zY(n,s.root,this.visualElement.getTransformPagePoint());let o=MY(s.layout.layoutBox,i);if(r){const a=r(UY(o));this.hasMutatedConstraints=!!a,a&&(o=EB(a))}return o}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:a}=this.getProps(),l=this.constraints||{},c=ls(u=>{if(!bm(u,r,this.currentDirection))return;let h=l&&l[u]||{};o&&(h={min:0,max:0});const d=s?200:1e6,f=s?40:1e7,g={type:"inertia",velocity:n?e[u]:0,bounceStiffness:d,bounceDamping:f,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(u,g)});return Promise.all(c).then(a)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return eE(this.visualElement,e),n.start(HT(e,n,0,r,this.visualElement,!1))}stopAnimation(){ls(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ls(e=>{var r;return(r=this.getAxisMotionValue(e).animation)===null||r===void 0?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)===null||r===void 0?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){ls(r=>{const{drag:n}=this.getProps();if(!bm(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(r);if(s&&s.layout){const{min:o,max:a}=s.layout.layoutBox[r];i.set(e[r]-Xt(o,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Mc(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};ls(o=>{const a=this.getAxisMotionValue(o);if(a&&this.constraints!==!1){const l=a.get();s[o]=BY({min:l,max:l},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),ls(o=>{if(!bm(o,e,null))return;const a=this.getAxisMotionValue(o),{min:l,max:c}=this.constraints[o];a.set(Xt(l,c,s[o]))})}addListeners(){if(!this.visualElement.current)return;VY.set(this.visualElement,this);const e=this.visualElement.current,r=_o(e,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();Mc(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Mt.read(n);const o=ho(window,"resize",()=>this.scalePositionWithinConstraints()),a=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(ls(u=>{const h=this.getAxisMotionValue(u);h&&(this.originPoint[u]+=l[u].translate,h.set(h.get()+l[u].translate))}),this.visualElement.render())});return()=>{o(),r(),i(),a&&a()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=rE,dragMomentum:a=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:a}}}function bm(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function WY(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class qY extends Ua{constructor(e){super(e),this.removeGroupControls=Jr,this.removeListeners=Jr,this.controls=new GY(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Jr}unmount(){this.removeGroupControls(),this.removeListeners()}}const W2=t=>(e,r)=>{t&&Mt.postRender(()=>t(e,r))};class KY extends Ua{constructor(){super(...arguments),this.removePointerDownListener=Jr}onPointerDown(e){this.session=new mB(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:CB(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:W2(e),onStart:W2(r),onMove:n,onEnd:(i,o)=>{delete this.session,s&&Mt.postRender(()=>s(i,o))}}}mount(){this.removePointerDownListener=_o(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ly=I.createContext(null);function YY(){const t=I.useContext(Ly);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:r,register:n}=t,s=I.useId();I.useEffect(()=>n(s),[]);const i=I.useCallback(()=>r&&r(s),[s,r]);return!e&&r?[!1,i]:[!0]}const qT=I.createContext({}),kB=I.createContext({}),$g={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function q2(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Ah={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(tt.test(t))t=parseFloat(t);else return t;const r=q2(t,e.target.x),n=q2(t,e.target.y);return`${r}% ${n}%`}},XY={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,s=Ea.parse(t);if(s.length>5)return n;const i=Ea.createTransformer(t),o=typeof s[0]!="number"?1:0,a=r.x.scale*e.x,l=r.y.scale*e.y;s[0+o]/=a,s[1+o]/=l;const c=Xt(a,l,.5);return typeof s[2+o]=="number"&&(s[2+o]/=c),typeof s[3+o]=="number"&&(s[3+o]/=c),i(s)}},R0={};function ZY(t){Object.assign(R0,t)}const{schedule:KT,cancel:vHe}=C3(queueMicrotask,!1);class JY extends I.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:i}=e;ZY(QY),i&&(r.group&&r.group.add(i),n&&n.register&&s&&n.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),$g.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:s,isPresent:i}=this.props,o=n.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==r||r===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||Mt.postRender(()=>{const a=o.getStack();(!a||!a.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),KT.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function AB(t){const[e,r]=YY(),n=I.useContext(qT);return T.jsx(JY,{...t,layoutGroup:n,switchLayoutGroup:I.useContext(kB),isPresent:e,safeToRemove:r})}const QY={borderRadius:{...Ah,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Ah,borderTopRightRadius:Ah,borderBottomLeftRadius:Ah,borderBottomRightRadius:Ah,boxShadow:XY},RB=["TopLeft","TopRight","BottomLeft","BottomRight"],eX=RB.length,K2=t=>typeof t=="string"?parseFloat(t):t,Y2=t=>typeof t=="number"||tt.test(t);function tX(t,e,r,n,s,i){s?(t.opacity=Xt(0,r.opacity!==void 0?r.opacity:1,rX(n)),t.opacityExit=Xt(e.opacity!==void 0?e.opacity:1,0,nX(n))):i&&(t.opacity=Xt(e.opacity!==void 0?e.opacity:1,r.opacity!==void 0?r.opacity:1,n));for(let o=0;o<eX;o++){const a=`border${RB[o]}Radius`;let l=X2(e,a),c=X2(r,a);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||Y2(l)===Y2(c)?(t[a]=Math.max(Xt(K2(l),K2(c),n),0),(Di.test(c)||Di.test(l))&&(t[a]+="%")):t[a]=c}(e.rotate||r.rotate)&&(t.rotate=Xt(e.rotate||0,r.rotate||0,n))}function X2(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const rX=IB(0,.5,D3),nX=IB(.5,.95,Jr);function IB(t,e,r){return n=>n<t?0:n>e?1:r(Ll(t,e,n))}function Z2(t,e){t.min=e.min,t.max=e.max}function os(t,e){Z2(t.x,e.x),Z2(t.y,e.y)}function J2(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function Q2(t,e,r,n,s){return t-=e,t=A0(t,1/r,n),s!==void 0&&(t=A0(t,1/s,n)),t}function sX(t,e=0,r=1,n=.5,s,i=t,o=t){if(Di.test(e)&&(e=parseFloat(e),e=Xt(o.min,o.max,e/100)-o.min),typeof e!="number")return;let a=Xt(i.min,i.max,n);t===i&&(a-=e),t.min=Q2(t.min,e,r,a,s),t.max=Q2(t.max,e,r,a,s)}function eR(t,e,[r,n,s],i,o){sX(t,e[r],e[n],e[s],e.scale,i,o)}const iX=["x","scaleX","originX"],oX=["y","scaleY","originY"];function tR(t,e,r,n){eR(t.x,e,iX,r?r.x:void 0,n?n.x:void 0),eR(t.y,e,oX,r?r.y:void 0,n?n.y:void 0)}function rR(t){return t.translate===0&&t.scale===1}function PB(t){return rR(t.x)&&rR(t.y)}function nR(t,e){return t.min===e.min&&t.max===e.max}function aX(t,e){return nR(t.x,e.x)&&nR(t.y,e.y)}function sR(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function OB(t,e){return sR(t.x,e.x)&&sR(t.y,e.y)}function iR(t){return Jn(t.x)/Jn(t.y)}function oR(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class lX{constructor(){this.members=[]}add(e){zT(this.members,e),e.scheduleRender()}remove(e){if(Oy(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(s=>e===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){n=i;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function cX(t,e,r){let n="";const s=t.x.translate/e.x,i=t.y.translate/e.y,o=r?.z||0;if((s||i||o)&&(n=`translate3d(${s}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:c,rotate:u,rotateX:h,rotateY:d,skewX:f,skewY:g}=r;c&&(n=`perspective(${c}px) ${n}`),u&&(n+=`rotate(${u}deg) `),h&&(n+=`rotateX(${h}deg) `),d&&(n+=`rotateY(${d}deg) `),f&&(n+=`skewX(${f}deg) `),g&&(n+=`skewY(${g}deg) `)}const a=t.x.scale*e.x,l=t.y.scale*e.y;return(a!==1||l!==1)&&(n+=`scale(${a}, ${l})`),n||"none"}const uX=(t,e)=>t.depth-e.depth;class hX{constructor(){this.children=[],this.isDirty=!1}add(e){zT(this.children,e),this.isDirty=!0}remove(e){Oy(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(uX),this.isDirty=!1,this.children.forEach(e)}}function Hg(t){const e=Ar(t)?t.get():t;return rY(e)?e.toValue():e}function dX(t,e){const r=Li.now(),n=({timestamp:s})=>{const i=s-r;i>=e&&(wa(n),t(i-e))};return Mt.read(n,!0),()=>wa(n)}function DB(t){return t instanceof SVGElement&&t.tagName!=="svg"}function LB(t,e,r){const n=Ar(t)?t:Yd(t);return n.start(HT("",n,e,r)),n.animation}const rl={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},Qh=typeof window<"u"&&window.MotionDebug!==void 0,_v=["","X","Y","Z"],fX={visibility:"hidden"},aR=1e3;let pX=0;function yv(t,e,r,n){const{latestValues:s}=e;s[t]&&(r[t]=s[t],e.setStaticValue(t,0),n&&(n[t]=0))}function NB(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=dB(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",Mt,!(s||i))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&NB(n)}function MB({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(o={},a=e?.()){this.id=pX++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Qh&&(rl.totalNodes=rl.resolvedTargetDeltas=rl.recalculatedProjection=0),this.nodes.forEach(_X),this.nodes.forEach(EX),this.nodes.forEach(xX),this.nodes.forEach(yX),Qh&&window.MotionDebug.record(rl)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=a?a.root||a:this,this.path=a?[...a.path,a]:[],this.parent=a,this.depth=a?a.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new hX)}addEventListener(o,a){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new VT),this.eventHandlers.get(o).add(a)}notifyListeners(o,...a){const l=this.eventHandlers.get(o);l&&l.notify(...a)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,a=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=DB(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),a&&(c||l)&&(this.isLayoutDirty=!0),t){let h;const d=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=dX(d,250),$g.hasAnimatedSinceResize&&($g.hasAnimatedSinceResize=!1,this.nodes.forEach(cR))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:d,hasRelativeTargetChanged:f,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||u.getDefaultTransition()||AX,{onLayoutAnimationStart:m,onLayoutAnimationComplete:p}=u.getProps(),y=!this.targetLayout||!OB(this.targetLayout,g)||f,b=!d&&f;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||b||d&&(y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,b);const v={...kT(_,"layout"),onPlay:m,onComplete:p};(u.shouldReduceMotion||this.options.layoutRoot)&&(v.delay=0,v.type=!1),this.startAnimation(v)}else d||cR(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,wa(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(SX),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&NB(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const h=this.path[u];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:a,layout:l}=this.options;if(a===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(lR);return}this.isUpdating||this.nodes.forEach(vX),this.isUpdating=!1,this.nodes.forEach(wX),this.nodes.forEach(mX),this.nodes.forEach(gX),this.clearAllSnapshots();const a=Li.now();Nr.delta=wo(0,1e3/60,a-Nr.timestamp),Nr.timestamp=a,Nr.isProcessing=!0,cv.update.process(Nr),cv.preRender.process(Nr),cv.render.process(Nr),Nr.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,KT.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(bX),this.sharedNodes.forEach(TX)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Mt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Mt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=rr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:a}=this.options;a&&a.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let a=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(a=!1),a){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:l,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,a=this.projectionDelta&&!PB(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;o&&(a||tl(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const a=this.measurePageBox();let l=this.removeElementScroll(a);return o&&(l=this.removeTransform(l)),RX(l),{animationId:this.root.animationId,measuredBox:a,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var o;const{visualElement:a}=this.options;if(!a)return rr();const l=a.measureViewportBox();if(!(((o=this.scroll)===null||o===void 0?void 0:o.wasRoot)||this.path.some(IX))){const{scroll:u}=this.root;u&&(Fc(l.x,u.offset.x),Fc(l.y,u.offset.y))}return l}removeElementScroll(o){var a;const l=rr();if(os(l,o),!((a=this.scroll)===null||a===void 0)&&a.wasRoot)return l;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:h,options:d}=u;u!==this.root&&h&&d.layoutScroll&&(h.wasRoot&&os(l,o),Fc(l.x,h.offset.x),Fc(l.y,h.offset.y))}return l}applyTransform(o,a=!1){const l=rr();os(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];!a&&u.options.layoutScroll&&u.scroll&&u!==u.root&&jc(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),tl(u.latestValues)&&jc(l,u.latestValues)}return tl(this.latestValues)&&jc(l,this.latestValues),l}removeTransform(o){const a=rr();os(a,o);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!tl(c.latestValues))continue;nE(c.latestValues)&&c.updateSnapshot();const u=rr(),h=c.measurePageBox();os(u,h),tR(a,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return tl(this.latestValues)&&tR(a,this.latestValues),a}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Nr.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var a;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:d}=this.options;if(!(!this.layout||!(h||d))){if(this.resolvedRelativeTargetAt=Nr.timestamp,!this.targetDelta&&!this.relativeTarget){const f=this.getClosestProjectingParent();f&&f.layout&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=rr(),this.relativeTargetOrigin=rr(),gd(this.relativeTargetOrigin,this.layout.layoutBox,f.layout.layoutBox),os(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=rr(),this.targetWithTransforms=rr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),DY(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):os(this.target,this.layout.layoutBox),SB(this.target,this.targetDelta)):os(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const f=this.getClosestProjectingParent();f&&!!f.resumingFrom==!!this.resumingFrom&&!f.options.layoutScroll&&f.target&&this.animationProgress!==1?(this.relativeParent=f,this.forceRelativeParentToResolveTarget(),this.relativeTarget=rr(),this.relativeTargetOrigin=rr(),gd(this.relativeTargetOrigin,this.target,f.target),os(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Qh&&rl.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||nE(this.parent.latestValues)||xB(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const a=this.getLead(),l=!!this.resumingFrom||this!==a;let c=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Nr.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;os(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,f=this.treeScale.y;HY(this.layoutCorrected,this.treeScale,this.path,l),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=rr());const{target:g}=a;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(J2(this.prevProjectionDelta.x,this.projectionDelta.x),J2(this.prevProjectionDelta.y,this.projectionDelta.y)),md(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==f||!oR(this.projectionDelta.x,this.prevProjectionDelta.x)||!oR(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),Qh&&rl.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var a;if((a=this.options.visualElement)===null||a===void 0||a.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Bc(),this.projectionDelta=Bc(),this.projectionDeltaWithTransform=Bc()}setAnimationOrigin(o,a=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},h=Bc();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!a;const d=rr(),f=l?l.source:void 0,g=this.layout?this.layout.source:void 0,_=f!==g,m=this.getStack(),p=!m||m.members.length<=1,y=!!(_&&!p&&this.options.crossfade===!0&&!this.path.some(kX));this.animationProgress=0;let b;this.mixTargetDelta=v=>{const w=v/1e3;uR(h.x,o.x,w),uR(h.y,o.y,w),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(gd(d,this.layout.layoutBox,this.relativeParent.layout.layoutBox),CX(this.relativeTarget,this.relativeTargetOrigin,d,w),b&&aX(this.relativeTarget,b)&&(this.isProjectionDirty=!1),b||(b=rr()),os(b,this.relativeTarget)),_&&(this.animationValues=u,tX(u,c,this.latestValues,w,y,p)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=w},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(wa(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Mt.update(()=>{$g.hasAnimatedSinceResize=!0,this.currentAnimation=LB(0,aR,{...o,onUpdate:a=>{this.mixTargetDelta(a),o.onUpdate&&o.onUpdate(a)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(aR),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:a,target:l,layout:c,latestValues:u}=o;if(!(!a||!l||!c)){if(this!==o&&this.layout&&c&&BB(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||rr();const h=Jn(this.layout.layoutBox.x);l.x.min=o.target.x.min,l.x.max=l.x.min+h;const d=Jn(this.layout.layoutBox.y);l.y.min=o.target.y.min,l.y.max=l.y.min+d}os(a,l),jc(a,u),md(this.projectionDeltaWithTransform,this.layoutCorrected,a,u)}}registerSharedNode(o,a){this.sharedNodes.has(o)||this.sharedNodes.set(o,new lX),this.sharedNodes.get(o).add(a);const c=a.options.initialPromotionConfig;a.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(a):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:a,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),o&&(this.projectionDelta=void 0,this.needsReset=!0),a&&this.setOptions({transition:a})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let a=!1;const{latestValues:l}=o;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(a=!0),!a)return;const c={};l.z&&yv("z",o,c,this.animationValues);for(let u=0;u<_v.length;u++)yv(`rotate${_v[u]}`,o,c,this.animationValues),yv(`skew${_v[u]}`,o,c,this.animationValues);o.render();for(const u in c)o.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);o.scheduleRender()}getProjectionStyles(o){var a,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return fX;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=Hg(o?.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const _={};return this.options.layoutId&&(_.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,_.pointerEvents=Hg(o?.pointerEvents)||""),this.hasProjected&&!tl(this.latestValues)&&(_.transform=u?u({},""):"none",this.hasProjected=!1),_}const d=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=cX(this.projectionDeltaWithTransform,this.treeScale,d),u&&(c.transform=u(d,c.transform));const{x:f,y:g}=this.projectionDelta;c.transformOrigin=`${f.origin*100}% ${g.origin*100}% 0`,h.animationValues?c.opacity=h===this?(l=(a=d.opacity)!==null&&a!==void 0?a:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:c.opacity=h===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const _ in R0){if(d[_]===void 0)continue;const{correct:m,applyTo:p}=R0[_],y=c.transform==="none"?d[_]:m(d[_],h);if(p){const b=p.length;for(let v=0;v<b;v++)c[p[v]]=y}else c[_]=y}return this.options.layoutId&&(c.pointerEvents=h===this?Hg(o?.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var a;return(a=o.currentAnimation)===null||a===void 0?void 0:a.stop()}),this.root.nodes.forEach(lR),this.root.sharedNodes.clear()}}}function mX(t){t.updateLayout()}function gX(t){var e;const r=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&r&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=t.layout,{animationType:i}=t.options,o=r.source!==t.layout.source;i==="size"?ls(h=>{const d=o?r.measuredBox[h]:r.layoutBox[h],f=Jn(d);d.min=n[h].min,d.max=d.min+f}):BB(i,r.layoutBox,n)&&ls(h=>{const d=o?r.measuredBox[h]:r.layoutBox[h],f=Jn(n[h]);d.max=d.min+f,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+f)});const a=Bc();md(a,n,r.layoutBox);const l=Bc();o?md(l,t.applyTransform(s,!0),r.measuredBox):md(l,n,r.layoutBox);const c=!PB(a);let u=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:d,layout:f}=h;if(d&&f){const g=rr();gd(g,r.layoutBox,d.layoutBox);const _=rr();gd(_,n,f.layoutBox),OB(g,_)||(u=!0),h.options.layoutRoot&&(t.relativeTarget=_,t.relativeTargetOrigin=g,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:l,layoutDelta:a,hasLayoutChanged:c,hasRelativeTargetChanged:u})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function _X(t){Qh&&rl.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function yX(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function bX(t){t.clearSnapshot()}function lR(t){t.clearMeasurements()}function vX(t){t.isLayoutDirty=!1}function wX(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function cR(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function EX(t){t.resolveTargetDelta()}function xX(t){t.calcProjection()}function SX(t){t.resetSkewAndRotation()}function TX(t){t.removeLeadSnapshot()}function uR(t,e,r){t.translate=Xt(e.translate,0,r),t.scale=Xt(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function hR(t,e,r,n){t.min=Xt(e.min,r.min,n),t.max=Xt(e.max,r.max,n)}function CX(t,e,r,n){hR(t.x,e.x,r.x,n),hR(t.y,e.y,r.y,n)}function kX(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const AX={duration:.45,ease:[.4,0,.1,1]},dR=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),fR=dR("applewebkit/")&&!dR("chrome/")?Math.round:Jr;function pR(t){t.min=fR(t.min),t.max=fR(t.max)}function RX(t){pR(t.x),pR(t.y)}function BB(t,e,r){return t==="position"||t==="preserve-aspect"&&!OY(iR(e),iR(r),.2)}function IX(t){var e;return t!==t.root&&((e=t.scroll)===null||e===void 0?void 0:e.wasRoot)}const PX=MB({attachResizeListener:(t,e)=>ho(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),bv={current:void 0},FB=MB({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!bv.current){const t=new PX({});t.mount(window),t.setOptions({layoutScroll:!0}),bv.current=t}return bv.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),OX={pan:{Feature:KY},drag:{Feature:qY,ProjectionNode:FB,MeasureLayout:AB}};function mR(t,e){const r=e?"pointerenter":"pointerleave",n=e?"onHoverStart":"onHoverEnd",s=(i,o)=>{if(i.pointerType==="touch"||bB())return;const a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",e);const l=a[n];l&&Mt.postRender(()=>l(i,o))};return _o(t.current,r,s,{passive:!t.getProps()[n]})}class DX extends Ua{mount(){this.unmount=go(mR(this.node,!0),mR(this.node,!1))}unmount(){}}class LX extends Ua{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=go(ho(this.node.current,"focus",()=>this.onFocus()),ho(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const jB=(t,e)=>e?t===e?!0:jB(t,e.parentElement):!1;function vv(t,e){if(!e)return;const r=new PointerEvent("pointer"+t);e(r,Dy(r))}class NX extends Ua{constructor(){super(...arguments),this.removeStartListeners=Jr,this.removeEndListeners=Jr,this.removeAccessibleListeners=Jr,this.startPointerPress=(e,r)=>{if(this.isPressing)return;this.removeEndListeners();const n=this.node.getProps(),i=_o(window,"pointerup",(a,l)=>{if(!this.checkPressEnd())return;const{onTap:c,onTapCancel:u,globalTapTarget:h}=this.node.getProps(),d=!h&&!jB(this.node.current,a.target)?u:c;d&&Mt.update(()=>d(a,l))},{passive:!(n.onTap||n.onPointerUp)}),o=_o(window,"pointercancel",(a,l)=>this.cancelPress(a,l),{passive:!(n.onTapCancel||n.onPointerCancel)});this.removeEndListeners=go(i,o),this.startPress(e,r)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=a=>{a.key!=="Enter"||!this.checkPressEnd()||vv("up",(l,c)=>{const{onTap:u}=this.node.getProps();u&&Mt.postRender(()=>u(l,c))})};this.removeEndListeners(),this.removeEndListeners=ho(this.node.current,"keyup",o),vv("down",(a,l)=>{this.startPress(a,l)})},r=ho(this.node.current,"keydown",e),n=()=>{this.isPressing&&vv("cancel",(i,o)=>this.cancelPress(i,o))},s=ho(this.node.current,"blur",n);this.removeAccessibleListeners=go(r,s)}}startPress(e,r){this.isPressing=!0;const{onTapStart:n,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),n&&Mt.postRender(()=>n(e,r))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!bB()}cancelPress(e,r){if(!this.checkPressEnd())return;const{onTapCancel:n}=this.node.getProps();n&&Mt.postRender(()=>n(e,r))}mount(){const e=this.node.getProps(),r=_o(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),n=ho(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=go(r,n)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const iE=new WeakMap,wv=new WeakMap,MX=t=>{const e=iE.get(t.target);e&&e(t)},BX=t=>{t.forEach(MX)};function FX({root:t,...e}){const r=t||document;wv.has(r)||wv.set(r,{});const n=wv.get(r),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(BX,{root:t,...e})),n[s]}function jX(t,e,r){const n=FX(e);return iE.set(t,r),n.observe(t),()=>{iE.delete(t),n.unobserve(t)}}const UX={some:0,all:1};class $X extends Ua{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:i}=e,o={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:UX[s]},a=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:h}=this.node.getProps(),d=c?u:h;d&&d(l)};return jX(this.node.current,o,a)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(HX(e,r))&&this.startObserver()}unmount(){}}function HX({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const zX={inView:{Feature:$X},tap:{Feature:NX},focus:{Feature:LX},hover:{Feature:DX}},VX={layout:{ProjectionNode:FB,MeasureLayout:AB}},YT=I.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),Ny=I.createContext({}),XT=typeof window<"u",UB=XT?I.useLayoutEffect:I.useEffect,$B=I.createContext({strict:!1});function GX(t,e,r,n,s){var i,o;const{visualElement:a}=I.useContext(Ny),l=I.useContext($B),c=I.useContext(Ly),u=I.useContext(YT).reducedMotion,h=I.useRef();n=n||l.renderer,!h.current&&n&&(h.current=n(t,{visualState:e,parent:a,props:r,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const d=h.current,f=I.useContext(kB);d&&!d.projection&&s&&(d.type==="html"||d.type==="svg")&&WX(h.current,r,s,f);const g=I.useRef(!1);I.useInsertionEffect(()=>{d&&g.current&&d.update(r,c)});const _=r[hB],m=I.useRef(!!_&&!(!((i=window.MotionHandoffIsComplete)===null||i===void 0)&&i.call(window,_))&&((o=window.MotionHasOptimisedAnimation)===null||o===void 0?void 0:o.call(window,_)));return UB(()=>{d&&(g.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),KT.render(d.render),m.current&&d.animationState&&d.animationState.animateChanges())}),I.useEffect(()=>{d&&(!m.current&&d.animationState&&d.animationState.animateChanges(),m.current&&(queueMicrotask(()=>{var p;(p=window.MotionHandoffMarkAsComplete)===null||p===void 0||p.call(window,_)}),m.current=!1))}),d}function WX(t,e,r,n){const{layoutId:s,layout:i,drag:o,dragConstraints:a,layoutScroll:l,layoutRoot:c}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:HB(t.parent)),t.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!o||a&&Mc(a),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:n,layoutScroll:l,layoutRoot:c})}function HB(t){if(t)return t.options.allowProjection!==!1?t.projection:HB(t.parent)}function qX(t,e,r){return I.useCallback(n=>{n&&t.mount&&t.mount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):Mc(r)&&(r.current=n))},[e])}function My(t){return Ay(t.animate)||CT.some(e=>Wd(t[e]))}function zB(t){return!!(My(t)||t.variants)}function KX(t,e){if(My(t)){const{initial:r,animate:n}=t;return{initial:r===!1||Wd(r)?r:void 0,animate:Wd(n)?n:void 0}}return t.inherit!==!1?e:{}}function YX(t){const{initial:e,animate:r}=KX(t,I.useContext(Ny));return I.useMemo(()=>({initial:e,animate:r}),[gR(e),gR(r)])}function gR(t){return Array.isArray(t)?t.join(" "):t}const _R={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},yu={};for(const t in _R)yu[t]={isEnabled:e=>_R[t].some(r=>!!e[r])};function XX(t){for(const e in t)yu[e]={...yu[e],...t[e]}}const ZX=Symbol.for("motionComponentSymbol");function JX({preloadedFeatures:t,createVisualElement:e,useRender:r,useVisualState:n,Component:s}){t&&XX(t);function i(a,l){let c;const u={...I.useContext(YT),...a,layoutId:QX(a)},{isStatic:h}=u,d=YX(a),f=n(a,h);if(!h&&XT){eZ();const g=tZ(u);c=g.MeasureLayout,d.visualElement=GX(s,f,u,e,g.ProjectionNode)}return T.jsxs(Ny.Provider,{value:d,children:[c&&d.visualElement?T.jsx(c,{visualElement:d.visualElement,...u}):null,r(s,a,qX(f,d.visualElement,l),f,h,d.visualElement)]})}const o=I.forwardRef(i);return o[ZX]=s,o}function QX({layoutId:t}){const e=I.useContext(qT).id;return e&&t!==void 0?e+"-"+t:t}function eZ(t,e){I.useContext($B).strict}function tZ(t){const{drag:e,layout:r}=yu;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e?.isEnabled(t)||r?.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const rZ=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ZT(t){return typeof t!="string"||t.includes("-")?!1:!!(rZ.indexOf(t)>-1||/[A-Z]/u.test(t))}function VB(t,{style:e,vars:r},n,s){Object.assign(t.style,e,s&&s.getProjectionStyles(n));for(const i in r)t.style.setProperty(i,r[i])}const GB=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function WB(t,e,r,n){VB(t,e,void 0,n);for(const s in e.attrs)t.setAttribute(GB.has(s)?s:GT(s),e.attrs[s])}function qB(t,{layout:e,layoutId:r}){return nc.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!R0[t]||t==="opacity")}function JT(t,e,r){var n;const{style:s}=t,i={};for(const o in s)(Ar(s[o])||e.style&&Ar(e.style[o])||qB(o,t)||((n=r?.getValue(o))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(i[o]=s[o]);return i}function KB(t,e,r){const n=JT(t,e,r);for(const s in t)if(Ar(t[s])||Ar(e[s])){const i=bp.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[i]=t[s]}return n}function Xd(t){const e=I.useRef(null);return e.current===null&&(e.current=t()),e.current}function nZ({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:r},n,s,i){const o={latestValues:sZ(n,s,i,t),renderState:e()};return r&&(o.mount=a=>r(n,a,o)),o}const YB=t=>(e,r)=>{const n=I.useContext(Ny),s=I.useContext(Ly),i=()=>nZ(t,e,n,s);return r?i():Xd(i)};function sZ(t,e,r,n){const s={},i=n(t,{});for(const d in i)s[d]=Hg(i[d]);let{initial:o,animate:a}=t;const l=My(t),c=zB(t);e&&c&&!l&&t.inherit!==!1&&(o===void 0&&(o=e.initial),a===void 0&&(a=e.animate));let u=r?r.initial===!1:!1;u=u||o===!1;const h=u?a:o;if(h&&typeof h!="boolean"&&!Ay(h)){const d=Array.isArray(h)?h:[h];for(let f=0;f<d.length;f++){const g=ST(t,d[f]);if(g){const{transitionEnd:_,transition:m,...p}=g;for(const y in p){let b=p[y];if(Array.isArray(b)){const v=u?b.length-1:0;b=b[v]}b!==null&&(s[y]=b)}for(const y in _)s[y]=_[y]}}}return s}const QT=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),XB=()=>({...QT(),attrs:{}}),ZB=(t,e)=>e&&typeof t=="number"?e.transform(t):t,iZ={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},oZ=bp.length;function aZ(t,e,r){let n="",s=!0;for(let i=0;i<oZ;i++){const o=bp[i],a=t[o];if(a===void 0)continue;let l=!0;if(typeof a=="number"?l=a===(o.startsWith("scale")?1:0):l=parseFloat(a)===0,!l||r){const c=ZB(a,LT[o]);if(!l){s=!1;const u=iZ[o]||o;n+=`${u}(${c}) `}r&&(e[o]=c)}}return n=n.trim(),r?n=r(e,s?"":n):s&&(n="none"),n}function eC(t,e,r){const{style:n,vars:s,transformOrigin:i}=t;let o=!1,a=!1;for(const l in e){const c=e[l];if(nc.has(l)){o=!0;continue}else if(F3(l)){s[l]=c;continue}else{const u=ZB(c,LT[l]);l.startsWith("origin")?(a=!0,i[l]=u):n[l]=u}}if(e.transform||(o||r?n.transform=aZ(e,t.transform,r):n.transform&&(n.transform="none")),a){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;n.transformOrigin=`${l} ${c} ${u}`}}function yR(t,e,r){return typeof t=="string"?t:tt.transform(e+r*t)}function lZ(t,e,r){const n=yR(e,t.x,t.width),s=yR(r,t.y,t.height);return`${n} ${s}`}const cZ={offset:"stroke-dashoffset",array:"stroke-dasharray"},uZ={offset:"strokeDashoffset",array:"strokeDasharray"};function hZ(t,e,r=1,n=0,s=!0){t.pathLength=1;const i=s?cZ:uZ;t[i.offset]=tt.transform(-n);const o=tt.transform(e),a=tt.transform(r);t[i.array]=`${o} ${a}`}function tC(t,{attrX:e,attrY:r,attrScale:n,originX:s,originY:i,pathLength:o,pathSpacing:a=1,pathOffset:l=0,...c},u,h){if(eC(t,c,h),u){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:d,style:f,dimensions:g}=t;d.transform&&(g&&(f.transform=d.transform),delete d.transform),g&&(s!==void 0||i!==void 0||f.transform)&&(f.transformOrigin=lZ(g,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(d.x=e),r!==void 0&&(d.y=r),n!==void 0&&(d.scale=n),o!==void 0&&hZ(d,o,a,l,!1)}const rC=t=>typeof t=="string"&&t.toLowerCase()==="svg",dZ={useVisualState:YB({scrapeMotionValuesFromProps:KB,createRenderState:XB,onMount:(t,e,{renderState:r,latestValues:n})=>{Mt.read(()=>{try{r.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{r.dimensions={x:0,y:0,width:0,height:0}}}),Mt.render(()=>{tC(r,n,rC(e.tagName),t.transformTemplate),WB(e,r)})}})},fZ={useVisualState:YB({scrapeMotionValuesFromProps:JT,createRenderState:QT})};function JB(t,e,r){for(const n in e)!Ar(e[n])&&!qB(n,r)&&(t[n]=e[n])}function pZ({transformTemplate:t},e){return I.useMemo(()=>{const r=QT();return eC(r,e,t),Object.assign({},r.vars,r.style)},[e])}function mZ(t,e){const r=t.style||{},n={};return JB(n,r,t),Object.assign(n,pZ(t,e)),n}function gZ(t,e){const r={},n=mZ(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const _Z=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function I0(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||_Z.has(t)}let QB=t=>!I0(t);function yZ(t){t&&(QB=e=>e.startsWith("on")?!I0(e):t(e))}try{yZ(require("@emotion/is-prop-valid").default)}catch{}function bZ(t,e,r){const n={};for(const s in t)s==="values"&&typeof t.values=="object"||(QB(s)||r===!0&&I0(s)||!e&&!I0(s)||t.draggable&&s.startsWith("onDrag"))&&(n[s]=t[s]);return n}function vZ(t,e,r,n){const s=I.useMemo(()=>{const i=XB();return tC(i,e,rC(n),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};JB(i,t.style,t),s.style={...i,...s.style}}return s}function wZ(t=!1){return(r,n,s,{latestValues:i},o)=>{const l=(ZT(r)?vZ:gZ)(n,i,o,r),c=bZ(n,typeof r=="string",t),u=r!==I.Fragment?{...c,...l,ref:s}:{},{children:h}=n,d=I.useMemo(()=>Ar(h)?h.get():h,[h]);return I.createElement(r,{...u,children:d})}}function EZ(t,e){return function(n,{forwardMotionProps:s}={forwardMotionProps:!1}){const o={...ZT(n)?dZ:fZ,preloadedFeatures:t,useRender:wZ(s),createVisualElement:e,Component:n};return JX(o)}}const oE={current:null},e6={current:!1};function xZ(){if(e6.current=!0,!!XT)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>oE.current=t.matches;t.addListener(e),e()}else oE.current=!1}function SZ(t,e,r){for(const n in e){const s=e[n],i=r[n];if(Ar(s))t.addValue(n,s);else if(Ar(i))t.addValue(n,Yd(s,{owner:t}));else if(i!==s)if(t.hasValue(n)){const o=t.getValue(n);o.liveStyle===!0?o.jump(s):o.hasAnimated||o.set(s)}else{const o=t.getStaticValue(n);t.addValue(n,Yd(o!==void 0?o:s,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const bu=new WeakMap,TZ=[...$3,qr,Ea],CZ=t=>TZ.find(U3(t)),bR=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class t6{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:i,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=PT,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const d=Li.now();this.renderScheduledAt<d&&(this.renderScheduledAt=d,Mt.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=a,this.blockInitialAnimation=!!i,this.isControllingVariants=My(r),this.isVariantNode=zB(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...h}=this.scrapeMotionValuesFromProps(r,{},this);for(const d in h){const f=h[d];l[d]!==void 0&&Ar(f)&&f.set(l[d],!1)}}mount(e){this.current=e,bu.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),e6.current||xZ(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:oE.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){bu.delete(this.current),this.projection&&this.projection.unmount(),wa(this.notifyUpdate),wa(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=nc.has(e),s=r.on("change",a=>{this.latestValues[e]=a,this.props.onUpdate&&Mt.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),i=r.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{s(),i(),o&&o(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in yu){const r=yu[e];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[e]&&s&&n(this.props)&&(this.features[e]=new s(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):rr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<bR.length;n++){const s=bR[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,o=e[i];o&&(this.propEventSubscriptions[s]=this.on(s,o))}this.prevMotionValues=SZ(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=Yd(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){var n;let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(M3(s)||N3(s))?s=parseFloat(s):!CZ(s)&&Ea.test(r)&&(s=Y3(e,r)),this.setBaseTarget(e,Ar(s)?s.get():s)),Ar(s)?s.get():s}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var r;const{initial:n}=this.props;let s;if(typeof n=="string"||typeof n=="object"){const o=ST(this.props,n,(r=this.presenceContext)===null||r===void 0?void 0:r.custom);o&&(s=o[e])}if(n&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!Ar(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new VT),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}}class r6 extends t6{constructor(){super(...arguments),this.KeyframeResolver=X3}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}}function kZ(t){return window.getComputedStyle(t)}class n6 extends r6{constructor(){super(...arguments),this.type="html",this.renderInstance=VB}readValueFromInstance(e,r){if(nc.has(r)){const n=NT(r);return n&&n.default||0}else{const n=kZ(e),s=(F3(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:r}){return TB(e,r)}build(e,r,n){eC(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return JT(e,r,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Ar(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}class s6 extends r6{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=rr}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(nc.has(r)){const n=NT(r);return n&&n.default||0}return r=GB.has(r)?r:GT(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return KB(e,r,n)}build(e,r,n){tC(e,r,this.isSVGTag,n.transformTemplate)}renderInstance(e,r,n,s){WB(e,r,n,s)}mount(e){this.isSVGTag=rC(e.tagName),super.mount(e)}}const AZ=(t,e)=>ZT(t)?new s6(e):new n6(e,{allowProjection:t!==I.Fragment}),RZ=EZ({...xY,...zX,...OX,...VX},AZ),yr=Tq(RZ);class IZ extends I.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=r.offsetHeight||0,n.width=r.offsetWidth||0,n.top=r.offsetTop,n.left=r.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function PZ({children:t,isPresent:e}){const r=I.useId(),n=I.useRef(null),s=I.useRef({width:0,height:0,top:0,left:0}),{nonce:i}=I.useContext(YT);return I.useInsertionEffect(()=>{const{width:o,height:a,top:l,left:c}=s.current;if(e||!n.current||!o||!a)return;n.current.dataset.motionPopId=r;const u=document.createElement("style");return i&&(u.nonce=i),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${a}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),T.jsx(IZ,{isPresent:e,childRef:n,sizeRef:s,children:I.cloneElement(t,{ref:n})})}const OZ=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:i,mode:o})=>{const a=Xd(DZ),l=I.useId(),c=I.useCallback(h=>{a.set(h,!0);for(const d of a.values())if(!d)return;n&&n()},[a,n]),u=I.useMemo(()=>({id:l,initial:e,isPresent:r,custom:s,onExitComplete:c,register:h=>(a.set(h,!1),()=>a.delete(h))}),i?[Math.random(),c]:[r,c]);return I.useMemo(()=>{a.forEach((h,d)=>a.set(d,!1))},[r]),I.useEffect(()=>{!r&&!a.size&&n&&n()},[r]),o==="popLayout"&&(t=T.jsx(PZ,{isPresent:r,children:t})),T.jsx(Ly.Provider,{value:u,children:t})};function DZ(){return new Map}const vm=t=>t.key||"";function vR(t){const e=[];return I.Children.forEach(t,r=>{I.isValidElement(r)&&e.push(r)}),e}const Zd=({children:t,exitBeforeEnter:e,custom:r,initial:n=!0,onExitComplete:s,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const a=I.useMemo(()=>vR(t),[t]),l=a.map(vm),c=I.useRef(!0),u=I.useRef(a),h=Xd(()=>new Map),[d,f]=I.useState(a),[g,_]=I.useState(a);UB(()=>{c.current=!1,u.current=a;for(let y=0;y<g.length;y++){const b=vm(g[y]);l.includes(b)?h.delete(b):h.get(b)!==!0&&h.set(b,!1)}},[g,l.length,l.join("-")]);const m=[];if(a!==d){let y=[...a];for(let b=0;b<g.length;b++){const v=g[b],w=vm(v);l.includes(w)||(y.splice(b,0,v),m.push(v))}o==="wait"&&m.length&&(y=m),_(vR(y)),f(a);return}const{forceRender:p}=I.useContext(qT);return T.jsx(T.Fragment,{children:g.map(y=>{const b=vm(y),v=a===g||l.includes(b),w=()=>{if(h.has(b))h.set(b,!0);else return;let E=!0;h.forEach(S=>{S||(E=!1)}),E&&(p?.(),_(u.current),s&&s())};return T.jsx(OZ,{isPresent:v,initial:!c.current||n?void 0:!1,custom:v?void 0:r,presenceAffectsLayout:i,mode:o,onExitComplete:v?void 0:w,children:y},b)})})};function LZ(t,e,r){var n;if(typeof t=="string"){let s=document;e&&(E0(!!e.current),s=e.current),r?((n=r[t])!==null&&n!==void 0||(r[t]=s.querySelectorAll(t)),t=r[t]):t=s.querySelectorAll(t)}else t instanceof Element&&(t=[t]);return Array.from(t||[])}function NZ(t){return I.useEffect(()=>()=>t(),[])}function MZ(t,e=100,r){const n=r({...t,keyframes:[0,e]}),s=Math.min(MT(n),x0);return{type:"keyframes",ease:i=>n.next(s*i).value/e,duration:Oi(s)}}function nC(t){return typeof t=="object"&&!Array.isArray(t)}function i6(t,e,r,n){return typeof t=="string"&&nC(e)?LZ(t,r,n):t instanceof NodeList?Array.from(t):Array.isArray(t)?t:[t]}function wR(t,e,r,n){var s;return typeof e=="number"?e:e.startsWith("-")||e.startsWith("+")?Math.max(0,t+parseFloat(e)):e==="<"?r:(s=n.get(e))!==null&&s!==void 0?s:t}const BZ=(t,e,r)=>{const n=e-t;return((r-t)%n+n)%n+t};function FZ(t,e){return rB(t)?t[BZ(0,t.length,e)]:t}function jZ(t,e,r){for(let n=0;n<t.length;n++){const s=t[n];s.at>e&&s.at<r&&(Oy(t,s),n--)}}function UZ(t,e,r,n,s,i){jZ(t,s,i);for(let o=0;o<e.length;o++)t.push({value:e[o],at:Xt(s,i,n[o]),easing:FZ(r,o)})}function $Z(t,e){return t.at===e.at?t.value===null?1:e.value===null?-1:0:t.at-e.at}const HZ="easeInOut";function zZ(t,{defaultTransition:e={},...r}={},n,s){const i=e.duration||.3,o=new Map,a=new Map,l={},c=new Map;let u=0,h=0,d=0;for(let f=0;f<t.length;f++){const g=t[f];if(typeof g=="string"){c.set(g,h);continue}else if(!Array.isArray(g)){c.set(g.name,wR(h,g.at,u,c));continue}let[_,m,p={}]=g;p.at!==void 0&&(h=wR(h,p.at,u,c));let y=0;const b=(v,w,E,S=0,x=0)=>{const C=VZ(v),{delay:A=0,times:M=oB(C),type:P="keyframes",...D}=w;let{ease:R=e.ease||"easeOut",duration:G}=w;const ee=typeof A=="function"?A(S,x):A,q=C.length,re=Py(P)?P:s?.[P];if(q<=2&&re){let H=100;if(q===2&&qZ(C)){const ne=C[1]-C[0];H=Math.abs(ne)}const U={...D};G!==void 0&&(U.duration=Pi(G));const Q=MZ(U,H,re);R=Q.ease,G=Q.duration}G??(G=i);const N=h+ee,B=N+G;M.length===1&&M[0]===0&&(M[1]=1);const $=M.length-C.length;$>0&&iB(M,$),C.length===1&&C.unshift(null),UZ(E,C,R,M,N,B),y=Math.max(ee+G,y),d=Math.max(B,d)};if(Ar(_)){const v=ER(_,a);b(m,p,xR("default",v))}else{const v=i6(_,m,n,l),w=v.length;for(let E=0;E<w;E++){m=m,p=p;const S=v[E],x=ER(S,a);for(const C in m)b(m[C],GZ(p,C),xR(C,x),E,w)}}u=h,h+=y}return a.forEach((f,g)=>{for(const _ in f){const m=f[_];m.sort($Z);const p=[],y=[],b=[];for(let w=0;w<m.length;w++){const{at:E,value:S,easing:x}=m[w];p.push(S),y.push(Ll(0,d,E)),b.push(x||"easeOut")}y[0]!==0&&(y.unshift(0),p.unshift(p[0]),b.unshift(HZ)),y[y.length-1]!==1&&(y.push(1),p.push(null)),o.has(g)||o.set(g,{keyframes:{},transition:{}});const v=o.get(g);v.keyframes[_]=p,v.transition[_]={...e,duration:d,ease:b,times:y,...r}}}),o}function ER(t,e){return!e.has(t)&&e.set(t,{}),e.get(t)}function xR(t,e){return e[t]||(e[t]=[]),e[t]}function VZ(t){return Array.isArray(t)?t:[t]}function GZ(t,e){return t&&t[e]?{...t,...t[e]}:{...t}}const WZ=t=>typeof t=="number",qZ=t=>t.every(WZ);function KZ(t,e){return t in e}class YZ extends t6{constructor(){super(...arguments),this.type="object"}readValueFromInstance(e,r){if(KZ(r,e)){const n=e[r];if(typeof n=="string"||typeof n=="number")return n}}getBaseTargetFromProps(){}removeValueFromRenderState(e,r){delete r.output[e]}measureInstanceViewportBox(){return rr()}build(e,r){Object.assign(e.output,r)}renderInstance(e,{output:r}){Object.assign(e,r)}sortInstanceNodePosition(){return 0}}function XZ(t){const e={presenceContext:null,props:{},visualState:{renderState:{transform:{},transformOrigin:{},style:{},vars:{},attrs:{}},latestValues:{}}},r=DB(t)?new s6(e):new n6(e);r.mount(t),bu.set(t,r)}function ZZ(t){const e={presenceContext:null,props:{},visualState:{renderState:{output:{}},latestValues:{}}},r=new YZ(e);r.mount(t),bu.set(t,r)}function JZ(t,e){return Ar(t)||typeof t=="number"||typeof t=="string"&&!nC(e)}function o6(t,e,r,n){const s=[];if(JZ(t,e))s.push(LB(t,nC(e)&&e.default||e,r&&(r.default||r)));else{const i=i6(t,e,n),o=i.length;for(let a=0;a<o;a++){const l=i[a],c=l instanceof Element?XZ:ZZ;bu.has(l)||c(l);const u=bu.get(l),h={...r};"delay"in h&&typeof h.delay=="function"&&(h.delay=h.delay(a,o)),s.push(...WT(u,{...e,transition:h},{}))}}return s}function QZ(t,e,r){const n=[];return zZ(t,e,r,{spring:BT}).forEach(({keyframes:i,transition:o},a)=>{n.push(...o6(a,i,o))}),n}function eJ(t){return Array.isArray(t)&&Array.isArray(t[0])}function tJ(t){function e(r,n,s){let i=[];eJ(r)?i=QZ(r,n,t):i=o6(r,n,s,t);const o=new uB(i);return t&&t.animations.push(o),o}return e}function rJ(){const t=Xd(()=>({current:null,animations:[]})),e=Xd(()=>tJ(t));return NZ(()=>{t.animations.forEach(r=>r.stop())}),[t,e]}function a6(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=a6(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function oa(){for(var t,e,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=a6(t))&&(n&&(n+=" "),n+=e);return n}const Jd=t=>typeof t=="number"&&!isNaN(t),Sl=t=>typeof t=="string",Gn=t=>typeof t=="function",zg=t=>Sl(t)||Gn(t)?t:null,aE=t=>I.isValidElement(t)||Sl(t)||Gn(t)||Jd(t);function nJ(t,e,r){r===void 0&&(r=300);const{scrollHeight:n,style:s}=t;requestAnimationFrame(()=>{s.minHeight="initial",s.height=n+"px",s.transition=`all ${r}ms`,requestAnimationFrame(()=>{s.height="0",s.padding="0",s.margin="0",setTimeout(e,r)})})}function wp(t){let{enter:e,exit:r,appendPosition:n=!1,collapse:s=!0,collapseDuration:i=300}=t;return function(o){let{children:a,position:l,preventExitTransition:c,done:u,nodeRef:h,isIn:d,playToast:f}=o;const g=n?`${e}--${l}`:e,_=n?`${r}--${l}`:r,m=I.useRef(0);return I.useLayoutEffect(()=>{const p=h.current,y=g.split(" "),b=v=>{v.target===h.current&&(f(),p.removeEventListener("animationend",b),p.removeEventListener("animationcancel",b),m.current===0&&v.type!=="animationcancel"&&p.classList.remove(...y))};p.classList.add(...y),p.addEventListener("animationend",b),p.addEventListener("animationcancel",b)},[]),I.useEffect(()=>{const p=h.current,y=()=>{p.removeEventListener("animationend",y),s?nJ(p,u,i):u()};d||(c?y():(m.current=1,p.className+=` ${_}`,p.addEventListener("animationend",y)))},[d]),at.createElement(at.Fragment,null,a)}}function SR(t,e){return t!=null?{content:t.content,containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,status:e}:{}}const dn=new Map;let Qd=[];const lE=new Set,sJ=t=>lE.forEach(e=>e(t)),l6=()=>dn.size>0;function c6(t,e){var r;if(e)return!((r=dn.get(e))==null||!r.isToastActive(t));let n=!1;return dn.forEach(s=>{s.isToastActive(t)&&(n=!0)}),n}function u6(t,e){aE(t)&&(l6()||Qd.push({content:t,options:e}),dn.forEach(r=>{r.buildToast(t,e)}))}function TR(t,e){dn.forEach(r=>{e!=null&&e!=null&&e.containerId?e?.containerId===r.id&&r.toggle(t,e?.id):r.toggle(t,e?.id)})}function iJ(t){const{subscribe:e,getSnapshot:r,setProps:n}=I.useRef(function(i){const o=i.containerId||1;return{subscribe(a){const l=function(u,h,d){let f=1,g=0,_=[],m=[],p=[],y=h;const b=new Map,v=new Set,w=()=>{p=Array.from(b.values()),v.forEach(x=>x())},E=x=>{m=x==null?[]:m.filter(C=>C!==x),w()},S=x=>{const{toastId:C,onOpen:A,updateId:M,children:P}=x.props,D=M==null;x.staleId&&b.delete(x.staleId),b.set(C,x),m=[...m,x.props.toastId].filter(R=>R!==x.staleId),w(),d(SR(x,D?"added":"updated")),D&&Gn(A)&&A(I.isValidElement(P)&&P.props)};return{id:u,props:y,observe:x=>(v.add(x),()=>v.delete(x)),toggle:(x,C)=>{b.forEach(A=>{C!=null&&C!==A.props.toastId||Gn(A.toggle)&&A.toggle(x)})},removeToast:E,toasts:b,clearQueue:()=>{g-=_.length,_=[]},buildToast:(x,C)=>{if((H=>{let{containerId:U,toastId:Q,updateId:ne}=H;const ge=U?U!==u:u!==1,J=b.has(Q)&&ne==null;return ge||J})(C))return;const{toastId:A,updateId:M,data:P,staleId:D,delay:R}=C,G=()=>{E(A)},ee=M==null;ee&&g++;const q={...y,style:y.toastStyle,key:f++,...Object.fromEntries(Object.entries(C).filter(H=>{let[U,Q]=H;return Q!=null})),toastId:A,updateId:M,data:P,closeToast:G,isIn:!1,className:zg(C.className||y.toastClassName),bodyClassName:zg(C.bodyClassName||y.bodyClassName),progressClassName:zg(C.progressClassName||y.progressClassName),autoClose:!C.isLoading&&(re=C.autoClose,N=y.autoClose,re===!1||Jd(re)&&re>0?re:N),deleteToast(){const H=b.get(A),{onClose:U,children:Q}=H.props;Gn(U)&&U(I.isValidElement(Q)&&Q.props),d(SR(H,"removed")),b.delete(A),g--,g<0&&(g=0),_.length>0?S(_.shift()):w()}};var re,N;q.closeButton=y.closeButton,C.closeButton===!1||aE(C.closeButton)?q.closeButton=C.closeButton:C.closeButton===!0&&(q.closeButton=!aE(y.closeButton)||y.closeButton);let B=x;I.isValidElement(x)&&!Sl(x.type)?B=I.cloneElement(x,{closeToast:G,toastProps:q,data:P}):Gn(x)&&(B=x({closeToast:G,toastProps:q,data:P}));const $={content:B,props:q,staleId:D};y.limit&&y.limit>0&&g>y.limit&&ee?_.push($):Jd(R)?setTimeout(()=>{S($)},R):S($)},setProps(x){y=x},setToggle:(x,C)=>{b.get(x).toggle=C},isToastActive:x=>m.some(C=>C===x),getSnapshot:()=>p}}(o,i,sJ);dn.set(o,l);const c=l.observe(a);return Qd.forEach(u=>u6(u.content,u.options)),Qd=[],()=>{c(),dn.delete(o)}},setProps(a){var l;(l=dn.get(o))==null||l.setProps(a)},getSnapshot(){var a;return(a=dn.get(o))==null?void 0:a.getSnapshot()}}}(t)).current;n(t);const s=I.useSyncExternalStore(e,r,r);return{getToastToRender:function(i){if(!s)return[];const o=new Map;return t.newestOnTop&&s.reverse(),s.forEach(a=>{const{position:l}=a.props;o.has(l)||o.set(l,[]),o.get(l).push(a)}),Array.from(o,a=>i(a[0],a[1]))},isToastActive:c6,count:s?.length}}function oJ(t){const[e,r]=I.useState(!1),[n,s]=I.useState(!1),i=I.useRef(null),o=I.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:a,pauseOnHover:l,closeToast:c,onClick:u,closeOnClick:h}=t;var d,f;function g(){r(!0)}function _(){r(!1)}function m(b){const v=i.current;o.canDrag&&v&&(o.didMove=!0,e&&_(),o.delta=t.draggableDirection==="x"?b.clientX-o.start:b.clientY-o.start,o.start!==b.clientX&&(o.canCloseOnClick=!1),v.style.transform=`translate3d(${t.draggableDirection==="x"?`${o.delta}px, var(--y)`:`0, calc(${o.delta}px + var(--y))`},0)`,v.style.opacity=""+(1-Math.abs(o.delta/o.removalDistance)))}function p(){document.removeEventListener("pointermove",m),document.removeEventListener("pointerup",p);const b=i.current;if(o.canDrag&&o.didMove&&b){if(o.canDrag=!1,Math.abs(o.delta)>o.removalDistance)return s(!0),t.closeToast(),void t.collapseAll();b.style.transition="transform 0.2s, opacity 0.2s",b.style.removeProperty("transform"),b.style.removeProperty("opacity")}}(f=dn.get((d={id:t.toastId,containerId:t.containerId,fn:r}).containerId||1))==null||f.setToggle(d.id,d.fn),I.useEffect(()=>{if(t.pauseOnFocusLoss)return document.hasFocus()||_(),window.addEventListener("focus",g),window.addEventListener("blur",_),()=>{window.removeEventListener("focus",g),window.removeEventListener("blur",_)}},[t.pauseOnFocusLoss]);const y={onPointerDown:function(b){if(t.draggable===!0||t.draggable===b.pointerType){o.didMove=!1,document.addEventListener("pointermove",m),document.addEventListener("pointerup",p);const v=i.current;o.canCloseOnClick=!0,o.canDrag=!0,v.style.transition="none",t.draggableDirection==="x"?(o.start=b.clientX,o.removalDistance=v.offsetWidth*(t.draggablePercent/100)):(o.start=b.clientY,o.removalDistance=v.offsetHeight*(t.draggablePercent===80?1.5*t.draggablePercent:t.draggablePercent)/100)}},onPointerUp:function(b){const{top:v,bottom:w,left:E,right:S}=i.current.getBoundingClientRect();b.nativeEvent.type!=="touchend"&&t.pauseOnHover&&b.clientX>=E&&b.clientX<=S&&b.clientY>=v&&b.clientY<=w?_():g()}};return a&&l&&(y.onMouseEnter=_,t.stacked||(y.onMouseLeave=g)),h&&(y.onClick=b=>{u&&u(b),o.canCloseOnClick&&c()}),{playToast:g,pauseToast:_,isRunning:e,preventExitTransition:n,toastRef:i,eventHandlers:y}}function aJ(t){let{delay:e,isRunning:r,closeToast:n,type:s="default",hide:i,className:o,style:a,controlledProgress:l,progress:c,rtl:u,isIn:h,theme:d}=t;const f=i||l&&c===0,g={...a,animationDuration:`${e}ms`,animationPlayState:r?"running":"paused"};l&&(g.transform=`scaleX(${c})`);const _=oa("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${d}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":u}),m=Gn(o)?o({rtl:u,type:s,defaultClassName:_}):oa(_,o),p={[l&&c>=1?"onTransitionEnd":"onAnimationEnd"]:l&&c<1?null:()=>{h&&n()}};return at.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},at.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${d} Toastify__progress-bar--${s}`}),at.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:m,style:g,...p}))}let lJ=1;const h6=()=>""+lJ++;function cJ(t){return t&&(Sl(t.toastId)||Jd(t.toastId))?t.toastId:h6()}function _d(t,e){return u6(t,e),e.toastId}function P0(t,e){return{...e,type:e&&e.type||t,toastId:cJ(e)}}function wm(t){return(e,r)=>_d(e,P0(t,r))}function Ne(t,e){return _d(t,P0("default",e))}Ne.loading=(t,e)=>_d(t,P0("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e})),Ne.promise=function(t,e,r){let n,{pending:s,error:i,success:o}=e;s&&(n=Sl(s)?Ne.loading(s,r):Ne.loading(s.render,{...r,...s}));const a={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,h,d)=>{if(h==null)return void Ne.dismiss(n);const f={type:u,...a,...r,data:d},g=Sl(h)?{render:h}:h;return n?Ne.update(n,{...f,...g}):Ne(g.render,{...f,...g}),d},c=Gn(t)?t():t;return c.then(u=>l("success",o,u)).catch(u=>l("error",i,u)),c},Ne.success=wm("success"),Ne.info=wm("info"),Ne.error=wm("error"),Ne.warning=wm("warning"),Ne.warn=Ne.warning,Ne.dark=(t,e)=>_d(t,P0("default",{theme:"dark",...e})),Ne.dismiss=function(t){(function(e){var r;if(l6()){if(e==null||Sl(r=e)||Jd(r))dn.forEach(n=>{n.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){const n=dn.get(e.containerId);n?n.removeToast(e.id):dn.forEach(s=>{s.removeToast(e.id)})}}else Qd=Qd.filter(n=>e!=null&&n.options.toastId!==e)})(t)},Ne.clearWaitingQueue=function(t){t===void 0&&(t={}),dn.forEach(e=>{!e.props.limit||t.containerId&&e.id!==t.containerId||e.clearQueue()})},Ne.isActive=c6,Ne.update=function(t,e){e===void 0&&(e={});const r=((n,s)=>{var i;let{containerId:o}=s;return(i=dn.get(o||1))==null?void 0:i.toasts.get(n)})(t,e);if(r){const{props:n,content:s}=r,i={delay:100,...n,...e,toastId:e.toastId||t,updateId:h6()};i.toastId!==t&&(i.staleId=t);const o=i.render||s;delete i.render,_d(o,i)}},Ne.done=t=>{Ne.update(t,{progress:1})},Ne.onChange=function(t){return lE.add(t),()=>{lE.delete(t)}},Ne.play=t=>TR(!0,t),Ne.pause=t=>TR(!1,t);const uJ=typeof window<"u"?I.useLayoutEffect:I.useEffect,Em=t=>{let{theme:e,type:r,isLoading:n,...s}=t;return at.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:e==="colored"?"currentColor":`var(--toastify-icon-color-${r})`,...s})},Ev={info:function(t){return at.createElement(Em,{...t},at.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))},warning:function(t){return at.createElement(Em,{...t},at.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))},success:function(t){return at.createElement(Em,{...t},at.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))},error:function(t){return at.createElement(Em,{...t},at.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))},spinner:function(){return at.createElement("div",{className:"Toastify__spinner"})}},hJ=t=>{const{isRunning:e,preventExitTransition:r,toastRef:n,eventHandlers:s,playToast:i}=oJ(t),{closeButton:o,children:a,autoClose:l,onClick:c,type:u,hideProgressBar:h,closeToast:d,transition:f,position:g,className:_,style:m,bodyClassName:p,bodyStyle:y,progressClassName:b,progressStyle:v,updateId:w,role:E,progress:S,rtl:x,toastId:C,deleteToast:A,isIn:M,isLoading:P,closeOnClick:D,theme:R}=t,G=oa("Toastify__toast",`Toastify__toast-theme--${R}`,`Toastify__toast--${u}`,{"Toastify__toast--rtl":x},{"Toastify__toast--close-on-click":D}),ee=Gn(_)?_({rtl:x,position:g,type:u,defaultClassName:G}):oa(G,_),q=function($){let{theme:H,type:U,isLoading:Q,icon:ne}=$,ge=null;const J={theme:H,type:U};return ne===!1||(Gn(ne)?ge=ne({...J,isLoading:Q}):I.isValidElement(ne)?ge=I.cloneElement(ne,J):Q?ge=Ev.spinner():(V=>V in Ev)(U)&&(ge=Ev[U](J))),ge}(t),re=!!S||!l,N={closeToast:d,type:u,theme:R};let B=null;return o===!1||(B=Gn(o)?o(N):I.isValidElement(o)?I.cloneElement(o,N):function($){let{closeToast:H,theme:U,ariaLabel:Q="close"}=$;return at.createElement("button",{className:`Toastify__close-button Toastify__close-button--${U}`,type:"button",onClick:ne=>{ne.stopPropagation(),H(ne)},"aria-label":Q},at.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},at.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}(N)),at.createElement(f,{isIn:M,done:A,position:g,preventExitTransition:r,nodeRef:n,playToast:i},at.createElement("div",{id:C,onClick:c,"data-in":M,className:ee,...s,style:m,ref:n},at.createElement("div",{...M&&{role:E},className:Gn(p)?p({type:u}):oa("Toastify__toast-body",p),style:y},q!=null&&at.createElement("div",{className:oa("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!P})},q),at.createElement("div",null,a)),B,at.createElement(aJ,{...w&&!re?{key:`pb-${w}`}:{},rtl:x,theme:R,delay:l,isRunning:e,isIn:M,closeToast:d,hide:h,type:u,style:v,className:b,controlledProgress:re,progress:S||0})))},By=function(t,e){return e===void 0&&(e=!1),{enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}},dJ=wp(By("bounce",!0));wp(By("slide",!0));wp(By("zoom"));wp(By("flip"));const fJ={position:"top-right",transition:dJ,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light"};function pJ(t){let e={...fJ,...t};const r=t.stacked,[n,s]=I.useState(!0),i=I.useRef(null),{getToastToRender:o,isToastActive:a,count:l}=iJ(e),{className:c,style:u,rtl:h,containerId:d}=e;function f(_){const m=oa("Toastify__toast-container",`Toastify__toast-container--${_}`,{"Toastify__toast-container--rtl":h});return Gn(c)?c({position:_,rtl:h,defaultClassName:m}):oa(m,zg(c))}function g(){r&&(s(!0),Ne.play())}return uJ(()=>{if(r){var _;const m=i.current.querySelectorAll('[data-in="true"]'),p=12,y=(_=e.position)==null?void 0:_.includes("top");let b=0,v=0;Array.from(m).reverse().forEach((w,E)=>{const S=w;S.classList.add("Toastify__toast--stacked"),E>0&&(S.dataset.collapsed=`${n}`),S.dataset.pos||(S.dataset.pos=y?"top":"bot");const x=b*(n?.2:1)+(n?0:p*E);S.style.setProperty("--y",`${y?x:-1*x}px`),S.style.setProperty("--g",`${p}`),S.style.setProperty("--s",""+(1-(n?v:0))),b+=S.offsetHeight,v+=.025})}},[n,l,r]),at.createElement("div",{ref:i,className:"Toastify",id:d,onMouseEnter:()=>{r&&(s(!1),Ne.pause())},onMouseLeave:g},o((_,m)=>{const p=m.length?{...u}:{...u,pointerEvents:"none"};return at.createElement("div",{className:f(_),style:p,key:`container-${_}`},m.map(y=>{let{content:b,props:v}=y;return at.createElement(hJ,{...v,stacked:r,collapseAll:g,isIn:a(v.toastId,v.containerId),style:v.style,key:`toast-${v.key}`},b)}))}))}function et(t,e,{checkForDefaultPrevented:r=!0}={}){return function(s){if(t?.(s),r===!1||!s.defaultPrevented)return e?.(s)}}function mJ(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function Fy(...t){return e=>t.forEach(r=>mJ(r,e))}function gr(...t){return I.useCallback(Fy(...t),t)}function gJ(t,e){const r=I.createContext(e),n=i=>{const{children:o,...a}=i,l=I.useMemo(()=>a,Object.values(a));return T.jsx(r.Provider,{value:l,children:o})};n.displayName=t+"Provider";function s(i){const o=I.useContext(r);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[n,s]}function Ju(t,e=[]){let r=[];function n(i,o){const a=I.createContext(o),l=r.length;r=[...r,o];const c=h=>{const{scope:d,children:f,...g}=h,_=d?.[t]?.[l]||a,m=I.useMemo(()=>g,Object.values(g));return T.jsx(_.Provider,{value:m,children:f})};c.displayName=i+"Provider";function u(h,d){const f=d?.[t]?.[l]||a,g=I.useContext(f);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=r.map(o=>I.createContext(o));return function(a){const l=a?.[t]||i;return I.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[n,_J(s,...e)]}function _J(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=n.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return I.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return r.scopeName=e.scopeName,r}var Nl=globalThis?.document?I.useLayoutEffect:()=>{},yJ=wT.useId||(()=>{}),bJ=0;function Tl(t){const[e,r]=I.useState(yJ());return Nl(()=>{r(n=>n??String(bJ++))},[t]),e?`radix-${e}`:""}function xs(t){const e=I.useRef(t);return I.useEffect(()=>{e.current=t}),I.useMemo(()=>(...r)=>e.current?.(...r),[])}function Ep({prop:t,defaultProp:e,onChange:r=()=>{}}){const[n,s]=vJ({defaultProp:e,onChange:r}),i=t!==void 0,o=i?t:n,a=xs(r),l=I.useCallback(c=>{if(i){const h=typeof c=="function"?c(t):c;h!==t&&a(h)}else s(c)},[i,t,s,a]);return[o,l]}function vJ({defaultProp:t,onChange:e}){const r=I.useState(t),[n]=r,s=I.useRef(n),i=xs(e);return I.useEffect(()=>{s.current!==n&&(i(n),s.current=n)},[n,s,i]),r}var vu=I.forwardRef((t,e)=>{const{children:r,...n}=t,s=I.Children.toArray(r),i=s.find(wJ);if(i){const o=i.props.children,a=s.map(l=>l===i?I.Children.count(o)>1?I.Children.only(null):I.isValidElement(o)?o.props.children:null:l);return T.jsx(cE,{...n,ref:e,children:I.isValidElement(o)?I.cloneElement(o,void 0,a):null})}return T.jsx(cE,{...n,ref:e,children:r})});vu.displayName="Slot";var cE=I.forwardRef((t,e)=>{const{children:r,...n}=t;if(I.isValidElement(r)){const s=xJ(r);return I.cloneElement(r,{...EJ(n,r.props),ref:e?Fy(e,s):s})}return I.Children.count(r)>1?I.Children.only(null):null});cE.displayName="SlotClone";var d6=({children:t})=>T.jsx(T.Fragment,{children:t});function wJ(t){return I.isValidElement(t)&&t.type===d6}function EJ(t,e){const r={...e};for(const n in e){const s=t[n],i=e[n];/^on[A-Z]/.test(n)?s&&i?r[n]=(...a)=>{i(...a),s(...a)}:s&&(r[n]=s):n==="style"?r[n]={...s,...i}:n==="className"&&(r[n]=[s,i].filter(Boolean).join(" "))}return{...t,...r}}function xJ(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var SJ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Gt=SJ.reduce((t,e)=>{const r=I.forwardRef((n,s)=>{const{asChild:i,...o}=n,a=i?vu:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),T.jsx(a,{...o,ref:s})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function f6(t,e){t&&E3.flushSync(()=>t.dispatchEvent(e))}function TJ(t,e=globalThis?.document){const r=xs(t);I.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[r,e])}var CJ="DismissableLayer",uE="dismissableLayer.update",kJ="dismissableLayer.pointerDownOutside",AJ="dismissableLayer.focusOutside",CR,p6=I.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),jy=I.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=I.useContext(p6),[u,h]=I.useState(null),d=u?.ownerDocument??globalThis?.document,[,f]=I.useState({}),g=gr(e,S=>h(S)),_=Array.from(c.layers),[m]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),p=_.indexOf(m),y=u?_.indexOf(u):-1,b=c.layersWithOutsidePointerEventsDisabled.size>0,v=y>=p,w=PJ(S=>{const x=S.target,C=[...c.branches].some(A=>A.contains(x));!v||C||(s?.(S),o?.(S),S.defaultPrevented||a?.())},d),E=OJ(S=>{const x=S.target;[...c.branches].some(A=>A.contains(x))||(i?.(S),o?.(S),S.defaultPrevented||a?.())},d);return TJ(S=>{y===c.layers.size-1&&(n?.(S),!S.defaultPrevented&&a&&(S.preventDefault(),a()))},d),I.useEffect(()=>{if(u)return r&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(CR=d.body.style.pointerEvents,d.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),kR(),()=>{r&&c.layersWithOutsidePointerEventsDisabled.size===1&&(d.body.style.pointerEvents=CR)}},[u,d,r,c]),I.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),kR())},[u,c]),I.useEffect(()=>{const S=()=>f({});return document.addEventListener(uE,S),()=>document.removeEventListener(uE,S)},[]),T.jsx(Gt.div,{...l,ref:g,style:{pointerEvents:b?v?"auto":"none":void 0,...t.style},onFocusCapture:et(t.onFocusCapture,E.onFocusCapture),onBlurCapture:et(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:et(t.onPointerDownCapture,w.onPointerDownCapture)})});jy.displayName=CJ;var RJ="DismissableLayerBranch",IJ=I.forwardRef((t,e)=>{const r=I.useContext(p6),n=I.useRef(null),s=gr(e,n);return I.useEffect(()=>{const i=n.current;if(i)return r.branches.add(i),()=>{r.branches.delete(i)}},[r.branches]),T.jsx(Gt.div,{...t,ref:s})});IJ.displayName=RJ;function PJ(t,e=globalThis?.document){const r=xs(t),n=I.useRef(!1),s=I.useRef(()=>{});return I.useEffect(()=>{const i=a=>{if(a.target&&!n.current){let l=function(){m6(kJ,r,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);n.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,r]),{onPointerDownCapture:()=>n.current=!0}}function OJ(t,e=globalThis?.document){const r=xs(t),n=I.useRef(!1);return I.useEffect(()=>{const s=i=>{i.target&&!n.current&&m6(AJ,r,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function kR(){const t=new CustomEvent(uE);document.dispatchEvent(t)}function m6(t,e,r,{discrete:n}){const s=r.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&s.addEventListener(t,e,{once:!0}),n?f6(s,i):s.dispatchEvent(i)}var xv="focusScope.autoFocusOnMount",Sv="focusScope.autoFocusOnUnmount",AR={bubbles:!1,cancelable:!0},DJ="FocusScope",sC=I.forwardRef((t,e)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[a,l]=I.useState(null),c=xs(s),u=xs(i),h=I.useRef(null),d=gr(e,_=>l(_)),f=I.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;I.useEffect(()=>{if(n){let _=function(b){if(f.paused||!a)return;const v=b.target;a.contains(v)?h.current=v:zo(h.current,{select:!0})},m=function(b){if(f.paused||!a)return;const v=b.relatedTarget;v!==null&&(a.contains(v)||zo(h.current,{select:!0}))},p=function(b){if(document.activeElement===document.body)for(const w of b)w.removedNodes.length>0&&zo(a)};document.addEventListener("focusin",_),document.addEventListener("focusout",m);const y=new MutationObserver(p);return a&&y.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",_),document.removeEventListener("focusout",m),y.disconnect()}}},[n,a,f.paused]),I.useEffect(()=>{if(a){IR.add(f);const _=document.activeElement;if(!a.contains(_)){const p=new CustomEvent(xv,AR);a.addEventListener(xv,c),a.dispatchEvent(p),p.defaultPrevented||(LJ(jJ(g6(a)),{select:!0}),document.activeElement===_&&zo(a))}return()=>{a.removeEventListener(xv,c),setTimeout(()=>{const p=new CustomEvent(Sv,AR);a.addEventListener(Sv,u),a.dispatchEvent(p),p.defaultPrevented||zo(_??document.body,{select:!0}),a.removeEventListener(Sv,u),IR.remove(f)},0)}}},[a,c,u,f]);const g=I.useCallback(_=>{if(!r&&!n||f.paused)return;const m=_.key==="Tab"&&!_.altKey&&!_.ctrlKey&&!_.metaKey,p=document.activeElement;if(m&&p){const y=_.currentTarget,[b,v]=NJ(y);b&&v?!_.shiftKey&&p===v?(_.preventDefault(),r&&zo(b,{select:!0})):_.shiftKey&&p===b&&(_.preventDefault(),r&&zo(v,{select:!0})):p===y&&_.preventDefault()}},[r,n,f.paused]);return T.jsx(Gt.div,{tabIndex:-1,...o,ref:d,onKeyDown:g})});sC.displayName=DJ;function LJ(t,{select:e=!1}={}){const r=document.activeElement;for(const n of t)if(zo(n,{select:e}),document.activeElement!==r)return}function NJ(t){const e=g6(t),r=RR(e,t),n=RR(e.reverse(),t);return[r,n]}function g6(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function RR(t,e){for(const r of t)if(!MJ(r,{upTo:e}))return r}function MJ(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function BJ(t){return t instanceof HTMLInputElement&&"select"in t}function zo(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&BJ(t)&&e&&t.select()}}var IR=FJ();function FJ(){let t=[];return{add(e){const r=t[0];e!==r&&r?.pause(),t=PR(t,e),t.unshift(e)},remove(e){t=PR(t,e),t[0]?.resume()}}}function PR(t,e){const r=[...t],n=r.indexOf(e);return n!==-1&&r.splice(n,1),r}function jJ(t){return t.filter(e=>e.tagName!=="A")}var UJ="Portal",Uy=I.forwardRef((t,e)=>{const{container:r,...n}=t,[s,i]=I.useState(!1);Nl(()=>i(!0),[]);const o=r||s&&globalThis?.document?.body;return o?hq.createPortal(T.jsx(Gt.div,{...n,ref:e}),o):null});Uy.displayName=UJ;function $J(t,e){return I.useReducer((r,n)=>e[r][n]??r,t)}var Hi=t=>{const{present:e,children:r}=t,n=HJ(e),s=typeof r=="function"?r({present:n.isPresent}):I.Children.only(r),i=gr(n.ref,zJ(s));return typeof r=="function"||n.isPresent?I.cloneElement(s,{ref:i}):null};Hi.displayName="Presence";function HJ(t){const[e,r]=I.useState(),n=I.useRef({}),s=I.useRef(t),i=I.useRef("none"),o=t?"mounted":"unmounted",[a,l]=$J(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return I.useEffect(()=>{const c=xm(n.current);i.current=a==="mounted"?c:"none"},[a]),Nl(()=>{const c=n.current,u=s.current;if(u!==t){const d=i.current,f=xm(c);t?l("MOUNT"):f==="none"||c?.display==="none"?l("UNMOUNT"):l(u&&d!==f?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),Nl(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,h=f=>{const _=xm(n.current).includes(f.animationName);if(f.target===e&&_&&(l("ANIMATION_END"),!s.current)){const m=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=m)})}},d=f=>{f.target===e&&(i.current=xm(n.current))};return e.addEventListener("animationstart",d),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",d),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:I.useCallback(c=>{c&&(n.current=getComputedStyle(c)),r(c)},[])}}function xm(t){return t?.animationName||"none"}function zJ(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Tv=0;function _6(){I.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??OR()),document.body.insertAdjacentElement("beforeend",t[1]??OR()),Tv++,()=>{Tv===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Tv--}},[])}function OR(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var _i=function(){return _i=Object.assign||function(e){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},_i.apply(this,arguments)};function y6(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(t);s<n.length;s++)e.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(t,n[s])&&(r[n[s]]=t[n[s]]);return r}function VJ(t,e,r,n){function s(i){return i instanceof r?i:new r(function(o){o(i)})}return new(r||(r=Promise))(function(i,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((n=n.apply(t,e||[])).next())})}function GJ(t,e){var r={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=a(0),o.throw=a(1),o.return=a(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(c){return function(u){return l([c,u])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(r=0)),r;)try{if(n=1,s&&(i=c[0]&2?s.return:c[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,c[1])).done)return i;switch(s=0,i&&(c=[c[0]&2,i.value]),c[0]){case 0:case 1:i=c;break;case 4:return r.label++,{value:c[1],done:!1};case 5:r.label++,s=c[1],c=[0];continue;case 7:c=r.ops.pop(),r.trys.pop();continue;default:if(i=r.trys,!(i=i.length>0&&i[i.length-1])&&(c[0]===6||c[0]===2)){r=0;continue}if(c[0]===3&&(!i||c[1]>i[0]&&c[1]<i[3])){r.label=c[1];break}if(c[0]===6&&r.label<i[1]){r.label=i[1],i=c;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(c);break}i[2]&&r.ops.pop(),r.trys.pop();continue}c=e.call(t,r)}catch(u){c=[6,u],s=0}finally{n=i=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function WJ(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qJ(t,e,r){if(r||arguments.length===2)for(var n=0,s=e.length,i;n<s;n++)(i||!(n in e))&&(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}var Vg="right-scroll-bar-position",Gg="width-before-scroll-bar",KJ="with-scroll-bars-hidden",YJ="--removed-body-scroll-bar-size";function Cv(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function XJ(t,e){var r=I.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=e,r.facade}var ZJ=typeof window<"u"?I.useLayoutEffect:I.useEffect,DR=new WeakMap;function JJ(t,e){var r=XJ(null,function(n){return t.forEach(function(s){return Cv(s,n)})});return ZJ(function(){var n=DR.get(r);if(n){var s=new Set(n),i=new Set(t),o=r.current;s.forEach(function(a){i.has(a)||Cv(a,null)}),i.forEach(function(a){s.has(a)||Cv(a,o)})}DR.set(r,t)},[t]),r}function QJ(t){return t}function eQ(t,e){e===void 0&&(e=QJ);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(i){var o=e(i,n);return r.push(o),function(){r=r.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(n=!0;r.length;){var o=r;r=[],o.forEach(i)}r={push:function(a){return i(a)},filter:function(){return r}}},assignMedium:function(i){n=!0;var o=[];if(r.length){var a=r;r=[],a.forEach(i),o=r}var l=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),r={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),r}}}};return s}function tQ(t){t===void 0&&(t={});var e=eQ(null);return e.options=_i({async:!0,ssr:!1},t),e}var b6=function(t){var e=t.sideCar,r=y6(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return I.createElement(n,_i({},r))};b6.isSideCarExport=!0;function rQ(t,e){return t.useMedium(e),b6}var v6=tQ(),kv=function(){},$y=I.forwardRef(function(t,e){var r=I.useRef(null),n=I.useState({onScrollCapture:kv,onWheelCapture:kv,onTouchMoveCapture:kv}),s=n[0],i=n[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,h=t.shards,d=t.sideCar,f=t.noIsolation,g=t.inert,_=t.allowPinchZoom,m=t.as,p=m===void 0?"div":m,y=t.gapMode,b=y6(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),v=d,w=JJ([r,e]),E=_i(_i({},b),s);return I.createElement(I.Fragment,null,u&&I.createElement(v,{sideCar:v6,removeScrollBar:c,shards:h,noIsolation:f,inert:g,setCallbacks:i,allowPinchZoom:!!_,lockRef:r,gapMode:y}),o?I.cloneElement(I.Children.only(a),_i(_i({},E),{ref:w})):I.createElement(p,_i({},E,{className:l,ref:w}),a))});$y.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};$y.classNames={fullWidth:Gg,zeroRight:Vg};var nQ=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function sQ(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=nQ();return e&&t.setAttribute("nonce",e),t}function iQ(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function oQ(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var aQ=function(){var t=0,e=null;return{add:function(r){t==0&&(e=sQ())&&(iQ(e,r),oQ(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},lQ=function(){var t=aQ();return function(e,r){I.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},w6=function(){var t=lQ(),e=function(r){var n=r.styles,s=r.dynamic;return t(n,s),null};return e},cQ={left:0,top:0,right:0,gap:0},Av=function(t){return parseInt(t||"",10)||0},uQ=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],n=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[Av(r),Av(n),Av(s)]},hQ=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return cQ;var e=uQ(t),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-r+e[2]-e[0])}},dQ=w6(),Xc="data-scroll-locked",fQ=function(t,e,r,n){var s=t.left,i=t.top,o=t.right,a=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(KJ,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(a,"px ").concat(n,`;
  }
  body[`).concat(Xc,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(a,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Vg,` {
    right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(Gg,` {
    margin-right: `).concat(a,"px ").concat(n,`;
  }
  
  .`).concat(Vg," .").concat(Vg,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(Gg," .").concat(Gg,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Xc,`] {
    `).concat(YJ,": ").concat(a,`px;
  }
`)},LR=function(){var t=parseInt(document.body.getAttribute(Xc)||"0",10);return isFinite(t)?t:0},pQ=function(){I.useEffect(function(){return document.body.setAttribute(Xc,(LR()+1).toString()),function(){var t=LR()-1;t<=0?document.body.removeAttribute(Xc):document.body.setAttribute(Xc,t.toString())}},[])},mQ=function(t){var e=t.noRelative,r=t.noImportant,n=t.gapMode,s=n===void 0?"margin":n;pQ();var i=I.useMemo(function(){return hQ(s)},[s]);return I.createElement(dQ,{styles:fQ(i,!e,s,r?"":"!important")})},hE=!1;if(typeof window<"u")try{var Sm=Object.defineProperty({},"passive",{get:function(){return hE=!0,!0}});window.addEventListener("test",Sm,Sm),window.removeEventListener("test",Sm,Sm)}catch{hE=!1}var pc=hE?{passive:!1}:!1,gQ=function(t){return t.tagName==="TEXTAREA"},E6=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!gQ(t)&&r[e]==="visible")},_Q=function(t){return E6(t,"overflowY")},yQ=function(t){return E6(t,"overflowX")},NR=function(t,e){var r=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=x6(t,n);if(s){var i=S6(t,n),o=i[1],a=i[2];if(o>a)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},bQ=function(t){var e=t.scrollTop,r=t.scrollHeight,n=t.clientHeight;return[e,r,n]},vQ=function(t){var e=t.scrollLeft,r=t.scrollWidth,n=t.clientWidth;return[e,r,n]},x6=function(t,e){return t==="v"?_Q(e):yQ(e)},S6=function(t,e){return t==="v"?bQ(e):vQ(e)},wQ=function(t,e){return t==="h"&&e==="rtl"?-1:1},EQ=function(t,e,r,n,s){var i=wQ(t,window.getComputedStyle(e).direction),o=i*n,a=r.target,l=e.contains(a),c=!1,u=o>0,h=0,d=0;do{var f=S6(t,a),g=f[0],_=f[1],m=f[2],p=_-m-i*g;(g||p)&&x6(t,a)&&(h+=p,d+=g),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(Math.abs(h)<1||!s)||!u&&(Math.abs(d)<1||!s))&&(c=!0),c},Tm=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},MR=function(t){return[t.deltaX,t.deltaY]},BR=function(t){return t&&"current"in t?t.current:t},xQ=function(t,e){return t[0]===e[0]&&t[1]===e[1]},SQ=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},TQ=0,mc=[];function CQ(t){var e=I.useRef([]),r=I.useRef([0,0]),n=I.useRef(),s=I.useState(TQ++)[0],i=I.useState(w6)[0],o=I.useRef(t);I.useEffect(function(){o.current=t},[t]),I.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var _=qJ([t.lockRef.current],(t.shards||[]).map(BR),!0).filter(Boolean);return _.forEach(function(m){return m.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),_.forEach(function(m){return m.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var a=I.useCallback(function(_,m){if("touches"in _&&_.touches.length===2||_.type==="wheel"&&_.ctrlKey)return!o.current.allowPinchZoom;var p=Tm(_),y=r.current,b="deltaX"in _?_.deltaX:y[0]-p[0],v="deltaY"in _?_.deltaY:y[1]-p[1],w,E=_.target,S=Math.abs(b)>Math.abs(v)?"h":"v";if("touches"in _&&S==="h"&&E.type==="range")return!1;var x=NR(S,E);if(!x)return!0;if(x?w=S:(w=S==="v"?"h":"v",x=NR(S,E)),!x)return!1;if(!n.current&&"changedTouches"in _&&(b||v)&&(n.current=w),!w)return!0;var C=n.current||w;return EQ(C,m,_,C==="h"?b:v,!0)},[]),l=I.useCallback(function(_){var m=_;if(!(!mc.length||mc[mc.length-1]!==i)){var p="deltaY"in m?MR(m):Tm(m),y=e.current.filter(function(w){return w.name===m.type&&(w.target===m.target||m.target===w.shadowParent)&&xQ(w.delta,p)})[0];if(y&&y.should){m.cancelable&&m.preventDefault();return}if(!y){var b=(o.current.shards||[]).map(BR).filter(Boolean).filter(function(w){return w.contains(m.target)}),v=b.length>0?a(m,b[0]):!o.current.noIsolation;v&&m.cancelable&&m.preventDefault()}}},[]),c=I.useCallback(function(_,m,p,y){var b={name:_,delta:m,target:p,should:y,shadowParent:kQ(p)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(v){return v!==b})},1)},[]),u=I.useCallback(function(_){r.current=Tm(_),n.current=void 0},[]),h=I.useCallback(function(_){c(_.type,MR(_),_.target,a(_,t.lockRef.current))},[]),d=I.useCallback(function(_){c(_.type,Tm(_),_.target,a(_,t.lockRef.current))},[]);I.useEffect(function(){return mc.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:d}),document.addEventListener("wheel",l,pc),document.addEventListener("touchmove",l,pc),document.addEventListener("touchstart",u,pc),function(){mc=mc.filter(function(_){return _!==i}),document.removeEventListener("wheel",l,pc),document.removeEventListener("touchmove",l,pc),document.removeEventListener("touchstart",u,pc)}},[]);var f=t.removeScrollBar,g=t.inert;return I.createElement(I.Fragment,null,g?I.createElement(i,{styles:SQ(s)}):null,f?I.createElement(mQ,{gapMode:t.gapMode}):null)}function kQ(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const AQ=rQ(v6,CQ);var iC=I.forwardRef(function(t,e){return I.createElement($y,_i({},t,{ref:e,sideCar:AQ}))});iC.classNames=$y.classNames;var RQ=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},gc=new WeakMap,Cm=new WeakMap,km={},Rv=0,T6=function(t){return t&&(t.host||T6(t.parentNode))},IQ=function(t,e){return e.map(function(r){if(t.contains(r))return r;var n=T6(r);return n&&t.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},PQ=function(t,e,r,n){var s=IQ(e,Array.isArray(t)?t:[t]);km[r]||(km[r]=new WeakMap);var i=km[r],o=[],a=new Set,l=new Set(s),c=function(h){!h||a.has(h)||(a.add(h),c(h.parentNode))};s.forEach(c);var u=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(d){if(a.has(d))u(d);else try{var f=d.getAttribute(n),g=f!==null&&f!=="false",_=(gc.get(d)||0)+1,m=(i.get(d)||0)+1;gc.set(d,_),i.set(d,m),o.push(d),_===1&&g&&Cm.set(d,!0),m===1&&d.setAttribute(r,"true"),g||d.setAttribute(n,"true")}catch(p){console.error("aria-hidden: cannot operate on ",d,p)}})};return u(e),a.clear(),Rv++,function(){o.forEach(function(h){var d=gc.get(h)-1,f=i.get(h)-1;gc.set(h,d),i.set(h,f),d||(Cm.has(h)||h.removeAttribute(n),Cm.delete(h)),f||h.removeAttribute(r)}),Rv--,Rv||(gc=new WeakMap,gc=new WeakMap,Cm=new WeakMap,km={})}},C6=function(t,e,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(t)?t:[t]),s=RQ(t);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live]"))),PQ(n,s,r,"aria-hidden")):function(){return null}},oC="Dialog",[k6,EHe]=Ju(oC),[OQ,Gs]=k6(oC),A6=t=>{const{__scopeDialog:e,children:r,open:n,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,a=I.useRef(null),l=I.useRef(null),[c=!1,u]=Ep({prop:n,defaultProp:s,onChange:i});return T.jsx(OQ,{scope:e,triggerRef:a,contentRef:l,contentId:Tl(),titleId:Tl(),descriptionId:Tl(),open:c,onOpenChange:u,onOpenToggle:I.useCallback(()=>u(h=>!h),[u]),modal:o,children:r})};A6.displayName=oC;var R6="DialogTrigger",I6=I.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=Gs(R6,r),i=gr(e,s.triggerRef);return T.jsx(Gt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":cC(s.open),...n,ref:i,onClick:et(t.onClick,s.onOpenToggle)})});I6.displayName=R6;var aC="DialogPortal",[DQ,P6]=k6(aC,{forceMount:void 0}),O6=t=>{const{__scopeDialog:e,forceMount:r,children:n,container:s}=t,i=Gs(aC,e);return T.jsx(DQ,{scope:e,forceMount:r,children:I.Children.map(n,o=>T.jsx(Hi,{present:r||i.open,children:T.jsx(Uy,{asChild:!0,container:s,children:o})}))})};O6.displayName=aC;var O0="DialogOverlay",D6=I.forwardRef((t,e)=>{const r=P6(O0,t.__scopeDialog),{forceMount:n=r.forceMount,...s}=t,i=Gs(O0,t.__scopeDialog);return i.modal?T.jsx(Hi,{present:n||i.open,children:T.jsx(LQ,{...s,ref:e})}):null});D6.displayName=O0;var LQ=I.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=Gs(O0,r);return T.jsx(iC,{as:vu,allowPinchZoom:!0,shards:[s.contentRef],children:T.jsx(Gt.div,{"data-state":cC(s.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),Ml="DialogContent",L6=I.forwardRef((t,e)=>{const r=P6(Ml,t.__scopeDialog),{forceMount:n=r.forceMount,...s}=t,i=Gs(Ml,t.__scopeDialog);return T.jsx(Hi,{present:n||i.open,children:i.modal?T.jsx(NQ,{...s,ref:e}):T.jsx(MQ,{...s,ref:e})})});L6.displayName=Ml;var NQ=I.forwardRef((t,e)=>{const r=Gs(Ml,t.__scopeDialog),n=I.useRef(null),s=gr(e,r.contentRef,n);return I.useEffect(()=>{const i=n.current;if(i)return C6(i)},[]),T.jsx(N6,{...t,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:et(t.onCloseAutoFocus,i=>{i.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:et(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:et(t.onFocusOutside,i=>i.preventDefault())})}),MQ=I.forwardRef((t,e)=>{const r=Gs(Ml,t.__scopeDialog),n=I.useRef(!1),s=I.useRef(!1);return T.jsx(N6,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{t.onCloseAutoFocus?.(i),i.defaultPrevented||(n.current||r.triggerRef.current?.focus(),i.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:i=>{t.onInteractOutside?.(i),i.defaultPrevented||(n.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;r.triggerRef.current?.contains(o)&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),N6=I.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,a=Gs(Ml,r),l=I.useRef(null),c=gr(e,l);return _6(),T.jsxs(T.Fragment,{children:[T.jsx(sC,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:i,children:T.jsx(jy,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":cC(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),T.jsxs(T.Fragment,{children:[T.jsx(BQ,{titleId:a.titleId}),T.jsx(jQ,{contentRef:l,descriptionId:a.descriptionId})]})]})}),lC="DialogTitle",M6=I.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=Gs(lC,r);return T.jsx(Gt.h2,{id:s.titleId,...n,ref:e})});M6.displayName=lC;var B6="DialogDescription",F6=I.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=Gs(B6,r);return T.jsx(Gt.p,{id:s.descriptionId,...n,ref:e})});F6.displayName=B6;var j6="DialogClose",U6=I.forwardRef((t,e)=>{const{__scopeDialog:r,...n}=t,s=Gs(j6,r);return T.jsx(Gt.button,{type:"button",...n,ref:e,onClick:et(t.onClick,()=>s.onOpenChange(!1))})});U6.displayName=j6;function cC(t){return t?"open":"closed"}var $6="DialogTitleWarning",[xHe,H6]=gJ($6,{contentName:Ml,titleName:lC,docsSlug:"dialog"}),BQ=({titleId:t})=>{const e=H6($6),r=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return I.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},FQ="DialogDescriptionWarning",jQ=({contentRef:t,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${H6(FQ).contentName}}.`;return I.useEffect(()=>{const s=t.current?.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(n))},[n,t,e]),null},z6=A6,UQ=I6,V6=O6,G6=D6,W6=L6,$Q=M6,HQ=F6,q6=U6;function qe(...t){let e="";for(const r of t)e=K6(e,zQ(r));return e}function zQ(t){if(typeof t=="string"||typeof t=="number")return t;if(typeof t!="object")return"";if(Array.isArray(t))return qe(...t);let e="";for(const r in t)t[r]&&(e=K6(e,r));return e}function K6(t,e){return e?t?t+" "+e:t+e:t}const Ss=sc(.4,0,.2,1),cr=I.memo(I.forwardRef(({icon:t,size:e="xl",className:r,iconClassName:n,disabledClassName:s,disabled:i=!1,title:o,onClick:a,children:l},c)=>T.jsx("button",{ref:c,className:qe("flex items-center text-Terretacode-elements-item-contentDefault bg-transparent enabled:hover:text-Terretacode-elements-item-contentActive rounded-md p-1 enabled:hover:bg-Terretacode-elements-item-backgroundActive disabled:cursor-not-allowed",{[qe("opacity-30",s)]:i},r),title:o,disabled:i,onClick:u=>{i||a?.(u)},children:l||T.jsx("div",{className:qe(t,VQ(e),n)})})));function VQ(t){return t==="sm"?"text-sm":t==="md"?"text-md":t==="lg"?"text-lg":t==="xl"?"text-xl":"text-2xl"}const D0={duration:.15,ease:Ss},Y6={closed:{opacity:0,transition:D0},open:{opacity:1,transition:D0}},X6={closed:{x:"-50%",y:"-40%",scale:.96,opacity:0,transition:D0},open:{x:"-50%",y:"-50%",scale:1,opacity:1,transition:D0}},FR=I.memo(({type:t,children:e,onClick:r})=>T.jsx("button",{className:qe("inline-flex h-[35px] items-center justify-center rounded-lg px-4 text-sm leading-none focus:outline-none",{"bg-Terretacode-elements-button-primary-background text-Terretacode-elements-button-primary-text hover:bg-Terretacode-elements-button-primary-backgroundHover":t==="primary","bg-Terretacode-elements-button-secondary-background text-Terretacode-elements-button-secondary-text hover:bg-Terretacode-elements-button-secondary-backgroundHover":t==="secondary","bg-Terretacode-elements-button-danger-background text-Terretacode-elements-button-danger-text hover:bg-Terretacode-elements-button-danger-backgroundHover":t==="danger"}),onClick:r,children:e})),Z6=I.memo(({className:t,children:e,...r})=>T.jsx($Q,{className:qe("px-5 py-4 flex items-center justify-between border-b border-Terretacode-elements-borderColor text-lg font-semibold leading-6 text-Terretacode-elements-textPrimary",t),...r,children:e})),GQ=I.memo(({className:t,children:e,...r})=>T.jsx(HQ,{className:qe("px-5 py-4 text-Terretacode-elements-textPrimary text-md",t),...r,children:e})),WQ=I.memo(({className:t,children:e,onBackdrop:r,onClose:n})=>T.jsxs(V6,{children:[T.jsx(G6,{onClick:r,asChild:!0,children:T.jsx(yr.div,{className:"bg-black/50 fixed inset-0 z-max",initial:"closed",animate:"open",exit:"closed",variants:Y6})}),T.jsx(W6,{asChild:!0,children:T.jsxs(yr.div,{className:qe("fixed top-[50%] left-[50%] z-max max-h-[85vh] w-[90vw] max-w-[450px] translate-x-[-50%] translate-y-[-50%] border border-Terretacode-elements-borderColor rounded-lg bg-Terretacode-elements-background-depth-2 shadow-lg focus:outline-none overflow-hidden",t),initial:"closed",animate:"open",exit:"closed",variants:X6,children:[e,T.jsx(q6,{asChild:!0,onClick:n,children:T.jsx(cr,{icon:"i-ph:x",className:"absolute top-[10px] right-[10px]"})})]})})]})),qQ=I.memo(({className:t})=>{const e=wt(w0),[r,n]=I.useState(!1);return I.useEffect(()=>{n(!0)},[]),r&&T.jsx(cr,{className:t,icon:e==="dark"?"i-ph-sun-dim-duotone":"i-ph-moon-stars-duotone",size:"xl",title:"Toggle Theme",onClick:gq})}),KQ="y",Am={"settings-tabs":"x",active:KQ,"settings-button":"z","settings-danger-area":"A"};function YQ(t){const e=I.useRef({value:t,previous:t});return I.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}function J6(t){const[e,r]=I.useState(void 0);return Nl(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;r({width:o,height:a})});return n.observe(t,{box:"border-box"}),()=>n.unobserve(t)}else r(void 0)},[t]),e}var uC="Switch",[XQ,SHe]=Ju(uC),[ZQ,JQ]=XQ(uC),Q6=I.forwardRef((t,e)=>{const{__scopeSwitch:r,name:n,checked:s,defaultChecked:i,required:o,disabled:a,value:l="on",onCheckedChange:c,form:u,...h}=t,[d,f]=I.useState(null),g=gr(e,b=>f(b)),_=I.useRef(!1),m=d?u||!!d.closest("form"):!0,[p=!1,y]=Ep({prop:s,defaultProp:i,onChange:c});return T.jsxs(ZQ,{scope:r,checked:p,disabled:a,children:[T.jsx(Gt.button,{type:"button",role:"switch","aria-checked":p,"aria-required":o,"data-state":r4(p),"data-disabled":a?"":void 0,disabled:a,value:l,...h,ref:g,onClick:et(t.onClick,b=>{y(v=>!v),m&&(_.current=b.isPropagationStopped(),_.current||b.stopPropagation())})}),m&&T.jsx(QQ,{control:d,bubbles:!_.current,name:n,value:l,checked:p,required:o,disabled:a,form:u,style:{transform:"translateX(-100%)"}})]})});Q6.displayName=uC;var e4="SwitchThumb",t4=I.forwardRef((t,e)=>{const{__scopeSwitch:r,...n}=t,s=JQ(e4,r);return T.jsx(Gt.span,{"data-state":r4(s.checked),"data-disabled":s.disabled?"":void 0,...n,ref:e})});t4.displayName=e4;var QQ=t=>{const{control:e,checked:r,bubbles:n=!0,...s}=t,i=I.useRef(null),o=YQ(r),a=J6(e);return I.useEffect(()=>{const l=i.current,c=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(c,"checked").set;if(o!==r&&h){const d=new Event("click",{bubbles:n});h.call(l,r),l.dispatchEvent(d)}},[o,r,n]),T.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...s,tabIndex:-1,ref:i,style:{...t.style,...a,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function r4(t){return t?"checked":"unchecked"}var eee=Q6,tee=t4;const Qo=I.memo(({className:t,onCheckedChange:e,checked:r})=>T.jsx(eee,{className:qe("relative h-6 w-11 cursor-pointer rounded-full bg-Terretacode-elements-button-primary-background","transition-colors duration-200 ease-in-out","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2","disabled:cursor-not-allowed disabled:opacity-50","data-[state=checked]:bg-Terretacode-elements-item-contentAccent",t),checked:r,onCheckedChange:n=>e?.(n),children:T.jsx(tee,{className:qe("block h-5 w-5 rounded-full bg-white","shadow-lg shadow-black/20","transition-transform duration-200 ease-in-out","translate-x-0.5","data-[state=checked]:translate-x-[1.375rem]","will-change-transform")})}));var Er={},Hy={};Hy.byteLength=see;Hy.toByteArray=oee;Hy.fromByteArray=cee;var yi=[],cs=[],ree=typeof Uint8Array<"u"?Uint8Array:Array,Iv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var _c=0,nee=Iv.length;_c<nee;++_c)yi[_c]=Iv[_c],cs[Iv.charCodeAt(_c)]=_c;cs[45]=62;cs[95]=63;function n4(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function see(t){var e=n4(t),r=e[0],n=e[1];return(r+n)*3/4-n}function iee(t,e,r){return(e+r)*3/4-r}function oee(t){var e,r=n4(t),n=r[0],s=r[1],i=new ree(iee(t,n,s)),o=0,a=s>0?n-4:n,l;for(l=0;l<a;l+=4)e=cs[t.charCodeAt(l)]<<18|cs[t.charCodeAt(l+1)]<<12|cs[t.charCodeAt(l+2)]<<6|cs[t.charCodeAt(l+3)],i[o++]=e>>16&255,i[o++]=e>>8&255,i[o++]=e&255;return s===2&&(e=cs[t.charCodeAt(l)]<<2|cs[t.charCodeAt(l+1)]>>4,i[o++]=e&255),s===1&&(e=cs[t.charCodeAt(l)]<<10|cs[t.charCodeAt(l+1)]<<4|cs[t.charCodeAt(l+2)]>>2,i[o++]=e>>8&255,i[o++]=e&255),i}function aee(t){return yi[t>>18&63]+yi[t>>12&63]+yi[t>>6&63]+yi[t&63]}function lee(t,e,r){for(var n,s=[],i=e;i<r;i+=3)n=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(t[i+2]&255),s.push(aee(n));return s.join("")}function cee(t){for(var e,r=t.length,n=r%3,s=[],i=16383,o=0,a=r-n;o<a;o+=i)s.push(lee(t,o,o+i>a?a:o+i));return n===1?(e=t[r-1],s.push(yi[e>>2]+yi[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],s.push(yi[e>>10]+yi[e>>4&63]+yi[e<<2&63]+"=")),s.join("")}var hC={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */hC.read=function(t,e,r,n,s){var i,o,a=s*8-n-1,l=(1<<a)-1,c=l>>1,u=-7,h=r?s-1:0,d=r?-1:1,f=t[e+h];for(h+=d,i=f&(1<<-u)-1,f>>=-u,u+=a;u>0;i=i*256+t[e+h],h+=d,u-=8);for(o=i&(1<<-u)-1,i>>=-u,u+=n;u>0;o=o*256+t[e+h],h+=d,u-=8);if(i===0)i=1-c;else{if(i===l)return o?NaN:(f?-1:1)*(1/0);o=o+Math.pow(2,n),i=i-c}return(f?-1:1)*o*Math.pow(2,i-n)};hC.write=function(t,e,r,n,s,i){var o,a,l,c=i*8-s-1,u=(1<<c)-1,h=u>>1,d=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:i-1,g=n?1:-1,_=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+h>=1?e+=d/l:e+=d*Math.pow(2,1-h),e*l>=2&&(o++,l/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(e*l-1)*Math.pow(2,s),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,s),o=0));s>=8;t[r+f]=a&255,f+=g,a/=256,s-=8);for(o=o<<s|a,c+=s;c>0;t[r+f]=o&255,f+=g,o/=256,c-=8);t[r+f-g]|=_*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const e=Hy,r=hC,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=w,t.INSPECT_MAX_BYTES=50;const s=2147483647;t.kMaxLength=s;const{Uint8Array:i,ArrayBuffer:o,SharedArrayBuffer:a}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const z=new i(1),O={foo:function(){return 42}};return Object.setPrototypeOf(O,i.prototype),Object.setPrototypeOf(z,O),z.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(z){if(z>s)throw new RangeError('The value "'+z+'" is invalid for option "size"');const O=new i(z);return Object.setPrototypeOf(O,u.prototype),O}function u(z,O,F){if(typeof z=="number"){if(typeof O=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return g(z)}return h(z,O,F)}u.poolSize=8192;function h(z,O,F){if(typeof z=="string")return _(z,O);if(o.isView(z))return p(z);if(z==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z);if(Ce(z,o)||z&&Ce(z.buffer,o)||typeof a<"u"&&(Ce(z,a)||z&&Ce(z.buffer,a)))return y(z,O,F);if(typeof z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Y=z.valueOf&&z.valueOf();if(Y!=null&&Y!==z)return u.from(Y,O,F);const ce=b(z);if(ce)return ce;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof z[Symbol.toPrimitive]=="function")return u.from(z[Symbol.toPrimitive]("string"),O,F);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof z)}u.from=function(z,O,F){return h(z,O,F)},Object.setPrototypeOf(u.prototype,i.prototype),Object.setPrototypeOf(u,i);function d(z){if(typeof z!="number")throw new TypeError('"size" argument must be of type number');if(z<0)throw new RangeError('The value "'+z+'" is invalid for option "size"')}function f(z,O,F){return d(z),z<=0?c(z):O!==void 0?typeof F=="string"?c(z).fill(O,F):c(z).fill(O):c(z)}u.alloc=function(z,O,F){return f(z,O,F)};function g(z){return d(z),c(z<0?0:v(z)|0)}u.allocUnsafe=function(z){return g(z)},u.allocUnsafeSlow=function(z){return g(z)};function _(z,O){if((typeof O!="string"||O==="")&&(O="utf8"),!u.isEncoding(O))throw new TypeError("Unknown encoding: "+O);const F=E(z,O)|0;let Y=c(F);const ce=Y.write(z,O);return ce!==F&&(Y=Y.slice(0,ce)),Y}function m(z){const O=z.length<0?0:v(z.length)|0,F=c(O);for(let Y=0;Y<O;Y+=1)F[Y]=z[Y]&255;return F}function p(z){if(Ce(z,i)){const O=new i(z);return y(O.buffer,O.byteOffset,O.byteLength)}return m(z)}function y(z,O,F){if(O<0||z.byteLength<O)throw new RangeError('"offset" is outside of buffer bounds');if(z.byteLength<O+(F||0))throw new RangeError('"length" is outside of buffer bounds');let Y;return O===void 0&&F===void 0?Y=new i(z):F===void 0?Y=new i(z,O):Y=new i(z,O,F),Object.setPrototypeOf(Y,u.prototype),Y}function b(z){if(u.isBuffer(z)){const O=v(z.length)|0,F=c(O);return F.length===0||z.copy(F,0,0,O),F}if(z.length!==void 0)return typeof z.length!="number"||he(z.length)?c(0):m(z);if(z.type==="Buffer"&&Array.isArray(z.data))return m(z.data)}function v(z){if(z>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return z|0}function w(z){return+z!=z&&(z=0),u.alloc(+z)}u.isBuffer=function(O){return O!=null&&O._isBuffer===!0&&O!==u.prototype},u.compare=function(O,F){if(Ce(O,i)&&(O=u.from(O,O.offset,O.byteLength)),Ce(F,i)&&(F=u.from(F,F.offset,F.byteLength)),!u.isBuffer(O)||!u.isBuffer(F))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(O===F)return 0;let Y=O.length,ce=F.length;for(let ye=0,we=Math.min(Y,ce);ye<we;++ye)if(O[ye]!==F[ye]){Y=O[ye],ce=F[ye];break}return Y<ce?-1:ce<Y?1:0},u.isEncoding=function(O){switch(String(O).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(O,F){if(!Array.isArray(O))throw new TypeError('"list" argument must be an Array of Buffers');if(O.length===0)return u.alloc(0);let Y;if(F===void 0)for(F=0,Y=0;Y<O.length;++Y)F+=O[Y].length;const ce=u.allocUnsafe(F);let ye=0;for(Y=0;Y<O.length;++Y){let we=O[Y];if(Ce(we,i))ye+we.length>ce.length?(u.isBuffer(we)||(we=u.from(we)),we.copy(ce,ye)):i.prototype.set.call(ce,we,ye);else if(u.isBuffer(we))we.copy(ce,ye);else throw new TypeError('"list" argument must be an Array of Buffers');ye+=we.length}return ce};function E(z,O){if(u.isBuffer(z))return z.length;if(o.isView(z)||Ce(z,o))return z.byteLength;if(typeof z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof z);const F=z.length,Y=arguments.length>2&&arguments[2]===!0;if(!Y&&F===0)return 0;let ce=!1;for(;;)switch(O){case"ascii":case"latin1":case"binary":return F;case"utf8":case"utf-8":return xe(z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F*2;case"hex":return F>>>1;case"base64":return Se(z).length;default:if(ce)return Y?-1:xe(z).length;O=(""+O).toLowerCase(),ce=!0}}u.byteLength=E;function S(z,O,F){let Y=!1;if((O===void 0||O<0)&&(O=0),O>this.length||((F===void 0||F>this.length)&&(F=this.length),F<=0)||(F>>>=0,O>>>=0,F<=O))return"";for(z||(z="utf8");;)switch(z){case"hex":return H(this,O,F);case"utf8":case"utf-8":return q(this,O,F);case"ascii":return B(this,O,F);case"latin1":case"binary":return $(this,O,F);case"base64":return ee(this,O,F);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,O,F);default:if(Y)throw new TypeError("Unknown encoding: "+z);z=(z+"").toLowerCase(),Y=!0}}u.prototype._isBuffer=!0;function x(z,O,F){const Y=z[O];z[O]=z[F],z[F]=Y}u.prototype.swap16=function(){const O=this.length;if(O%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let F=0;F<O;F+=2)x(this,F,F+1);return this},u.prototype.swap32=function(){const O=this.length;if(O%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let F=0;F<O;F+=4)x(this,F,F+3),x(this,F+1,F+2);return this},u.prototype.swap64=function(){const O=this.length;if(O%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let F=0;F<O;F+=8)x(this,F,F+7),x(this,F+1,F+6),x(this,F+2,F+5),x(this,F+3,F+4);return this},u.prototype.toString=function(){const O=this.length;return O===0?"":arguments.length===0?q(this,0,O):S.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(O){if(!u.isBuffer(O))throw new TypeError("Argument must be a Buffer");return this===O?!0:u.compare(this,O)===0},u.prototype.inspect=function(){let O="";const F=t.INSPECT_MAX_BYTES;return O=this.toString("hex",0,F).replace(/(.{2})/g,"$1 ").trim(),this.length>F&&(O+=" ... "),"<Buffer "+O+">"},n&&(u.prototype[n]=u.prototype.inspect),u.prototype.compare=function(O,F,Y,ce,ye){if(Ce(O,i)&&(O=u.from(O,O.offset,O.byteLength)),!u.isBuffer(O))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof O);if(F===void 0&&(F=0),Y===void 0&&(Y=O?O.length:0),ce===void 0&&(ce=0),ye===void 0&&(ye=this.length),F<0||Y>O.length||ce<0||ye>this.length)throw new RangeError("out of range index");if(ce>=ye&&F>=Y)return 0;if(ce>=ye)return-1;if(F>=Y)return 1;if(F>>>=0,Y>>>=0,ce>>>=0,ye>>>=0,this===O)return 0;let we=ye-ce,nt=Y-F;const bt=Math.min(we,nt),$t=this.slice(ce,ye),Wt=O.slice(F,Y);for(let Ot=0;Ot<bt;++Ot)if($t[Ot]!==Wt[Ot]){we=$t[Ot],nt=Wt[Ot];break}return we<nt?-1:nt<we?1:0};function C(z,O,F,Y,ce){if(z.length===0)return-1;if(typeof F=="string"?(Y=F,F=0):F>2147483647?F=2147483647:F<-2147483648&&(F=-2147483648),F=+F,he(F)&&(F=ce?0:z.length-1),F<0&&(F=z.length+F),F>=z.length){if(ce)return-1;F=z.length-1}else if(F<0)if(ce)F=0;else return-1;if(typeof O=="string"&&(O=u.from(O,Y)),u.isBuffer(O))return O.length===0?-1:A(z,O,F,Y,ce);if(typeof O=="number")return O=O&255,typeof i.prototype.indexOf=="function"?ce?i.prototype.indexOf.call(z,O,F):i.prototype.lastIndexOf.call(z,O,F):A(z,[O],F,Y,ce);throw new TypeError("val must be string, number or Buffer")}function A(z,O,F,Y,ce){let ye=1,we=z.length,nt=O.length;if(Y!==void 0&&(Y=String(Y).toLowerCase(),Y==="ucs2"||Y==="ucs-2"||Y==="utf16le"||Y==="utf-16le")){if(z.length<2||O.length<2)return-1;ye=2,we/=2,nt/=2,F/=2}function bt(Wt,Ot){return ye===1?Wt[Ot]:Wt.readUInt16BE(Ot*ye)}let $t;if(ce){let Wt=-1;for($t=F;$t<we;$t++)if(bt(z,$t)===bt(O,Wt===-1?0:$t-Wt)){if(Wt===-1&&(Wt=$t),$t-Wt+1===nt)return Wt*ye}else Wt!==-1&&($t-=$t-Wt),Wt=-1}else for(F+nt>we&&(F=we-nt),$t=F;$t>=0;$t--){let Wt=!0;for(let Ot=0;Ot<nt;Ot++)if(bt(z,$t+Ot)!==bt(O,Ot)){Wt=!1;break}if(Wt)return $t}return-1}u.prototype.includes=function(O,F,Y){return this.indexOf(O,F,Y)!==-1},u.prototype.indexOf=function(O,F,Y){return C(this,O,F,Y,!0)},u.prototype.lastIndexOf=function(O,F,Y){return C(this,O,F,Y,!1)};function M(z,O,F,Y){F=Number(F)||0;const ce=z.length-F;Y?(Y=Number(Y),Y>ce&&(Y=ce)):Y=ce;const ye=O.length;Y>ye/2&&(Y=ye/2);let we;for(we=0;we<Y;++we){const nt=parseInt(O.substr(we*2,2),16);if(he(nt))return we;z[F+we]=nt}return we}function P(z,O,F,Y){return Oe(xe(O,z.length-F),z,F,Y)}function D(z,O,F,Y){return Oe(Te(O),z,F,Y)}function R(z,O,F,Y){return Oe(Se(O),z,F,Y)}function G(z,O,F,Y){return Oe(le(O,z.length-F),z,F,Y)}u.prototype.write=function(O,F,Y,ce){if(F===void 0)ce="utf8",Y=this.length,F=0;else if(Y===void 0&&typeof F=="string")ce=F,Y=this.length,F=0;else if(isFinite(F))F=F>>>0,isFinite(Y)?(Y=Y>>>0,ce===void 0&&(ce="utf8")):(ce=Y,Y=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ye=this.length-F;if((Y===void 0||Y>ye)&&(Y=ye),O.length>0&&(Y<0||F<0)||F>this.length)throw new RangeError("Attempt to write outside buffer bounds");ce||(ce="utf8");let we=!1;for(;;)switch(ce){case"hex":return M(this,O,F,Y);case"utf8":case"utf-8":return P(this,O,F,Y);case"ascii":case"latin1":case"binary":return D(this,O,F,Y);case"base64":return R(this,O,F,Y);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,O,F,Y);default:if(we)throw new TypeError("Unknown encoding: "+ce);ce=(""+ce).toLowerCase(),we=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ee(z,O,F){return O===0&&F===z.length?e.fromByteArray(z):e.fromByteArray(z.slice(O,F))}function q(z,O,F){F=Math.min(z.length,F);const Y=[];let ce=O;for(;ce<F;){const ye=z[ce];let we=null,nt=ye>239?4:ye>223?3:ye>191?2:1;if(ce+nt<=F){let bt,$t,Wt,Ot;switch(nt){case 1:ye<128&&(we=ye);break;case 2:bt=z[ce+1],(bt&192)===128&&(Ot=(ye&31)<<6|bt&63,Ot>127&&(we=Ot));break;case 3:bt=z[ce+1],$t=z[ce+2],(bt&192)===128&&($t&192)===128&&(Ot=(ye&15)<<12|(bt&63)<<6|$t&63,Ot>2047&&(Ot<55296||Ot>57343)&&(we=Ot));break;case 4:bt=z[ce+1],$t=z[ce+2],Wt=z[ce+3],(bt&192)===128&&($t&192)===128&&(Wt&192)===128&&(Ot=(ye&15)<<18|(bt&63)<<12|($t&63)<<6|Wt&63,Ot>65535&&Ot<1114112&&(we=Ot))}}we===null?(we=65533,nt=1):we>65535&&(we-=65536,Y.push(we>>>10&1023|55296),we=56320|we&1023),Y.push(we),ce+=nt}return N(Y)}const re=4096;function N(z){const O=z.length;if(O<=re)return String.fromCharCode.apply(String,z);let F="",Y=0;for(;Y<O;)F+=String.fromCharCode.apply(String,z.slice(Y,Y+=re));return F}function B(z,O,F){let Y="";F=Math.min(z.length,F);for(let ce=O;ce<F;++ce)Y+=String.fromCharCode(z[ce]&127);return Y}function $(z,O,F){let Y="";F=Math.min(z.length,F);for(let ce=O;ce<F;++ce)Y+=String.fromCharCode(z[ce]);return Y}function H(z,O,F){const Y=z.length;(!O||O<0)&&(O=0),(!F||F<0||F>Y)&&(F=Y);let ce="";for(let ye=O;ye<F;++ye)ce+=ke[z[ye]];return ce}function U(z,O,F){const Y=z.slice(O,F);let ce="";for(let ye=0;ye<Y.length-1;ye+=2)ce+=String.fromCharCode(Y[ye]+Y[ye+1]*256);return ce}u.prototype.slice=function(O,F){const Y=this.length;O=~~O,F=F===void 0?Y:~~F,O<0?(O+=Y,O<0&&(O=0)):O>Y&&(O=Y),F<0?(F+=Y,F<0&&(F=0)):F>Y&&(F=Y),F<O&&(F=O);const ce=this.subarray(O,F);return Object.setPrototypeOf(ce,u.prototype),ce};function Q(z,O,F){if(z%1!==0||z<0)throw new RangeError("offset is not uint");if(z+O>F)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(O,F,Y){O=O>>>0,F=F>>>0,Y||Q(O,F,this.length);let ce=this[O],ye=1,we=0;for(;++we<F&&(ye*=256);)ce+=this[O+we]*ye;return ce},u.prototype.readUintBE=u.prototype.readUIntBE=function(O,F,Y){O=O>>>0,F=F>>>0,Y||Q(O,F,this.length);let ce=this[O+--F],ye=1;for(;F>0&&(ye*=256);)ce+=this[O+--F]*ye;return ce},u.prototype.readUint8=u.prototype.readUInt8=function(O,F){return O=O>>>0,F||Q(O,1,this.length),this[O]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(O,F){return O=O>>>0,F||Q(O,2,this.length),this[O]|this[O+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(O,F){return O=O>>>0,F||Q(O,2,this.length),this[O]<<8|this[O+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(O,F){return O=O>>>0,F||Q(O,4,this.length),(this[O]|this[O+1]<<8|this[O+2]<<16)+this[O+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(O,F){return O=O>>>0,F||Q(O,4,this.length),this[O]*16777216+(this[O+1]<<16|this[O+2]<<8|this[O+3])},u.prototype.readBigUInt64LE=Ie(function(O){O=O>>>0,ie(O,"offset");const F=this[O],Y=this[O+7];(F===void 0||Y===void 0)&&W(O,this.length-8);const ce=F+this[++O]*2**8+this[++O]*2**16+this[++O]*2**24,ye=this[++O]+this[++O]*2**8+this[++O]*2**16+Y*2**24;return BigInt(ce)+(BigInt(ye)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ie(function(O){O=O>>>0,ie(O,"offset");const F=this[O],Y=this[O+7];(F===void 0||Y===void 0)&&W(O,this.length-8);const ce=F*2**24+this[++O]*2**16+this[++O]*2**8+this[++O],ye=this[++O]*2**24+this[++O]*2**16+this[++O]*2**8+Y;return(BigInt(ce)<<BigInt(32))+BigInt(ye)}),u.prototype.readIntLE=function(O,F,Y){O=O>>>0,F=F>>>0,Y||Q(O,F,this.length);let ce=this[O],ye=1,we=0;for(;++we<F&&(ye*=256);)ce+=this[O+we]*ye;return ye*=128,ce>=ye&&(ce-=Math.pow(2,8*F)),ce},u.prototype.readIntBE=function(O,F,Y){O=O>>>0,F=F>>>0,Y||Q(O,F,this.length);let ce=F,ye=1,we=this[O+--ce];for(;ce>0&&(ye*=256);)we+=this[O+--ce]*ye;return ye*=128,we>=ye&&(we-=Math.pow(2,8*F)),we},u.prototype.readInt8=function(O,F){return O=O>>>0,F||Q(O,1,this.length),this[O]&128?(255-this[O]+1)*-1:this[O]},u.prototype.readInt16LE=function(O,F){O=O>>>0,F||Q(O,2,this.length);const Y=this[O]|this[O+1]<<8;return Y&32768?Y|4294901760:Y},u.prototype.readInt16BE=function(O,F){O=O>>>0,F||Q(O,2,this.length);const Y=this[O+1]|this[O]<<8;return Y&32768?Y|4294901760:Y},u.prototype.readInt32LE=function(O,F){return O=O>>>0,F||Q(O,4,this.length),this[O]|this[O+1]<<8|this[O+2]<<16|this[O+3]<<24},u.prototype.readInt32BE=function(O,F){return O=O>>>0,F||Q(O,4,this.length),this[O]<<24|this[O+1]<<16|this[O+2]<<8|this[O+3]},u.prototype.readBigInt64LE=Ie(function(O){O=O>>>0,ie(O,"offset");const F=this[O],Y=this[O+7];(F===void 0||Y===void 0)&&W(O,this.length-8);const ce=this[O+4]+this[O+5]*2**8+this[O+6]*2**16+(Y<<24);return(BigInt(ce)<<BigInt(32))+BigInt(F+this[++O]*2**8+this[++O]*2**16+this[++O]*2**24)}),u.prototype.readBigInt64BE=Ie(function(O){O=O>>>0,ie(O,"offset");const F=this[O],Y=this[O+7];(F===void 0||Y===void 0)&&W(O,this.length-8);const ce=(F<<24)+this[++O]*2**16+this[++O]*2**8+this[++O];return(BigInt(ce)<<BigInt(32))+BigInt(this[++O]*2**24+this[++O]*2**16+this[++O]*2**8+Y)}),u.prototype.readFloatLE=function(O,F){return O=O>>>0,F||Q(O,4,this.length),r.read(this,O,!0,23,4)},u.prototype.readFloatBE=function(O,F){return O=O>>>0,F||Q(O,4,this.length),r.read(this,O,!1,23,4)},u.prototype.readDoubleLE=function(O,F){return O=O>>>0,F||Q(O,8,this.length),r.read(this,O,!0,52,8)},u.prototype.readDoubleBE=function(O,F){return O=O>>>0,F||Q(O,8,this.length),r.read(this,O,!1,52,8)};function ne(z,O,F,Y,ce,ye){if(!u.isBuffer(z))throw new TypeError('"buffer" argument must be a Buffer instance');if(O>ce||O<ye)throw new RangeError('"value" argument is out of bounds');if(F+Y>z.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(O,F,Y,ce){if(O=+O,F=F>>>0,Y=Y>>>0,!ce){const nt=Math.pow(2,8*Y)-1;ne(this,O,F,Y,nt,0)}let ye=1,we=0;for(this[F]=O&255;++we<Y&&(ye*=256);)this[F+we]=O/ye&255;return F+Y},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(O,F,Y,ce){if(O=+O,F=F>>>0,Y=Y>>>0,!ce){const nt=Math.pow(2,8*Y)-1;ne(this,O,F,Y,nt,0)}let ye=Y-1,we=1;for(this[F+ye]=O&255;--ye>=0&&(we*=256);)this[F+ye]=O/we&255;return F+Y},u.prototype.writeUint8=u.prototype.writeUInt8=function(O,F,Y){return O=+O,F=F>>>0,Y||ne(this,O,F,1,255,0),this[F]=O&255,F+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(O,F,Y){return O=+O,F=F>>>0,Y||ne(this,O,F,2,65535,0),this[F]=O&255,this[F+1]=O>>>8,F+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(O,F,Y){return O=+O,F=F>>>0,Y||ne(this,O,F,2,65535,0),this[F]=O>>>8,this[F+1]=O&255,F+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(O,F,Y){return O=+O,F=F>>>0,Y||ne(this,O,F,4,4294967295,0),this[F+3]=O>>>24,this[F+2]=O>>>16,this[F+1]=O>>>8,this[F]=O&255,F+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(O,F,Y){return O=+O,F=F>>>0,Y||ne(this,O,F,4,4294967295,0),this[F]=O>>>24,this[F+1]=O>>>16,this[F+2]=O>>>8,this[F+3]=O&255,F+4};function ge(z,O,F,Y,ce){oe(O,Y,ce,z,F,7);let ye=Number(O&BigInt(4294967295));z[F++]=ye,ye=ye>>8,z[F++]=ye,ye=ye>>8,z[F++]=ye,ye=ye>>8,z[F++]=ye;let we=Number(O>>BigInt(32)&BigInt(4294967295));return z[F++]=we,we=we>>8,z[F++]=we,we=we>>8,z[F++]=we,we=we>>8,z[F++]=we,F}function J(z,O,F,Y,ce){oe(O,Y,ce,z,F,7);let ye=Number(O&BigInt(4294967295));z[F+7]=ye,ye=ye>>8,z[F+6]=ye,ye=ye>>8,z[F+5]=ye,ye=ye>>8,z[F+4]=ye;let we=Number(O>>BigInt(32)&BigInt(4294967295));return z[F+3]=we,we=we>>8,z[F+2]=we,we=we>>8,z[F+1]=we,we=we>>8,z[F]=we,F+8}u.prototype.writeBigUInt64LE=Ie(function(O,F=0){return ge(this,O,F,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ie(function(O,F=0){return J(this,O,F,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(O,F,Y,ce){if(O=+O,F=F>>>0,!ce){const bt=Math.pow(2,8*Y-1);ne(this,O,F,Y,bt-1,-bt)}let ye=0,we=1,nt=0;for(this[F]=O&255;++ye<Y&&(we*=256);)O<0&&nt===0&&this[F+ye-1]!==0&&(nt=1),this[F+ye]=(O/we>>0)-nt&255;return F+Y},u.prototype.writeIntBE=function(O,F,Y,ce){if(O=+O,F=F>>>0,!ce){const bt=Math.pow(2,8*Y-1);ne(this,O,F,Y,bt-1,-bt)}let ye=Y-1,we=1,nt=0;for(this[F+ye]=O&255;--ye>=0&&(we*=256);)O<0&&nt===0&&this[F+ye+1]!==0&&(nt=1),this[F+ye]=(O/we>>0)-nt&255;return F+Y},u.prototype.writeInt8=function(O,F,Y){return O=+O,F=F>>>0,Y||ne(this,O,F,1,127,-128),O<0&&(O=255+O+1),this[F]=O&255,F+1},u.prototype.writeInt16LE=function(O,F,Y){return O=+O,F=F>>>0,Y||ne(this,O,F,2,32767,-32768),this[F]=O&255,this[F+1]=O>>>8,F+2},u.prototype.writeInt16BE=function(O,F,Y){return O=+O,F=F>>>0,Y||ne(this,O,F,2,32767,-32768),this[F]=O>>>8,this[F+1]=O&255,F+2},u.prototype.writeInt32LE=function(O,F,Y){return O=+O,F=F>>>0,Y||ne(this,O,F,4,2147483647,-2147483648),this[F]=O&255,this[F+1]=O>>>8,this[F+2]=O>>>16,this[F+3]=O>>>24,F+4},u.prototype.writeInt32BE=function(O,F,Y){return O=+O,F=F>>>0,Y||ne(this,O,F,4,2147483647,-2147483648),O<0&&(O=4294967295+O+1),this[F]=O>>>24,this[F+1]=O>>>16,this[F+2]=O>>>8,this[F+3]=O&255,F+4},u.prototype.writeBigInt64LE=Ie(function(O,F=0){return ge(this,O,F,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ie(function(O,F=0){return J(this,O,F,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function V(z,O,F,Y,ce,ye){if(F+Y>z.length)throw new RangeError("Index out of range");if(F<0)throw new RangeError("Index out of range")}function fe(z,O,F,Y,ce){return O=+O,F=F>>>0,ce||V(z,O,F,4),r.write(z,O,F,Y,23,4),F+4}u.prototype.writeFloatLE=function(O,F,Y){return fe(this,O,F,!0,Y)},u.prototype.writeFloatBE=function(O,F,Y){return fe(this,O,F,!1,Y)};function de(z,O,F,Y,ce){return O=+O,F=F>>>0,ce||V(z,O,F,8),r.write(z,O,F,Y,52,8),F+8}u.prototype.writeDoubleLE=function(O,F,Y){return de(this,O,F,!0,Y)},u.prototype.writeDoubleBE=function(O,F,Y){return de(this,O,F,!1,Y)},u.prototype.copy=function(O,F,Y,ce){if(!u.isBuffer(O))throw new TypeError("argument should be a Buffer");if(Y||(Y=0),!ce&&ce!==0&&(ce=this.length),F>=O.length&&(F=O.length),F||(F=0),ce>0&&ce<Y&&(ce=Y),ce===Y||O.length===0||this.length===0)return 0;if(F<0)throw new RangeError("targetStart out of bounds");if(Y<0||Y>=this.length)throw new RangeError("Index out of range");if(ce<0)throw new RangeError("sourceEnd out of bounds");ce>this.length&&(ce=this.length),O.length-F<ce-Y&&(ce=O.length-F+Y);const ye=ce-Y;return this===O&&typeof i.prototype.copyWithin=="function"?this.copyWithin(F,Y,ce):i.prototype.set.call(O,this.subarray(Y,ce),F),ye},u.prototype.fill=function(O,F,Y,ce){if(typeof O=="string"){if(typeof F=="string"?(ce=F,F=0,Y=this.length):typeof Y=="string"&&(ce=Y,Y=this.length),ce!==void 0&&typeof ce!="string")throw new TypeError("encoding must be a string");if(typeof ce=="string"&&!u.isEncoding(ce))throw new TypeError("Unknown encoding: "+ce);if(O.length===1){const we=O.charCodeAt(0);(ce==="utf8"&&we<128||ce==="latin1")&&(O=we)}}else typeof O=="number"?O=O&255:typeof O=="boolean"&&(O=Number(O));if(F<0||this.length<F||this.length<Y)throw new RangeError("Out of range index");if(Y<=F)return this;F=F>>>0,Y=Y===void 0?this.length:Y>>>0,O||(O=0);let ye;if(typeof O=="number")for(ye=F;ye<Y;++ye)this[ye]=O;else{const we=u.isBuffer(O)?O:u.from(O,ce),nt=we.length;if(nt===0)throw new TypeError('The value "'+O+'" is invalid for argument "value"');for(ye=0;ye<Y-F;++ye)this[ye+F]=we[ye%nt]}return this};const be={};function me(z,O,F){be[z]=class extends F{constructor(){super(),Object.defineProperty(this,"message",{value:O.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${z}]`,this.stack,delete this.name}get code(){return z}set code(ce){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ce,writable:!0})}toString(){return`${this.name} [${z}]: ${this.message}`}}}me("ERR_BUFFER_OUT_OF_BOUNDS",function(z){return z?`${z} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),me("ERR_INVALID_ARG_TYPE",function(z,O){return`The "${z}" argument must be of type number. Received type ${typeof O}`},TypeError),me("ERR_OUT_OF_RANGE",function(z,O,F){let Y=`The value of "${z}" is out of range.`,ce=F;return Number.isInteger(F)&&Math.abs(F)>2**32?ce=ve(String(F)):typeof F=="bigint"&&(ce=String(F),(F>BigInt(2)**BigInt(32)||F<-(BigInt(2)**BigInt(32)))&&(ce=ve(ce)),ce+="n"),Y+=` It must be ${O}. Received ${ce}`,Y},RangeError);function ve(z){let O="",F=z.length;const Y=z[0]==="-"?1:0;for(;F>=Y+4;F-=3)O=`_${z.slice(F-3,F)}${O}`;return`${z.slice(0,F)}${O}`}function L(z,O,F){ie(O,"offset"),(z[O]===void 0||z[O+F]===void 0)&&W(O,z.length-(F+1))}function oe(z,O,F,Y,ce,ye){if(z>F||z<O){const we=typeof O=="bigint"?"n":"";let nt;throw O===0||O===BigInt(0)?nt=`>= 0${we} and < 2${we} ** ${(ye+1)*8}${we}`:nt=`>= -(2${we} ** ${(ye+1)*8-1}${we}) and < 2 ** ${(ye+1)*8-1}${we}`,new be.ERR_OUT_OF_RANGE("value",nt,z)}L(Y,ce,ye)}function ie(z,O){if(typeof z!="number")throw new be.ERR_INVALID_ARG_TYPE(O,"number",z)}function W(z,O,F){throw Math.floor(z)!==z?(ie(z,F),new be.ERR_OUT_OF_RANGE("offset","an integer",z)):O<0?new be.ERR_BUFFER_OUT_OF_BOUNDS:new be.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${O}`,z)}const K=/[^+/0-9A-Za-z-_]/g;function ae(z){if(z=z.split("=")[0],z=z.trim().replace(K,""),z.length<2)return"";for(;z.length%4!==0;)z=z+"=";return z}function xe(z,O){O=O||1/0;let F;const Y=z.length;let ce=null;const ye=[];for(let we=0;we<Y;++we){if(F=z.charCodeAt(we),F>55295&&F<57344){if(!ce){if(F>56319){(O-=3)>-1&&ye.push(239,191,189);continue}else if(we+1===Y){(O-=3)>-1&&ye.push(239,191,189);continue}ce=F;continue}if(F<56320){(O-=3)>-1&&ye.push(239,191,189),ce=F;continue}F=(ce-55296<<10|F-56320)+65536}else ce&&(O-=3)>-1&&ye.push(239,191,189);if(ce=null,F<128){if((O-=1)<0)break;ye.push(F)}else if(F<2048){if((O-=2)<0)break;ye.push(F>>6|192,F&63|128)}else if(F<65536){if((O-=3)<0)break;ye.push(F>>12|224,F>>6&63|128,F&63|128)}else if(F<1114112){if((O-=4)<0)break;ye.push(F>>18|240,F>>12&63|128,F>>6&63|128,F&63|128)}else throw new Error("Invalid code point")}return ye}function Te(z){const O=[];for(let F=0;F<z.length;++F)O.push(z.charCodeAt(F)&255);return O}function le(z,O){let F,Y,ce;const ye=[];for(let we=0;we<z.length&&!((O-=2)<0);++we)F=z.charCodeAt(we),Y=F>>8,ce=F%256,ye.push(ce),ye.push(Y);return ye}function Se(z){return e.toByteArray(ae(z))}function Oe(z,O,F,Y){let ce;for(ce=0;ce<Y&&!(ce+F>=O.length||ce>=z.length);++ce)O[ce+F]=z[ce];return ce}function Ce(z,O){return z instanceof O||z!=null&&z.constructor!=null&&z.constructor.name!=null&&z.constructor.name===O.name}function he(z){return z!==z}const ke=function(){const z="0123456789abcdef",O=new Array(256);for(let F=0;F<16;++F){const Y=F*16;for(let ce=0;ce<16;++ce)O[Y+ce]=z[F]+z[ce]}return O}();function Ie(z){return typeof BigInt>"u"?Ye:z}function Ye(){throw new Error("BigInt not supported")}})(Er);const Ue=Er.Buffer,uee=Er.Blob,hee=Er.BlobOptions,s4=Er.Buffer,dee=Er.File,fee=Er.FileOptions,pee=Er.INSPECT_MAX_BYTES,mee=Er.SlowBuffer,gee=Er.TranscodeEncoding,_ee=Er.atob,yee=Er.btoa,bee=Er.constants,vee=Er.isAscii,wee=Er.isUtf8,Eee=Er.kMaxLength,xee=Er.kStringMaxLength,See=Er.resolveObjectURL,Tee=Er.transcode,Cee=Object.freeze(Object.defineProperty({__proto__:null,Blob:uee,BlobOptions:hee,Buffer:s4,File:dee,FileOptions:fee,INSPECT_MAX_BYTES:pee,SlowBuffer:mee,TranscodeEncoding:gee,atob:_ee,btoa:yee,constants:bee,default:Ue,isAscii:vee,isUtf8:wee,kMaxLength:Eee,kStringMaxLength:xee,resolveObjectURL:See,transcode:Tee},Symbol.toStringTag,{value:"Module"})),kee="https://stackblitz.com",Aee=new Error;Aee.stack="";function Ree(){let t,e;function r(){e=new Promise(n=>t=n)}return r(),{get promise(){return e},resolve(n){return t(n)},reset:r}}let Rm;const Iee={initialized:!1,forwardAuth:!0,redirectUri:"",authComplete:Ree(),clientId:"",oauthScope:"",broadcastChannel:null,get editorOrigin(){return Rm==null&&(Rm=new URL(globalThis.WEBCONTAINER_API_IFRAME_URL??kee).origin),Rm},set editorOrigin(t){Rm=t},tokens:null,cleanup:[]};function i4(t){const e={d:{}};for(const r of Object.keys(t)){const n=t[r];if("file"in n){const i=n.file.contents,o=typeof i=="string"?i:Pee(i),a=typeof i=="string"?{}:{b:!0};e.d[r]={f:{c:o,...a}};continue}const s=i4(n.directory);e.d[r]=s}return e}function Pee(t){let e="";for(const r of t)e+=String.fromCharCode(r);return e}var yd;(function(t){t.UncaughtException="PREVIEW_UNCAUGHT_EXCEPTION",t.UnhandledRejection="PREVIEW_UNHANDLED_REJECTION",t.ConsoleError="PREVIEW_CONSOLE_ERROR"})(yd||(yd={}));var Oee=Object.defineProperty,Dee=(t,e)=>{for(var r in e)Oee(t,r,{get:e[r],enumerable:!0})},ys={};Dee(ys,{createEndpoint:()=>o4,expose:()=>pC,proxy:()=>f4,proxyMarker:()=>dC,releaseProxy:()=>a4,transfer:()=>d4,transferHandlers:()=>fC,windowEndpoint:()=>Fee,wrap:()=>u4});var dC=Symbol("Comlink.proxy"),o4=Symbol("Comlink.endpoint"),a4=Symbol("Comlink.releaseProxy"),dE=Symbol("Comlink.thrown"),l4=t=>typeof t=="object"&&t!==null||typeof t=="function",Lee={canHandle:t=>l4(t)&&t[dC],serialize(t){const{port1:e,port2:r}=new MessageChannel;return pC(t,e),[r,[r]]},deserialize(t){return t.start(),u4(t)}},Nee={canHandle:t=>l4(t)&&dE in t,serialize({value:t}){let e;return t instanceof Error?e={isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:e={isError:!1,value:t},[e,[]]},deserialize(t){throw t.isError?Object.assign(new Error(t.value.message),t.value):t.value}},fC=new Map([["proxy",Lee],["throw",Nee]]);function pC(t,e=self){e.addEventListener("message",function r(n){if(!n||!n.data)return;const{id:s,type:i,path:o}=Object.assign({path:[]},n.data),a=(n.data.argumentList||[]).map(il);let l;try{const c=o.slice(0,-1).reduce((h,d)=>h[d],t),u=o.reduce((h,d)=>h[d],t);switch(i){case 0:l=u;break;case 1:c[o.slice(-1)[0]]=il(n.data.value),l=!0;break;case 2:l=u.apply(c,a);break;case 3:{const h=new u(...a);l=f4(h)}break;case 4:{const{port1:h,port2:d}=new MessageChannel;pC(t,d),l=d4(h,[h])}break;case 5:l=void 0;break}}catch(c){l={value:c,[dE]:0}}Promise.resolve(l).catch(c=>({value:c,[dE]:0})).then(c=>{const[u,h]=mC(c);e.postMessage(Object.assign(Object.assign({},u),{id:s}),h),i===5&&(e.removeEventListener("message",r),c4(e))})}),e.start&&e.start()}function Mee(t){return t.constructor.name==="MessagePort"}function c4(t){Mee(t)&&t.close()}function u4(t,e){return fE(t,[],e)}function Im(t){if(t)throw new Error("Proxy has been released and is not useable")}function fE(t,e=[],r=function(){}){let n=!1;const s=new Proxy(r,{get(i,o){if(Im(n),o===a4)return()=>yc(t,{type:5,path:e.map(a=>a.toString())}).then(()=>{c4(t),n=!0});if(o==="then"){if(e.length===0)return{then:()=>s};const a=yc(t,{type:0,path:e.map(l=>l.toString())}).then(il);return a.then.bind(a)}return fE(t,[...e,o])},set(i,o,a){Im(n);const[l,c]=mC(a);return yc(t,{type:1,path:[...e,o].map(u=>u.toString()),value:l},c).then(il)},apply(i,o,a){Im(n);const l=e[e.length-1];if(l===o4)return yc(t,{type:4}).then(il);if(l==="bind")return fE(t,e.slice(0,-1));const[c,u]=jR(a);return yc(t,{type:2,path:e.map(h=>h.toString()),argumentList:c},u).then(il)},construct(i,o){Im(n);const[a,l]=jR(o);return yc(t,{type:3,path:e.map(c=>c.toString()),argumentList:a},l).then(il)}});return s}function Bee(t){return Array.prototype.concat.apply([],t)}function jR(t){const e=t.map(mC);return[e.map(r=>r[0]),Bee(e.map(r=>r[1]))]}var h4=new WeakMap;function d4(t,e){return h4.set(t,e),t}function f4(t){return Object.assign(t,{[dC]:!0})}function Fee(t,e=self,r="*"){return{postMessage:(n,s)=>t.postMessage(n,r,s),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e)}}function mC(t){for(const[e,r]of fC)if(r.canHandle(t)){const[n,s]=r.serialize(t);return[{type:3,name:e,value:n},s]}return[{type:0,value:t},h4.get(t)||[]]}function il(t){switch(t.type){case 3:return fC.get(t.name).deserialize(t.value);case 0:return t.value}}function yc(t,e,r){return new Promise(n=>{const s=jee();t.addEventListener("message",function i(o){!o.data||!o.data.id||o.data.id!==s||(t.removeEventListener("message",i),n(o.data))}),t.start&&t.start(),t.postMessage(Object.assign({id:s},e),r)})}function jee(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}const Uee=[yd.ConsoleError,yd.UncaughtException,yd.UnhandledRejection];function $ee(t){return!(t==null||typeof t!="object"||!("type"in t)||!Uee.includes(t.type))}let Pm=null,Om=null,Pv={};const Hee=new TextDecoder,zee=new TextEncoder;class hl{_instance;_runtimeInfo;fs;internal;static _instance=null;_tornDown=!1;_unsubscribeFromTokenChangedListener=()=>{};constructor(e,r,n){this._instance=e,this._runtimeInfo=n,this.fs=new Xee(r),this.internal=new Vee(e)}async spawn(e,r,n){let s=[];Array.isArray(r)?s=r:n=r;let i,o=new ReadableStream;if(n?.output!==!1){const _=Dv();i=_.push,o=_.stream}let a,l,c,u;if(l=new ReadableStream,u=new ReadableStream,n?.stdout){const _=Dv();a=_.push,l=_.stream}if(n?.stderr){const _=Dv();c=_.push,u=_.stream}const h=Wg(Ov(i)),d=Wg(Ov(a)),f=Wg(Ov(c)),g=await this._instance.run({command:e,args:s,cwd:n?.cwd,env:n?.env,terminal:n?.terminal},d,f,h);return new Yee(g,o,l,u)}on(e,r){if(e==="preview-message"){const i=r;r=o=>{$ee(o)&&i(o)}}const{listener:n,subscribe:s}=pE(r);return s(this._instance.on(e,ys.proxy(n)))}mount(e,r){const n=e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):zee.encode(JSON.stringify(i4(e)));return this._instance.loadFiles(ys.transfer(n,[n.buffer]),{mountPoints:r?.mountPoint})}get path(){return this._runtimeInfo.path}get workdir(){return this._runtimeInfo.cwd}teardown(){if(this._tornDown)throw new Error("WebContainer already torn down");this._tornDown=!0,this._unsubscribeFromTokenChangedListener(),this.fs._teardown(),this._instance.teardown(),this._instance[ys.releaseProxy](),hl._instance===this&&(hl._instance=null)}static async boot(e={}){const{workdirName:r}=e;if(window.crossOriginIsolated&&e.coep==="none"&&console.warn(`A Cross-Origin-Embedder-Policy header is required in cross origin isolated environments.
Set the 'coep' option to 'require-corp'.`),r?.includes("/")||r===".."||r===".")throw new Error("workdirName should be a valid folder name");for(;Pm;)await Pm;if(hl._instance)throw new Error("Only a single WebContainer instance can be booted");const n=Zee(e);Pm=n.catch(()=>{});try{const s=await n;return hl._instance=s,s}finally{Pm=null}}}class Vee{_instance;constructor(e){this._instance=e}watchPaths(e,r){const{listener:n,subscribe:s}=pE(r);return s(this._instance.watchPaths(e,ys.proxy(n)))}getProcesses(){return this._instance.getProcesses()}onProcessesRemove(e){const{listener:r,subscribe:n}=pE(e);return n(this._instance.onProcessesRemove(ys.proxy(r)))}serialize(e,r){return this._instance.serialize(e,r)}}const Gee=1,Wee=2;class qee{name;_type;constructor(e,r){this.name=e,this._type=r}isFile(){return this._type===Gee}isDirectory(){return this._type===Wee}}class Kee{_apiClient;_path;_options;_listener;_wrappedListener;_watcher;_closed=!1;constructor(e,r,n,s){this._apiClient=e,this._path=r,this._options=n,this._listener=s,this._apiClient._watchers.add(this),this._wrappedListener=(i,o)=>{this._listener&&!this._closed&&this._listener(i,o)},this._apiClient._fs.watch(this._path,this._options,Wg(this._wrappedListener)).then(i=>{this._watcher=i,this._closed&&this._teardown()}).catch(console.error)}close(){this._closed||(this._closed=!0,this._apiClient._watchers.delete(this),this._teardown())}_teardown(){this._watcher?.close().finally(()=>{this._watcher?.[ys.releaseProxy]()})}}class Yee{output;input;exit;_process;stdout;stderr;constructor(e,r,n,s){this.output=r,this._process=e,this.input=new WritableStream({write:i=>{this._getProcess()?.write(i).catch(()=>{})}}),this.exit=this._onExit(),this.stdout=n,this.stderr=s}kill(){this._getProcess()?.kill()}resize(e){this._getProcess()?.resize(e)}async _onExit(){try{return await this._process.onExit}finally{this._process?.[ys.releaseProxy](),this._process=null}}_getProcess(){return this._process==null&&console.warn("This process already exited"),this._process}}class Xee{_fs;_watchers=new Set([]);constructor(e){this._fs=e}rm(...e){return this._fs.rm(...e)}async readFile(e,r){return await this._fs.readFile(e,r)}async rename(e,r){return await this._fs.rename(e,r)}async writeFile(e,r,n){if(r instanceof Uint8Array){const s=r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);r=ys.transfer(new Uint8Array(s),[s])}await this._fs.writeFile(e,r,n)}async readdir(e,r){const n=await this._fs.readdir(e,r);return Qee(n)||ete(n)?n:n.map(i=>new qee(i.name,i["Symbol(type)"]))}async mkdir(e,r){return await this._fs.mkdir(e,r)}watch(e,r,n){return typeof r=="function"&&(n=r,r=null),new Kee(this,e,r,n)}_teardown(){this._fs[ys.releaseProxy]();for(const e of this._watchers)e.close()}}async function Zee(t){const{serverPromise:e}=Jee(t),n=await(await e).build({host:window.location.host,version:"1.3.0-internal.10",workdirName:t.workdirName,forwardPreviewErrors:t.forwardPreviewErrors}),s=await n.fs(),i=await n.runtimeInfo();return new hl(n,s,i)}function Ov(t){if(t!=null)return e=>{e instanceof Uint8Array?t(Hee.decode(e)):e==null&&t(null)}}function Wg(t){if(t!=null)return ys.proxy(t)}function Jee(t){if(Om!=null)return t.coep!==Pv.coep&&(console.warn(`Attempting to boot WebContainer with 'coep: ${t.coep}'`),console.warn(`First boot had 'coep: ${Pv.coep}', new settings will not take effect!`)),{serverPromise:Om};const e=document.createElement("iframe");e.style.display="none",e.setAttribute("allow","cross-origin-isolated");const r=tte();t.coep&&r.searchParams.set("coep",t.coep),e.src=r.toString();const{origin:n}=r;return Pv={...t},Om=new Promise(s=>{const i=o=>{if(o.origin!==n)return;const{data:a}=o;if(a.type==="init"){s(ys.wrap(o.ports[0]));return}if(a.type==="warning"){console[a.level].call(console,a.message);return}};window.addEventListener("message",i)}),document.body.insertBefore(e,null),{serverPromise:Om}}function Qee(t){return typeof t[0]=="string"}function ete(t){return t[0]instanceof Uint8Array}function tte(){const t=new URL(Iee.editorOrigin);return t.pathname="/headless",t.searchParams.set("version","1.3.0-internal.10"),t}function Dv(){let t=null;return{stream:new ReadableStream({start(n){t=n}}),push:n=>{n!=null?t?.enqueue(n):(t?.close(),t=null)}}}function pE(t){let e=!1,r=()=>{};return{subscribe(s){return s.then(i=>{r=i,e&&r()}),()=>{e=!0,r()}},listener:(...s)=>{e||t(...s)}}}function rte(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var p4={exports:{}},hr=p4.exports={},fi,pi;function mE(){throw new Error("setTimeout has not been defined")}function gE(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?fi=setTimeout:fi=mE}catch{fi=mE}try{typeof clearTimeout=="function"?pi=clearTimeout:pi=gE}catch{pi=gE}})();function m4(t){if(fi===setTimeout)return setTimeout(t,0);if((fi===mE||!fi)&&setTimeout)return fi=setTimeout,setTimeout(t,0);try{return fi(t,0)}catch{try{return fi.call(null,t,0)}catch{return fi.call(this,t,0)}}}function nte(t){if(pi===clearTimeout)return clearTimeout(t);if((pi===gE||!pi)&&clearTimeout)return pi=clearTimeout,clearTimeout(t);try{return pi(t)}catch{try{return pi.call(null,t)}catch{return pi.call(this,t)}}}var fo=[],Zc=!1,dl,qg=-1;function ste(){!Zc||!dl||(Zc=!1,dl.length?fo=dl.concat(fo):qg=-1,fo.length&&g4())}function g4(){if(!Zc){var t=m4(ste);Zc=!0;for(var e=fo.length;e;){for(dl=fo,fo=[];++qg<e;)dl&&dl[qg].run();qg=-1,e=fo.length}dl=null,Zc=!1,nte(t)}}hr.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];fo.push(new _4(t,e)),fo.length===1&&!Zc&&m4(g4)};function _4(t,e){this.fun=t,this.array=e}_4.prototype.run=function(){this.fun.apply(null,this.array)};hr.title="browser";hr.browser=!0;hr.env={};hr.argv=[];hr.version="";hr.versions={};function Oo(){}hr.on=Oo;hr.addListener=Oo;hr.once=Oo;hr.off=Oo;hr.removeListener=Oo;hr.removeAllListeners=Oo;hr.emit=Oo;hr.prependListener=Oo;hr.prependOnceListener=Oo;hr.listeners=function(t){return[]};hr.binding=function(t){throw new Error("process.binding is not supported")};hr.cwd=function(){return"/"};hr.chdir=function(t){throw new Error("process.chdir is not supported")};hr.umask=function(){return 0};var ite=p4.exports;const Dt=rte(ite);function Zs(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function UR(t,e){for(var r="",n=0,s=-1,i=0,o,a=0;a<=t.length;++a){if(a<t.length)o=t.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(s===a-1||i===1))if(s!==a-1&&i===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){var l=r.lastIndexOf("/");if(l!==r.length-1){l===-1?(r="",n=0):(r=r.slice(0,l),n=r.length-1-r.lastIndexOf("/")),s=a,i=0;continue}}else if(r.length===2||r.length===1){r="",n=0,s=a,i=0;continue}}e&&(r.length>0?r+="/..":r="..",n=2)}else r.length>0?r+="/"+t.slice(s+1,a):r=t.slice(s+1,a),n=a-s-1;s=a,i=0}else o===46&&i!==-1?++i:i=-1}return r}function ote(t,e){var r=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return r?r===e.root?r+n:r+t+n:n}var Jc={resolve:function(){for(var e="",r=!1,n,s=arguments.length-1;s>=-1&&!r;s--){var i;s>=0?i=arguments[s]:(n===void 0&&(n=Dt.cwd()),i=n),Zs(i),i.length!==0&&(e=i+"/"+e,r=i.charCodeAt(0)===47)}return e=UR(e,!r),r?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(Zs(e),e.length===0)return".";var r=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=UR(e,!r),e.length===0&&!r&&(e="."),e.length>0&&n&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return Zs(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,r=0;r<arguments.length;++r){var n=arguments[r];Zs(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":Jc.normalize(e)},relative:function(e,r){if(Zs(e),Zs(r),e===r||(e=Jc.resolve(e),r=Jc.resolve(r),e===r))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var s=e.length,i=s-n,o=1;o<r.length&&r.charCodeAt(o)===47;++o);for(var a=r.length,l=a-o,c=i<l?i:l,u=-1,h=0;h<=c;++h){if(h===c){if(l>c){if(r.charCodeAt(o+h)===47)return r.slice(o+h+1);if(h===0)return r.slice(o+h)}else i>c&&(e.charCodeAt(n+h)===47?u=h:h===0&&(u=0));break}var d=e.charCodeAt(n+h),f=r.charCodeAt(o+h);if(d!==f)break;d===47&&(u=h)}var g="";for(h=n+u+1;h<=s;++h)(h===s||e.charCodeAt(h)===47)&&(g.length===0?g+="..":g+="/..");return g.length>0?g+r.slice(o+u):(o+=u,r.charCodeAt(o)===47&&++o,r.slice(o))},_makeLong:function(e){return e},dirname:function(e){if(Zs(e),e.length===0)return".";for(var r=e.charCodeAt(0),n=r===47,s=-1,i=!0,o=e.length-1;o>=1;--o)if(r=e.charCodeAt(o),r===47){if(!i){s=o;break}}else i=!1;return s===-1?n?"/":".":n&&s===1?"//":e.slice(0,s)},basename:function(e,r){if(r!==void 0&&typeof r!="string")throw new TypeError('"ext" argument must be a string');Zs(e);var n=0,s=-1,i=!0,o;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var a=r.length-1,l=-1;for(o=e.length-1;o>=0;--o){var c=e.charCodeAt(o);if(c===47){if(!i){n=o+1;break}}else l===-1&&(i=!1,l=o+1),a>=0&&(c===r.charCodeAt(a)?--a===-1&&(s=o):(a=-1,s=l))}return n===s?s=l:s===-1&&(s=e.length),e.slice(n,s)}else{for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!i){n=o+1;break}}else s===-1&&(i=!1,s=o+1);return s===-1?"":e.slice(n,s)}},extname:function(e){Zs(e);for(var r=-1,n=0,s=-1,i=!0,o=0,a=e.length-1;a>=0;--a){var l=e.charCodeAt(a);if(l===47){if(!i){n=a+1;break}continue}s===-1&&(i=!1,s=a+1),l===46?r===-1?r=a:o!==1&&(o=1):r!==-1&&(o=-1)}return r===-1||s===-1||o===0||o===1&&r===s-1&&r===n+1?"":e.slice(r,s)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return ote("/",e)},parse:function(e){Zs(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var n=e.charCodeAt(0),s=n===47,i;s?(r.root="/",i=1):i=0;for(var o=-1,a=0,l=-1,c=!0,u=e.length-1,h=0;u>=i;--u){if(n=e.charCodeAt(u),n===47){if(!c){a=u+1;break}continue}l===-1&&(c=!1,l=u+1),n===46?o===-1?o=u:h!==1&&(h=1):o!==-1&&(h=-1)}return o===-1||l===-1||h===0||h===1&&o===l-1&&o===a+1?l!==-1&&(a===0&&s?r.base=r.name=e.slice(1,l):r.base=r.name=e.slice(a,l)):(a===0&&s?(r.name=e.slice(1,o),r.base=e.slice(1,l)):(r.name=e.slice(a,o),r.base=e.slice(a,l)),r.ext=e.slice(o,l)),a>0?r.dir=e.slice(0,a-1):s&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};Jc.posix=Jc;var Pe=Jc;function Os(t){throw new Error(`Unreachable: ${t}`)}const Js=Fn("ActionRunner");class Uc extends Error{_output;_header;constructor(e,r){const n=`Failed To Execute Shell Command: ${e}

Output:
${r}`;super(n),this._header=e,this._output=r,Object.setPrototypeOf(this,Uc.prototype),this.name="ActionCommandError"}get output(){return this._output}get header(){return this._header}}class ate{#t;#r=Promise.resolve();#e;runnerId=vr(`${Date.now()}`);actions=rc({});onAlert;constructor(e,r,n){this.#t=e,this.#e=r,this.onAlert=n}addAction(e){const{actionId:r}=e;if(this.actions.get()[r])return;const i=new AbortController;this.actions.setKey(r,{...e.action,status:"pending",executed:!1,abort:()=>{i.abort(),this.#a(r,{status:"aborted"})},abortSignal:i.signal}),this.#r.then(()=>{this.#a(r,{status:"running"})})}async runAction(e,r=!1){const{actionId:n}=e,s=this.actions.get()[n];s||Os(`Action ${n} not found`),!s.executed&&(r&&s.type!=="file"||(this.#a(n,{...s,...e.action,executed:!r}),this.#r=this.#r.then(()=>this.#n(n,r)).catch(i=>{console.error("Action failed:",i)}),await this.#r))}async#n(e,r=!1){const n=this.actions.get()[e];this.#a(e,{status:"running"});try{switch(n.type){case"shell":{await this.#i(n);break}case"file":{await this.#o(n);break}case"start":{this.#s(n).then(()=>this.#a(e,{status:"complete"})).catch(s=>{n.abortSignal.aborted||(this.#a(e,{status:"failed",error:"Action failed"}),Js.error(`[${n.type}]:Action failed

`,s),s instanceof Uc&&this.onAlert?.({type:"error",title:"Dev Server Failed",description:s.header,content:s.output}))}),await new Promise(s=>setTimeout(s,2e3));return}}this.#a(e,{status:r?"running":n.abortSignal.aborted?"aborted":"complete"})}catch(s){if(n.abortSignal.aborted||(this.#a(e,{status:"failed",error:"Action failed"}),Js.error(`[${n.type}]:Action failed

`,s),!(s instanceof Uc)))return;throw this.onAlert?.({type:"error",title:"Dev Server Failed",description:s.header,content:s.output}),s}}async#i(e){e.type!=="shell"&&Os("Expected shell action");const r=this.#e();await r.ready(),(!r||!r.terminal||!r.process)&&Os("Shell terminal not found");const n=await r.executeCommand(this.runnerId.get(),e.content,()=>{Js.debug(`[${e.type}]:Aborting Action

`,e),e.abort()});if(Js.debug(`${e.type} Shell Response: [exit code:${n?.exitCode}]`),n?.exitCode!=0)throw new Uc("Failed To Execute Shell Command",n?.output||"No Output Available")}async#s(e){e.type!=="start"&&Os("Expected shell action"),this.#e||Os("Shell terminal not found");const r=this.#e();await r.ready(),(!r||!r.terminal||!r.process)&&Os("Shell terminal not found");const n=await r.executeCommand(this.runnerId.get(),e.content,()=>{Js.debug(`[${e.type}]:Aborting Action

`,e),e.abort()});if(Js.debug(`${e.type} Shell Response: [exit code:${n?.exitCode}]`),n?.exitCode!=0)throw new Uc("Failed To Start Application",n?.output||"No Output Available");return n}async#o(e){e.type!=="file"&&Os("Expected file action");const r=await this.#t,n=Pe.relative(r.workdir,e.filePath);let s=Pe.dirname(n);if(s=s.replace(/\/+$/g,""),s!==".")try{await r.fs.mkdir(s,{recursive:!0}),Js.debug("Created folder",s)}catch(i){Js.error(`Failed to create folder

`,i)}try{await r.fs.writeFile(n,e.content),Js.debug(`File written ${n}`)}catch(i){Js.error(`Failed to write file

`,i)}}#a(e,r){const n=this.actions.get();this.actions.setKey(e,{...n[e],...r})}}const lte="modulepreload",cte=function(t){return"/"+t},$R={},Z=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");s=Promise.allSettled(r.map(l=>{if(l=cte(l),l in $R)return;$R[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":lte,c||(h.as="script"),h.crossOrigin="",h.href=l,a&&h.setAttribute("nonce",a),document.head.appendChild(h),c)return new Promise((d,f)=>{h.addEventListener("load",d),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return s.then(o=>{for(const a of o||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};let y4=(t,e=21)=>(r=e)=>{let n="",s=r;for(;s--;)n+=t[Math.random()*t.length|0];return n};var b4="vercel.ai.error",ute=Symbol.for(b4),v4,hte=class w4 extends Error{constructor({name:e,message:r,cause:n}){super(r),this[v4]=!0,this.name=e,this.cause=n}static isInstance(e){return w4.hasMarker(e,b4)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}toJSON(){return{name:this.name,message:this.message}}};v4=ute;var Rr=hte,_E="AI_APICallError",E4=`vercel.ai.error.${_E}`,dte=Symbol.for(E4),x4,ro=class extends Rr{constructor({message:e,url:r,requestBodyValues:n,statusCode:s,responseHeaders:i,responseBody:o,cause:a,isRetryable:l=s!=null&&(s===408||s===409||s===429||s>=500),data:c}){super({name:_E,message:e,cause:a}),this[x4]=!0,this.url=r,this.requestBodyValues=n,this.statusCode=s,this.responseHeaders=i,this.responseBody=o,this.isRetryable=l,this.data=c}static isInstance(e){return Rr.hasMarker(e,E4)}static isAPICallError(e){return e instanceof Error&&e.name===_E&&typeof e.url=="string"&&typeof e.requestBodyValues=="object"&&(e.statusCode==null||typeof e.statusCode=="number")&&(e.responseHeaders==null||typeof e.responseHeaders=="object")&&(e.responseBody==null||typeof e.responseBody=="string")&&(e.cause==null||typeof e.cause=="object")&&typeof e.isRetryable=="boolean"&&(e.data==null||typeof e.data=="object")}toJSON(){return{name:this.name,message:this.message,url:this.url,requestBodyValues:this.requestBodyValues,statusCode:this.statusCode,responseHeaders:this.responseHeaders,responseBody:this.responseBody,cause:this.cause,isRetryable:this.isRetryable,data:this.data}}};x4=dte;var yE="AI_EmptyResponseBodyError",S4=`vercel.ai.error.${yE}`,fte=Symbol.for(S4),T4,C4=class extends Rr{constructor({message:e="Empty response body"}={}){super({name:yE,message:e}),this[T4]=!0}static isInstance(e){return Rr.hasMarker(e,S4)}static isEmptyResponseBodyError(e){return e instanceof Error&&e.name===yE}};T4=fte;function k4(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var bE="AI_InvalidPromptError",A4=`vercel.ai.error.${bE}`,pte=Symbol.for(A4),R4,mte=class extends Rr{constructor({prompt:e,message:r,cause:n}){super({name:bE,message:`Invalid prompt: ${r}`,cause:n}),this[R4]=!0,this.prompt=e}static isInstance(e){return Rr.hasMarker(e,A4)}static isInvalidPromptError(e){return e instanceof Error&&e.name===bE&&prompt!=null}toJSON(){return{name:this.name,message:this.message,stack:this.stack,prompt:this.prompt}}};R4=pte;var vE="AI_InvalidResponseDataError",I4=`vercel.ai.error.${vE}`,gte=Symbol.for(I4),P4,Lv=class extends Rr{constructor({data:e,message:r=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:vE,message:r}),this[P4]=!0,this.data=e}static isInstance(e){return Rr.hasMarker(e,I4)}static isInvalidResponseDataError(e){return e instanceof Error&&e.name===vE&&e.data!=null}toJSON(){return{name:this.name,message:this.message,stack:this.stack,data:this.data}}};P4=gte;var wE="AI_JSONParseError",O4=`vercel.ai.error.${wE}`,_te=Symbol.for(O4),D4,L0=class extends Rr{constructor({text:e,cause:r}){super({name:wE,message:`JSON parsing failed: Text: ${e}.
Error message: ${k4(r)}`,cause:r}),this[D4]=!0,this.text=e}static isInstance(e){return Rr.hasMarker(e,O4)}static isJSONParseError(e){return e instanceof Error&&e.name===wE&&"text"in e&&typeof e.text=="string"}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,valueText:this.text}}};D4=_te;var EE="AI_LoadAPIKeyError",L4=`vercel.ai.error.${EE}`,yte=Symbol.for(L4),N4,Dm=class extends Rr{constructor({message:e}){super({name:EE,message:e}),this[N4]=!0}static isInstance(e){return Rr.hasMarker(e,L4)}static isLoadAPIKeyError(e){return e instanceof Error&&e.name===EE}};N4=yte;var xE="AI_TooManyEmbeddingValuesForCallError",M4=`vercel.ai.error.${xE}`,bte=Symbol.for(M4),B4,zy=class extends Rr{constructor(e){super({name:xE,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[B4]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return Rr.hasMarker(e,M4)}static isTooManyEmbeddingValuesForCallError(e){return e instanceof Error&&e.name===xE&&"provider"in e&&typeof e.provider=="string"&&"modelId"in e&&typeof e.modelId=="string"&&"maxEmbeddingsPerCall"in e&&typeof e.maxEmbeddingsPerCall=="number"&&"values"in e&&Array.isArray(e.values)}toJSON(){return{name:this.name,message:this.message,stack:this.stack,provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:this.values}}};B4=bte;var SE="AI_TypeValidationError",F4=`vercel.ai.error.${SE}`,vte=Symbol.for(F4),j4,wte=class TE extends Rr{constructor({value:e,cause:r}){super({name:SE,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${k4(r)}`,cause:r}),this[j4]=!0,this.value=e}static isInstance(e){return Rr.hasMarker(e,F4)}static wrap({value:e,cause:r}){return TE.isInstance(r)&&r.value===e?r:new TE({value:e,cause:r})}static isTypeValidationError(e){return e instanceof Error&&e.name===SE}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,value:this.value}}};j4=vte;var N0=wte,CE="AI_UnsupportedFunctionalityError",U4=`vercel.ai.error.${CE}`,Ete=Symbol.for(U4),$4,Fr=class extends Rr{constructor({functionality:e}){super({name:CE,message:`'${e}' functionality not supported.`}),this[$4]=!0,this.functionality=e}static isInstance(e){return Rr.hasMarker(e,U4)}static isUnsupportedFunctionalityError(e){return e instanceof Error&&e.name===CE&&typeof e.functionality=="string"}toJSON(){return{name:this.name,message:this.message,stack:this.stack,functionality:this.functionality}}};$4=Ete;var Qu={exports:{}};const xte=typeof Ue<"u",HR=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,zR=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function H4(t,e,r){r==null&&e!==null&&typeof e=="object"&&(r=e,e=void 0),xte&&Ue.isBuffer(t)&&(t=t.toString()),t&&t.charCodeAt(0)===65279&&(t=t.slice(1));const n=JSON.parse(t,e);if(n===null||typeof n!="object")return n;const s=r&&r.protoAction||"error",i=r&&r.constructorAction||"error";if(s==="ignore"&&i==="ignore")return n;if(s!=="ignore"&&i!=="ignore"){if(HR.test(t)===!1&&zR.test(t)===!1)return n}else if(s!=="ignore"&&i==="ignore"){if(HR.test(t)===!1)return n}else if(zR.test(t)===!1)return n;return z4(n,{protoAction:s,constructorAction:i,safe:r&&r.safe})}function z4(t,{protoAction:e="error",constructorAction:r="error",safe:n}={}){let s=[t];for(;s.length;){const i=s;s=[];for(const o of i){if(e!=="ignore"&&Object.prototype.hasOwnProperty.call(o,"__proto__")){if(n===!0)return null;if(e==="error")throw new SyntaxError("Object contains forbidden prototype property");delete o.__proto__}if(r!=="ignore"&&Object.prototype.hasOwnProperty.call(o,"constructor")&&Object.prototype.hasOwnProperty.call(o.constructor,"prototype")){if(n===!0)return null;if(r==="error")throw new SyntaxError("Object contains forbidden prototype property");delete o.constructor}for(const a in o){const l=o[a];l&&typeof l=="object"&&s.push(l)}}}return t}function gC(t,e,r){const n=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return H4(t,e,r)}finally{Error.stackTraceLimit=n}}function Ste(t,e){const r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return H4(t,e,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=r}}Qu.exports=gC;Qu.exports.default=gC;Qu.exports.parse=gC;Qu.exports.safeParse=Ste;Qu.exports.scan=z4;var Tte=Qu.exports;const Ws=rs(Tte);function Cte(t){let e,r,n,s,i,o,a;return l(),{feed:c,reset:l};function l(){e=!0,r="",n=0,s=-1,i=void 0,o=void 0,a=""}function c(h){r=r?r+h:h,e&&kte(r)&&(r=r.slice(V4.length)),e=!1;const d=r.length;let f=0,g=!1;for(;f<d;){g&&(r[f]===`
`&&++f,g=!1);let _=-1,m=s,p;for(let y=n;_<0&&y<d;++y)p=r[y],p===":"&&m<0?m=y-f:p==="\r"?(g=!0,_=y-f):p===`
`&&(_=y-f);if(_<0){n=d-f,s=m;break}else n=0,s=-1;u(r,f,m,_),f+=_+1}f===d?r="":f>0&&(r=r.slice(f))}function u(h,d,f,g){if(g===0){a.length>0&&(t({type:"event",id:i,event:o||void 0,data:a.slice(0,-1)}),a="",i=void 0),o=void 0;return}const _=f<0,m=h.slice(d,d+(_?g:f));let p=0;_?p=g:h[d+f+1]===" "?p=f+2:p=f+1;const y=d+p,b=g-p,v=h.slice(y,y+b).toString();if(m==="data")a+=v?"".concat(v,`
`):`
`;else if(m==="event")o=v;else if(m==="id"&&!v.includes("\0"))i=v;else if(m==="retry"){const w=parseInt(v,10);Number.isNaN(w)||t({type:"reconnect-interval",value:w})}}}const V4=[239,187,191];function kte(t){return V4.every((e,r)=>t.charCodeAt(r)===e)}let _C=class extends TransformStream{constructor(){let e;super({start(r){e=Cte(n=>{n.type==="event"&&r.enqueue(n)})},transform(r){e.feed(r)}})}};var Ate={};function Qn(...t){return t.reduce((e,r)=>({...e,...r??{}}),{})}function xp(t){const e={};return t.headers.forEach((r,n)=>{e[n]=r}),e}var Rte=({prefix:t="",size:e=7,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"}={})=>{const n=y4(r,e);return s=>`${t}${n(s)}`},ea=Rte();function Nv(t){return t instanceof Error&&(t.name==="AbortError"||t.name==="TimeoutError")}function yC({apiKey:t,environmentVariableName:e,apiKeyParameterName:r="apiKey",description:n}){if(typeof t=="string")return t;if(t!=null)throw new Dm({message:`${n} API key must be a string.`});if(typeof Dt>"u")throw new Dm({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=Ate[e],t==null)throw new Dm({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new Dm({message:`${n} API key must be a string. The value of the ${e} environment variable is not a string.`});return t}var kE=Symbol.for("vercel.ai.validator");function Ite(t){return{[kE]:!0,validate:t}}function Pte(t){return typeof t=="object"&&t!==null&&kE in t&&t[kE]===!0&&"validate"in t}function Ote(t){return Pte(t)?t:Dte(t)}function Dte(t){return Ite(e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}})}function Lte({value:t,schema:e}){const r=G4({value:t,schema:e});if(!r.success)throw N0.wrap({value:t,cause:r.error});return r.value}function G4({value:t,schema:e}){const r=Ote(e);try{if(r.validate==null)return{success:!0,value:t};const n=r.validate(t);return n.success?n:{success:!1,error:N0.wrap({value:t,cause:n.error})}}catch(n){return{success:!1,error:N0.wrap({value:t,cause:n})}}}function Nte({text:t,schema:e}){try{const r=Ws.parse(t);return e==null?r:Lte({value:r,schema:e})}catch(r){throw L0.isJSONParseError(r)||N0.isTypeValidationError(r)?r:new L0({text:t,cause:r})}}function bC({text:t,schema:e}){try{const r=Ws.parse(t);return e==null?{success:!0,value:r}:G4({value:r,schema:e})}catch(r){return{success:!1,error:L0.isJSONParseError(r)?r:new L0({text:t,cause:r})}}}function VR(t){try{return Ws.parse(t),!0}catch{return!1}}function Mte(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!=null))}var Bte=()=>globalThis.fetch,Nn=async({url:t,headers:e,body:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o})=>Fte({url:t,headers:{"Content-Type":"application/json",...e},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o}),Fte=async({url:t,headers:e={},body:r,successfulResponseHandler:n,failedResponseHandler:s,abortSignal:i,fetch:o=Bte()})=>{try{const a=await o(t,{method:"POST",headers:Mte(e),body:r.content,signal:i}),l=xp(a);if(!a.ok){let c;try{c=await s({response:a,url:t,requestBodyValues:r.values})}catch(u){throw Nv(u)||ro.isAPICallError(u)?u:new ro({message:"Failed to process error response",cause:u,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}throw c.value}try{return await n({response:a,url:t,requestBodyValues:r.values})}catch(c){throw c instanceof Error&&(Nv(c)||ro.isAPICallError(c))?c:new ro({message:"Failed to process successful response",cause:c,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}}catch(a){if(Nv(a))throw a;if(a instanceof TypeError&&a.message==="fetch failed"){const l=a.cause;if(l!=null)throw new ro({message:`Cannot connect to API: ${l.message}`,cause:l,url:t,requestBodyValues:r.values,isRetryable:!0})}throw a}},Vy=({errorSchema:t,errorToMessage:e,isRetryable:r})=>async({response:n,url:s,requestBodyValues:i})=>{const o=await n.text(),a=xp(n);if(o.trim()==="")return{responseHeaders:a,value:new ro({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})};try{const l=Nte({text:o,schema:t});return{responseHeaders:a,value:new ro({message:e(l),url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,data:l,isRetryable:r?.(n,l)})}}catch{return{responseHeaders:a,value:new ro({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})}}},Gy=t=>async({response:e})=>{const r=xp(e);if(e.body==null)throw new C4({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new _C).pipeThrough(new TransformStream({transform({data:n},s){n!=="[DONE]"&&s.enqueue(bC({text:n,schema:t}))}}))}},Do=t=>async({response:e,url:r,requestBodyValues:n})=>{const s=await e.text(),i=bC({text:s,schema:t}),o=xp(e);if(!i.success)throw new ro({message:"Invalid JSON response",cause:i.error,statusCode:e.status,responseHeaders:o,responseBody:s,url:r,requestBodyValues:n});return{responseHeaders:o,value:i.value}},{btoa:jte,atob:NHe}=globalThis;function Wy(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCodePoint(t[r]);return jte(e)}function qy(t){return t?.replace(/\/$/,"")}var Et;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function r(s){throw new Error}t.assertNever=r,t.arrayToEnum=s=>{const i={};for(const o of s)i[o]=o;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(a=>typeof s[s[a]]!="number"),o={};for(const a of i)o[a]=s[a];return t.objectValues(o)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.push(o);return i},t.find=(s,i)=>{for(const o of s)if(i(o))return o},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function n(s,i=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}t.joinValues=n,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(Et||(Et={}));var AE;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(AE||(AE={}));const ze=Et.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ta=t=>{switch(typeof t){case"undefined":return ze.undefined;case"string":return ze.string;case"number":return isNaN(t)?ze.nan:ze.number;case"boolean":return ze.boolean;case"function":return ze.function;case"bigint":return ze.bigint;case"symbol":return ze.symbol;case"object":return Array.isArray(t)?ze.array:t===null?ze.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ze.promise:typeof Map<"u"&&t instanceof Map?ze.map:typeof Set<"u"&&t instanceof Set?ze.set:typeof Date<"u"&&t instanceof Date?ze.date:ze.object;default:return ze.unknown}},Me=Et.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Ute=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Yn extends Error{constructor(e){super(),this.issues=[],this.addIssue=n=>{this.issues=[...this.issues,n]},this.addIssues=(n=[])=>{this.issues=[...this.issues,...n]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const r=e||function(i){return i.message},n={_errors:[]},s=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)n._errors.push(r(o));else{let a=n,l=0;for(;l<o.path.length;){const c=o.path[l];l===o.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(r(o))):a[c]=a[c]||{_errors:[]},a=a[c],l++}}};return s(this),n}static assert(e){if(!(e instanceof Yn))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Et.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},n=[];for(const s of this.issues)s.path.length>0?(r[s.path[0]]=r[s.path[0]]||[],r[s.path[0]].push(e(s))):n.push(e(s));return{formErrors:n,fieldErrors:r}}get formErrors(){return this.flatten()}}Yn.create=t=>new Yn(t);const wu=(t,e)=>{let r;switch(t.code){case Me.invalid_type:t.received===ze.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case Me.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Et.jsonStringifyReplacer)}`;break;case Me.unrecognized_keys:r=`Unrecognized key(s) in object: ${Et.joinValues(t.keys,", ")}`;break;case Me.invalid_union:r="Invalid input";break;case Me.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Et.joinValues(t.options)}`;break;case Me.invalid_enum_value:r=`Invalid enum value. Expected ${Et.joinValues(t.options)}, received '${t.received}'`;break;case Me.invalid_arguments:r="Invalid function arguments";break;case Me.invalid_return_type:r="Invalid function return type";break;case Me.invalid_date:r="Invalid date";break;case Me.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Et.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case Me.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case Me.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case Me.custom:r="Invalid input";break;case Me.invalid_intersection_types:r="Intersection results could not be merged";break;case Me.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case Me.not_finite:r="Number must be finite";break;default:r=e.defaultError,Et.assertNever(t)}return{message:r}};let W4=wu;function $te(t){W4=t}function M0(){return W4}const B0=t=>{const{data:e,path:r,errorMaps:n,issueData:s}=t,i=[...r,...s.path||[]],o={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let a="";const l=n.filter(c=>!!c).slice().reverse();for(const c of l)a=c(o,{data:e,defaultError:a}).message;return{...s,path:i,message:a}},Hte=[];function He(t,e){const r=M0(),n=B0({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===wu?void 0:wu].filter(s=>!!s)});t.common.issues.push(n)}class en{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const n=[];for(const s of r){if(s.status==="aborted")return rt;s.status==="dirty"&&e.dirty(),n.push(s.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,r){const n=[];for(const s of r){const i=await s.key,o=await s.value;n.push({key:i,value:o})}return en.mergeObjectSync(e,n)}static mergeObjectSync(e,r){const n={};for(const s of r){const{key:i,value:o}=s;if(i.status==="aborted"||o.status==="aborted")return rt;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(n[i.value]=o.value)}return{status:e.value,value:n}}}const rt=Object.freeze({status:"aborted"}),$c=t=>({status:"dirty",value:t}),_n=t=>({status:"valid",value:t}),RE=t=>t.status==="aborted",IE=t=>t.status==="dirty",ef=t=>t.status==="valid",tf=t=>typeof Promise<"u"&&t instanceof Promise;function F0(t,e,r,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function q4(t,e,r,n,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,r),r}var Je;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(Je||(Je={}));var ed,td;class Fi{constructor(e,r,n,s){this._cachedPath=[],this.parent=e,this.data=r,this._path=n,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const GR=(t,e)=>{if(ef(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Yn(t.common.issues);return this._error=r,this._error}}};function ot(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:n,description:s}=t;if(e&&(r||n))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,a)=>{var l,c;const{message:u}=t;return o.code==="invalid_enum_value"?{message:u??a.defaultError}:typeof a.data>"u"?{message:(l=u??n)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(c=u??r)!==null&&c!==void 0?c:a.defaultError}},description:s}}class ct{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ta(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:ta(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new en,ctx:{common:e.parent.common,data:e.data,parsedType:ta(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(tf(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const n=this.safeParse(e,r);if(n.success)return n.data;throw n.error}safeParse(e,r){var n;const s={common:{issues:[],async:(n=r?.async)!==null&&n!==void 0?n:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ta(e)},i=this._parseSync({data:e,path:s.path,parent:s});return GR(s,i)}async parseAsync(e,r){const n=await this.safeParseAsync(e,r);if(n.success)return n.data;throw n.error}async safeParseAsync(e,r){const n={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ta(e)},s=this._parse({data:e,path:n.path,parent:n}),i=await(tf(s)?s:Promise.resolve(s));return GR(n,i)}refine(e,r){const n=s=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(s):r;return this._refinement((s,i)=>{const o=e(s),a=()=>i.addIssue({code:Me.custom,...n(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,r){return this._refinement((n,s)=>e(n)?!0:(s.addIssue(typeof r=="function"?r(n,s):r),!1))}_refinement(e){return new Us({schema:this,typeName:Fe.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Ni.create(this,this._def)}nullable(){return Ca.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ms.create(this,this._def)}promise(){return xu.create(this,this._def)}or(e){return of.create([this,e],this._def)}and(e){return af.create(this,e,this._def)}transform(e){return new Us({...ot(this._def),schema:this,typeName:Fe.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new df({...ot(this._def),innerType:this,defaultValue:r,typeName:Fe.ZodDefault})}brand(){return new vC({typeName:Fe.ZodBranded,type:this,...ot(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new ff({...ot(this._def),innerType:this,catchValue:r,typeName:Fe.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Sp.create(this,e)}readonly(){return pf.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const zte=/^c[^\s-]{8,}$/i,Vte=/^[0-9a-z]+$/,Gte=/^[0-9A-HJKMNP-TV-Z]{26}$/,Wte=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,qte=/^[a-z0-9_-]{21}$/i,Kte=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,Yte=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,Xte="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let Mv;const Zte=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Jte=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Qte=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,K4="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ere=new RegExp(`^${K4}$`);function Y4(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function tre(t){return new RegExp(`^${Y4(t)}$`)}function X4(t){let e=`${K4}T${Y4(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function rre(t,e){return!!((e==="v4"||!e)&&Zte.test(t)||(e==="v6"||!e)&&Jte.test(t))}class Ls extends ct{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ze.string){const i=this._getOrReturnCtx(e);return He(i,{code:Me.invalid_type,expected:ze.string,received:i.parsedType}),rt}const n=new en;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),He(s,{code:Me.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),He(s,{code:Me.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),n.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,a=e.data.length<i.value;(o||a)&&(s=this._getOrReturnCtx(e,s),o?He(s,{code:Me.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):a&&He(s,{code:Me.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),n.dirty())}else if(i.kind==="email")Yte.test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{validation:"email",code:Me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="emoji")Mv||(Mv=new RegExp(Xte,"u")),Mv.test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{validation:"emoji",code:Me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="uuid")Wte.test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{validation:"uuid",code:Me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="nanoid")qte.test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{validation:"nanoid",code:Me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid")zte.test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{validation:"cuid",code:Me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="cuid2")Vte.test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{validation:"cuid2",code:Me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="ulid")Gte.test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{validation:"ulid",code:Me.invalid_string,message:i.message}),n.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),He(s,{validation:"url",code:Me.invalid_string,message:i.message}),n.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{validation:"regex",code:Me.invalid_string,message:i.message}),n.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),He(s,{code:Me.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),n.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),He(s,{code:Me.invalid_string,validation:{startsWith:i.value},message:i.message}),n.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),He(s,{code:Me.invalid_string,validation:{endsWith:i.value},message:i.message}),n.dirty()):i.kind==="datetime"?X4(i).test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{code:Me.invalid_string,validation:"datetime",message:i.message}),n.dirty()):i.kind==="date"?ere.test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{code:Me.invalid_string,validation:"date",message:i.message}),n.dirty()):i.kind==="time"?tre(i).test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{code:Me.invalid_string,validation:"time",message:i.message}),n.dirty()):i.kind==="duration"?Kte.test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{validation:"duration",code:Me.invalid_string,message:i.message}),n.dirty()):i.kind==="ip"?rre(e.data,i.version)||(s=this._getOrReturnCtx(e,s),He(s,{validation:"ip",code:Me.invalid_string,message:i.message}),n.dirty()):i.kind==="base64"?Qte.test(e.data)||(s=this._getOrReturnCtx(e,s),He(s,{validation:"base64",code:Me.invalid_string,message:i.message}),n.dirty()):Et.assertNever(i);return{status:n.value,value:e.data}}_regex(e,r,n){return this.refinement(s=>e.test(s),{validation:r,code:Me.invalid_string,...Je.errToObj(n)})}_addCheck(e){return new Ls({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Je.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Je.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Je.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Je.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Je.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Je.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Je.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Je.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Je.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Je.errToObj(e)})}datetime(e){var r,n;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(n=e?.local)!==null&&n!==void 0?n:!1,...Je.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...Je.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...Je.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...Je.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...Je.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...Je.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...Je.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...Je.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...Je.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...Je.errToObj(r)})}nonempty(e){return this.min(1,Je.errToObj(e))}trim(){return new Ls({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ls({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ls({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Ls.create=t=>{var e;return new Ls({checks:[],typeName:Fe.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...ot(t)})};function nre(t,e){const r=(t.toString().split(".")[1]||"").length,n=(e.toString().split(".")[1]||"").length,s=r>n?r:n,i=parseInt(t.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return i%o/Math.pow(10,s)}class xa extends ct{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ze.number){const i=this._getOrReturnCtx(e);return He(i,{code:Me.invalid_type,expected:ze.number,received:i.parsedType}),rt}let n;const s=new en;for(const i of this._def.checks)i.kind==="int"?Et.isInteger(e.data)||(n=this._getOrReturnCtx(e,n),He(n,{code:Me.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),He(n,{code:Me.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),He(n,{code:Me.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?nre(e.data,i.value)!==0&&(n=this._getOrReturnCtx(e,n),He(n,{code:Me.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(n=this._getOrReturnCtx(e,n),He(n,{code:Me.not_finite,message:i.message}),s.dirty()):Et.assertNever(i);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,Je.toString(r))}gt(e,r){return this.setLimit("min",e,!1,Je.toString(r))}lte(e,r){return this.setLimit("max",e,!0,Je.toString(r))}lt(e,r){return this.setLimit("max",e,!1,Je.toString(r))}setLimit(e,r,n,s){return new xa({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:Je.toString(s)}]})}_addCheck(e){return new xa({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Je.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Je.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Je.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Je.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Je.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:Je.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:Je.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Je.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Je.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Et.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const n of this._def.checks){if(n.kind==="finite"||n.kind==="int"||n.kind==="multipleOf")return!0;n.kind==="min"?(r===null||n.value>r)&&(r=n.value):n.kind==="max"&&(e===null||n.value<e)&&(e=n.value)}return Number.isFinite(r)&&Number.isFinite(e)}}xa.create=t=>new xa({checks:[],typeName:Fe.ZodNumber,coerce:t?.coerce||!1,...ot(t)});class Sa extends ct{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ze.bigint){const i=this._getOrReturnCtx(e);return He(i,{code:Me.invalid_type,expected:ze.bigint,received:i.parsedType}),rt}let n;const s=new en;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(n=this._getOrReturnCtx(e,n),He(n,{code:Me.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(n=this._getOrReturnCtx(e,n),He(n,{code:Me.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(n=this._getOrReturnCtx(e,n),He(n,{code:Me.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):Et.assertNever(i);return{status:s.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,Je.toString(r))}gt(e,r){return this.setLimit("min",e,!1,Je.toString(r))}lte(e,r){return this.setLimit("max",e,!0,Je.toString(r))}lt(e,r){return this.setLimit("max",e,!1,Je.toString(r))}setLimit(e,r,n,s){return new Sa({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:n,message:Je.toString(s)}]})}_addCheck(e){return new Sa({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Je.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Je.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Je.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Je.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:Je.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Sa.create=t=>{var e;return new Sa({checks:[],typeName:Fe.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...ot(t)})};class rf extends ct{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ze.boolean){const n=this._getOrReturnCtx(e);return He(n,{code:Me.invalid_type,expected:ze.boolean,received:n.parsedType}),rt}return _n(e.data)}}rf.create=t=>new rf({typeName:Fe.ZodBoolean,coerce:t?.coerce||!1,...ot(t)});class Bl extends ct{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ze.date){const i=this._getOrReturnCtx(e);return He(i,{code:Me.invalid_type,expected:ze.date,received:i.parsedType}),rt}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return He(i,{code:Me.invalid_date}),rt}const n=new en;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),He(s,{code:Me.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),n.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),He(s,{code:Me.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),n.dirty()):Et.assertNever(i);return{status:n.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Bl({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:Je.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:Je.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}Bl.create=t=>new Bl({checks:[],coerce:t?.coerce||!1,typeName:Fe.ZodDate,...ot(t)});class j0 extends ct{_parse(e){if(this._getType(e)!==ze.symbol){const n=this._getOrReturnCtx(e);return He(n,{code:Me.invalid_type,expected:ze.symbol,received:n.parsedType}),rt}return _n(e.data)}}j0.create=t=>new j0({typeName:Fe.ZodSymbol,...ot(t)});class nf extends ct{_parse(e){if(this._getType(e)!==ze.undefined){const n=this._getOrReturnCtx(e);return He(n,{code:Me.invalid_type,expected:ze.undefined,received:n.parsedType}),rt}return _n(e.data)}}nf.create=t=>new nf({typeName:Fe.ZodUndefined,...ot(t)});class sf extends ct{_parse(e){if(this._getType(e)!==ze.null){const n=this._getOrReturnCtx(e);return He(n,{code:Me.invalid_type,expected:ze.null,received:n.parsedType}),rt}return _n(e.data)}}sf.create=t=>new sf({typeName:Fe.ZodNull,...ot(t)});class Eu extends ct{constructor(){super(...arguments),this._any=!0}_parse(e){return _n(e.data)}}Eu.create=t=>new Eu({typeName:Fe.ZodAny,...ot(t)});class Cl extends ct{constructor(){super(...arguments),this._unknown=!0}_parse(e){return _n(e.data)}}Cl.create=t=>new Cl({typeName:Fe.ZodUnknown,...ot(t)});class Eo extends ct{_parse(e){const r=this._getOrReturnCtx(e);return He(r,{code:Me.invalid_type,expected:ze.never,received:r.parsedType}),rt}}Eo.create=t=>new Eo({typeName:Fe.ZodNever,...ot(t)});class U0 extends ct{_parse(e){if(this._getType(e)!==ze.undefined){const n=this._getOrReturnCtx(e);return He(n,{code:Me.invalid_type,expected:ze.void,received:n.parsedType}),rt}return _n(e.data)}}U0.create=t=>new U0({typeName:Fe.ZodVoid,...ot(t)});class Ms extends ct{_parse(e){const{ctx:r,status:n}=this._processInputParams(e),s=this._def;if(r.parsedType!==ze.array)return He(r,{code:Me.invalid_type,expected:ze.array,received:r.parsedType}),rt;if(s.exactLength!==null){const o=r.data.length>s.exactLength.value,a=r.data.length<s.exactLength.value;(o||a)&&(He(r,{code:o?Me.too_big:Me.too_small,minimum:a?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),n.dirty())}if(s.minLength!==null&&r.data.length<s.minLength.value&&(He(r,{code:Me.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),n.dirty()),s.maxLength!==null&&r.data.length>s.maxLength.value&&(He(r,{code:Me.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),n.dirty()),r.common.async)return Promise.all([...r.data].map((o,a)=>s.type._parseAsync(new Fi(r,o,r.path,a)))).then(o=>en.mergeArray(n,o));const i=[...r.data].map((o,a)=>s.type._parseSync(new Fi(r,o,r.path,a)));return en.mergeArray(n,i)}get element(){return this._def.type}min(e,r){return new Ms({...this._def,minLength:{value:e,message:Je.toString(r)}})}max(e,r){return new Ms({...this._def,maxLength:{value:e,message:Je.toString(r)}})}length(e,r){return new Ms({...this._def,exactLength:{value:e,message:Je.toString(r)}})}nonempty(e){return this.min(1,e)}}Ms.create=(t,e)=>new Ms({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Fe.ZodArray,...ot(e)});function Rc(t){if(t instanceof Qt){const e={};for(const r in t.shape){const n=t.shape[r];e[r]=Ni.create(Rc(n))}return new Qt({...t._def,shape:()=>e})}else return t instanceof Ms?new Ms({...t._def,type:Rc(t.element)}):t instanceof Ni?Ni.create(Rc(t.unwrap())):t instanceof Ca?Ca.create(Rc(t.unwrap())):t instanceof ji?ji.create(t.items.map(e=>Rc(e))):t}class Qt extends ct{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=Et.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==ze.object){const c=this._getOrReturnCtx(e);return He(c,{code:Me.invalid_type,expected:ze.object,received:c.parsedType}),rt}const{status:n,ctx:s}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Eo&&this._def.unknownKeys==="strip"))for(const c in s.data)o.includes(c)||a.push(c);const l=[];for(const c of o){const u=i[c],h=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Fi(s,h,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof Eo){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of a)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(c==="strict")a.length>0&&(He(s,{code:Me.unrecognized_keys,keys:a}),n.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of a){const h=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Fi(s,h,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const h=await u.key,d=await u.value;c.push({key:h,value:d,alwaysSet:u.alwaysSet})}return c}).then(c=>en.mergeObjectSync(n,c)):en.mergeObjectSync(n,l)}get shape(){return this._def.shape()}strict(e){return Je.errToObj,new Qt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,n)=>{var s,i,o,a;const l=(o=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,r,n).message)!==null&&o!==void 0?o:n.defaultError;return r.code==="unrecognized_keys"?{message:(a=Je.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new Qt({...this._def,unknownKeys:"strip"})}passthrough(){return new Qt({...this._def,unknownKeys:"passthrough"})}extend(e){return new Qt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Qt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Fe.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new Qt({...this._def,catchall:e})}pick(e){const r={};return Et.objectKeys(e).forEach(n=>{e[n]&&this.shape[n]&&(r[n]=this.shape[n])}),new Qt({...this._def,shape:()=>r})}omit(e){const r={};return Et.objectKeys(this.shape).forEach(n=>{e[n]||(r[n]=this.shape[n])}),new Qt({...this._def,shape:()=>r})}deepPartial(){return Rc(this)}partial(e){const r={};return Et.objectKeys(this.shape).forEach(n=>{const s=this.shape[n];e&&!e[n]?r[n]=s:r[n]=s.optional()}),new Qt({...this._def,shape:()=>r})}required(e){const r={};return Et.objectKeys(this.shape).forEach(n=>{if(e&&!e[n])r[n]=this.shape[n];else{let i=this.shape[n];for(;i instanceof Ni;)i=i._def.innerType;r[n]=i}}),new Qt({...this._def,shape:()=>r})}keyof(){return Z4(Et.objectKeys(this.shape))}}Qt.create=(t,e)=>new Qt({shape:()=>t,unknownKeys:"strip",catchall:Eo.create(),typeName:Fe.ZodObject,...ot(e)});Qt.strictCreate=(t,e)=>new Qt({shape:()=>t,unknownKeys:"strict",catchall:Eo.create(),typeName:Fe.ZodObject,...ot(e)});Qt.lazycreate=(t,e)=>new Qt({shape:t,unknownKeys:"strip",catchall:Eo.create(),typeName:Fe.ZodObject,...ot(e)});class of extends ct{_parse(e){const{ctx:r}=this._processInputParams(e),n=this._def.options;function s(i){for(const a of i)if(a.result.status==="valid")return a.result;for(const a of i)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;const o=i.map(a=>new Yn(a.ctx.common.issues));return He(r,{code:Me.invalid_union,unionErrors:o}),rt}if(r.common.async)return Promise.all(n.map(async i=>{const o={...r,common:{...r.common,issues:[]},parent:null};return{result:await i._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(s);{let i;const o=[];for(const l of n){const c={...r,common:{...r.common,issues:[]},parent:null},u=l._parseSync({data:r.data,path:r.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(i)return r.common.issues.push(...i.ctx.common.issues),i.result;const a=o.map(l=>new Yn(l));return He(r,{code:Me.invalid_union,unionErrors:a}),rt}}get options(){return this._def.options}}of.create=(t,e)=>new of({options:t,typeName:Fe.ZodUnion,...ot(e)});const Zi=t=>t instanceof cf?Zi(t.schema):t instanceof Us?Zi(t.innerType()):t instanceof uf?[t.value]:t instanceof Ta?t.options:t instanceof hf?Et.objectValues(t.enum):t instanceof df?Zi(t._def.innerType):t instanceof nf?[void 0]:t instanceof sf?[null]:t instanceof Ni?[void 0,...Zi(t.unwrap())]:t instanceof Ca?[null,...Zi(t.unwrap())]:t instanceof vC||t instanceof pf?Zi(t.unwrap()):t instanceof ff?Zi(t._def.innerType):[];class Ky extends ct{_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==ze.object)return He(r,{code:Me.invalid_type,expected:ze.object,received:r.parsedType}),rt;const n=this.discriminator,s=r.data[n],i=this.optionsMap.get(s);return i?r.common.async?i._parseAsync({data:r.data,path:r.path,parent:r}):i._parseSync({data:r.data,path:r.path,parent:r}):(He(r,{code:Me.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),rt)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,n){const s=new Map;for(const i of r){const o=Zi(i.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of o){if(s.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,i)}}return new Ky({typeName:Fe.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:s,...ot(n)})}}function PE(t,e){const r=ta(t),n=ta(e);if(t===e)return{valid:!0,data:t};if(r===ze.object&&n===ze.object){const s=Et.objectKeys(e),i=Et.objectKeys(t).filter(a=>s.indexOf(a)!==-1),o={...t,...e};for(const a of i){const l=PE(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(r===ze.array&&n===ze.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const o=t[i],a=e[i],l=PE(o,a);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return r===ze.date&&n===ze.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class af extends ct{_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=(i,o)=>{if(RE(i)||RE(o))return rt;const a=PE(i.value,o.value);return a.valid?((IE(i)||IE(o))&&r.dirty(),{status:r.value,value:a.data}):(He(n,{code:Me.invalid_intersection_types}),rt)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then(([i,o])=>s(i,o)):s(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}af.create=(t,e,r)=>new af({left:t,right:e,typeName:Fe.ZodIntersection,...ot(r)});class ji extends ct{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ze.array)return He(n,{code:Me.invalid_type,expected:ze.array,received:n.parsedType}),rt;if(n.data.length<this._def.items.length)return He(n,{code:Me.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),rt;!this._def.rest&&n.data.length>this._def.items.length&&(He(n,{code:Me.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const i=[...n.data].map((o,a)=>{const l=this._def.items[a]||this._def.rest;return l?l._parse(new Fi(n,o,n.path,a)):null}).filter(o=>!!o);return n.common.async?Promise.all(i).then(o=>en.mergeArray(r,o)):en.mergeArray(r,i)}get items(){return this._def.items}rest(e){return new ji({...this._def,rest:e})}}ji.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ji({items:t,typeName:Fe.ZodTuple,rest:null,...ot(e)})};class lf extends ct{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ze.object)return He(n,{code:Me.invalid_type,expected:ze.object,received:n.parsedType}),rt;const s=[],i=this._def.keyType,o=this._def.valueType;for(const a in n.data)s.push({key:i._parse(new Fi(n,a,n.path,a)),value:o._parse(new Fi(n,n.data[a],n.path,a)),alwaysSet:a in n.data});return n.common.async?en.mergeObjectAsync(r,s):en.mergeObjectSync(r,s)}get element(){return this._def.valueType}static create(e,r,n){return r instanceof ct?new lf({keyType:e,valueType:r,typeName:Fe.ZodRecord,...ot(n)}):new lf({keyType:Ls.create(),valueType:e,typeName:Fe.ZodRecord,...ot(r)})}}class $0 extends ct{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ze.map)return He(n,{code:Me.invalid_type,expected:ze.map,received:n.parsedType}),rt;const s=this._def.keyType,i=this._def.valueType,o=[...n.data.entries()].map(([a,l],c)=>({key:s._parse(new Fi(n,a,n.path,[c,"key"])),value:i._parse(new Fi(n,l,n.path,[c,"value"]))}));if(n.common.async){const a=new Map;return Promise.resolve().then(async()=>{for(const l of o){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return rt;(c.status==="dirty"||u.status==="dirty")&&r.dirty(),a.set(c.value,u.value)}return{status:r.value,value:a}})}else{const a=new Map;for(const l of o){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return rt;(c.status==="dirty"||u.status==="dirty")&&r.dirty(),a.set(c.value,u.value)}return{status:r.value,value:a}}}}$0.create=(t,e,r)=>new $0({valueType:e,keyType:t,typeName:Fe.ZodMap,...ot(r)});class Fl extends ct{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.parsedType!==ze.set)return He(n,{code:Me.invalid_type,expected:ze.set,received:n.parsedType}),rt;const s=this._def;s.minSize!==null&&n.data.size<s.minSize.value&&(He(n,{code:Me.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),r.dirty()),s.maxSize!==null&&n.data.size>s.maxSize.value&&(He(n,{code:Me.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),r.dirty());const i=this._def.valueType;function o(l){const c=new Set;for(const u of l){if(u.status==="aborted")return rt;u.status==="dirty"&&r.dirty(),c.add(u.value)}return{status:r.value,value:c}}const a=[...n.data.values()].map((l,c)=>i._parse(new Fi(n,l,n.path,c)));return n.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,r){return new Fl({...this._def,minSize:{value:e,message:Je.toString(r)}})}max(e,r){return new Fl({...this._def,maxSize:{value:e,message:Je.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Fl.create=(t,e)=>new Fl({valueType:t,minSize:null,maxSize:null,typeName:Fe.ZodSet,...ot(e)});class Qc extends ct{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==ze.function)return He(r,{code:Me.invalid_type,expected:ze.function,received:r.parsedType}),rt;function n(a,l){return B0({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,M0(),wu].filter(c=>!!c),issueData:{code:Me.invalid_arguments,argumentsError:l}})}function s(a,l){return B0({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,M0(),wu].filter(c=>!!c),issueData:{code:Me.invalid_return_type,returnTypeError:l}})}const i={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof xu){const a=this;return _n(async function(...l){const c=new Yn([]),u=await a._def.args.parseAsync(l,i).catch(f=>{throw c.addIssue(n(l,f)),c}),h=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(h,i).catch(f=>{throw c.addIssue(s(h,f)),c})})}else{const a=this;return _n(function(...l){const c=a._def.args.safeParse(l,i);if(!c.success)throw new Yn([n(l,c.error)]);const u=Reflect.apply(o,this,c.data),h=a._def.returns.safeParse(u,i);if(!h.success)throw new Yn([s(u,h.error)]);return h.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Qc({...this._def,args:ji.create(e).rest(Cl.create())})}returns(e){return new Qc({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,n){return new Qc({args:e||ji.create([]).rest(Cl.create()),returns:r||Cl.create(),typeName:Fe.ZodFunction,...ot(n)})}}class cf extends ct{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}cf.create=(t,e)=>new cf({getter:t,typeName:Fe.ZodLazy,...ot(e)});class uf extends ct{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return He(r,{received:r.data,code:Me.invalid_literal,expected:this._def.value}),rt}return{status:"valid",value:e.data}}get value(){return this._def.value}}uf.create=(t,e)=>new uf({value:t,typeName:Fe.ZodLiteral,...ot(e)});function Z4(t,e){return new Ta({values:t,typeName:Fe.ZodEnum,...ot(e)})}class Ta extends ct{constructor(){super(...arguments),ed.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),n=this._def.values;return He(r,{expected:Et.joinValues(n),received:r.parsedType,code:Me.invalid_type}),rt}if(F0(this,ed)||q4(this,ed,new Set(this._def.values)),!F0(this,ed).has(e.data)){const r=this._getOrReturnCtx(e),n=this._def.values;return He(r,{received:r.data,code:Me.invalid_enum_value,options:n}),rt}return _n(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return Ta.create(e,{...this._def,...r})}exclude(e,r=this._def){return Ta.create(this.options.filter(n=>!e.includes(n)),{...this._def,...r})}}ed=new WeakMap;Ta.create=Z4;class hf extends ct{constructor(){super(...arguments),td.set(this,void 0)}_parse(e){const r=Et.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==ze.string&&n.parsedType!==ze.number){const s=Et.objectValues(r);return He(n,{expected:Et.joinValues(s),received:n.parsedType,code:Me.invalid_type}),rt}if(F0(this,td)||q4(this,td,new Set(Et.getValidEnumValues(this._def.values))),!F0(this,td).has(e.data)){const s=Et.objectValues(r);return He(n,{received:n.data,code:Me.invalid_enum_value,options:s}),rt}return _n(e.data)}get enum(){return this._def.values}}td=new WeakMap;hf.create=(t,e)=>new hf({values:t,typeName:Fe.ZodNativeEnum,...ot(e)});class xu extends ct{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==ze.promise&&r.common.async===!1)return He(r,{code:Me.invalid_type,expected:ze.promise,received:r.parsedType}),rt;const n=r.parsedType===ze.promise?r.data:Promise.resolve(r.data);return _n(n.then(s=>this._def.type.parseAsync(s,{path:r.path,errorMap:r.common.contextualErrorMap})))}}xu.create=(t,e)=>new xu({type:t,typeName:Fe.ZodPromise,...ot(e)});class Us extends ct{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Fe.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:n}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:o=>{He(n,o),o.fatal?r.abort():r.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const o=s.transform(n.data,i);if(n.common.async)return Promise.resolve(o).then(async a=>{if(r.value==="aborted")return rt;const l=await this._def.schema._parseAsync({data:a,path:n.path,parent:n});return l.status==="aborted"?rt:l.status==="dirty"||r.value==="dirty"?$c(l.value):l});{if(r.value==="aborted")return rt;const a=this._def.schema._parseSync({data:o,path:n.path,parent:n});return a.status==="aborted"?rt:a.status==="dirty"||r.value==="dirty"?$c(a.value):a}}if(s.type==="refinement"){const o=a=>{const l=s.refinement(a,i);if(n.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(n.common.async===!1){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return a.status==="aborted"?rt:(a.status==="dirty"&&r.dirty(),o(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(a=>a.status==="aborted"?rt:(a.status==="dirty"&&r.dirty(),o(a.value).then(()=>({status:r.value,value:a.value}))))}if(s.type==="transform")if(n.common.async===!1){const o=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!ef(o))return o;const a=s.transform(o.value,i);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then(o=>ef(o)?Promise.resolve(s.transform(o.value,i)).then(a=>({status:r.value,value:a})):o);Et.assertNever(s)}}Us.create=(t,e,r)=>new Us({schema:t,typeName:Fe.ZodEffects,effect:e,...ot(r)});Us.createWithPreprocess=(t,e,r)=>new Us({schema:e,effect:{type:"preprocess",transform:t},typeName:Fe.ZodEffects,...ot(r)});class Ni extends ct{_parse(e){return this._getType(e)===ze.undefined?_n(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ni.create=(t,e)=>new Ni({innerType:t,typeName:Fe.ZodOptional,...ot(e)});class Ca extends ct{_parse(e){return this._getType(e)===ze.null?_n(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ca.create=(t,e)=>new Ca({innerType:t,typeName:Fe.ZodNullable,...ot(e)});class df extends ct{_parse(e){const{ctx:r}=this._processInputParams(e);let n=r.data;return r.parsedType===ze.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}df.create=(t,e)=>new df({innerType:t,typeName:Fe.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ot(e)});class ff extends ct{_parse(e){const{ctx:r}=this._processInputParams(e),n={...r,common:{...r.common,issues:[]}},s=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return tf(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Yn(n.common.issues)},input:n.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Yn(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}ff.create=(t,e)=>new ff({innerType:t,typeName:Fe.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ot(e)});class H0 extends ct{_parse(e){if(this._getType(e)!==ze.nan){const n=this._getOrReturnCtx(e);return He(n,{code:Me.invalid_type,expected:ze.nan,received:n.parsedType}),rt}return{status:"valid",value:e.data}}}H0.create=t=>new H0({typeName:Fe.ZodNaN,...ot(t)});const sre=Symbol("zod_brand");class vC extends ct{_parse(e){const{ctx:r}=this._processInputParams(e),n=r.data;return this._def.type._parse({data:n,path:r.path,parent:r})}unwrap(){return this._def.type}}class Sp extends ct{_parse(e){const{status:r,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return i.status==="aborted"?rt:i.status==="dirty"?(r.dirty(),$c(i.value)):this._def.out._parseAsync({data:i.value,path:n.path,parent:n})})();{const s=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return s.status==="aborted"?rt:s.status==="dirty"?(r.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:n.path,parent:n})}}static create(e,r){return new Sp({in:e,out:r,typeName:Fe.ZodPipeline})}}class pf extends ct{_parse(e){const r=this._def.innerType._parse(e),n=s=>(ef(s)&&(s.value=Object.freeze(s.value)),s);return tf(r)?r.then(s=>n(s)):n(r)}unwrap(){return this._def.innerType}}pf.create=(t,e)=>new pf({innerType:t,typeName:Fe.ZodReadonly,...ot(e)});function J4(t,e={},r){return t?Eu.create().superRefine((n,s)=>{var i,o;if(!t(n)){const a=typeof e=="function"?e(n):typeof e=="string"?{message:e}:e,l=(o=(i=a.fatal)!==null&&i!==void 0?i:r)!==null&&o!==void 0?o:!0,c=typeof a=="string"?{message:a}:a;s.addIssue({code:"custom",...c,fatal:l})}}):Eu.create()}const ire={object:Qt.lazycreate};var Fe;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Fe||(Fe={}));const ore=(t,e={message:`Input not instance of ${t.name}`})=>J4(r=>r instanceof t,e),Q4=Ls.create,eF=xa.create,are=H0.create,lre=Sa.create,tF=rf.create,cre=Bl.create,ure=j0.create,hre=nf.create,dre=sf.create,fre=Eu.create,pre=Cl.create,mre=Eo.create,gre=U0.create,_re=Ms.create,yre=Qt.create,bre=Qt.strictCreate,vre=of.create,wre=Ky.create,Ere=af.create,xre=ji.create,Sre=lf.create,Tre=$0.create,Cre=Fl.create,kre=Qc.create,Are=cf.create,Rre=uf.create,Ire=Ta.create,Pre=hf.create,Ore=xu.create,WR=Us.create,Dre=Ni.create,Lre=Ca.create,Nre=Us.createWithPreprocess,Mre=Sp.create,Bre=()=>Q4().optional(),Fre=()=>eF().optional(),jre=()=>tF().optional(),Ure={string:t=>Ls.create({...t,coerce:!0}),number:t=>xa.create({...t,coerce:!0}),boolean:t=>rf.create({...t,coerce:!0}),bigint:t=>Sa.create({...t,coerce:!0}),date:t=>Bl.create({...t,coerce:!0})},$re=rt;var j=Object.freeze({__proto__:null,defaultErrorMap:wu,setErrorMap:$te,getErrorMap:M0,makeIssue:B0,EMPTY_PATH:Hte,addIssueToContext:He,ParseStatus:en,INVALID:rt,DIRTY:$c,OK:_n,isAborted:RE,isDirty:IE,isValid:ef,isAsync:tf,get util(){return Et},get objectUtil(){return AE},ZodParsedType:ze,getParsedType:ta,ZodType:ct,datetimeRegex:X4,ZodString:Ls,ZodNumber:xa,ZodBigInt:Sa,ZodBoolean:rf,ZodDate:Bl,ZodSymbol:j0,ZodUndefined:nf,ZodNull:sf,ZodAny:Eu,ZodUnknown:Cl,ZodNever:Eo,ZodVoid:U0,ZodArray:Ms,ZodObject:Qt,ZodUnion:of,ZodDiscriminatedUnion:Ky,ZodIntersection:af,ZodTuple:ji,ZodRecord:lf,ZodMap:$0,ZodSet:Fl,ZodFunction:Qc,ZodLazy:cf,ZodLiteral:uf,ZodEnum:Ta,ZodNativeEnum:hf,ZodPromise:xu,ZodEffects:Us,ZodTransformer:Us,ZodOptional:Ni,ZodNullable:Ca,ZodDefault:df,ZodCatch:ff,ZodNaN:H0,BRAND:sre,ZodBranded:vC,ZodPipeline:Sp,ZodReadonly:pf,custom:J4,Schema:ct,ZodSchema:ct,late:ire,get ZodFirstPartyTypeKind(){return Fe},coerce:Ure,any:fre,array:_re,bigint:lre,boolean:tF,date:cre,discriminatedUnion:wre,effect:WR,enum:Ire,function:kre,instanceof:ore,intersection:Ere,lazy:Are,literal:Rre,map:Tre,nan:are,nativeEnum:Pre,never:mre,null:dre,nullable:Lre,number:eF,object:yre,oboolean:jre,onumber:Fre,optional:Dre,ostring:Bre,pipeline:Mre,preprocess:Nre,promise:Ore,record:Sre,set:Cre,strictObject:bre,string:Q4,symbol:ure,transformer:WR,tuple:xre,undefined:hre,union:vre,unknown:pre,void:gre,NEVER:$re,ZodIssueCode:Me,quotelessJson:Ute,ZodError:Yn});function Hre({prompt:t,useLegacyFunctionCalling:e=!1}){const r=[];for(const{role:n,content:s}of t)switch(n){case"system":{r.push({role:"system",content:s});break}case"user":{if(s.length===1&&s[0].type==="text"){r.push({role:"user",content:s[0].text});break}r.push({role:"user",content:s.map(i=>{var o,a,l;switch(i.type){case"text":return{type:"text",text:i.text};case"image":return{type:"image_url",image_url:{url:i.image instanceof URL?i.image.toString():`data:${(o=i.mimeType)!=null?o:"image/jpeg"};base64,${Wy(i.image)}`,detail:(l=(a=i.providerMetadata)==null?void 0:a.openai)==null?void 0:l.imageDetail}};case"file":throw new Fr({functionality:"File content parts in user messages"})}})});break}case"assistant":{let i="";const o=[];for(const a of s)switch(a.type){case"text":{i+=a.text;break}case"tool-call":{o.push({id:a.toolCallId,type:"function",function:{name:a.toolName,arguments:JSON.stringify(a.args)}});break}default:{const l=a;throw new Error(`Unsupported part: ${l}`)}}if(e){if(o.length>1)throw new Fr({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:i,function_call:o.length>0?o[0].function:void 0})}else r.push({role:"assistant",content:i,tool_calls:o.length>0?o:void 0});break}case"tool":{for(const i of s)e?r.push({role:"function",name:i.toolName,content:JSON.stringify(i.result)}):r.push({role:"tool",tool_call_id:i.toolCallId,content:JSON.stringify(i.result)});break}default:{const i=n;throw new Error(`Unsupported role: ${i}`)}}return r}function qR(t){var e,r;return(r=(e=t?.content)==null?void 0:e.map(({token:n,logprob:s,top_logprobs:i})=>({token:n,logprob:s,topLogprobs:i?i.map(({token:o,logprob:a})=>({token:o,logprob:a})):[]})))!=null?r:void 0}function z0(t){switch(t){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var wC=j.object({error:j.object({message:j.string(),type:j.string().nullish(),param:j.any().nullish(),code:j.union([j.string(),j.number()]).nullish()})}),mf=Vy({errorSchema:wC,errorToMessage:t=>t.error.message});function V0({id:t,model:e,created:r}){return{id:t??void 0,modelId:e??void 0,timestamp:r!=null?new Date(r*1e3):void 0}}var zre=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get supportsStructuredOutputs(){return this.settings.structuredOutputs===!0}get defaultObjectGenerationMode(){return this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u,providerMetadata:h}){var d,f,g,_,m,p,y;const b=t.type,v=[];i!=null&&v.push({type:"unsupported-setting",setting:"topK"}),c!=null&&c.type==="json"&&c.schema!=null&&v.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is not supported"});const w=this.settings.useLegacyFunctionCalling;if(w&&this.settings.parallelToolCalls===!0)throw new Fr({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(w&&this.settings.structuredOutputs===!0)throw new Fr({functionality:"structuredOutputs with useLegacyFunctionCalling"});const E={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:r,temperature:n,top_p:s,frequency_penalty:o,presence_penalty:a,stop:l,seed:u,max_completion_tokens:(f=(d=h?.openai)==null?void 0:d.maxCompletionTokens)!=null?f:void 0,store:(_=(g=h?.openai)==null?void 0:g.store)!=null?_:void 0,metadata:(p=(m=h?.openai)==null?void 0:m.metadata)!=null?p:void 0,response_format:c?.type==="json"?{type:"json_object"}:void 0,messages:Hre({prompt:e,useLegacyFunctionCalling:w})};switch(KR(this.modelId)&&(E.temperature=void 0,E.top_p=void 0,E.frequency_penalty=void 0,E.presence_penalty=void 0),b){case"regular":return{args:{...E,...Wre({mode:t,useLegacyFunctionCalling:w,structuredOutputs:this.settings.structuredOutputs})},warnings:v};case"object-json":return{args:{...E,response_format:this.settings.structuredOutputs===!0?{type:"json_schema",json_schema:{schema:t.schema,strict:!0,name:(y=t.name)!=null?y:"response",description:t.description}}:{type:"json_object"}},warnings:v};case"object-tool":return{args:w?{...E,function_call:{name:t.tool.name},functions:[{name:t.tool.name,description:t.tool.description,parameters:t.tool.parameters}]}:{...E,tool_choice:{type:"function",function:{name:t.tool.name}},tools:[{type:"function",function:{name:t.tool.name,description:t.tool.description,parameters:t.tool.parameters,strict:this.settings.structuredOutputs===!0?!0:void 0}}]},warnings:v};default:{const S=b;throw new Error(`Unsupported type: ${S}`)}}}async doGenerate(t){var e,r,n,s,i,o,a,l,c,u,h,d,f,g,_,m,p,y;const{args:b,warnings:v}=this.getArgs(t),{responseHeaders:w,value:E}=await Nn({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Qn(this.config.headers(),t.headers),body:b,failedResponseHandler:mf,successfulResponseHandler:Do(Vre),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:S,...x}=b,C=E.choices[0];let A;return(((r=(e=E.usage)==null?void 0:e.completion_tokens_details)==null?void 0:r.reasoning_tokens)!=null||((s=(n=E.usage)==null?void 0:n.prompt_tokens_details)==null?void 0:s.cached_tokens)!=null)&&(A={openai:{}},((o=(i=E.usage)==null?void 0:i.completion_tokens_details)==null?void 0:o.reasoning_tokens)!=null&&(A.openai.reasoningTokens=(l=(a=E.usage)==null?void 0:a.completion_tokens_details)==null?void 0:l.reasoning_tokens),((u=(c=E.usage)==null?void 0:c.prompt_tokens_details)==null?void 0:u.cached_tokens)!=null&&(A.openai.cachedPromptTokens=(d=(h=E.usage)==null?void 0:h.prompt_tokens_details)==null?void 0:d.cached_tokens)),{text:(f=C.message.content)!=null?f:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&C.message.function_call?[{toolCallType:"function",toolCallId:ea(),toolName:C.message.function_call.name,args:C.message.function_call.arguments}]:(g=C.message.tool_calls)==null?void 0:g.map(M=>{var P;return{toolCallType:"function",toolCallId:(P=M.id)!=null?P:ea(),toolName:M.function.name,args:M.function.arguments}}),finishReason:z0(C.finish_reason),usage:{promptTokens:(m=(_=E.usage)==null?void 0:_.prompt_tokens)!=null?m:NaN,completionTokens:(y=(p=E.usage)==null?void 0:p.completion_tokens)!=null?y:NaN},rawCall:{rawPrompt:S,rawSettings:x},rawResponse:{headers:w},response:V0(E),warnings:v,logprobs:qR(C.logprobs),providerMetadata:A}}async doStream(t){if(KR(this.modelId)){const g=await this.doGenerate(t);return{stream:new ReadableStream({start(m){if(m.enqueue({type:"response-metadata",...g.response}),g.text&&m.enqueue({type:"text-delta",textDelta:g.text}),g.toolCalls)for(const p of g.toolCalls)m.enqueue({type:"tool-call",...p});m.enqueue({type:"finish",finishReason:g.finishReason,usage:g.usage,logprobs:g.logprobs,providerMetadata:g.providerMetadata}),m.close()}}),rawCall:g.rawCall,rawResponse:g.rawResponse,warnings:g.warnings}}const{args:e,warnings:r}=this.getArgs(t),{responseHeaders:n,value:s}=await Nn({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Qn(this.config.headers(),t.headers),body:{...e,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},failedResponseHandler:mf,successfulResponseHandler:Gy(Gre),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:i,...o}=e,a=[];let l="unknown",c={promptTokens:void 0,completionTokens:void 0},u,h=!0;const{useLegacyFunctionCalling:d}=this.settings;let f;return{stream:s.pipeThrough(new TransformStream({transform(g,_){var m,p,y,b,v,w,E,S,x,C,A,M,P,D,R,G;if(!g.success){l="error",_.enqueue({type:"error",error:g.error});return}const ee=g.value;if("error"in ee){l="error",_.enqueue({type:"error",error:ee.error});return}h&&(h=!1,_.enqueue({type:"response-metadata",...V0(ee)})),ee.usage!=null&&(c={promptTokens:(m=ee.usage.prompt_tokens)!=null?m:void 0,completionTokens:(p=ee.usage.completion_tokens)!=null?p:void 0},((y=ee.usage.prompt_tokens_details)==null?void 0:y.cached_tokens)!=null&&(f={openai:{cachedPromptTokens:(b=ee.usage.prompt_tokens_details)==null?void 0:b.cached_tokens}}));const q=ee.choices[0];if(q?.finish_reason!=null&&(l=z0(q.finish_reason)),q?.delta==null)return;const re=q.delta;re.content!=null&&_.enqueue({type:"text-delta",textDelta:re.content});const N=qR(q?.logprobs);N?.length&&(u===void 0&&(u=[]),u.push(...N));const B=d&&re.function_call!=null?[{type:"function",id:ea(),function:re.function_call,index:0}]:re.tool_calls;if(B!=null)for(const $ of B){const H=$.index;if(a[H]==null){if($.type!=="function")throw new Lv({data:$,message:"Expected 'function' type."});if($.id==null)throw new Lv({data:$,message:"Expected 'id' to be a string."});if(((v=$.function)==null?void 0:v.name)==null)throw new Lv({data:$,message:"Expected 'function.name' to be a string."});a[H]={id:$.id,type:"function",function:{name:$.function.name,arguments:(w=$.function.arguments)!=null?w:""}};const Q=a[H];((E=Q.function)==null?void 0:E.name)!=null&&((S=Q.function)==null?void 0:S.arguments)!=null&&(Q.function.arguments.length>0&&_.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:Q.function.arguments}),VR(Q.function.arguments)&&_.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(x=Q.id)!=null?x:ea(),toolName:Q.function.name,args:Q.function.arguments}));continue}const U=a[H];((C=$.function)==null?void 0:C.arguments)!=null&&(U.function.arguments+=(M=(A=$.function)==null?void 0:A.arguments)!=null?M:""),_.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:U.id,toolName:U.function.name,argsTextDelta:(P=$.function.arguments)!=null?P:""}),((D=U.function)==null?void 0:D.name)!=null&&((R=U.function)==null?void 0:R.arguments)!=null&&VR(U.function.arguments)&&_.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(G=U.id)!=null?G:ea(),toolName:U.function.name,args:U.function.arguments})}},flush(g){var _,m;g.enqueue({type:"finish",finishReason:l,logprobs:u,usage:{promptTokens:(_=c.promptTokens)!=null?_:NaN,completionTokens:(m=c.completionTokens)!=null?m:NaN},...f!=null?{providerMetadata:f}:{}})}})),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:n},warnings:r}}},rF=j.object({prompt_tokens:j.number().nullish(),completion_tokens:j.number().nullish(),prompt_tokens_details:j.object({cached_tokens:j.number().nullish()}).nullish(),completion_tokens_details:j.object({reasoning_tokens:j.number().nullish()}).nullish()}).nullish(),Vre=j.object({id:j.string().nullish(),created:j.number().nullish(),model:j.string().nullish(),choices:j.array(j.object({message:j.object({role:j.literal("assistant").nullish(),content:j.string().nullish(),function_call:j.object({arguments:j.string(),name:j.string()}).nullish(),tool_calls:j.array(j.object({id:j.string().nullish(),type:j.literal("function"),function:j.object({name:j.string(),arguments:j.string()})})).nullish()}),index:j.number(),logprobs:j.object({content:j.array(j.object({token:j.string(),logprob:j.number(),top_logprobs:j.array(j.object({token:j.string(),logprob:j.number()}))})).nullable()}).nullish(),finish_reason:j.string().nullish()})),usage:rF}),Gre=j.union([j.object({id:j.string().nullish(),created:j.number().nullish(),model:j.string().nullish(),choices:j.array(j.object({delta:j.object({role:j.enum(["assistant"]).nullish(),content:j.string().nullish(),function_call:j.object({name:j.string().optional(),arguments:j.string().optional()}).nullish(),tool_calls:j.array(j.object({index:j.number(),id:j.string().nullish(),type:j.literal("function").optional(),function:j.object({name:j.string().nullish(),arguments:j.string().nullish()})})).nullish()}).nullish(),logprobs:j.object({content:j.array(j.object({token:j.string(),logprob:j.number(),top_logprobs:j.array(j.object({token:j.string(),logprob:j.number()}))})).nullable()}).nullish(),finish_reason:j.string().nullable().optional(),index:j.number()})),usage:rF}),wC]);function Wre({mode:t,useLegacyFunctionCalling:e=!1,structuredOutputs:r=!1}){var n;const s=(n=t.tools)!=null&&n.length?t.tools:void 0;if(s==null)return{tools:void 0,tool_choice:void 0};const i=t.toolChoice;if(e){const l=s.map(u=>({name:u.name,description:u.description,parameters:u.parameters}));if(i==null)return{functions:l,function_call:void 0};switch(i.type){case"auto":case"none":case void 0:return{functions:l,function_call:void 0};case"required":throw new Fr({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:l,function_call:{name:i.toolName}}}}const o=s.map(l=>({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters,strict:r===!0?!0:void 0}}));if(i==null)return{tools:o,tool_choice:void 0};const a=i.type;switch(a){case"auto":case"none":case"required":return{tools:o,tool_choice:a};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:i.toolName}}};default:{const l=a;throw new Error(`Unsupported tool choice type: ${l}`)}}}function KR(t){return t.startsWith("o1-")}function qre({prompt:t,inputFormat:e,user:r="user",assistant:n="assistant"}){if(e==="prompt"&&t.length===1&&t[0].role==="user"&&t[0].content.length===1&&t[0].content[0].type==="text")return{prompt:t[0].content[0].text};let s="";t[0].role==="system"&&(s+=`${t[0].content}

`,t=t.slice(1));for(const{role:i,content:o}of t)switch(i){case"system":throw new mte({message:"Unexpected system message in prompt: ${content}",prompt:t});case"user":{const a=o.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new Fr({functionality:"images"})}}).join("");s+=`${r}:
${a}

`;break}case"assistant":{const a=o.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new Fr({functionality:"tool-call messages"})}}).join("");s+=`${n}:
${a}

`;break}case"tool":throw new Fr({functionality:"tool messages"});default:{const a=i;throw new Error(`Unsupported role: ${a}`)}}return s+=`${n}:
`,{prompt:s,stopSequences:[`
${r}:`]}}function YR(t){return t?.tokens.map((e,r)=>({token:e,logprob:t.token_logprobs[r],topLogprobs:t.top_logprobs?Object.entries(t.top_logprobs[r]).map(([n,s])=>({token:n,logprob:s})):[]}))}var Kre=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}getArgs({mode:t,inputFormat:e,prompt:r,maxTokens:n,temperature:s,topP:i,topK:o,frequencyPenalty:a,presencePenalty:l,stopSequences:c,responseFormat:u,seed:h}){var d;const f=t.type,g=[];o!=null&&g.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&g.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:_,stopSequences:m}=qre({prompt:r,inputFormat:e}),p=[...m??[],...c??[]],y={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:n,temperature:s,top_p:i,frequency_penalty:a,presence_penalty:l,seed:h,prompt:_,stop:p.length>0?p:void 0};switch(f){case"regular":{if((d=t.tools)!=null&&d.length)throw new Fr({functionality:"tools"});if(t.toolChoice)throw new Fr({functionality:"toolChoice"});return{args:y,warnings:g}}case"object-json":throw new Fr({functionality:"object-json mode"});case"object-tool":throw new Fr({functionality:"object-tool mode"});default:{const b=f;throw new Error(`Unsupported type: ${b}`)}}}async doGenerate(t){const{args:e,warnings:r}=this.getArgs(t),{responseHeaders:n,value:s}=await Nn({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Qn(this.config.headers(),t.headers),body:e,failedResponseHandler:mf,successfulResponseHandler:Do(Yre),abortSignal:t.abortSignal,fetch:this.config.fetch}),{prompt:i,...o}=e,a=s.choices[0];return{text:a.text,usage:{promptTokens:s.usage.prompt_tokens,completionTokens:s.usage.completion_tokens},finishReason:z0(a.finish_reason),logprobs:YR(a.logprobs),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:n},response:V0(s),warnings:r}}async doStream(t){const{args:e,warnings:r}=this.getArgs(t),{responseHeaders:n,value:s}=await Nn({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Qn(this.config.headers(),t.headers),body:{...e,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},failedResponseHandler:mf,successfulResponseHandler:Gy(Xre),abortSignal:t.abortSignal,fetch:this.config.fetch}),{prompt:i,...o}=e;let a="unknown",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c,u=!0;return{stream:s.pipeThrough(new TransformStream({transform(h,d){if(!h.success){a="error",d.enqueue({type:"error",error:h.error});return}const f=h.value;if("error"in f){a="error",d.enqueue({type:"error",error:f.error});return}u&&(u=!1,d.enqueue({type:"response-metadata",...V0(f)})),f.usage!=null&&(l={promptTokens:f.usage.prompt_tokens,completionTokens:f.usage.completion_tokens});const g=f.choices[0];g?.finish_reason!=null&&(a=z0(g.finish_reason)),g?.text!=null&&d.enqueue({type:"text-delta",textDelta:g.text});const _=YR(g?.logprobs);_?.length&&(c===void 0&&(c=[]),c.push(..._))},flush(h){h.enqueue({type:"finish",finishReason:a,logprobs:c,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:n},warnings:r}}},Yre=j.object({id:j.string().nullish(),created:j.number().nullish(),model:j.string().nullish(),choices:j.array(j.object({text:j.string(),finish_reason:j.string(),logprobs:j.object({tokens:j.array(j.string()),token_logprobs:j.array(j.number()),top_logprobs:j.array(j.record(j.string(),j.number())).nullable()}).nullish()})),usage:j.object({prompt_tokens:j.number(),completion_tokens:j.number()})}),Xre=j.union([j.object({id:j.string().nullish(),created:j.number().nullish(),model:j.string().nullish(),choices:j.array(j.object({text:j.string(),finish_reason:j.string().nullish(),index:j.number(),logprobs:j.object({tokens:j.array(j.string()),token_logprobs:j.array(j.number()),top_logprobs:j.array(j.record(j.string(),j.number())).nullable()}).nullish()})),usage:j.object({prompt_tokens:j.number(),completion_tokens:j.number()}).nullish()}),wC]),Zre=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var t;return(t=this.settings.maxEmbeddingsPerCall)!=null?t:2048}get supportsParallelCalls(){var t;return(t=this.settings.supportsParallelCalls)!=null?t:!0}async doEmbed({values:t,headers:e,abortSignal:r}){if(t.length>this.maxEmbeddingsPerCall)throw new zy({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:t});const{responseHeaders:n,value:s}=await Nn({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Qn(this.config.headers(),e),body:{model:this.modelId,input:t,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:mf,successfulResponseHandler:Do(Jre),abortSignal:r,fetch:this.config.fetch});return{embeddings:s.data.map(i=>i.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:n}}}},Jre=j.object({data:j.array(j.object({embedding:j.array(j.number())})),usage:j.object({prompt_tokens:j.number()}).nullish()});function zi(t={}){var e,r,n;const s=(r=qy((e=t.baseURL)!=null?e:t.baseUrl))!=null?r:"https://api.openai.com/v1",i=(n=t.compatibility)!=null?n:"compatible",o=()=>({Authorization:`Bearer ${yC({apiKey:t.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":t.organization,"OpenAI-Project":t.project,...t.headers}),a=(d,f={})=>new zre(d,f,{provider:"openai.chat",url:({path:g})=>`${s}${g}`,headers:o,compatibility:i,fetch:t.fetch}),l=(d,f={})=>new Kre(d,f,{provider:"openai.completion",url:({path:g})=>`${s}${g}`,headers:o,compatibility:i,fetch:t.fetch}),c=(d,f={})=>new Zre(d,f,{provider:"openai.embedding",url:({path:g})=>`${s}${g}`,headers:o,fetch:t.fetch}),u=(d,f)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return d==="gpt-3.5-turbo-instruct"?l(d,f):a(d,f)},h=function(d,f){return u(d,f)};return h.languageModel=u,h.chat=a,h.completion=l,h.embedding=c,h.textEmbedding=c,h.textEmbeddingModel=c,h}zi({compatibility:"strict"});class Ir{cachedDynamicModels;getApiKeyLink;labelForGetApiKey;icon;getProviderBaseUrlAndKey(e){const{apiKeys:r,providerSettings:n,serverEnv:s,defaultBaseUrlKey:i,defaultApiTokenKey:o}=e;let a=n?.baseUrl;const l=aa.getInstance();a&&a.length==0&&(a=void 0);const c=this.config.baseUrlKey||i;let u=a||s?.[c]||Dt?.env?.[c]||l.env?.[c]||this.config.baseUrl;u&&u.endsWith("/")&&(u=u.slice(0,-1));const h=this.config.apiTokenKey||o,d=r?.[this.name]||s?.[h]||Dt?.env?.[h]||l.env?.[h];return{baseUrl:u,apiKey:d}}getModelsFromCache(e){if(!this.cachedDynamicModels)return null;const r=this.cachedDynamicModels.cacheId,n=this.getDynamicModelsCacheKey(e);return r!==n?(this.cachedDynamicModels=void 0,null):this.cachedDynamicModels.models}getDynamicModelsCacheKey(e){return JSON.stringify({apiKeys:e.apiKeys?.[this.name],providerSettings:e.providerSettings?.[this.name],serverEnv:e.serverEnv})}storeDynamicModels(e,r){const n=this.getDynamicModelsCacheKey(e);this.cachedDynamicModels={cacheId:n,models:r}}}function nF(t,e,r){return zi({baseURL:t,apiKey:e})(r)}var sF="vercel.ai.error",Qre=Symbol.for(sF),iF,ene=class oF extends Error{constructor({name:e,message:r,cause:n}){super(r),this[iF]=!0,this.name=e,this.cause=n}static isInstance(e){return oF.hasMarker(e,sF)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}toJSON(){return{name:this.name,message:this.message}}};iF=Qre;var Ts=ene,OE="AI_APICallError",aF=`vercel.ai.error.${OE}`,tne=Symbol.for(aF),lF,no=class extends Ts{constructor({message:e,url:r,requestBodyValues:n,statusCode:s,responseHeaders:i,responseBody:o,cause:a,isRetryable:l=s!=null&&(s===408||s===409||s===429||s>=500),data:c}){super({name:OE,message:e,cause:a}),this[lF]=!0,this.url=r,this.requestBodyValues=n,this.statusCode=s,this.responseHeaders=i,this.responseBody=o,this.isRetryable=l,this.data=c}static isInstance(e){return Ts.hasMarker(e,aF)}static isAPICallError(e){return e instanceof Error&&e.name===OE&&typeof e.url=="string"&&typeof e.requestBodyValues=="object"&&(e.statusCode==null||typeof e.statusCode=="number")&&(e.responseHeaders==null||typeof e.responseHeaders=="object")&&(e.responseBody==null||typeof e.responseBody=="string")&&(e.cause==null||typeof e.cause=="object")&&typeof e.isRetryable=="boolean"&&(e.data==null||typeof e.data=="object")}toJSON(){return{name:this.name,message:this.message,url:this.url,requestBodyValues:this.requestBodyValues,statusCode:this.statusCode,responseHeaders:this.responseHeaders,responseBody:this.responseBody,cause:this.cause,isRetryable:this.isRetryable,data:this.data}}};lF=tne;var DE="AI_EmptyResponseBodyError",cF=`vercel.ai.error.${DE}`,rne=Symbol.for(cF),uF,nne=class extends Ts{constructor({message:e="Empty response body"}={}){super({name:DE,message:e}),this[uF]=!0}static isInstance(e){return Ts.hasMarker(e,cF)}static isEmptyResponseBodyError(e){return e instanceof Error&&e.name===DE}};uF=rne;function hF(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var LE="AI_JSONParseError",dF=`vercel.ai.error.${LE}`,sne=Symbol.for(dF),fF,G0=class extends Ts{constructor({text:e,cause:r}){super({name:LE,message:`JSON parsing failed: Text: ${e}.
Error message: ${hF(r)}`,cause:r}),this[fF]=!0,this.text=e}static isInstance(e){return Ts.hasMarker(e,dF)}static isJSONParseError(e){return e instanceof Error&&e.name===LE&&typeof e.text=="string"&&typeof e.cause=="string"}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,valueText:this.text}}};fF=sne;var NE="AI_LoadAPIKeyError",pF=`vercel.ai.error.${NE}`,ine=Symbol.for(pF),mF,Lm=class extends Ts{constructor({message:e}){super({name:NE,message:e}),this[mF]=!0}static isInstance(e){return Ts.hasMarker(e,pF)}static isLoadAPIKeyError(e){return e instanceof Error&&e.name===NE}};mF=ine;var ME="AI_TypeValidationError",gF=`vercel.ai.error.${ME}`,one=Symbol.for(gF),_F,bd=class extends Ts{constructor({value:e,cause:r}){super({name:ME,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${hF(r)}`,cause:r}),this[_F]=!0,this.value=e}static isInstance(e){return Ts.hasMarker(e,gF)}static isTypeValidationError(e){return e instanceof Error&&e.name===ME}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,value:this.value}}};_F=one;var BE="AI_UnsupportedFunctionalityError",yF=`vercel.ai.error.${BE}`,ane=Symbol.for(yF),bF,FE=class extends Ts{constructor({functionality:e}){super({name:BE,message:`'${e}' functionality not supported.`}),this[bF]=!0,this.functionality=e}static isInstance(e){return Ts.hasMarker(e,yF)}static isUnsupportedFunctionalityError(e){return e instanceof Error&&e.name===BE&&typeof e.functionality=="string"}toJSON(){return{name:this.name,message:this.message,stack:this.stack,functionality:this.functionality}}};bF=ane;var lne={};function XR(...t){return t.reduce((e,r)=>({...e,...r??{}}),{})}function Yy(t){const e={};return t.headers.forEach((r,n)=>{e[n]=r}),e}function Bv(t){return t instanceof Error&&(t.name==="AbortError"||t.name==="TimeoutError")}function cne({apiKey:t,environmentVariableName:e,apiKeyParameterName:r="apiKey",description:n}){if(typeof t=="string")return t;if(t!=null)throw new Lm({message:`${n} API key must be a string.`});if(typeof Dt>"u")throw new Lm({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=lne[e],t==null)throw new Lm({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new Lm({message:`${n} API key must be a string. The value of the ${e} environment variable is not a string.`});return t}var jE=Symbol.for("vercel.ai.validator");function une(t){return{[jE]:!0,validate:t}}function hne(t){return typeof t=="object"&&t!==null&&jE in t&&t[jE]===!0&&"validate"in t}function dne(t){return une(e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}})}function fne({value:t,schema:e}){const r=vF({value:t,schema:e});if(!r.success)throw new bd({value:t,cause:r.error});return r.value}function vF({value:t,schema:e}){const r=hne(e)?e:dne(e);try{if(r.validate==null)return{success:!0,value:t};const n=r.validate(t);return n.success?n:{success:!1,error:new bd({value:t,cause:n.error})}}catch(n){return{success:!1,error:bd.isTypeValidationError(n)?n:new bd({value:t,cause:n})}}}function pne({text:t,schema:e}){try{const r=Ws.parse(t);return e==null?r:fne({value:r,schema:e})}catch(r){throw G0.isJSONParseError(r)||bd.isTypeValidationError(r)?r:new G0({text:t,cause:r})}}function wF({text:t,schema:e}){try{const r=Ws.parse(t);return e==null?{success:!0,value:r}:vF({value:r,schema:e})}catch(r){return{success:!1,error:G0.isJSONParseError(r)?r:new G0({text:t,cause:r})}}}function mne(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!=null))}var gne=()=>fetch,ZR=async({url:t,headers:e,body:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o})=>_ne({url:t,headers:{"Content-Type":"application/json",...e},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o}),_ne=async({url:t,headers:e={},body:r,successfulResponseHandler:n,failedResponseHandler:s,abortSignal:i,fetch:o=gne()})=>{try{const a=await o(t,{method:"POST",headers:mne(e),body:r.content,signal:i}),l=Yy(a);if(!a.ok){let c;try{c=await s({response:a,url:t,requestBodyValues:r.values})}catch(u){throw Bv(u)||no.isAPICallError(u)?u:new no({message:"Failed to process error response",cause:u,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}throw c.value}try{return await n({response:a,url:t,requestBodyValues:r.values})}catch(c){throw c instanceof Error&&(Bv(c)||no.isAPICallError(c))?c:new no({message:"Failed to process successful response",cause:c,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}}catch(a){if(Bv(a))throw a;if(a instanceof TypeError&&a.message==="fetch failed"){const l=a.cause;if(l!=null)throw new no({message:`Cannot connect to API: ${l.message}`,cause:l,url:t,requestBodyValues:r.values,isRetryable:!0})}throw a}},yne=({errorSchema:t,errorToMessage:e,isRetryable:r})=>async({response:n,url:s,requestBodyValues:i})=>{const o=await n.text(),a=Yy(n);if(o.trim()==="")return{responseHeaders:a,value:new no({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})};try{const l=pne({text:o,schema:t});return{responseHeaders:a,value:new no({message:e(l),url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,data:l,isRetryable:r?.(n,l)})}}catch{return{responseHeaders:a,value:new no({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})}}},bne=t=>async({response:e})=>{const r=Yy(e);if(e.body==null)throw new nne({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new _C).pipeThrough(new TransformStream({transform({data:n},s){n!=="[DONE]"&&s.enqueue(wF({text:n,schema:t}))}}))}},vne=t=>async({response:e,url:r,requestBodyValues:n})=>{const s=await e.text(),i=wF({text:s,schema:t}),o=Yy(e);if(!i.success)throw new no({message:"Invalid JSON response",cause:i.error,statusCode:e.status,responseHeaders:o,responseBody:s,url:r,requestBodyValues:n});return{responseHeaders:o,value:i.value}};function wne(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCodePoint(t[r]);return globalThis.btoa(e)}function Ene(t){return t?.replace(/\/$/,"")}var xne=j.object({type:j.literal("error"),error:j.object({type:j.string(),message:j.string()})}),JR=yne({errorSchema:xne,errorToMessage:t=>t.error.message});function Sne(t){var e;const r=Tne(t);let n;const s=[];for(let i=0;i<r.length;i++){const o=r[i],a=o.type;switch(a){case"system":{if(n!=null)throw new FE({functionality:"Multiple system messages that are separated by user/assistant messages"});n=o.messages.map(({content:l})=>l).join(`
`);break}case"user":{const l=[];for(const{role:c,content:u}of o.messages)switch(c){case"user":{for(const h of u)switch(h.type){case"text":{l.push({type:"text",text:h.text});break}case"image":{if(h.image instanceof URL)throw new FE({functionality:"Image URLs in user messages"});l.push({type:"image",source:{type:"base64",media_type:(e=h.mimeType)!=null?e:"image/jpeg",data:wne(h.image)}});break}}break}case"tool":{for(const h of u)l.push({type:"tool_result",tool_use_id:h.toolCallId,content:JSON.stringify(h.result),is_error:h.isError});break}default:{const h=c;throw new Error(`Unsupported role: ${h}`)}}s.push({role:"user",content:l});break}case"assistant":{const l=[];for(const{content:c}of o.messages)for(let u=0;u<c.length;u++){const h=c[u];switch(h.type){case"text":{l.push({type:"text",text:i===r.length-1&&u===o.messages.length-1?h.text.trim():h.text});break}case"tool-call":{l.push({type:"tool_use",id:h.toolCallId,name:h.toolName,input:h.args});break}}}s.push({role:"assistant",content:l});break}default:{const l=a;throw new Error(`Unsupported type: ${l}`)}}}return{system:n,messages:s}}function Tne(t){const e=[];let r;for(const{role:n,content:s}of t)switch(n){case"system":{r?.type!=="system"&&(r={type:"system",messages:[]},e.push(r)),r.messages.push({role:n,content:s});break}case"assistant":{r?.type!=="assistant"&&(r={type:"assistant",messages:[]},e.push(r)),r.messages.push({role:n,content:s});break}case"user":{r?.type!=="user"&&(r={type:"user",messages:[]},e.push(r)),r.messages.push({role:n,content:s});break}case"tool":{r?.type!=="user"&&(r={type:"user",messages:[]},e.push(r)),r.messages.push({role:n,content:s});break}default:{const i=n;throw new Error(`Unsupported role: ${i}`)}}return e}function QR(t){switch(t){case"end_turn":case"stop_sequence":return"stop";case"tool_use":return"tool-calls";case"max_tokens":return"length";default:return"other"}}var Cne=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.supportsImageUrls=!1,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}async getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u}){const h=t.type,d=[];o!=null&&d.push({type:"unsupported-setting",setting:"frequencyPenalty"}),a!=null&&d.push({type:"unsupported-setting",setting:"presencePenalty"}),u!=null&&d.push({type:"unsupported-setting",setting:"seed"}),c!=null&&c.type!=="text"&&d.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const f=Sne(e),g={model:this.modelId,top_k:i??this.settings.topK,max_tokens:r??4096,temperature:n,top_p:s,stop_sequences:l,system:f.system,messages:f.messages};switch(h){case"regular":return{args:{...g,...Rne(t)},warnings:d};case"object-json":throw new FE({functionality:"json-mode object generation"});case"object-tool":{const{name:_,description:m,parameters:p}=t.tool;return{args:{...g,tools:[{name:_,description:m,input_schema:p}],tool_choice:{type:"tool",name:_}},warnings:d}}default:{const _=h;throw new Error(`Unsupported type: ${_}`)}}}async doGenerate(t){const{args:e,warnings:r}=await this.getArgs(t),{responseHeaders:n,value:s}=await ZR({url:`${this.config.baseURL}/messages`,headers:XR(this.config.headers(),t.headers),body:e,failedResponseHandler:JR,successfulResponseHandler:vne(kne),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:i,...o}=e;let a="";for(const c of s.content)c.type==="text"&&(a+=c.text);let l;if(s.content.some(c=>c.type==="tool_use")){l=[];for(const c of s.content)c.type==="tool_use"&&l.push({toolCallType:"function",toolCallId:c.id,toolName:c.name,args:JSON.stringify(c.input)})}return{text:a,toolCalls:l,finishReason:QR(s.stop_reason),usage:{promptTokens:s.usage.input_tokens,completionTokens:s.usage.output_tokens},rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:n},warnings:r}}async doStream(t){const{args:e,warnings:r}=await this.getArgs(t),{responseHeaders:n,value:s}=await ZR({url:`${this.config.baseURL}/messages`,headers:XR(this.config.headers(),t.headers),body:{...e,stream:!0},failedResponseHandler:JR,successfulResponseHandler:bne(Ane),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:i,...o}=e;let a="other";const l={promptTokens:Number.NaN,completionTokens:Number.NaN},c={};return{stream:s.pipeThrough(new TransformStream({transform(u,h){if(!u.success){h.enqueue({type:"error",error:u.error});return}const d=u.value;switch(d.type){case"ping":return;case"content_block_start":{const f=d.content_block.type;switch(f){case"text":return;case"tool_use":{c[d.index]={toolCallId:d.content_block.id,toolName:d.content_block.name,jsonText:""};return}default:{const g=f;throw new Error(`Unsupported content block type: ${g}`)}}}case"content_block_stop":{if(c[d.index]!=null){const f=c[d.index];h.enqueue({type:"tool-call",toolCallType:"function",toolCallId:f.toolCallId,toolName:f.toolName,args:f.jsonText}),delete c[d.index]}return}case"content_block_delta":{const f=d.delta.type;switch(f){case"text_delta":{h.enqueue({type:"text-delta",textDelta:d.delta.text});return}case"input_json_delta":{const g=c[d.index];h.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:g.toolCallId,toolName:g.toolName,argsTextDelta:d.delta.partial_json}),g.jsonText+=d.delta.partial_json;return}default:{const g=f;throw new Error(`Unsupported delta type: ${g}`)}}}case"message_start":{l.promptTokens=d.message.usage.input_tokens,l.completionTokens=d.message.usage.output_tokens;return}case"message_delta":{l.completionTokens=d.usage.output_tokens,a=QR(d.delta.stop_reason);return}case"message_stop":{h.enqueue({type:"finish",finishReason:a,usage:l});return}case"error":{h.enqueue({type:"error",error:d.error});return}default:{const f=d;throw new Error(`Unsupported chunk type: ${f}`)}}}})),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:n},warnings:r}}},kne=j.object({type:j.literal("message"),content:j.array(j.discriminatedUnion("type",[j.object({type:j.literal("text"),text:j.string()}),j.object({type:j.literal("tool_use"),id:j.string(),name:j.string(),input:j.unknown()})])),stop_reason:j.string().optional().nullable(),usage:j.object({input_tokens:j.number(),output_tokens:j.number()})}),Ane=j.discriminatedUnion("type",[j.object({type:j.literal("message_start"),message:j.object({usage:j.object({input_tokens:j.number(),output_tokens:j.number()})})}),j.object({type:j.literal("content_block_start"),index:j.number(),content_block:j.discriminatedUnion("type",[j.object({type:j.literal("text"),text:j.string()}),j.object({type:j.literal("tool_use"),id:j.string(),name:j.string()})])}),j.object({type:j.literal("content_block_delta"),index:j.number(),delta:j.discriminatedUnion("type",[j.object({type:j.literal("input_json_delta"),partial_json:j.string()}),j.object({type:j.literal("text_delta"),text:j.string()})])}),j.object({type:j.literal("content_block_stop"),index:j.number()}),j.object({type:j.literal("error"),error:j.object({type:j.string(),message:j.string()})}),j.object({type:j.literal("message_delta"),delta:j.object({stop_reason:j.string().optional().nullable()}),usage:j.object({output_tokens:j.number()})}),j.object({type:j.literal("message_stop")}),j.object({type:j.literal("ping")})]);function Rne(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0;if(r==null)return{tools:void 0,tool_choice:void 0};const n=r.map(o=>({name:o.name,description:o.description,input_schema:o.parameters})),s=t.toolChoice;if(s==null)return{tools:n,tool_choice:void 0};const i=s.type;switch(i){case"auto":return{tools:n,tool_choice:{type:"auto"}};case"required":return{tools:n,tool_choice:{type:"any"}};case"none":return{tools:void 0,tool_choice:void 0};case"tool":return{tools:n,tool_choice:{type:"tool",name:s.toolName}};default:{const o=i;throw new Error(`Unsupported tool choice type: ${o}`)}}}function EF(t={}){var e,r;const n=(r=Ene((e=t.baseURL)!=null?e:t.baseUrl))!=null?r:"https://api.anthropic.com/v1",s=()=>({"anthropic-version":"2023-06-01","x-api-key":cne({apiKey:t.apiKey,environmentVariableName:"ANTHROPIC_API_KEY",description:"Anthropic"}),...t.headers}),i=(a,l={})=>new Cne(a,l,{provider:"anthropic.messages",baseURL:n,headers:s,fetch:t.fetch}),o=function(a,l){if(new.target)throw new Error("The Anthropic model function cannot be called with the new keyword.");return i(a,l)};return o.languageModel=i,o.chat=i,o.messages=i,o}EF();class Ine extends Ir{name="Anthropic";getApiKeyLink="https://console.anthropic.com/settings/keys";config={apiTokenKey:"ANTHROPIC_API_KEY"};staticModels=[{name:"claude-3-5-sonnet-latest",label:"Claude 3.5 Sonnet (new)",provider:"Anthropic",maxTokenAllowed:8e3},{name:"claude-3-5-sonnet-20240620",label:"Claude 3.5 Sonnet (old)",provider:"Anthropic",maxTokenAllowed:8e3},{name:"claude-3-5-haiku-latest",label:"Claude 3.5 Haiku (new)",provider:"Anthropic",maxTokenAllowed:8e3},{name:"claude-3-opus-latest",label:"Claude 3 Opus",provider:"Anthropic",maxTokenAllowed:8e3},{name:"claude-3-sonnet-20240229",label:"Claude 3 Sonnet",provider:"Anthropic",maxTokenAllowed:8e3},{name:"claude-3-haiku-20240307",label:"Claude 3 Haiku",provider:"Anthropic",maxTokenAllowed:8e3}];getModelInstance=e=>{const{apiKeys:r,providerSettings:n,serverEnv:s,model:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:r,providerSettings:n,serverEnv:s,defaultBaseUrlKey:"",defaultApiTokenKey:"ANTHROPIC_API_KEY"});return EF({apiKey:o})(i)}}var xF="vercel.ai.error",Pne=Symbol.for(xF),SF,One=class TF extends Error{constructor({name:e,message:r,cause:n}){super(r),this[SF]=!0,this.name=e,this.cause=n}static isInstance(e){return TF.hasMarker(e,xF)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}};SF=Pne;var tn=One,CF="AI_APICallError",kF=`vercel.ai.error.${CF}`,Dne=Symbol.for(kF),AF,so=class extends tn{constructor({message:e,url:r,requestBodyValues:n,statusCode:s,responseHeaders:i,responseBody:o,cause:a,isRetryable:l=s!=null&&(s===408||s===409||s===429||s>=500),data:c}){super({name:CF,message:e,cause:a}),this[AF]=!0,this.url=r,this.requestBodyValues=n,this.statusCode=s,this.responseHeaders=i,this.responseBody=o,this.isRetryable=l,this.data=c}static isInstance(e){return tn.hasMarker(e,kF)}};AF=Dne;var RF="AI_EmptyResponseBodyError",IF=`vercel.ai.error.${RF}`,Lne=Symbol.for(IF),PF,Nne=class extends tn{constructor({message:e="Empty response body"}={}){super({name:RF,message:e}),this[PF]=!0}static isInstance(e){return tn.hasMarker(e,IF)}};PF=Lne;function OF(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var DF="AI_InvalidArgumentError",LF=`vercel.ai.error.${DF}`,Mne=Symbol.for(LF),NF,Bne=class extends tn{constructor({message:e,cause:r,argument:n}){super({name:DF,message:e,cause:r}),this[NF]=!0,this.argument=n}static isInstance(e){return tn.hasMarker(e,LF)}};NF=Mne;var MF="AI_JSONParseError",BF=`vercel.ai.error.${MF}`,Fne=Symbol.for(BF),FF,W0=class extends tn{constructor({text:e,cause:r}){super({name:MF,message:`JSON parsing failed: Text: ${e}.
Error message: ${OF(r)}`,cause:r}),this[FF]=!0,this.text=e}static isInstance(e){return tn.hasMarker(e,BF)}};FF=Fne;var jF="AI_LoadAPIKeyError",UF=`vercel.ai.error.${jF}`,jne=Symbol.for(UF),$F,Nm=class extends tn{constructor({message:e}){super({name:jF,message:e}),this[$F]=!0}static isInstance(e){return tn.hasMarker(e,UF)}};$F=jne;var HF="AI_TooManyEmbeddingValuesForCallError",zF=`vercel.ai.error.${HF}`,Une=Symbol.for(zF),VF,$ne=class extends tn{constructor(t){super({name:HF,message:`Too many values for a single embedding call. The ${t.provider} model "${t.modelId}" can only embed up to ${t.maxEmbeddingsPerCall} values per call, but ${t.values.length} values were provided.`}),this[VF]=!0,this.provider=t.provider,this.modelId=t.modelId,this.maxEmbeddingsPerCall=t.maxEmbeddingsPerCall,this.values=t.values}static isInstance(t){return tn.hasMarker(t,zF)}};VF=Une;var GF="AI_TypeValidationError",WF=`vercel.ai.error.${GF}`,Hne=Symbol.for(WF),qF,zne=class UE extends tn{constructor({value:e,cause:r}){super({name:GF,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${OF(r)}`,cause:r}),this[qF]=!0,this.value=e}static isInstance(e){return tn.hasMarker(e,WF)}static wrap({value:e,cause:r}){return UE.isInstance(r)&&r.value===e?r:new UE({value:e,cause:r})}};qF=Hne;var q0=zne,KF="AI_UnsupportedFunctionalityError",YF=`vercel.ai.error.${KF}`,Vne=Symbol.for(YF),XF,eu=class extends tn{constructor({functionality:e}){super({name:KF,message:`'${e}' functionality not supported.`}),this[XF]=!0,this.functionality=e}static isInstance(e){return tn.hasMarker(e,YF)}};XF=Vne;let EC=(t,e=21)=>(r=e)=>{let n="",s=r|0;for(;s--;)n+=t[Math.random()*t.length|0];return n};var Gne=Object.defineProperty,Wne=(t,e,r)=>e in t?Gne(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Mm=(t,e,r)=>Wne(t,typeof e!="symbol"?e+"":e,r);let eI=class extends Error{constructor(e,r){super(e),Mm(this,"type"),Mm(this,"field"),Mm(this,"value"),Mm(this,"line"),this.name="ParseError",this.type=r.type,this.field=r.field,this.value=r.value,this.line=r.line}};function Fv(t){}function qne(t){const{onEvent:e=Fv,onError:r=Fv,onRetry:n=Fv,onComment:s}=t;let i="",o=!0,a,l="",c="";function u(_){const m=o?_.replace(/^\xEF\xBB\xBF/,""):_,[p,y]=Kne(`${i}${m}`);for(const b of p)h(b);i=y,o=!1}function h(_){if(_===""){f();return}if(_.startsWith(":")){s&&s(_.slice(_.startsWith(": ")?2:1));return}const m=_.indexOf(":");if(m!==-1){const p=_.slice(0,m),y=_[m+1]===" "?2:1,b=_.slice(m+y);d(p,b,_);return}d(_,"",_)}function d(_,m,p){switch(_){case"event":c=m;break;case"data":l=`${l}${m}
`;break;case"id":a=m.includes("\0")?void 0:m;break;case"retry":/^\d+$/.test(m)?n(parseInt(m,10)):r(new eI(`Invalid \`retry\` value: "${m}"`,{type:"invalid-retry",value:m,line:p}));break;default:r(new eI(`Unknown field "${_.length>20?`${_.slice(0,20)}…`:_}"`,{type:"unknown-field",field:_,value:m,line:p}));break}}function f(){l.length>0&&e({id:a,event:c||void 0,data:l.endsWith(`
`)?l.slice(0,-1):l}),a=void 0,l="",c=""}function g(_={}){i&&_.consume&&h(i),a=void 0,l="",c="",i=""}return{feed:u,reset:g}}function Kne(t){const e=[];let r="";const n=t.length;for(let s=0;s<n;s++){const i=t[s];i==="\r"&&t[s+1]===`
`?(e.push(r),r="",s++):i==="\r"||i===`
`?(e.push(r),r=""):r+=i}return[e,r]}class Yne extends TransformStream{constructor({onError:e,onRetry:r,onComment:n}={}){let s;super({start(i){s=qne({onEvent:o=>{i.enqueue(o)},onError(o){e==="terminate"?i.error(o):typeof e=="function"&&e(o)},onRetry:r,onComment:n})},transform(i){s.feed(i)}})}}var Xne={};function $E(...t){return t.reduce((e,r)=>({...e,...r??{}}),{})}function Xy(t){const e={};return t.headers.forEach((r,n)=>{e[n]=r}),e}var Zne=({prefix:t,size:e=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{const s=EC(r,e);if(t==null)return s;if(r.includes(n))throw new Bne({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return i=>`${t}${n}${s(i)}`};Zne();function jv(t){return t instanceof Error&&(t.name==="AbortError"||t.name==="TimeoutError")}function Jne({apiKey:t,environmentVariableName:e,apiKeyParameterName:r="apiKey",description:n}){if(typeof t=="string")return t;if(t!=null)throw new Nm({message:`${n} API key must be a string.`});if(typeof Dt>"u")throw new Nm({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=Xne[e],t==null)throw new Nm({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new Nm({message:`${n} API key must be a string. The value of the ${e} environment variable is not a string.`});return t}var HE=Symbol.for("vercel.ai.validator");function Qne(t){return{[HE]:!0,validate:t}}function ese(t){return typeof t=="object"&&t!==null&&HE in t&&t[HE]===!0&&"validate"in t}function tse(t){return ese(t)?t:rse(t)}function rse(t){return Qne(e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}})}function nse({value:t,schema:e}){const r=ZF({value:t,schema:e});if(!r.success)throw q0.wrap({value:t,cause:r.error});return r.value}function ZF({value:t,schema:e}){const r=tse(e);try{if(r.validate==null)return{success:!0,value:t};const n=r.validate(t);return n.success?n:{success:!1,error:q0.wrap({value:t,cause:n.error})}}catch(n){return{success:!1,error:q0.wrap({value:t,cause:n})}}}function sse({text:t,schema:e}){try{const r=Ws.parse(t);return e==null?r:nse({value:r,schema:e})}catch(r){throw W0.isInstance(r)||q0.isInstance(r)?r:new W0({text:t,cause:r})}}function JF({text:t,schema:e}){try{const r=Ws.parse(t);return e==null?{success:!0,value:r}:ZF({value:r,schema:e})}catch(r){return{success:!1,error:W0.isInstance(r)?r:new W0({text:t,cause:r})}}}function ise(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!=null))}var ose=()=>globalThis.fetch,zE=async({url:t,headers:e,body:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o})=>ase({url:t,headers:{"Content-Type":"application/json",...e},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o}),ase=async({url:t,headers:e={},body:r,successfulResponseHandler:n,failedResponseHandler:s,abortSignal:i,fetch:o=ose()})=>{try{const a=await o(t,{method:"POST",headers:ise(e),body:r.content,signal:i}),l=Xy(a);if(!a.ok){let c;try{c=await s({response:a,url:t,requestBodyValues:r.values})}catch(u){throw jv(u)||so.isInstance(u)?u:new so({message:"Failed to process error response",cause:u,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}throw c.value}try{return await n({response:a,url:t,requestBodyValues:r.values})}catch(c){throw c instanceof Error&&(jv(c)||so.isInstance(c))?c:new so({message:"Failed to process successful response",cause:c,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}}catch(a){if(jv(a))throw a;if(a instanceof TypeError&&a.message==="fetch failed"){const l=a.cause;if(l!=null)throw new so({message:`Cannot connect to API: ${l.message}`,cause:l,url:t,requestBodyValues:r.values,isRetryable:!0})}throw a}},lse=({errorSchema:t,errorToMessage:e,isRetryable:r})=>async({response:n,url:s,requestBodyValues:i})=>{const o=await n.text(),a=Xy(n);if(o.trim()==="")return{responseHeaders:a,value:new so({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})};try{const l=sse({text:o,schema:t});return{responseHeaders:a,value:new so({message:e(l),url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,data:l,isRetryable:r?.(n,l)})}}catch{return{responseHeaders:a,value:new so({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})}}},cse=t=>async({response:e})=>{const r=Xy(e);if(e.body==null)throw new Nne({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new Yne).pipeThrough(new TransformStream({transform({data:n},s){n!=="[DONE]"&&s.enqueue(JF({text:n,schema:t}))}}))}},QF=t=>async({response:e,url:r,requestBodyValues:n})=>{const s=await e.text(),i=JF({text:s,schema:t}),o=Xy(e);if(!i.success)throw new so({message:"Invalid JSON response",cause:i.error,statusCode:e.status,responseHeaders:o,responseBody:s,url:r,requestBodyValues:n});return{responseHeaders:o,value:i.value}};function use(t){return t?.replace(/\/$/,"")}var hse=j.object({message:j.string()}),VE=lse({errorSchema:hse,errorToMessage:t=>t.message});function dse(t){const e=[];for(const{role:r,content:n}of t)switch(r){case"system":{e.push({role:"system",content:n});break}case"user":{e.push({role:"user",content:n.map(s=>{switch(s.type){case"text":return s.text;case"image":throw new eu({functionality:"image-part"})}}).join("")});break}case"assistant":{let s="";const i=[];for(const o of n)switch(o.type){case"text":{s+=o.text;break}case"tool-call":{i.push({id:o.toolCallId,type:"function",function:{name:o.toolName,arguments:JSON.stringify(o.args)}});break}default:{const a=o;throw new Error(`Unsupported part: ${a}`)}}e.push({role:"assistant",content:s!==""?s:"call tool",tool_calls:i.length>0?i:void 0,tool_plan:void 0});break}case"tool":{e.push(...n.map(s=>({role:"tool",content:JSON.stringify(s.result),tool_call_id:s.toolCallId})));break}default:{const s=r;throw new Error(`Unsupported role: ${s}`)}}return e}function tI(t){switch(t){case"COMPLETE":case"STOP_SEQUENCE":return"stop";case"MAX_TOKENS":return"length";case"ERROR":case"ERROR_LIMIT":return"error";case"ERROR_TOXIC":return"content-filter";case"USER_CANCEL":return"other";default:return"unknown"}}function fse(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0,n=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:n};const s=[];for(const a of r)a.type==="provider-defined"?n.push({type:"unsupported-tool",tool:a}):s.push({type:"function",function:{name:a.name,description:a.description,parameters:a.parameters}});const i=t.toolChoice;if(i==null)return{tools:s,tool_choice:void 0,toolWarnings:n};const o=i.type;switch(o){case"auto":return{tools:s,tool_choice:o,toolWarnings:n};case"none":return{tools:void 0,tool_choice:"any",toolWarnings:n};case"required":case"tool":throw new eu({functionality:`Unsupported tool choice type: ${o}`});default:{const a=o;throw new eu({functionality:`Unsupported tool choice type: ${a}`})}}}var pse=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u}){const h=t.type,d=dse(e),f={model:this.modelId,frequency_penalty:o,presence_penalty:a,max_tokens:r,temperature:n,p:s,k:i,seed:u,stop_sequences:l,response_format:c?.type==="json"?{type:"json_object",schema:c.schema}:void 0,messages:d};switch(h){case"regular":{const{tools:g,tool_choice:_,toolWarnings:m}=fse(t);return{...f,tools:g,warnings:m}}case"object-json":throw new eu({functionality:"object-json mode"});case"object-tool":throw new eu({functionality:"object-tool mode"});default:{const g=h;throw new eu({functionality:`Unsupported mode: ${g}`})}}}concatenateMessageText(t){return t.filter(e=>"content"in e).map(e=>e.content).join("")}removeJsonSchemaExtras(t){return t.map(e=>{if(e.type==="function"&&e.function.parameters&&typeof e.function.parameters=="object"){const{additionalProperties:r,$schema:n,...s}=e.function.parameters;return{...e,function:{...e.function,parameters:s}}}return e})}async doGenerate(t){var e,r,n,s,i;const{warnings:o,...a}=this.getArgs(t);a.tools=a.tools&&this.removeJsonSchemaExtras(a.tools);const{responseHeaders:l,value:c}=await zE({url:`${this.config.baseURL}/chat`,headers:$E(this.config.headers(),t.headers),body:a,failedResponseHandler:VE,successfulResponseHandler:QF(mse),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:u,...h}=a;let d=(n=(r=(e=c.message.content)==null?void 0:e[0])==null?void 0:r.text)!=null?n:"";return d||(d=(s=c.message.tool_plan)!=null?s:""),{text:d,toolCalls:c.message.tool_calls?c.message.tool_calls.map(f=>({toolCallId:f.id,toolName:f.function.name,args:f.function.arguments,toolCallType:"function"})):[],finishReason:tI(c.finish_reason),usage:{promptTokens:c.usage.tokens.input_tokens,completionTokens:c.usage.tokens.output_tokens},rawCall:{rawPrompt:{messages:u},rawSettings:h},response:{id:(i=c.generation_id)!=null?i:void 0},rawResponse:{headers:l},warnings:o,request:{body:JSON.stringify(a)}}}async doStream(t){const{warnings:e,...r}=this.getArgs(t);r.tools=r.tools&&this.removeJsonSchemaExtras(r.tools);const n={...r,stream:!0},{responseHeaders:s,value:i}=await zE({url:`${this.config.baseURL}/chat`,headers:$E(this.config.headers(),t.headers),body:n,failedResponseHandler:VE,successfulResponseHandler:cse(gse),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:o,...a}=r;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u={toolCallId:"",toolName:"",argsTextDelta:""};return{stream:i.pipeThrough(new TransformStream({transform(h,d){var f;if(!h.success){l="error",d.enqueue({type:"error",error:h.error});return}const g=h.value;switch(g.type){case"content-delta":{d.enqueue({type:"text-delta",textDelta:g.delta.message.content.text});return}case"tool-plan-delta":{d.enqueue({type:"text-delta",textDelta:g.delta.message.tool_plan});return}case"tool-call-start":{u={toolCallId:g.delta.message.tool_calls.id,toolName:g.delta.message.tool_calls.function.name,argsTextDelta:g.delta.message.tool_calls.function.arguments},d.enqueue({type:"tool-call-delta",toolCallId:u.toolCallId,toolName:u.toolName,toolCallType:"function",argsTextDelta:u.argsTextDelta});return}case"tool-call-delta":{u.argsTextDelta+=g.delta.message.tool_calls.function.arguments,d.enqueue({type:"tool-call-delta",toolCallId:u.toolCallId,toolName:u.toolName,toolCallType:"function",argsTextDelta:g.delta.message.tool_calls.function.arguments});return}case"tool-call-end":{d.enqueue({type:"tool-call",toolCallId:u.toolCallId,toolName:u.toolName,toolCallType:"function",args:JSON.stringify(JSON.parse(u.argsTextDelta))}),u={toolCallId:"",toolName:"",argsTextDelta:""};return}case"message-start":{d.enqueue({type:"response-metadata",id:(f=g.id)!=null?f:void 0});return}case"message-end":{l=tI(g.delta.finish_reason);const m=g.delta.usage.tokens;c={promptTokens:m.input_tokens,completionTokens:m.output_tokens}}default:return}},flush(h){h.enqueue({type:"finish",finishReason:l,usage:c})}})),rawCall:{rawPrompt:{messages:o},rawSettings:a},rawResponse:{headers:s},warnings:e,request:{body:JSON.stringify(n)}}}},mse=j.object({generation_id:j.string().nullish(),message:j.object({role:j.string(),content:j.array(j.object({type:j.string(),text:j.string()})).nullish(),tool_plan:j.string().nullish(),tool_calls:j.array(j.object({id:j.string(),type:j.literal("function"),function:j.object({name:j.string(),arguments:j.string()})})).nullish()}),finish_reason:j.string(),usage:j.object({billed_units:j.object({input_tokens:j.number(),output_tokens:j.number()}),tokens:j.object({input_tokens:j.number(),output_tokens:j.number()})})}),gse=j.discriminatedUnion("type",[j.object({type:j.literal("citation-start")}),j.object({type:j.literal("citation-end")}),j.object({type:j.literal("content-start")}),j.object({type:j.literal("content-delta"),delta:j.object({message:j.object({content:j.object({text:j.string()})})})}),j.object({type:j.literal("content-end")}),j.object({type:j.literal("message-start"),id:j.string().nullish()}),j.object({type:j.literal("message-end"),delta:j.object({finish_reason:j.string(),usage:j.object({tokens:j.object({input_tokens:j.number(),output_tokens:j.number()})})})}),j.object({type:j.literal("tool-plan-delta"),delta:j.object({message:j.object({tool_plan:j.string()})})}),j.object({type:j.literal("tool-call-start"),delta:j.object({message:j.object({tool_calls:j.object({id:j.string(),type:j.literal("function"),function:j.object({name:j.string(),arguments:j.string()})})})})}),j.object({type:j.literal("tool-call-delta"),delta:j.object({message:j.object({tool_calls:j.object({function:j.object({arguments:j.string()})})})})}),j.object({type:j.literal("tool-call-end")})]),_se=class{constructor(t,e,r){this.specificationVersion="v1",this.maxEmbeddingsPerCall=96,this.supportsParallelCalls=!0,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}async doEmbed({values:t,headers:e,abortSignal:r}){var n;if(t.length>this.maxEmbeddingsPerCall)throw new $ne({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:t});const{responseHeaders:s,value:i}=await zE({url:`${this.config.baseURL}/embed`,headers:$E(this.config.headers(),e),body:{model:this.modelId,embedding_types:["float"],texts:t,input_type:(n=this.settings.inputType)!=null?n:"search_query",truncate:this.settings.truncate},failedResponseHandler:VE,successfulResponseHandler:QF(yse),abortSignal:r,fetch:this.config.fetch});return{embeddings:i.embeddings.float,usage:{tokens:i.meta.billed_units.input_tokens},rawResponse:{headers:s}}}},yse=j.object({embeddings:j.object({float:j.array(j.array(j.number()))}),meta:j.object({billed_units:j.object({input_tokens:j.number()})})});function e5(t={}){var e;const r=(e=use(t.baseURL))!=null?e:"https://api.cohere.com/v2",n=()=>({Authorization:`Bearer ${Jne({apiKey:t.apiKey,environmentVariableName:"COHERE_API_KEY",description:"Cohere"})}`,...t.headers}),s=(a,l={})=>new pse(a,l,{provider:"cohere.chat",baseURL:r,headers:n,fetch:t.fetch}),i=(a,l={})=>new _se(a,l,{provider:"cohere.textEmbedding",baseURL:r,headers:n,fetch:t.fetch}),o=function(a,l){if(new.target)throw new Error("The Cohere model function cannot be called with the new keyword.");return s(a,l)};return o.languageModel=s,o.embedding=i,o.textEmbeddingModel=i,o}e5();class bse extends Ir{name="Cohere";getApiKeyLink="https://dashboard.cohere.com/api-keys";config={apiTokenKey:"COHERE_API_KEY"};staticModels=[{name:"command-r-plus-08-2024",label:"Command R plus Latest",provider:"Cohere",maxTokenAllowed:4096},{name:"command-r-08-2024",label:"Command R Latest",provider:"Cohere",maxTokenAllowed:4096},{name:"command-r-plus",label:"Command R plus",provider:"Cohere",maxTokenAllowed:4096},{name:"command-r",label:"Command R",provider:"Cohere",maxTokenAllowed:4096},{name:"command",label:"Command",provider:"Cohere",maxTokenAllowed:4096},{name:"command-nightly",label:"Command Nightly",provider:"Cohere",maxTokenAllowed:4096},{name:"command-light",label:"Command Light",provider:"Cohere",maxTokenAllowed:4096},{name:"command-light-nightly",label:"Command Light Nightly",provider:"Cohere",maxTokenAllowed:4096},{name:"c4ai-aya-expanse-8b",label:"c4AI Aya Expanse 8b",provider:"Cohere",maxTokenAllowed:4096},{name:"c4ai-aya-expanse-32b",label:"c4AI Aya Expanse 32b",provider:"Cohere",maxTokenAllowed:4096}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"COHERE_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return e5({apiKey:o})(r)}}class vse extends Ir{name="Deepseek";getApiKeyLink="https://platform.deepseek.com/apiKeys";config={apiTokenKey:"DEEPSEEK_API_KEY"};staticModels=[{name:"deepseek-coder",label:"Deepseek-Coder",provider:"Deepseek",maxTokenAllowed:8e3},{name:"deepseek-chat",label:"Deepseek-Chat",provider:"Deepseek",maxTokenAllowed:8e3}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"DEEPSEEK_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return zi({baseURL:"https://api.deepseek.com/beta",apiKey:o})(r)}}function mi(t){if(typeof t=="boolean")return{type:"boolean",properties:{}};const{type:e,description:r,required:n,properties:s,items:i,allOf:o,anyOf:a,oneOf:l,format:c,const:u,minLength:h}=t,d={};return r&&(d.description=r),n&&(d.required=n),c&&(d.format=c),u!==void 0&&(d.enum=[u]),e&&(Array.isArray(e)?e.includes("null")?(d.type=e.filter(f=>f!=="null")[0],d.nullable=!0):d.type=e:e==="null"?d.type="null":d.type=e),s&&(d.properties=Object.entries(s).reduce((f,[g,_])=>(f[g]=mi(_),f),{})),i&&(d.items=Array.isArray(i)?i.map(mi):mi(i)),o&&(d.allOf=o.map(mi)),a&&(d.anyOf=a.map(mi)),l&&(d.oneOf=l.map(mi)),h!==void 0&&(d.minLength=h),d}function wse(t){var e;const r=[],n=[];let s=!0;for(const{role:i,content:o}of t)switch(i){case"system":{if(!s)throw new Fr({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:o});break}case"user":{s=!1;const a=[];for(const l of o)switch(l.type){case"text":{a.push({text:l.text});break}case"image":{if(l.image instanceof URL)throw new Fr({functionality:"Image URLs in user messages"});a.push({inlineData:{mimeType:(e=l.mimeType)!=null?e:"image/jpeg",data:Wy(l.image)}});break}case"file":{if(l.data instanceof URL)throw new Fr({functionality:"File URLs in user messages"});a.push({inlineData:{mimeType:l.mimeType,data:l.data}});break}}n.push({role:"user",parts:a});break}case"assistant":{s=!1,n.push({role:"model",parts:o.map(a=>{switch(a.type){case"text":return a.text.length===0?void 0:{text:a.text};case"tool-call":return{functionCall:{name:a.toolName,args:a.args}}}}).filter(a=>a!==void 0)});break}case"tool":{s=!1,n.push({role:"user",parts:o.map(a=>({functionResponse:{name:a.toolName,response:a.result}}))});break}default:{const a=i;throw new Error(`Unsupported role: ${a}`)}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:n}}function rI(t){return t.includes("/")?t:`models/${t}`}var Ese=j.object({error:j.object({code:j.number().nullable(),message:j.string(),status:j.string()})}),GE=Vy({errorSchema:Ese,errorToMessage:t=>t.error.message});function nI({finishReason:t,hasToolCalls:e}){switch(t){case"STOP":return e?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"RECITATION":case"SAFETY":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";default:return"unknown"}}var xse=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=t,this.settings=e,this.config=r}get supportsObjectGeneration(){return this.settings.structuredOutputs!==!1}get provider(){return this.config.provider}async getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u}){var h;const d=t.type,f=[];u!=null&&f.push({type:"unsupported-setting",setting:"seed"});const g={maxOutputTokens:r,temperature:n,topK:i??this.settings.topK,topP:s,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseMimeType:c?.type==="json"?"application/json":void 0,responseSchema:c?.type==="json"&&c.schema!=null&&this.supportsObjectGeneration?mi(c.schema):void 0},{contents:_,systemInstruction:m}=wse(e);switch(d){case"regular":return{args:{generationConfig:g,contents:_,systemInstruction:m,safetySettings:this.settings.safetySettings,...Cse(t),cachedContent:this.settings.cachedContent},warnings:f};case"object-json":return{args:{generationConfig:{...g,responseMimeType:"application/json",responseSchema:t.schema!=null&&this.supportsObjectGeneration?mi(t.schema):void 0},contents:_,systemInstruction:m,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:f};case"object-tool":return{args:{generationConfig:g,contents:_,tools:{functionDeclarations:[{name:t.tool.name,description:(h=t.tool.description)!=null?h:"",parameters:mi(t.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:f};default:{const p=d;throw new Error(`Unsupported type: ${p}`)}}}async doGenerate(t){var e,r;const{args:n,warnings:s}=await this.getArgs(t),{responseHeaders:i,value:o}=await Nn({url:`${this.config.baseURL}/${rI(this.modelId)}:generateContent`,headers:Qn(this.config.headers(),t.headers),body:n,failedResponseHandler:GE,successfulResponseHandler:Do(Sse),abortSignal:t.abortSignal,fetch:this.config.fetch}),{contents:a,...l}=n,c=o.candidates[0],u=sI({parts:c.content.parts,generateId:this.config.generateId}),h=o.usageMetadata;return{text:iI(c.content.parts),toolCalls:u,finishReason:nI({finishReason:c.finishReason,hasToolCalls:u!=null&&u.length>0}),usage:{promptTokens:(e=h?.promptTokenCount)!=null?e:NaN,completionTokens:(r=h?.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:a,rawSettings:l},rawResponse:{headers:i},warnings:s}}async doStream(t){const{args:e,warnings:r}=await this.getArgs(t),{responseHeaders:n,value:s}=await Nn({url:`${this.config.baseURL}/${rI(this.modelId)}:streamGenerateContent?alt=sse`,headers:Qn(this.config.headers(),t.headers),body:e,failedResponseHandler:GE,successfulResponseHandler:Gy(Tse),abortSignal:t.abortSignal,fetch:this.config.fetch}),{contents:i,...o}=e;let a="unknown",l={promptTokens:Number.NaN,completionTokens:Number.NaN};const c=this.config.generateId;let u=!1;return{stream:s.pipeThrough(new TransformStream({transform(h,d){var f,g;if(!h.success){d.enqueue({type:"error",error:h.error});return}const _=h.value,m=_.candidates[0];m?.finishReason!=null&&(a=nI({finishReason:m.finishReason,hasToolCalls:u}));const p=_.usageMetadata;p!=null&&(l={promptTokens:(f=p.promptTokenCount)!=null?f:NaN,completionTokens:(g=p.candidatesTokenCount)!=null?g:NaN});const y=m.content;if(y==null)return;const b=iI(y.parts);b!=null&&d.enqueue({type:"text-delta",textDelta:b});const v=sI({parts:y.parts,generateId:c});if(v!=null)for(const w of v)d.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,argsTextDelta:w.args}),d.enqueue({type:"tool-call",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,args:w.args}),u=!0},flush(h){h.enqueue({type:"finish",finishReason:a,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:n},warnings:r}}};function sI({parts:t,generateId:e}){const r=t.filter(n=>"functionCall"in n);return r.length===0?void 0:r.map(n=>({toolCallType:"function",toolCallId:e(),toolName:n.functionCall.name,args:JSON.stringify(n.functionCall.args)}))}function iI(t){const e=t.filter(r=>"text"in r);return e.length===0?void 0:e.map(r=>r.text).join("")}var t5=j.object({role:j.string(),parts:j.array(j.union([j.object({text:j.string()}),j.object({functionCall:j.object({name:j.string(),args:j.unknown()})})]))}),Sse=j.object({candidates:j.array(j.object({content:t5,finishReason:j.string().optional()})),usageMetadata:j.object({promptTokenCount:j.number(),candidatesTokenCount:j.number().nullish(),totalTokenCount:j.number()}).optional()}),Tse=j.object({candidates:j.array(j.object({content:t5.optional(),finishReason:j.string().optional()})),usageMetadata:j.object({promptTokenCount:j.number(),candidatesTokenCount:j.number().nullish(),totalTokenCount:j.number()}).optional()});function Cse(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0;if(r==null)return{tools:void 0,toolConfig:void 0};const n={functionDeclarations:r.map(o=>{var a;return{name:o.name,description:(a=o.description)!=null?a:"",parameters:mi(o.parameters)}})},s=t.toolChoice;if(s==null)return{tools:n,toolConfig:void 0};const i=s.type;switch(i){case"auto":return{tools:n,toolConfig:{functionCallingConfig:{mode:"AUTO"}}};case"none":return{tools:n,toolConfig:{functionCallingConfig:{mode:"NONE"}}};case"required":return{tools:n,toolConfig:{functionCallingConfig:{mode:"ANY"}}};case"tool":return{tools:n,toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[s.toolName]}}};default:{const o=i;throw new Error(`Unsupported tool choice type: ${o}`)}}}var kse=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:t,headers:e,abortSignal:r}){if(t.length>this.maxEmbeddingsPerCall)throw new zy({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:t});const{responseHeaders:n,value:s}=await Nn({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:Qn(this.config.headers(),e),body:{requests:t.map(i=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:i}]},outputDimensionality:this.settings.outputDimensionality}))},failedResponseHandler:GE,successfulResponseHandler:Do(Ase),abortSignal:r,fetch:this.config.fetch});return{embeddings:s.embeddings.map(i=>i.values),usage:void 0,rawResponse:{headers:n}}}},Ase=j.object({embeddings:j.array(j.object({values:j.array(j.number())}))});function r5(t={}){var e,r;const n=(r=qy((e=t.baseURL)!=null?e:t.baseUrl))!=null?r:"https://generativelanguage.googleapis.com/v1beta",s=()=>({"x-goog-api-key":yC({apiKey:t.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...t.headers}),i=(l,c={})=>{var u;return new xse(l,c,{provider:"google.generative-ai",baseURL:n,headers:s,generateId:(u=t.generateId)!=null?u:ea,fetch:t.fetch})},o=(l,c={})=>new kse(l,c,{provider:"google.generative-ai",baseURL:n,headers:s,fetch:t.fetch}),a=function(l,c){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return i(l,c)};return a.languageModel=i,a.chat=i,a.generativeAI=i,a.embedding=o,a.textEmbedding=o,a.textEmbeddingModel=o,a}r5();class Rse extends Ir{name="Google";getApiKeyLink="https://aistudio.google.com/app/apikey";config={apiTokenKey:"GOOGLE_GENERATIVE_AI_API_KEY"};staticModels=[{name:"gemini-1.5-flash-latest",label:"Gemini 1.5 Flash",provider:"Google",maxTokenAllowed:8192},{name:"gemini-2.0-flash-exp",label:"Gemini 2.0 Flash",provider:"Google",maxTokenAllowed:8192},{name:"gemini-1.5-flash-002",label:"Gemini 1.5 Flash-002",provider:"Google",maxTokenAllowed:8192},{name:"gemini-1.5-flash-8b",label:"Gemini 1.5 Flash-8b",provider:"Google",maxTokenAllowed:8192},{name:"gemini-1.5-pro-latest",label:"Gemini 1.5 Pro",provider:"Google",maxTokenAllowed:8192},{name:"gemini-1.5-pro-002",label:"Gemini 1.5 Pro-002",provider:"Google",maxTokenAllowed:8192},{name:"gemini-exp-1206",label:"Gemini exp-1206",provider:"Google",maxTokenAllowed:8192}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"GOOGLE_GENERATIVE_AI_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return r5({apiKey:o})(r)}}class Ise extends Ir{name="Groq";getApiKeyLink="https://console.groq.com/keys";config={apiTokenKey:"GROQ_API_KEY"};staticModels=[{name:"llama-3.1-8b-instant",label:"Llama 3.1 8b (Groq)",provider:"Groq",maxTokenAllowed:8e3},{name:"llama-3.2-11b-vision-preview",label:"Llama 3.2 11b (Groq)",provider:"Groq",maxTokenAllowed:8e3},{name:"llama-3.2-90b-vision-preview",label:"Llama 3.2 90b (Groq)",provider:"Groq",maxTokenAllowed:8e3},{name:"llama-3.2-3b-preview",label:"Llama 3.2 3b (Groq)",provider:"Groq",maxTokenAllowed:8e3},{name:"llama-3.2-1b-preview",label:"Llama 3.2 1b (Groq)",provider:"Groq",maxTokenAllowed:8e3},{name:"llama-3.3-70b-versatile",label:"Llama 3.3 70b (Groq)",provider:"Groq",maxTokenAllowed:8e3}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"GROQ_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return zi({baseURL:"https://api.groq.com/openai/v1",apiKey:o})(r)}}class Pse extends Ir{name="HuggingFace";getApiKeyLink="https://huggingface.co/settings/tokens";config={apiTokenKey:"HuggingFace_API_KEY"};staticModels=[{name:"Qwen/Qwen2.5-Coder-32B-Instruct",label:"Qwen2.5-Coder-32B-Instruct (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"01-ai/Yi-1.5-34B-Chat",label:"Yi-1.5-34B-Chat (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"codellama/CodeLlama-34b-Instruct-hf",label:"CodeLlama-34b-Instruct (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"NousResearch/Hermes-3-Llama-3.1-8B",label:"Hermes-3-Llama-3.1-8B (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"Qwen/Qwen2.5-Coder-32B-Instruct",label:"Qwen2.5-Coder-32B-Instruct (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"Qwen/Qwen2.5-72B-Instruct",label:"Qwen2.5-72B-Instruct (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"meta-llama/Llama-3.1-70B-Instruct",label:"Llama-3.1-70B-Instruct (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"meta-llama/Llama-3.1-405B",label:"Llama-3.1-405B (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"01-ai/Yi-1.5-34B-Chat",label:"Yi-1.5-34B-Chat (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"codellama/CodeLlama-34b-Instruct-hf",label:"CodeLlama-34b-Instruct (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3},{name:"NousResearch/Hermes-3-Llama-3.1-8B",label:"Hermes-3-Llama-3.1-8B (HuggingFace)",provider:"HuggingFace",maxTokenAllowed:8e3}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"HuggingFace_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return zi({baseURL:"https://api-inference.huggingface.co/v1/",apiKey:o})(r)}}var oI={};class Ose extends Ir{name="LMStudio";getApiKeyLink="https://lmstudio.ai/";labelForGetApiKey="Get LMStudio";icon="i-ph:cloud-arrow-down";config={baseUrlKey:"LMSTUDIO_API_BASE_URL",baseUrl:"http://localhost:1234/"};staticModels=[];async getDynamicModels(e,r,n={}){let{baseUrl:s}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"LMSTUDIO_API_BASE_URL",defaultApiTokenKey:""});if(!s)throw new Error("No baseUrl found for LMStudio provider");if(typeof window>"u"){const a=oI.RUNNING_IN_DOCKER==="true";s=a?s.replace("localhost","host.docker.internal"):s,s=a?s.replace("127.0.0.1","host.docker.internal"):s}return(await(await fetch(`${s}/v1/models`)).json()).data.map(a=>({name:a.id,label:a.id,provider:this.name,maxTokenAllowed:8e3}))}getModelInstance=e=>{const{apiKeys:r,providerSettings:n,serverEnv:s,model:i}=e;let{baseUrl:o}=this.getProviderBaseUrlAndKey({apiKeys:r,providerSettings:n?.[this.name],serverEnv:s,defaultBaseUrlKey:"LMSTUDIO_API_BASE_URL",defaultApiTokenKey:""});if(!o)throw new Error("No baseUrl found for LMStudio provider");if(typeof window>"u"){const l=oI.RUNNING_IN_DOCKER==="true";o=l?o.replace("localhost","host.docker.internal"):o,o=l?o.replace("127.0.0.1","host.docker.internal"):o}return ET.debug("LMStudio Base Url used: ",o),zi({baseUrl:`${o}/v1`,apiKey:""})(i)}}function Dse(t){const e=[];for(let r=0;r<t.length;r++){const{role:n,content:s}=t[r],i=r===t.length-1;switch(n){case"system":{e.push({role:"system",content:s});break}case"user":{e.push({role:"user",content:s.map(o=>{var a;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:o.image instanceof URL?o.image.toString():`data:${(a=o.mimeType)!=null?a:"image/jpeg"};base64,${Wy(o.image)}`};case"file":throw new Fr({functionality:"File content parts in user messages"})}})});break}case"assistant":{let o="";const a=[];for(const l of s)switch(l.type){case"text":{o+=l.text;break}case"tool-call":{a.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)}});break}default:{const c=l;throw new Error(`Unsupported part: ${c}`)}}e.push({role:"assistant",content:o,prefix:i?!0:void 0,tool_calls:a.length>0?a:void 0});break}case"tool":{for(const o of s)e.push({role:"tool",name:o.toolName,content:JSON.stringify(o.result),tool_call_id:o.toolCallId});break}default:{const o=n;throw new Error(`Unsupported role: ${o}`)}}}return e}function aI(t){switch(t){case"stop":return"stop";case"length":case"model_length":return"length";case"tool_calls":return"tool-calls";default:return"unknown"}}var Lse=j.object({object:j.literal("error"),message:j.string(),type:j.string(),param:j.string().nullable(),code:j.string().nullable()}),WE=Vy({errorSchema:Lse,errorToMessage:t=>t.message});function lI({id:t,model:e,created:r}){return{id:t??void 0,modelId:e??void 0,timestamp:r!=null?new Date(r*1e3):void 0}}var Nse=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u}){const h=t.type,d=[];i!=null&&d.push({type:"unsupported-setting",setting:"topK"}),o!=null&&d.push({type:"unsupported-setting",setting:"frequencyPenalty"}),a!=null&&d.push({type:"unsupported-setting",setting:"presencePenalty"}),l!=null&&d.push({type:"unsupported-setting",setting:"stopSequences"}),c!=null&&c.type==="json"&&c.schema!=null&&d.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is not supported"});const f={model:this.modelId,safe_prompt:this.settings.safePrompt,max_tokens:r,temperature:n,top_p:s,random_seed:u,response_format:c?.type==="json"?{type:"json_object"}:void 0,messages:Dse(e)};switch(h){case"regular":return{args:{...f,...Fse(t)},warnings:d};case"object-json":return{args:{...f,response_format:{type:"json_object"}},warnings:d};case"object-tool":return{args:{...f,tool_choice:"any",tools:[{type:"function",function:t.tool}]},warnings:d};default:{const g=h;throw new Error(`Unsupported type: ${g}`)}}}async doGenerate(t){var e,r;const{args:n,warnings:s}=this.getArgs(t),{responseHeaders:i,value:o}=await Nn({url:`${this.config.baseURL}/chat/completions`,headers:Qn(this.config.headers(),t.headers),body:n,failedResponseHandler:WE,successfulResponseHandler:Do(Mse),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:a,...l}=n,c=o.choices[0];let u=(e=c.message.content)!=null?e:void 0;const h=a[a.length-1];return h.role==="assistant"&&u?.startsWith(h.content)&&(u=u.slice(h.content.length)),{text:u,toolCalls:(r=c.message.tool_calls)==null?void 0:r.map(d=>({toolCallType:"function",toolCallId:d.id,toolName:d.function.name,args:d.function.arguments})),finishReason:aI(c.finish_reason),usage:{promptTokens:o.usage.prompt_tokens,completionTokens:o.usage.completion_tokens},rawCall:{rawPrompt:a,rawSettings:l},rawResponse:{headers:i},response:lI(o),warnings:s}}async doStream(t){const{args:e,warnings:r}=this.getArgs(t),{responseHeaders:n,value:s}=await Nn({url:`${this.config.baseURL}/chat/completions`,headers:Qn(this.config.headers(),t.headers),body:{...e,stream:!0},failedResponseHandler:WE,successfulResponseHandler:Gy(Bse),abortSignal:t.abortSignal,fetch:this.config.fetch}),{messages:i,...o}=e;let a="unknown",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c=0,u=!1;return{stream:s.pipeThrough(new TransformStream({transform(h,d){if(!h.success){d.enqueue({type:"error",error:h.error});return}c++;const f=h.value;c===1&&d.enqueue({type:"response-metadata",...lI(f)}),f.usage!=null&&(l={promptTokens:f.usage.prompt_tokens,completionTokens:f.usage.completion_tokens});const g=f.choices[0];if(g?.finish_reason!=null&&(a=aI(g.finish_reason)),g?.delta==null)return;const _=g.delta;if(c<=2){const m=i[i.length-1];if(m.role==="assistant"&&_.content===m.content.trimEnd()){_.content.length<m.content.length&&(u=!0);return}}if(_.content!=null&&(d.enqueue({type:"text-delta",textDelta:u?_.content.trimStart():_.content}),u=!1),_.tool_calls!=null)for(const m of _.tool_calls)d.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:m.id,toolName:m.function.name,argsTextDelta:m.function.arguments}),d.enqueue({type:"tool-call",toolCallType:"function",toolCallId:m.id,toolName:m.function.name,args:m.function.arguments})},flush(h){h.enqueue({type:"finish",finishReason:a,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:n},warnings:r}}},Mse=j.object({id:j.string().nullish(),created:j.number().nullish(),model:j.string().nullish(),choices:j.array(j.object({message:j.object({role:j.literal("assistant"),content:j.string().nullable(),tool_calls:j.array(j.object({id:j.string(),function:j.object({name:j.string(),arguments:j.string()})})).nullish()}),index:j.number(),finish_reason:j.string().nullish()})),object:j.literal("chat.completion"),usage:j.object({prompt_tokens:j.number(),completion_tokens:j.number()})}),Bse=j.object({id:j.string().nullish(),created:j.number().nullish(),model:j.string().nullish(),choices:j.array(j.object({delta:j.object({role:j.enum(["assistant"]).optional(),content:j.string().nullish(),tool_calls:j.array(j.object({id:j.string(),function:j.object({name:j.string(),arguments:j.string()})})).nullish()}),finish_reason:j.string().nullish(),index:j.number()})),usage:j.object({prompt_tokens:j.number(),completion_tokens:j.number()}).nullish()});function Fse(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0;if(r==null)return{tools:void 0,tool_choice:void 0};const n=r.map(o=>({type:"function",function:{name:o.name,description:o.description,parameters:o.parameters}})),s=t.toolChoice;if(s==null)return{tools:n,tool_choice:void 0};const i=s.type;switch(i){case"auto":case"none":return{tools:n,tool_choice:i};case"required":return{tools:n,tool_choice:"any"};case"tool":return{tools:n.filter(o=>o.function.name===s.toolName),tool_choice:"any"};default:{const o=i;throw new Error(`Unsupported tool choice type: ${o}`)}}}var jse=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var t;return(t=this.settings.maxEmbeddingsPerCall)!=null?t:32}get supportsParallelCalls(){var t;return(t=this.settings.supportsParallelCalls)!=null?t:!1}async doEmbed({values:t,abortSignal:e,headers:r}){if(t.length>this.maxEmbeddingsPerCall)throw new zy({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:t});const{responseHeaders:n,value:s}=await Nn({url:`${this.config.baseURL}/embeddings`,headers:Qn(this.config.headers(),r),body:{model:this.modelId,input:t,encoding_format:"float"},failedResponseHandler:WE,successfulResponseHandler:Do(Use),abortSignal:e,fetch:this.config.fetch});return{embeddings:s.data.map(i=>i.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:n}}}},Use=j.object({data:j.array(j.object({embedding:j.array(j.number())})),usage:j.object({prompt_tokens:j.number()}).nullish()});function n5(t={}){var e,r;const n=(r=qy((e=t.baseURL)!=null?e:t.baseUrl))!=null?r:"https://api.mistral.ai/v1",s=()=>({Authorization:`Bearer ${yC({apiKey:t.apiKey,environmentVariableName:"MISTRAL_API_KEY",description:"Mistral"})}`,...t.headers}),i=(l,c={})=>new Nse(l,c,{provider:"mistral.chat",baseURL:n,headers:s,fetch:t.fetch}),o=(l,c={})=>new jse(l,c,{provider:"mistral.embedding",baseURL:n,headers:s,fetch:t.fetch}),a=function(l,c){if(new.target)throw new Error("The Mistral model function cannot be called with the new keyword.");return i(l,c)};return a.languageModel=i,a.chat=i,a.embedding=o,a.textEmbedding=o,a.textEmbeddingModel=o,a}n5();class $se extends Ir{name="Mistral";getApiKeyLink="https://console.mistral.ai/api-keys/";config={apiTokenKey:"MISTRAL_API_KEY"};staticModels=[{name:"open-mistral-7b",label:"Mistral 7B",provider:"Mistral",maxTokenAllowed:8e3},{name:"open-mixtral-8x7b",label:"Mistral 8x7B",provider:"Mistral",maxTokenAllowed:8e3},{name:"open-mixtral-8x22b",label:"Mistral 8x22B",provider:"Mistral",maxTokenAllowed:8e3},{name:"open-codestral-mamba",label:"Codestral Mamba",provider:"Mistral",maxTokenAllowed:8e3},{name:"open-mistral-nemo",label:"Mistral Nemo",provider:"Mistral",maxTokenAllowed:8e3},{name:"ministral-8b-latest",label:"Mistral 8B",provider:"Mistral",maxTokenAllowed:8e3},{name:"mistral-small-latest",label:"Mistral Small",provider:"Mistral",maxTokenAllowed:8e3},{name:"codestral-latest",label:"Codestral",provider:"Mistral",maxTokenAllowed:8e3},{name:"mistral-large-latest",label:"Mistral Large Latest",provider:"Mistral",maxTokenAllowed:8e3}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"MISTRAL_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return n5({apiKey:o})(r)}}var s5={},qE={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Allow=t.ALL=t.COLLECTION=t.ATOM=t.SPECIAL=t.INF=t._INFINITY=t.INFINITY=t.NAN=t.BOOL=t.NULL=t.OBJ=t.ARR=t.NUM=t.STR=void 0,t.STR=1,t.NUM=2,t.ARR=4,t.OBJ=8,t.NULL=16,t.BOOL=32,t.NAN=64,t.INFINITY=128,t._INFINITY=256,t.INF=t.INFINITY|t._INFINITY,t.SPECIAL=t.NULL|t.BOOL|t.INF|t.NAN,t.ATOM=t.STR|t.NUM|t.SPECIAL,t.COLLECTION=t.ARR|t.OBJ,t.ALL=t.ATOM|t.COLLECTION,t.Allow={STR:t.STR,NUM:t.NUM,ARR:t.ARR,OBJ:t.OBJ,NULL:t.NULL,BOOL:t.BOOL,NAN:t.NAN,INFINITY:t.INFINITY,_INFINITY:t._INFINITY,INF:t.INF,SPECIAL:t.SPECIAL,ATOM:t.ATOM,COLLECTION:t.COLLECTION,ALL:t.ALL},t.default=t.Allow})(qE);(function(t){var e=hn&&hn.__createBinding||(Object.create?function(c,u,h,d){d===void 0&&(d=h);var f=Object.getOwnPropertyDescriptor(u,h);(!f||("get"in f?!u.__esModule:f.writable||f.configurable))&&(f={enumerable:!0,get:function(){return u[h]}}),Object.defineProperty(c,d,f)}:function(c,u,h,d){d===void 0&&(d=h),c[d]=u[h]}),r=hn&&hn.__exportStar||function(c,u){for(var h in c)h!=="default"&&!Object.prototype.hasOwnProperty.call(u,h)&&e(u,c,h)};Object.defineProperty(t,"__esModule",{value:!0}),t.Allow=t.MalformedJSON=t.PartialJSON=t.parseJSON=t.parse=void 0;const n=qE;Object.defineProperty(t,"Allow",{enumerable:!0,get:function(){return n.Allow}}),r(qE,t);class s extends Error{}t.PartialJSON=s;class i extends Error{}t.MalformedJSON=i;function o(c,u=n.Allow.ALL){if(typeof c!="string")throw new TypeError(`expecting str, got ${typeof c}`);if(!c.trim())throw new Error(`${c} is empty`);return a(c.trim(),u)}t.parseJSON=o;const a=(c,u)=>{const h=c.length;let d=0;const f=w=>{throw new s(`${w} at position ${d}`)},g=w=>{throw new i(`${w} at position ${d}`)},_=()=>(v(),d>=h&&f("Unexpected end of input"),c[d]==='"'?m():c[d]==="{"?p():c[d]==="["?y():c.substring(d,d+4)==="null"||n.Allow.NULL&u&&h-d<4&&"null".startsWith(c.substring(d))?(d+=4,null):c.substring(d,d+4)==="true"||n.Allow.BOOL&u&&h-d<4&&"true".startsWith(c.substring(d))?(d+=4,!0):c.substring(d,d+5)==="false"||n.Allow.BOOL&u&&h-d<5&&"false".startsWith(c.substring(d))?(d+=5,!1):c.substring(d,d+8)==="Infinity"||n.Allow.INFINITY&u&&h-d<8&&"Infinity".startsWith(c.substring(d))?(d+=8,1/0):c.substring(d,d+9)==="-Infinity"||n.Allow._INFINITY&u&&1<h-d&&h-d<9&&"-Infinity".startsWith(c.substring(d))?(d+=9,-1/0):c.substring(d,d+3)==="NaN"||n.Allow.NAN&u&&h-d<3&&"NaN".startsWith(c.substring(d))?(d+=3,NaN):b()),m=()=>{const w=d;let E=!1;for(d++;d<h&&(c[d]!=='"'||E&&c[d-1]==="\\");)E=c[d]==="\\"?!E:!1,d++;if(c.charAt(d)=='"')try{return JSON.parse(c.substring(w,++d-Number(E)))}catch(S){g(String(S))}else if(n.Allow.STR&u)try{return JSON.parse(c.substring(w,d-Number(E))+'"')}catch{return JSON.parse(c.substring(w,c.lastIndexOf("\\"))+'"')}f("Unterminated string literal")},p=()=>{d++,v();const w={};try{for(;c[d]!=="}";){if(v(),d>=h&&n.Allow.OBJ&u)return w;const E=m();v(),d++;try{const S=_();w[E]=S}catch(S){if(n.Allow.OBJ&u)return w;throw S}v(),c[d]===","&&d++}}catch{if(n.Allow.OBJ&u)return w;f("Expected '}' at end of object")}return d++,w},y=()=>{d++;const w=[];try{for(;c[d]!=="]";)w.push(_()),v(),c[d]===","&&d++}catch{if(n.Allow.ARR&u)return w;f("Expected ']' at end of array")}return d++,w},b=()=>{if(d===0){c==="-"&&g("Not sure what '-' is");try{return JSON.parse(c)}catch(E){if(n.Allow.NUM&u)try{return JSON.parse(c.substring(0,c.lastIndexOf("e")))}catch{}g(String(E))}}const w=d;for(c[d]==="-"&&d++;c[d]&&",]}".indexOf(c[d])===-1;)d++;d==h&&!(n.Allow.NUM&u)&&f("Unterminated number literal");try{return JSON.parse(c.substring(w,d))}catch{c.substring(w,d)==="-"&&f("Not sure what '-' is");try{return JSON.parse(c.substring(w,c.lastIndexOf("e")))}catch(S){g(String(S))}}},v=()=>{for(;d<h&&` 
\r	`.includes(c[d]);)d++};return _()},l=o;t.parse=l})(s5);function Uv(t){const e=[];for(const{content:r,role:n}of t)switch(n){case"system":{e.push({content:r,role:"system"});break}case"user":{e.push({...r.reduce((s,i)=>{if(i.type==="text")s.content+=i.text;else{if(i.type==="image"&&i.image instanceof URL)throw new Fr({functionality:"Image URLs in user messages"});i.type==="image"&&i.image instanceof Uint8Array&&(s.images=s.images||[],s.images.push(Wy(i.image)))}return s},{content:""}),role:"user"});break}case"assistant":{const s=[],i=[];for(const o of r)switch(o.type){case"text":{s.push(o.text);break}case"tool-call":{i.push({function:{arguments:o.args,name:o.toolName},id:o.toolCallId,type:"function"});break}default:{const a=o;throw new Error(`Unsupported part: ${a}`)}}e.push({content:s.join(","),role:"assistant",tool_calls:i.length>0?i:void 0});break}case"tool":{e.push(...r.map(s=>({content:typeof s.result=="object"?JSON.stringify(s.result):`${s.result}`,role:"tool",tool_call_id:s.toolCallId})));break}default:{const s=n;throw new Error(`Unsupported role: ${s}`)}}return e}var Hse=class{constructor({tools:t,type:e}){this._firstMessage=!0,this._tools=t,this._toolPartial="",this._toolCalls=[],this._type=e,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:t,delta:e}){var r;if(this.detectToolCall(e),!this._detectedToolCall)return!1;this._toolPartial+=e;let n=s5.parse(this._toolPartial);Array.isArray(n)||(n=[n]);for(const[s,i]of n.entries()){const o=(r=JSON.stringify(i?.parameters))!=null?r:"";if(o==="")continue;this._toolCalls[s]||(this._toolCalls[s]={function:{arguments:"",name:i.name},id:ea(),type:"function"});const a=this._toolCalls[s];a.function.arguments=o,t.enqueue({argsTextDelta:e,toolCallId:a.id,toolCallType:"function",toolName:a.function.name,type:"tool-call-delta"})}return!0}finish({controller:t}){for(const e of this.toolCalls)t.enqueue({args:e.function.arguments,toolCallId:e.id,toolCallType:"function",toolName:e.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(t){!this._tools||this._tools.length===0||this._firstMessage&&(this._type==="object-tool"?this._detectedToolCall=!0:this._type==="regular"&&(t.trim().startsWith("{")||t.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?this._type==="object-tool"?"stop":"tool-calls":"stop"}};function zse({finishReason:t,hasToolCalls:e}){switch(t){case"stop":return e?"tool-calls":"stop";default:return"other"}}var Vse=j.object({error:j.object({code:j.string().nullable(),message:j.string(),param:j.any().nullable(),type:j.string()})}),KE=Vy({errorSchema:Vse,errorToMessage:t=>t.error.message});function Gse(t){return Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0))}var Wse=class extends TransformStream{constructor(){super({flush:t=>{this.buffer.length!==0&&t.enqueue(this.buffer)},transform:(t,e)=>{for(t=this.buffer+t;;){const r=t.indexOf(`
`);if(r===-1)break;e.enqueue(t.slice(0,r)),t=t.slice(r+1)}this.buffer=t}}),this.buffer=""}},qse=t=>async({response:e})=>{const r=xp(e);if(e.body===null)throw new C4({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new Wse).pipeThrough(new TransformStream({transform(n,s){s.enqueue(bC({schema:t,text:n}))}}))}},Kse=class{constructor(t,e,r){this.modelId=t,this.settings=e,this.config=r,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get provider(){return this.config.provider}getArguments({frequencyPenalty:t,maxTokens:e,mode:r,presencePenalty:n,prompt:s,responseFormat:i,seed:o,stopSequences:a,temperature:l,topK:c,topP:u}){var h,d,f;const g=r.type,_=[];i!==void 0&&i.type==="json"&&i.schema!==void 0&&_.push({details:"JSON response format schema is not supported",setting:"responseFormat",type:"unsupported-setting"});const m={format:i?.type,model:this.modelId,options:Gse({f16_kv:this.settings.f16Kv,frequency_penalty:t,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:e,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:n,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:o,stop:(h=this.settings.stop)!=null?h:a,temperature:l,tfs_z:this.settings.tfsZ,top_k:(d=this.settings.topK)!=null?d:c,top_p:u,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly})};switch(g){case"regular":{const p=(f=r.tools)!=null&&f.length?r.tools:void 0;return{args:{...m,messages:Uv(s),tools:p?.map(y=>({function:{description:y.description,name:y.name,parameters:y.parameters},type:"function"}))},type:g,warnings:_}}case"object-json":return{args:{...m,format:"json",messages:Uv(s)},type:g,warnings:_};case"object-tool":return{args:{...m,messages:Uv(s),tool_choice:{function:{name:r.tool.name},type:"function"},tools:[{function:{description:r.tool.description,name:r.tool.name,parameters:r.tool.parameters},type:"function"}]},type:g,warnings:_};default:{const p=g;throw new Error(`Unsupported type: ${p}`)}}}async doGenerate(t){var e,r;const{args:n,warnings:s}=this.getArguments(t),{responseHeaders:i,value:o}=await Nn({abortSignal:t.abortSignal,body:{...n,stream:!1},failedResponseHandler:KE,fetch:this.config.fetch,headers:Qn(this.config.headers(),t.headers),successfulResponseHandler:Do(Yse),url:`${this.config.baseURL}/chat`}),{messages:a,...l}=n,c=(e=o.message.tool_calls)==null?void 0:e.map(u=>{var h;return{args:JSON.stringify(u.function.arguments),toolCallId:(h=u.id)!=null?h:ea(),toolCallType:"function",toolName:u.function.name}});return{finishReason:zse({finishReason:o.done_reason,hasToolCalls:c!==void 0&&c.length>0}),rawCall:{rawPrompt:a,rawSettings:l},rawResponse:{headers:i},text:(r=o.message.content)!=null?r:void 0,toolCalls:c,usage:{completionTokens:o.eval_count||0,promptTokens:o.prompt_eval_count||0},warnings:s}}async doStream(t){const{args:e,type:r,warnings:n}=this.getArguments(t),{responseHeaders:s,value:i}=await Nn({abortSignal:t.abortSignal,body:e,failedResponseHandler:KE,fetch:this.config.fetch,headers:Qn(this.config.headers(),t.headers),successfulResponseHandler:qse(Xse),url:`${this.config.baseURL}/chat`}),{messages:o,...a}=e,l=t.mode.type==="regular"?t.mode.tools:t.mode.type==="object-tool"?[t.mode.tool]:void 0,c=new Hse({tools:l,type:r});let u="other",h={completionTokens:Number.NaN,promptTokens:Number.NaN};const{experimentalStreamTools:d=!0}=this.settings;return{rawCall:{rawPrompt:o,rawSettings:a},rawResponse:{headers:s},stream:i.pipeThrough(new TransformStream({async flush(f){f.enqueue({finishReason:u,type:"finish",usage:h})},async transform(f,g){if(!f.success){g.enqueue({error:f.error,type:"error"});return}const _=f.value;if(_.done){u=c.finish({controller:g}),h={completionTokens:_.eval_count,promptTokens:_.prompt_eval_count||0};return}d&&c.parse({controller:g,delta:_.message.content})||_.message.content!==null&&g.enqueue({textDelta:_.message.content,type:"text-delta"})}})),warnings:n}}},Yse=j.object({created_at:j.string(),done:j.literal(!0),done_reason:j.string().optional().nullable(),eval_count:j.number(),eval_duration:j.number(),load_duration:j.number().optional(),message:j.object({content:j.string(),role:j.string(),tool_calls:j.array(j.object({function:j.object({arguments:j.record(j.any()),name:j.string()}),id:j.string().optional()})).optional().nullable()}),model:j.string(),prompt_eval_count:j.number().optional(),prompt_eval_duration:j.number().optional(),total_duration:j.number()}),Xse=j.discriminatedUnion("done",[j.object({created_at:j.string(),done:j.literal(!1),message:j.object({content:j.string(),role:j.string()}),model:j.string()}),j.object({created_at:j.string(),done:j.literal(!0),eval_count:j.number(),eval_duration:j.number(),load_duration:j.number().optional(),model:j.string(),prompt_eval_count:j.number().optional(),prompt_eval_duration:j.number().optional(),total_duration:j.number()})]),Zse=class{constructor(t,e,r){this.specificationVersion="v1",this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var t;return(t=this.settings.maxEmbeddingsPerCall)!=null?t:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:t,values:e}){if(e.length>this.maxEmbeddingsPerCall)throw new zy({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:e});const{responseHeaders:r,value:n}=await Nn({abortSignal:t,body:{input:e,model:this.modelId},failedResponseHandler:KE,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:Do(Jse),url:`${this.config.baseURL}/embed`});return{embeddings:n.embeddings,rawResponse:{headers:r},usage:n.prompt_eval_count?{tokens:n.prompt_eval_count}:void 0}}},Jse=j.object({embeddings:j.array(j.array(j.number())),prompt_eval_count:j.number().nullable()});function Qse(t={}){var e;const r=(e=qy(t.baseURL))!=null?e:"http://127.0.0.1:11434/api",n=()=>({...t.headers}),s=(a,l={})=>new Kse(a,l,{baseURL:r,fetch:t.fetch,headers:n,provider:"ollama.chat"}),i=(a,l={})=>new Zse(a,l,{baseURL:r,fetch:t.fetch,headers:n,provider:"ollama.embedding"}),o=function(a,l){if(new.target)throw new Error("The Ollama model function cannot be called with the new keyword.");return s(a,l)};return o.chat=s,o.embedding=i,o.languageModel=s,o.textEmbedding=i,o.textEmbeddingModel=i,o}var eie=Qse(),K0={};const tie=K0?.DEFAULT_NUM_CTX?parseInt(K0.DEFAULT_NUM_CTX,10):32768;class rie extends Ir{name="Ollama";getApiKeyLink="https://ollama.com/download";labelForGetApiKey="Download Ollama";icon="i-ph:cloud-arrow-down";config={baseUrlKey:"OLLAMA_API_BASE_URL"};staticModels=[];async getDynamicModels(e,r,n={}){let{baseUrl:s}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"OLLAMA_API_BASE_URL",defaultApiTokenKey:""});if(!s)throw new Error("No baseUrl found for OLLAMA provider");if(typeof window>"u"){const a=K0.RUNNING_IN_DOCKER==="true";s=a?s.replace("localhost","host.docker.internal"):s,s=a?s.replace("127.0.0.1","host.docker.internal"):s}return(await(await fetch(`${s}/api/tags`)).json()).models.map(a=>({name:a.name,label:`${a.name} (${a.details.parameter_size})`,provider:this.name,maxTokenAllowed:8e3}))}getModelInstance=e=>{const{apiKeys:r,providerSettings:n,serverEnv:s,model:i}=e;let{baseUrl:o}=this.getProviderBaseUrlAndKey({apiKeys:r,providerSettings:n?.[this.name],serverEnv:s,defaultBaseUrlKey:"OLLAMA_API_BASE_URL",defaultApiTokenKey:""});if(!o)throw new Error("No baseUrl found for OLLAMA provider");const a=K0.RUNNING_IN_DOCKER==="true";o=a?o.replace("localhost","host.docker.internal"):o,o=a?o.replace("127.0.0.1","host.docker.internal"):o,ET.debug("Ollama Base Url used: ",o);const l=eie(i,{numCtx:tie});return l.config.baseURL=`${o}/api`,l}}var io=class extends Error{constructor({message:t,url:e,requestBodyValues:r,statusCode:n,responseHeaders:s,responseBody:i,cause:o,isRetryable:a=n!=null&&(n===408||n===409||n===429||n>=500),data:l}){super(t),this.name="AI_APICallError",this.url=e,this.requestBodyValues=r,this.statusCode=n,this.responseHeaders=s,this.responseBody=i,this.cause=o,this.isRetryable=a,this.data=l}static isAPICallError(t){return t instanceof Error&&t.name==="AI_APICallError"&&typeof t.url=="string"&&typeof t.requestBodyValues=="object"&&(t.statusCode==null||typeof t.statusCode=="number")&&(t.responseHeaders==null||typeof t.responseHeaders=="object")&&(t.responseBody==null||typeof t.responseBody=="string")&&(t.cause==null||typeof t.cause=="object")&&typeof t.isRetryable=="boolean"&&(t.data==null||typeof t.data=="object")}toJSON(){return{name:this.name,message:this.message,url:this.url,requestBodyValues:this.requestBodyValues,statusCode:this.statusCode,responseHeaders:this.responseHeaders,responseBody:this.responseBody,cause:this.cause,isRetryable:this.isRetryable,data:this.data}}},nie=class extends Error{constructor({message:t="Empty response body"}={}){super(t),this.name="AI_EmptyResponseBodyError"}static isEmptyResponseBodyError(t){return t instanceof Error&&t.name==="AI_EmptyResponseBodyError"}toJSON(){return{name:this.name,message:this.message,stack:this.stack}}},sie=class extends Error{constructor({prompt:t,message:e}){super(`Invalid prompt: ${e}`),this.name="AI_InvalidPromptError",this.prompt=t}static isInvalidPromptError(t){return t instanceof Error&&t.name==="AI_InvalidPromptError"&&prompt!=null}toJSON(){return{name:this.name,message:this.message,stack:this.stack,prompt:this.prompt}}},$v=class extends Error{constructor({data:t,message:e=`Invalid response data: ${JSON.stringify(t)}.`}){super(e),this.name="AI_InvalidResponseDataError",this.data=t}static isInvalidResponseDataError(t){return t instanceof Error&&t.name==="AI_InvalidResponseDataError"&&t.data!=null}toJSON(){return{name:this.name,message:this.message,stack:this.stack,data:this.data}}};function i5(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var Y0=class extends Error{constructor({text:e,cause:r}){super(`JSON parsing failed: Text: ${e}.
Error message: ${i5(r)}`),this.name="AI_JSONParseError",this.cause=r,this.text=e}static isJSONParseError(e){return e instanceof Error&&e.name==="AI_JSONParseError"&&typeof e.text=="string"&&typeof e.cause=="string"}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,valueText:this.text}}},Bm=class extends Error{constructor({message:t}){super(t),this.name="AI_LoadAPIKeyError"}static isLoadAPIKeyError(t){return t instanceof Error&&t.name==="AI_LoadAPIKeyError"}toJSON(){return{name:this.name,message:this.message}}},vd=class extends Error{constructor({value:e,cause:r}){super(`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${i5(r)}`),this.name="AI_TypeValidationError",this.cause=r,this.value=e}static isTypeValidationError(e){return e instanceof Error&&e.name==="AI_TypeValidationError"}toJSON(){return{name:this.name,message:this.message,cause:this.cause,stack:this.stack,value:this.value}}},oo=class extends Error{constructor({functionality:e}){super(`'${e}' functionality not supported.`),this.name="AI_UnsupportedFunctionalityError",this.functionality=e}static isUnsupportedFunctionalityError(e){return e instanceof Error&&e.name==="AI_UnsupportedFunctionalityError"&&typeof e.functionality=="string"}toJSON(){return{name:this.name,message:this.message,stack:this.stack,functionality:this.functionality}}},iie={};function X0(...t){return t.reduce((e,r)=>({...e,...r??{}}),{})}function Zy(t){const e={};return t.headers.forEach((r,n)=>{e[n]=r}),e}var Hv=y4("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",7);function zv(t){return t instanceof Error&&(t.name==="AbortError"||t.name==="TimeoutError")}function oie({apiKey:t,environmentVariableName:e,apiKeyParameterName:r="apiKey",description:n}){if(typeof t=="string")return t;if(t!=null)throw new Bm({message:`${n} API key must be a string.`});if(typeof Dt>"u")throw new Bm({message:`${n} API key is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=iie[e],t==null)throw new Bm({message:`${n} API key is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new Bm({message:`${n} API key must be a string. The value of the ${e} environment variable is not a string.`});return t}function aie({value:t,schema:e}){try{return e.parse(t)}catch(r){throw new vd({value:t,cause:r})}}function lie({value:t,schema:e}){try{const r=e.safeParse(t);return r.success?{success:!0,value:r.data}:{success:!1,error:new vd({value:t,cause:r.error})}}catch(r){return{success:!1,error:vd.isTypeValidationError(r)?r:new vd({value:t,cause:r})}}}function cie({text:t,schema:e}){try{const r=Ws.parse(t);return e==null?r:aie({value:r,schema:e})}catch(r){throw Y0.isJSONParseError(r)||vd.isTypeValidationError(r)?r:new Y0({text:t,cause:r})}}function o5({text:t,schema:e}){try{const r=Ws.parse(t);return e==null?{success:!0,value:r}:lie({value:r,schema:e})}catch(r){return{success:!1,error:Y0.isJSONParseError(r)?r:new Y0({text:t,cause:r})}}}function cI(t){try{return Ws.parse(t),!0}catch{return!1}}function uie(t){return Object.fromEntries(Object.entries(t).filter(([e,r])=>r!=null))}var hie=()=>fetch,Z0=async({url:t,headers:e,body:r,failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o})=>die({url:t,headers:{"Content-Type":"application/json",...e},body:{content:JSON.stringify(r),values:r},failedResponseHandler:n,successfulResponseHandler:s,abortSignal:i,fetch:o}),die=async({url:t,headers:e={},body:r,successfulResponseHandler:n,failedResponseHandler:s,abortSignal:i,fetch:o=hie()})=>{try{const a=await o(t,{method:"POST",headers:uie(e),body:r.content,signal:i}),l=Zy(a);if(!a.ok){let c;try{c=await s({response:a,url:t,requestBodyValues:r.values})}catch(u){throw zv(u)||io.isAPICallError(u)?u:new io({message:"Failed to process error response",cause:u,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}throw c.value}try{return await n({response:a,url:t,requestBodyValues:r.values})}catch(c){throw c instanceof Error&&(zv(c)||io.isAPICallError(c))?c:new io({message:"Failed to process successful response",cause:c,statusCode:a.status,url:t,responseHeaders:l,requestBodyValues:r.values})}}catch(a){if(zv(a))throw a;if(a instanceof TypeError&&a.message==="fetch failed"){const l=a.cause;if(l!=null)throw new io({message:`Cannot connect to API: ${l.message}`,cause:l,url:t,requestBodyValues:r.values,isRetryable:!0})}throw a}},fie=({errorSchema:t,errorToMessage:e,isRetryable:r})=>async({response:n,url:s,requestBodyValues:i})=>{const o=await n.text(),a=Zy(n);if(o.trim()==="")return{responseHeaders:a,value:new io({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})};try{const l=cie({text:o,schema:t});return{responseHeaders:a,value:new io({message:e(l),url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,data:l,isRetryable:r?.(n,l)})}}catch{return{responseHeaders:a,value:new io({message:n.statusText,url:s,requestBodyValues:i,statusCode:n.status,responseHeaders:a,responseBody:o,isRetryable:r?.(n)})}}},a5=t=>async({response:e})=>{const r=Zy(e);if(e.body==null)throw new nie({});return{responseHeaders:r,value:e.body.pipeThrough(new TextDecoderStream).pipeThrough(new _C).pipeThrough(new TransformStream({transform({data:n},s){n!=="[DONE]"&&s.enqueue(o5({text:n,schema:t}))}}))}},l5=t=>async({response:e,url:r,requestBodyValues:n})=>{const s=await e.text(),i=o5({text:s,schema:t}),o=Zy(e);if(!i.success)throw new io({message:"Invalid JSON response",cause:i.error,statusCode:e.status,responseHeaders:o,responseBody:s,url:r,requestBodyValues:n});return{responseHeaders:o,value:i.value}};function pie(t){let e="";for(let r=0;r<t.length;r++)e+=String.fromCodePoint(t[r]);return globalThis.btoa(e)}function mie(t){return t?.replace(/\/$/,"")}var gie=Object.defineProperty,_ie=Object.defineProperties,yie=Object.getOwnPropertyDescriptors,J0=Object.getOwnPropertySymbols,c5=Object.prototype.hasOwnProperty,u5=Object.prototype.propertyIsEnumerable,uI=(t,e,r)=>e in t?gie(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Qi=(t,e)=>{for(var r in e||(e={}))c5.call(e,r)&&uI(t,r,e[r]);if(J0)for(var r of J0(e))u5.call(e,r)&&uI(t,r,e[r]);return t},Kg=(t,e)=>_ie(t,yie(e)),Q0=(t,e)=>{var r={};for(var n in t)c5.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&J0)for(var n of J0(t))e.indexOf(n)<0&&u5.call(t,n)&&(r[n]=t[n]);return r};function bie(t){var e;const r=[];for(const{role:n,content:s}of t)switch(n){case"system":{r.push({role:"system",content:s});break}case"user":{if(s.length===1&&((e=s[0])==null?void 0:e.type)==="text"){r.push({role:"user",content:s[0].text});break}r.push({role:"user",content:s.map(i=>{var o;switch(i.type){case"text":return{type:"text",text:i.text};case"image":return{type:"image_url",image_url:{url:i.image instanceof URL?i.image.toString():`data:${(o=i.mimeType)!=null?o:"image/jpeg"};base64,${pie(i.image)}`}}}})});break}case"assistant":{let i="";const o=[];for(const a of s)switch(a.type){case"text":{i+=a.text;break}case"tool-call":{o.push({id:a.toolCallId,type:"function",function:{name:a.toolName,arguments:JSON.stringify(a.args)}});break}default:{const l=a;throw new Error(`Unsupported part: ${l}`)}}r.push({role:"assistant",content:i,tool_calls:o.length>0?o:void 0});break}case"tool":{for(const i of s)r.push({role:"tool",tool_call_id:i.toolCallId,content:JSON.stringify(i.result)});break}default:{const i=n;throw new Error(`Unsupported role: ${i}`)}}return r}function hI(t){var e,r;return(r=(e=t?.content)==null?void 0:e.map(({token:n,logprob:s,top_logprobs:i})=>({token:n,logprob:s,topLogprobs:i?i.map(({token:o,logprob:a})=>({token:o,logprob:a})):[]})))!=null?r:void 0}function e_(t){switch(t){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var xC=j.object({error:j.object({message:j.string(),type:j.string(),param:j.any().nullable(),code:j.string().nullable()})}),t_=fie({errorSchema:xC,errorToMessage:t=>t.error.message}),vie=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,frequencyPenalty:i,presencePenalty:o,seed:a}){const l=t.type,c=Qi({model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:r,temperature:n,top_p:s,frequency_penalty:i,presence_penalty:o,seed:a,messages:bie(e)},this.config.extraBody);switch(l){case"regular":return Qi(Qi({},c),xie(t));case"object-json":return Kg(Qi({},c),{response_format:{type:"json_object"}});case"object-tool":return Kg(Qi({},c),{tool_choice:{type:"function",function:{name:t.tool.name}},tools:[{type:"function",function:{name:t.tool.name,description:t.tool.description,parameters:t.tool.parameters}}]});case"object-grammar":throw new oo({functionality:"object-grammar mode"});default:{const u=l;throw new Error(`Unsupported type: ${u}`)}}}async doGenerate(t){var e,r;const n=this.getArgs(t),{responseHeaders:s,value:i}=await Z0({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:X0(this.config.headers(),t.headers),body:n,failedResponseHandler:t_,successfulResponseHandler:l5(wie),abortSignal:t.abortSignal,fetch:this.config.fetch}),o=n,{messages:a}=o,l=Q0(o,["messages"]),c=i.choices[0];if(c==null)throw new Error("No choice in response");return{text:(e=c.message.content)!=null?e:void 0,toolCalls:(r=c.message.tool_calls)==null?void 0:r.map(u=>{var h;return{toolCallType:"function",toolCallId:(h=u.id)!=null?h:Hv(),toolName:u.function.name,args:u.function.arguments}}),finishReason:e_(c.finish_reason),usage:{promptTokens:i.usage.prompt_tokens,completionTokens:i.usage.completion_tokens},rawCall:{rawPrompt:a,rawSettings:l},rawResponse:{headers:s},warnings:[],logprobs:hI(c.logprobs)}}async doStream(t){const e=this.getArgs(t),{responseHeaders:r,value:n}=await Z0({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:X0(this.config.headers(),t.headers),body:Kg(Qi({},e),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:t_,successfulResponseHandler:a5(Eie),abortSignal:t.abortSignal,fetch:this.config.fetch}),s=e,{messages:i}=s,o=Q0(s,["messages"]),a=[];let l="other",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u;return{stream:n.pipeThrough(new TransformStream({transform(h,d){var f,g,_,m,p,y,b,v,w,E,S,x;if(!h.success){l="error",d.enqueue({type:"error",error:h.error});return}const C=h.value;if("error"in C){l="error",d.enqueue({type:"error",error:C.error});return}C.usage!=null&&(c={promptTokens:C.usage.prompt_tokens,completionTokens:C.usage.completion_tokens});const A=C.choices[0];if(A?.finish_reason!=null&&(l=e_(A.finish_reason)),A?.delta==null)return;const M=A.delta;M.content!=null&&d.enqueue({type:"text-delta",textDelta:M.content});const P=hI(A?.logprobs);if(P?.length&&(u===void 0&&(u=[]),u.push(...P)),M.tool_calls!=null)for(const D of M.tool_calls){const R=D.index;if(a[R]==null){if(D.type!=="function")throw new $v({data:D,message:"Expected 'function' type."});if(D.id==null)throw new $v({data:D,message:"Expected 'id' to be a string."});if(((f=D.function)==null?void 0:f.name)==null)throw new $v({data:D,message:"Expected 'function.name' to be a string."});a[R]={id:D.id,type:"function",function:{name:D.function.name,arguments:(g=D.function.arguments)!=null?g:""}};const ee=a[R];if(ee==null)throw new Error("Tool call is missing");((_=ee.function)==null?void 0:_.name)!=null&&((m=ee.function)==null?void 0:m.arguments)!=null&&cI(ee.function.arguments)&&(d.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ee.id,toolName:ee.function.name,argsTextDelta:ee.function.arguments}),d.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(p=ee.id)!=null?p:Hv(),toolName:ee.function.name,args:ee.function.arguments}));continue}const G=a[R];if(G==null)throw new Error("Tool call is missing");((y=D.function)==null?void 0:y.arguments)!=null&&(G.function.arguments+=(v=(b=D.function)==null?void 0:b.arguments)!=null?v:""),d.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:G.id,toolName:G.function.name,argsTextDelta:(w=D.function.arguments)!=null?w:""}),((E=G.function)==null?void 0:E.name)!=null&&((S=G.function)==null?void 0:S.arguments)!=null&&cI(G.function.arguments)&&d.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(x=G.id)!=null?x:Hv(),toolName:G.function.name,args:G.function.arguments})}},flush(h){h.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:r},warnings:[]}}},wie=j.object({choices:j.array(j.object({message:j.object({role:j.literal("assistant"),content:j.string().nullable().optional(),tool_calls:j.array(j.object({id:j.string().optional().nullable(),type:j.literal("function"),function:j.object({name:j.string(),arguments:j.string()})})).optional()}),index:j.number(),logprobs:j.object({content:j.array(j.object({token:j.string(),logprob:j.number(),top_logprobs:j.array(j.object({token:j.string(),logprob:j.number()}))})).nullable()}).nullable().optional(),finish_reason:j.string().optional().nullable()})),usage:j.object({prompt_tokens:j.number(),completion_tokens:j.number()})}),Eie=j.union([j.object({choices:j.array(j.object({delta:j.object({role:j.enum(["assistant"]).optional(),content:j.string().nullish(),tool_calls:j.array(j.object({index:j.number(),id:j.string().nullish(),type:j.literal("function").optional(),function:j.object({name:j.string().nullish(),arguments:j.string().nullish()})})).nullish()}).nullish(),logprobs:j.object({content:j.array(j.object({token:j.string(),logprob:j.number(),top_logprobs:j.array(j.object({token:j.string(),logprob:j.number()}))})).nullable()}).nullish(),finish_reason:j.string().nullable().optional(),index:j.number()})),usage:j.object({prompt_tokens:j.number(),completion_tokens:j.number()}).nullish()}),xC]);function xie(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0;if(r==null)return{tools:void 0,tool_choice:void 0};const n=r.map(o=>({type:"function",function:{name:o.name,description:o.description,parameters:o.parameters}})),s=t.toolChoice;if(s==null)return{tools:n,tool_choice:void 0};const i=s.type;switch(i){case"auto":case"none":case"required":return{tools:n,tool_choice:i};case"tool":return{tools:n,tool_choice:{type:"function",function:{name:s.toolName}}};default:{const o=i;throw new Error(`Unsupported tool choice type: ${o}`)}}}function Sie({prompt:t,inputFormat:e,user:r="user",assistant:n="assistant"}){if(e==="prompt"&&t.length===1&&t[0]&&t[0].role==="user"&&t[0].content.length===1&&t[0].content[0]&&t[0].content[0].type==="text")return{prompt:t[0].content[0].text};let s="";t[0]&&t[0].role==="system"&&(s+=`${t[0].content}

`,t=t.slice(1));for(const{role:i,content:o}of t)switch(i){case"system":throw new sie({message:"Unexpected system message in prompt: ${content}",prompt:t});case"user":{const a=o.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new oo({functionality:"images"})}}).join("");s+=`${r}:
${a}

`;break}case"assistant":{const a=o.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new oo({functionality:"tool-call messages"})}}).join("");s+=`${n}:
${a}

`;break}case"tool":throw new oo({functionality:"tool messages"});default:{const a=i;throw new Error(`Unsupported role: ${a}`)}}return s+=`${n}:
`,{prompt:s,stopSequences:[`
${r}:`]}}function dI(t){return t?.tokens.map((e,r)=>{var n,s;return{token:e,logprob:(n=t.token_logprobs[r])!=null?n:0,topLogprobs:t.top_logprobs?Object.entries((s=t.top_logprobs[r])!=null?s:{}).map(([i,o])=>({token:i,logprob:o})):[]}})}var Tie=class{constructor(t,e,r){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=t,this.settings=e,this.config=r}get provider(){return this.config.provider}getArgs({mode:t,inputFormat:e,prompt:r,maxTokens:n,temperature:s,topP:i,frequencyPenalty:o,presencePenalty:a,seed:l}){var c;const u=t.type,{prompt:h,stopSequences:d}=Sie({prompt:r,inputFormat:e}),f=Qi({model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:n,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:a,seed:l,prompt:h,stop:d},this.config.extraBody);switch(u){case"regular":{if((c=t.tools)!=null&&c.length)throw new oo({functionality:"tools"});if(t.toolChoice)throw new oo({functionality:"toolChoice"});return f}case"object-json":throw new oo({functionality:"object-json mode"});case"object-tool":throw new oo({functionality:"object-tool mode"});case"object-grammar":throw new oo({functionality:"object-grammar mode"});default:{const g=u;throw new Error(`Unsupported type: ${g}`)}}}async doGenerate(t){const e=this.getArgs(t),{responseHeaders:r,value:n}=await Z0({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:X0(this.config.headers(),t.headers),body:e,failedResponseHandler:t_,successfulResponseHandler:l5(Cie),abortSignal:t.abortSignal,fetch:this.config.fetch}),s=e,{prompt:i}=s,o=Q0(s,["prompt"]),a=n.choices[0];if(!a)throw new Error("No choice in OpenRouter completion response");return{text:a.text,usage:{promptTokens:n.usage.prompt_tokens,completionTokens:n.usage.completion_tokens},finishReason:e_(a.finish_reason),logprobs:dI(a.logprobs),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:r},warnings:[]}}async doStream(t){const e=this.getArgs(t),{responseHeaders:r,value:n}=await Z0({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:X0(this.config.headers(),t.headers),body:Kg(Qi({},this.getArgs(t)),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:t_,successfulResponseHandler:a5(kie),abortSignal:t.abortSignal,fetch:this.config.fetch}),s=e,{prompt:i}=s,o=Q0(s,["prompt"]);let a="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c;return{stream:n.pipeThrough(new TransformStream({transform(u,h){if(!u.success){a="error",h.enqueue({type:"error",error:u.error});return}const d=u.value;if("error"in d){a="error",h.enqueue({type:"error",error:d.error});return}d.usage!=null&&(l={promptTokens:d.usage.prompt_tokens,completionTokens:d.usage.completion_tokens});const f=d.choices[0];f?.finish_reason!=null&&(a=e_(f.finish_reason)),f?.text!=null&&h.enqueue({type:"text-delta",textDelta:f.text});const g=dI(f?.logprobs);g?.length&&(c===void 0&&(c=[]),c.push(...g))},flush(u){u.enqueue({type:"finish",finishReason:a,logprobs:c,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:o},rawResponse:{headers:r},warnings:[]}}},Cie=j.object({choices:j.array(j.object({text:j.string(),finish_reason:j.string(),logprobs:j.object({tokens:j.array(j.string()),token_logprobs:j.array(j.number()),top_logprobs:j.array(j.record(j.string(),j.number())).nullable()}).nullable().optional()})),usage:j.object({prompt_tokens:j.number(),completion_tokens:j.number()})}),kie=j.union([j.object({choices:j.array(j.object({text:j.string(),finish_reason:j.string().nullish(),index:j.number(),logprobs:j.object({tokens:j.array(j.string()),token_logprobs:j.array(j.number()),top_logprobs:j.array(j.record(j.string(),j.number())).nullable()}).nullable().optional()})),usage:j.object({prompt_tokens:j.number(),completion_tokens:j.number()}).optional().nullable()}),xC]);function h5(t={}){var e,r,n;const s=(r=mie((e=t.baseURL)!=null?e:t.baseUrl))!=null?r:"https://openrouter.ai/api/v1",i=(n=t.compatibility)!=null?n:"compatible",o=()=>Qi({Authorization:`Bearer ${oie({apiKey:t.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},t.headers),a=(h,d={})=>new vie(h,d,{provider:"openrouter.chat",url:({path:f})=>`${s}${f}`,headers:o,compatibility:i,fetch:t.fetch,extraBody:t.extraBody}),l=(h,d={})=>new Tie(h,d,{provider:"openrouter.completion",url:({path:f})=>`${s}${f}`,headers:o,compatibility:i,fetch:t.fetch,extraBody:t.extraBody}),c=(h,d)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return h==="openai/gpt-3.5-turbo-instruct"?l(h,d):a(h,d)},u=function(h,d){return c(h,d)};return u.languageModel=c,u.chat=a,u.completion=l,u}h5({compatibility:"strict"});class Aie extends Ir{name="OpenRouter";getApiKeyLink="https://openrouter.ai/settings/keys";config={apiTokenKey:"OPEN_ROUTER_API_KEY"};staticModels=[{name:"anthropic/claude-3.5-sonnet",label:"Anthropic: Claude 3.5 Sonnet (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"anthropic/claude-3-haiku",label:"Anthropic: Claude 3 Haiku (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"deepseek/deepseek-coder",label:"Deepseek-Coder V2 236B (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"google/gemini-flash-1.5",label:"Google Gemini Flash 1.5 (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"google/gemini-pro-1.5",label:"Google Gemini Pro 1.5 (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"x-ai/grok-beta",label:"xAI Grok Beta (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"mistralai/mistral-nemo",label:"OpenRouter Mistral Nemo (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"qwen/qwen-110b-chat",label:"OpenRouter Qwen 110b Chat (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:8e3},{name:"cohere/command",label:"Cohere Command (OpenRouter)",provider:"OpenRouter",maxTokenAllowed:4096}];async getDynamicModels(e,r,n={}){try{return(await(await fetch("https://openrouter.ai/api/v1/models",{headers:{"Content-Type":"application/json"}})).json()).data.sort((o,a)=>o.name.localeCompare(a.name)).map(o=>({name:o.id,label:`${o.name} - in:$${(o.pricing.prompt*1e6).toFixed(2)} out:$${(o.pricing.completion*1e6).toFixed(2)} - context ${Math.floor(o.context_length/1e3)}k`,provider:this.name,maxTokenAllowed:8e3}))}catch(s){return console.error("Error getting OpenRouter models:",s),[]}}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"OPEN_ROUTER_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return h5({apiKey:o}).chat(r)}}class Rie extends Ir{name="OpenAILike";getApiKeyLink=void 0;config={baseUrlKey:"OPENAI_LIKE_API_BASE_URL",apiTokenKey:"OPENAI_LIKE_API_KEY"};staticModels=[];async getDynamicModels(e,r,n={}){const{baseUrl:s,apiKey:i}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"OPENAI_LIKE_API_BASE_URL",defaultApiTokenKey:"OPENAI_LIKE_API_KEY"});return!s||!i?[]:(await(await fetch(`${s}/models`,{headers:{Authorization:`Bearer ${i}`}})).json()).data.map(l=>({name:l.id,label:l.id,provider:this.name,maxTokenAllowed:8e3}))}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{baseUrl:o,apiKey:a}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"OPENAI_LIKE_API_BASE_URL",defaultApiTokenKey:"OPENAI_LIKE_API_KEY"});if(!o||!a)throw new Error(`Missing configuration for ${this.name} provider`);return nF(o,a,r)}}class Iie extends Ir{name="OpenAI";getApiKeyLink="https://platform.openai.com/api-keys";config={apiTokenKey:"OPENAI_API_KEY"};staticModels=[{name:"gpt-4o",label:"GPT-4o",provider:"OpenAI",maxTokenAllowed:8e3},{name:"gpt-4o-mini",label:"GPT-4o Mini",provider:"OpenAI",maxTokenAllowed:8e3},{name:"gpt-4-turbo",label:"GPT-4 Turbo",provider:"OpenAI",maxTokenAllowed:8e3},{name:"gpt-4",label:"GPT-4",provider:"OpenAI",maxTokenAllowed:8e3},{name:"gpt-3.5-turbo",label:"GPT-3.5 Turbo",provider:"OpenAI",maxTokenAllowed:8e3}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"OPENAI_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return zi({apiKey:o})(r)}}class Pie extends Ir{name="Perplexity";getApiKeyLink="https://www.perplexity.ai/settings/api";config={apiTokenKey:"PERPLEXITY_API_KEY"};staticModels=[{name:"llama-3.1-sonar-small-128k-online",label:"Sonar Small Online",provider:"Perplexity",maxTokenAllowed:8192},{name:"llama-3.1-sonar-large-128k-online",label:"Sonar Large Online",provider:"Perplexity",maxTokenAllowed:8192},{name:"llama-3.1-sonar-huge-128k-online",label:"Sonar Huge Online",provider:"Perplexity",maxTokenAllowed:8192}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"PERPLEXITY_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return zi({baseURL:"https://api.perplexity.ai/",apiKey:o})(r)}}class Oie extends Ir{name="Together";getApiKeyLink="https://api.together.xyz/settings/api-keys";config={baseUrlKey:"TOGETHER_API_BASE_URL",apiTokenKey:"TOGETHER_API_KEY"};staticModels=[{name:"Qwen/Qwen2.5-Coder-32B-Instruct",label:"Qwen/Qwen2.5-Coder-32B-Instruct",provider:"Together",maxTokenAllowed:8e3},{name:"meta-llama/Llama-3.2-90B-Vision-Instruct-Turbo",label:"meta-llama/Llama-3.2-90B-Vision-Instruct-Turbo",provider:"Together",maxTokenAllowed:8e3},{name:"mistralai/Mixtral-8x7B-Instruct-v0.1",label:"Mixtral 8x7B Instruct",provider:"Together",maxTokenAllowed:8192}];async getDynamicModels(e,r,n={}){const{baseUrl:s,apiKey:i}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"TOGETHER_API_BASE_URL",defaultApiTokenKey:"TOGETHER_API_KEY"}),o=s||"https://api.together.xyz/v1";return!o||!i?[]:(await(await fetch(`${o}/models`,{headers:{Authorization:`Bearer ${i}`}})).json()||[]).filter(u=>u.type==="chat").map(u=>({name:u.id,label:`${u.display_name} - in:$${u.pricing.input.toFixed(2)} out:$${u.pricing.output.toFixed(2)} - context ${Math.floor(u.context_length/1e3)}k`,provider:this.name,maxTokenAllowed:8e3}))}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{baseUrl:o,apiKey:a}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"TOGETHER_API_BASE_URL",defaultApiTokenKey:"TOGETHER_API_KEY"});if(!o||!a)throw new Error(`Missing configuration for ${this.name} provider`);return nF(o,a,r)}}class Die extends Ir{name="xAI";getApiKeyLink="https://docs.x.ai/docs/quickstart#creating-an-api-key";config={apiTokenKey:"XAI_API_KEY"};staticModels=[{name:"grok-beta",label:"xAI Grok Beta",provider:"xAI",maxTokenAllowed:8e3},{name:"grok-2-1212",label:"xAI Grok2 1212",provider:"xAI",maxTokenAllowed:8e3}];getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"XAI_API_KEY"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);return zi({baseURL:"https://api.x.ai/v1",apiKey:o})(r)}}class Lie extends Ir{name="Hyperbolic";getApiKeyLink="https://app.hyperbolic.xyz/settings";config={apiTokenKey:"HYPERBOLIC_API_KEY"};staticModels=[{name:"Qwen/Qwen2.5-Coder-32B-Instruct",label:"Qwen 2.5 Coder 32B Instruct",provider:"Hyperbolic",maxTokenAllowed:8192},{name:"Qwen/Qwen2.5-72B-Instruct",label:"Qwen2.5-72B-Instruct",provider:"Hyperbolic",maxTokenAllowed:8192},{name:"deepseek-ai/DeepSeek-V2.5",label:"DeepSeek-V2.5",provider:"Hyperbolic",maxTokenAllowed:8192},{name:"Qwen/QwQ-32B-Preview",label:"QwQ-32B-Preview",provider:"Hyperbolic",maxTokenAllowed:8192},{name:"Qwen/Qwen2-VL-72B-Instruct",label:"Qwen2-VL-72B-Instruct",provider:"Hyperbolic",maxTokenAllowed:8192}];async getDynamicModels(e,r,n={}){const{baseUrl:s,apiKey:i}=this.getProviderBaseUrlAndKey({apiKeys:e,providerSettings:r,serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"HYPERBOLIC_API_KEY"}),o=s||"https://api.hyperbolic.xyz/v1";if(!i)throw`Missing Api Key configuration for ${this.name} provider`;return(await(await fetch(`${o}/models`,{headers:{Authorization:`Bearer ${i}`}})).json()).data.filter(u=>u.object==="model"&&u.supports_chat).map(u=>({name:u.id,label:`${u.id} - context ${u.context_length?Math.floor(u.context_length/1e3)+"k":"N/A"}`,provider:this.name,maxTokenAllowed:u.context_length||8e3}))}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"HYPERBOLIC_API_KEY"});if(!o)throw`Missing Api Key configuration for ${this.name} provider`;return zi({baseURL:"https://api.hyperbolic.xyz/v1/",apiKey:o})(r)}}var d5="vercel.ai.error",Nie=Symbol.for(d5),f5,Mie=class p5 extends Error{constructor({name:e,message:r,cause:n}){super(r),this[f5]=!0,this.name=e,this.cause=n}static isInstance(e){return p5.hasMarker(e,d5)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}};f5=Nie;var Su=Mie,m5="AI_InvalidArgumentError",g5=`vercel.ai.error.${m5}`,Bie=Symbol.for(g5),_5,Fie=class extends Su{constructor({message:e,cause:r,argument:n}){super({name:m5,message:e,cause:r}),this[_5]=!0,this.argument=n}static isInstance(e){return Su.hasMarker(e,g5)}};_5=Bie;var y5="AI_LoadSettingError",b5=`vercel.ai.error.${y5}`,jie=Symbol.for(b5),v5,Fm=class extends Su{constructor({message:t}){super({name:y5,message:t}),this[v5]=!0}static isInstance(t){return Su.hasMarker(t,b5)}};v5=jie;var w5="AI_UnsupportedFunctionalityError",E5=`vercel.ai.error.${w5}`,Uie=Symbol.for(E5),x5,wd=class extends Su{constructor({functionality:t}){super({name:w5,message:`'${t}' functionality not supported.`}),this[x5]=!0,this.functionality=t}static isInstance(t){return Su.hasMarker(t,E5)}};x5=Uie;var S5={},T5=({prefix:t,size:e=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{const s=EC(r,e);if(t==null)return s;if(r.includes(n))throw new Fie({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return i=>`${t}${n}${s(i)}`},$ie=T5();function Hie({settingValue:t,environmentVariableName:e}){if(typeof t=="string")return t;if(!(t!=null||typeof Dt>"u")&&(t=S5[e],!(t==null||typeof t!="string")))return t}function Vv({settingValue:t,environmentVariableName:e,settingName:r,description:n}){if(typeof t=="string")return t;if(t!=null)throw new Fm({message:`${n} setting must be a string.`});if(typeof Dt>"u")throw new Fm({message:`${n} setting is missing. Pass it using the '${r}' parameter. Environment variables is not supported in this environment.`});if(t=S5[e],t==null)throw new Fm({message:`${n} setting is missing. Pass it using the '${r}' parameter or the ${e} environment variable.`});if(typeof t!="string")throw new Fm({message:`${n} setting must be a string. The value of the ${e} environment variable is not a string.`});return t}const zie=t=>{let e=t.httpHandler;return{setHttpHandler(r){e=r},httpHandler(){return e},updateHttpClientConfig(r,n){e.updateHttpClientConfig(r,n)},httpHandlerConfigs(){return e.httpHandlerConfigs()}}},Vie=t=>({httpHandler:t.httpHandler()});var fI;(function(t){t.HEADER="header",t.QUERY="query"})(fI||(fI={}));var pI;(function(t){t.HEADER="header",t.QUERY="query"})(pI||(pI={}));var gf;(function(t){t.HTTP="http",t.HTTPS="https"})(gf||(gf={}));var r_;(function(t){t.MD5="md5",t.CRC32="crc32",t.CRC32C="crc32c",t.SHA1="sha1",t.SHA256="sha256"})(r_||(r_={}));var mI;(function(t){t[t.HEADER=0]="HEADER",t[t.TRAILER=1]="TRAILER"})(mI||(mI={}));const YE="__smithy_context";var gI;(function(t){t.PROFILE="profile",t.SSO_SESSION="sso-session",t.SERVICES="services"})(gI||(gI={}));var _I;(function(t){t.HTTP_0_9="http/0.9",t.HTTP_1_0="http/1.0",t.TDS_8_0="tds/8.0"})(_I||(_I={}));class es{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?e.protocol.slice(-1)!==":"?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?e.path.charAt(0)!=="/"?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const r=new es({...e,headers:{...e.headers}});return r.query&&(r.query=Gie(r.query)),r}static isInstance(e){if(!e)return!1;const r=e;return"method"in r&&"protocol"in r&&"hostname"in r&&"path"in r&&typeof r.query=="object"&&typeof r.headers=="object"}clone(){return es.clone(this)}}function Gie(t){return Object.keys(t).reduce((e,r)=>{const n=t[r];return{...e,[r]:Array.isArray(n)?[...n]:n}},{})}class n_{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const r=e;return typeof r.statusCode=="number"&&typeof r.headers=="object"}}const Wie=t=>e=>async r=>{if(!es.isInstance(r.request))return e(r);const{request:n}=r,{handlerProtocol:s=""}=t.requestHandler.metadata||{};if(s.indexOf("h2")>=0&&!n.headers[":authority"])delete n.headers.host,n.headers[":authority"]=n.hostname+(n.port?":"+n.port:"");else if(!n.headers.host){let i=n.hostname;n.port!=null&&(i+=`:${n.port}`),n.headers.host=i}return e(r)},qie={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},Kie=t=>({applyToStack:e=>{e.add(Wie(t),qie)}}),Yie=()=>(t,e)=>async r=>{try{const n=await t(r),{clientName:s,commandName:i,logger:o,dynamoDbDocumentClientOptions:a={}}=e,{overrideInputFilterSensitiveLog:l,overrideOutputFilterSensitiveLog:c}=a,u=l??e.inputFilterSensitiveLog,h=c??e.outputFilterSensitiveLog,{$metadata:d,...f}=n.output;return o?.info?.({clientName:s,commandName:i,input:u(r.input),output:h(f),metadata:d}),n}catch(n){const{clientName:s,commandName:i,logger:o,dynamoDbDocumentClientOptions:a={}}=e,{overrideInputFilterSensitiveLog:l}=a,c=l??e.inputFilterSensitiveLog;throw o?.error?.({clientName:s,commandName:i,input:c(r.input),error:n,metadata:n.$metadata}),n}},Xie={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},Zie=t=>({applyToStack:e=>{e.add(Yie(),Xie)}});var yI={};const bI="X-Amzn-Trace-Id",Jie="AWS_LAMBDA_FUNCTION_NAME",Qie="_X_AMZN_TRACE_ID",eoe=t=>e=>async r=>{const{request:n}=r;if(!es.isInstance(n)||t.runtime!=="node"||n.headers.hasOwnProperty(bI))return e(r);const s=yI[Jie],i=yI[Qie],o=a=>typeof a=="string"&&a.length>0;return o(s)&&o(i)&&(n.headers[bI]=i),e({...r,request:n})},toe={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},roe=t=>({applyToStack:e=>{e.add(eoe(t),toe)}}),Jy=t=>t[YE]||(t[YE]={}),_a=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e};function noe(t){const e=new Map;for(const r of t)e.set(r.schemeId,r);return e}const soe=(t,e)=>(r,n)=>async s=>{const i=t.httpAuthSchemeProvider(await e.httpAuthSchemeParametersProvider(t,n,s.input)),o=noe(t.httpAuthSchemes),a=Jy(n),l=[];for(const c of i){const u=o.get(c.schemeId);if(!u){l.push(`HttpAuthScheme \`${c.schemeId}\` was not enabled for this service.`);continue}const h=u.identityProvider(await e.identityProviderConfigProvider(t));if(!h){l.push(`HttpAuthScheme \`${c.schemeId}\` did not have an IdentityProvider configured.`);continue}const{identityProperties:d={},signingProperties:f={}}=c.propertiesExtractor?.(t,n)||{};c.identityProperties=Object.assign(c.identityProperties||{},d),c.signingProperties=Object.assign(c.signingProperties||{},f),a.selectedHttpAuthScheme={httpAuthOption:c,identity:await h(c.identityProperties),signer:u.signer};break}if(!a.selectedHttpAuthScheme)throw new Error(l.join(`
`));return r(s)},ioe={step:"serialize",tags:["HTTP_AUTH_SCHEME"],name:"httpAuthSchemeMiddleware",override:!0,relation:"before",toMiddleware:"endpointV2Middleware"},ooe=(t,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:r})=>({applyToStack:n=>{n.addRelativeTo(soe(t,{httpAuthSchemeParametersProvider:e,identityProviderConfigProvider:r}),ioe)}}),aoe=(t,e)=>r=>async n=>{const{response:s}=await r(n);try{const i=await e(s,t);return{response:s,output:i}}catch(i){if(Object.defineProperty(i,"$response",{value:s}),!("$metadata"in i)){const o="Deserialization error: to see the raw response, inspect the hidden field {error}.$response on this object.";i.message+=`
  `+o,typeof i.$responseBodyText<"u"&&i.$response&&(i.$response.body=i.$responseBodyText)}throw i}},loe=(t,e)=>(r,n)=>async s=>{const i=n.endpointV2?.url&&t.urlParser?async()=>t.urlParser(n.endpointV2.url):t.endpoint;if(!i)throw new Error("No valid endpoint provider available.");const o=await e(s.input,{...t,endpoint:i});return r({...s,request:o})},coe={name:"deserializerMiddleware",step:"deserialize",tags:["DESERIALIZER"],override:!0},SC={name:"serializerMiddleware",step:"serialize",tags:["SERIALIZER"],override:!0};function TC(t,e,r){return{applyToStack:n=>{n.add(aoe(t,r),coe),n.add(loe(t,e),SC)}}}SC.name;const uoe=t=>e=>{throw e},hoe=(t,e)=>{},doe=t=>(e,r)=>async n=>{if(!es.isInstance(n.request))return e(n);const i=Jy(r).selectedHttpAuthScheme;if(!i)throw new Error("No HttpAuthScheme was selected: unable to sign request");const{httpAuthOption:{signingProperties:o={}},identity:a,signer:l}=i,c=await e({...n,request:await l.sign(n.request,a,o)}).catch((l.errorHandler||uoe)(o));return(l.successHandler||hoe)(c.response,o),c},foe={step:"finalizeRequest",tags:["HTTP_SIGNING"],name:"httpSigningMiddleware",aliases:["apiKeyMiddleware","tokenMiddleware","awsAuthMiddleware"],override:!0,relation:"after",toMiddleware:"retryMiddleware"},poe=t=>({applyToStack:e=>{e.addRelativeTo(doe(),foe)}}),rd=t=>{if(typeof t=="function")return t;const e=Promise.resolve(t);return()=>e},ka={},eh=new Array(64);for(let t=0,e=65,r=90;t+e<=r;t++){const n=String.fromCharCode(t+e);ka[n]=t,eh[t]=n}for(let t=0,e=97,r=122;t+e<=r;t++){const n=String.fromCharCode(t+e),s=t+26;ka[n]=s,eh[s]=n}for(let t=0;t<10;t++){ka[t.toString(10)]=t+52;const e=t.toString(10),r=t+52;ka[e]=r,eh[r]=e}ka["+"]=62;eh[62]="+";ka["/"]=63;eh[63]="/";const tu=6,Ed=8,moe=63,C5=t=>{let e=t.length/4*3;t.slice(-2)==="=="?e-=2:t.slice(-1)==="="&&e--;const r=new ArrayBuffer(e),n=new DataView(r);for(let s=0;s<t.length;s+=4){let i=0,o=0;for(let c=s,u=s+3;c<=u;c++)if(t[c]!=="="){if(!(t[c]in ka))throw new TypeError(`Invalid character ${t[c]} in base64 string.`);i|=ka[t[c]]<<(u-c)*tu,o+=tu}else i>>=tu;const a=s/4*3;i>>=o%Ed;const l=Math.floor(o/Ed);for(let c=0;c<l;c++){const u=(l-c-1)*Ed;n.setUint8(a+c,(i&255<<u)>>u)}}return new Uint8Array(r)},Tu=t=>new TextEncoder().encode(t),xd=t=>typeof t=="string"?Tu(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t),k5=t=>{if(typeof t=="string")return t;if(typeof t!="object"||typeof t.byteOffset!="number"||typeof t.byteLength!="number")throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return new TextDecoder("utf-8").decode(t)};function A5(t){let e;typeof t=="string"?e=Tu(t):e=t;const r=typeof e=="object"&&typeof e.length=="number",n=typeof e=="object"&&typeof e.byteOffset=="number"&&typeof e.byteLength=="number";if(!r&&!n)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");let s="";for(let i=0;i<e.length;i+=3){let o=0,a=0;for(let c=i,u=Math.min(i+3,e.length);c<u;c++)o|=e[c]<<(u-c-1)*Ed,a+=Ed;const l=Math.ceil(a/tu);o<<=l*tu-a;for(let c=1;c<=l;c++){const u=(l-c)*tu;s+=eh[(o&moe<<u)>>u]}s+="==".slice(0,4-l)}return s}function goe(t,e="utf-8"){return e==="base64"?A5(t):k5(t)}function _oe(t,e){return e==="base64"?kl.mutate(C5(t)):kl.mutate(Tu(t))}class kl extends Uint8Array{static fromString(e,r="utf-8"){switch(typeof e){case"string":return _oe(e,r);default:throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}}static mutate(e){return Object.setPrototypeOf(e,kl.prototype),e}transformToString(e="utf-8"){return goe(this,e)}}const Al=t=>encodeURIComponent(t).replace(/[!'()*]/g,yoe),yoe=t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`;function boe(t){const e=[];for(let r of Object.keys(t).sort()){const n=t[r];if(r=Al(r),Array.isArray(n))for(let s=0,i=n.length;s<i;s++)e.push(`${r}=${Al(n[s])}`);else{let s=r;(n||typeof n=="string")&&(s+=`=${Al(n)}`),e.push(s)}}return e.join("&")}function vI(t,e){return new Request(t,e)}function voe(t=0){return new Promise((e,r)=>{t&&setTimeout(()=>{const n=new Error(`Request did not complete within ${t} ms`);n.name="TimeoutError",r(n)},t)})}const Gv={supported:void 0};class CC{static create(e){return typeof e?.handle=="function"?e:new CC(e)}constructor(e){typeof e=="function"?this.configProvider=e().then(r=>r||{}):(this.config=e??{},this.configProvider=Promise.resolve(this.config)),Gv.supported===void 0&&(Gv.supported=typeof Request<"u"&&"keepalive"in vI("https://[::1]"))}destroy(){}async handle(e,{abortSignal:r}={}){this.config||(this.config=await this.configProvider);const n=this.config.requestTimeout,s=this.config.keepAlive===!0,i=this.config.credentials;if(r?.aborted){const p=new Error("Request aborted");return p.name="AbortError",Promise.reject(p)}let o=e.path;const a=boe(e.query||{});a&&(o+=`?${a}`),e.fragment&&(o+=`#${e.fragment}`);let l="";if(e.username!=null||e.password!=null){const p=e.username??"",y=e.password??"";l=`${p}:${y}@`}const{port:c,method:u}=e,h=`${e.protocol}//${l}${e.hostname}${c?`:${c}`:""}${o}`,d=u==="GET"||u==="HEAD"?void 0:e.body,f={body:d,headers:new Headers(e.headers),method:u,credentials:i};this.config?.cache&&(f.cache=this.config.cache),d&&(f.duplex="half"),typeof AbortController<"u"&&(f.signal=r),Gv.supported&&(f.keepalive=s),typeof this.config.requestInit=="function"&&Object.assign(f,this.config.requestInit(e));let g=()=>{};const _=vI(h,f),m=[fetch(_).then(p=>{const y=p.headers,b={};for(const w of y.entries())b[w[0]]=w[1];return p.body!=null?{response:new n_({headers:b,reason:p.statusText,statusCode:p.status,body:p.body})}:p.blob().then(w=>({response:new n_({headers:b,reason:p.statusText,statusCode:p.status,body:w})}))}),voe(n)];return r&&m.push(new Promise((p,y)=>{const b=()=>{const v=new Error("Request aborted");v.name="AbortError",y(v)};if(typeof r.addEventListener=="function"){const v=r;v.addEventListener("abort",b,{once:!0}),g=()=>v.removeEventListener("abort",b)}else r.onabort=b})),Promise.race(m).finally(g)}updateHttpClientConfig(e,r){this.config=void 0,this.configProvider=this.configProvider.then(n=>(n[e]=r,n))}httpHandlerConfigs(){return this.config??{}}}const woe=async t=>typeof Blob=="function"&&t instanceof Blob||t.constructor?.name==="Blob"?new Uint8Array(await t.arrayBuffer()):Eoe(t);async function Eoe(t){const e=[],r=t.getReader();let n=!1,s=0;for(;!n;){const{done:a,value:l}=await r.read();l&&(e.push(l),s+=l.length),n=a}const i=new Uint8Array(s);let o=0;for(const a of e)i.set(a,o),o+=a.length;return i}const R5={},XE={};for(let t=0;t<256;t++){let e=t.toString(16).toLowerCase();e.length===1&&(e=`0${e}`),R5[t]=e,XE[e]=t}function I5(t){if(t.length%2!==0)throw new Error("Hex encoded strings must have an even number length");const e=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2){const n=t.slice(r,r+2).toLowerCase();if(n in XE)e[r/2]=XE[n];else throw new Error(`Cannot decode unrecognized sequence ${n} as hexadecimal`)}return e}function Vn(t){let e="";for(let r=0;r<t.byteLength;r++)e+=R5[t[r]];return e}const P5=async(t=new Uint8Array,e)=>{if(t instanceof Uint8Array)return kl.mutate(t);if(!t)return kl.mutate(new Uint8Array);const r=e.streamCollector(t);return kl.mutate(await r)};function wI(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}const xoe=(t,e,r,n,s,i)=>{if(e!=null&&e[r]!==void 0){const o=n();if(o.length<=0)throw new Error("Empty value provided for input HTTP label: "+r+".");t=t.replace(s,i?o.split("/").map(a=>wI(a)).join("/"):wI(o))}else throw new Error("No value provided for input HTTP label: "+r+".");return t};function kC(t,e){return new Soe(t,e)}class Soe{constructor(e,r){this.input=e,this.context=r,this.query={},this.method="",this.headers={},this.path="",this.body=null,this.hostname="",this.resolvePathStack=[]}async build(){const{hostname:e,protocol:r="https",port:n,path:s}=await this.context.endpoint();this.path=s;for(const i of this.resolvePathStack)i(this.path);return new es({protocol:r,hostname:this.hostname||e,port:n,method:this.method,path:this.path,query:this.query,body:this.body,headers:this.headers})}hn(e){return this.hostname=e,this}bp(e){return this.resolvePathStack.push(r=>{this.path=`${r?.endsWith("/")?r.slice(0,-1):r||""}`+e}),this}p(e,r,n,s){return this.resolvePathStack.push(i=>{this.path=xoe(i,this.input,e,r,n,s)}),this}h(e){return this.headers=e,this}q(e){return this.query=e,this}b(e){return this.body=e,this}m(e){return this.method=e,this}}function Toe(t,e,r){t.__smithy_context?t.__smithy_context.features||(t.__smithy_context.features={}):t.__smithy_context={features:{}},t.__smithy_context.features[e]=r}class Coe{constructor(e){this.authSchemes=new Map;for(const[r,n]of Object.entries(e))n!==void 0&&this.authSchemes.set(r,n)}getIdentityProvider(e){return this.authSchemes.get(e)}}const koe=t=>e=>O5(e)&&e.expiration.getTime()-Date.now()<t,Aoe=3e5,Roe=koe(Aoe),O5=t=>t.expiration!==void 0,Ioe=(t,e,r)=>{if(t===void 0)return;const n=typeof t!="function"?async()=>Promise.resolve(t):t;let s,i,o,a=!1;const l=async c=>{i||(i=n(c));try{s=await i,o=!0,a=!1}finally{i=void 0}return s};return e===void 0?async c=>((!o||c?.forceRefresh)&&(s=await l(c)),s):async c=>((!o||c?.forceRefresh)&&(s=await l(c)),a?s:r(s)?(e(s)&&await l(c),s):(a=!0,s))},Poe=void 0;function Ooe(t){return t===void 0?!0:typeof t=="string"&&t.length<=50}function Doe(t){const e=rd(t.userAgentAppId??Poe);return{...t,customUserAgent:typeof t.customUserAgent=="string"?[[t.customUserAgent]]:t.customUserAgent,userAgentAppId:async()=>{const r=await e();if(!Ooe(r)){const n=t.logger?.constructor?.name==="NoOpLogger"||!t.logger?console:t.logger;typeof r!="string"?n?.warn("userAgentAppId must be a string or undefined."):r.length>50&&n?.warn("The provided userAgentAppId exceeds the maximum length of 50 characters.")}return r}}}class Loe{constructor({size:e,params:r}){this.data=new Map,this.parameters=[],this.capacity=e??50,r&&(this.parameters=r)}get(e,r){const n=this.hash(e);if(n===!1)return r();if(!this.data.has(n)){if(this.data.size>this.capacity+10){const s=this.data.keys();let i=0;for(;;){const{value:o,done:a}=s.next();if(this.data.delete(o),a||++i>10)break}}this.data.set(n,r())}return this.data.get(n)}size(){return this.data.size}hash(e){let r="";const{parameters:n}=this;if(n.length===0)return!1;for(const s of n){const i=String(e[s]??"");if(i.includes("|;"))return!1;r+=i+"|;"}return r}}const Noe=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),D5=t=>Noe.test(t)||t.startsWith("[")&&t.endsWith("]"),Moe=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),AC=(t,e=!1)=>{if(!e)return Moe.test(t);const r=t.split(".");for(const n of r)if(!AC(n))return!1;return!0},s_={},_f="endpoints";function Aa(t){return typeof t!="object"||t==null?t:"ref"in t?`$${Aa(t.ref)}`:"fn"in t?`${t.fn}(${(t.argv||[]).map(Aa).join(", ")})`:JSON.stringify(t,null,2)}class ts extends Error{constructor(e){super(e),this.name="EndpointError"}}const Boe=(t,e)=>t===e,Foe=t=>{const e=t.split("."),r=[];for(const n of e){const s=n.indexOf("[");if(s!==-1){if(n.indexOf("]")!==n.length-1)throw new ts(`Path: '${t}' does not end with ']'`);const i=n.slice(s+1,-1);if(Number.isNaN(parseInt(i)))throw new ts(`Invalid array index: '${i}' in path: '${t}'`);s!==0&&r.push(n.slice(0,s)),r.push(i)}else r.push(n)}return r},L5=(t,e)=>Foe(e).reduce((r,n)=>{if(typeof r!="object")throw new ts(`Index '${n}' in '${e}' not found in '${JSON.stringify(t)}'`);return Array.isArray(r)?r[parseInt(n)]:r[n]},t),joe=t=>t!=null,Uoe=t=>!t,Wv={[gf.HTTP]:80,[gf.HTTPS]:443},$oe=t=>{const e=(()=>{try{if(t instanceof URL)return t;if(typeof t=="object"&&"hostname"in t){const{hostname:d,port:f,protocol:g="",path:_="",query:m={}}=t,p=new URL(`${g}//${d}${f?`:${f}`:""}${_}`);return p.search=Object.entries(m).map(([y,b])=>`${y}=${b}`).join("&"),p}return new URL(t)}catch{return null}})();if(!e)return console.error(`Unable to parse ${JSON.stringify(t)} as a whatwg URL.`),null;const r=e.href,{host:n,hostname:s,pathname:i,protocol:o,search:a}=e;if(a)return null;const l=o.slice(0,-1);if(!Object.values(gf).includes(l))return null;const c=D5(s),u=r.includes(`${n}:${Wv[l]}`)||typeof t=="string"&&t.includes(`${n}:${Wv[l]}`),h=`${n}${u?`:${Wv[l]}`:""}`;return{scheme:l,authority:h,path:i,normalizedPath:i.endsWith("/")?i:`${i}/`,isIp:c}},Hoe=(t,e)=>t===e,zoe=(t,e,r,n)=>e>=r||t.length<r?null:n?t.substring(t.length-r,t.length-e):t.substring(e,r),Voe=t=>encodeURIComponent(t).replace(/[!*'()]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Goe={booleanEquals:Boe,getAttr:L5,isSet:joe,isValidHostLabel:AC,not:Uoe,parseURL:$oe,stringEquals:Hoe,substring:zoe,uriEncode:Voe},N5=(t,e)=>{const r=[],n={...e.endpointParams,...e.referenceRecord};let s=0;for(;s<t.length;){const i=t.indexOf("{",s);if(i===-1){r.push(t.slice(s));break}r.push(t.slice(s,i));const o=t.indexOf("}",i);if(o===-1){r.push(t.slice(i));break}t[i+1]==="{"&&t[o+1]==="}"&&(r.push(t.slice(i+1,o)),s=o+2);const a=t.substring(i+1,o);if(a.includes("#")){const[l,c]=a.split("#");r.push(L5(n[l],c))}else r.push(n[a]);s=o+1}return r.join("")},Woe=({ref:t},e)=>({...e.endpointParams,...e.referenceRecord})[t],Qy=(t,e,r)=>{if(typeof t=="string")return N5(t,r);if(t.fn)return M5(t,r);if(t.ref)return Woe(t,r);throw new ts(`'${e}': ${String(t)} is not a string, function or reference.`)},M5=({fn:t,argv:e},r)=>{const n=e.map(i=>["boolean","number"].includes(typeof i)?i:Qy(i,"arg",r)),s=t.split(".");return s[0]in s_&&s[1]!=null?s_[s[0]][s[1]](...n):Goe[t](...n)},qoe=({assign:t,...e},r)=>{if(t&&t in r.referenceRecord)throw new ts(`'${t}' is already defined in Reference Record.`);const n=M5(e,r);return r.logger?.debug?.(`${_f} evaluateCondition: ${Aa(e)} = ${Aa(n)}`),{result:n===""?!0:!!n,...t!=null&&{toAssign:{name:t,value:n}}}},RC=(t=[],e)=>{const r={};for(const n of t){const{result:s,toAssign:i}=qoe(n,{...e,referenceRecord:{...e.referenceRecord,...r}});if(!s)return{result:s};i&&(r[i.name]=i.value,e.logger?.debug?.(`${_f} assign: ${i.name} := ${Aa(i.value)}`))}return{result:!0,referenceRecord:r}},Koe=(t,e)=>Object.entries(t).reduce((r,[n,s])=>({...r,[n]:s.map(i=>{const o=Qy(i,"Header value entry",e);if(typeof o!="string")throw new ts(`Header '${n}' value '${o}' is not a string`);return o})}),{}),B5=(t,e)=>{if(Array.isArray(t))return t.map(r=>B5(r,e));switch(typeof t){case"string":return N5(t,e);case"object":if(t===null)throw new ts(`Unexpected endpoint property: ${t}`);return F5(t,e);case"boolean":return t;default:throw new ts(`Unexpected endpoint property type: ${typeof t}`)}},F5=(t,e)=>Object.entries(t).reduce((r,[n,s])=>({...r,[n]:B5(s,e)}),{}),Yoe=(t,e)=>{const r=Qy(t,"Endpoint URL",e);if(typeof r=="string")try{return new URL(r)}catch(n){throw console.error(`Failed to construct URL with ${r}`,n),n}throw new ts(`Endpoint URL must be a string, got ${typeof r}`)},Xoe=(t,e)=>{const{conditions:r,endpoint:n}=t,{result:s,referenceRecord:i}=RC(r,e);if(!s)return;const o={...e,referenceRecord:{...e.referenceRecord,...i}},{url:a,properties:l,headers:c}=n;return e.logger?.debug?.(`${_f} Resolving endpoint from template: ${Aa(n)}`),{...c!=null&&{headers:Koe(c,o)},...l!=null&&{properties:F5(l,o)},url:Yoe(a,o)}},Zoe=(t,e)=>{const{conditions:r,error:n}=t,{result:s,referenceRecord:i}=RC(r,e);if(s)throw new ts(Qy(n,"Error",{...e,referenceRecord:{...e.referenceRecord,...i}}))},Joe=(t,e)=>{const{conditions:r,rules:n}=t,{result:s,referenceRecord:i}=RC(r,e);if(s)return j5(n,{...e,referenceRecord:{...e.referenceRecord,...i}})},j5=(t,e)=>{for(const r of t)if(r.type==="endpoint"){const n=Xoe(r,e);if(n)return n}else if(r.type==="error")Zoe(r,e);else if(r.type==="tree"){const n=Joe(r,e);if(n)return n}else throw new ts(`Unknown endpoint rule: ${r}`);throw new ts("Rules evaluation failed")},Qoe=(t,e)=>{const{endpointParams:r,logger:n}=e,{parameters:s,rules:i}=t;e.logger?.debug?.(`${_f} Initial EndpointParams: ${Aa(r)}`);const o=Object.entries(s).filter(([,c])=>c.default!=null).map(([c,u])=>[c,u.default]);if(o.length>0)for(const[c,u]of o)r[c]=r[c]??u;const a=Object.entries(s).filter(([,c])=>c.required).map(([c])=>c);for(const c of a)if(r[c]==null)throw new ts(`Missing required parameter: '${c}'`);const l=j5(i,{endpointParams:r,logger:n,referenceRecord:{}});return e.logger?.debug?.(`${_f} Resolved endpoint: ${Aa(l)}`),l},U5=(t,e=!1)=>{if(e){for(const r of t.split("."))if(!U5(r))return!1;return!0}return!(!AC(t)||t.length<3||t.length>63||t!==t.toLowerCase()||D5(t))},EI=":",eae="/",tae=t=>{const e=t.split(EI);if(e.length<6)return null;const[r,n,s,i,o,...a]=e;if(r!=="arn"||n===""||s===""||a.join(EI)==="")return null;const l=a.map(c=>c.split(eae)).flat();return{partition:n,service:s,region:i,accountId:o,resourceId:l}},rae=[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"cloud.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"csp.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{}}],nae="1.1",sae={partitions:rae,version:nae};let iae=sae;const oae=t=>{const{partitions:e}=iae;for(const n of e){const{regions:s,outputs:i}=n;for(const[o,a]of Object.entries(s))if(o===t)return{...i,...a}}for(const n of e){const{regionRegex:s,outputs:i}=n;if(new RegExp(s).test(t))return{...i}}const r=e.find(n=>n.id==="aws");if(!r)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...r.outputs}},$5={isVirtualHostableS3Bucket:U5,parseArn:tae,partition:oae};s_.aws=$5;function aae(t,e,r){return t.$source||(t.$source={}),t.$source[e]=r,t}function Qs(t,e,r){t.__aws_sdk_context?t.__aws_sdk_context.features||(t.__aws_sdk_context.features={}):t.__aws_sdk_context={features:{}},t.__aws_sdk_context.features[e]=r}const xI=t=>n_.isInstance(t)?t.headers?.date??t.headers?.Date:void 0,H5=t=>new Date(Date.now()+t),lae=(t,e)=>Math.abs(H5(e).getTime()-t)>=3e5,SI=(t,e)=>{const r=Date.parse(t);return lae(r,e)?r-Date.now():e},Sd=(t,e)=>{if(!e)throw new Error(`Property \`${t}\` is not resolved for AWS SDK SigV4Auth`);return e},cae=async t=>{const e=Sd("context",t.context),r=Sd("config",t.config),n=e.endpointV2?.properties?.authSchemes?.[0],i=await Sd("signer",r.signer)(n),o=t?.signingRegion,a=t?.signingRegionSet,l=t?.signingName;return{config:r,signer:i,signingRegion:o,signingRegionSet:a,signingName:l}};class uae{async sign(e,r,n){if(!es.isInstance(e))throw new Error("The request is not an instance of `HttpRequest` and cannot be signed");const s=await cae(n),{config:i,signer:o}=s;let{signingRegion:a,signingName:l}=s;const c=n.context;if(c?.authSchemes?.length??!1){const[h,d]=c.authSchemes;h?.name==="sigv4a"&&d?.name==="sigv4"&&(a=d?.signingRegion??a,l=d?.signingName??l)}return await o.sign(e,{signingDate:H5(i.systemClockOffset),signingRegion:a,signingService:l})}errorHandler(e){return r=>{const n=r.ServerTime??xI(r.$response);if(n){const s=Sd("config",e.config),i=s.systemClockOffset;s.systemClockOffset=SI(n,s.systemClockOffset),s.systemClockOffset!==i&&r.$metadata&&(r.$metadata.clockSkewCorrected=!0)}throw r}}successHandler(e,r){const n=xI(e);if(n){const s=Sd("config",r.config);s.systemClockOffset=SI(n,s.systemClockOffset)}}}const hae=(t,e,r)=>{let n,s,i,o=!1;const a=async()=>{s||(s=t());try{n=await s,i=!0,o=!1}finally{s=void 0}return n};return async l=>((!i||l?.forceRefresh)&&(n=await a()),n)},dae="X-Amz-Algorithm",fae="X-Amz-Credential",z5="X-Amz-Date",pae="X-Amz-SignedHeaders",mae="X-Amz-Expires",V5="X-Amz-Signature",G5="X-Amz-Security-Token",W5="authorization",q5=z5.toLowerCase(),gae="date",_ae=[W5,q5,gae],yae=V5.toLowerCase(),ZE="x-amz-content-sha256",bae=G5.toLowerCase(),vae={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},wae=/^proxy-/,Eae=/^sec-/,qv="AWS4-HMAC-SHA256",xae="AWS4-HMAC-SHA256-PAYLOAD",Sae="UNSIGNED-PAYLOAD",Tae=50,K5="aws4_request",Cae=60*60*24*7,jm={},Kv=[],Yv=(t,e,r)=>`${t}/${e}/${r}/${K5}`,kae=async(t,e,r,n,s)=>{const i=await TI(t,e.secretAccessKey,e.accessKeyId),o=`${r}:${n}:${s}:${Vn(i)}:${e.sessionToken}`;if(o in jm)return jm[o];for(Kv.push(o);Kv.length>Tae;)delete jm[Kv.shift()];let a=`AWS4${e.secretAccessKey}`;for(const l of[r,n,s,K5])a=await TI(t,a,l);return jm[o]=a},TI=(t,e,r)=>{const n=new t(e);return n.update(xd(r)),n.digest()},CI=({headers:t},e,r)=>{const n={};for(const s of Object.keys(t).sort()){if(t[s]==null)continue;const i=s.toLowerCase();(i in vae||e?.has(i)||wae.test(i)||Eae.test(i))&&(!r||r&&!r.has(i))||(n[i]=t[s].trim().replace(/\s+/g," "))}return n},Aae=({query:t={}})=>{const e=[],r={};for(const n of Object.keys(t)){if(n.toLowerCase()===yae)continue;const s=Al(n);e.push(s);const i=t[n];typeof i=="string"?r[s]=`${s}=${Al(i)}`:Array.isArray(i)&&(r[s]=i.slice(0).reduce((o,a)=>o.concat([`${s}=${Al(a)}`]),[]).sort().join("&"))}return e.sort().map(n=>r[n]).filter(n=>n).join("&")},Rae=t=>typeof ArrayBuffer=="function"&&t instanceof ArrayBuffer||Object.prototype.toString.call(t)==="[object ArrayBuffer]",Xv=async({headers:t,body:e},r)=>{for(const n of Object.keys(t))if(n.toLowerCase()===ZE)return t[n];if(e==null)return"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855";if(typeof e=="string"||ArrayBuffer.isView(e)||Rae(e)){const n=new r;return n.update(xd(e)),Vn(await n.digest())}return Sae};class Iae{format(e){const r=[];for(const i of Object.keys(e)){const o=Tu(i);r.push(Uint8Array.from([o.byteLength]),o,this.formatHeaderValue(e[i]))}const n=new Uint8Array(r.reduce((i,o)=>i+o.byteLength,0));let s=0;for(const i of r)n.set(i,s),s+=i.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const r=new DataView(new ArrayBuffer(3));return r.setUint8(0,3),r.setInt16(1,e.value,!1),new Uint8Array(r.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(i.buffer);return o.set(e.value,3),o;case"string":const a=Tu(e.value),l=new DataView(new ArrayBuffer(3+a.byteLength));l.setUint8(0,7),l.setUint16(1,a.byteLength,!1);const c=new Uint8Array(l.buffer);return c.set(a,3),c;case"timestamp":const u=new Uint8Array(9);return u[0]=8,u.set(Oae.fromNumber(e.value.valueOf()).bytes,1),u;case"uuid":if(!Pae.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const h=new Uint8Array(17);return h[0]=9,h.set(I5(e.value.replace(/\-/g,"")),1),h}}}var kI;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(kI||(kI={}));const Pae=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;let Oae=class Y5{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const r=new Uint8Array(8);for(let n=7,s=Math.abs(Math.round(e));n>-1&&s>0;n--,s/=256)r[n]=s;return e<0&&AI(r),new Y5(r)}valueOf(){const e=this.bytes.slice(0),r=e[0]&128;return r&&AI(e),parseInt(Vn(e),16)*(r?-1:1)}toString(){return String(this.valueOf())}};function AI(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}const Dae=(t,e)=>{t=t.toLowerCase();for(const r of Object.keys(e))if(t===r.toLowerCase())return!0;return!1},Lae=(t,e={})=>{const{headers:r,query:n={}}=es.clone(t);for(const s of Object.keys(r)){const i=s.toLowerCase();(i.slice(0,6)==="x-amz-"&&!e.unhoistableHeaders?.has(i)||e.hoistableHeaders?.has(i))&&(n[s]=r[s],delete r[s])}return{...t,headers:r,query:n}},RI=t=>{t=es.clone(t);for(const e of Object.keys(t.headers))_ae.indexOf(e.toLowerCase())>-1&&delete t.headers[e];return t},Nae=t=>Mae(t).toISOString().replace(/\.\d{3}Z$/,"Z"),Mae=t=>typeof t=="number"?new Date(t*1e3):typeof t=="string"?Number(t)?new Date(Number(t)*1e3):new Date(t):t;class II{constructor({applyChecksum:e,credentials:r,region:n,service:s,sha256:i,uriEscapePath:o=!0}){this.headerFormatter=new Iae,this.service=s,this.sha256=i,this.uriEscapePath=o,this.applyChecksum=typeof e=="boolean"?e:!0,this.regionProvider=_a(n),this.credentialProvider=_a(r)}async presign(e,r={}){const{signingDate:n=new Date,expiresIn:s=3600,unsignableHeaders:i,unhoistableHeaders:o,signableHeaders:a,hoistableHeaders:l,signingRegion:c,signingService:u}=r,h=await this.credentialProvider();this.validateResolvedCredentials(h);const d=c??await this.regionProvider(),{longDate:f,shortDate:g}=Um(n);if(s>Cae)return Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future");const _=Yv(g,d,u??this.service),m=Lae(RI(e),{unhoistableHeaders:o,hoistableHeaders:l});h.sessionToken&&(m.query[G5]=h.sessionToken),m.query[dae]=qv,m.query[fae]=`${h.accessKeyId}/${_}`,m.query[z5]=f,m.query[mae]=s.toString(10);const p=CI(m,i,a);return m.query[pae]=PI(p),m.query[V5]=await this.getSignature(f,_,this.getSigningKey(h,d,g,u),this.createCanonicalRequest(m,p,await Xv(e,this.sha256))),m}async sign(e,r){return typeof e=="string"?this.signString(e,r):e.headers&&e.payload?this.signEvent(e,r):e.message?this.signMessage(e,r):this.signRequest(e,r)}async signEvent({headers:e,payload:r},{signingDate:n=new Date,priorSignature:s,signingRegion:i,signingService:o}){const a=i??await this.regionProvider(),{shortDate:l,longDate:c}=Um(n),u=Yv(l,a,o??this.service),h=await Xv({headers:{},body:r},this.sha256),d=new this.sha256;d.update(e);const f=Vn(await d.digest()),g=[xae,c,u,s,f,h].join(`
`);return this.signString(g,{signingDate:n,signingRegion:a,signingService:o})}async signMessage(e,{signingDate:r=new Date,signingRegion:n,signingService:s}){return this.signEvent({headers:this.headerFormatter.format(e.message.headers),payload:e.message.body},{signingDate:r,signingRegion:n,signingService:s,priorSignature:e.priorSignature}).then(o=>({message:e.message,signature:o}))}async signString(e,{signingDate:r=new Date,signingRegion:n,signingService:s}={}){const i=await this.credentialProvider();this.validateResolvedCredentials(i);const o=n??await this.regionProvider(),{shortDate:a}=Um(r),l=new this.sha256(await this.getSigningKey(i,o,a,s));return l.update(xd(e)),Vn(await l.digest())}async signRequest(e,{signingDate:r=new Date,signableHeaders:n,unsignableHeaders:s,signingRegion:i,signingService:o}={}){const a=await this.credentialProvider();this.validateResolvedCredentials(a);const l=i??await this.regionProvider(),c=RI(e),{longDate:u,shortDate:h}=Um(r),d=Yv(h,l,o??this.service);c.headers[q5]=u,a.sessionToken&&(c.headers[bae]=a.sessionToken);const f=await Xv(c,this.sha256);!Dae(ZE,c.headers)&&this.applyChecksum&&(c.headers[ZE]=f);const g=CI(c,s,n),_=await this.getSignature(u,d,this.getSigningKey(a,l,h,o),this.createCanonicalRequest(c,g,f));return c.headers[W5]=`${qv} Credential=${a.accessKeyId}/${d}, SignedHeaders=${PI(g)}, Signature=${_}`,c}createCanonicalRequest(e,r,n){const s=Object.keys(r).sort();return`${e.method}
${this.getCanonicalPath(e)}
${Aae(e)}
${s.map(i=>`${i}:${r[i]}`).join(`
`)}

${s.join(";")}
${n}`}async createStringToSign(e,r,n){const s=new this.sha256;s.update(xd(n));const i=await s.digest();return`${qv}
${e}
${r}
${Vn(i)}`}getCanonicalPath({path:e}){if(this.uriEscapePath){const r=[];for(const i of e.split("/"))i?.length!==0&&i!=="."&&(i===".."?r.pop():r.push(i));const n=`${e?.startsWith("/")?"/":""}${r.join("/")}${r.length>0&&e?.endsWith("/")?"/":""}`;return Al(n).replace(/%2F/g,"/")}return e}async getSignature(e,r,n,s){const i=await this.createStringToSign(e,r,s),o=new this.sha256(await n);return o.update(xd(i)),Vn(await o.digest())}getSigningKey(e,r,n,s){return kae(this.sha256,e,n,r,s||this.service)}validateResolvedCredentials(e){if(typeof e!="object"||typeof e.accessKeyId!="string"||typeof e.secretAccessKey!="string")throw new Error("Resolved credential object is not valid")}}const Um=t=>{const e=Nae(t).replace(/[\-:]/g,"");return{longDate:e,shortDate:e.slice(0,8)}},PI=t=>Object.keys(t).sort().join(";"),Bae=t=>{let e=!1,r;t.credentials&&(e=!0,r=Ioe(t.credentials,Roe,O5)),r||(t.credentialDefaultProvider?r=rd(t.credentialDefaultProvider(Object.assign({},t,{parentClientConfig:t}))):r=async()=>{throw new Error("`credentials` is missing")});const n=async()=>r({callerClientConfig:t}),{signingEscapePath:s=!0,systemClockOffset:i=t.systemClockOffset||0,sha256:o}=t;let a;return t.signer?a=rd(t.signer):t.regionInfoProvider?a=()=>rd(t.region)().then(async l=>[await t.regionInfoProvider(l,{useFipsEndpoint:await t.useFipsEndpoint(),useDualstackEndpoint:await t.useDualstackEndpoint()})||{},l]).then(([l,c])=>{const{signingRegion:u,signingService:h}=l;t.signingRegion=t.signingRegion||u||c,t.signingName=t.signingName||h||t.serviceId;const d={...t,credentials:n,region:t.signingRegion,service:t.signingName,sha256:o,uriEscapePath:s},f=t.signerConstructor||II;return new f(d)}):a=async l=>{l=Object.assign({},{name:"sigv4",signingName:t.signingName||t.defaultSigningName,signingRegion:await rd(t.region)(),properties:{}},l);const c=l.signingRegion,u=l.signingName;t.signingRegion=t.signingRegion||c,t.signingName=t.signingName||u||t.serviceId;const h={...t,credentials:n,region:t.signingRegion,service:t.signingName,sha256:o,uriEscapePath:s},d=t.signerConstructor||II;return new d(h)},{...t,systemClockOffset:i,signingEscapePath:s,credentials:e?async()=>n().then(l=>aae(l,"CREDENTIALS_CODE","e")):n,signer:a}},qa=(t,e)=>{const r=[];if(t&&r.push(t),e)for(const n of e)r.push(n);return r},Bo=(t,e)=>`${t||"anonymous"}${e&&e.length>0?` (a.k.a. ${e.join(",")})`:""}`,i_=()=>{let t=[],e=[],r=!1;const n=new Set,s=h=>h.sort((d,f)=>OI[f.step]-OI[d.step]||DI[f.priority||"normal"]-DI[d.priority||"normal"]),i=h=>{let d=!1;const f=g=>{const _=qa(g.name,g.aliases);if(_.includes(h)){d=!0;for(const m of _)n.delete(m);return!1}return!0};return t=t.filter(f),e=e.filter(f),d},o=h=>{let d=!1;const f=g=>{if(g.middleware===h){d=!0;for(const _ of qa(g.name,g.aliases))n.delete(_);return!1}return!0};return t=t.filter(f),e=e.filter(f),d},a=h=>(t.forEach(d=>{h.add(d.middleware,{...d})}),e.forEach(d=>{h.addRelativeTo(d.middleware,{...d})}),h.identifyOnResolve?.(u.identifyOnResolve()),h),l=h=>{const d=[];return h.before.forEach(f=>{f.before.length===0&&f.after.length===0?d.push(f):d.push(...l(f))}),d.push(h),h.after.reverse().forEach(f=>{f.before.length===0&&f.after.length===0?d.push(f):d.push(...l(f))}),d},c=(h=!1)=>{const d=[],f=[],g={};return t.forEach(m=>{const p={...m,before:[],after:[]};for(const y of qa(p.name,p.aliases))g[y]=p;d.push(p)}),e.forEach(m=>{const p={...m,before:[],after:[]};for(const y of qa(p.name,p.aliases))g[y]=p;f.push(p)}),f.forEach(m=>{if(m.toMiddleware){const p=g[m.toMiddleware];if(p===void 0){if(h)return;throw new Error(`${m.toMiddleware} is not found when adding ${Bo(m.name,m.aliases)} middleware ${m.relation} ${m.toMiddleware}`)}m.relation==="after"&&p.after.push(m),m.relation==="before"&&p.before.push(m)}}),s(d).map(l).reduce((m,p)=>(m.push(...p),m),[])},u={add:(h,d={})=>{const{name:f,override:g,aliases:_}=d,m={step:"initialize",priority:"normal",middleware:h,...d},p=qa(f,_);if(p.length>0){if(p.some(y=>n.has(y))){if(!g)throw new Error(`Duplicate middleware name '${Bo(f,_)}'`);for(const y of p){const b=t.findIndex(w=>w.name===y||w.aliases?.some(E=>E===y));if(b===-1)continue;const v=t[b];if(v.step!==m.step||m.priority!==v.priority)throw new Error(`"${Bo(v.name,v.aliases)}" middleware with ${v.priority} priority in ${v.step} step cannot be overridden by "${Bo(f,_)}" middleware with ${m.priority} priority in ${m.step} step.`);t.splice(b,1)}}for(const y of p)n.add(y)}t.push(m)},addRelativeTo:(h,d)=>{const{name:f,override:g,aliases:_}=d,m={middleware:h,...d},p=qa(f,_);if(p.length>0){if(p.some(y=>n.has(y))){if(!g)throw new Error(`Duplicate middleware name '${Bo(f,_)}'`);for(const y of p){const b=e.findIndex(w=>w.name===y||w.aliases?.some(E=>E===y));if(b===-1)continue;const v=e[b];if(v.toMiddleware!==m.toMiddleware||v.relation!==m.relation)throw new Error(`"${Bo(v.name,v.aliases)}" middleware ${v.relation} "${v.toMiddleware}" middleware cannot be overridden by "${Bo(f,_)}" middleware ${m.relation} "${m.toMiddleware}" middleware.`);e.splice(b,1)}}for(const y of p)n.add(y)}e.push(m)},clone:()=>a(i_()),use:h=>{h.applyToStack(u)},remove:h=>typeof h=="string"?i(h):o(h),removeByTag:h=>{let d=!1;const f=g=>{const{tags:_,name:m,aliases:p}=g;if(_&&_.includes(h)){const y=qa(m,p);for(const b of y)n.delete(b);return d=!0,!1}return!0};return t=t.filter(f),e=e.filter(f),d},concat:h=>{const d=a(i_());return d.use(h),d.identifyOnResolve(r||d.identifyOnResolve()||(h.identifyOnResolve?.()??!1)),d},applyToStack:a,identify:()=>c(!0).map(h=>{const d=h.step??h.relation+" "+h.toMiddleware;return Bo(h.name,h.aliases)+" - "+d}),identifyOnResolve(h){return typeof h=="boolean"&&(r=h),r},resolve:(h,d)=>{for(const f of c().map(g=>g.middleware).reverse())h=f(h,d);return r&&console.log(u.identify()),h}};return u},OI={initialize:5,serialize:4,build:3,finalizeRequest:2,deserialize:1},DI={high:3,normal:2,low:1};class Fae{constructor(e){this.config=e,this.middlewareStack=i_()}send(e,r,n){const s=typeof r!="function"?r:void 0,i=typeof r=="function"?r:n,o=s===void 0&&this.config.cacheMiddleware===!0;let a;if(o){this.handlers||(this.handlers=new WeakMap);const l=this.handlers;l.has(e.constructor)?a=l.get(e.constructor):(a=e.resolveMiddleware(this.middlewareStack,this.config,s),l.set(e.constructor,a))}else delete this.handlers,a=e.resolveMiddleware(this.middlewareStack,this.config,s);if(i)a(e).then(l=>i(null,l.output),l=>i(l)).catch(()=>{});else return a(e).then(l=>l.output)}destroy(){this.config?.requestHandler?.destroy?.(),delete this.handlers}}class eb{constructor(){this.middlewareStack=i_()}static classBuilder(){return new jae}resolveMiddlewareWithContext(e,r,n,{middlewareFn:s,clientName:i,commandName:o,inputFilterSensitiveLog:a,outputFilterSensitiveLog:l,smithyContext:c,additionalContext:u,CommandCtor:h}){for(const m of s.bind(this)(h,e,r,n))this.middlewareStack.use(m);const d=e.concat(this.middlewareStack),{logger:f}=r,g={logger:f,clientName:i,commandName:o,inputFilterSensitiveLog:a,outputFilterSensitiveLog:l,[YE]:{commandInstance:this,...c},...u},{requestHandler:_}=r;return d.resolve(m=>_.handle(m.request,n||{}),g)}}class jae{constructor(){this._init=()=>{},this._ep={},this._middlewareFn=()=>[],this._commandName="",this._clientName="",this._additionalContext={},this._smithyContext={},this._inputFilterSensitiveLog=e=>e,this._outputFilterSensitiveLog=e=>e,this._serializer=null,this._deserializer=null}init(e){this._init=e}ep(e){return this._ep=e,this}m(e){return this._middlewareFn=e,this}s(e,r,n={}){return this._smithyContext={service:e,operation:r,...n},this}c(e={}){return this._additionalContext=e,this}n(e,r){return this._clientName=e,this._commandName=r,this}f(e=n=>n,r=n=>n){return this._inputFilterSensitiveLog=e,this._outputFilterSensitiveLog=r,this}ser(e){return this._serializer=e,this}de(e){return this._deserializer=e,this}build(){const e=this;let r;return r=class extends eb{static getEndpointParameterInstructions(){return e._ep}constructor(...[n]){super(),this.serialize=e._serializer,this.deserialize=e._deserializer,this.input=n??{},e._init(this)}resolveMiddleware(n,s,i){return this.resolveMiddlewareWithContext(n,s,i,{CommandCtor:r,middlewareFn:e._middlewareFn,clientName:e._clientName,commandName:e._commandName,inputFilterSensitiveLog:e._inputFilterSensitiveLog,outputFilterSensitiveLog:e._outputFilterSensitiveLog,smithyContext:e._smithyContext,additionalContext:e._additionalContext})}}}}const jl="***SensitiveInformation***",Uae=t=>{if(t!=null){if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return String(e)!==String(t)&&Q5.warn(J5(`Expected number but observed string: ${t}`)),e}if(typeof t=="number")return t;throw new TypeError(`Expected number, got ${typeof t}: ${t}`)}},$ae=t=>{if(t!=null){if(Number.isInteger(t)&&!Number.isNaN(t))return t;throw new TypeError(`Expected integer, got ${typeof t}: ${t}`)}},X5=t=>Hae(t,32),Hae=(t,e)=>{const r=$ae(t);if(r!==void 0&&zae(r,e)!==r)throw new TypeError(`Expected ${e}-bit integer, got ${t}`);return r},zae=(t,e)=>{switch(e){case 32:return Int32Array.of(t)[0];case 16:return Int16Array.of(t)[0];case 8:return Int8Array.of(t)[0]}},Vae=(t,e)=>{if(t==null)throw new TypeError(`Expected a non-null value for ${e}`);return t},Z5=t=>{if(t==null)return;if(typeof t=="object"&&!Array.isArray(t))return t;const e=Array.isArray(t)?"array":typeof t;throw new TypeError(`Expected object, got ${e}: ${t}`)},At=t=>{if(t!=null){if(typeof t=="string")return t;if(["boolean","number","bigint"].includes(typeof t))return Q5.warn(J5(`Expected string, got ${typeof t}: ${t}`)),String(t);throw new TypeError(`Expected string, got ${typeof t}: ${t}`)}},Gae=t=>{if(t==null)return;const e=Z5(t),r=Object.entries(e).filter(([,n])=>n!=null).map(([n])=>n);if(r.length===0)throw new TypeError("Unions must have exactly one non-null member. None were found.");if(r.length>1)throw new TypeError(`Unions must have exactly one non-null member. Keys ${r} were not null.`);return e},LI=t=>typeof t=="string"?Wae(t):Uae(t),Wae=t=>{switch(t){case"NaN":return NaN;case"Infinity":return 1/0;case"-Infinity":return-1/0;default:throw new Error(`Unable to parse float value: ${t}`)}},J5=t=>String(new TypeError(t).stack||t).split(`
`).slice(0,5).filter(e=>!e.includes("stackTraceWarning")).join(`
`),Q5={warn:console.warn};class IC extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,IC.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}}const ns=(t,e={})=>{Object.entries(e).filter(([,n])=>n!==void 0).forEach(([n,s])=>{(t[n]==null||t[n]==="")&&(t[n]=s)});const r=t.message||t.Message||"UnknownError";return t.message=r,delete t.Message,t},qae=({output:t,parsedBody:e,exceptionCtor:r,errorCode:n})=>{const s=Yae(t),i=s.httpStatusCode?s.httpStatusCode+"":void 0,o=new r({name:e?.code||e?.Code||n||i||"UnknownError",$fault:"client",$metadata:s});throw ns(o,e)},Kae=t=>({output:e,parsedBody:r,errorCode:n})=>{qae({output:e,parsedBody:r,exceptionCtor:t,errorCode:n})},Yae=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),Xae=t=>{switch(t){case"standard":return{retryMode:"standard",connectionTimeout:3100};case"in-region":return{retryMode:"standard",connectionTimeout:1100};case"cross-region":return{retryMode:"standard",connectionTimeout:3100};case"mobile":return{retryMode:"standard",connectionTimeout:3e4};default:return{}}},Zae=t=>{const e=[];for(const r in r_){const n=r_[r];t[n]!==void 0&&e.push({algorithmId:()=>n,checksumConstructor:()=>t[n]})}return{_checksumAlgorithms:e,addChecksumAlgorithm(r){this._checksumAlgorithms.push(r)},checksumAlgorithms(){return this._checksumAlgorithms}}},Jae=t=>{const e={};return t.checksumAlgorithms().forEach(r=>{e[r.algorithmId()]=r.checksumConstructor()}),e},Qae=t=>{let e=t.retryStrategy;return{setRetryStrategy(r){e=r},retryStrategy(){return e}}},ele=t=>{const e={};return e.retryStrategy=t.retryStrategy(),e},tle=t=>({...Zae(t),...Qae(t)}),rle=t=>({...Jae(t),...ele(t)}),nle=t=>t!=null;class e8{trace(){}debug(){}info(){}warn(){}error(){}}function Vr(t,e,r){let n,s,i;if(typeof e>"u"&&typeof r>"u")n={},i=t;else{if(n=t,typeof e=="function")return s=e,i=r,sle(n,s,i);i=e}for(const o of Object.keys(i)){if(!Array.isArray(i[o])){n[o]=i[o];continue}t8(n,null,i,o)}return n}const ut=(t,e)=>{const r={};for(const n in e)t8(r,t,e,n);return r},sle=(t,e,r)=>Vr(t,Object.entries(r).reduce((n,[s,i])=>(Array.isArray(i)?n[s]=i:typeof i=="function"?n[s]=[e,i()]:n[s]=[e,i],n),{})),t8=(t,e,r,n)=>{if(e!==null){let o=r[n];typeof o=="function"&&(o=[,o]);const[a=ile,l=ole,c=n]=o;(typeof a=="function"&&a(e[c])||typeof a!="function"&&a)&&(t[n]=l(e[c]));return}let[s,i]=r[n];if(typeof i=="function"){let o;const a=s===void 0&&(o=i())!=null,l=typeof s=="function"&&!!s(void 0)||typeof s!="function"&&!!s;a?t[n]=o:l&&(t[n]=i())}else{const o=s===void 0&&i!=null,a=typeof s=="function"&&!!s(i)||typeof s!="function"&&!!s;(o||a)&&(t[n]=i)}},ile=t=>t!=null,ole=t=>t,NI=t=>{if(t!==t)return"NaN";switch(t){case 1/0:return"Infinity";case-1/0:return"-Infinity";default:return t}},gt=t=>{if(t==null)return{};if(Array.isArray(t))return t.filter(e=>e!=null).map(gt);if(typeof t=="object"){const e={};for(const r of Object.keys(t))t[r]!=null&&(e[r]=gt(t[r]));return e}return t},$a=t=>{if(t!=null)return typeof t=="object"&&"__type"in t&&delete t.__type,Gae(t)},ale=(t,e)=>P5(t,e).then(r=>e.utf8Encoder(r)),ss=(t,e)=>ale(t,e).then(r=>{if(r.length)try{return JSON.parse(r)}catch(n){throw n?.name==="SyntaxError"&&Object.defineProperty(n,"$responseBodyText",{value:r}),n}return{}}),lle=async(t,e)=>{const r=await ss(t,e);return r.message=r.message??r.Message,r},cle=(t,e)=>{const r=(i,o)=>Object.keys(i).find(a=>a.toLowerCase()===o.toLowerCase()),n=i=>{let o=i;return typeof o=="number"&&(o=o.toString()),o.indexOf(",")>=0&&(o=o.split(",")[0]),o.indexOf(":")>=0&&(o=o.split(":")[0]),o.indexOf("#")>=0&&(o=o.split("#")[1]),o},s=r(t.headers,"x-amzn-errortype");if(s!==void 0)return n(t.headers[s]);if(e.code!==void 0)return n(e.code);if(e.__type!==void 0)return n(e.__type)},ule=/\d{12}\.ddb/;async function hle(t,e,r){if(r.request?.headers?.["smithy-protocol"]==="rpc-v2-cbor"&&Qs(t,"PROTOCOL_RPC_V2_CBOR","M"),typeof e.retryStrategy=="function"){const i=await e.retryStrategy();typeof i.acquireInitialRetryToken=="function"?i.constructor?.name?.includes("Adaptive")?Qs(t,"RETRY_MODE_ADAPTIVE","F"):Qs(t,"RETRY_MODE_STANDARD","E"):Qs(t,"RETRY_MODE_LEGACY","D")}if(typeof e.accountIdEndpointMode=="function"){const i=t.endpointV2;switch(String(i?.url?.hostname).match(ule)&&Qs(t,"ACCOUNT_ID_ENDPOINT","O"),await e.accountIdEndpointMode?.()){case"disabled":Qs(t,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":Qs(t,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":Qs(t,"ACCOUNT_ID_MODE_REQUIRED","R");break}}const s=t.__smithy_context?.selectedHttpAuthScheme?.identity;if(s?.$source){const i=s;i.accountId&&Qs(t,"RESOLVED_ACCOUNT_ID","T");for(const[o,a]of Object.entries(i.$source??{}))Qs(t,o,a)}}const MI="user-agent",Zv="x-amz-user-agent",BI=" ",Jv="/",dle=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,fle=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,FI="-",ple=1024;function mle(t){let e="";for(const r in t){const n=t[r];if(e.length+n.length+1<=ple){e.length?e+=","+n:e+=n;continue}break}return e}const gle=t=>(e,r)=>async n=>{const{request:s}=n;if(!es.isInstance(s))return e(n);const{headers:i}=s,o=r?.userAgent?.map($m)||[],a=(await t.defaultUserAgentProvider()).map($m);await hle(r,t,n);const l=r;a.push(`m/${mle(Object.assign({},r.__smithy_context?.features,l.__aws_sdk_context?.features))}`);const c=t?.customUserAgent?.map($m)||[],u=await t.userAgentAppId();u&&a.push($m([`app/${u}`]));const h=[].concat([...a,...o,...c]).join(BI),d=[...a.filter(f=>f.startsWith("aws-sdk-")),...c].join(BI);return t.runtime!=="browser"?(d&&(i[Zv]=i[Zv]?`${i[MI]} ${d}`:d),i[MI]=h):i[Zv]=h,e({...n,request:s})},$m=t=>{const e=t[0].split(Jv).map(o=>o.replace(dle,FI)).join(Jv),r=t[1]?.replace(fle,FI),n=e.indexOf(Jv),s=e.substring(0,n);let i=e.substring(n+1);return s==="api"&&(i=i.toLowerCase()),[s,i,r].filter(o=>o&&o.length>0).reduce((o,a,l)=>{switch(l){case 0:return a;case 1:return`${o}/${a}`;default:return`${o}#${a}`}},"")},_le={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},yle=t=>({applyToStack:e=>{e.add(gle(t),_le)}});var jI;(function(t){t.ENV="env",t.CONFIG="shared config entry"})(jI||(jI={}));const ble=!1,vle=!1,r8=t=>typeof t=="string"&&(t.startsWith("fips-")||t.endsWith("-fips")),UI=t=>r8(t)?["fips-aws-global","aws-fips"].includes(t)?"us-east-1":t.replace(/fips-(dkr-|prod-)?|-fips/,""):t,wle=t=>{const{region:e,useFipsEndpoint:r}=t;if(!e)throw new Error("Region is missing");return{...t,region:async()=>{if(typeof e=="string")return UI(e);const n=await e();return UI(n)},useFipsEndpoint:async()=>{const n=typeof e=="string"?e:await e();return r8(n)?!0:typeof r!="function"?Promise.resolve(!!r):r()}}},Ele=t=>({...t,eventStreamMarshaller:t.eventStreamSerdeProvider(t)}),$I="content-length";function xle(t){return e=>async r=>{const n=r.request;if(es.isInstance(n)){const{body:s,headers:i}=n;if(s&&Object.keys(i).map(o=>o.toLowerCase()).indexOf($I)===-1)try{const o=t(s);n.headers={...n.headers,[$I]:String(o)}}catch{}}return e({...r,request:n})}}const Sle={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},Tle=t=>({applyToStack:e=>{e.add(xle(t.bodyLengthChecker),Sle)}}),Cle=async t=>{const e=t?.Bucket||"";if(typeof t.Bucket=="string"&&(t.Bucket=e.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"))),Ple(e)){if(t.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else(!Ile(e)||e.indexOf(".")!==-1&&!String(t.Endpoint).startsWith("http:")||e.toLowerCase()!==e||e.length<3)&&(t.ForcePathStyle=!0);return t.DisableMultiRegionAccessPoints&&(t.disableMultiRegionAccessPoints=!0,t.DisableMRAP=!0),t},kle=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,Ale=/(\d+\.){3}\d+/,Rle=/\.\./,Ile=t=>kle.test(t)&&!Ale.test(t)&&!Rle.test(t),Ple=t=>{const[e,r,n,,,s]=t.split(":"),i=e==="arn"&&t.split(":").length>=6,o=!!(i&&r&&n&&s);if(i&&!o)throw new Error(`Invalid ARN: ${t} was an invalid ARN.`);return o},Ole=(t,e,r)=>{const n=async()=>{const s=r[t]??r[e];return typeof s=="function"?s():s};return t==="credentialScope"||e==="CredentialScope"?async()=>{const s=typeof r.credentials=="function"?await r.credentials():r.credentials;return s?.credentialScope??s?.CredentialScope}:t==="accountId"||e==="AccountId"?async()=>{const s=typeof r.credentials=="function"?await r.credentials():r.credentials;return s?.accountId??s?.AccountId}:t==="endpoint"||e==="endpoint"?async()=>{const s=await n();if(s&&typeof s=="object"){if("url"in s)return s.url.href;if("hostname"in s){const{protocol:i,hostname:o,port:a,path:l}=s;return`${i}//${o}${a?":"+a:""}${l}`}}return s}:n},n8=async t=>{};function Dle(t){const e={};if(t=t.replace(/^\?/,""),t)for(const r of t.split("&")){let[n,s=null]=r.split("=");n=decodeURIComponent(n),s&&(s=decodeURIComponent(s)),n in e?Array.isArray(e[n])?e[n].push(s):e[n]=[e[n],s]:e[n]=s}return e}const o_=t=>{if(typeof t=="string")return o_(new URL(t));const{hostname:e,pathname:r,port:n,protocol:s,search:i}=t;let o;return i&&(o=Dle(i)),{hostname:e,port:n?parseInt(n):void 0,protocol:s,path:r,query:o}},s8=t=>typeof t=="object"?"url"in t?o_(t.url):t:o_(t),Lle=async(t,e,r,n)=>{if(!r.endpoint){let o;r.serviceConfiguredEndpoint?o=await r.serviceConfiguredEndpoint():o=await n8(r.serviceId),o&&(r.endpoint=()=>Promise.resolve(s8(o)))}const s=await Nle(t,e,r);if(typeof r.endpointProvider!="function")throw new Error("config.endpointProvider is not set.");return r.endpointProvider(s,n)},Nle=async(t,e,r)=>{const n={},s=e?.getEndpointParameterInstructions?.()||{};for(const[i,o]of Object.entries(s))switch(o.type){case"staticContextParams":n[i]=o.value;break;case"contextParams":n[i]=t[o.name];break;case"clientContextParams":case"builtInParams":n[i]=await Ole(o.name,i,r)();break;case"operationContextParams":n[i]=o.get(t);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(o))}return Object.keys(s).length===0&&Object.assign(n,r),String(r.serviceId).toLowerCase()==="s3"&&await Cle(n),n},Mle=({config:t,instructions:e})=>(r,n)=>async s=>{t.endpoint&&Toe(n,"ENDPOINT_OVERRIDE","N");const i=await Lle(s.input,{getEndpointParameterInstructions(){return e}},{...t},n);n.endpointV2=i,n.authSchemes=i.properties?.authSchemes;const o=n.authSchemes?.[0];if(o){n.signing_region=o.signingRegion,n.signing_service=o.signingName;const l=Jy(n)?.selectedHttpAuthScheme?.httpAuthOption;l&&(l.signingProperties=Object.assign(l.signingProperties||{},{signing_region:o.signingRegion,signingRegion:o.signingRegion,signing_service:o.signingName,signingName:o.signingName,signingRegionSet:o.signingRegionSet},o.properties))}return r({...s})},Ble={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:SC.name},PC=(t,e)=>({applyToStack:r=>{r.addRelativeTo(Mle({config:t,instructions:e}),Ble)}}),Fle=t=>{const e=t.tls??!0,{endpoint:r}=t,n=r!=null?async()=>s8(await _a(r)()):void 0,i={...t,endpoint:n,tls:e,isCustomEndpoint:!!r,useDualstackEndpoint:_a(t.useDualstackEndpoint??!1),useFipsEndpoint:_a(t.useFipsEndpoint??!1)};let o;return i.serviceConfiguredEndpoint=async()=>(t.serviceId&&!o&&(o=n8(t.serviceId)),o),i};var Cu;(function(t){t.STANDARD="standard",t.ADAPTIVE="adaptive"})(Cu||(Cu={}));const a_=3,jle=Cu.STANDARD,Ule=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],$le=["TimeoutError","RequestTimeout","RequestTimeoutException"],Hle=[500,502,503,504],zle=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],Vle=t=>t.$metadata?.clockSkewCorrected,i8=t=>t.$metadata?.httpStatusCode===429||Ule.includes(t.name)||t.$retryable?.throttling==!0,OC=(t,e=0)=>Vle(t)||$le.includes(t.name)||zle.includes(t?.code||"")||Hle.includes(t.$metadata?.httpStatusCode||0)||t.cause!==void 0&&e<=10&&OC(t.cause,e+1),Gle=t=>{if(t.$metadata?.httpStatusCode!==void 0){const e=t.$metadata.httpStatusCode;return 500<=e&&e<=599&&!OC(t)}return!1};class tb{constructor(e){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=e?.beta??.7,this.minCapacity=e?.minCapacity??1,this.minFillRate=e?.minFillRate??.5,this.scaleConstant=e?.scaleConstant??.4,this.smooth=e?.smooth??.8;const r=this.getCurrentTimeInSeconds();this.lastThrottleTime=r,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1e3}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(this.enabled){if(this.refillTokenBucket(),e>this.currentCapacity){const r=(e-this.currentCapacity)/this.fillRate*1e3;await new Promise(n=>tb.setTimeoutFn(n,r))}this.currentCapacity=this.currentCapacity-e}}refillTokenBucket(){const e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}const r=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+r),this.lastTimestamp=e}updateClientSendingRate(e){let r;if(this.updateMeasuredRate(),i8(e)){const s=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=s,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),r=this.cubicThrottle(s),this.enableTokenBucket()}else this.calculateTimeWindow(),r=this.cubicSuccess(this.getCurrentTimeInSeconds());const n=Math.min(r,2*this.measuredTxRate);this.updateTokenBucketRate(n)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){const e=this.getCurrentTimeInSeconds(),r=Math.floor(e*2)/2;if(this.requestCount++,r>this.lastTxRateBucket){const n=this.requestCount/(r-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(n*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=r}}getPrecise(e){return parseFloat(e.toFixed(8))}}tb.setTimeoutFn=setTimeout;const JE=100,o8=20*1e3,Wle=500,HI=500,qle=5,Kle=10,Yle=1,Xle="amz-sdk-invocation-id",Zle="amz-sdk-request",Jle=()=>{let t=JE;return{computeNextBackoffDelay:n=>Math.floor(Math.min(o8,Math.random()*2**n*t)),setDelayBase:n=>{t=n}}},zI=({retryDelay:t,retryCount:e,retryCost:r})=>({getRetryCount:()=>e,getRetryDelay:()=>Math.min(o8,t),getRetryCost:()=>r});class a8{constructor(e){this.maxAttempts=e,this.mode=Cu.STANDARD,this.capacity=HI,this.retryBackoffStrategy=Jle(),this.maxAttemptsProvider=typeof e=="function"?e:async()=>e}async acquireInitialRetryToken(e){return zI({retryDelay:JE,retryCount:0})}async refreshRetryTokenForRetry(e,r){const n=await this.getMaxAttempts();if(this.shouldRetry(e,r,n)){const s=r.errorType;this.retryBackoffStrategy.setDelayBase(s==="THROTTLING"?Wle:JE);const i=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),o=r.retryAfterHint?Math.max(r.retryAfterHint.getTime()-Date.now()||0,i):i,a=this.getCapacityCost(s);return this.capacity-=a,zI({retryDelay:o,retryCount:e.getRetryCount()+1,retryCost:a})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(HI,this.capacity+(e.getRetryCost()??Yle))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch{return console.warn(`Max attempts provider could not resolve. Using default of ${a_}`),a_}}shouldRetry(e,r,n){return e.getRetryCount()+1<n&&this.capacity>=this.getCapacityCost(r.errorType)&&this.isRetryableError(r.errorType)}getCapacityCost(e){return e==="TRANSIENT"?Kle:qle}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class Qle{constructor(e,r){this.maxAttemptsProvider=e,this.mode=Cu.ADAPTIVE;const{rateLimiter:n}=r??{};this.rateLimiter=n??new tb,this.standardRetryStrategy=new a8(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,r){return this.rateLimiter.updateClientSendingRate(r),this.standardRetryStrategy.refreshRetryTokenForRetry(e,r)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}let Hm;const ece=new Uint8Array(16);function tce(){if(!Hm&&(Hm=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Hm))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Hm(ece)}const Dr=[];for(let t=0;t<256;++t)Dr.push((t+256).toString(16).slice(1));function rce(t,e=0){return Dr[t[e+0]]+Dr[t[e+1]]+Dr[t[e+2]]+Dr[t[e+3]]+"-"+Dr[t[e+4]]+Dr[t[e+5]]+"-"+Dr[t[e+6]]+Dr[t[e+7]]+"-"+Dr[t[e+8]]+Dr[t[e+9]]+"-"+Dr[t[e+10]]+Dr[t[e+11]]+Dr[t[e+12]]+Dr[t[e+13]]+Dr[t[e+14]]+Dr[t[e+15]]}const nce=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),VI={randomUUID:nce};function sce(t,e,r){if(VI.randomUUID&&!e&&!t)return VI.randomUUID();t=t||{};const n=t.random||(t.rng||tce)();return n[6]=n[6]&15|64,n[8]=n[8]&63|128,rce(n)}const ice=t=>t instanceof Error?t:t instanceof Object?Object.assign(new Error,t):typeof t=="string"?new Error(t):new Error(`AWS SDK error wrapper for ${t}`),oce=t=>{const{retryStrategy:e}=t,r=_a(t.maxAttempts??a_);return{...t,maxAttempts:r,retryStrategy:async()=>e||(await _a(t.retryMode)()===Cu.ADAPTIVE?new Qle(r):new a8(r))}},ace=t=>t?.body instanceof ReadableStream,lce=t=>(e,r)=>async n=>{let s=await t.retryStrategy();const i=await t.maxAttempts();if(cce(s)){s=s;let o=await s.acquireInitialRetryToken(r.partition_id),a=new Error,l=0,c=0;const{request:u}=n,h=es.isInstance(u);for(h&&(u.headers[Xle]=sce());;)try{h&&(u.headers[Zle]=`attempt=${l+1}; max=${i}`);const{response:d,output:f}=await e(n);return s.recordSuccess(o),f.$metadata.attempts=l+1,f.$metadata.totalRetryDelay=c,{response:d,output:f}}catch(d){const f=uce(d);if(a=ice(d),h&&ace(u))throw(r.logger instanceof e8?console:r.logger)?.warn("An error was encountered in a non-retryable streaming request."),a;try{o=await s.refreshRetryTokenForRetry(o,f)}catch{throw a.$metadata||(a.$metadata={}),a.$metadata.attempts=l+1,a.$metadata.totalRetryDelay=c,a}l=o.getRetryCount();const g=o.getRetryDelay();c+=g,await new Promise(_=>setTimeout(_,g))}}else return s=s,s?.mode&&(r.userAgent=[...r.userAgent||[],["cfg/retry-mode",s.mode]]),s.retry(e,n)},cce=t=>typeof t.acquireInitialRetryToken<"u"&&typeof t.refreshRetryTokenForRetry<"u"&&typeof t.recordSuccess<"u",uce=t=>{const e={error:t,errorType:hce(t)},r=pce(t.$response);return r&&(e.retryAfterHint=r),e},hce=t=>i8(t)?"THROTTLING":OC(t)?"TRANSIENT":Gle(t)?"SERVER_ERROR":"CLIENT_ERROR",dce={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},fce=t=>({applyToStack:e=>{e.add(lce(t),dce)}}),pce=t=>{if(!n_.isInstance(t))return;const e=Object.keys(t.headers).find(i=>i.toLowerCase()==="retry-after");if(!e)return;const r=t.headers[e],n=Number(r);return Number.isNaN(n)?new Date(r):new Date(n*1e3)},mce=async(t,e,r)=>({operation:Jy(e).operation,region:await _a(t.region)()||(()=>{throw new Error("expected `region` to be configured for `aws.auth#sigv4`")})()});function gce(t){return{schemeId:"aws.auth#sigv4",signingProperties:{name:"bedrock",region:t.region},propertiesExtractor:(e,r)=>({signingProperties:{config:e,context:r}})}}const _ce=t=>{const e=[];switch(t.operation){default:e.push(gce(t))}return e},yce=t=>({...Bae(t)}),bce=t=>({...t,useDualstackEndpoint:t.useDualstackEndpoint??!1,useFipsEndpoint:t.useFipsEndpoint??!1,defaultSigningName:"bedrock"}),DC={UseFIPS:{type:"builtInParams",name:"useFipsEndpoint"},Endpoint:{type:"builtInParams",name:"endpoint"},Region:{type:"builtInParams",name:"region"},UseDualStack:{type:"builtInParams",name:"useDualstackEndpoint"}},vce="@aws-sdk/client-bedrock-runtime",wce="AWS SDK for JavaScript Bedrock Runtime Client for Node.js, Browser and React Native",Ece="3.716.0",xce={build:"concurrently 'yarn:build:cjs' 'yarn:build:es' 'yarn:build:types'","build:cjs":"node ../../scripts/compilation/inline client-bedrock-runtime","build:es":"tsc -p tsconfig.es.json","build:include:deps":"lerna run --scope $npm_package_name --include-dependencies build","build:types":"tsc -p tsconfig.types.json","build:types:downlevel":"downlevel-dts dist-types dist-types/ts3.4",clean:"rimraf ./dist-* && rimraf *.tsbuildinfo","extract:docs":"api-extractor run --local","generate:client":"node ../../scripts/generate-clients/single-service --solo bedrock-runtime"},Sce="./dist-cjs/index.js",Tce="./dist-types/index.d.ts",Cce="./dist-es/index.js",kce=!1,Ace={"@aws-crypto/sha256-browser":"5.2.0","@aws-crypto/sha256-js":"5.2.0","@aws-sdk/client-sso-oidc":"3.716.0","@aws-sdk/client-sts":"3.716.0","@aws-sdk/core":"3.716.0","@aws-sdk/credential-provider-node":"3.716.0","@aws-sdk/middleware-host-header":"3.714.0","@aws-sdk/middleware-logger":"3.714.0","@aws-sdk/middleware-recursion-detection":"3.714.0","@aws-sdk/middleware-user-agent":"3.716.0","@aws-sdk/region-config-resolver":"3.714.0","@aws-sdk/types":"3.714.0","@aws-sdk/util-endpoints":"3.714.0","@aws-sdk/util-user-agent-browser":"3.714.0","@aws-sdk/util-user-agent-node":"3.716.0","@smithy/config-resolver":"^3.0.13","@smithy/core":"^2.5.5","@smithy/eventstream-serde-browser":"^3.0.14","@smithy/eventstream-serde-config-resolver":"^3.0.11","@smithy/eventstream-serde-node":"^3.0.13","@smithy/fetch-http-handler":"^4.1.2","@smithy/hash-node":"^3.0.11","@smithy/invalid-dependency":"^3.0.11","@smithy/middleware-content-length":"^3.0.13","@smithy/middleware-endpoint":"^3.2.6","@smithy/middleware-retry":"^3.0.31","@smithy/middleware-serde":"^3.0.11","@smithy/middleware-stack":"^3.0.11","@smithy/node-config-provider":"^3.1.12","@smithy/node-http-handler":"^3.3.2","@smithy/protocol-http":"^4.1.8","@smithy/smithy-client":"^3.5.1","@smithy/types":"^3.7.2","@smithy/url-parser":"^3.0.11","@smithy/util-base64":"^3.0.0","@smithy/util-body-length-browser":"^3.0.0","@smithy/util-body-length-node":"^3.0.0","@smithy/util-defaults-mode-browser":"^3.0.31","@smithy/util-defaults-mode-node":"^3.0.31","@smithy/util-endpoints":"^2.1.7","@smithy/util-middleware":"^3.0.11","@smithy/util-retry":"^3.0.11","@smithy/util-stream":"^3.3.2","@smithy/util-utf8":"^3.0.0","@types/uuid":"^9.0.1",tslib:"^2.6.2",uuid:"^9.0.1"},Rce={"@tsconfig/node16":"16.1.3","@types/node":"^16.18.96",concurrently:"7.0.0","downlevel-dts":"0.10.1",rimraf:"3.0.2",typescript:"~4.9.5"},Ice={node:">=16.0.0"},Pce={"<4.0":{"dist-types/*":["dist-types/ts3.4/*"]}},Oce=["dist-*/**"],Dce={name:"AWS SDK for JavaScript Team",url:"https://aws.amazon.com/javascript/"},Lce="Apache-2.0",Nce={"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.browser"},Mce="https://github.com/aws/aws-sdk-js-v3/tree/main/clients/client-bedrock-runtime",Bce={type:"git",url:"https://github.com/aws/aws-sdk-js-v3.git",directory:"clients/client-bedrock-runtime"},Fce={name:vce,description:wce,version:Ece,scripts:xce,main:Sce,types:Tce,module:Cce,sideEffects:kce,dependencies:Ace,devDependencies:Rce,engines:Ice,typesVersions:Pce,files:Oce,author:Dce,license:Lce,browser:Nce,"react-native":{"./dist-es/runtimeConfig":"./dist-es/runtimeConfig.native"},homepage:Mce,repository:Bce},jce=t=>new TextEncoder().encode(t);var Uce=typeof Ue<"u"&&Ue.from?function(t){return Ue.from(t,"utf8")}:jce;function yf(t){return t instanceof Uint8Array?t:typeof t=="string"?Uce(t):ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(t)}function QE(t){return typeof t=="string"?t.length===0:t.byteLength===0}function $ce(t){if(!Uint32Array.from){for(var e=new Uint32Array(t.length),r=0;r<t.length;)e[r]=t[r],r+=1;return e}return Uint32Array.from(t)}var l8={name:"SHA-256"},GI={name:"HMAC",hash:l8},Hce=new Uint8Array([227,176,196,66,152,252,28,20,154,251,244,200,153,111,185,36,39,174,65,228,100,155,147,76,164,149,153,27,120,82,184,85]);const zce={};function Yg(){return typeof window<"u"?window:typeof self<"u"?self:zce}var Vce=function(){function t(e){this.toHash=new Uint8Array(0),this.secret=e,this.reset()}return t.prototype.update=function(e){if(!QE(e)){var r=yf(e),n=new Uint8Array(this.toHash.byteLength+r.byteLength);n.set(this.toHash,0),n.set(r,this.toHash.byteLength),this.toHash=n}},t.prototype.digest=function(){var e=this;return this.key?this.key.then(function(r){return Yg().crypto.subtle.sign(GI,r,e.toHash).then(function(n){return new Uint8Array(n)})}):QE(this.toHash)?Promise.resolve(Hce):Promise.resolve().then(function(){return Yg().crypto.subtle.digest(l8,e.toHash)}).then(function(r){return Promise.resolve(new Uint8Array(r))})},t.prototype.reset=function(){var e=this;this.toHash=new Uint8Array(0),this.secret&&this.secret!==void 0&&(this.key=new Promise(function(r,n){Yg().crypto.subtle.importKey("raw",yf(e.secret),GI,!1,["sign"]).then(r,n)}),this.key.catch(function(){}))},t}(),hs=64,Gce=32,Wce=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qce=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],Kce=Math.pow(2,53)-1,Xg=function(){function t(){this.state=Int32Array.from(qce),this.temp=new Int32Array(64),this.buffer=new Uint8Array(64),this.bufferLength=0,this.bytesHashed=0,this.finished=!1}return t.prototype.update=function(e){if(this.finished)throw new Error("Attempted to update an already finished hash.");var r=0,n=e.byteLength;if(this.bytesHashed+=n,this.bytesHashed*8>Kce)throw new Error("Cannot hash more than 2^53 - 1 bits");for(;n>0;)this.buffer[this.bufferLength++]=e[r++],n--,this.bufferLength===hs&&(this.hashBuffer(),this.bufferLength=0)},t.prototype.digest=function(){if(!this.finished){var e=this.bytesHashed*8,r=new DataView(this.buffer.buffer,this.buffer.byteOffset,this.buffer.byteLength),n=this.bufferLength;if(r.setUint8(this.bufferLength++,128),n%hs>=hs-8){for(var s=this.bufferLength;s<hs;s++)r.setUint8(s,0);this.hashBuffer(),this.bufferLength=0}for(var s=this.bufferLength;s<hs-8;s++)r.setUint8(s,0);r.setUint32(hs-8,Math.floor(e/4294967296),!0),r.setUint32(hs-4,e),this.hashBuffer(),this.finished=!0}for(var i=new Uint8Array(Gce),s=0;s<8;s++)i[s*4]=this.state[s]>>>24&255,i[s*4+1]=this.state[s]>>>16&255,i[s*4+2]=this.state[s]>>>8&255,i[s*4+3]=this.state[s]>>>0&255;return i},t.prototype.hashBuffer=function(){for(var e=this,r=e.buffer,n=e.state,s=n[0],i=n[1],o=n[2],a=n[3],l=n[4],c=n[5],u=n[6],h=n[7],d=0;d<hs;d++){if(d<16)this.temp[d]=(r[d*4]&255)<<24|(r[d*4+1]&255)<<16|(r[d*4+2]&255)<<8|r[d*4+3]&255;else{var f=this.temp[d-2],g=(f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10;f=this.temp[d-15];var _=(f>>>7|f<<25)^(f>>>18|f<<14)^f>>>3;this.temp[d]=(g+this.temp[d-7]|0)+(_+this.temp[d-16]|0)}var m=(((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+(l&c^~l&u)|0)+(h+(Wce[d]+this.temp[d]|0)|0)|0,p=((s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10))+(s&i^s&o^i&o)|0;h=u,u=c,c=l,l=a+m|0,a=o,o=i,i=s,s=m+p|0}n[0]+=s,n[1]+=i,n[2]+=o,n[3]+=a,n[4]+=l,n[5]+=c,n[6]+=u,n[7]+=h},t}(),Yce=function(){function t(e){this.secret=e,this.hash=new Xg,this.reset()}return t.prototype.update=function(e){if(!(QE(e)||this.error))try{this.hash.update(yf(e))}catch(r){this.error=r}},t.prototype.digestSync=function(){if(this.error)throw this.error;return this.outer?(this.outer.finished||this.outer.update(this.hash.digest()),this.outer.digest()):this.hash.digest()},t.prototype.digest=function(){return VJ(this,void 0,void 0,function(){return GJ(this,function(e){return[2,this.digestSync()]})})},t.prototype.reset=function(){if(this.hash=new Xg,this.secret){this.outer=new Xg;var e=Xce(this.secret),r=new Uint8Array(hs);r.set(e);for(var n=0;n<hs;n++)e[n]^=54,r[n]^=92;this.hash.update(e),this.outer.update(r);for(var n=0;n<e.byteLength;n++)e[n]=0}},t}();function Xce(t){var e=yf(t);if(e.byteLength>hs){var r=new Xg;r.update(e),e=r.digest()}var n=new Uint8Array(hs);return n.set(e),n}var Zce=["decrypt","digest","encrypt","exportKey","generateKey","importKey","sign","verify"];function Jce(t){if(Qce(t)&&typeof t.crypto.subtle=="object"){var e=t.crypto.subtle;return eue(e)}return!1}function Qce(t){if(typeof t=="object"&&typeof t.crypto=="object"){var e=t.crypto.getRandomValues;return typeof e=="function"}return!1}function eue(t){return t&&Zce.every(function(e){return typeof t[e]=="function"})}var tue=function(){function t(e){Jce(Yg())?this.hash=new Vce(e):this.hash=new Yce(e)}return t.prototype.update=function(e,r){this.hash.update(yf(e))},t.prototype.digest=function(){return this.hash.digest()},t.prototype.reset=function(){this.hash.reset()},t}();const rue={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},c8={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},sr={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},ln={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},Vo={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"};class Ae{static getFirstMatch(e,r){const n=r.match(e);return n&&n.length>0&&n[1]||""}static getSecondMatch(e,r){const n=r.match(e);return n&&n.length>1&&n[2]||""}static matchAndReturnConst(e,r,n){if(e.test(r))return n}static getWindowsVersionName(e){switch(e){case"NT":return"NT";case"XP":return"XP";case"NT 5.0":return"2000";case"NT 5.1":return"XP";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}}static getMacOSVersionName(e){const r=e.split(".").splice(0,2).map(n=>parseInt(n,10)||0);if(r.push(0),r[0]===10)switch(r[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}}static getAndroidVersionName(e){const r=e.split(".").splice(0,2).map(n=>parseInt(n,10)||0);if(r.push(0),!(r[0]===1&&r[1]<5)){if(r[0]===1&&r[1]<6)return"Cupcake";if(r[0]===1&&r[1]>=6)return"Donut";if(r[0]===2&&r[1]<2)return"Eclair";if(r[0]===2&&r[1]===2)return"Froyo";if(r[0]===2&&r[1]>2)return"Gingerbread";if(r[0]===3)return"Honeycomb";if(r[0]===4&&r[1]<1)return"Ice Cream Sandwich";if(r[0]===4&&r[1]<4)return"Jelly Bean";if(r[0]===4&&r[1]>=4)return"KitKat";if(r[0]===5)return"Lollipop";if(r[0]===6)return"Marshmallow";if(r[0]===7)return"Nougat";if(r[0]===8)return"Oreo";if(r[0]===9)return"Pie"}}static getVersionPrecision(e){return e.split(".").length}static compareVersions(e,r,n=!1){const s=Ae.getVersionPrecision(e),i=Ae.getVersionPrecision(r);let o=Math.max(s,i),a=0;const l=Ae.map([e,r],c=>{const u=o-Ae.getVersionPrecision(c),h=c+new Array(u+1).join(".0");return Ae.map(h.split("."),d=>new Array(20-d.length).join("0")+d).reverse()});for(n&&(a=o-Math.min(s,i)),o-=1;o>=a;){if(l[0][o]>l[1][o])return 1;if(l[0][o]===l[1][o]){if(o===a)return 0;o-=1}else if(l[0][o]<l[1][o])return-1}}static map(e,r){const n=[];let s;if(Array.prototype.map)return Array.prototype.map.call(e,r);for(s=0;s<e.length;s+=1)n.push(r(e[s]));return n}static find(e,r){let n,s;if(Array.prototype.find)return Array.prototype.find.call(e,r);for(n=0,s=e.length;n<s;n+=1){const i=e[n];if(r(i,n))return i}}static assign(e,...r){const n=e;let s,i;if(Object.assign)return Object.assign(e,...r);for(s=0,i=r.length;s<i;s+=1){const o=r[s];typeof o=="object"&&o!==null&&Object.keys(o).forEach(l=>{n[l]=o[l]})}return e}static getBrowserAlias(e){return rue[e]}static getBrowserTypeByAlias(e){return c8[e]||""}}const Bt=/version\/(\d+(\.?_?\d+)+)/i,nue=[{test:[/googlebot/i],describe(t){const e={name:"Googlebot"},r=Ae.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/opera/i],describe(t){const e={name:"Opera"},r=Ae.getFirstMatch(Bt,t)||Ae.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/opr\/|opios/i],describe(t){const e={name:"Opera"},r=Ae.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/SamsungBrowser/i],describe(t){const e={name:"Samsung Internet for Android"},r=Ae.getFirstMatch(Bt,t)||Ae.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/Whale/i],describe(t){const e={name:"NAVER Whale Browser"},r=Ae.getFirstMatch(Bt,t)||Ae.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/MZBrowser/i],describe(t){const e={name:"MZ Browser"},r=Ae.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/focus/i],describe(t){const e={name:"Focus"},r=Ae.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/swing/i],describe(t){const e={name:"Swing"},r=Ae.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/coast/i],describe(t){const e={name:"Opera Coast"},r=Ae.getFirstMatch(Bt,t)||Ae.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe(t){const e={name:"Opera Touch"},r=Ae.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/yabrowser/i],describe(t){const e={name:"Yandex Browser"},r=Ae.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/ucbrowser/i],describe(t){const e={name:"UC Browser"},r=Ae.getFirstMatch(Bt,t)||Ae.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/Maxthon|mxios/i],describe(t){const e={name:"Maxthon"},r=Ae.getFirstMatch(Bt,t)||Ae.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/epiphany/i],describe(t){const e={name:"Epiphany"},r=Ae.getFirstMatch(Bt,t)||Ae.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/puffin/i],describe(t){const e={name:"Puffin"},r=Ae.getFirstMatch(Bt,t)||Ae.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/sleipnir/i],describe(t){const e={name:"Sleipnir"},r=Ae.getFirstMatch(Bt,t)||Ae.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/k-meleon/i],describe(t){const e={name:"K-Meleon"},r=Ae.getFirstMatch(Bt,t)||Ae.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/micromessenger/i],describe(t){const e={name:"WeChat"},r=Ae.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/qqbrowser/i],describe(t){const e={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},r=Ae.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/msie|trident/i],describe(t){const e={name:"Internet Explorer"},r=Ae.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/\sedg\//i],describe(t){const e={name:"Microsoft Edge"},r=Ae.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/edg([ea]|ios)/i],describe(t){const e={name:"Microsoft Edge"},r=Ae.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/vivaldi/i],describe(t){const e={name:"Vivaldi"},r=Ae.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/seamonkey/i],describe(t){const e={name:"SeaMonkey"},r=Ae.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/sailfish/i],describe(t){const e={name:"Sailfish"},r=Ae.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return r&&(e.version=r),e}},{test:[/silk/i],describe(t){const e={name:"Amazon Silk"},r=Ae.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/phantom/i],describe(t){const e={name:"PhantomJS"},r=Ae.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/slimerjs/i],describe(t){const e={name:"SlimerJS"},r=Ae.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e={name:"BlackBerry"},r=Ae.getFirstMatch(Bt,t)||Ae.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/(web|hpw)[o0]s/i],describe(t){const e={name:"WebOS Browser"},r=Ae.getFirstMatch(Bt,t)||Ae.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/bada/i],describe(t){const e={name:"Bada"},r=Ae.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/tizen/i],describe(t){const e={name:"Tizen"},r=Ae.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/qupzilla/i],describe(t){const e={name:"QupZilla"},r=Ae.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/firefox|iceweasel|fxios/i],describe(t){const e={name:"Firefox"},r=Ae.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/electron/i],describe(t){const e={name:"Electron"},r=Ae.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/MiuiBrowser/i],describe(t){const e={name:"Miui"},r=Ae.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/chromium/i],describe(t){const e={name:"Chromium"},r=Ae.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/chrome|crios|crmo/i],describe(t){const e={name:"Chrome"},r=Ae.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/GSA/i],describe(t){const e={name:"Google Search"},r=Ae.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){const e=!t.test(/like android/i),r=t.test(/android/i);return e&&r},describe(t){const e={name:"Android Browser"},r=Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/playstation 4/i],describe(t){const e={name:"PlayStation 4"},r=Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/safari|applewebkit/i],describe(t){const e={name:"Safari"},r=Ae.getFirstMatch(Bt,t);return r&&(e.version=r),e}},{test:[/.*/i],describe(t){const e=/^(.*)\/(.*) /,r=/^(.*)\/(.*)[ \t]\((.*)/,s=t.search("\\(")!==-1?r:e;return{name:Ae.getFirstMatch(s,t),version:Ae.getSecondMatch(s,t)}}}],sue=[{test:[/Roku\/DVP/],describe(t){const e=Ae.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:ln.Roku,version:e}}},{test:[/windows phone/i],describe(t){const e=Ae.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:ln.WindowsPhone,version:e}}},{test:[/windows /i],describe(t){const e=Ae.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),r=Ae.getWindowsVersionName(e);return{name:ln.Windows,version:e,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(t){const e={name:ln.iOS},r=Ae.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return r&&(e.version=r),e}},{test:[/macintosh/i],describe(t){const e=Ae.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),r=Ae.getMacOSVersionName(e),n={name:ln.MacOS,version:e};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe(t){const e=Ae.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:ln.iOS,version:e}}},{test(t){const e=!t.test(/like android/i),r=t.test(/android/i);return e&&r},describe(t){const e=Ae.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),r=Ae.getAndroidVersionName(e),n={name:ln.Android,version:e};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe(t){const e=Ae.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),r={name:ln.WebOS};return e&&e.length&&(r.version=e),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe(t){const e=Ae.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||Ae.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||Ae.getFirstMatch(/\bbb(\d+)/i,t);return{name:ln.BlackBerry,version:e}}},{test:[/bada/i],describe(t){const e=Ae.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:ln.Bada,version:e}}},{test:[/tizen/i],describe(t){const e=Ae.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:ln.Tizen,version:e}}},{test:[/linux/i],describe(){return{name:ln.Linux}}},{test:[/CrOS/],describe(){return{name:ln.ChromeOS}}},{test:[/PlayStation 4/],describe(t){const e=Ae.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:ln.PlayStation4,version:e}}}],iue=[{test:[/googlebot/i],describe(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe(t){const e=Ae.getFirstMatch(/(can-l01)/i,t)&&"Nova",r={type:sr.mobile,vendor:"Huawei"};return e&&(r.model=e),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe(){return{type:sr.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe(){return{type:sr.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe(){return{type:sr.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe(){return{type:sr.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe(){return{type:sr.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe(){return{type:sr.tablet}}},{test(t){const e=t.test(/ipod|iphone/i),r=t.test(/like (ipod|iphone)/i);return e&&!r},describe(t){const e=Ae.getFirstMatch(/(ipod|iphone)/i,t);return{type:sr.mobile,vendor:"Apple",model:e}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe(){return{type:sr.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe(){return{type:sr.mobile}}},{test(t){return t.getBrowserName(!0)==="blackberry"},describe(){return{type:sr.mobile,vendor:"BlackBerry"}}},{test(t){return t.getBrowserName(!0)==="bada"},describe(){return{type:sr.mobile}}},{test(t){return t.getBrowserName()==="windows phone"},describe(){return{type:sr.mobile,vendor:"Microsoft"}}},{test(t){const e=Number(String(t.getOSVersion()).split(".")[0]);return t.getOSName(!0)==="android"&&e>=3},describe(){return{type:sr.tablet}}},{test(t){return t.getOSName(!0)==="android"},describe(){return{type:sr.mobile}}},{test(t){return t.getOSName(!0)==="macos"},describe(){return{type:sr.desktop,vendor:"Apple"}}},{test(t){return t.getOSName(!0)==="windows"},describe(){return{type:sr.desktop}}},{test(t){return t.getOSName(!0)==="linux"},describe(){return{type:sr.desktop}}},{test(t){return t.getOSName(!0)==="playstation 4"},describe(){return{type:sr.tv}}},{test(t){return t.getOSName(!0)==="roku"},describe(){return{type:sr.tv}}}],oue=[{test(t){return t.getBrowserName(!0)==="microsoft edge"},describe(t){if(/\sedg\//i.test(t))return{name:Vo.Blink};const r=Ae.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:Vo.EdgeHTML,version:r}}},{test:[/trident/i],describe(t){const e={name:Vo.Trident},r=Ae.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){return t.test(/presto/i)},describe(t){const e={name:Vo.Presto},r=Ae.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test(t){const e=t.test(/gecko/i),r=t.test(/like gecko/i);return e&&!r},describe(t){const e={name:Vo.Gecko},r=Ae.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}},{test:[/(apple)?webkit\/537\.36/i],describe(){return{name:Vo.Blink}}},{test:[/(apple)?webkit/i],describe(t){const e={name:Vo.WebKit},r=Ae.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return r&&(e.version=r),e}}];let WI=class{constructor(e,r=!1){if(e==null||e==="")throw new Error("UserAgent parameter can't be empty");this._ua=e,this.parsedResult={},r!==!0&&this.parse()}getUA(){return this._ua}test(e){return e.test(this._ua)}parseBrowser(){this.parsedResult.browser={};const e=Ae.find(nue,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.browser=e.describe(this.getUA())),this.parsedResult.browser}getBrowser(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()}getBrowserName(e){return e?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""}getBrowserVersion(){return this.getBrowser().version}getOS(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()}parseOS(){this.parsedResult.os={};const e=Ae.find(sue,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.os=e.describe(this.getUA())),this.parsedResult.os}getOSName(e){const{name:r}=this.getOS();return e?String(r).toLowerCase()||"":r||""}getOSVersion(){return this.getOS().version}getPlatform(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()}getPlatformType(e=!1){const{type:r}=this.getPlatform();return e?String(r).toLowerCase()||"":r||""}parsePlatform(){this.parsedResult.platform={};const e=Ae.find(iue,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.platform=e.describe(this.getUA())),this.parsedResult.platform}getEngine(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()}getEngineName(e){return e?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""}parseEngine(){this.parsedResult.engine={};const e=Ae.find(oue,r=>{if(typeof r.test=="function")return r.test(this);if(r.test instanceof Array)return r.test.some(n=>this.test(n));throw new Error("Browser's test function is not valid")});return e&&(this.parsedResult.engine=e.describe(this.getUA())),this.parsedResult.engine}parse(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this}getResult(){return Ae.assign({},this.parsedResult)}satisfies(e){const r={};let n=0;const s={};let i=0;if(Object.keys(e).forEach(a=>{const l=e[a];typeof l=="string"?(s[a]=l,i+=1):typeof l=="object"&&(r[a]=l,n+=1)}),n>0){const a=Object.keys(r),l=Ae.find(a,u=>this.isOS(u));if(l){const u=this.satisfies(r[l]);if(u!==void 0)return u}const c=Ae.find(a,u=>this.isPlatform(u));if(c){const u=this.satisfies(r[c]);if(u!==void 0)return u}}if(i>0){const a=Object.keys(s),l=Ae.find(a,c=>this.isBrowser(c,!0));if(l!==void 0)return this.compareVersion(s[l])}}isBrowser(e,r=!1){const n=this.getBrowserName().toLowerCase();let s=e.toLowerCase();const i=Ae.getBrowserTypeByAlias(s);return r&&i&&(s=i.toLowerCase()),s===n}compareVersion(e){let r=[0],n=e,s=!1;const i=this.getBrowserVersion();if(typeof i=="string")return e[0]===">"||e[0]==="<"?(n=e.substr(1),e[1]==="="?(s=!0,n=e.substr(2)):r=[],e[0]===">"?r.push(1):r.push(-1)):e[0]==="="?n=e.substr(1):e[0]==="~"&&(s=!0,n=e.substr(1)),r.indexOf(Ae.compareVersions(i,n,s))>-1}isOS(e){return this.getOSName(!0)===String(e).toLowerCase()}isPlatform(e){return this.getPlatformType(!0)===String(e).toLowerCase()}isEngine(e){return this.getEngineName(!0)===String(e).toLowerCase()}is(e,r=!1){return this.isBrowser(e,r)||this.isOS(e)||this.isPlatform(e)}some(e=[]){return e.some(r=>this.is(r))}};/*!
 * Bowser - a browser detector
 * https://github.com/lancedikson/bowser
 * MIT License | (c) Dustin Diaz 2012-2015
 * MIT License | (c) Denis Demchenko 2015-2019
 */class u8{static getParser(e,r=!1){if(typeof e!="string")throw new Error("UserAgent should be a string");return new WI(e,r)}static parse(e){return new WI(e).getResult()}static get BROWSER_MAP(){return c8}static get ENGINE_MAP(){return Vo}static get OS_MAP(){return ln}static get PLATFORMS_MAP(){return sr}}const aue=({serviceId:t,clientVersion:e})=>async r=>{const n=typeof window<"u"&&window?.navigator?.userAgent?u8.parse(window.navigator.userAgent):void 0,s=[["aws-sdk-js",e],["ua","2.1"],[`os/${n?.os?.name||"other"}`,n?.os?.version],["lang/js"],["md/browser",`${n?.browser?.name??"unknown"}_${n?.browser?.version??"unknown"}`]];t&&s.push([`api/${t}`,e]);const i=await r?.userAgentAppId?.();return i&&s.push([`app/${i}`]),s};var h8=function(){function t(){this.checksum=4294967295}return t.prototype.update=function(e){var r,n;try{for(var s=WJ(e),i=s.next();!i.done;i=s.next()){var o=i.value;this.checksum=this.checksum>>>8^cue[(this.checksum^o)&255]}}catch(a){r={error:a}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}return this},t.prototype.digest=function(){return(this.checksum^4294967295)>>>0},t}(),lue=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],cue=$ce(lue);class Td{constructor(e){if(this.bytes=e,e.byteLength!==8)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>9223372036854776e3||e<-9223372036854776e3)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const r=new Uint8Array(8);for(let n=7,s=Math.abs(Math.round(e));n>-1&&s>0;n--,s/=256)r[n]=s;return e<0&&qI(r),new Td(r)}valueOf(){const e=this.bytes.slice(0),r=e[0]&128;return r&&qI(e),parseInt(Vn(e),16)*(r?-1:1)}toString(){return String(this.valueOf())}}function qI(t){for(let e=0;e<8;e++)t[e]^=255;for(let e=7;e>-1&&(t[e]++,t[e]===0);e--);}class uue{constructor(e,r){this.toUtf8=e,this.fromUtf8=r}format(e){const r=[];for(const i of Object.keys(e)){const o=this.fromUtf8(i);r.push(Uint8Array.from([o.byteLength]),o,this.formatHeaderValue(e[i]))}const n=new Uint8Array(r.reduce((i,o)=>i+o.byteLength,0));let s=0;for(const i of r)n.set(i,s),s+=i.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const r=new DataView(new ArrayBuffer(3));return r.setUint8(0,3),r.setInt16(1,e.value,!1),new Uint8Array(r.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const i=new DataView(new ArrayBuffer(3+e.value.byteLength));i.setUint8(0,6),i.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(i.buffer);return o.set(e.value,3),o;case"string":const a=this.fromUtf8(e.value),l=new DataView(new ArrayBuffer(3+a.byteLength));l.setUint8(0,7),l.setUint16(1,a.byteLength,!1);const c=new Uint8Array(l.buffer);return c.set(a,3),c;case"timestamp":const u=new Uint8Array(9);return u[0]=8,u.set(Td.fromNumber(e.value.valueOf()).bytes,1),u;case"uuid":if(!bue.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const h=new Uint8Array(17);return h[0]=9,h.set(I5(e.value.replace(/\-/g,"")),1),h}}parse(e){const r={};let n=0;for(;n<e.byteLength;){const s=e.getUint8(n++),i=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,s));switch(n+=s,e.getUint8(n++)){case 0:r[i]={type:YI,value:!0};break;case 1:r[i]={type:YI,value:!1};break;case 2:r[i]={type:hue,value:e.getInt8(n++)};break;case 3:r[i]={type:due,value:e.getInt16(n,!1)},n+=2;break;case 4:r[i]={type:fue,value:e.getInt32(n,!1)},n+=4;break;case 5:r[i]={type:pue,value:new Td(new Uint8Array(e.buffer,e.byteOffset+n,8))},n+=8;break;case 6:const o=e.getUint16(n,!1);n+=2,r[i]={type:mue,value:new Uint8Array(e.buffer,e.byteOffset+n,o)},n+=o;break;case 7:const a=e.getUint16(n,!1);n+=2,r[i]={type:gue,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,a))},n+=a;break;case 8:r[i]={type:_ue,value:new Date(new Td(new Uint8Array(e.buffer,e.byteOffset+n,8)).valueOf())},n+=8;break;case 9:const l=new Uint8Array(e.buffer,e.byteOffset+n,16);n+=16,r[i]={type:yue,value:`${Vn(l.subarray(0,4))}-${Vn(l.subarray(4,6))}-${Vn(l.subarray(6,8))}-${Vn(l.subarray(8,10))}-${Vn(l.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return r}}var KI;(function(t){t[t.boolTrue=0]="boolTrue",t[t.boolFalse=1]="boolFalse",t[t.byte=2]="byte",t[t.short=3]="short",t[t.integer=4]="integer",t[t.long=5]="long",t[t.byteArray=6]="byteArray",t[t.string=7]="string",t[t.timestamp=8]="timestamp",t[t.uuid=9]="uuid"})(KI||(KI={}));const YI="boolean",hue="byte",due="short",fue="integer",pue="long",mue="binary",gue="string",_ue="timestamp",yue="uuid",bue=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/,d8=4,Go=d8*2,nl=4,vue=Go+nl*2;function wue({byteLength:t,byteOffset:e,buffer:r}){if(t<vue)throw new Error("Provided message too short to accommodate event stream message overhead");const n=new DataView(r,e,t),s=n.getUint32(0,!1);if(t!==s)throw new Error("Reported message length does not match received message length");const i=n.getUint32(d8,!1),o=n.getUint32(Go,!1),a=n.getUint32(t-nl,!1),l=new h8().update(new Uint8Array(r,e,Go));if(o!==l.digest())throw new Error(`The prelude checksum specified in the message (${o}) does not match the calculated CRC32 checksum (${l.digest()})`);if(l.update(new Uint8Array(r,e+Go,t-(Go+nl))),a!==l.digest())throw new Error(`The message checksum (${l.digest()}) did not match the expected value of ${a}`);return{headers:new DataView(r,e+Go+nl,i),body:new Uint8Array(r,e+Go+nl+i,s-i-(Go+nl+nl))}}class Eue{constructor(e,r){this.headerMarshaller=new uue(e,r),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){const e=this.messageBuffer.pop(),r=this.isEndOfStream;return{getMessage(){return e},isEndOfStream(){return r}}}getAvailableMessages(){const e=this.messageBuffer;this.messageBuffer=[];const r=this.isEndOfStream;return{getMessages(){return e},isEndOfStream(){return r}}}encode({headers:e,body:r}){const n=this.headerMarshaller.format(e),s=n.byteLength+r.byteLength+16,i=new Uint8Array(s),o=new DataView(i.buffer,i.byteOffset,i.byteLength),a=new h8;return o.setUint32(0,s,!1),o.setUint32(4,n.byteLength,!1),o.setUint32(8,a.update(i.subarray(0,8)).digest(),!1),i.set(n,12),i.set(r,n.byteLength+12),o.setUint32(s-4,a.update(i.subarray(8,s-4)).digest(),!1),i}decode(e){const{headers:r,body:n}=wue(e);return{headers:this.headerMarshaller.parse(r),body:n}}formatHeaders(e){return this.headerMarshaller.format(e)}}class xue{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.decoder.decode(e)}}class Sue{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream)yield this.options.encoder.encode(e);this.options.includeEndFrame&&(yield new Uint8Array(0))}}class Tue{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const r=await this.options.deserializer(e);r!==void 0&&(yield r)}}}class Cue{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream)yield this.options.serializer(e)}}function kue(t){let e=0,r=0,n=null,s=null;const i=a=>{if(typeof a!="number")throw new Error("Attempted to allocate an event message where size was not a number: "+a);e=a,r=4,n=new Uint8Array(a),new DataView(n.buffer).setUint32(0,a,!1)},o=async function*(){const a=t[Symbol.asyncIterator]();for(;;){const{value:l,done:c}=await a.next();if(c){if(e)if(e===r)yield n;else throw new Error("Truncated event message received.");else return;return}const u=l.length;let h=0;for(;h<u;){if(!n){const f=u-h;s||(s=new Uint8Array(4));const g=Math.min(4-r,f);if(s.set(l.slice(h,h+g),r),r+=g,h+=g,r<4)break;i(new DataView(s.buffer).getUint32(0,!1)),s=null}const d=Math.min(e-r,u-h);n.set(l.slice(h,h+d),r),r+=d,h+=d,e&&e===r&&(yield n,n=null,e=0,r=0)}}};return{[Symbol.asyncIterator]:o}}function Aue(t,e){return async function(r){const{value:n}=r.headers[":message-type"];if(n==="error"){const s=new Error(r.headers[":error-message"].value||"UnknownError");throw s.name=r.headers[":error-code"].value,s}else if(n==="exception"){const s=r.headers[":exception-type"].value,i={[s]:r},o=await t(i);if(o.$unknown){const a=new Error(e(r.body));throw a.name=s,a}throw o[s]}else if(n==="event"){const s={[r.headers[":event-type"].value]:r},i=await t(s);return i.$unknown?void 0:i}else throw Error(`Unrecognizable event type: ${r.headers[":event-type"].value}`)}}let Rue=class{constructor({utf8Encoder:e,utf8Decoder:r}){this.eventStreamCodec=new Eue(e,r),this.utfEncoder=e}deserialize(e,r){const n=kue(e);return new Tue({messageStream:new xue({inputStream:n,decoder:this.eventStreamCodec}),deserializer:Aue(r,this.utfEncoder)})}serialize(e,r){return new Sue({messageStream:new Cue({inputStream:e,serializer:r}),encoder:this.eventStreamCodec,includeEndFrame:!0})}};const Iue=t=>({[Symbol.asyncIterator]:async function*(){const e=t.getReader();try{for(;;){const{done:r,value:n}=await e.read();if(r)return;yield n}}finally{e.releaseLock()}}}),Pue=t=>{const e=t[Symbol.asyncIterator]();return new ReadableStream({async pull(r){const{done:n,value:s}=await e.next();if(n)return r.close();r.enqueue(s)}})};class Oue{constructor({utf8Encoder:e,utf8Decoder:r}){this.universalMarshaller=new Rue({utf8Decoder:r,utf8Encoder:e})}deserialize(e,r){const n=Due(e)?Iue(e):e;return this.universalMarshaller.deserialize(n,r)}serialize(e,r){const n=this.universalMarshaller.serialize(e,r);return typeof ReadableStream=="function"?Pue(n):n}}const Due=t=>typeof ReadableStream=="function"&&t instanceof ReadableStream,Lue=t=>new Oue(t),Nue=t=>()=>Promise.reject(t),XI=typeof TextEncoder=="function"?new TextEncoder:null,Mue=t=>{if(typeof t=="string"){if(XI)return XI.encode(t).byteLength;let e=t.length;for(let r=e-1;r>=0;r--){const n=t.charCodeAt(r);n>127&&n<=2047?e++:n>2047&&n<=65535&&(e+=2),n>=56320&&n<=57343&&r--}return e}else{if(typeof t.byteLength=="number")return t.byteLength;if(typeof t.size=="number")return t.size}throw new Error(`Body Length computation failed for ${t}`)},f8="required",bi="fn",vi="argv",th="ref",ZI=!0,JI="isSet",bf="booleanEquals",bc="error",Rh="endpoint",an="tree",LC="PartitionResult",QI={[f8]:!1,type:"String"},eP={[f8]:!0,default:!1,type:"Boolean"},tP={[th]:"Endpoint"},p8={[bi]:bf,[vi]:[{[th]:"UseFIPS"},!0]},m8={[bi]:bf,[vi]:[{[th]:"UseDualStack"},!0]},ei={},rP={[bi]:"getAttr",[vi]:[{[th]:LC},"supportsFIPS"]},nP={[bi]:bf,[vi]:[!0,{[bi]:"getAttr",[vi]:[{[th]:LC},"supportsDualStack"]}]},sP=[p8],iP=[m8],oP=[{[th]:"Region"}],Bue={version:"1.0",parameters:{Region:QI,UseDualStack:eP,UseFIPS:eP,Endpoint:QI},rules:[{conditions:[{[bi]:JI,[vi]:[tP]}],rules:[{conditions:sP,error:"Invalid Configuration: FIPS and custom endpoint are not supported",type:bc},{rules:[{conditions:iP,error:"Invalid Configuration: Dualstack and custom endpoint are not supported",type:bc},{endpoint:{url:tP,properties:ei,headers:ei},type:Rh}],type:an}],type:an},{rules:[{conditions:[{[bi]:JI,[vi]:oP}],rules:[{conditions:[{[bi]:"aws.partition",[vi]:oP,assign:LC}],rules:[{conditions:[p8,m8],rules:[{conditions:[{[bi]:bf,[vi]:[ZI,rP]},nP],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime-fips.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:ei,headers:ei},type:Rh}],type:an}],type:an},{error:"FIPS and DualStack are enabled, but this partition does not support one or both",type:bc}],type:an},{conditions:sP,rules:[{conditions:[{[bi]:bf,[vi]:[rP,ZI]}],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime-fips.{Region}.{PartitionResult#dnsSuffix}",properties:ei,headers:ei},type:Rh}],type:an}],type:an},{error:"FIPS is enabled but this partition does not support FIPS",type:bc}],type:an},{conditions:iP,rules:[{conditions:[nP],rules:[{rules:[{endpoint:{url:"https://bedrock-runtime.{Region}.{PartitionResult#dualStackDnsSuffix}",properties:ei,headers:ei},type:Rh}],type:an}],type:an},{error:"DualStack is enabled but this partition does not support DualStack",type:bc}],type:an},{rules:[{endpoint:{url:"https://bedrock-runtime.{Region}.{PartitionResult#dnsSuffix}",properties:ei,headers:ei},type:Rh}],type:an}],type:an}],type:an},{error:"Invalid Configuration: Missing Region",type:bc}],type:an}]},Fue=Bue,jue=new Loe({size:50,params:["Endpoint","Region","UseDualStack","UseFIPS"]}),Uue=(t,e={})=>jue.get(t,()=>Qoe(Fue,{endpointParams:t,logger:e.logger}));s_.aws=$5;const $ue=t=>({apiVersion:"2023-09-30",base64Decoder:t?.base64Decoder??C5,base64Encoder:t?.base64Encoder??A5,disableHostPrefix:t?.disableHostPrefix??!1,endpointProvider:t?.endpointProvider??Uue,extensions:t?.extensions??[],httpAuthSchemeProvider:t?.httpAuthSchemeProvider??_ce,httpAuthSchemes:t?.httpAuthSchemes??[{schemeId:"aws.auth#sigv4",identityProvider:e=>e.getIdentityProvider("aws.auth#sigv4"),signer:new uae}],logger:t?.logger??new e8,serviceId:t?.serviceId??"Bedrock Runtime",urlParser:t?.urlParser??o_,utf8Decoder:t?.utf8Decoder??Tu,utf8Encoder:t?.utf8Encoder??k5}),Hue=["in-region","cross-region","mobile","standard","legacy"],zue=({defaultsMode:t}={})=>hae(async()=>{const e=typeof t=="function"?await t():t;switch(e?.toLowerCase()){case"auto":return Promise.resolve(Vue()?"mobile":"standard");case"mobile":case"in-region":case"cross-region":case"standard":case"legacy":return Promise.resolve(e?.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${Hue.join(", ")}, got ${e}`)}}),Vue=()=>{const e=(typeof window<"u"&&window?.navigator?.userAgent?u8.parse(window.navigator.userAgent):void 0)?.platform?.type;return e==="tablet"||e==="mobile"},Gue=t=>{const e=zue(t),r=()=>e().then(Xae),n=$ue(t);return{...n,...t,runtime:"browser",defaultsMode:e,bodyLengthChecker:t?.bodyLengthChecker??Mue,credentialDefaultProvider:t?.credentialDefaultProvider??(s=>()=>Promise.reject(new Error("Credential is missing"))),defaultUserAgentProvider:t?.defaultUserAgentProvider??aue({serviceId:n.serviceId,clientVersion:Fce.version}),eventStreamSerdeProvider:t?.eventStreamSerdeProvider??Lue,maxAttempts:t?.maxAttempts??a_,region:t?.region??Nue("Region is missing"),requestHandler:CC.create(t?.requestHandler??r),retryMode:t?.retryMode??(async()=>(await r()).retryMode||jle),sha256:t?.sha256??tue,streamCollector:t?.streamCollector??woe,useDualstackEndpoint:t?.useDualstackEndpoint??(()=>Promise.resolve(ble)),useFipsEndpoint:t?.useFipsEndpoint??(()=>Promise.resolve(vle))}},Wue=t=>{let e=async()=>{if(t.region===void 0)throw new Error("Region is missing from runtimeConfig");const r=t.region;return typeof r=="string"?r:r()};return{setRegion(r){e=r},region(){return e}}},que=t=>({region:t.region()}),Kue=t=>{const e=t.httpAuthSchemes;let r=t.httpAuthSchemeProvider,n=t.credentials;return{setHttpAuthScheme(s){const i=e.findIndex(o=>o.schemeId===s.schemeId);i===-1?e.push(s):e.splice(i,1,s)},httpAuthSchemes(){return e},setHttpAuthSchemeProvider(s){r=s},httpAuthSchemeProvider(){return r},setCredentials(s){n=s},credentials(){return n}}},Yue=t=>({httpAuthSchemes:t.httpAuthSchemes(),httpAuthSchemeProvider:t.httpAuthSchemeProvider(),credentials:t.credentials()}),zm=t=>t,Xue=(t,e)=>{const r={...zm(Wue(t)),...zm(tle(t)),...zm(zie(t)),...zm(Kue(t))};return e.forEach(n=>n.configure(r)),{...t,...que(r),...rle(r),...Vie(r),...Yue(r)}};class Zue extends Fae{constructor(...[e]){const r=Gue(e||{}),n=bce(r),s=Doe(n),i=oce(s),o=wle(i),a=o,l=Fle(a),c=Ele(l),u=yce(c),h=Xue(u,e?.extensions||[]);super(h),this.config=h,this.middlewareStack.use(yle(this.config)),this.middlewareStack.use(fce(this.config)),this.middlewareStack.use(Tle(this.config)),this.middlewareStack.use(Kie(this.config)),this.middlewareStack.use(Zie(this.config)),this.middlewareStack.use(roe(this.config)),this.middlewareStack.use(ooe(this.config,{httpAuthSchemeParametersProvider:mce,identityProviderConfigProvider:async d=>new Coe({"aws.auth#sigv4":d.credentials})})),this.middlewareStack.use(poe(this.config))}destroy(){super.destroy()}}class bn extends IC{constructor(e){super(e),Object.setPrototypeOf(this,bn.prototype)}}class NC extends bn{constructor(e){super({name:"AccessDeniedException",$fault:"client",...e}),this.name="AccessDeniedException",this.$fault="client",Object.setPrototypeOf(this,NC.prototype)}}var aP;(function(t){t.visit=(e,r)=>e.s3OutputDataConfig!==void 0?r.s3OutputDataConfig(e.s3OutputDataConfig):r._(e.$unknown[0],e.$unknown[1])})(aP||(aP={}));class MC extends bn{constructor(e){super({name:"InternalServerException",$fault:"server",...e}),this.name="InternalServerException",this.$fault="server",Object.setPrototypeOf(this,MC.prototype)}}class BC extends bn{constructor(e){super({name:"ThrottlingException",$fault:"client",...e}),this.name="ThrottlingException",this.$fault="client",Object.setPrototypeOf(this,BC.prototype)}}class FC extends bn{constructor(e){super({name:"ValidationException",$fault:"client",...e}),this.name="ValidationException",this.$fault="client",Object.setPrototypeOf(this,FC.prototype)}}class jC extends bn{constructor(e){super({name:"ConflictException",$fault:"client",...e}),this.name="ConflictException",this.$fault="client",Object.setPrototypeOf(this,jC.prototype)}}class UC extends bn{constructor(e){super({name:"ResourceNotFoundException",$fault:"client",...e}),this.name="ResourceNotFoundException",this.$fault="client",Object.setPrototypeOf(this,UC.prototype)}}class $C extends bn{constructor(e){super({name:"ServiceQuotaExceededException",$fault:"client",...e}),this.name="ServiceQuotaExceededException",this.$fault="client",Object.setPrototypeOf(this,$C.prototype)}}class HC extends bn{constructor(e){super({name:"ServiceUnavailableException",$fault:"server",...e}),this.name="ServiceUnavailableException",this.$fault="server",Object.setPrototypeOf(this,HC.prototype)}}var lP;(function(t){t.visit=(e,r)=>e.bytes!==void 0?r.bytes(e.bytes):r._(e.$unknown[0],e.$unknown[1])})(lP||(lP={}));var cP;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):e.image!==void 0?r.image(e.image):r._(e.$unknown[0],e.$unknown[1])})(cP||(cP={}));var ex;(function(t){t.visit=(e,r)=>e.bytes!==void 0?r.bytes(e.bytes):r._(e.$unknown[0],e.$unknown[1])})(ex||(ex={}));var tx;(function(t){t.visit=(e,r)=>e.bytes!==void 0?r.bytes(e.bytes):r._(e.$unknown[0],e.$unknown[1])})(tx||(tx={}));var rx;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):e.image!==void 0?r.image(e.image):r._(e.$unknown[0],e.$unknown[1])})(rx||(rx={}));var nx;(function(t){t.visit=(e,r)=>e.bytes!==void 0?r.bytes(e.bytes):r._(e.$unknown[0],e.$unknown[1])})(nx||(nx={}));var sx;(function(t){t.visit=(e,r)=>e.bytes!==void 0?r.bytes(e.bytes):e.s3Location!==void 0?r.s3Location(e.s3Location):r._(e.$unknown[0],e.$unknown[1])})(sx||(sx={}));var ix;(function(t){t.visit=(e,r)=>e.json!==void 0?r.json(e.json):e.text!==void 0?r.text(e.text):e.image!==void 0?r.image(e.image):e.document!==void 0?r.document(e.document):e.video!==void 0?r.video(e.video):r._(e.$unknown[0],e.$unknown[1])})(ix||(ix={}));var ox;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):e.image!==void 0?r.image(e.image):e.document!==void 0?r.document(e.document):e.video!==void 0?r.video(e.video):e.toolUse!==void 0?r.toolUse(e.toolUse):e.toolResult!==void 0?r.toolResult(e.toolResult):e.guardContent!==void 0?r.guardContent(e.guardContent):r._(e.$unknown[0],e.$unknown[1])})(ox||(ox={}));var uP;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):r._(e.$unknown[0],e.$unknown[1])})(uP||(uP={}));var ax;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):e.guardContent!==void 0?r.guardContent(e.guardContent):r._(e.$unknown[0],e.$unknown[1])})(ax||(ax={}));var hP;(function(t){t.visit=(e,r)=>e.auto!==void 0?r.auto(e.auto):e.any!==void 0?r.any(e.any):e.tool!==void 0?r.tool(e.tool):r._(e.$unknown[0],e.$unknown[1])})(hP||(hP={}));var lx;(function(t){t.visit=(e,r)=>e.json!==void 0?r.json(e.json):r._(e.$unknown[0],e.$unknown[1])})(lx||(lx={}));var cx;(function(t){t.visit=(e,r)=>e.toolSpec!==void 0?r.toolSpec(e.toolSpec):r._(e.$unknown[0],e.$unknown[1])})(cx||(cx={}));var dP;(function(t){t.visit=(e,r)=>e.message!==void 0?r.message(e.message):r._(e.$unknown[0],e.$unknown[1])})(dP||(dP={}));class zC extends bn{constructor(e){super({name:"ModelErrorException",$fault:"client",...e}),this.name="ModelErrorException",this.$fault="client",Object.setPrototypeOf(this,zC.prototype),this.originalStatusCode=e.originalStatusCode,this.resourceName=e.resourceName}}class VC extends bn{constructor(e){super({name:"ModelNotReadyException",$fault:"client",...e}),this.name="ModelNotReadyException",this.$fault="client",this.$retryable={},Object.setPrototypeOf(this,VC.prototype)}}class GC extends bn{constructor(e){super({name:"ModelTimeoutException",$fault:"client",...e}),this.name="ModelTimeoutException",this.$fault="client",Object.setPrototypeOf(this,GC.prototype)}}var fP;(function(t){t.visit=(e,r)=>e.text!==void 0?r.text(e.text):e.toolUse!==void 0?r.toolUse(e.toolUse):r._(e.$unknown[0],e.$unknown[1])})(fP||(fP={}));var pP;(function(t){t.visit=(e,r)=>e.toolUse!==void 0?r.toolUse(e.toolUse):r._(e.$unknown[0],e.$unknown[1])})(pP||(pP={}));class WC extends bn{constructor(e){super({name:"ModelStreamErrorException",$fault:"client",...e}),this.name="ModelStreamErrorException",this.$fault="client",Object.setPrototypeOf(this,WC.prototype),this.originalStatusCode=e.originalStatusCode,this.originalMessage=e.originalMessage}}var mP;(function(t){t.visit=(e,r)=>e.messageStart!==void 0?r.messageStart(e.messageStart):e.contentBlockStart!==void 0?r.contentBlockStart(e.contentBlockStart):e.contentBlockDelta!==void 0?r.contentBlockDelta(e.contentBlockDelta):e.contentBlockStop!==void 0?r.contentBlockStop(e.contentBlockStop):e.messageStop!==void 0?r.messageStop(e.messageStop):e.metadata!==void 0?r.metadata(e.metadata):e.internalServerException!==void 0?r.internalServerException(e.internalServerException):e.modelStreamErrorException!==void 0?r.modelStreamErrorException(e.modelStreamErrorException):e.validationException!==void 0?r.validationException(e.validationException):e.throttlingException!==void 0?r.throttlingException(e.throttlingException):e.serviceUnavailableException!==void 0?r.serviceUnavailableException(e.serviceUnavailableException):r._(e.$unknown[0],e.$unknown[1])})(mP||(mP={}));var gP;(function(t){t.visit=(e,r)=>e.chunk!==void 0?r.chunk(e.chunk):e.internalServerException!==void 0?r.internalServerException(e.internalServerException):e.modelStreamErrorException!==void 0?r.modelStreamErrorException(e.modelStreamErrorException):e.validationException!==void 0?r.validationException(e.validationException):e.throttlingException!==void 0?r.throttlingException(e.throttlingException):e.modelTimeoutException!==void 0?r.modelTimeoutException(e.modelTimeoutException):e.serviceUnavailableException!==void 0?r.serviceUnavailableException(e.serviceUnavailableException):r._(e.$unknown[0],e.$unknown[1])})(gP||(gP={}));const g8=t=>{if(t.text!==void 0)return{text:t.text};if(t.image!==void 0)return{image:jl};if(t.$unknown!==void 0)return{[t.$unknown[0]]:"UNKNOWN"}},Jue=t=>{if(t.text!==void 0)return{text:t.text};if(t.image!==void 0)return{image:t.image};if(t.document!==void 0)return{document:t.document};if(t.video!==void 0)return{video:t.video};if(t.toolUse!==void 0)return{toolUse:t.toolUse};if(t.toolResult!==void 0)return{toolResult:t.toolResult};if(t.guardContent!==void 0)return{guardContent:g8(t.guardContent)};if(t.$unknown!==void 0)return{[t.$unknown[0]]:"UNKNOWN"}},qC=t=>({...t,...t.content&&{content:t.content.map(e=>Jue(e))}}),_8=t=>{if(t.text!==void 0)return{text:t.text};if(t.guardContent!==void 0)return{guardContent:g8(t.guardContent)};if(t.$unknown!==void 0)return{[t.$unknown[0]]:"UNKNOWN"}},Que=t=>({...t,...t.messages&&{messages:t.messages.map(e=>qC(e))},...t.system&&{system:t.system.map(e=>_8(e))},...t.toolConfig&&{toolConfig:t.toolConfig},...t.promptVariables&&{promptVariables:jl},...t.requestMetadata&&{requestMetadata:jl}}),ehe=t=>{if(t.message!==void 0)return{message:qC(t.message)};if(t.$unknown!==void 0)return{[t.$unknown[0]]:"UNKNOWN"}},the=t=>({...t,...t.output&&{output:ehe(t.output)}}),rhe=t=>({...t,...t.messages&&{messages:t.messages.map(e=>qC(e))},...t.system&&{system:t.system.map(e=>_8(e))},...t.toolConfig&&{toolConfig:t.toolConfig},...t.promptVariables&&{promptVariables:jl},...t.requestMetadata&&{requestMetadata:jl}}),nhe=t=>({...t,...t.stream&&{stream:"STREAMING_CONTENT"}}),she=t=>({...t,...t.body&&{body:jl}}),ihe=t=>({...t,...t.body&&{body:jl}}),ohe=async(t,e)=>{const r=kC(t,e),n={"content-type":"application/json"};r.bp("/model/{modelId}/converse"),r.p("modelId",()=>t.modelId,"{modelId}",!1);let s;return s=JSON.stringify(ut(t,{additionalModelRequestFields:i=>Tp(i),additionalModelResponseFieldPaths:i=>gt(i),guardrailConfig:i=>gt(i),inferenceConfig:i=>C8(i),messages:i=>k8(i,e),performanceConfig:i=>gt(i),promptVariables:i=>gt(i),requestMetadata:i=>gt(i),system:i=>A8(i,e),toolConfig:i=>R8(i)})),r.m("POST").h(n).b(s),r.build()},ahe=async(t,e)=>{const r=kC(t,e),n={"content-type":"application/json"};r.bp("/model/{modelId}/converse-stream"),r.p("modelId",()=>t.modelId,"{modelId}",!1);let s;return s=JSON.stringify(ut(t,{additionalModelRequestFields:i=>Tp(i),additionalModelResponseFieldPaths:i=>gt(i),guardrailConfig:i=>gt(i),inferenceConfig:i=>C8(i),messages:i=>k8(i,e),performanceConfig:i=>gt(i),promptVariables:i=>gt(i),requestMetadata:i=>gt(i),system:i=>A8(i,e),toolConfig:i=>R8(i)})),r.m("POST").h(n).b(s),r.build()},lhe=async(t,e)=>{const r=kC(t,e),n=Vr({},nle,{[B8]:t[M8]||"application/octet-stream",[_P]:t[_P],[Sde]:t[wde],[Ede]:t[bde],[xde]:t[vde],[j8]:t[F8]});r.bp("/model/{modelId}/invoke"),r.p("modelId",()=>t.modelId,"{modelId}",!1);let s;return t.body!==void 0&&(s=t.body),r.m("POST").h(n).b(s),r.build()},che=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return KC(t,e);const r=Vr({$metadata:vn(t)}),n=Vae(Z5(await ss(t.body,e)),"body"),s=ut(n,{additionalModelResponseFields:i=>rb(i),metrics:gt,output:i=>Zhe($a(i),e),performanceConfig:gt,stopReason:At,trace:i=>ede(i),usage:gt});return Object.assign(r,s),r},uhe=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return KC(t,e);const r=Vr({$metadata:vn(t)}),n=t.body;return r.stream=vhe(n,e),r},hhe=async(t,e)=>{if(t.statusCode!==200&&t.statusCode>=300)return KC(t,e);const r=Vr({$metadata:vn(t),[M8]:[,t.headers[B8]],[F8]:[,t.headers[j8]]}),n=await P5(t.body,e);return r.body=n,r},KC=async(t,e)=>{const r={...t,body:await lle(t.body,e)},n=cle(t,r.body);switch(n){case"AccessDeniedException":case"com.amazonaws.bedrockruntime#AccessDeniedException":throw await fhe(r);case"InternalServerException":case"com.amazonaws.bedrockruntime#InternalServerException":throw await y8(r);case"ResourceNotFoundException":case"com.amazonaws.bedrockruntime#ResourceNotFoundException":throw await yhe(r);case"ServiceQuotaExceededException":case"com.amazonaws.bedrockruntime#ServiceQuotaExceededException":throw await bhe(r);case"ThrottlingException":case"com.amazonaws.bedrockruntime#ThrottlingException":throw await w8(r);case"ValidationException":case"com.amazonaws.bedrockruntime#ValidationException":throw await E8(r);case"ModelErrorException":case"com.amazonaws.bedrockruntime#ModelErrorException":throw await mhe(r);case"ModelNotReadyException":case"com.amazonaws.bedrockruntime#ModelNotReadyException":throw await ghe(r);case"ModelTimeoutException":case"com.amazonaws.bedrockruntime#ModelTimeoutException":throw await _he(r);case"ServiceUnavailableException":case"com.amazonaws.bedrockruntime#ServiceUnavailableException":throw await v8(r);case"ModelStreamErrorException":case"com.amazonaws.bedrockruntime#ModelStreamErrorException":throw await b8(r);case"ConflictException":case"com.amazonaws.bedrockruntime#ConflictException":throw await phe(r);default:const s=r.body;return dhe({output:t,parsedBody:s,errorCode:n})}},dhe=Kae(bn),fhe=async(t,e)=>{const r=Vr({}),n=t.body,s=ut(n,{message:At});Object.assign(r,s);const i=new NC({$metadata:vn(t),...r});return ns(i,t.body)},phe=async(t,e)=>{const r=Vr({}),n=t.body,s=ut(n,{message:At});Object.assign(r,s);const i=new jC({$metadata:vn(t),...r});return ns(i,t.body)},y8=async(t,e)=>{const r=Vr({}),n=t.body,s=ut(n,{message:At});Object.assign(r,s);const i=new MC({$metadata:vn(t),...r});return ns(i,t.body)},mhe=async(t,e)=>{const r=Vr({}),n=t.body,s=ut(n,{message:At,originalStatusCode:X5,resourceName:At});Object.assign(r,s);const i=new zC({$metadata:vn(t),...r});return ns(i,t.body)},ghe=async(t,e)=>{const r=Vr({}),n=t.body,s=ut(n,{message:At});Object.assign(r,s);const i=new VC({$metadata:vn(t),...r});return ns(i,t.body)},b8=async(t,e)=>{const r=Vr({}),n=t.body,s=ut(n,{message:At,originalMessage:At,originalStatusCode:X5});Object.assign(r,s);const i=new WC({$metadata:vn(t),...r});return ns(i,t.body)},_he=async(t,e)=>{const r=Vr({}),n=t.body,s=ut(n,{message:At});Object.assign(r,s);const i=new GC({$metadata:vn(t),...r});return ns(i,t.body)},yhe=async(t,e)=>{const r=Vr({}),n=t.body,s=ut(n,{message:At});Object.assign(r,s);const i=new UC({$metadata:vn(t),...r});return ns(i,t.body)},bhe=async(t,e)=>{const r=Vr({}),n=t.body,s=ut(n,{message:At});Object.assign(r,s);const i=new $C({$metadata:vn(t),...r});return ns(i,t.body)},v8=async(t,e)=>{const r=Vr({}),n=t.body,s=ut(n,{message:At});Object.assign(r,s);const i=new HC({$metadata:vn(t),...r});return ns(i,t.body)},w8=async(t,e)=>{const r=Vr({}),n=t.body,s=ut(n,{message:At});Object.assign(r,s);const i=new BC({$metadata:vn(t),...r});return ns(i,t.body)},E8=async(t,e)=>{const r=Vr({}),n=t.body,s=ut(n,{message:At});Object.assign(r,s);const i=new FC({$metadata:vn(t),...r});return ns(i,t.body)},vhe=(t,e)=>e.eventStreamMarshaller.deserialize(t,async r=>r.messageStart!=null?{messageStart:await Che(r.messageStart,e)}:r.contentBlockStart!=null?{contentBlockStart:await Ehe(r.contentBlockStart,e)}:r.contentBlockDelta!=null?{contentBlockDelta:await whe(r.contentBlockDelta,e)}:r.contentBlockStop!=null?{contentBlockStop:await xhe(r.contentBlockStop,e)}:r.messageStop!=null?{messageStop:await khe(r.messageStop,e)}:r.metadata!=null?{metadata:await She(r.metadata,e)}:r.internalServerException!=null?{internalServerException:await The(r.internalServerException,e)}:r.modelStreamErrorException!=null?{modelStreamErrorException:await Ahe(r.modelStreamErrorException,e)}:r.validationException!=null?{validationException:await Phe(r.validationException,e)}:r.throttlingException!=null?{throttlingException:await Ihe(r.throttlingException,e)}:r.serviceUnavailableException!=null?{serviceUnavailableException:await Rhe(r.serviceUnavailableException,e)}:{$unknown:t}),whe=async(t,e)=>{const r={},n=await ss(t.body,e);return Object.assign(r,gt(n)),r},Ehe=async(t,e)=>{const r={},n=await ss(t.body,e);return Object.assign(r,gt(n)),r},xhe=async(t,e)=>{const r={},n=await ss(t.body,e);return Object.assign(r,gt(n)),r},She=async(t,e)=>{const r={},n=await ss(t.body,e);return Object.assign(r,Jhe(n)),r},The=async(t,e)=>{const r={...t,body:await ss(t.body,e)};return y8(r)},Che=async(t,e)=>{const r={},n=await ss(t.body,e);return Object.assign(r,gt(n)),r},khe=async(t,e)=>{const r={},n=await ss(t.body,e);return Object.assign(r,fde(n)),r},Ahe=async(t,e)=>{const r={...t,body:await ss(t.body,e)};return b8(r)},Rhe=async(t,e)=>{const r={...t,body:await ss(t.body,e)};return v8(r)},Ihe=async(t,e)=>{const r={...t,body:await ss(t.body,e)};return w8(r)},Phe=async(t,e)=>{const r={...t,body:await ss(t.body,e)};return E8(r)},Ohe=(t,e)=>ox.visit(t,{document:r=>({document:x8(r,e)}),guardContent:r=>({guardContent:S8(r,e)}),image:r=>({image:T8(r,e)}),text:r=>({text:r}),toolResult:r=>({toolResult:Hhe(r,e)}),toolUse:r=>({toolUse:qhe(r)}),video:r=>({video:I8(r,e)}),_:(r,n)=>({name:n})}),Dhe=(t,e)=>t.filter(r=>r!=null).map(r=>Ohe(r,e)),x8=(t,e)=>ut(t,{format:[],name:[],source:r=>Lhe(r,e)}),Lhe=(t,e)=>ex.visit(t,{bytes:r=>({bytes:e.base64Encoder(r)}),_:(r,n)=>({name:n})}),S8=(t,e)=>rx.visit(t,{image:r=>({image:Nhe(r,e)}),text:r=>({text:gt(r)}),_:(r,n)=>({name:n})}),Nhe=(t,e)=>ut(t,{format:[],source:r=>Mhe(r,e)}),Mhe=(t,e)=>tx.visit(t,{bytes:r=>({bytes:e.base64Encoder(r)}),_:(r,n)=>({name:n})}),T8=(t,e)=>ut(t,{format:[],source:r=>Bhe(r,e)}),Bhe=(t,e)=>nx.visit(t,{bytes:r=>({bytes:e.base64Encoder(r)}),_:(r,n)=>({name:n})}),C8=(t,e)=>ut(t,{maxTokens:[],stopSequences:gt,temperature:NI,topP:NI}),Fhe=(t,e)=>ut(t,{content:r=>Dhe(r,e),role:[]}),k8=(t,e)=>t.filter(r=>r!=null).map(r=>Fhe(r,e)),jhe=(t,e)=>ax.visit(t,{guardContent:r=>({guardContent:S8(r,e)}),text:r=>({text:r}),_:(r,n)=>({name:n})}),A8=(t,e)=>t.filter(r=>r!=null).map(r=>jhe(r,e)),Uhe=(t,e)=>cx.visit(t,{toolSpec:r=>({toolSpec:Whe(r)}),_:(r,n)=>({name:n})}),R8=(t,e)=>ut(t,{toolChoice:gt,tools:r=>Ghe(r)}),$he=(t,e)=>lx.visit(t,{json:r=>({json:Tp(r)}),_:(r,n)=>({name:n})}),Hhe=(t,e)=>ut(t,{content:r=>Vhe(r,e),status:[],toolUseId:[]}),zhe=(t,e)=>ix.visit(t,{document:r=>({document:x8(r,e)}),image:r=>({image:T8(r,e)}),json:r=>({json:Tp(r)}),text:r=>({text:r}),video:r=>({video:I8(r,e)}),_:(r,n)=>({name:n})}),Vhe=(t,e)=>t.filter(r=>r!=null).map(r=>zhe(r,e)),Ghe=(t,e)=>t.filter(r=>r!=null).map(r=>Uhe(r)),Whe=(t,e)=>ut(t,{description:[],inputSchema:r=>$he(r),name:[]}),qhe=(t,e)=>ut(t,{input:r=>Tp(r),name:[],toolUseId:[]}),I8=(t,e)=>ut(t,{format:[],source:r=>Khe(r,e)}),Khe=(t,e)=>sx.visit(t,{bytes:r=>({bytes:e.base64Encoder(r)}),s3Location:r=>({s3Location:gt(r)}),_:(r,n)=>({name:n})}),Tp=(t,e)=>t,Yhe=(t,e)=>t.document!=null?{document:P8(t.document,e)}:t.guardContent!=null?{guardContent:lde($a(t.guardContent),e)}:t.image!=null?{image:L8(t.image,e)}:At(t.text)!==void 0?{text:At(t.text)}:t.toolResult!=null?{toolResult:pde(t.toolResult,e)}:t.toolUse!=null?{toolUse:_de(t.toolUse)}:t.video!=null?{video:N8(t.video,e)}:{$unknown:Object.entries(t)[0]},Xhe=(t,e)=>(t||[]).filter(n=>n!=null).map(n=>Yhe($a(n),e)),Zhe=(t,e)=>t.message!=null?{message:dde(t.message,e)}:{$unknown:Object.entries(t)[0]},Jhe=(t,e)=>ut(t,{metrics:gt,performanceConfig:gt,trace:r=>Qhe(r),usage:gt}),Qhe=(t,e)=>ut(t,{guardrail:r=>D8(r),promptRouter:gt}),ede=(t,e)=>ut(t,{guardrail:r=>D8(r),promptRouter:gt}),P8=(t,e)=>ut(t,{format:At,name:At,source:r=>tde($a(r),e)}),tde=(t,e)=>t.bytes!=null?{bytes:e.base64Decoder(t.bytes)}:{$unknown:Object.entries(t)[0]},O8=(t,e)=>ut(t,{contentPolicy:gt,contextualGroundingPolicy:r=>ade(r),invocationMetrics:gt,sensitiveInformationPolicy:gt,topicPolicy:gt,wordPolicy:gt}),rde=(t,e)=>(t||[]).filter(n=>n!=null).map(n=>O8(n)),nde=(t,e)=>Object.entries(t).reduce((r,[n,s])=>(s===null||(r[n]=rde(s)),r),{}),sde=(t,e)=>Object.entries(t).reduce((r,[n,s])=>(s===null||(r[n]=O8(s)),r),{}),ide=(t,e)=>ut(t,{action:At,score:LI,threshold:LI,type:At}),ode=(t,e)=>(t||[]).filter(n=>n!=null).map(n=>ide(n)),ade=(t,e)=>ut(t,{filters:r=>ode(r)}),lde=(t,e)=>t.image!=null?{image:cde(t.image,e)}:t.text!=null?{text:gt(t.text)}:{$unknown:Object.entries(t)[0]},cde=(t,e)=>ut(t,{format:At,source:r=>ude($a(r),e)}),ude=(t,e)=>t.bytes!=null?{bytes:e.base64Decoder(t.bytes)}:{$unknown:Object.entries(t)[0]},D8=(t,e)=>ut(t,{inputAssessment:r=>sde(r),modelOutput:gt,outputAssessments:r=>nde(r)}),L8=(t,e)=>ut(t,{format:At,source:r=>hde($a(r),e)}),hde=(t,e)=>t.bytes!=null?{bytes:e.base64Decoder(t.bytes)}:{$unknown:Object.entries(t)[0]},dde=(t,e)=>ut(t,{content:r=>Xhe(r,e),role:At}),fde=(t,e)=>ut(t,{additionalModelResponseFields:r=>rb(r),stopReason:At}),pde=(t,e)=>ut(t,{content:r=>gde(r,e),status:At,toolUseId:At}),mde=(t,e)=>t.document!=null?{document:P8(t.document,e)}:t.image!=null?{image:L8(t.image,e)}:t.json!=null?{json:rb(t.json)}:At(t.text)!==void 0?{text:At(t.text)}:t.video!=null?{video:N8(t.video,e)}:{$unknown:Object.entries(t)[0]},gde=(t,e)=>(t||[]).filter(n=>n!=null).map(n=>mde($a(n),e)),_de=(t,e)=>ut(t,{input:r=>rb(r),name:At,toolUseId:At}),N8=(t,e)=>ut(t,{format:At,source:r=>yde($a(r),e)}),yde=(t,e)=>t.bytes!=null?{bytes:e.base64Decoder(t.bytes)}:t.s3Location!=null?{s3Location:gt(t.s3Location)}:{$unknown:Object.entries(t)[0]},rb=(t,e)=>t,vn=t=>({httpStatusCode:t.statusCode,requestId:t.headers["x-amzn-requestid"]??t.headers["x-amzn-request-id"]??t.headers["x-amz-request-id"],extendedRequestId:t.headers["x-amz-id-2"],cfId:t.headers["x-amz-cf-id"]}),_P="accept",M8="contentType",B8="content-type",bde="guardrailIdentifier",vde="guardrailVersion",F8="performanceConfigLatency",wde="trace",Ede="x-amzn-bedrock-guardrailidentifier",xde="x-amzn-bedrock-guardrailversion",j8="x-amzn-bedrock-performanceconfig-latency",Sde="x-amzn-bedrock-trace";class Tde extends eb.classBuilder().ep(DC).m(function(e,r,n,s){return[TC(n,this.serialize,this.deserialize),PC(n,e.getEndpointParameterInstructions())]}).s("AmazonBedrockFrontendService","Converse",{}).n("BedrockRuntimeClient","ConverseCommand").f(Que,the).ser(ohe).de(che).build(){}class Cde extends eb.classBuilder().ep(DC).m(function(e,r,n,s){return[TC(n,this.serialize,this.deserialize),PC(n,e.getEndpointParameterInstructions())]}).s("AmazonBedrockFrontendService","ConverseStream",{eventStream:{output:!0}}).n("BedrockRuntimeClient","ConverseStreamCommand").f(rhe,nhe).ser(ahe).de(uhe).build(){}class kde extends eb.classBuilder().ep(DC).m(function(e,r,n,s){return[TC(n,this.serialize,this.deserialize),PC(n,e.getEndpointParameterInstructions())]}).s("AmazonBedrockFrontendService","InvokeModel",{}).n("BedrockRuntimeClient","InvokeModelCommand").f(she,ihe).ser(lhe).de(hhe).build(){}function Ade(t){var e;const r=(e=t.tools)!=null&&e.length?t.tools:void 0;if(r==null)return{toolConfig:{tools:void 0,toolChoice:void 0},toolWarnings:[]};const n=[],s=[];for(const a of r)a.type==="provider-defined"?n.push({type:"unsupported-tool",tool:a}):s.push({toolSpec:{name:a.name,description:a.description,inputSchema:{json:a.parameters}}});const i=t.toolChoice;if(i==null)return{toolConfig:{tools:s,toolChoice:void 0},toolWarnings:n};const o=i.type;switch(o){case"auto":return{toolConfig:{tools:s,toolChoice:{auto:{}}},toolWarnings:n};case"required":return{toolConfig:{tools:s,toolChoice:{any:{}}},toolWarnings:n};case"none":return{toolConfig:{tools:void 0,toolChoice:void 0},toolWarnings:n};case"tool":return{toolConfig:{tools:s,toolChoice:{tool:{name:i.toolName}}},toolWarnings:n};default:{const a=o;throw new wd({functionality:`Unsupported tool choice type: ${a}`})}}}var Rde=T5({prefix:"file",size:16});function Ide(t){var e,r,n,s,i;const o=Pde(t);let a;const l=[];for(let c=0;c<o.length;c++){const u=o[c],h=c===o.length-1,d=u.type;switch(d){case"system":{if(l.length>0)throw new wd({functionality:"Multiple system messages that are separated by user/assistant messages"});a=u.messages.map(({content:f})=>f).join(`
`);break}case"user":{const f=[];for(const g of u.messages){const{role:_,content:m}=g;switch(_){case"user":{for(let p=0;p<m.length;p++){const y=m[p];switch(y.type){case"text":{f.push({text:y.text});break}case"image":{if(y.image instanceof URL)throw new wd({functionality:"Image URLs in user messages"});f.push({image:{format:(r=(e=y.mimeType)==null?void 0:e.split("/"))==null?void 0:r[1],source:{bytes:(n=y.image)!=null?n:y.image}}});break}case"file":{if(y.data instanceof URL)throw new wd({functionality:"File URLs in user messages"});f.push({document:{format:(i=(s=y.mimeType)==null?void 0:s.split("/"))==null?void 0:i[1],name:Rde(),source:{bytes:Ue.from(y.data,"base64")}}});break}}}break}case"tool":{for(let p=0;p<m.length;p++){const y=m[p];f.push({toolResult:{toolUseId:y.toolCallId,content:[{text:JSON.stringify(y.result)}]}})}break}default:{const p=_;throw new Error(`Unsupported role: ${p}`)}}}l.push({role:"user",content:f});break}case"assistant":{const f=[];for(let g=0;g<u.messages.length;g++){const _=u.messages[g],m=g===u.messages.length-1,{content:p}=_;for(let y=0;y<p.length;y++){const b=p[y],v=y===p.length-1;switch(b.type){case"text":{f.push({text:h&&m&&v?b.text.trim():b.text});break}case"tool-call":{f.push({toolUse:{toolUseId:b.toolCallId,name:b.toolName,input:b.args}});break}}}}l.push({role:"assistant",content:f});break}default:{const f=d;throw new Error(`Unsupported type: ${f}`)}}}return{system:a,messages:l}}function Pde(t){const e=[];let r;for(const n of t){const{role:s}=n;switch(s){case"system":{r?.type!=="system"&&(r={type:"system",messages:[]},e.push(r)),r.messages.push(n);break}case"assistant":{r?.type!=="assistant"&&(r={type:"assistant",messages:[]},e.push(r)),r.messages.push(n);break}case"user":{r?.type!=="user"&&(r={type:"user",messages:[]},e.push(r)),r.messages.push(n);break}case"tool":{r?.type!=="user"&&(r={type:"user",messages:[]},e.push(r)),r.messages.push(n);break}default:{const i=s;throw new Error(`Unsupported role: ${i}`)}}}return e}function yP(t){switch(t){case"stop_sequence":case"end_turn":return"stop";case"max_tokens":return"length";case"content_filtered":case"guardrail_intervened":return"content-filter";case"tool_use":return"tool-calls";default:return"unknown"}}var Ode=class{constructor(t,e,r){this.specificationVersion="v1",this.provider="amazon-bedrock",this.defaultObjectGenerationMode="tool",this.supportsImageUrls=!1,this.modelId=t,this.settings=e,this.config=r}getArgs({mode:t,prompt:e,maxTokens:r,temperature:n,topP:s,topK:i,frequencyPenalty:o,presencePenalty:a,stopSequences:l,responseFormat:c,seed:u,providerMetadata:h,headers:d}){var f,g;const _=t.type,m=[];o!=null&&m.push({type:"unsupported-setting",setting:"frequencyPenalty"}),a!=null&&m.push({type:"unsupported-setting",setting:"presencePenalty"}),u!=null&&m.push({type:"unsupported-setting",setting:"seed"}),d!=null&&m.push({type:"unsupported-setting",setting:"headers"}),i!=null&&m.push({type:"unsupported-setting",setting:"topK"}),c!=null&&c.type!=="text"&&m.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{system:p,messages:y}=Ide(e),b={modelId:this.modelId,system:p?[{text:p}]:void 0,additionalModelRequestFields:this.settings.additionalModelRequestFields,inferenceConfig:{maxTokens:r,temperature:n,topP:s,stopSequences:l},messages:y,guardrailConfig:(f=h?.bedrock)==null?void 0:f.guardrailConfig};switch(_){case"regular":{const{toolConfig:v,toolWarnings:w}=Ade(t);return{command:{...b,...(g=v.tools)!=null&&g.length?{toolConfig:v}:{}},warnings:[...m,...w]}}case"object-json":throw new wd({functionality:"json-mode object generation"});case"object-tool":return{command:{...b,toolConfig:{tools:[{toolSpec:{name:t.tool.name,description:t.tool.description,inputSchema:{json:t.tool.parameters}}}],toolChoice:{tool:{name:t.tool.name}}}},warnings:m};default:{const v=_;throw new Error(`Unsupported type: ${v}`)}}}async doGenerate(t){var e,r,n,s,i,o,a,l,c,u,h,d;const{command:f,warnings:g}=this.getArgs(t),_=await this.config.client.send(new Tde(f)),{messages:m,...p}=f,y=_.trace?{bedrock:{trace:_.trace}}:void 0;return{text:(s=(n=(r=(e=_.output)==null?void 0:e.message)==null?void 0:r.content)==null?void 0:n.map(b=>{var v;return(v=b.text)!=null?v:""}).join(""))!=null?s:void 0,toolCalls:(l=(a=(o=(i=_.output)==null?void 0:i.message)==null?void 0:o.content)==null?void 0:a.filter(b=>!!b.toolUse))==null?void 0:l.map(b=>{var v,w,E,S,x,C;return{toolCallType:"function",toolCallId:(w=(v=b.toolUse)==null?void 0:v.toolUseId)!=null?w:this.config.generateId(),toolName:(S=(E=b.toolUse)==null?void 0:E.name)!=null?S:`tool-${this.config.generateId()}`,args:JSON.stringify((C=(x=b.toolUse)==null?void 0:x.input)!=null?C:"")}}),finishReason:yP(_.stopReason),usage:{promptTokens:(u=(c=_.usage)==null?void 0:c.inputTokens)!=null?u:Number.NaN,completionTokens:(d=(h=_.usage)==null?void 0:h.outputTokens)!=null?d:Number.NaN},rawCall:{rawPrompt:m,rawSettings:p},warnings:g,providerMetadata:y}}async doStream(t){const{command:e,warnings:r}=this.getArgs(t),n=await this.config.client.send(new Cde(e)),{messages:s,...i}=e;let o="unknown",a={promptTokens:Number.NaN,completionTokens:Number.NaN},l;if(!n.stream)throw new Error("No stream found");const c=new ReadableStream({async start(h){for await(const d of n.stream)h.enqueue({success:!0,value:d});h.close()}}),u={};return{stream:c.pipeThrough(new TransformStream({transform(h,d){var f,g,_,m,p,y,b,v,w;function E(M){o="error",d.enqueue({type:"error",error:M})}if(!h.success){E(h.error);return}const S=h.value;if(S.internalServerException){E(S.internalServerException);return}if(S.modelStreamErrorException){E(S.modelStreamErrorException);return}if(S.throttlingException){E(S.throttlingException);return}if(S.validationException){E(S.validationException);return}S.messageStop&&(o=yP(S.messageStop.stopReason)),S.metadata&&(a={promptTokens:(g=(f=S.metadata.usage)==null?void 0:f.inputTokens)!=null?g:Number.NaN,completionTokens:(m=(_=S.metadata.usage)==null?void 0:_.outputTokens)!=null?m:Number.NaN},S.metadata.trace&&(l={bedrock:{trace:S.metadata.trace}})),(y=(p=S.contentBlockDelta)==null?void 0:p.delta)!=null&&y.text&&d.enqueue({type:"text-delta",textDelta:S.contentBlockDelta.delta.text});const x=S.contentBlockStart;if(((b=x?.start)==null?void 0:b.toolUse)!=null){const M=x.start.toolUse;u[x.contentBlockIndex]={toolCallId:M.toolUseId,toolName:M.name,jsonText:""}}const C=S.contentBlockDelta;if((v=C?.delta)!=null&&v.toolUse){const M=u[C.contentBlockIndex],P=(w=C.delta.toolUse.input)!=null?w:"";d.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:M.toolCallId,toolName:M.toolName,argsTextDelta:P}),M.jsonText+=P}const A=S.contentBlockStop;if(A!=null){const M=A.contentBlockIndex,P=u[M];P!=null&&(d.enqueue({type:"tool-call",toolCallType:"function",toolCallId:P.toolCallId,toolName:P.toolName,args:P.jsonText}),delete u[M])}},flush(h){h.enqueue({type:"finish",finishReason:o,usage:a,providerMetadata:l})}})),rawCall:{rawPrompt:s,rawSettings:i},warnings:r}}},Dde=class{constructor(t,e,r){this.specificationVersion="v1",this.provider="amazon-bedrock",this.maxEmbeddingsPerCall=void 0,this.supportsParallelCalls=!0,this.modelId=t,this.config=r,this.settings=e}async doEmbed({values:t}){const e=async s=>{const i={inputText:s,dimensions:this.settings.dimensions,normalize:this.settings.normalize},o=new kde({contentType:"application/json",body:JSON.stringify(i),modelId:this.modelId}),a=await this.config.client.send(o);return JSON.parse(new TextDecoder().decode(a.body))};return(await Promise.all(t.map(e))).reduce((s,i)=>(s.embeddings.push(i.embedding),s.usage.tokens+=i.inputTextTokenCount,s),{embeddings:[],usage:{tokens:0}})}};function U8(t={}){const e=()=>{var i;return new Zue((i=t.bedrockOptions)!=null?i:{region:Vv({settingValue:t.region,settingName:"region",environmentVariableName:"AWS_REGION",description:"AWS region"}),credentials:{accessKeyId:Vv({settingValue:t.accessKeyId,settingName:"accessKeyId",environmentVariableName:"AWS_ACCESS_KEY_ID",description:"AWS access key ID"}),secretAccessKey:Vv({settingValue:t.secretAccessKey,settingName:"secretAccessKey",environmentVariableName:"AWS_SECRET_ACCESS_KEY",description:"AWS secret access key"}),sessionToken:Hie({settingValue:t.sessionToken,environmentVariableName:"AWS_SESSION_TOKEN"})}})},r=(i,o={})=>new Ode(i,o,{client:e(),generateId:$ie}),n=function(i,o){if(new.target)throw new Error("The Amazon Bedrock model function cannot be called with the new keyword.");return r(i,o)},s=(i,o={})=>new Dde(i,o,{client:e()});return n.languageModel=r,n.embedding=s,n.textEmbedding=s,n.textEmbeddingModel=s,n}U8();class Lde extends Ir{name="AmazonBedrock";getApiKeyLink="https://console.aws.amazon.com/iam/home";config={apiTokenKey:"AWS_BEDROCK_CONFIG"};staticModels=[{name:"anthropic.claude-3-5-sonnet-20240620-v1:0",label:"Claude 3.5 Sonnet (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:4096},{name:"anthropic.claude-3-sonnet-20240229-v1:0",label:"Claude 3 Sonnet (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:4096},{name:"anthropic.claude-3-haiku-20240307-v1:0",label:"Claude 3 Haiku (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:4096},{name:"amazon.nova-pro-v1:0",label:"Amazon Nova Pro (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:5120},{name:"amazon.nova-lite-v1:0",label:"Amazon Nova Lite (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:5120},{name:"mistral.mistral-large-2402-v1:0",label:"Mistral Large 24.02 (Bedrock)",provider:"AmazonBedrock",maxTokenAllowed:8192}];_parseAndValidateConfig(e){let r;try{r=JSON.parse(e)}catch{throw new Error("Invalid AWS Bedrock configuration format. Please provide a valid JSON string containing region, accessKeyId, and secretAccessKey.")}const{region:n,accessKeyId:s,secretAccessKey:i,sessionToken:o}=r;if(!n||!s||!i)throw new Error("Missing required AWS credentials. Configuration must include region, accessKeyId, and secretAccessKey.");return{region:n,accessKeyId:s,secretAccessKey:i,...o&&{sessionToken:o}}}getModelInstance(e){const{model:r,serverEnv:n,apiKeys:s,providerSettings:i}=e,{apiKey:o}=this.getProviderBaseUrlAndKey({apiKeys:s,providerSettings:i?.[this.name],serverEnv:n,defaultBaseUrlKey:"",defaultApiTokenKey:"AWS_BEDROCK_CONFIG"});if(!o)throw new Error(`Missing API key for ${this.name} provider`);const a=this._parseAndValidateConfig(o);return U8(a)(r)}}const Nde=Object.freeze(Object.defineProperty({__proto__:null,AmazonBedrockProvider:Lde,AnthropicProvider:Ine,CohereProvider:bse,DeepseekProvider:vse,GoogleProvider:Rse,GroqProvider:Ise,HuggingFaceProvider:Pse,HyperbolicProvider:Lie,LMStudioProvider:Ose,MistralProvider:$se,OllamaProvider:rie,OpenAILikeProvider:Rie,OpenAIProvider:Iie,OpenRouterProvider:Aie,PerplexityProvider:Pie,TogetherProvider:Oie,XAIProvider:Die},Symbol.toStringTag,{value:"Module"})),ti=Fn("LLMManager");class aa{static _instance;_providers=new Map;_modelList=[];_env={};constructor(e){this._registerProvidersFromDirectory(),this._env=e}static getInstance(e={}){return aa._instance||(aa._instance=new aa(e)),aa._instance}get env(){return this._env}async _registerProvidersFromDirectory(){try{for(const e of Object.values(Nde))if(typeof e=="function"&&e.prototype instanceof Ir){const r=new e;try{this.registerProvider(r)}catch(n){ti.warn("Failed To Register Provider: ",r.name,"error:",n.message)}}}catch(e){ti.error("Error registering providers:",e)}}registerProvider(e){if(this._providers.has(e.name)){ti.warn(`Provider ${e.name} is already registered. Skipping.`);return}ti.info("Registering Provider: ",e.name),this._providers.set(e.name,e),this._modelList=[...this._modelList,...e.staticModels]}getProvider(e){return this._providers.get(e)}getAllProviders(){return Array.from(this._providers.values())}getModelList(){return this._modelList}async updateModelList(e){const{apiKeys:r,providerSettings:n,serverEnv:s}=e;let i=Array.from(this._providers.values()).map(l=>l.name);n&&(i=i.filter(l=>n[l].enabled));const a=[...(await Promise.all(Array.from(this._providers.values()).filter(l=>i.includes(l.name)).filter(l=>!!l.getDynamicModels).map(async l=>{const c=l.getModelsFromCache(e);return c||await l.getDynamicModels(r,n?.[l.name],s).then(h=>(ti.info(`Caching ${h.length} dynamic models for ${l.name}`),l.storeDynamicModels(e,h),h)).catch(h=>(ti.error(`Error getting dynamic models ${l.name} :`,h),[]))}))).flat(),...Array.from(this._providers.values()).flatMap(l=>l.staticModels||[])];return this._modelList=a,a}getStaticModelList(){return[...this._providers.values()].flatMap(e=>e.staticModels||[])}async getModelListFromProvider(e,r){const n=this._providers.get(e.name);if(!n)throw new Error(`Provider ${e.name} not found`);const s=n.staticModels||[];if(!n.getDynamicModels)return s;const{apiKeys:i,providerSettings:o,serverEnv:a}=r,l=n.getModelsFromCache({apiKeys:i,providerSettings:o,serverEnv:a});return l?(ti.info(`Found ${l.length} cached models for ${n.name}`),[...l,...s]):(ti.info(`Getting dynamic models for ${n.name}`),[...await n.getDynamicModels?.(i,o?.[n.name],a).then(u=>(ti.info(`Got ${u.length} dynamic models for ${n.name}`),n.storeDynamicModels(r,u),u)).catch(u=>(ti.error(`Error getting dynamic models ${n.name} :`,u),[])),...s])}getStaticModelListFromProvider(e){const r=this._providers.get(e.name);if(!r)throw new Error(`Provider ${e.name} not found`);return[...r.staticModels||[]]}getDefaultProvider(){const e=this._providers.values().next().value;if(!e)throw new Error("No providers registered");return e}}const Mde={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},$8="project",ya=`/home/${$8}`,Qv="Terretacode_file_modifications",Bde=/^\[Model: (.*?)\]\n\n/,Fde=/\[Provider: (.*?)\]\n\n/,jde="claude-3-5-sonnet-latest",ew="cachedPrompt",nb=aa.getInstance(Mde),sb=nb.getAllProviders(),Ude=nb.getDefaultProvider();let ux=nb.getModelList();const YC={};sb.forEach(t=>{YC[t.name]={baseUrlKey:t.config.baseUrlKey,apiTokenKey:t.config.apiTokenKey}});async function $de(t){return await nb.updateModelList(t)}async function Hde(t){const{providerSettings:e,apiKeys:r,env:n}=t,s=await $de({apiKeys:r,providerSettings:e,serverEnv:n});return ux=s||ux,s}const XC=[{name:"Terretacode-astro-basic",label:"Astro Basic",description:"Lightweight Astro starter template for building fast static websites",githubRepo:"thecodacus/Terretacode-astro-basic-template",tags:["astro","blog","performance"],icon:"i-Terretacode:astro"},{name:"Terretacode-nextjs-shadcn",label:"Next.js with shadcn/ui",description:"Next.js starter fullstack template integrated with shadcn/ui components and styling system",githubRepo:"thecodacus/Terretacode-nextjs-shadcn-template",tags:["nextjs","react","typescript","shadcn","tailwind"],icon:"i-Terretacode:nextjs"},{name:"Terretacode-qwik-ts",label:"Qwik TypeScript",description:"Qwik framework starter with TypeScript for building resumable applications",githubRepo:"thecodacus/Terretacode-qwik-ts-template",tags:["qwik","typescript","performance","resumable"],icon:"i-Terretacode:qwik"},{name:"Terretacode-remix-ts",label:"Remix TypeScript",description:"Remix framework starter with TypeScript for full-stack web applications",githubRepo:"thecodacus/Terretacode-remix-ts-template",tags:["remix","typescript","fullstack","react"],icon:"i-Terretacode:remix"},{name:"Terretacode-slidev",label:"Slidev Presentation",description:"Slidev starter template for creating developer-friendly presentations using Markdown",githubRepo:"thecodacus/Terretacode-slidev-template",tags:["slidev","presentation","markdown"],icon:"i-Terretacode:slidev"},{name:"Terretacode-sveltekit",label:"SvelteKit",description:"SvelteKit starter template for building fast, efficient web applications",githubRepo:"Terretacode-sveltekit-template",tags:["svelte","sveltekit","typescript"],icon:"i-Terretacode:svelte"},{name:"vanilla-vite",label:"Vanilla + Vite",description:"Minimal Vite starter template for vanilla JavaScript projects",githubRepo:"thecodacus/vanilla-vite-template",tags:["vite","vanilla-js","minimal"],icon:"i-Terretacode:vite"},{name:"Terretacode-vite-react",label:"React + Vite + typescript",description:"React starter template powered by Vite for fast development experience",githubRepo:"thecodacus/Terretacode-vite-react-ts-template",tags:["react","vite","frontend"],icon:"i-Terretacode:react"},{name:"Terretacode-vite-ts",label:"Vite + TypeScript",description:"Vite starter template with TypeScript configuration for type-safe development",githubRepo:"thecodacus/Terretacode-vite-ts-template",tags:["vite","typescript","minimal"],icon:"i-Terretacode:typescript"},{name:"Terretacode-vue",label:"Vue.js",description:"Vue.js starter template with modern tooling and best practices",githubRepo:"thecodacus/Terretacode-vue-template",tags:["vue","typescript","frontend"],icon:"i-Terretacode:vue"},{name:"Terretacode-angular",label:"Angular Starter",description:"A modern Angular starter template with TypeScript support and best practices configuration",githubRepo:"thecodacus/Terretacode-angular-template",tags:["angular","typescript","frontend","spa"],icon:"i-Terretacode:angular"}];function zde(t){const e=r=>{if(!/^https?:\/\/[^\/]+\.webcontainer-api\.io(\/.*)?$/.test(r))return r;const s=/^https?:\/\/[^\/]+\.webcontainer-api\.io\/(.*?)$/;return r.match(s)?.[1]||""};return t.split(`
`).map(r=>r.replace(/(https?:\/\/[^\/]+\.webcontainer-api\.io\/[^\s\)]+)/g,n=>e(n))).join(`
`)}let ol=new Promise(()=>{});ol=Promise.resolve().then(()=>hl.boot({coep:"credentialless",workdirName:$8,forwardPreviewErrors:!0})).then(async t=>{const{workbenchStore:e}=await Z(async()=>{const{workbenchStore:r}=await Promise.resolve().then(()=>Ape);return{workbenchStore:r}},void 0);return t.on("preview-message",r=>{if(console.log("WebContainer preview message:",r),r.type==="PREVIEW_UNCAUGHT_EXCEPTION"||r.type==="PREVIEW_UNHANDLED_REJECTION"){const n=r.type==="PREVIEW_UNHANDLED_REJECTION";e.actionAlert.set({type:"preview",title:n?"Unhandled Promise Rejection":"Uncaught Exception",description:r.message,content:`Error occurred at ${r.pathname}${r.search}${r.hash}
Port: ${r.port}

Stack trace:
${zde(r.stack||"")}`,source:"preview"})}}),t});class Vde{#t;selectedFile=vr();documents=rc({});currentDocument=xT([this.documents,this.selectedFile],(e,r)=>{if(r)return e[r]});constructor(e){this.#t=e}setDocuments(e){const r=this.documents.value;this.documents.set(Object.fromEntries(Object.entries(e).map(([n,s])=>{if(s===void 0||s.type==="folder")return;const i=r?.[n];return[n,{value:s.content,filePath:n,scroll:i?.scroll}]}).filter(Boolean)))}setSelectedFile(e){this.selectedFile.set(e)}updateScrollPosition(e,r){const s=this.documents.get()[e];s&&this.documents.setKey(e,{...s,scroll:r})}updateFile(e,r){const s=this.documents.get()[e];if(!s)return;s.value!==r&&this.documents.setKey(e,{...s,value:r})}}function Zg(t,e){if(!t)return null;const r="utf8",n="binary",s=e?.chunkLength??24;let i=e?.chunkBegin??0;if(e?.chunkBegin==null){let o=Zg(t,{chunkLength:s,chunkBegin:i});return o===r&&(i=Math.max(0,Math.floor(t.length/2)-s),o=Zg(t,{chunkLength:s,chunkBegin:i}),o===r&&(i=Math.max(0,t.length-s),o=Zg(t,{chunkLength:s,chunkBegin:i}))),o}else{if(i=Gde(t,i),i===-1)return n;const o=Wde(t,Math.min(t.length,i+s));if(o>t.length)return n;const a=t.toString(r,i,o);for(let l=0;l<a.length;++l){const c=a.charCodeAt(l);if(c===65533||c<=8)return n}return r}}function Gde(t,e){if(e===0)return 0;if(!qde(t[e]))return e;let r=e-3;return r>=0&&ru(t[r])||(r=e-2,r>=0&&(ru(t[r])||l_(t[r])))||(r=e-1,r>=0&&(ru(t[r])||l_(t[r])||H8(t[r])))?r:-1}function Wde(t,e){if(e===t.length)return e;let r=e-3;if(r>=0&&ru(t[r]))return e+1;if(r=e-2,r>=0){if(ru(t[r]))return e+2;if(l_(t[r]))return e+1}if(r=e-1,r>=0){if(ru(t[r]))return e+3;if(l_(t[r]))return e+2;if(H8(t[r]))return e+1}return e}function ru(t){return t>>3===30}function l_(t){return t>>4===14}function H8(t){return t>>5===6}function qde(t){return t>>6===2}function Kde(t,e){let r,n=[],s=Promise.resolve();const i=()=>{r=self.setTimeout(async()=>{await s,n.length>0&&(s=Promise.resolve(e(n))),r=void 0,n=[]},t)};return(...o)=>{n.push(o),r||i()}}function Ha(){}Ha.prototype={diff:function(e,r){var n,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=s.callback;typeof s=="function"&&(i=s,s={}),this.options=s;var o=this;function a(v){return i?(setTimeout(function(){i(void 0,v)},0),!0):v}e=this.castInput(e),r=this.castInput(r),e=this.removeEmpty(this.tokenize(e)),r=this.removeEmpty(this.tokenize(r));var l=r.length,c=e.length,u=1,h=l+c;s.maxEditLength&&(h=Math.min(h,s.maxEditLength));var d=(n=s.timeout)!==null&&n!==void 0?n:1/0,f=Date.now()+d,g=[{oldPos:-1,lastComponent:void 0}],_=this.extractCommon(g[0],r,e,0);if(g[0].oldPos+1>=c&&_+1>=l)return a([{value:this.join(r),count:r.length}]);var m=-1/0,p=1/0;function y(){for(var v=Math.max(m,-u);v<=Math.min(p,u);v+=2){var w=void 0,E=g[v-1],S=g[v+1];E&&(g[v-1]=void 0);var x=!1;if(S){var C=S.oldPos-v;x=S&&0<=C&&C<l}var A=E&&E.oldPos+1<c;if(!x&&!A){g[v]=void 0;continue}if(!A||x&&E.oldPos+1<S.oldPos?w=o.addToPath(S,!0,void 0,0):w=o.addToPath(E,void 0,!0,1),_=o.extractCommon(w,r,e,v),w.oldPos+1>=c&&_+1>=l)return a(Yde(o,w.lastComponent,r,e,o.useLongestToken));g[v]=w,w.oldPos+1>=c&&(p=Math.min(p,v-1)),_+1>=l&&(m=Math.max(m,v+1))}u++}if(i)(function v(){setTimeout(function(){if(u>h||Date.now()>f)return i();y()||v()},0)})();else for(;u<=h&&Date.now()<=f;){var b=y();if(b)return b}},addToPath:function(e,r,n,s){var i=e.lastComponent;return i&&i.added===r&&i.removed===n?{oldPos:e.oldPos+s,lastComponent:{count:i.count+1,added:r,removed:n,previousComponent:i.previousComponent}}:{oldPos:e.oldPos+s,lastComponent:{count:1,added:r,removed:n,previousComponent:i}}},extractCommon:function(e,r,n,s){for(var i=r.length,o=n.length,a=e.oldPos,l=a-s,c=0;l+1<i&&a+1<o&&this.equals(r[l+1],n[a+1]);)l++,a++,c++;return c&&(e.lastComponent={count:c,previousComponent:e.lastComponent}),e.oldPos=a,l},equals:function(e,r){return this.options.comparator?this.options.comparator(e,r):e===r||this.options.ignoreCase&&e.toLowerCase()===r.toLowerCase()},removeEmpty:function(e){for(var r=[],n=0;n<e.length;n++)e[n]&&r.push(e[n]);return r},castInput:function(e){return e},tokenize:function(e){return e.split("")},join:function(e){return e.join("")}};function Yde(t,e,r,n,s){for(var i=[],o;e;)i.push(e),o=e.previousComponent,delete e.previousComponent,e=o;i.reverse();for(var a=0,l=i.length,c=0,u=0;a<l;a++){var h=i[a];if(h.removed){if(h.value=t.join(n.slice(u,u+h.count)),u+=h.count,a&&i[a-1].added){var f=i[a-1];i[a-1]=i[a],i[a]=f}}else{if(!h.added&&s){var d=r.slice(c,c+h.count);d=d.map(function(_,m){var p=n[u+m];return p.length>_.length?p:_}),h.value=t.join(d)}else h.value=t.join(r.slice(c,c+h.count));c+=h.count,h.added||(u+=h.count)}}var g=i[l-1];return l>1&&typeof g.value=="string"&&(g.added||g.removed)&&t.equals("",g.value)&&(i[l-2].value+=g.value,i.pop()),i}var bP=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,vP=/\S/,z8=new Ha;z8.equals=function(t,e){return this.options.ignoreCase&&(t=t.toLowerCase(),e=e.toLowerCase()),t===e||this.options.ignoreWhitespace&&!vP.test(t)&&!vP.test(e)};z8.tokenize=function(t){for(var e=t.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),r=0;r<e.length-1;r++)!e[r+1]&&e[r+2]&&bP.test(e[r])&&bP.test(e[r+2])&&(e[r]+=e[r+2],e.splice(r+1,2),r--);return e};var ZC=new Ha;ZC.tokenize=function(t){this.options.stripTrailingCr&&(t=t.replace(/\r\n/g,`
`));var e=[],r=t.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var n=0;n<r.length;n++){var s=r[n];n%2&&!this.options.newlineIsToken?e[e.length-1]+=s:(this.options.ignoreWhitespace&&(s=s.trim()),e.push(s))}return e};function Xde(t,e,r){return ZC.diff(t,e,r)}var Zde=new Ha;Zde.tokenize=function(t){return t.split(/(\S.+?[.!?])(?=\s+|$)/)};var Jde=new Ha;Jde.tokenize=function(t){return t.split(/([{}:;,]|\s+)/)};function Jg(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Jg=function(e){return typeof e}:Jg=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jg(t)}function tw(t){return Qde(t)||efe(t)||tfe(t)||rfe()}function Qde(t){if(Array.isArray(t))return hx(t)}function efe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function tfe(t,e){if(t){if(typeof t=="string")return hx(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hx(t,e)}}function hx(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function rfe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var nfe=Object.prototype.toString,vf=new Ha;vf.useLongestToken=!0;vf.tokenize=ZC.tokenize;vf.castInput=function(t){var e=this.options,r=e.undefinedReplacement,n=e.stringifyReplacer,s=n===void 0?function(i,o){return typeof o>"u"?r:o}:n;return typeof t=="string"?t:JSON.stringify(dx(t,null,null,s),s,"  ")};vf.equals=function(t,e){return Ha.prototype.equals.call(vf,t.replace(/,([\r\n])/g,"$1"),e.replace(/,([\r\n])/g,"$1"))};function dx(t,e,r,n,s){e=e||[],r=r||[],n&&(t=n(s,t));var i;for(i=0;i<e.length;i+=1)if(e[i]===t)return r[i];var o;if(nfe.call(t)==="[object Array]"){for(e.push(t),o=new Array(t.length),r.push(o),i=0;i<t.length;i+=1)o[i]=dx(t[i],e,r,n,s);return e.pop(),r.pop(),o}if(t&&t.toJSON&&(t=t.toJSON()),Jg(t)==="object"&&t!==null){e.push(t),o={},r.push(o);var a=[],l;for(l in t)t.hasOwnProperty(l)&&a.push(l);for(a.sort(),i=0;i<a.length;i+=1)l=a[i],o[l]=dx(t[l],e,r,n,l);e.pop(),r.pop()}else o=t;return o}var fx=new Ha;fx.tokenize=function(t){return t.slice()};fx.join=fx.removeEmpty=function(t){return t};function sfe(t,e,r,n,s,i,o){o||(o={}),typeof o.context>"u"&&(o.context=4);var a=Xde(r,n,o);if(!a)return;a.push({value:"",lines:[]});function l(p){return p.map(function(y){return" "+y})}for(var c=[],u=0,h=0,d=[],f=1,g=1,_=function(y){var b=a[y],v=b.lines||b.value.replace(/\n$/,"").split(`
`);if(b.lines=v,b.added||b.removed){var w;if(!u){var E=a[y-1];u=f,h=g,E&&(d=o.context>0?l(E.lines.slice(-o.context)):[],u-=d.length,h-=d.length)}(w=d).push.apply(w,tw(v.map(function(R){return(b.added?"+":"-")+R}))),b.added?g+=v.length:f+=v.length}else{if(u)if(v.length<=o.context*2&&y<a.length-2){var S;(S=d).push.apply(S,tw(l(v)))}else{var x,C=Math.min(v.length,o.context);(x=d).push.apply(x,tw(l(v.slice(0,C))));var A={oldStart:u,oldLines:f-u+C,newStart:h,newLines:g-h+C,lines:d};if(y>=a.length-2&&v.length<=o.context){var M=/\n$/.test(r),P=/\n$/.test(n),D=v.length==0&&d.length>A.oldLines;!M&&D&&r.length>0&&d.splice(A.oldLines,0,"\\ No newline at end of file"),(!M&&!D||!P)&&d.push("\\ No newline at end of file")}c.push(A),u=0,h=0,d=[]}f+=v.length,g+=v.length}},m=0;m<a.length;m++)_(m);return{oldFileName:t,newFileName:e,oldHeader:s,newHeader:i,hunks:c}}function V8(t){if(Array.isArray(t))return t.map(V8).join(`
`);var e=[];t.oldFileName==t.newFileName&&e.push("Index: "+t.oldFileName),e.push("==================================================================="),e.push("--- "+t.oldFileName+(typeof t.oldHeader>"u"?"":"	"+t.oldHeader)),e.push("+++ "+t.newFileName+(typeof t.newHeader>"u"?"":"	"+t.newHeader));for(var r=0;r<t.hunks.length;r++){var n=t.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),e.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@"),e.push.apply(e,n.lines)}return e.join(`
`)+`
`}function ife(t,e,r,n,s,i,o){return V8(sfe(t,e,r,n,s,i,o))}function ofe(t,e){const r={};let n=!1;for(const[s,i]of e){const o=t[s];if(o?.type!=="file")continue;const a=afe(s,i,o.content);a&&(n=!0,a.length>o.content.length?r[s]={type:"file",content:o.content}:r[s]={type:"diff",content:a})}if(n)return r}function afe(t,e,r){let n=ife(t,t,e,r);const s=`--- ${t}
+++ ${t}
`,i=n.indexOf(s);if(i>=0&&(n=n.slice(i+s.length)),n!=="")return n}const lfe=new RegExp(`^${ya}/`);function rw(t){return t.replace(lfe,"")}const wP=Fn("FilesStore"),cfe=new TextDecoder("utf8",{fatal:!0});class ufe{#t;#r=0;#e=new Map;files=rc({});get filesCount(){return this.#r}constructor(e){this.#t=e,this.#n()}getFile(e){const r=this.files.get()[e];if(r?.type==="file")return r}getFileModifications(){return ofe(this.files.get(),this.#e)}resetFileModifications(){this.#e.clear()}async saveFile(e,r){const n=await this.#t;try{const s=Pe.relative(n.workdir,e);if(!s)throw new Error(`EINVAL: invalid file path, write '${s}'`);const i=this.getFile(e)?.content;i||Os("Expected content to be defined"),await n.fs.writeFile(s,r),this.#e.has(e)||this.#e.set(e,i),this.files.setKey(e,{type:"file",content:r,isBinary:!1}),wP.info("File updated")}catch(s){throw wP.error(`Failed to update file content

`,s),s}}async#n(){(await this.#t).internal.watchPaths({include:[`${ya}/**`],exclude:["**/node_modules",".git"],includeContent:!0},Kde(100,this.#i.bind(this)))}#i(e){const r=e.flat(2);for(const{type:n,path:s,buffer:i}of r){const o=s.replace(/\/+$/g,"");switch(n){case"add_dir":{this.files.setKey(o,{type:"folder"});break}case"remove_dir":{this.files.setKey(o,void 0);for(const[a]of Object.entries(this.files))a.startsWith(o)&&this.files.setKey(a,void 0);break}case"add_file":case"change":{n==="add_file"&&this.#r++;let a="";const l=hfe(i);l||(a=this.#s(i)),this.files.setKey(o,{type:"file",content:a,isBinary:l});break}case"remove_file":{this.#r--,this.files.setKey(o,void 0);break}}}}#s(e){if(!e||e.byteLength===0)return"";try{return cfe.decode(e)}catch(r){return console.log(r),""}}}function hfe(t){return t===void 0?!1:Zg(dfe(t),{chunkLength:100})==="binary"}function dfe(t){return s4.from(t.buffer,t.byteOffset,t.byteLength)}class ffe{#t=new Map;#r;previews=vr([]);constructor(e){this.#r=e,this.#e()}async#e(){(await this.#r).on("port",(r,n,s)=>{let i=this.#t.get(r);if(n==="close"&&i){this.#t.delete(r),this.previews.set(this.previews.get().filter(a=>a.port!==r));return}const o=this.previews.get();i||(i={port:r,ready:n==="open",baseUrl:s},this.#t.set(r,i),o.push(i)),i.ready=n==="open",i.baseUrl=s,this.previews.set([...o])})}}function G8(){if(typeof Promise.withResolvers=="function")return Promise.withResolvers();let t,e;const r=new Promise((n,s)=>{t=n,e=s});return{resolve:t,reject:e,promise:r}}async function pfe(t,e){const r=[],n=await t.spawn("/bin/jsh",["--osc",...r],{terminal:{cols:e.cols??80,rows:e.rows??15}}),s=n.input.getWriter(),i=n.output,o=G8();let a=!1;return i.pipeTo(new WritableStream({write(l){if(!a){const[,c]=l.match(/\x1b\]654;([^\x07]+)\x07/)||[];c==="interactive"&&(a=!0,o.resolve())}e.write(l)}})),e.onData(l=>{a&&s.write(l)}),await o.promise,n}class mfe{#t;#r;#e;#n;#i;executionState=vr();#s;#o;constructor(){this.#r=new Promise(e=>{this.#t=e})}ready(){return this.#r}async init(e,r){this.#e=e,this.#n=r;const{process:n,output:s}=await this.newTerretacodeShellProcess(e,r);this.#i=n,this.#s=s.getReader(),await this.waitTillOscCode("interactive"),this.#t?.()}get terminal(){return this.#n}get process(){return this.#i}async executeCommand(e,r,n){if(!this.process||!this.terminal)return;const s=this.executionState.get();s?.active&&s.abort&&s.abort(),this.terminal.input(""),await this.waitTillOscCode("prompt"),s&&s.executionPrms&&await s.executionPrms,this.terminal.input(r.trim()+`
`);const i=this.getCurrentExecutionResult();this.executionState.set({sessionId:e,active:!0,executionPrms:i,abort:n});const o=await i;if(this.executionState.set({sessionId:e,active:!1}),o)try{o.output=gfe(o.output)}catch(a){console.log("failed to format terminal output",a)}return o}async newTerretacodeShellProcess(e,r){const n=[],s=await e.spawn("/bin/jsh",["--osc",...n],{terminal:{cols:r.cols??80,rows:r.rows??15}}),i=s.input.getWriter();this.#o=i;const[o,a]=s.output.tee(),l=G8();let c=!1;return a.pipeTo(new WritableStream({write(u){if(!c){const[,h]=u.match(/\x1b\]654;([^\x07]+)\x07/)||[];h==="interactive"&&(c=!0,l.resolve())}r.write(u)}})),r.onData(u=>{c&&i.write(u)}),await l.promise,{process:s,output:o}}async getCurrentExecutionResult(){const{output:e,exitCode:r}=await this.waitTillOscCode("exit");return{output:e,exitCode:r}}async waitTillOscCode(e){let r="",n=0;if(!this.#s)return{output:r,exitCode:n};const s=this.#s;for(;;){const{value:i,done:o}=await s.read();if(o)break;const a=i||"";r+=a;const[,l,,,c]=a.match(/\x1b\]654;([^\x07=]+)=?((-?\d+):(\d+))?\x07/)||[];if(l==="exit"&&(n=parseInt(c,10)),l===e)break}return{output:r,exitCode:n}}}function gfe(t){return t.replace(/\x1b\](\d+;[^\x07\x1b]*|\d+[^\x07\x1b]*)\x07/g,"").replace(/\](\d+;[^\n]*|\d+[^\n]*)/g,"").replace(/\u001b\[[\?]?[0-9;]*[a-zA-Z]/g,"").replace(/\x1b\[[\?]?[0-9;]*[a-zA-Z]/g,"").replace(/\u001b\[[0-9;]*m/g,"").replace(/\x1b\[[0-9;]*m/g,"").replace(/\u001b/g,"").replace(/\x1b/g,"").replace(/\r\n/g,`
`).replace(/\r/g,`
`).replace(/\n{3,}/g,`

`).replace(/^([~\/][^\n❯]+)❯/m,`$1
❯`).replace(/(?<!^|\n)>/g,`
>`).replace(/(?<!^|\n|\w)(error|failed|warning|Error|Failed|Warning):/g,`
$1:`).replace(/(?<!^|\n|\/)(at\s+(?!async|sync))/g,`
at `).replace(/\bat\s+async/g,"at async").replace(/(?<!^|\n)(npm ERR!)/g,`
$1`).split(`
`).map(o=>o.trim()).filter(o=>o.length>0).join(`
`).replace(/\n{3,}/g,`

`).replace(/:\s+/g,": ").replace(/\s{2,}/g," ").replace(/^\s+|\s+$/g,"").replace(/\u0000/g,"")}function _fe(){return new mfe}const W8="\x1B[0m",yfe={reset:W8,clear:"\x1B[g",red:"\x1B[1;31m"},EP={red:t=>`${yfe.red}${t}${W8}`};class bfe{#t;#r=[];#e=_fe();showTerminal=vr(!0);constructor(e){this.#t=e}get TerretacodeTerminal(){return this.#e}toggleTerminal(e){this.showTerminal.set(e!==void 0?e:!this.showTerminal.get())}async attachTerretacodeTerminal(e){try{const r=await this.#t;await this.#e.init(r,e)}catch(r){e.write(EP.red(`Failed to spawn Terretacode shell

`)+r.message);return}}async attachTerminal(e){try{const r=await pfe(await this.#t,e);this.#r.push({terminal:e,process:r})}catch(r){e.write(EP.red(`Failed to spawn shell

`)+r.message);return}}onTerminalResize(e,r){for(const{process:n}of this.#r)n.resize({cols:e,rows:r})}}function Vm(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var q8={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,s,i){function o(c,u){if(!s[c]){if(!n[c]){var h=typeof Vm=="function"&&Vm;if(!u&&h)return h(c,!0);if(a)return a(c,!0);var d=new Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d}var f=s[c]={exports:{}};n[c][0].call(f.exports,function(g){var _=n[c][1][g];return o(_||g)},f,f.exports,r,n,s,i)}return s[c].exports}for(var a=typeof Vm=="function"&&Vm,l=0;l<i.length;l++)o(i[l]);return o}({1:[function(r,n,s){var i=r("./utils"),o=r("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var c,u,h,d,f,g,_,m=[],p=0,y=l.length,b=y,v=i.getTypeOf(l)!=="string";p<l.length;)b=y-p,h=v?(c=l[p++],u=p<y?l[p++]:0,p<y?l[p++]:0):(c=l.charCodeAt(p++),u=p<y?l.charCodeAt(p++):0,p<y?l.charCodeAt(p++):0),d=c>>2,f=(3&c)<<4|u>>4,g=1<b?(15&u)<<2|h>>6:64,_=2<b?63&h:64,m.push(a.charAt(d)+a.charAt(f)+a.charAt(g)+a.charAt(_));return m.join("")},s.decode=function(l){var c,u,h,d,f,g,_=0,m=0,p="data:";if(l.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");var y,b=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&b--,l.charAt(l.length-2)===a.charAt(64)&&b--,b%1!=0)throw new Error("Invalid base64 input, bad content length.");for(y=o.uint8array?new Uint8Array(0|b):new Array(0|b);_<l.length;)c=a.indexOf(l.charAt(_++))<<2|(d=a.indexOf(l.charAt(_++)))>>4,u=(15&d)<<4|(f=a.indexOf(l.charAt(_++)))>>2,h=(3&f)<<6|(g=a.indexOf(l.charAt(_++))),y[m++]=c,f!==64&&(y[m++]=u),g!==64&&(y[m++]=h);return y}},{"./support":30,"./utils":32}],2:[function(r,n,s){var i=r("./external"),o=r("./stream/DataWorker"),a=r("./stream/Crc32Probe"),l=r("./stream/DataLengthProbe");function c(u,h,d,f,g){this.compressedSize=u,this.uncompressedSize=h,this.crc32=d,this.compression=f,this.compressedContent=g}c.prototype={getContentWorker:function(){var u=new o(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),h=this;return u.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new o(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,h,d){return u.pipe(new a).pipe(new l("uncompressedSize")).pipe(h.compressWorker(d)).pipe(new l("compressedSize")).withStreamInfo("compression",h)},n.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,n,s){var i=r("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,n,s){var i=r("./utils"),o=function(){for(var a,l=[],c=0;c<256;c++){a=c;for(var u=0;u<8;u++)a=1&a?3988292384^a>>>1:a>>>1;l[c]=a}return l}();n.exports=function(a,l){return a!==void 0&&a.length?i.getTypeOf(a)!=="string"?function(c,u,h,d){var f=o,g=d+h;c^=-1;for(var _=d;_<g;_++)c=c>>>8^f[255&(c^u[_])];return-1^c}(0|l,a,a.length,0):function(c,u,h,d){var f=o,g=d+h;c^=-1;for(var _=d;_<g;_++)c=c>>>8^f[255&(c^u.charCodeAt(_))];return-1^c}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(r,n,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(r,n,s){var i=null;i=typeof Promise<"u"?Promise:r("lie"),n.exports={Promise:i}},{lie:37}],7:[function(r,n,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=r("pako"),a=r("./utils"),l=r("./stream/GenericWorker"),c=i?"uint8array":"array";function u(h,d){l.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=d,this.meta={}}s.magic="\b\0",a.inherits(u,l),u.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(c,h.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(d){h.push({data:d,meta:h.meta})}},s.compressWorker=function(h){return new u("Deflate",h)},s.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,n,s){function i(f,g){var _,m="";for(_=0;_<g;_++)m+=String.fromCharCode(255&f),f>>>=8;return m}function o(f,g,_,m,p,y){var b,v,w=f.file,E=f.compression,S=y!==c.utf8encode,x=a.transformTo("string",y(w.name)),C=a.transformTo("string",c.utf8encode(w.name)),A=w.comment,M=a.transformTo("string",y(A)),P=a.transformTo("string",c.utf8encode(A)),D=C.length!==w.name.length,R=P.length!==A.length,G="",ee="",q="",re=w.dir,N=w.date,B={crc32:0,compressedSize:0,uncompressedSize:0};g&&!_||(B.crc32=f.crc32,B.compressedSize=f.compressedSize,B.uncompressedSize=f.uncompressedSize);var $=0;g&&($|=8),S||!D&&!R||($|=2048);var H=0,U=0;re&&(H|=16),p==="UNIX"?(U=798,H|=function(ne,ge){var J=ne;return ne||(J=ge?16893:33204),(65535&J)<<16}(w.unixPermissions,re)):(U=20,H|=function(ne){return 63&(ne||0)}(w.dosPermissions)),b=N.getUTCHours(),b<<=6,b|=N.getUTCMinutes(),b<<=5,b|=N.getUTCSeconds()/2,v=N.getUTCFullYear()-1980,v<<=4,v|=N.getUTCMonth()+1,v<<=5,v|=N.getUTCDate(),D&&(ee=i(1,1)+i(u(x),4)+C,G+="up"+i(ee.length,2)+ee),R&&(q=i(1,1)+i(u(M),4)+P,G+="uc"+i(q.length,2)+q);var Q="";return Q+=`
\0`,Q+=i($,2),Q+=E.magic,Q+=i(b,2),Q+=i(v,2),Q+=i(B.crc32,4),Q+=i(B.compressedSize,4),Q+=i(B.uncompressedSize,4),Q+=i(x.length,2),Q+=i(G.length,2),{fileRecord:h.LOCAL_FILE_HEADER+Q+x+G,dirRecord:h.CENTRAL_FILE_HEADER+i(U,2)+Q+i(M.length,2)+"\0\0\0\0"+i(H,4)+i(m,4)+x+G+M}}var a=r("../utils"),l=r("../stream/GenericWorker"),c=r("../utf8"),u=r("../crc32"),h=r("../signature");function d(f,g,_,m){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=g,this.zipPlatform=_,this.encodeFileName=m,this.streamFiles=f,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(d,l),d.prototype.push=function(f){var g=f.meta.percent||0,_=this.entriesCount,m=this._sources.length;this.accumulate?this.contentBuffer.push(f):(this.bytesWritten+=f.data.length,l.prototype.push.call(this,{data:f.data,meta:{currentFile:this.currentFile,percent:_?(g+100*(_-m-1))/_:100}}))},d.prototype.openedSource=function(f){this.currentSourceOffset=this.bytesWritten,this.currentFile=f.file.name;var g=this.streamFiles&&!f.file.dir;if(g){var _=o(f,g,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:_.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(f){this.accumulate=!1;var g=this.streamFiles&&!f.file.dir,_=o(f,g,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(_.dirRecord),g)this.push({data:function(m){return h.DATA_DESCRIPTOR+i(m.crc32,4)+i(m.compressedSize,4)+i(m.uncompressedSize,4)}(f),meta:{percent:100}});else for(this.push({data:_.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var f=this.bytesWritten,g=0;g<this.dirRecords.length;g++)this.push({data:this.dirRecords[g],meta:{percent:100}});var _=this.bytesWritten-f,m=function(p,y,b,v,w){var E=a.transformTo("string",w(v));return h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(p,2)+i(p,2)+i(y,4)+i(b,4)+i(E.length,2)+E}(this.dirRecords.length,_,f,this.zipComment,this.encodeFileName);this.push({data:m,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(f){this._sources.push(f);var g=this;return f.on("data",function(_){g.processChunk(_)}),f.on("end",function(){g.closedSource(g.previous.streamInfo),g._sources.length?g.prepareNextSource():g.end()}),f.on("error",function(_){g.error(_)}),this},d.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(f){var g=this._sources;if(!l.prototype.error.call(this,f))return!1;for(var _=0;_<g.length;_++)try{g[_].error(f)}catch{}return!0},d.prototype.lock=function(){l.prototype.lock.call(this);for(var f=this._sources,g=0;g<f.length;g++)f[g].lock()},n.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,n,s){var i=r("../compressions"),o=r("./ZipFileWorker");s.generateWorker=function(a,l,c){var u=new o(l.streamFiles,c,l.platform,l.encodeFileName),h=0;try{a.forEach(function(d,f){h++;var g=function(y,b){var v=y||b,w=i[v];if(!w)throw new Error(v+" is not a valid compression method !");return w}(f.options.compression,l.compression),_=f.options.compressionOptions||l.compressionOptions||{},m=f.dir,p=f.date;f._compressWorker(g,_).withStreamInfo("file",{name:d,dir:m,date:p,comment:f.comment||"",unixPermissions:f.unixPermissions,dosPermissions:f.dosPermissions}).pipe(u)}),u.entriesCount=h}catch(d){u.error(d)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,n,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new i;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(i.prototype=r("./object")).loadAsync=r("./load"),i.support=r("./support"),i.defaults=r("./defaults"),i.version="3.10.1",i.loadAsync=function(o,a){return new i().loadAsync(o,a)},i.external=r("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,n,s){var i=r("./utils"),o=r("./external"),a=r("./utf8"),l=r("./zipEntries"),c=r("./stream/Crc32Probe"),u=r("./nodejsUtils");function h(d){return new o.Promise(function(f,g){var _=d.decompressed.getContentWorker().pipe(new c);_.on("error",function(m){g(m)}).on("end",function(){_.streamInfo.crc32!==d.decompressed.crc32?g(new Error("Corrupted zip : CRC32 mismatch")):f()}).resume()})}n.exports=function(d,f){var g=this;return f=i.extend(f||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),u.isNode&&u.isStream(d)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",d,!0,f.optimizedBinaryString,f.base64).then(function(_){var m=new l(f);return m.load(_),m}).then(function(_){var m=[o.Promise.resolve(_)],p=_.files;if(f.checkCRC32)for(var y=0;y<p.length;y++)m.push(h(p[y]));return o.Promise.all(m)}).then(function(_){for(var m=_.shift(),p=m.files,y=0;y<p.length;y++){var b=p[y],v=b.fileNameStr,w=i.resolve(b.fileNameStr);g.file(w,b.decompressed,{binary:!0,optimizedBinaryString:!0,date:b.date,dir:b.dir,comment:b.fileCommentStr.length?b.fileCommentStr:null,unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions,createFolders:f.createFolders}),b.dir||(g.file(w).unsafeOriginalName=v)}return m.zipComment.length&&(g.comment=m.zipComment),g})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,n,s){var i=r("../utils"),o=r("../stream/GenericWorker");function a(l,c){o.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(a,o),a.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,n,s){var i=r("readable-stream").Readable;function o(a,l,c){i.call(this,l),this._helper=a;var u=this;a.on("data",function(h,d){u.push(h)||u._helper.pause(),c&&c(d)}).on("error",function(h){u.emit("error",h)}).on("end",function(){u.push(null)})}r("../utils").inherits(o,i),o.prototype._read=function(){this._helper.resume()},n.exports=o},{"../utils":32,"readable-stream":16}],14:[function(r,n,s){n.exports={isNode:typeof Ue<"u",newBufferFrom:function(i,o){if(Ue.from&&Ue.from!==Uint8Array.from)return Ue.from(i,o);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Ue(i,o)},allocBuffer:function(i){if(Ue.alloc)return Ue.alloc(i);var o=new Ue(i);return o.fill(0),o},isBuffer:function(i){return Ue.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(r,n,s){function i(w,E,S){var x,C=a.getTypeOf(E),A=a.extend(S||{},u);A.date=A.date||new Date,A.compression!==null&&(A.compression=A.compression.toUpperCase()),typeof A.unixPermissions=="string"&&(A.unixPermissions=parseInt(A.unixPermissions,8)),A.unixPermissions&&16384&A.unixPermissions&&(A.dir=!0),A.dosPermissions&&16&A.dosPermissions&&(A.dir=!0),A.dir&&(w=p(w)),A.createFolders&&(x=m(w))&&y.call(this,x,!0);var M=C==="string"&&A.binary===!1&&A.base64===!1;S&&S.binary!==void 0||(A.binary=!M),(E instanceof h&&E.uncompressedSize===0||A.dir||!E||E.length===0)&&(A.base64=!1,A.binary=!0,E="",A.compression="STORE",C="string");var P=null;P=E instanceof h||E instanceof l?E:g.isNode&&g.isStream(E)?new _(w,E):a.prepareContent(w,E,A.binary,A.optimizedBinaryString,A.base64);var D=new d(w,P,A);this.files[w]=D}var o=r("./utf8"),a=r("./utils"),l=r("./stream/GenericWorker"),c=r("./stream/StreamHelper"),u=r("./defaults"),h=r("./compressedObject"),d=r("./zipObject"),f=r("./generate"),g=r("./nodejsUtils"),_=r("./nodejs/NodejsStreamInputAdapter"),m=function(w){w.slice(-1)==="/"&&(w=w.substring(0,w.length-1));var E=w.lastIndexOf("/");return 0<E?w.substring(0,E):""},p=function(w){return w.slice(-1)!=="/"&&(w+="/"),w},y=function(w,E){return E=E!==void 0?E:u.createFolders,w=p(w),this.files[w]||i.call(this,w,null,{dir:!0,createFolders:E}),this.files[w]};function b(w){return Object.prototype.toString.call(w)==="[object RegExp]"}var v={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(w){var E,S,x;for(E in this.files)x=this.files[E],(S=E.slice(this.root.length,E.length))&&E.slice(0,this.root.length)===this.root&&w(S,x)},filter:function(w){var E=[];return this.forEach(function(S,x){w(S,x)&&E.push(x)}),E},file:function(w,E,S){if(arguments.length!==1)return w=this.root+w,i.call(this,w,E,S),this;if(b(w)){var x=w;return this.filter(function(A,M){return!M.dir&&x.test(A)})}var C=this.files[this.root+w];return C&&!C.dir?C:null},folder:function(w){if(!w)return this;if(b(w))return this.filter(function(C,A){return A.dir&&w.test(C)});var E=this.root+w,S=y.call(this,E),x=this.clone();return x.root=S.name,x},remove:function(w){w=this.root+w;var E=this.files[w];if(E||(w.slice(-1)!=="/"&&(w+="/"),E=this.files[w]),E&&!E.dir)delete this.files[w];else for(var S=this.filter(function(C,A){return A.name.slice(0,w.length)===w}),x=0;x<S.length;x++)delete this.files[S[x].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(w){var E,S={};try{if((S=a.extend(w||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=S.type.toLowerCase(),S.compression=S.compression.toUpperCase(),S.type==="binarystring"&&(S.type="string"),!S.type)throw new Error("No output type specified.");a.checkSupport(S.type),S.platform!=="darwin"&&S.platform!=="freebsd"&&S.platform!=="linux"&&S.platform!=="sunos"||(S.platform="UNIX"),S.platform==="win32"&&(S.platform="DOS");var x=S.comment||this.comment||"";E=f.generateWorker(this,S,x)}catch(C){(E=new l("error")).error(C)}return new c(E,S.type||"string",S.mimeType)},generateAsync:function(w,E){return this.generateInternalStream(w).accumulate(E)},generateNodeStream:function(w,E){return(w=w||{}).type||(w.type="nodebuffer"),this.generateInternalStream(w).toNodejsStream(E)}};n.exports=v},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,n,s){n.exports=r("stream")},{stream:void 0}],17:[function(r,n,s){var i=r("./DataReader");function o(a){i.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}r("../utils").inherits(o,i),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),c=a.charCodeAt(1),u=a.charCodeAt(2),h=a.charCodeAt(3),d=this.length-4;0<=d;--d)if(this.data[d]===l&&this.data[d+1]===c&&this.data[d+2]===u&&this.data[d+3]===h)return d-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),c=a.charCodeAt(1),u=a.charCodeAt(2),h=a.charCodeAt(3),d=this.readData(4);return l===d[0]&&c===d[1]&&u===d[2]&&h===d[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./DataReader":18}],18:[function(r,n,s){var i=r("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,c=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=a,c},readString:function(a){return i.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},n.exports=o},{"../utils":32}],19:[function(r,n,s){var i=r("./Uint8ArrayReader");function o(a){i.call(this,a)}r("../utils").inherits(o,i),o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,n,s){var i=r("./DataReader");function o(a){i.call(this,a)}r("../utils").inherits(o,i),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./DataReader":18}],21:[function(r,n,s){var i=r("./ArrayReader");function o(a){i.call(this,a)}r("../utils").inherits(o,i),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(r,n,s){var i=r("../utils"),o=r("../support"),a=r("./ArrayReader"),l=r("./StringReader"),c=r("./NodeBufferReader"),u=r("./Uint8ArrayReader");n.exports=function(h){var d=i.getTypeOf(h);return i.checkSupport(d),d!=="string"||o.uint8array?d==="nodebuffer"?new c(h):o.uint8array?new u(i.transformTo("uint8array",h)):new a(i.transformTo("array",h)):new l(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,n,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,n,s){var i=r("./GenericWorker"),o=r("../utils");function a(l){i.call(this,"ConvertWorker to "+l),this.destType=l}o.inherits(a,i),a.prototype.processChunk=function(l){this.push({data:o.transformTo(this.destType,l.data),meta:l.meta})},n.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(r,n,s){var i=r("./GenericWorker"),o=r("../crc32");function a(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(a,i),a.prototype.processChunk=function(l){this.streamInfo.crc32=o(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,n,s){var i=r("../utils"),o=r("./GenericWorker");function a(l){o.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(a,o),a.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}o.prototype.processChunk.call(this,l)},n.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(r,n,s){var i=r("../utils"),o=r("./GenericWorker");function a(l){o.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=i.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}i.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(r,n,s){function i(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var l=0;l<this._listeners[o].length;l++)this._listeners[o][l].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(l){a.processChunk(l)}),o.on("end",function(){a.end()}),o.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},n.exports=i},{}],29:[function(r,n,s){var i=r("../utils"),o=r("./ConvertWorker"),a=r("./GenericWorker"),l=r("../base64"),c=r("../support"),u=r("../external"),h=null;if(c.nodestream)try{h=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function d(g,_){return new u.Promise(function(m,p){var y=[],b=g._internalType,v=g._outputType,w=g._mimeType;g.on("data",function(E,S){y.push(E),_&&_(S)}).on("error",function(E){y=[],p(E)}).on("end",function(){try{var E=function(S,x,C){switch(S){case"blob":return i.newBlob(i.transformTo("arraybuffer",x),C);case"base64":return l.encode(x);default:return i.transformTo(S,x)}}(v,function(S,x){var C,A=0,M=null,P=0;for(C=0;C<x.length;C++)P+=x[C].length;switch(S){case"string":return x.join("");case"array":return Array.prototype.concat.apply([],x);case"uint8array":for(M=new Uint8Array(P),C=0;C<x.length;C++)M.set(x[C],A),A+=x[C].length;return M;case"nodebuffer":return Ue.concat(x);default:throw new Error("concat : unsupported type '"+S+"'")}}(b,y),w);m(E)}catch(S){p(S)}y=[]}).resume()})}function f(g,_,m){var p=_;switch(_){case"blob":case"arraybuffer":p="uint8array";break;case"base64":p="string"}try{this._internalType=p,this._outputType=_,this._mimeType=m,i.checkSupport(p),this._worker=g.pipe(new o(p)),g.lock()}catch(y){this._worker=new a("error"),this._worker.error(y)}}f.prototype={accumulate:function(g){return d(this,g)},on:function(g,_){var m=this;return g==="data"?this._worker.on(g,function(p){_.call(m,p.data,p.meta)}):this._worker.on(g,function(){i.delay(_,arguments,m)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(g){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},g)}},n.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,n,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Ue<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(i),s.blob=o.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!r("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(r,n,s){for(var i=r("./utils"),o=r("./support"),a=r("./nodejsUtils"),l=r("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function h(){l.call(this,"utf-8 decode"),this.leftOver=null}function d(){l.call(this,"utf-8 encode")}s.utf8encode=function(f){return o.nodebuffer?a.newBufferFrom(f,"utf-8"):function(g){var _,m,p,y,b,v=g.length,w=0;for(y=0;y<v;y++)(64512&(m=g.charCodeAt(y)))==55296&&y+1<v&&(64512&(p=g.charCodeAt(y+1)))==56320&&(m=65536+(m-55296<<10)+(p-56320),y++),w+=m<128?1:m<2048?2:m<65536?3:4;for(_=o.uint8array?new Uint8Array(w):new Array(w),y=b=0;b<w;y++)(64512&(m=g.charCodeAt(y)))==55296&&y+1<v&&(64512&(p=g.charCodeAt(y+1)))==56320&&(m=65536+(m-55296<<10)+(p-56320),y++),m<128?_[b++]=m:(m<2048?_[b++]=192|m>>>6:(m<65536?_[b++]=224|m>>>12:(_[b++]=240|m>>>18,_[b++]=128|m>>>12&63),_[b++]=128|m>>>6&63),_[b++]=128|63&m);return _}(f)},s.utf8decode=function(f){return o.nodebuffer?i.transformTo("nodebuffer",f).toString("utf-8"):function(g){var _,m,p,y,b=g.length,v=new Array(2*b);for(_=m=0;_<b;)if((p=g[_++])<128)v[m++]=p;else if(4<(y=c[p]))v[m++]=65533,_+=y-1;else{for(p&=y===2?31:y===3?15:7;1<y&&_<b;)p=p<<6|63&g[_++],y--;1<y?v[m++]=65533:p<65536?v[m++]=p:(p-=65536,v[m++]=55296|p>>10&1023,v[m++]=56320|1023&p)}return v.length!==m&&(v.subarray?v=v.subarray(0,m):v.length=m),i.applyFromCharCode(v)}(f=i.transformTo(o.uint8array?"uint8array":"array",f))},i.inherits(h,l),h.prototype.processChunk=function(f){var g=i.transformTo(o.uint8array?"uint8array":"array",f.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var _=g;(g=new Uint8Array(_.length+this.leftOver.length)).set(this.leftOver,0),g.set(_,this.leftOver.length)}else g=this.leftOver.concat(g);this.leftOver=null}var m=function(y,b){var v;for((b=b||y.length)>y.length&&(b=y.length),v=b-1;0<=v&&(192&y[v])==128;)v--;return v<0||v===0?b:v+c[y[v]]>b?v:b}(g),p=g;m!==g.length&&(o.uint8array?(p=g.subarray(0,m),this.leftOver=g.subarray(m,g.length)):(p=g.slice(0,m),this.leftOver=g.slice(m,g.length))),this.push({data:s.utf8decode(p),meta:f.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=h,i.inherits(d,l),d.prototype.processChunk=function(f){this.push({data:s.utf8encode(f.data),meta:f.meta})},s.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,n,s){var i=r("./support"),o=r("./base64"),a=r("./nodejsUtils"),l=r("./external");function c(_){return _}function u(_,m){for(var p=0;p<_.length;++p)m[p]=255&_.charCodeAt(p);return m}r("setimmediate"),s.newBlob=function(_,m){s.checkSupport("blob");try{return new Blob([_],{type:m})}catch{try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return p.append(_),p.getBlob(m)}catch{throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(_,m,p){var y=[],b=0,v=_.length;if(v<=p)return String.fromCharCode.apply(null,_);for(;b<v;)m==="array"||m==="nodebuffer"?y.push(String.fromCharCode.apply(null,_.slice(b,Math.min(b+p,v)))):y.push(String.fromCharCode.apply(null,_.subarray(b,Math.min(b+p,v)))),b+=p;return y.join("")},stringifyByChar:function(_){for(var m="",p=0;p<_.length;p++)m+=String.fromCharCode(_[p]);return m},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function d(_){var m=65536,p=s.getTypeOf(_),y=!0;if(p==="uint8array"?y=h.applyCanBeUsed.uint8array:p==="nodebuffer"&&(y=h.applyCanBeUsed.nodebuffer),y)for(;1<m;)try{return h.stringifyByChunk(_,p,m)}catch{m=Math.floor(m/2)}return h.stringifyByChar(_)}function f(_,m){for(var p=0;p<_.length;p++)m[p]=_[p];return m}s.applyFromCharCode=d;var g={};g.string={string:c,array:function(_){return u(_,new Array(_.length))},arraybuffer:function(_){return g.string.uint8array(_).buffer},uint8array:function(_){return u(_,new Uint8Array(_.length))},nodebuffer:function(_){return u(_,a.allocBuffer(_.length))}},g.array={string:d,array:c,arraybuffer:function(_){return new Uint8Array(_).buffer},uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return a.newBufferFrom(_)}},g.arraybuffer={string:function(_){return d(new Uint8Array(_))},array:function(_){return f(new Uint8Array(_),new Array(_.byteLength))},arraybuffer:c,uint8array:function(_){return new Uint8Array(_)},nodebuffer:function(_){return a.newBufferFrom(new Uint8Array(_))}},g.uint8array={string:d,array:function(_){return f(_,new Array(_.length))},arraybuffer:function(_){return _.buffer},uint8array:c,nodebuffer:function(_){return a.newBufferFrom(_)}},g.nodebuffer={string:d,array:function(_){return f(_,new Array(_.length))},arraybuffer:function(_){return g.nodebuffer.uint8array(_).buffer},uint8array:function(_){return f(_,new Uint8Array(_.length))},nodebuffer:c},s.transformTo=function(_,m){if(m=m||"",!_)return m;s.checkSupport(_);var p=s.getTypeOf(m);return g[p][_](m)},s.resolve=function(_){for(var m=_.split("/"),p=[],y=0;y<m.length;y++){var b=m[y];b==="."||b===""&&y!==0&&y!==m.length-1||(b===".."?p.pop():p.push(b))}return p.join("/")},s.getTypeOf=function(_){return typeof _=="string"?"string":Object.prototype.toString.call(_)==="[object Array]"?"array":i.nodebuffer&&a.isBuffer(_)?"nodebuffer":i.uint8array&&_ instanceof Uint8Array?"uint8array":i.arraybuffer&&_ instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(_){if(!i[_.toLowerCase()])throw new Error(_+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(_){var m,p,y="";for(p=0;p<(_||"").length;p++)y+="\\x"+((m=_.charCodeAt(p))<16?"0":"")+m.toString(16).toUpperCase();return y},s.delay=function(_,m,p){setImmediate(function(){_.apply(p||null,m||[])})},s.inherits=function(_,m){function p(){}p.prototype=m.prototype,_.prototype=new p},s.extend=function(){var _,m,p={};for(_=0;_<arguments.length;_++)for(m in arguments[_])Object.prototype.hasOwnProperty.call(arguments[_],m)&&p[m]===void 0&&(p[m]=arguments[_][m]);return p},s.prepareContent=function(_,m,p,y,b){return l.Promise.resolve(m).then(function(v){return i.blob&&(v instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(v))!==-1)&&typeof FileReader<"u"?new l.Promise(function(w,E){var S=new FileReader;S.onload=function(x){w(x.target.result)},S.onerror=function(x){E(x.target.error)},S.readAsArrayBuffer(v)}):v}).then(function(v){var w=s.getTypeOf(v);return w?(w==="arraybuffer"?v=s.transformTo("uint8array",v):w==="string"&&(b?v=o.decode(v):p&&y!==!0&&(v=function(E){return u(E,i.uint8array?new Uint8Array(E.length):new Array(E.length))}(v))),v):l.Promise.reject(new Error("Can't read the data of '"+_+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,n,s){var i=r("./reader/readerFor"),o=r("./utils"),a=r("./signature"),l=r("./zipEntry"),c=r("./support");function u(h){this.files=[],this.loadOptions=h}u.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var d=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(d)+", expected "+o.pretty(h)+")")}},isSignature:function(h,d){var f=this.reader.index;this.reader.setIndex(h);var g=this.reader.readString(4)===d;return this.reader.setIndex(f),g},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),d=c.uint8array?"uint8array":"array",f=o.transformTo(d,h);this.zipComment=this.loadOptions.decodeFileName(f)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,d,f,g=this.zip64EndOfCentralSize-44;0<g;)h=this.reader.readInt(2),d=this.reader.readInt(4),f=this.reader.readData(d),this.zip64ExtensibleData[h]={id:h,length:d,value:f}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,d;for(h=0;h<this.files.length;h++)d=this.files[h],this.reader.setIndex(d.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),d.readLocalPart(this.reader),d.handleUTF8(),d.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(h=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);var d=h;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var f=this.centralDirOffset+this.centralDirSize;this.zip64&&(f+=20,f+=12+this.zip64EndOfCentralSize);var g=d-f;if(0<g)this.isSignature(d,a.CENTRAL_FILE_HEADER)||(this.reader.zero=g);else if(g<0)throw new Error("Corrupted zip: missing "+Math.abs(g)+" bytes.")},prepareReader:function(h){this.reader=i(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,n,s){var i=r("./reader/readerFor"),o=r("./utils"),a=r("./compressedObject"),l=r("./crc32"),c=r("./utf8"),u=r("./compressions"),h=r("./support");function d(f,g){this.options=f,this.loadOptions=g}d.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(f){var g,_;if(f.skip(22),this.fileNameLength=f.readInt(2),_=f.readInt(2),this.fileName=f.readData(this.fileNameLength),f.skip(_),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((g=function(m){for(var p in u)if(Object.prototype.hasOwnProperty.call(u,p)&&u[p].magic===m)return u[p];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,g,f.readData(this.compressedSize))},readCentralPart:function(f){this.versionMadeBy=f.readInt(2),f.skip(2),this.bitFlag=f.readInt(2),this.compressionMethod=f.readString(2),this.date=f.readDate(),this.crc32=f.readInt(4),this.compressedSize=f.readInt(4),this.uncompressedSize=f.readInt(4);var g=f.readInt(2);if(this.extraFieldsLength=f.readInt(2),this.fileCommentLength=f.readInt(2),this.diskNumberStart=f.readInt(2),this.internalFileAttributes=f.readInt(2),this.externalFileAttributes=f.readInt(4),this.localHeaderOffset=f.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");f.skip(g),this.readExtraFields(f),this.parseZIP64ExtraField(f),this.fileComment=f.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var f=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),f==0&&(this.dosPermissions=63&this.externalFileAttributes),f==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var f=i(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=f.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=f.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=f.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=f.readInt(4))}},readExtraFields:function(f){var g,_,m,p=f.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});f.index+4<p;)g=f.readInt(2),_=f.readInt(2),m=f.readData(_),this.extraFields[g]={id:g,length:_,value:m};f.setIndex(p)},handleUTF8:function(){var f=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var g=this.findExtraFieldUnicodePath();if(g!==null)this.fileNameStr=g;else{var _=o.transformTo(f,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(_)}var m=this.findExtraFieldUnicodeComment();if(m!==null)this.fileCommentStr=m;else{var p=o.transformTo(f,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(p)}}},findExtraFieldUnicodePath:function(){var f=this.extraFields[28789];if(f){var g=i(f.value);return g.readInt(1)!==1||l(this.fileName)!==g.readInt(4)?null:c.utf8decode(g.readData(f.length-5))}return null},findExtraFieldUnicodeComment:function(){var f=this.extraFields[25461];if(f){var g=i(f.value);return g.readInt(1)!==1||l(this.fileComment)!==g.readInt(4)?null:c.utf8decode(g.readData(f.length-5))}return null}},n.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,n,s){function i(g,_,m){this.name=g,this.dir=m.dir,this.date=m.date,this.comment=m.comment,this.unixPermissions=m.unixPermissions,this.dosPermissions=m.dosPermissions,this._data=_,this._dataBinary=m.binary,this.options={compression:m.compression,compressionOptions:m.compressionOptions}}var o=r("./stream/StreamHelper"),a=r("./stream/DataWorker"),l=r("./utf8"),c=r("./compressedObject"),u=r("./stream/GenericWorker");i.prototype={internalStream:function(g){var _=null,m="string";try{if(!g)throw new Error("No output type specified.");var p=(m=g.toLowerCase())==="string"||m==="text";m!=="binarystring"&&m!=="text"||(m="string"),_=this._decompressWorker();var y=!this._dataBinary;y&&!p&&(_=_.pipe(new l.Utf8EncodeWorker)),!y&&p&&(_=_.pipe(new l.Utf8DecodeWorker))}catch(b){(_=new u("error")).error(b)}return new o(_,m,"")},async:function(g,_){return this.internalStream(g).accumulate(_)},nodeStream:function(g,_){return this.internalStream(g||"nodebuffer").toNodejsStream(_)},_compressWorker:function(g,_){if(this._data instanceof c&&this._data.compression.magic===g.magic)return this._data.getCompressedWorker();var m=this._decompressWorker();return this._dataBinary||(m=m.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(m,g,_)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new a(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<h.length;f++)i.prototype[h[f]]=d;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,n,s){(function(i){var o,a,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,u=new l(g),h=i.document.createTextNode("");u.observe(h,{characterData:!0}),o=function(){h.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)o="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var _=i.document.createElement("script");_.onreadystatechange=function(){g(),_.onreadystatechange=null,_.parentNode.removeChild(_),_=null},i.document.documentElement.appendChild(_)}:function(){setTimeout(g,0)};else{var d=new i.MessageChannel;d.port1.onmessage=g,o=function(){d.port2.postMessage(0)}}var f=[];function g(){var _,m;a=!0;for(var p=f.length;p;){for(m=f,f=[],_=-1;++_<p;)m[_]();p=f.length}a=!1}n.exports=function(_){f.push(_)!==1||a||o()}}).call(this,typeof hn<"u"?hn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,n,s){var i=r("immediate");function o(){}var a={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function h(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,p!==o&&_(this,p)}function d(p,y,b){this.promise=p,typeof y=="function"&&(this.onFulfilled=y,this.callFulfilled=this.otherCallFulfilled),typeof b=="function"&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function f(p,y,b){i(function(){var v;try{v=y(b)}catch(w){return a.reject(p,w)}v===p?a.reject(p,new TypeError("Cannot resolve promise with itself")):a.resolve(p,v)})}function g(p){var y=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof y=="function")return function(){y.apply(p,arguments)}}function _(p,y){var b=!1;function v(S){b||(b=!0,a.reject(p,S))}function w(S){b||(b=!0,a.resolve(p,S))}var E=m(function(){y(w,v)});E.status==="error"&&v(E.value)}function m(p,y){var b={};try{b.value=p(y),b.status="success"}catch(v){b.status="error",b.value=v}return b}(n.exports=h).prototype.finally=function(p){if(typeof p!="function")return this;var y=this.constructor;return this.then(function(b){return y.resolve(p()).then(function(){return b})},function(b){return y.resolve(p()).then(function(){throw b})})},h.prototype.catch=function(p){return this.then(null,p)},h.prototype.then=function(p,y){if(typeof p!="function"&&this.state===c||typeof y!="function"&&this.state===l)return this;var b=new this.constructor(o);return this.state!==u?f(b,this.state===c?p:y,this.outcome):this.queue.push(new d(b,p,y)),b},d.prototype.callFulfilled=function(p){a.resolve(this.promise,p)},d.prototype.otherCallFulfilled=function(p){f(this.promise,this.onFulfilled,p)},d.prototype.callRejected=function(p){a.reject(this.promise,p)},d.prototype.otherCallRejected=function(p){f(this.promise,this.onRejected,p)},a.resolve=function(p,y){var b=m(g,y);if(b.status==="error")return a.reject(p,b.value);var v=b.value;if(v)_(p,v);else{p.state=c,p.outcome=y;for(var w=-1,E=p.queue.length;++w<E;)p.queue[w].callFulfilled(y)}return p},a.reject=function(p,y){p.state=l,p.outcome=y;for(var b=-1,v=p.queue.length;++b<v;)p.queue[b].callRejected(y);return p},h.resolve=function(p){return p instanceof this?p:a.resolve(new this(o),p)},h.reject=function(p){var y=new this(o);return a.reject(y,p)},h.all=function(p){var y=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=p.length,v=!1;if(!b)return this.resolve([]);for(var w=new Array(b),E=0,S=-1,x=new this(o);++S<b;)C(p[S],S);return x;function C(A,M){y.resolve(A).then(function(P){w[M]=P,++E!==b||v||(v=!0,a.resolve(x,w))},function(P){v||(v=!0,a.reject(x,P))})}},h.race=function(p){var y=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var b=p.length,v=!1;if(!b)return this.resolve([]);for(var w=-1,E=new this(o);++w<b;)S=p[w],y.resolve(S).then(function(x){v||(v=!0,a.resolve(E,x))},function(x){v||(v=!0,a.reject(E,x))});var S;return E}},{immediate:36}],38:[function(r,n,s){var i={};(0,r("./lib/utils/common").assign)(i,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,n,s){var i=r("./zlib/deflate"),o=r("./utils/common"),a=r("./utils/strings"),l=r("./zlib/messages"),c=r("./zlib/zstream"),u=Object.prototype.toString,h=0,d=-1,f=0,g=8;function _(p){if(!(this instanceof _))return new _(p);this.options=o.assign({level:d,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},p||{});var y=this.options;y.raw&&0<y.windowBits?y.windowBits=-y.windowBits:y.gzip&&0<y.windowBits&&y.windowBits<16&&(y.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var b=i.deflateInit2(this.strm,y.level,y.method,y.windowBits,y.memLevel,y.strategy);if(b!==h)throw new Error(l[b]);if(y.header&&i.deflateSetHeader(this.strm,y.header),y.dictionary){var v;if(v=typeof y.dictionary=="string"?a.string2buf(y.dictionary):u.call(y.dictionary)==="[object ArrayBuffer]"?new Uint8Array(y.dictionary):y.dictionary,(b=i.deflateSetDictionary(this.strm,v))!==h)throw new Error(l[b]);this._dict_set=!0}}function m(p,y){var b=new _(y);if(b.push(p,!0),b.err)throw b.msg||l[b.err];return b.result}_.prototype.push=function(p,y){var b,v,w=this.strm,E=this.options.chunkSize;if(this.ended)return!1;v=y===~~y?y:y===!0?4:0,typeof p=="string"?w.input=a.string2buf(p):u.call(p)==="[object ArrayBuffer]"?w.input=new Uint8Array(p):w.input=p,w.next_in=0,w.avail_in=w.input.length;do{if(w.avail_out===0&&(w.output=new o.Buf8(E),w.next_out=0,w.avail_out=E),(b=i.deflate(w,v))!==1&&b!==h)return this.onEnd(b),!(this.ended=!0);w.avail_out!==0&&(w.avail_in!==0||v!==4&&v!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(w.output,w.next_out))):this.onData(o.shrinkBuf(w.output,w.next_out)))}while((0<w.avail_in||w.avail_out===0)&&b!==1);return v===4?(b=i.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===h):v!==2||(this.onEnd(h),!(w.avail_out=0))},_.prototype.onData=function(p){this.chunks.push(p)},_.prototype.onEnd=function(p){p===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},s.Deflate=_,s.deflate=m,s.deflateRaw=function(p,y){return(y=y||{}).raw=!0,m(p,y)},s.gzip=function(p,y){return(y=y||{}).gzip=!0,m(p,y)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,n,s){var i=r("./zlib/inflate"),o=r("./utils/common"),a=r("./utils/strings"),l=r("./zlib/constants"),c=r("./zlib/messages"),u=r("./zlib/zstream"),h=r("./zlib/gzheader"),d=Object.prototype.toString;function f(_){if(!(this instanceof f))return new f(_);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},_||{});var m=this.options;m.raw&&0<=m.windowBits&&m.windowBits<16&&(m.windowBits=-m.windowBits,m.windowBits===0&&(m.windowBits=-15)),!(0<=m.windowBits&&m.windowBits<16)||_&&_.windowBits||(m.windowBits+=32),15<m.windowBits&&m.windowBits<48&&!(15&m.windowBits)&&(m.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var p=i.inflateInit2(this.strm,m.windowBits);if(p!==l.Z_OK)throw new Error(c[p]);this.header=new h,i.inflateGetHeader(this.strm,this.header)}function g(_,m){var p=new f(m);if(p.push(_,!0),p.err)throw p.msg||c[p.err];return p.result}f.prototype.push=function(_,m){var p,y,b,v,w,E,S=this.strm,x=this.options.chunkSize,C=this.options.dictionary,A=!1;if(this.ended)return!1;y=m===~~m?m:m===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof _=="string"?S.input=a.binstring2buf(_):d.call(_)==="[object ArrayBuffer]"?S.input=new Uint8Array(_):S.input=_,S.next_in=0,S.avail_in=S.input.length;do{if(S.avail_out===0&&(S.output=new o.Buf8(x),S.next_out=0,S.avail_out=x),(p=i.inflate(S,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&C&&(E=typeof C=="string"?a.string2buf(C):d.call(C)==="[object ArrayBuffer]"?new Uint8Array(C):C,p=i.inflateSetDictionary(this.strm,E)),p===l.Z_BUF_ERROR&&A===!0&&(p=l.Z_OK,A=!1),p!==l.Z_STREAM_END&&p!==l.Z_OK)return this.onEnd(p),!(this.ended=!0);S.next_out&&(S.avail_out!==0&&p!==l.Z_STREAM_END&&(S.avail_in!==0||y!==l.Z_FINISH&&y!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(b=a.utf8border(S.output,S.next_out),v=S.next_out-b,w=a.buf2string(S.output,b),S.next_out=v,S.avail_out=x-v,v&&o.arraySet(S.output,S.output,b,v,0),this.onData(w)):this.onData(o.shrinkBuf(S.output,S.next_out)))),S.avail_in===0&&S.avail_out===0&&(A=!0)}while((0<S.avail_in||S.avail_out===0)&&p!==l.Z_STREAM_END);return p===l.Z_STREAM_END&&(y=l.Z_FINISH),y===l.Z_FINISH?(p=i.inflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===l.Z_OK):y!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(S.avail_out=0))},f.prototype.onData=function(_){this.chunks.push(_)},f.prototype.onEnd=function(_){_===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},s.Inflate=f,s.inflate=g,s.inflateRaw=function(_,m){return(m=m||{}).raw=!0,g(_,m)},s.ungzip=g},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,n,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var h in u)u.hasOwnProperty(h)&&(l[h]=u[h])}}return l},s.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var o={arraySet:function(l,c,u,h,d){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+h),d);else for(var f=0;f<h;f++)l[d+f]=c[u+f]},flattenChunks:function(l){var c,u,h,d,f,g;for(c=h=0,u=l.length;c<u;c++)h+=l[c].length;for(g=new Uint8Array(h),c=d=0,u=l.length;c<u;c++)f=l[c],g.set(f,d),d+=f.length;return g}},a={arraySet:function(l,c,u,h,d){for(var f=0;f<h;f++)l[d+f]=c[u+f]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,o)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,a))},s.setTyped(i)},{}],42:[function(r,n,s){var i=r("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(h,d){if(d<65537&&(h.subarray&&a||!h.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(h,d));for(var f="",g=0;g<d;g++)f+=String.fromCharCode(h[g]);return f}l[254]=l[254]=1,s.string2buf=function(h){var d,f,g,_,m,p=h.length,y=0;for(_=0;_<p;_++)(64512&(f=h.charCodeAt(_)))==55296&&_+1<p&&(64512&(g=h.charCodeAt(_+1)))==56320&&(f=65536+(f-55296<<10)+(g-56320),_++),y+=f<128?1:f<2048?2:f<65536?3:4;for(d=new i.Buf8(y),_=m=0;m<y;_++)(64512&(f=h.charCodeAt(_)))==55296&&_+1<p&&(64512&(g=h.charCodeAt(_+1)))==56320&&(f=65536+(f-55296<<10)+(g-56320),_++),f<128?d[m++]=f:(f<2048?d[m++]=192|f>>>6:(f<65536?d[m++]=224|f>>>12:(d[m++]=240|f>>>18,d[m++]=128|f>>>12&63),d[m++]=128|f>>>6&63),d[m++]=128|63&f);return d},s.buf2binstring=function(h){return u(h,h.length)},s.binstring2buf=function(h){for(var d=new i.Buf8(h.length),f=0,g=d.length;f<g;f++)d[f]=h.charCodeAt(f);return d},s.buf2string=function(h,d){var f,g,_,m,p=d||h.length,y=new Array(2*p);for(f=g=0;f<p;)if((_=h[f++])<128)y[g++]=_;else if(4<(m=l[_]))y[g++]=65533,f+=m-1;else{for(_&=m===2?31:m===3?15:7;1<m&&f<p;)_=_<<6|63&h[f++],m--;1<m?y[g++]=65533:_<65536?y[g++]=_:(_-=65536,y[g++]=55296|_>>10&1023,y[g++]=56320|1023&_)}return u(y,g)},s.utf8border=function(h,d){var f;for((d=d||h.length)>h.length&&(d=h.length),f=d-1;0<=f&&(192&h[f])==128;)f--;return f<0||f===0?d:f+l[h[f]]>d?f:d}},{"./common":41}],43:[function(r,n,s){n.exports=function(i,o,a,l){for(var c=65535&i|0,u=i>>>16&65535|0,h=0;a!==0;){for(a-=h=2e3<a?2e3:a;u=u+(c=c+o[l++]|0)|0,--h;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(r,n,s){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,n,s){var i=function(){for(var o,a=[],l=0;l<256;l++){o=l;for(var c=0;c<8;c++)o=1&o?3988292384^o>>>1:o>>>1;a[l]=o}return a}();n.exports=function(o,a,l,c){var u=i,h=c+l;o^=-1;for(var d=c;d<h;d++)o=o>>>8^u[255&(o^a[d])];return-1^o}},{}],46:[function(r,n,s){var i,o=r("../utils/common"),a=r("./trees"),l=r("./adler32"),c=r("./crc32"),u=r("./messages"),h=0,d=4,f=0,g=-2,_=-1,m=4,p=2,y=8,b=9,v=286,w=30,E=19,S=2*v+1,x=15,C=3,A=258,M=A+C+1,P=42,D=113,R=1,G=2,ee=3,q=4;function re(L,oe){return L.msg=u[oe],oe}function N(L){return(L<<1)-(4<L?9:0)}function B(L){for(var oe=L.length;0<=--oe;)L[oe]=0}function $(L){var oe=L.state,ie=oe.pending;ie>L.avail_out&&(ie=L.avail_out),ie!==0&&(o.arraySet(L.output,oe.pending_buf,oe.pending_out,ie,L.next_out),L.next_out+=ie,oe.pending_out+=ie,L.total_out+=ie,L.avail_out-=ie,oe.pending-=ie,oe.pending===0&&(oe.pending_out=0))}function H(L,oe){a._tr_flush_block(L,0<=L.block_start?L.block_start:-1,L.strstart-L.block_start,oe),L.block_start=L.strstart,$(L.strm)}function U(L,oe){L.pending_buf[L.pending++]=oe}function Q(L,oe){L.pending_buf[L.pending++]=oe>>>8&255,L.pending_buf[L.pending++]=255&oe}function ne(L,oe){var ie,W,K=L.max_chain_length,ae=L.strstart,xe=L.prev_length,Te=L.nice_match,le=L.strstart>L.w_size-M?L.strstart-(L.w_size-M):0,Se=L.window,Oe=L.w_mask,Ce=L.prev,he=L.strstart+A,ke=Se[ae+xe-1],Ie=Se[ae+xe];L.prev_length>=L.good_match&&(K>>=2),Te>L.lookahead&&(Te=L.lookahead);do if(Se[(ie=oe)+xe]===Ie&&Se[ie+xe-1]===ke&&Se[ie]===Se[ae]&&Se[++ie]===Se[ae+1]){ae+=2,ie++;do;while(Se[++ae]===Se[++ie]&&Se[++ae]===Se[++ie]&&Se[++ae]===Se[++ie]&&Se[++ae]===Se[++ie]&&Se[++ae]===Se[++ie]&&Se[++ae]===Se[++ie]&&Se[++ae]===Se[++ie]&&Se[++ae]===Se[++ie]&&ae<he);if(W=A-(he-ae),ae=he-A,xe<W){if(L.match_start=oe,Te<=(xe=W))break;ke=Se[ae+xe-1],Ie=Se[ae+xe]}}while((oe=Ce[oe&Oe])>le&&--K!=0);return xe<=L.lookahead?xe:L.lookahead}function ge(L){var oe,ie,W,K,ae,xe,Te,le,Se,Oe,Ce=L.w_size;do{if(K=L.window_size-L.lookahead-L.strstart,L.strstart>=Ce+(Ce-M)){for(o.arraySet(L.window,L.window,Ce,Ce,0),L.match_start-=Ce,L.strstart-=Ce,L.block_start-=Ce,oe=ie=L.hash_size;W=L.head[--oe],L.head[oe]=Ce<=W?W-Ce:0,--ie;);for(oe=ie=Ce;W=L.prev[--oe],L.prev[oe]=Ce<=W?W-Ce:0,--ie;);K+=Ce}if(L.strm.avail_in===0)break;if(xe=L.strm,Te=L.window,le=L.strstart+L.lookahead,Se=K,Oe=void 0,Oe=xe.avail_in,Se<Oe&&(Oe=Se),ie=Oe===0?0:(xe.avail_in-=Oe,o.arraySet(Te,xe.input,xe.next_in,Oe,le),xe.state.wrap===1?xe.adler=l(xe.adler,Te,Oe,le):xe.state.wrap===2&&(xe.adler=c(xe.adler,Te,Oe,le)),xe.next_in+=Oe,xe.total_in+=Oe,Oe),L.lookahead+=ie,L.lookahead+L.insert>=C)for(ae=L.strstart-L.insert,L.ins_h=L.window[ae],L.ins_h=(L.ins_h<<L.hash_shift^L.window[ae+1])&L.hash_mask;L.insert&&(L.ins_h=(L.ins_h<<L.hash_shift^L.window[ae+C-1])&L.hash_mask,L.prev[ae&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=ae,ae++,L.insert--,!(L.lookahead+L.insert<C)););}while(L.lookahead<M&&L.strm.avail_in!==0)}function J(L,oe){for(var ie,W;;){if(L.lookahead<M){if(ge(L),L.lookahead<M&&oe===h)return R;if(L.lookahead===0)break}if(ie=0,L.lookahead>=C&&(L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+C-1])&L.hash_mask,ie=L.prev[L.strstart&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=L.strstart),ie!==0&&L.strstart-ie<=L.w_size-M&&(L.match_length=ne(L,ie)),L.match_length>=C)if(W=a._tr_tally(L,L.strstart-L.match_start,L.match_length-C),L.lookahead-=L.match_length,L.match_length<=L.max_lazy_match&&L.lookahead>=C){for(L.match_length--;L.strstart++,L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+C-1])&L.hash_mask,ie=L.prev[L.strstart&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=L.strstart,--L.match_length!=0;);L.strstart++}else L.strstart+=L.match_length,L.match_length=0,L.ins_h=L.window[L.strstart],L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+1])&L.hash_mask;else W=a._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++;if(W&&(H(L,!1),L.strm.avail_out===0))return R}return L.insert=L.strstart<C-1?L.strstart:C-1,oe===d?(H(L,!0),L.strm.avail_out===0?ee:q):L.last_lit&&(H(L,!1),L.strm.avail_out===0)?R:G}function V(L,oe){for(var ie,W,K;;){if(L.lookahead<M){if(ge(L),L.lookahead<M&&oe===h)return R;if(L.lookahead===0)break}if(ie=0,L.lookahead>=C&&(L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+C-1])&L.hash_mask,ie=L.prev[L.strstart&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=L.strstart),L.prev_length=L.match_length,L.prev_match=L.match_start,L.match_length=C-1,ie!==0&&L.prev_length<L.max_lazy_match&&L.strstart-ie<=L.w_size-M&&(L.match_length=ne(L,ie),L.match_length<=5&&(L.strategy===1||L.match_length===C&&4096<L.strstart-L.match_start)&&(L.match_length=C-1)),L.prev_length>=C&&L.match_length<=L.prev_length){for(K=L.strstart+L.lookahead-C,W=a._tr_tally(L,L.strstart-1-L.prev_match,L.prev_length-C),L.lookahead-=L.prev_length-1,L.prev_length-=2;++L.strstart<=K&&(L.ins_h=(L.ins_h<<L.hash_shift^L.window[L.strstart+C-1])&L.hash_mask,ie=L.prev[L.strstart&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=L.strstart),--L.prev_length!=0;);if(L.match_available=0,L.match_length=C-1,L.strstart++,W&&(H(L,!1),L.strm.avail_out===0))return R}else if(L.match_available){if((W=a._tr_tally(L,0,L.window[L.strstart-1]))&&H(L,!1),L.strstart++,L.lookahead--,L.strm.avail_out===0)return R}else L.match_available=1,L.strstart++,L.lookahead--}return L.match_available&&(W=a._tr_tally(L,0,L.window[L.strstart-1]),L.match_available=0),L.insert=L.strstart<C-1?L.strstart:C-1,oe===d?(H(L,!0),L.strm.avail_out===0?ee:q):L.last_lit&&(H(L,!1),L.strm.avail_out===0)?R:G}function fe(L,oe,ie,W,K){this.good_length=L,this.max_lazy=oe,this.nice_length=ie,this.max_chain=W,this.func=K}function de(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*S),this.dyn_dtree=new o.Buf16(2*(2*w+1)),this.bl_tree=new o.Buf16(2*(2*E+1)),B(this.dyn_ltree),B(this.dyn_dtree),B(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(x+1),this.heap=new o.Buf16(2*v+1),B(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*v+1),B(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function be(L){var oe;return L&&L.state?(L.total_in=L.total_out=0,L.data_type=p,(oe=L.state).pending=0,oe.pending_out=0,oe.wrap<0&&(oe.wrap=-oe.wrap),oe.status=oe.wrap?P:D,L.adler=oe.wrap===2?0:1,oe.last_flush=h,a._tr_init(oe),f):re(L,g)}function me(L){var oe=be(L);return oe===f&&function(ie){ie.window_size=2*ie.w_size,B(ie.head),ie.max_lazy_match=i[ie.level].max_lazy,ie.good_match=i[ie.level].good_length,ie.nice_match=i[ie.level].nice_length,ie.max_chain_length=i[ie.level].max_chain,ie.strstart=0,ie.block_start=0,ie.lookahead=0,ie.insert=0,ie.match_length=ie.prev_length=C-1,ie.match_available=0,ie.ins_h=0}(L.state),oe}function ve(L,oe,ie,W,K,ae){if(!L)return g;var xe=1;if(oe===_&&(oe=6),W<0?(xe=0,W=-W):15<W&&(xe=2,W-=16),K<1||b<K||ie!==y||W<8||15<W||oe<0||9<oe||ae<0||m<ae)return re(L,g);W===8&&(W=9);var Te=new de;return(L.state=Te).strm=L,Te.wrap=xe,Te.gzhead=null,Te.w_bits=W,Te.w_size=1<<Te.w_bits,Te.w_mask=Te.w_size-1,Te.hash_bits=K+7,Te.hash_size=1<<Te.hash_bits,Te.hash_mask=Te.hash_size-1,Te.hash_shift=~~((Te.hash_bits+C-1)/C),Te.window=new o.Buf8(2*Te.w_size),Te.head=new o.Buf16(Te.hash_size),Te.prev=new o.Buf16(Te.w_size),Te.lit_bufsize=1<<K+6,Te.pending_buf_size=4*Te.lit_bufsize,Te.pending_buf=new o.Buf8(Te.pending_buf_size),Te.d_buf=1*Te.lit_bufsize,Te.l_buf=3*Te.lit_bufsize,Te.level=oe,Te.strategy=ae,Te.method=ie,me(L)}i=[new fe(0,0,0,0,function(L,oe){var ie=65535;for(ie>L.pending_buf_size-5&&(ie=L.pending_buf_size-5);;){if(L.lookahead<=1){if(ge(L),L.lookahead===0&&oe===h)return R;if(L.lookahead===0)break}L.strstart+=L.lookahead,L.lookahead=0;var W=L.block_start+ie;if((L.strstart===0||L.strstart>=W)&&(L.lookahead=L.strstart-W,L.strstart=W,H(L,!1),L.strm.avail_out===0)||L.strstart-L.block_start>=L.w_size-M&&(H(L,!1),L.strm.avail_out===0))return R}return L.insert=0,oe===d?(H(L,!0),L.strm.avail_out===0?ee:q):(L.strstart>L.block_start&&(H(L,!1),L.strm.avail_out),R)}),new fe(4,4,8,4,J),new fe(4,5,16,8,J),new fe(4,6,32,32,J),new fe(4,4,16,16,V),new fe(8,16,32,32,V),new fe(8,16,128,128,V),new fe(8,32,128,256,V),new fe(32,128,258,1024,V),new fe(32,258,258,4096,V)],s.deflateInit=function(L,oe){return ve(L,oe,y,15,8,0)},s.deflateInit2=ve,s.deflateReset=me,s.deflateResetKeep=be,s.deflateSetHeader=function(L,oe){return L&&L.state?L.state.wrap!==2?g:(L.state.gzhead=oe,f):g},s.deflate=function(L,oe){var ie,W,K,ae;if(!L||!L.state||5<oe||oe<0)return L?re(L,g):g;if(W=L.state,!L.output||!L.input&&L.avail_in!==0||W.status===666&&oe!==d)return re(L,L.avail_out===0?-5:g);if(W.strm=L,ie=W.last_flush,W.last_flush=oe,W.status===P)if(W.wrap===2)L.adler=0,U(W,31),U(W,139),U(W,8),W.gzhead?(U(W,(W.gzhead.text?1:0)+(W.gzhead.hcrc?2:0)+(W.gzhead.extra?4:0)+(W.gzhead.name?8:0)+(W.gzhead.comment?16:0)),U(W,255&W.gzhead.time),U(W,W.gzhead.time>>8&255),U(W,W.gzhead.time>>16&255),U(W,W.gzhead.time>>24&255),U(W,W.level===9?2:2<=W.strategy||W.level<2?4:0),U(W,255&W.gzhead.os),W.gzhead.extra&&W.gzhead.extra.length&&(U(W,255&W.gzhead.extra.length),U(W,W.gzhead.extra.length>>8&255)),W.gzhead.hcrc&&(L.adler=c(L.adler,W.pending_buf,W.pending,0)),W.gzindex=0,W.status=69):(U(W,0),U(W,0),U(W,0),U(W,0),U(W,0),U(W,W.level===9?2:2<=W.strategy||W.level<2?4:0),U(W,3),W.status=D);else{var xe=y+(W.w_bits-8<<4)<<8;xe|=(2<=W.strategy||W.level<2?0:W.level<6?1:W.level===6?2:3)<<6,W.strstart!==0&&(xe|=32),xe+=31-xe%31,W.status=D,Q(W,xe),W.strstart!==0&&(Q(W,L.adler>>>16),Q(W,65535&L.adler)),L.adler=1}if(W.status===69)if(W.gzhead.extra){for(K=W.pending;W.gzindex<(65535&W.gzhead.extra.length)&&(W.pending!==W.pending_buf_size||(W.gzhead.hcrc&&W.pending>K&&(L.adler=c(L.adler,W.pending_buf,W.pending-K,K)),$(L),K=W.pending,W.pending!==W.pending_buf_size));)U(W,255&W.gzhead.extra[W.gzindex]),W.gzindex++;W.gzhead.hcrc&&W.pending>K&&(L.adler=c(L.adler,W.pending_buf,W.pending-K,K)),W.gzindex===W.gzhead.extra.length&&(W.gzindex=0,W.status=73)}else W.status=73;if(W.status===73)if(W.gzhead.name){K=W.pending;do{if(W.pending===W.pending_buf_size&&(W.gzhead.hcrc&&W.pending>K&&(L.adler=c(L.adler,W.pending_buf,W.pending-K,K)),$(L),K=W.pending,W.pending===W.pending_buf_size)){ae=1;break}ae=W.gzindex<W.gzhead.name.length?255&W.gzhead.name.charCodeAt(W.gzindex++):0,U(W,ae)}while(ae!==0);W.gzhead.hcrc&&W.pending>K&&(L.adler=c(L.adler,W.pending_buf,W.pending-K,K)),ae===0&&(W.gzindex=0,W.status=91)}else W.status=91;if(W.status===91)if(W.gzhead.comment){K=W.pending;do{if(W.pending===W.pending_buf_size&&(W.gzhead.hcrc&&W.pending>K&&(L.adler=c(L.adler,W.pending_buf,W.pending-K,K)),$(L),K=W.pending,W.pending===W.pending_buf_size)){ae=1;break}ae=W.gzindex<W.gzhead.comment.length?255&W.gzhead.comment.charCodeAt(W.gzindex++):0,U(W,ae)}while(ae!==0);W.gzhead.hcrc&&W.pending>K&&(L.adler=c(L.adler,W.pending_buf,W.pending-K,K)),ae===0&&(W.status=103)}else W.status=103;if(W.status===103&&(W.gzhead.hcrc?(W.pending+2>W.pending_buf_size&&$(L),W.pending+2<=W.pending_buf_size&&(U(W,255&L.adler),U(W,L.adler>>8&255),L.adler=0,W.status=D)):W.status=D),W.pending!==0){if($(L),L.avail_out===0)return W.last_flush=-1,f}else if(L.avail_in===0&&N(oe)<=N(ie)&&oe!==d)return re(L,-5);if(W.status===666&&L.avail_in!==0)return re(L,-5);if(L.avail_in!==0||W.lookahead!==0||oe!==h&&W.status!==666){var Te=W.strategy===2?function(le,Se){for(var Oe;;){if(le.lookahead===0&&(ge(le),le.lookahead===0)){if(Se===h)return R;break}if(le.match_length=0,Oe=a._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++,Oe&&(H(le,!1),le.strm.avail_out===0))return R}return le.insert=0,Se===d?(H(le,!0),le.strm.avail_out===0?ee:q):le.last_lit&&(H(le,!1),le.strm.avail_out===0)?R:G}(W,oe):W.strategy===3?function(le,Se){for(var Oe,Ce,he,ke,Ie=le.window;;){if(le.lookahead<=A){if(ge(le),le.lookahead<=A&&Se===h)return R;if(le.lookahead===0)break}if(le.match_length=0,le.lookahead>=C&&0<le.strstart&&(Ce=Ie[he=le.strstart-1])===Ie[++he]&&Ce===Ie[++he]&&Ce===Ie[++he]){ke=le.strstart+A;do;while(Ce===Ie[++he]&&Ce===Ie[++he]&&Ce===Ie[++he]&&Ce===Ie[++he]&&Ce===Ie[++he]&&Ce===Ie[++he]&&Ce===Ie[++he]&&Ce===Ie[++he]&&he<ke);le.match_length=A-(ke-he),le.match_length>le.lookahead&&(le.match_length=le.lookahead)}if(le.match_length>=C?(Oe=a._tr_tally(le,1,le.match_length-C),le.lookahead-=le.match_length,le.strstart+=le.match_length,le.match_length=0):(Oe=a._tr_tally(le,0,le.window[le.strstart]),le.lookahead--,le.strstart++),Oe&&(H(le,!1),le.strm.avail_out===0))return R}return le.insert=0,Se===d?(H(le,!0),le.strm.avail_out===0?ee:q):le.last_lit&&(H(le,!1),le.strm.avail_out===0)?R:G}(W,oe):i[W.level].func(W,oe);if(Te!==ee&&Te!==q||(W.status=666),Te===R||Te===ee)return L.avail_out===0&&(W.last_flush=-1),f;if(Te===G&&(oe===1?a._tr_align(W):oe!==5&&(a._tr_stored_block(W,0,0,!1),oe===3&&(B(W.head),W.lookahead===0&&(W.strstart=0,W.block_start=0,W.insert=0))),$(L),L.avail_out===0))return W.last_flush=-1,f}return oe!==d?f:W.wrap<=0?1:(W.wrap===2?(U(W,255&L.adler),U(W,L.adler>>8&255),U(W,L.adler>>16&255),U(W,L.adler>>24&255),U(W,255&L.total_in),U(W,L.total_in>>8&255),U(W,L.total_in>>16&255),U(W,L.total_in>>24&255)):(Q(W,L.adler>>>16),Q(W,65535&L.adler)),$(L),0<W.wrap&&(W.wrap=-W.wrap),W.pending!==0?f:1)},s.deflateEnd=function(L){var oe;return L&&L.state?(oe=L.state.status)!==P&&oe!==69&&oe!==73&&oe!==91&&oe!==103&&oe!==D&&oe!==666?re(L,g):(L.state=null,oe===D?re(L,-3):f):g},s.deflateSetDictionary=function(L,oe){var ie,W,K,ae,xe,Te,le,Se,Oe=oe.length;if(!L||!L.state||(ae=(ie=L.state).wrap)===2||ae===1&&ie.status!==P||ie.lookahead)return g;for(ae===1&&(L.adler=l(L.adler,oe,Oe,0)),ie.wrap=0,Oe>=ie.w_size&&(ae===0&&(B(ie.head),ie.strstart=0,ie.block_start=0,ie.insert=0),Se=new o.Buf8(ie.w_size),o.arraySet(Se,oe,Oe-ie.w_size,ie.w_size,0),oe=Se,Oe=ie.w_size),xe=L.avail_in,Te=L.next_in,le=L.input,L.avail_in=Oe,L.next_in=0,L.input=oe,ge(ie);ie.lookahead>=C;){for(W=ie.strstart,K=ie.lookahead-(C-1);ie.ins_h=(ie.ins_h<<ie.hash_shift^ie.window[W+C-1])&ie.hash_mask,ie.prev[W&ie.w_mask]=ie.head[ie.ins_h],ie.head[ie.ins_h]=W,W++,--K;);ie.strstart=W,ie.lookahead=C-1,ge(ie)}return ie.strstart+=ie.lookahead,ie.block_start=ie.strstart,ie.insert=ie.lookahead,ie.lookahead=0,ie.match_length=ie.prev_length=C-1,ie.match_available=0,L.next_in=Te,L.input=le,L.avail_in=xe,ie.wrap=ae,f},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,n,s){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,n,s){n.exports=function(i,o){var a,l,c,u,h,d,f,g,_,m,p,y,b,v,w,E,S,x,C,A,M,P,D,R,G;a=i.state,l=i.next_in,R=i.input,c=l+(i.avail_in-5),u=i.next_out,G=i.output,h=u-(o-i.avail_out),d=u+(i.avail_out-257),f=a.dmax,g=a.wsize,_=a.whave,m=a.wnext,p=a.window,y=a.hold,b=a.bits,v=a.lencode,w=a.distcode,E=(1<<a.lenbits)-1,S=(1<<a.distbits)-1;e:do{b<15&&(y+=R[l++]<<b,b+=8,y+=R[l++]<<b,b+=8),x=v[y&E];t:for(;;){if(y>>>=C=x>>>24,b-=C,(C=x>>>16&255)===0)G[u++]=65535&x;else{if(!(16&C)){if(!(64&C)){x=v[(65535&x)+(y&(1<<C)-1)];continue t}if(32&C){a.mode=12;break e}i.msg="invalid literal/length code",a.mode=30;break e}A=65535&x,(C&=15)&&(b<C&&(y+=R[l++]<<b,b+=8),A+=y&(1<<C)-1,y>>>=C,b-=C),b<15&&(y+=R[l++]<<b,b+=8,y+=R[l++]<<b,b+=8),x=w[y&S];r:for(;;){if(y>>>=C=x>>>24,b-=C,!(16&(C=x>>>16&255))){if(!(64&C)){x=w[(65535&x)+(y&(1<<C)-1)];continue r}i.msg="invalid distance code",a.mode=30;break e}if(M=65535&x,b<(C&=15)&&(y+=R[l++]<<b,(b+=8)<C&&(y+=R[l++]<<b,b+=8)),f<(M+=y&(1<<C)-1)){i.msg="invalid distance too far back",a.mode=30;break e}if(y>>>=C,b-=C,(C=u-h)<M){if(_<(C=M-C)&&a.sane){i.msg="invalid distance too far back",a.mode=30;break e}if(D=p,(P=0)===m){if(P+=g-C,C<A){for(A-=C;G[u++]=p[P++],--C;);P=u-M,D=G}}else if(m<C){if(P+=g+m-C,(C-=m)<A){for(A-=C;G[u++]=p[P++],--C;);if(P=0,m<A){for(A-=C=m;G[u++]=p[P++],--C;);P=u-M,D=G}}}else if(P+=m-C,C<A){for(A-=C;G[u++]=p[P++],--C;);P=u-M,D=G}for(;2<A;)G[u++]=D[P++],G[u++]=D[P++],G[u++]=D[P++],A-=3;A&&(G[u++]=D[P++],1<A&&(G[u++]=D[P++]))}else{for(P=u-M;G[u++]=G[P++],G[u++]=G[P++],G[u++]=G[P++],2<(A-=3););A&&(G[u++]=G[P++],1<A&&(G[u++]=G[P++]))}break}}break}}while(l<c&&u<d);l-=A=b>>3,y&=(1<<(b-=A<<3))-1,i.next_in=l,i.next_out=u,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=u<d?d-u+257:257-(u-d),a.hold=y,a.bits=b}},{}],49:[function(r,n,s){var i=r("../utils/common"),o=r("./adler32"),a=r("./crc32"),l=r("./inffast"),c=r("./inftrees"),u=1,h=2,d=0,f=-2,g=1,_=852,m=592;function p(P){return(P>>>24&255)+(P>>>8&65280)+((65280&P)<<8)+((255&P)<<24)}function y(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function b(P){var D;return P&&P.state?(D=P.state,P.total_in=P.total_out=D.total=0,P.msg="",D.wrap&&(P.adler=1&D.wrap),D.mode=g,D.last=0,D.havedict=0,D.dmax=32768,D.head=null,D.hold=0,D.bits=0,D.lencode=D.lendyn=new i.Buf32(_),D.distcode=D.distdyn=new i.Buf32(m),D.sane=1,D.back=-1,d):f}function v(P){var D;return P&&P.state?((D=P.state).wsize=0,D.whave=0,D.wnext=0,b(P)):f}function w(P,D){var R,G;return P&&P.state?(G=P.state,D<0?(R=0,D=-D):(R=1+(D>>4),D<48&&(D&=15)),D&&(D<8||15<D)?f:(G.window!==null&&G.wbits!==D&&(G.window=null),G.wrap=R,G.wbits=D,v(P))):f}function E(P,D){var R,G;return P?(G=new y,(P.state=G).window=null,(R=w(P,D))!==d&&(P.state=null),R):f}var S,x,C=!0;function A(P){if(C){var D;for(S=new i.Buf32(512),x=new i.Buf32(32),D=0;D<144;)P.lens[D++]=8;for(;D<256;)P.lens[D++]=9;for(;D<280;)P.lens[D++]=7;for(;D<288;)P.lens[D++]=8;for(c(u,P.lens,0,288,S,0,P.work,{bits:9}),D=0;D<32;)P.lens[D++]=5;c(h,P.lens,0,32,x,0,P.work,{bits:5}),C=!1}P.lencode=S,P.lenbits=9,P.distcode=x,P.distbits=5}function M(P,D,R,G){var ee,q=P.state;return q.window===null&&(q.wsize=1<<q.wbits,q.wnext=0,q.whave=0,q.window=new i.Buf8(q.wsize)),G>=q.wsize?(i.arraySet(q.window,D,R-q.wsize,q.wsize,0),q.wnext=0,q.whave=q.wsize):(G<(ee=q.wsize-q.wnext)&&(ee=G),i.arraySet(q.window,D,R-G,ee,q.wnext),(G-=ee)?(i.arraySet(q.window,D,R-G,G,0),q.wnext=G,q.whave=q.wsize):(q.wnext+=ee,q.wnext===q.wsize&&(q.wnext=0),q.whave<q.wsize&&(q.whave+=ee))),0}s.inflateReset=v,s.inflateReset2=w,s.inflateResetKeep=b,s.inflateInit=function(P){return E(P,15)},s.inflateInit2=E,s.inflate=function(P,D){var R,G,ee,q,re,N,B,$,H,U,Q,ne,ge,J,V,fe,de,be,me,ve,L,oe,ie,W,K=0,ae=new i.Buf8(4),xe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!P||!P.state||!P.output||!P.input&&P.avail_in!==0)return f;(R=P.state).mode===12&&(R.mode=13),re=P.next_out,ee=P.output,B=P.avail_out,q=P.next_in,G=P.input,N=P.avail_in,$=R.hold,H=R.bits,U=N,Q=B,oe=d;e:for(;;)switch(R.mode){case g:if(R.wrap===0){R.mode=13;break}for(;H<16;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}if(2&R.wrap&&$===35615){ae[R.check=0]=255&$,ae[1]=$>>>8&255,R.check=a(R.check,ae,2,0),H=$=0,R.mode=2;break}if(R.flags=0,R.head&&(R.head.done=!1),!(1&R.wrap)||(((255&$)<<8)+($>>8))%31){P.msg="incorrect header check",R.mode=30;break}if((15&$)!=8){P.msg="unknown compression method",R.mode=30;break}if(H-=4,L=8+(15&($>>>=4)),R.wbits===0)R.wbits=L;else if(L>R.wbits){P.msg="invalid window size",R.mode=30;break}R.dmax=1<<L,P.adler=R.check=1,R.mode=512&$?10:12,H=$=0;break;case 2:for(;H<16;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}if(R.flags=$,(255&R.flags)!=8){P.msg="unknown compression method",R.mode=30;break}if(57344&R.flags){P.msg="unknown header flags set",R.mode=30;break}R.head&&(R.head.text=$>>8&1),512&R.flags&&(ae[0]=255&$,ae[1]=$>>>8&255,R.check=a(R.check,ae,2,0)),H=$=0,R.mode=3;case 3:for(;H<32;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}R.head&&(R.head.time=$),512&R.flags&&(ae[0]=255&$,ae[1]=$>>>8&255,ae[2]=$>>>16&255,ae[3]=$>>>24&255,R.check=a(R.check,ae,4,0)),H=$=0,R.mode=4;case 4:for(;H<16;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}R.head&&(R.head.xflags=255&$,R.head.os=$>>8),512&R.flags&&(ae[0]=255&$,ae[1]=$>>>8&255,R.check=a(R.check,ae,2,0)),H=$=0,R.mode=5;case 5:if(1024&R.flags){for(;H<16;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}R.length=$,R.head&&(R.head.extra_len=$),512&R.flags&&(ae[0]=255&$,ae[1]=$>>>8&255,R.check=a(R.check,ae,2,0)),H=$=0}else R.head&&(R.head.extra=null);R.mode=6;case 6:if(1024&R.flags&&(N<(ne=R.length)&&(ne=N),ne&&(R.head&&(L=R.head.extra_len-R.length,R.head.extra||(R.head.extra=new Array(R.head.extra_len)),i.arraySet(R.head.extra,G,q,ne,L)),512&R.flags&&(R.check=a(R.check,G,ne,q)),N-=ne,q+=ne,R.length-=ne),R.length))break e;R.length=0,R.mode=7;case 7:if(2048&R.flags){if(N===0)break e;for(ne=0;L=G[q+ne++],R.head&&L&&R.length<65536&&(R.head.name+=String.fromCharCode(L)),L&&ne<N;);if(512&R.flags&&(R.check=a(R.check,G,ne,q)),N-=ne,q+=ne,L)break e}else R.head&&(R.head.name=null);R.length=0,R.mode=8;case 8:if(4096&R.flags){if(N===0)break e;for(ne=0;L=G[q+ne++],R.head&&L&&R.length<65536&&(R.head.comment+=String.fromCharCode(L)),L&&ne<N;);if(512&R.flags&&(R.check=a(R.check,G,ne,q)),N-=ne,q+=ne,L)break e}else R.head&&(R.head.comment=null);R.mode=9;case 9:if(512&R.flags){for(;H<16;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}if($!==(65535&R.check)){P.msg="header crc mismatch",R.mode=30;break}H=$=0}R.head&&(R.head.hcrc=R.flags>>9&1,R.head.done=!0),P.adler=R.check=0,R.mode=12;break;case 10:for(;H<32;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}P.adler=R.check=p($),H=$=0,R.mode=11;case 11:if(R.havedict===0)return P.next_out=re,P.avail_out=B,P.next_in=q,P.avail_in=N,R.hold=$,R.bits=H,2;P.adler=R.check=1,R.mode=12;case 12:if(D===5||D===6)break e;case 13:if(R.last){$>>>=7&H,H-=7&H,R.mode=27;break}for(;H<3;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}switch(R.last=1&$,H-=1,3&($>>>=1)){case 0:R.mode=14;break;case 1:if(A(R),R.mode=20,D!==6)break;$>>>=2,H-=2;break e;case 2:R.mode=17;break;case 3:P.msg="invalid block type",R.mode=30}$>>>=2,H-=2;break;case 14:for($>>>=7&H,H-=7&H;H<32;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}if((65535&$)!=($>>>16^65535)){P.msg="invalid stored block lengths",R.mode=30;break}if(R.length=65535&$,H=$=0,R.mode=15,D===6)break e;case 15:R.mode=16;case 16:if(ne=R.length){if(N<ne&&(ne=N),B<ne&&(ne=B),ne===0)break e;i.arraySet(ee,G,q,ne,re),N-=ne,q+=ne,B-=ne,re+=ne,R.length-=ne;break}R.mode=12;break;case 17:for(;H<14;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}if(R.nlen=257+(31&$),$>>>=5,H-=5,R.ndist=1+(31&$),$>>>=5,H-=5,R.ncode=4+(15&$),$>>>=4,H-=4,286<R.nlen||30<R.ndist){P.msg="too many length or distance symbols",R.mode=30;break}R.have=0,R.mode=18;case 18:for(;R.have<R.ncode;){for(;H<3;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}R.lens[xe[R.have++]]=7&$,$>>>=3,H-=3}for(;R.have<19;)R.lens[xe[R.have++]]=0;if(R.lencode=R.lendyn,R.lenbits=7,ie={bits:R.lenbits},oe=c(0,R.lens,0,19,R.lencode,0,R.work,ie),R.lenbits=ie.bits,oe){P.msg="invalid code lengths set",R.mode=30;break}R.have=0,R.mode=19;case 19:for(;R.have<R.nlen+R.ndist;){for(;fe=(K=R.lencode[$&(1<<R.lenbits)-1])>>>16&255,de=65535&K,!((V=K>>>24)<=H);){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}if(de<16)$>>>=V,H-=V,R.lens[R.have++]=de;else{if(de===16){for(W=V+2;H<W;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}if($>>>=V,H-=V,R.have===0){P.msg="invalid bit length repeat",R.mode=30;break}L=R.lens[R.have-1],ne=3+(3&$),$>>>=2,H-=2}else if(de===17){for(W=V+3;H<W;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}H-=V,L=0,ne=3+(7&($>>>=V)),$>>>=3,H-=3}else{for(W=V+7;H<W;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}H-=V,L=0,ne=11+(127&($>>>=V)),$>>>=7,H-=7}if(R.have+ne>R.nlen+R.ndist){P.msg="invalid bit length repeat",R.mode=30;break}for(;ne--;)R.lens[R.have++]=L}}if(R.mode===30)break;if(R.lens[256]===0){P.msg="invalid code -- missing end-of-block",R.mode=30;break}if(R.lenbits=9,ie={bits:R.lenbits},oe=c(u,R.lens,0,R.nlen,R.lencode,0,R.work,ie),R.lenbits=ie.bits,oe){P.msg="invalid literal/lengths set",R.mode=30;break}if(R.distbits=6,R.distcode=R.distdyn,ie={bits:R.distbits},oe=c(h,R.lens,R.nlen,R.ndist,R.distcode,0,R.work,ie),R.distbits=ie.bits,oe){P.msg="invalid distances set",R.mode=30;break}if(R.mode=20,D===6)break e;case 20:R.mode=21;case 21:if(6<=N&&258<=B){P.next_out=re,P.avail_out=B,P.next_in=q,P.avail_in=N,R.hold=$,R.bits=H,l(P,Q),re=P.next_out,ee=P.output,B=P.avail_out,q=P.next_in,G=P.input,N=P.avail_in,$=R.hold,H=R.bits,R.mode===12&&(R.back=-1);break}for(R.back=0;fe=(K=R.lencode[$&(1<<R.lenbits)-1])>>>16&255,de=65535&K,!((V=K>>>24)<=H);){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}if(fe&&!(240&fe)){for(be=V,me=fe,ve=de;fe=(K=R.lencode[ve+(($&(1<<be+me)-1)>>be)])>>>16&255,de=65535&K,!(be+(V=K>>>24)<=H);){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}$>>>=be,H-=be,R.back+=be}if($>>>=V,H-=V,R.back+=V,R.length=de,fe===0){R.mode=26;break}if(32&fe){R.back=-1,R.mode=12;break}if(64&fe){P.msg="invalid literal/length code",R.mode=30;break}R.extra=15&fe,R.mode=22;case 22:if(R.extra){for(W=R.extra;H<W;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}R.length+=$&(1<<R.extra)-1,$>>>=R.extra,H-=R.extra,R.back+=R.extra}R.was=R.length,R.mode=23;case 23:for(;fe=(K=R.distcode[$&(1<<R.distbits)-1])>>>16&255,de=65535&K,!((V=K>>>24)<=H);){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}if(!(240&fe)){for(be=V,me=fe,ve=de;fe=(K=R.distcode[ve+(($&(1<<be+me)-1)>>be)])>>>16&255,de=65535&K,!(be+(V=K>>>24)<=H);){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}$>>>=be,H-=be,R.back+=be}if($>>>=V,H-=V,R.back+=V,64&fe){P.msg="invalid distance code",R.mode=30;break}R.offset=de,R.extra=15&fe,R.mode=24;case 24:if(R.extra){for(W=R.extra;H<W;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}R.offset+=$&(1<<R.extra)-1,$>>>=R.extra,H-=R.extra,R.back+=R.extra}if(R.offset>R.dmax){P.msg="invalid distance too far back",R.mode=30;break}R.mode=25;case 25:if(B===0)break e;if(ne=Q-B,R.offset>ne){if((ne=R.offset-ne)>R.whave&&R.sane){P.msg="invalid distance too far back",R.mode=30;break}ge=ne>R.wnext?(ne-=R.wnext,R.wsize-ne):R.wnext-ne,ne>R.length&&(ne=R.length),J=R.window}else J=ee,ge=re-R.offset,ne=R.length;for(B<ne&&(ne=B),B-=ne,R.length-=ne;ee[re++]=J[ge++],--ne;);R.length===0&&(R.mode=21);break;case 26:if(B===0)break e;ee[re++]=R.length,B--,R.mode=21;break;case 27:if(R.wrap){for(;H<32;){if(N===0)break e;N--,$|=G[q++]<<H,H+=8}if(Q-=B,P.total_out+=Q,R.total+=Q,Q&&(P.adler=R.check=R.flags?a(R.check,ee,Q,re-Q):o(R.check,ee,Q,re-Q)),Q=B,(R.flags?$:p($))!==R.check){P.msg="incorrect data check",R.mode=30;break}H=$=0}R.mode=28;case 28:if(R.wrap&&R.flags){for(;H<32;){if(N===0)break e;N--,$+=G[q++]<<H,H+=8}if($!==(4294967295&R.total)){P.msg="incorrect length check",R.mode=30;break}H=$=0}R.mode=29;case 29:oe=1;break e;case 30:oe=-3;break e;case 31:return-4;case 32:default:return f}return P.next_out=re,P.avail_out=B,P.next_in=q,P.avail_in=N,R.hold=$,R.bits=H,(R.wsize||Q!==P.avail_out&&R.mode<30&&(R.mode<27||D!==4))&&M(P,P.output,P.next_out,Q-P.avail_out)?(R.mode=31,-4):(U-=P.avail_in,Q-=P.avail_out,P.total_in+=U,P.total_out+=Q,R.total+=Q,R.wrap&&Q&&(P.adler=R.check=R.flags?a(R.check,ee,Q,P.next_out-Q):o(R.check,ee,Q,P.next_out-Q)),P.data_type=R.bits+(R.last?64:0)+(R.mode===12?128:0)+(R.mode===20||R.mode===15?256:0),(U==0&&Q===0||D===4)&&oe===d&&(oe=-5),oe)},s.inflateEnd=function(P){if(!P||!P.state)return f;var D=P.state;return D.window&&(D.window=null),P.state=null,d},s.inflateGetHeader=function(P,D){var R;return P&&P.state&&2&(R=P.state).wrap?((R.head=D).done=!1,d):f},s.inflateSetDictionary=function(P,D){var R,G=D.length;return P&&P.state?(R=P.state).wrap!==0&&R.mode!==11?f:R.mode===11&&o(1,D,G,0)!==R.check?-3:M(P,D,G,G)?(R.mode=31,-4):(R.havedict=1,d):f},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,n,s){var i=r("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(u,h,d,f,g,_,m,p){var y,b,v,w,E,S,x,C,A,M=p.bits,P=0,D=0,R=0,G=0,ee=0,q=0,re=0,N=0,B=0,$=0,H=null,U=0,Q=new i.Buf16(16),ne=new i.Buf16(16),ge=null,J=0;for(P=0;P<=15;P++)Q[P]=0;for(D=0;D<f;D++)Q[h[d+D]]++;for(ee=M,G=15;1<=G&&Q[G]===0;G--);if(G<ee&&(ee=G),G===0)return g[_++]=20971520,g[_++]=20971520,p.bits=1,0;for(R=1;R<G&&Q[R]===0;R++);for(ee<R&&(ee=R),P=N=1;P<=15;P++)if(N<<=1,(N-=Q[P])<0)return-1;if(0<N&&(u===0||G!==1))return-1;for(ne[1]=0,P=1;P<15;P++)ne[P+1]=ne[P]+Q[P];for(D=0;D<f;D++)h[d+D]!==0&&(m[ne[h[d+D]]++]=D);if(S=u===0?(H=ge=m,19):u===1?(H=o,U-=257,ge=a,J-=257,256):(H=l,ge=c,-1),P=R,E=_,re=D=$=0,v=-1,w=(B=1<<(q=ee))-1,u===1&&852<B||u===2&&592<B)return 1;for(;;){for(x=P-re,A=m[D]<S?(C=0,m[D]):m[D]>S?(C=ge[J+m[D]],H[U+m[D]]):(C=96,0),y=1<<P-re,R=b=1<<q;g[E+($>>re)+(b-=y)]=x<<24|C<<16|A|0,b!==0;);for(y=1<<P-1;$&y;)y>>=1;if(y!==0?($&=y-1,$+=y):$=0,D++,--Q[P]==0){if(P===G)break;P=h[d+m[D]]}if(ee<P&&($&w)!==v){for(re===0&&(re=ee),E+=R,N=1<<(q=P-re);q+re<G&&!((N-=Q[q+re])<=0);)q++,N<<=1;if(B+=1<<q,u===1&&852<B||u===2&&592<B)return 1;g[v=$&w]=ee<<24|q<<16|E-_|0}}return $!==0&&(g[E+$]=P-re<<24|64<<16|0),p.bits=ee,0}},{"../utils/common":41}],51:[function(r,n,s){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,n,s){var i=r("../utils/common"),o=0,a=1;function l(K){for(var ae=K.length;0<=--ae;)K[ae]=0}var c=0,u=29,h=256,d=h+1+u,f=30,g=19,_=2*d+1,m=15,p=16,y=7,b=256,v=16,w=17,E=18,S=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],x=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],C=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],M=new Array(2*(d+2));l(M);var P=new Array(2*f);l(P);var D=new Array(512);l(D);var R=new Array(256);l(R);var G=new Array(u);l(G);var ee,q,re,N=new Array(f);function B(K,ae,xe,Te,le){this.static_tree=K,this.extra_bits=ae,this.extra_base=xe,this.elems=Te,this.max_length=le,this.has_stree=K&&K.length}function $(K,ae){this.dyn_tree=K,this.max_code=0,this.stat_desc=ae}function H(K){return K<256?D[K]:D[256+(K>>>7)]}function U(K,ae){K.pending_buf[K.pending++]=255&ae,K.pending_buf[K.pending++]=ae>>>8&255}function Q(K,ae,xe){K.bi_valid>p-xe?(K.bi_buf|=ae<<K.bi_valid&65535,U(K,K.bi_buf),K.bi_buf=ae>>p-K.bi_valid,K.bi_valid+=xe-p):(K.bi_buf|=ae<<K.bi_valid&65535,K.bi_valid+=xe)}function ne(K,ae,xe){Q(K,xe[2*ae],xe[2*ae+1])}function ge(K,ae){for(var xe=0;xe|=1&K,K>>>=1,xe<<=1,0<--ae;);return xe>>>1}function J(K,ae,xe){var Te,le,Se=new Array(m+1),Oe=0;for(Te=1;Te<=m;Te++)Se[Te]=Oe=Oe+xe[Te-1]<<1;for(le=0;le<=ae;le++){var Ce=K[2*le+1];Ce!==0&&(K[2*le]=ge(Se[Ce]++,Ce))}}function V(K){var ae;for(ae=0;ae<d;ae++)K.dyn_ltree[2*ae]=0;for(ae=0;ae<f;ae++)K.dyn_dtree[2*ae]=0;for(ae=0;ae<g;ae++)K.bl_tree[2*ae]=0;K.dyn_ltree[2*b]=1,K.opt_len=K.static_len=0,K.last_lit=K.matches=0}function fe(K){8<K.bi_valid?U(K,K.bi_buf):0<K.bi_valid&&(K.pending_buf[K.pending++]=K.bi_buf),K.bi_buf=0,K.bi_valid=0}function de(K,ae,xe,Te){var le=2*ae,Se=2*xe;return K[le]<K[Se]||K[le]===K[Se]&&Te[ae]<=Te[xe]}function be(K,ae,xe){for(var Te=K.heap[xe],le=xe<<1;le<=K.heap_len&&(le<K.heap_len&&de(ae,K.heap[le+1],K.heap[le],K.depth)&&le++,!de(ae,Te,K.heap[le],K.depth));)K.heap[xe]=K.heap[le],xe=le,le<<=1;K.heap[xe]=Te}function me(K,ae,xe){var Te,le,Se,Oe,Ce=0;if(K.last_lit!==0)for(;Te=K.pending_buf[K.d_buf+2*Ce]<<8|K.pending_buf[K.d_buf+2*Ce+1],le=K.pending_buf[K.l_buf+Ce],Ce++,Te===0?ne(K,le,ae):(ne(K,(Se=R[le])+h+1,ae),(Oe=S[Se])!==0&&Q(K,le-=G[Se],Oe),ne(K,Se=H(--Te),xe),(Oe=x[Se])!==0&&Q(K,Te-=N[Se],Oe)),Ce<K.last_lit;);ne(K,b,ae)}function ve(K,ae){var xe,Te,le,Se=ae.dyn_tree,Oe=ae.stat_desc.static_tree,Ce=ae.stat_desc.has_stree,he=ae.stat_desc.elems,ke=-1;for(K.heap_len=0,K.heap_max=_,xe=0;xe<he;xe++)Se[2*xe]!==0?(K.heap[++K.heap_len]=ke=xe,K.depth[xe]=0):Se[2*xe+1]=0;for(;K.heap_len<2;)Se[2*(le=K.heap[++K.heap_len]=ke<2?++ke:0)]=1,K.depth[le]=0,K.opt_len--,Ce&&(K.static_len-=Oe[2*le+1]);for(ae.max_code=ke,xe=K.heap_len>>1;1<=xe;xe--)be(K,Se,xe);for(le=he;xe=K.heap[1],K.heap[1]=K.heap[K.heap_len--],be(K,Se,1),Te=K.heap[1],K.heap[--K.heap_max]=xe,K.heap[--K.heap_max]=Te,Se[2*le]=Se[2*xe]+Se[2*Te],K.depth[le]=(K.depth[xe]>=K.depth[Te]?K.depth[xe]:K.depth[Te])+1,Se[2*xe+1]=Se[2*Te+1]=le,K.heap[1]=le++,be(K,Se,1),2<=K.heap_len;);K.heap[--K.heap_max]=K.heap[1],function(Ie,Ye){var z,O,F,Y,ce,ye,we=Ye.dyn_tree,nt=Ye.max_code,bt=Ye.stat_desc.static_tree,$t=Ye.stat_desc.has_stree,Wt=Ye.stat_desc.extra_bits,Ot=Ye.stat_desc.extra_base,kh=Ye.stat_desc.max_length,pm=0;for(Y=0;Y<=m;Y++)Ie.bl_count[Y]=0;for(we[2*Ie.heap[Ie.heap_max]+1]=0,z=Ie.heap_max+1;z<_;z++)kh<(Y=we[2*we[2*(O=Ie.heap[z])+1]+1]+1)&&(Y=kh,pm++),we[2*O+1]=Y,nt<O||(Ie.bl_count[Y]++,ce=0,Ot<=O&&(ce=Wt[O-Ot]),ye=we[2*O],Ie.opt_len+=ye*(Y+ce),$t&&(Ie.static_len+=ye*(bt[2*O+1]+ce)));if(pm!==0){do{for(Y=kh-1;Ie.bl_count[Y]===0;)Y--;Ie.bl_count[Y]--,Ie.bl_count[Y+1]+=2,Ie.bl_count[kh]--,pm-=2}while(0<pm);for(Y=kh;Y!==0;Y--)for(O=Ie.bl_count[Y];O!==0;)nt<(F=Ie.heap[--z])||(we[2*F+1]!==Y&&(Ie.opt_len+=(Y-we[2*F+1])*we[2*F],we[2*F+1]=Y),O--)}}(K,ae),J(Se,ke,K.bl_count)}function L(K,ae,xe){var Te,le,Se=-1,Oe=ae[1],Ce=0,he=7,ke=4;for(Oe===0&&(he=138,ke=3),ae[2*(xe+1)+1]=65535,Te=0;Te<=xe;Te++)le=Oe,Oe=ae[2*(Te+1)+1],++Ce<he&&le===Oe||(Ce<ke?K.bl_tree[2*le]+=Ce:le!==0?(le!==Se&&K.bl_tree[2*le]++,K.bl_tree[2*v]++):Ce<=10?K.bl_tree[2*w]++:K.bl_tree[2*E]++,Se=le,ke=(Ce=0)===Oe?(he=138,3):le===Oe?(he=6,3):(he=7,4))}function oe(K,ae,xe){var Te,le,Se=-1,Oe=ae[1],Ce=0,he=7,ke=4;for(Oe===0&&(he=138,ke=3),Te=0;Te<=xe;Te++)if(le=Oe,Oe=ae[2*(Te+1)+1],!(++Ce<he&&le===Oe)){if(Ce<ke)for(;ne(K,le,K.bl_tree),--Ce!=0;);else le!==0?(le!==Se&&(ne(K,le,K.bl_tree),Ce--),ne(K,v,K.bl_tree),Q(K,Ce-3,2)):Ce<=10?(ne(K,w,K.bl_tree),Q(K,Ce-3,3)):(ne(K,E,K.bl_tree),Q(K,Ce-11,7));Se=le,ke=(Ce=0)===Oe?(he=138,3):le===Oe?(he=6,3):(he=7,4)}}l(N);var ie=!1;function W(K,ae,xe,Te){Q(K,(c<<1)+(Te?1:0),3),function(le,Se,Oe,Ce){fe(le),U(le,Oe),U(le,~Oe),i.arraySet(le.pending_buf,le.window,Se,Oe,le.pending),le.pending+=Oe}(K,ae,xe)}s._tr_init=function(K){ie||(function(){var ae,xe,Te,le,Se,Oe=new Array(m+1);for(le=Te=0;le<u-1;le++)for(G[le]=Te,ae=0;ae<1<<S[le];ae++)R[Te++]=le;for(R[Te-1]=le,le=Se=0;le<16;le++)for(N[le]=Se,ae=0;ae<1<<x[le];ae++)D[Se++]=le;for(Se>>=7;le<f;le++)for(N[le]=Se<<7,ae=0;ae<1<<x[le]-7;ae++)D[256+Se++]=le;for(xe=0;xe<=m;xe++)Oe[xe]=0;for(ae=0;ae<=143;)M[2*ae+1]=8,ae++,Oe[8]++;for(;ae<=255;)M[2*ae+1]=9,ae++,Oe[9]++;for(;ae<=279;)M[2*ae+1]=7,ae++,Oe[7]++;for(;ae<=287;)M[2*ae+1]=8,ae++,Oe[8]++;for(J(M,d+1,Oe),ae=0;ae<f;ae++)P[2*ae+1]=5,P[2*ae]=ge(ae,5);ee=new B(M,S,h+1,d,m),q=new B(P,x,0,f,m),re=new B(new Array(0),C,0,g,y)}(),ie=!0),K.l_desc=new $(K.dyn_ltree,ee),K.d_desc=new $(K.dyn_dtree,q),K.bl_desc=new $(K.bl_tree,re),K.bi_buf=0,K.bi_valid=0,V(K)},s._tr_stored_block=W,s._tr_flush_block=function(K,ae,xe,Te){var le,Se,Oe=0;0<K.level?(K.strm.data_type===2&&(K.strm.data_type=function(Ce){var he,ke=4093624447;for(he=0;he<=31;he++,ke>>>=1)if(1&ke&&Ce.dyn_ltree[2*he]!==0)return o;if(Ce.dyn_ltree[18]!==0||Ce.dyn_ltree[20]!==0||Ce.dyn_ltree[26]!==0)return a;for(he=32;he<h;he++)if(Ce.dyn_ltree[2*he]!==0)return a;return o}(K)),ve(K,K.l_desc),ve(K,K.d_desc),Oe=function(Ce){var he;for(L(Ce,Ce.dyn_ltree,Ce.l_desc.max_code),L(Ce,Ce.dyn_dtree,Ce.d_desc.max_code),ve(Ce,Ce.bl_desc),he=g-1;3<=he&&Ce.bl_tree[2*A[he]+1]===0;he--);return Ce.opt_len+=3*(he+1)+5+5+4,he}(K),le=K.opt_len+3+7>>>3,(Se=K.static_len+3+7>>>3)<=le&&(le=Se)):le=Se=xe+5,xe+4<=le&&ae!==-1?W(K,ae,xe,Te):K.strategy===4||Se===le?(Q(K,2+(Te?1:0),3),me(K,M,P)):(Q(K,4+(Te?1:0),3),function(Ce,he,ke,Ie){var Ye;for(Q(Ce,he-257,5),Q(Ce,ke-1,5),Q(Ce,Ie-4,4),Ye=0;Ye<Ie;Ye++)Q(Ce,Ce.bl_tree[2*A[Ye]+1],3);oe(Ce,Ce.dyn_ltree,he-1),oe(Ce,Ce.dyn_dtree,ke-1)}(K,K.l_desc.max_code+1,K.d_desc.max_code+1,Oe+1),me(K,K.dyn_ltree,K.dyn_dtree)),V(K),Te&&fe(K)},s._tr_tally=function(K,ae,xe){return K.pending_buf[K.d_buf+2*K.last_lit]=ae>>>8&255,K.pending_buf[K.d_buf+2*K.last_lit+1]=255&ae,K.pending_buf[K.l_buf+K.last_lit]=255&xe,K.last_lit++,ae===0?K.dyn_ltree[2*xe]++:(K.matches++,ae--,K.dyn_ltree[2*(R[xe]+h+1)]++,K.dyn_dtree[2*H(ae)]++),K.last_lit===K.lit_bufsize-1},s._tr_align=function(K){Q(K,2,3),ne(K,b,M),function(ae){ae.bi_valid===16?(U(ae,ae.bi_buf),ae.bi_buf=0,ae.bi_valid=0):8<=ae.bi_valid&&(ae.pending_buf[ae.pending++]=255&ae.bi_buf,ae.bi_buf>>=8,ae.bi_valid-=8)}(K)}},{"../utils/common":41}],53:[function(r,n,s){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,n,s){(function(i){(function(o,a){if(!o.setImmediate){var l,c,u,h,d=1,f={},g=!1,_=o.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(o);m=m&&m.setTimeout?m:o,l={}.toString.call(o.process)==="[object process]"?function(v){Dt.nextTick(function(){y(v)})}:function(){if(o.postMessage&&!o.importScripts){var v=!0,w=o.onmessage;return o.onmessage=function(){v=!1},o.postMessage("","*"),o.onmessage=w,v}}()?(h="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",b,!1):o.attachEvent("onmessage",b),function(v){o.postMessage(h+v,"*")}):o.MessageChannel?((u=new MessageChannel).port1.onmessage=function(v){y(v.data)},function(v){u.port2.postMessage(v)}):_&&"onreadystatechange"in _.createElement("script")?(c=_.documentElement,function(v){var w=_.createElement("script");w.onreadystatechange=function(){y(v),w.onreadystatechange=null,c.removeChild(w),w=null},c.appendChild(w)}):function(v){setTimeout(y,0,v)},m.setImmediate=function(v){typeof v!="function"&&(v=new Function(""+v));for(var w=new Array(arguments.length-1),E=0;E<w.length;E++)w[E]=arguments[E+1];var S={callback:v,args:w};return f[d]=S,l(d),d++},m.clearImmediate=p}function p(v){delete f[v]}function y(v){if(g)setTimeout(y,0,v);else{var w=f[v];if(w){g=!0;try{(function(E){var S=E.callback,x=E.args;switch(x.length){case 0:S();break;case 1:S(x[0]);break;case 2:S(x[0],x[1]);break;case 3:S(x[0],x[1],x[2]);break;default:S.apply(a,x)}})(w)}finally{p(v),g=!1}}}}function b(v){v.source===o&&typeof v.data=="string"&&v.data.indexOf(h)===0&&y(+v.data.slice(h.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof hn<"u"?hn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(q8);var vfe=q8.exports;const wfe=rs(vfe);var K8={exports:{}};(function(t,e){(function(r,n){n()})(hn,function(){function r(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function n(c,u,h){var d=new XMLHttpRequest;d.open("GET",c),d.responseType="blob",d.onload=function(){l(d.response,u,h)},d.onerror=function(){console.error("could not download file")},d.send()}function s(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function i(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof hn=="object"&&hn.global===hn?hn:void 0,a=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(c,u,h){var d=o.URL||o.webkitURL,f=document.createElement("a");u=u||c.name||"download",f.download=u,f.rel="noopener",typeof c=="string"?(f.href=c,f.origin===location.origin?i(f):s(f.href)?n(c,u,h):i(f,f.target="_blank")):(f.href=d.createObjectURL(c),setTimeout(function(){d.revokeObjectURL(f.href)},4e4),setTimeout(function(){i(f)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,h){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,h),u);else if(s(c))n(c,u,h);else{var d=document.createElement("a");d.href=c,d.target="_blank",setTimeout(function(){i(d)})}}:function(c,u,h,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof c=="string")return n(c,u,h);var f=c.type==="application/octet-stream",g=/constructor/i.test(o.HTMLElement)||o.safari,_=/CriOS\/[\d]+/.test(navigator.userAgent);if((_||f&&g||a)&&typeof FileReader<"u"){var m=new FileReader;m.onloadend=function(){var b=m.result;b=_?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=b:location=b,d=null},m.readAsDataURL(c)}else{var p=o.URL||o.webkitURL,y=p.createObjectURL(c);d?d.location=y:location.href=y,d=null,setTimeout(function(){p.revokeObjectURL(y)},4e4)}});o.saveAs=l.saveAs=l,t.exports=l})})(K8);var Efe=K8.exports;function ib(){return typeof navigator=="object"&&"userAgent"in navigator?navigator.userAgent:typeof Dt=="object"&&Dt.version!==void 0?`Node.js/${Dt.version.substr(1)} (${Dt.platform}; ${Dt.arch})`:"<environment undetectable>"}function JC(t,e,r,n){if(typeof r!="function")throw new Error("method for before hook must be a function");return n||(n={}),Array.isArray(e)?e.reverse().reduce((s,i)=>JC.bind(null,t,i,s,n),r)():Promise.resolve().then(()=>t.registry[e]?t.registry[e].reduce((s,i)=>i.hook.bind(null,s,n),r)():r(n))}function xfe(t,e,r,n){const s=n;t.registry[r]||(t.registry[r]=[]),e==="before"&&(n=(i,o)=>Promise.resolve().then(s.bind(null,o)).then(i.bind(null,o))),e==="after"&&(n=(i,o)=>{let a;return Promise.resolve().then(i.bind(null,o)).then(l=>(a=l,s(a,o))).then(()=>a)}),e==="error"&&(n=(i,o)=>Promise.resolve().then(i.bind(null,o)).catch(a=>s(a,o))),t.registry[r].push({hook:n,orig:s})}function Sfe(t,e,r){if(!t.registry[e])return;const n=t.registry[e].map(s=>s.orig).indexOf(r);n!==-1&&t.registry[e].splice(n,1)}const xP=Function.bind,SP=xP.bind(xP);function Y8(t,e,r){const n=SP(Sfe,null).apply(null,r?[e,r]:[e]);t.api={remove:n},t.remove=n,["before","error","after","wrap"].forEach(s=>{const i=r?[e,s,r]:[e,s];t[s]=t.api[s]=SP(xfe,null).apply(null,i)})}function Tfe(){const t=Symbol("Singular"),e={registry:{}},r=JC.bind(null,e,t);return Y8(r,e,t),r}function Cfe(){const t={registry:{}},e=JC.bind(null,t);return Y8(e,t),e}const kfe={Singular:Tfe,Collection:Cfe};var Afe="0.0.0-development",Rfe=`octokit-endpoint.js/${Afe} ${ib()}`,Ife={method:"GET",baseUrl:"https://api.github.com",headers:{accept:"application/vnd.github.v3+json","user-agent":Rfe},mediaType:{format:""}};function Pfe(t){return t?Object.keys(t).reduce((e,r)=>(e[r.toLowerCase()]=t[r],e),{}):{}}function Ofe(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);if(e===null)return!0;const r=Object.prototype.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&Function.prototype.call(r)===Function.prototype.call(t)}function X8(t,e){const r=Object.assign({},t);return Object.keys(e).forEach(n=>{Ofe(e[n])?n in t?r[n]=X8(t[n],e[n]):Object.assign(r,{[n]:e[n]}):Object.assign(r,{[n]:e[n]})}),r}function TP(t){for(const e in t)t[e]===void 0&&delete t[e];return t}function px(t,e,r){if(typeof e=="string"){let[s,i]=e.split(" ");r=Object.assign(i?{method:s,url:i}:{url:s},r)}else r=Object.assign({},e);r.headers=Pfe(r.headers),TP(r),TP(r.headers);const n=X8(t||{},r);return r.url==="/graphql"&&(t&&t.mediaType.previews?.length&&(n.mediaType.previews=t.mediaType.previews.filter(s=>!n.mediaType.previews.includes(s)).concat(n.mediaType.previews)),n.mediaType.previews=(n.mediaType.previews||[]).map(s=>s.replace(/-preview/,""))),n}function Dfe(t,e){const r=/\?/.test(t)?"&":"?",n=Object.keys(e);return n.length===0?t:t+r+n.map(s=>s==="q"?"q="+e.q.split("+").map(encodeURIComponent).join("+"):`${s}=${encodeURIComponent(e[s])}`).join("&")}var Lfe=/\{[^}]+\}/g;function Nfe(t){return t.replace(/^\W+|\W+$/g,"").split(/,/)}function Mfe(t){const e=t.match(Lfe);return e?e.map(Nfe).reduce((r,n)=>r.concat(n),[]):[]}function CP(t,e){const r={__proto__:null};for(const n of Object.keys(t))e.indexOf(n)===-1&&(r[n]=t[n]);return r}function Z8(t){return t.split(/(%[0-9A-Fa-f]{2})/g).map(function(e){return/%[0-9A-Fa-f]/.test(e)||(e=encodeURI(e).replace(/%5B/g,"[").replace(/%5D/g,"]")),e}).join("")}function Hc(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})}function Ih(t,e,r){return e=t==="+"||t==="#"?Z8(e):Hc(e),r?Hc(r)+"="+e:e}function vc(t){return t!=null}function nw(t){return t===";"||t==="&"||t==="?"}function Bfe(t,e,r,n){var s=t[r],i=[];if(vc(s)&&s!=="")if(typeof s=="string"||typeof s=="number"||typeof s=="boolean")s=s.toString(),n&&n!=="*"&&(s=s.substring(0,parseInt(n,10))),i.push(Ih(e,s,nw(e)?r:""));else if(n==="*")Array.isArray(s)?s.filter(vc).forEach(function(o){i.push(Ih(e,o,nw(e)?r:""))}):Object.keys(s).forEach(function(o){vc(s[o])&&i.push(Ih(e,s[o],o))});else{const o=[];Array.isArray(s)?s.filter(vc).forEach(function(a){o.push(Ih(e,a))}):Object.keys(s).forEach(function(a){vc(s[a])&&(o.push(Hc(a)),o.push(Ih(e,s[a].toString())))}),nw(e)?i.push(Hc(r)+"="+o.join(",")):o.length!==0&&i.push(o.join(","))}else e===";"?vc(s)&&i.push(Hc(r)):s===""&&(e==="&"||e==="?")?i.push(Hc(r)+"="):s===""&&i.push("");return i}function Ffe(t){return{expand:jfe.bind(null,t)}}function jfe(t,e){var r=["+","#",".","/",";","?","&"];return t=t.replace(/\{([^\{\}]+)\}|([^\{\}]+)/g,function(n,s,i){if(s){let a="";const l=[];if(r.indexOf(s.charAt(0))!==-1&&(a=s.charAt(0),s=s.substr(1)),s.split(/,/g).forEach(function(c){var u=/([^:\*]*)(?::(\d+)|(\*))?/.exec(c);l.push(Bfe(e,a,u[1],u[2]||u[3]))}),a&&a!=="+"){var o=",";return a==="?"?o="&":a!=="#"&&(o=a),(l.length!==0?a:"")+l.join(o)}else return l.join(",")}else return Z8(i)}),t==="/"?t:t.replace(/\/$/,"")}function J8(t){let e=t.method.toUpperCase(),r=(t.url||"/").replace(/:([a-z]\w+)/g,"{$1}"),n=Object.assign({},t.headers),s,i=CP(t,["method","baseUrl","url","headers","request","mediaType"]);const o=Mfe(r);r=Ffe(r).expand(i),/^http/.test(r)||(r=t.baseUrl+r);const a=Object.keys(t).filter(u=>o.includes(u)).concat("baseUrl"),l=CP(i,a);if(!/application\/octet-stream/i.test(n.accept)&&(t.mediaType.format&&(n.accept=n.accept.split(/,/).map(u=>u.replace(/application\/vnd(\.\w+)(\.v3)?(\.\w+)?(\+json)?$/,`application/vnd$1$2.${t.mediaType.format}`)).join(",")),r.endsWith("/graphql")&&t.mediaType.previews?.length)){const u=n.accept.match(/[\w-]+(?=-preview)/g)||[];n.accept=u.concat(t.mediaType.previews).map(h=>{const d=t.mediaType.format?`.${t.mediaType.format}`:"+json";return`application/vnd.github.${h}-preview${d}`}).join(",")}return["GET","HEAD"].includes(e)?r=Dfe(r,l):"data"in l?s=l.data:Object.keys(l).length&&(s=l),!n["content-type"]&&typeof s<"u"&&(n["content-type"]="application/json; charset=utf-8"),["PATCH","PUT"].includes(e)&&typeof s>"u"&&(s=""),Object.assign({method:e,url:r,headers:n},typeof s<"u"?{body:s}:null,t.request?{request:t.request}:null)}function Ufe(t,e,r){return J8(px(t,e,r))}function Q8(t,e){const r=px(t,e),n=Ufe.bind(null,r);return Object.assign(n,{DEFAULTS:r,defaults:Q8.bind(null,r),merge:px.bind(null,r),parse:J8})}var $fe=Q8(null,Ife);class Gm extends Error{name;status;request;response;constructor(e,r,n){super(e),this.name="HttpError",this.status=Number.parseInt(r),Number.isNaN(this.status)&&(this.status=0),"response"in n&&(this.response=n.response);const s=Object.assign({},n.request);n.request.headers.authorization&&(s.headers=Object.assign({},n.request.headers,{authorization:n.request.headers.authorization.replace(/ .*$/," [REDACTED]")})),s.url=s.url.replace(/\bclient_secret=\w+/g,"client_secret=[REDACTED]").replace(/\baccess_token=\w+/g,"access_token=[REDACTED]"),this.request=s}}var Hfe="0.0.0-development",zfe={headers:{"user-agent":`octokit-request.js/${Hfe} ${ib()}`}};function Vfe(t){if(typeof t!="object"||t===null||Object.prototype.toString.call(t)!=="[object Object]")return!1;const e=Object.getPrototypeOf(t);if(e===null)return!0;const r=Object.prototype.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&Function.prototype.call(r)===Function.prototype.call(t)}async function kP(t){const e=t.request?.fetch||globalThis.fetch;if(!e)throw new Error("fetch is not set. Please pass a fetch implementation as new Octokit({ request: { fetch }}). Learn more at https://github.com/octokit/octokit.js/#fetch-missing");const r=t.request?.log||console,n=t.request?.parseSuccessResponseBody!==!1,s=Vfe(t.body)||Array.isArray(t.body)?JSON.stringify(t.body):t.body,i=Object.fromEntries(Object.entries(t.headers).map(([h,d])=>[h,String(d)]));let o;try{o=await e(t.url,{method:t.method,body:s,redirect:t.request?.redirect,headers:i,signal:t.request?.signal,...t.body&&{duplex:"half"}})}catch(h){let d="Unknown Error";if(h instanceof Error){if(h.name==="AbortError")throw h.status=500,h;d=h.message,h.name==="TypeError"&&"cause"in h&&(h.cause instanceof Error?d=h.cause.message:typeof h.cause=="string"&&(d=h.cause))}const f=new Gm(d,500,{request:t});throw f.cause=h,f}const a=o.status,l=o.url,c={};for(const[h,d]of o.headers)c[h]=d;const u={url:l,status:a,headers:c,data:""};if("deprecation"in c){const h=c.link&&c.link.match(/<([^>]+)>; rel="deprecation"/),d=h&&h.pop();r.warn(`[@octokit/request] "${t.method} ${t.url}" is deprecated. It is scheduled to be removed on ${c.sunset}${d?`. See ${d}`:""}`)}if(a===204||a===205)return u;if(t.method==="HEAD"){if(a<400)return u;throw new Gm(o.statusText,a,{response:u,request:t})}if(a===304)throw u.data=await sw(o),new Gm("Not modified",a,{response:u,request:t});if(a>=400)throw u.data=await sw(o),new Gm(Gfe(u.data),a,{response:u,request:t});return u.data=n?await sw(o):o.body,u}async function sw(t){const e=t.headers.get("content-type");return/application\/json/.test(e)?t.json().catch(()=>t.text()).catch(()=>""):!e||/^text\/|charset=utf-8$/.test(e)?t.text():t.arrayBuffer()}function Gfe(t){if(typeof t=="string")return t;if(t instanceof ArrayBuffer)return"Unknown error";if("message"in t){const e="documentation_url"in t?` - ${t.documentation_url}`:"";return Array.isArray(t.errors)?`${t.message}: ${t.errors.map(r=>JSON.stringify(r)).join(", ")}${e}`:`${t.message}${e}`}return`Unknown error: ${JSON.stringify(t)}`}function mx(t,e){const r=t.defaults(e);return Object.assign(function(s,i){const o=r.merge(s,i);if(!o.request||!o.request.hook)return kP(r.parse(o));const a=(l,c)=>kP(r.parse(r.merge(l,c)));return Object.assign(a,{endpoint:r,defaults:mx.bind(null,r)}),o.request.hook(a,o)},{endpoint:r,defaults:mx.bind(null,r)})}var gx=mx($fe,zfe),Wfe="0.0.0-development";function qfe(t){return`Request failed due to following response errors:
`+t.errors.map(e=>` - ${e.message}`).join(`
`)}var Kfe=class extends Error{constructor(t,e,r){super(qfe(r)),this.request=t,this.headers=e,this.response=r,this.errors=r.errors,this.data=r.data,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}name="GraphqlResponseError";errors;data},Yfe=["method","baseUrl","url","headers","request","query","mediaType"],Xfe=["query","method","url"],AP=/\/api\/v3\/?$/;function Zfe(t,e,r){if(r){if(typeof e=="string"&&"query"in r)return Promise.reject(new Error('[@octokit/graphql] "query" cannot be used as variable name'));for(const o in r)if(Xfe.includes(o))return Promise.reject(new Error(`[@octokit/graphql] "${o}" cannot be used as variable name`))}const n=typeof e=="string"?Object.assign({query:e},r):e,s=Object.keys(n).reduce((o,a)=>Yfe.includes(a)?(o[a]=n[a],o):(o.variables||(o.variables={}),o.variables[a]=n[a],o),{}),i=n.baseUrl||t.endpoint.DEFAULTS.baseUrl;return AP.test(i)&&(s.url=i.replace(AP,"/api/graphql")),t(s).then(o=>{if(o.data.errors){const a={};for(const l of Object.keys(o.headers))a[l]=o.headers[l];throw new Kfe(s,a,o.data)}return o.data.data})}function QC(t,e){const r=t.defaults(e);return Object.assign((s,i)=>Zfe(r,s,i),{defaults:QC.bind(null,r),endpoint:r.endpoint})}QC(gx,{headers:{"user-agent":`octokit-graphql.js/${Wfe} ${ib()}`},method:"POST",url:"/graphql"});function Jfe(t){return QC(t,{method:"POST",url:"/graphql"})}var Qfe=/^v1\./,epe=/^ghs_/,tpe=/^ghu_/;async function rpe(t){const e=t.split(/\./).length===3,r=Qfe.test(t)||epe.test(t),n=tpe.test(t);return{type:"token",token:t,tokenType:e?"app":r?"installation":n?"user-to-server":"oauth"}}function npe(t){return t.split(/\./).length===3?`bearer ${t}`:`token ${t}`}async function spe(t,e,r,n){const s=e.endpoint.merge(r,n);return s.headers.authorization=npe(t),e(s)}var ipe=function(e){if(!e)throw new Error("[@octokit/auth-token] No token passed to createTokenAuth");if(typeof e!="string")throw new Error("[@octokit/auth-token] Token passed to createTokenAuth is not a string");return e=e.replace(/^(token|bearer) +/i,""),Object.assign(rpe.bind(null,e),{hook:spe.bind(null,e)})};const ej="6.1.2",RP=()=>{},ope=console.warn.bind(console),ape=console.error.bind(console),IP=`octokit-core.js/${ej} ${ib()}`;let lpe=class{static VERSION=ej;static defaults(e){return class extends this{constructor(...n){const s=n[0]||{};if(typeof e=="function"){super(e(s));return}super(Object.assign({},e,s,s.userAgent&&e.userAgent?{userAgent:`${s.userAgent} ${e.userAgent}`}:null))}}}static plugins=[];static plugin(...e){const r=this.plugins;return class extends this{static plugins=r.concat(e.filter(s=>!r.includes(s)))}}constructor(e={}){const r=new kfe.Collection,n={baseUrl:gx.endpoint.DEFAULTS.baseUrl,headers:{},request:Object.assign({},e.request,{hook:r.bind(null,"request")}),mediaType:{previews:[],format:""}};if(n.headers["user-agent"]=e.userAgent?`${e.userAgent} ${IP}`:IP,e.baseUrl&&(n.baseUrl=e.baseUrl),e.previews&&(n.mediaType.previews=e.previews),e.timeZone&&(n.headers["time-zone"]=e.timeZone),this.request=gx.defaults(n),this.graphql=Jfe(this.request).defaults(n),this.log=Object.assign({debug:RP,info:RP,warn:ope,error:ape},e.log),this.hook=r,e.authStrategy){const{authStrategy:i,...o}=e,a=i(Object.assign({request:this.request,log:this.log,octokit:this,octokitOptions:o},e.auth));r.wrap("request",a.hook),this.auth=a}else if(!e.auth)this.auth=async()=>({type:"unauthenticated"});else{const i=ipe(e.auth);r.wrap("request",i.hook),this.auth=i}const s=this.constructor;for(let i=0;i<s.plugins.length;++i)Object.assign(this,s.plugins[i](this,e))}request;graphql;log;hook;auth};const cpe="5.3.1";function tj(t){t.hook.wrap("request",(e,r)=>{t.log.debug("request",r);const n=Date.now(),s=t.request.endpoint.parse(r),i=s.url.replace(r.baseUrl,"");return e(r).then(o=>{const a=o.headers["x-github-request-id"];return t.log.info(`${s.method} ${i} - ${o.status} with id ${a} in ${Date.now()-n}ms`),o}).catch(o=>{const a=o.response?.headers["x-github-request-id"]||"UNKNOWN";throw t.log.error(`${s.method} ${i} - ${o.status} with id ${a} in ${Date.now()-n}ms`),o})})}tj.VERSION=cpe;var upe="0.0.0-development";function hpe(t){if(!t.data)return{...t,data:[]};if(!("total_count"in t.data&&!("url"in t.data)))return t;const r=t.data.incomplete_results,n=t.data.repository_selection,s=t.data.total_count;delete t.data.incomplete_results,delete t.data.repository_selection,delete t.data.total_count;const i=Object.keys(t.data)[0],o=t.data[i];return t.data=o,typeof r<"u"&&(t.data.incomplete_results=r),typeof n<"u"&&(t.data.repository_selection=n),t.data.total_count=s,t}function ek(t,e,r){const n=typeof e=="function"?e.endpoint(r):t.request.endpoint(e,r),s=typeof e=="function"?e:t.request,i=n.method,o=n.headers;let a=n.url;return{[Symbol.asyncIterator]:()=>({async next(){if(!a)return{done:!0};try{const l=await s({method:i,url:a,headers:o}),c=hpe(l);return a=((c.headers.link||"").match(/<([^>]+)>;\s*rel="next"/)||[])[1],{value:c}}catch(l){if(l.status!==409)throw l;return a="",{value:{status:200,headers:{},data:[]}}}}})}}function rj(t,e,r,n){return typeof r=="function"&&(n=r,r=void 0),nj(t,[],ek(t,e,r)[Symbol.asyncIterator](),n)}function nj(t,e,r,n){return r.next().then(s=>{if(s.done)return e;let i=!1;function o(){i=!0}return e=e.concat(n?n(s.value,o):s.value.data),i?e:nj(t,e,r,n)})}Object.assign(rj,{iterator:ek});function sj(t){return{paginate:Object.assign(rj.bind(null,t),{iterator:ek.bind(null,t)})}}sj.VERSION=upe;const dpe="13.2.6",fpe={actions:{addCustomLabelsToSelfHostedRunnerForOrg:["POST /orgs/{org}/actions/runners/{runner_id}/labels"],addCustomLabelsToSelfHostedRunnerForRepo:["POST /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],addSelectedRepoToOrgSecret:["PUT /orgs/{org}/actions/secrets/{secret_name}/repositories/{repository_id}"],addSelectedRepoToOrgVariable:["PUT /orgs/{org}/actions/variables/{name}/repositories/{repository_id}"],approveWorkflowRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/approve"],cancelWorkflowRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/cancel"],createEnvironmentVariable:["POST /repos/{owner}/{repo}/environments/{environment_name}/variables"],createOrUpdateEnvironmentSecret:["PUT /repos/{owner}/{repo}/environments/{environment_name}/secrets/{secret_name}"],createOrUpdateOrgSecret:["PUT /orgs/{org}/actions/secrets/{secret_name}"],createOrUpdateRepoSecret:["PUT /repos/{owner}/{repo}/actions/secrets/{secret_name}"],createOrgVariable:["POST /orgs/{org}/actions/variables"],createRegistrationTokenForOrg:["POST /orgs/{org}/actions/runners/registration-token"],createRegistrationTokenForRepo:["POST /repos/{owner}/{repo}/actions/runners/registration-token"],createRemoveTokenForOrg:["POST /orgs/{org}/actions/runners/remove-token"],createRemoveTokenForRepo:["POST /repos/{owner}/{repo}/actions/runners/remove-token"],createRepoVariable:["POST /repos/{owner}/{repo}/actions/variables"],createWorkflowDispatch:["POST /repos/{owner}/{repo}/actions/workflows/{workflow_id}/dispatches"],deleteActionsCacheById:["DELETE /repos/{owner}/{repo}/actions/caches/{cache_id}"],deleteActionsCacheByKey:["DELETE /repos/{owner}/{repo}/actions/caches{?key,ref}"],deleteArtifact:["DELETE /repos/{owner}/{repo}/actions/artifacts/{artifact_id}"],deleteEnvironmentSecret:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/secrets/{secret_name}"],deleteEnvironmentVariable:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/variables/{name}"],deleteOrgSecret:["DELETE /orgs/{org}/actions/secrets/{secret_name}"],deleteOrgVariable:["DELETE /orgs/{org}/actions/variables/{name}"],deleteRepoSecret:["DELETE /repos/{owner}/{repo}/actions/secrets/{secret_name}"],deleteRepoVariable:["DELETE /repos/{owner}/{repo}/actions/variables/{name}"],deleteSelfHostedRunnerFromOrg:["DELETE /orgs/{org}/actions/runners/{runner_id}"],deleteSelfHostedRunnerFromRepo:["DELETE /repos/{owner}/{repo}/actions/runners/{runner_id}"],deleteWorkflowRun:["DELETE /repos/{owner}/{repo}/actions/runs/{run_id}"],deleteWorkflowRunLogs:["DELETE /repos/{owner}/{repo}/actions/runs/{run_id}/logs"],disableSelectedRepositoryGithubActionsOrganization:["DELETE /orgs/{org}/actions/permissions/repositories/{repository_id}"],disableWorkflow:["PUT /repos/{owner}/{repo}/actions/workflows/{workflow_id}/disable"],downloadArtifact:["GET /repos/{owner}/{repo}/actions/artifacts/{artifact_id}/{archive_format}"],downloadJobLogsForWorkflowRun:["GET /repos/{owner}/{repo}/actions/jobs/{job_id}/logs"],downloadWorkflowRunAttemptLogs:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt_number}/logs"],downloadWorkflowRunLogs:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/logs"],enableSelectedRepositoryGithubActionsOrganization:["PUT /orgs/{org}/actions/permissions/repositories/{repository_id}"],enableWorkflow:["PUT /repos/{owner}/{repo}/actions/workflows/{workflow_id}/enable"],forceCancelWorkflowRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/force-cancel"],generateRunnerJitconfigForOrg:["POST /orgs/{org}/actions/runners/generate-jitconfig"],generateRunnerJitconfigForRepo:["POST /repos/{owner}/{repo}/actions/runners/generate-jitconfig"],getActionsCacheList:["GET /repos/{owner}/{repo}/actions/caches"],getActionsCacheUsage:["GET /repos/{owner}/{repo}/actions/cache/usage"],getActionsCacheUsageByRepoForOrg:["GET /orgs/{org}/actions/cache/usage-by-repository"],getActionsCacheUsageForOrg:["GET /orgs/{org}/actions/cache/usage"],getAllowedActionsOrganization:["GET /orgs/{org}/actions/permissions/selected-actions"],getAllowedActionsRepository:["GET /repos/{owner}/{repo}/actions/permissions/selected-actions"],getArtifact:["GET /repos/{owner}/{repo}/actions/artifacts/{artifact_id}"],getCustomOidcSubClaimForRepo:["GET /repos/{owner}/{repo}/actions/oidc/customization/sub"],getEnvironmentPublicKey:["GET /repos/{owner}/{repo}/environments/{environment_name}/secrets/public-key"],getEnvironmentSecret:["GET /repos/{owner}/{repo}/environments/{environment_name}/secrets/{secret_name}"],getEnvironmentVariable:["GET /repos/{owner}/{repo}/environments/{environment_name}/variables/{name}"],getGithubActionsDefaultWorkflowPermissionsOrganization:["GET /orgs/{org}/actions/permissions/workflow"],getGithubActionsDefaultWorkflowPermissionsRepository:["GET /repos/{owner}/{repo}/actions/permissions/workflow"],getGithubActionsPermissionsOrganization:["GET /orgs/{org}/actions/permissions"],getGithubActionsPermissionsRepository:["GET /repos/{owner}/{repo}/actions/permissions"],getJobForWorkflowRun:["GET /repos/{owner}/{repo}/actions/jobs/{job_id}"],getOrgPublicKey:["GET /orgs/{org}/actions/secrets/public-key"],getOrgSecret:["GET /orgs/{org}/actions/secrets/{secret_name}"],getOrgVariable:["GET /orgs/{org}/actions/variables/{name}"],getPendingDeploymentsForRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/pending_deployments"],getRepoPermissions:["GET /repos/{owner}/{repo}/actions/permissions",{},{renamed:["actions","getGithubActionsPermissionsRepository"]}],getRepoPublicKey:["GET /repos/{owner}/{repo}/actions/secrets/public-key"],getRepoSecret:["GET /repos/{owner}/{repo}/actions/secrets/{secret_name}"],getRepoVariable:["GET /repos/{owner}/{repo}/actions/variables/{name}"],getReviewsForRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/approvals"],getSelfHostedRunnerForOrg:["GET /orgs/{org}/actions/runners/{runner_id}"],getSelfHostedRunnerForRepo:["GET /repos/{owner}/{repo}/actions/runners/{runner_id}"],getWorkflow:["GET /repos/{owner}/{repo}/actions/workflows/{workflow_id}"],getWorkflowAccessToRepository:["GET /repos/{owner}/{repo}/actions/permissions/access"],getWorkflowRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}"],getWorkflowRunAttempt:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt_number}"],getWorkflowRunUsage:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/timing"],getWorkflowUsage:["GET /repos/{owner}/{repo}/actions/workflows/{workflow_id}/timing"],listArtifactsForRepo:["GET /repos/{owner}/{repo}/actions/artifacts"],listEnvironmentSecrets:["GET /repos/{owner}/{repo}/environments/{environment_name}/secrets"],listEnvironmentVariables:["GET /repos/{owner}/{repo}/environments/{environment_name}/variables"],listJobsForWorkflowRun:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/jobs"],listJobsForWorkflowRunAttempt:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/attempts/{attempt_number}/jobs"],listLabelsForSelfHostedRunnerForOrg:["GET /orgs/{org}/actions/runners/{runner_id}/labels"],listLabelsForSelfHostedRunnerForRepo:["GET /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],listOrgSecrets:["GET /orgs/{org}/actions/secrets"],listOrgVariables:["GET /orgs/{org}/actions/variables"],listRepoOrganizationSecrets:["GET /repos/{owner}/{repo}/actions/organization-secrets"],listRepoOrganizationVariables:["GET /repos/{owner}/{repo}/actions/organization-variables"],listRepoSecrets:["GET /repos/{owner}/{repo}/actions/secrets"],listRepoVariables:["GET /repos/{owner}/{repo}/actions/variables"],listRepoWorkflows:["GET /repos/{owner}/{repo}/actions/workflows"],listRunnerApplicationsForOrg:["GET /orgs/{org}/actions/runners/downloads"],listRunnerApplicationsForRepo:["GET /repos/{owner}/{repo}/actions/runners/downloads"],listSelectedReposForOrgSecret:["GET /orgs/{org}/actions/secrets/{secret_name}/repositories"],listSelectedReposForOrgVariable:["GET /orgs/{org}/actions/variables/{name}/repositories"],listSelectedRepositoriesEnabledGithubActionsOrganization:["GET /orgs/{org}/actions/permissions/repositories"],listSelfHostedRunnersForOrg:["GET /orgs/{org}/actions/runners"],listSelfHostedRunnersForRepo:["GET /repos/{owner}/{repo}/actions/runners"],listWorkflowRunArtifacts:["GET /repos/{owner}/{repo}/actions/runs/{run_id}/artifacts"],listWorkflowRuns:["GET /repos/{owner}/{repo}/actions/workflows/{workflow_id}/runs"],listWorkflowRunsForRepo:["GET /repos/{owner}/{repo}/actions/runs"],reRunJobForWorkflowRun:["POST /repos/{owner}/{repo}/actions/jobs/{job_id}/rerun"],reRunWorkflow:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/rerun"],reRunWorkflowFailedJobs:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/rerun-failed-jobs"],removeAllCustomLabelsFromSelfHostedRunnerForOrg:["DELETE /orgs/{org}/actions/runners/{runner_id}/labels"],removeAllCustomLabelsFromSelfHostedRunnerForRepo:["DELETE /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],removeCustomLabelFromSelfHostedRunnerForOrg:["DELETE /orgs/{org}/actions/runners/{runner_id}/labels/{name}"],removeCustomLabelFromSelfHostedRunnerForRepo:["DELETE /repos/{owner}/{repo}/actions/runners/{runner_id}/labels/{name}"],removeSelectedRepoFromOrgSecret:["DELETE /orgs/{org}/actions/secrets/{secret_name}/repositories/{repository_id}"],removeSelectedRepoFromOrgVariable:["DELETE /orgs/{org}/actions/variables/{name}/repositories/{repository_id}"],reviewCustomGatesForRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/deployment_protection_rule"],reviewPendingDeploymentsForRun:["POST /repos/{owner}/{repo}/actions/runs/{run_id}/pending_deployments"],setAllowedActionsOrganization:["PUT /orgs/{org}/actions/permissions/selected-actions"],setAllowedActionsRepository:["PUT /repos/{owner}/{repo}/actions/permissions/selected-actions"],setCustomLabelsForSelfHostedRunnerForOrg:["PUT /orgs/{org}/actions/runners/{runner_id}/labels"],setCustomLabelsForSelfHostedRunnerForRepo:["PUT /repos/{owner}/{repo}/actions/runners/{runner_id}/labels"],setCustomOidcSubClaimForRepo:["PUT /repos/{owner}/{repo}/actions/oidc/customization/sub"],setGithubActionsDefaultWorkflowPermissionsOrganization:["PUT /orgs/{org}/actions/permissions/workflow"],setGithubActionsDefaultWorkflowPermissionsRepository:["PUT /repos/{owner}/{repo}/actions/permissions/workflow"],setGithubActionsPermissionsOrganization:["PUT /orgs/{org}/actions/permissions"],setGithubActionsPermissionsRepository:["PUT /repos/{owner}/{repo}/actions/permissions"],setSelectedReposForOrgSecret:["PUT /orgs/{org}/actions/secrets/{secret_name}/repositories"],setSelectedReposForOrgVariable:["PUT /orgs/{org}/actions/variables/{name}/repositories"],setSelectedRepositoriesEnabledGithubActionsOrganization:["PUT /orgs/{org}/actions/permissions/repositories"],setWorkflowAccessToRepository:["PUT /repos/{owner}/{repo}/actions/permissions/access"],updateEnvironmentVariable:["PATCH /repos/{owner}/{repo}/environments/{environment_name}/variables/{name}"],updateOrgVariable:["PATCH /orgs/{org}/actions/variables/{name}"],updateRepoVariable:["PATCH /repos/{owner}/{repo}/actions/variables/{name}"]},activity:{checkRepoIsStarredByAuthenticatedUser:["GET /user/starred/{owner}/{repo}"],deleteRepoSubscription:["DELETE /repos/{owner}/{repo}/subscription"],deleteThreadSubscription:["DELETE /notifications/threads/{thread_id}/subscription"],getFeeds:["GET /feeds"],getRepoSubscription:["GET /repos/{owner}/{repo}/subscription"],getThread:["GET /notifications/threads/{thread_id}"],getThreadSubscriptionForAuthenticatedUser:["GET /notifications/threads/{thread_id}/subscription"],listEventsForAuthenticatedUser:["GET /users/{username}/events"],listNotificationsForAuthenticatedUser:["GET /notifications"],listOrgEventsForAuthenticatedUser:["GET /users/{username}/events/orgs/{org}"],listPublicEvents:["GET /events"],listPublicEventsForRepoNetwork:["GET /networks/{owner}/{repo}/events"],listPublicEventsForUser:["GET /users/{username}/events/public"],listPublicOrgEvents:["GET /orgs/{org}/events"],listReceivedEventsForUser:["GET /users/{username}/received_events"],listReceivedPublicEventsForUser:["GET /users/{username}/received_events/public"],listRepoEvents:["GET /repos/{owner}/{repo}/events"],listRepoNotificationsForAuthenticatedUser:["GET /repos/{owner}/{repo}/notifications"],listReposStarredByAuthenticatedUser:["GET /user/starred"],listReposStarredByUser:["GET /users/{username}/starred"],listReposWatchedByUser:["GET /users/{username}/subscriptions"],listStargazersForRepo:["GET /repos/{owner}/{repo}/stargazers"],listWatchedReposForAuthenticatedUser:["GET /user/subscriptions"],listWatchersForRepo:["GET /repos/{owner}/{repo}/subscribers"],markNotificationsAsRead:["PUT /notifications"],markRepoNotificationsAsRead:["PUT /repos/{owner}/{repo}/notifications"],markThreadAsDone:["DELETE /notifications/threads/{thread_id}"],markThreadAsRead:["PATCH /notifications/threads/{thread_id}"],setRepoSubscription:["PUT /repos/{owner}/{repo}/subscription"],setThreadSubscription:["PUT /notifications/threads/{thread_id}/subscription"],starRepoForAuthenticatedUser:["PUT /user/starred/{owner}/{repo}"],unstarRepoForAuthenticatedUser:["DELETE /user/starred/{owner}/{repo}"]},apps:{addRepoToInstallation:["PUT /user/installations/{installation_id}/repositories/{repository_id}",{},{renamed:["apps","addRepoToInstallationForAuthenticatedUser"]}],addRepoToInstallationForAuthenticatedUser:["PUT /user/installations/{installation_id}/repositories/{repository_id}"],checkToken:["POST /applications/{client_id}/token"],createFromManifest:["POST /app-manifests/{code}/conversions"],createInstallationAccessToken:["POST /app/installations/{installation_id}/access_tokens"],deleteAuthorization:["DELETE /applications/{client_id}/grant"],deleteInstallation:["DELETE /app/installations/{installation_id}"],deleteToken:["DELETE /applications/{client_id}/token"],getAuthenticated:["GET /app"],getBySlug:["GET /apps/{app_slug}"],getInstallation:["GET /app/installations/{installation_id}"],getOrgInstallation:["GET /orgs/{org}/installation"],getRepoInstallation:["GET /repos/{owner}/{repo}/installation"],getSubscriptionPlanForAccount:["GET /marketplace_listing/accounts/{account_id}"],getSubscriptionPlanForAccountStubbed:["GET /marketplace_listing/stubbed/accounts/{account_id}"],getUserInstallation:["GET /users/{username}/installation"],getWebhookConfigForApp:["GET /app/hook/config"],getWebhookDelivery:["GET /app/hook/deliveries/{delivery_id}"],listAccountsForPlan:["GET /marketplace_listing/plans/{plan_id}/accounts"],listAccountsForPlanStubbed:["GET /marketplace_listing/stubbed/plans/{plan_id}/accounts"],listInstallationReposForAuthenticatedUser:["GET /user/installations/{installation_id}/repositories"],listInstallationRequestsForAuthenticatedApp:["GET /app/installation-requests"],listInstallations:["GET /app/installations"],listInstallationsForAuthenticatedUser:["GET /user/installations"],listPlans:["GET /marketplace_listing/plans"],listPlansStubbed:["GET /marketplace_listing/stubbed/plans"],listReposAccessibleToInstallation:["GET /installation/repositories"],listSubscriptionsForAuthenticatedUser:["GET /user/marketplace_purchases"],listSubscriptionsForAuthenticatedUserStubbed:["GET /user/marketplace_purchases/stubbed"],listWebhookDeliveries:["GET /app/hook/deliveries"],redeliverWebhookDelivery:["POST /app/hook/deliveries/{delivery_id}/attempts"],removeRepoFromInstallation:["DELETE /user/installations/{installation_id}/repositories/{repository_id}",{},{renamed:["apps","removeRepoFromInstallationForAuthenticatedUser"]}],removeRepoFromInstallationForAuthenticatedUser:["DELETE /user/installations/{installation_id}/repositories/{repository_id}"],resetToken:["PATCH /applications/{client_id}/token"],revokeInstallationAccessToken:["DELETE /installation/token"],scopeToken:["POST /applications/{client_id}/token/scoped"],suspendInstallation:["PUT /app/installations/{installation_id}/suspended"],unsuspendInstallation:["DELETE /app/installations/{installation_id}/suspended"],updateWebhookConfigForApp:["PATCH /app/hook/config"]},billing:{getGithubActionsBillingOrg:["GET /orgs/{org}/settings/billing/actions"],getGithubActionsBillingUser:["GET /users/{username}/settings/billing/actions"],getGithubPackagesBillingOrg:["GET /orgs/{org}/settings/billing/packages"],getGithubPackagesBillingUser:["GET /users/{username}/settings/billing/packages"],getSharedStorageBillingOrg:["GET /orgs/{org}/settings/billing/shared-storage"],getSharedStorageBillingUser:["GET /users/{username}/settings/billing/shared-storage"]},checks:{create:["POST /repos/{owner}/{repo}/check-runs"],createSuite:["POST /repos/{owner}/{repo}/check-suites"],get:["GET /repos/{owner}/{repo}/check-runs/{check_run_id}"],getSuite:["GET /repos/{owner}/{repo}/check-suites/{check_suite_id}"],listAnnotations:["GET /repos/{owner}/{repo}/check-runs/{check_run_id}/annotations"],listForRef:["GET /repos/{owner}/{repo}/commits/{ref}/check-runs"],listForSuite:["GET /repos/{owner}/{repo}/check-suites/{check_suite_id}/check-runs"],listSuitesForRef:["GET /repos/{owner}/{repo}/commits/{ref}/check-suites"],rerequestRun:["POST /repos/{owner}/{repo}/check-runs/{check_run_id}/rerequest"],rerequestSuite:["POST /repos/{owner}/{repo}/check-suites/{check_suite_id}/rerequest"],setSuitesPreferences:["PATCH /repos/{owner}/{repo}/check-suites/preferences"],update:["PATCH /repos/{owner}/{repo}/check-runs/{check_run_id}"]},codeScanning:{deleteAnalysis:["DELETE /repos/{owner}/{repo}/code-scanning/analyses/{analysis_id}{?confirm_delete}"],getAlert:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}",{},{renamedParameters:{alert_id:"alert_number"}}],getAnalysis:["GET /repos/{owner}/{repo}/code-scanning/analyses/{analysis_id}"],getCodeqlDatabase:["GET /repos/{owner}/{repo}/code-scanning/codeql/databases/{language}"],getDefaultSetup:["GET /repos/{owner}/{repo}/code-scanning/default-setup"],getSarif:["GET /repos/{owner}/{repo}/code-scanning/sarifs/{sarif_id}"],listAlertInstances:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/instances"],listAlertsForOrg:["GET /orgs/{org}/code-scanning/alerts"],listAlertsForRepo:["GET /repos/{owner}/{repo}/code-scanning/alerts"],listAlertsInstances:["GET /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}/instances",{},{renamed:["codeScanning","listAlertInstances"]}],listCodeqlDatabases:["GET /repos/{owner}/{repo}/code-scanning/codeql/databases"],listRecentAnalyses:["GET /repos/{owner}/{repo}/code-scanning/analyses"],updateAlert:["PATCH /repos/{owner}/{repo}/code-scanning/alerts/{alert_number}"],updateDefaultSetup:["PATCH /repos/{owner}/{repo}/code-scanning/default-setup"],uploadSarif:["POST /repos/{owner}/{repo}/code-scanning/sarifs"]},codesOfConduct:{getAllCodesOfConduct:["GET /codes_of_conduct"],getConductCode:["GET /codes_of_conduct/{key}"]},codespaces:{addRepositoryForSecretForAuthenticatedUser:["PUT /user/codespaces/secrets/{secret_name}/repositories/{repository_id}"],addSelectedRepoToOrgSecret:["PUT /orgs/{org}/codespaces/secrets/{secret_name}/repositories/{repository_id}"],checkPermissionsForDevcontainer:["GET /repos/{owner}/{repo}/codespaces/permissions_check"],codespaceMachinesForAuthenticatedUser:["GET /user/codespaces/{codespace_name}/machines"],createForAuthenticatedUser:["POST /user/codespaces"],createOrUpdateOrgSecret:["PUT /orgs/{org}/codespaces/secrets/{secret_name}"],createOrUpdateRepoSecret:["PUT /repos/{owner}/{repo}/codespaces/secrets/{secret_name}"],createOrUpdateSecretForAuthenticatedUser:["PUT /user/codespaces/secrets/{secret_name}"],createWithPrForAuthenticatedUser:["POST /repos/{owner}/{repo}/pulls/{pull_number}/codespaces"],createWithRepoForAuthenticatedUser:["POST /repos/{owner}/{repo}/codespaces"],deleteForAuthenticatedUser:["DELETE /user/codespaces/{codespace_name}"],deleteFromOrganization:["DELETE /orgs/{org}/members/{username}/codespaces/{codespace_name}"],deleteOrgSecret:["DELETE /orgs/{org}/codespaces/secrets/{secret_name}"],deleteRepoSecret:["DELETE /repos/{owner}/{repo}/codespaces/secrets/{secret_name}"],deleteSecretForAuthenticatedUser:["DELETE /user/codespaces/secrets/{secret_name}"],exportForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/exports"],getCodespacesForUserInOrg:["GET /orgs/{org}/members/{username}/codespaces"],getExportDetailsForAuthenticatedUser:["GET /user/codespaces/{codespace_name}/exports/{export_id}"],getForAuthenticatedUser:["GET /user/codespaces/{codespace_name}"],getOrgPublicKey:["GET /orgs/{org}/codespaces/secrets/public-key"],getOrgSecret:["GET /orgs/{org}/codespaces/secrets/{secret_name}"],getPublicKeyForAuthenticatedUser:["GET /user/codespaces/secrets/public-key"],getRepoPublicKey:["GET /repos/{owner}/{repo}/codespaces/secrets/public-key"],getRepoSecret:["GET /repos/{owner}/{repo}/codespaces/secrets/{secret_name}"],getSecretForAuthenticatedUser:["GET /user/codespaces/secrets/{secret_name}"],listDevcontainersInRepositoryForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces/devcontainers"],listForAuthenticatedUser:["GET /user/codespaces"],listInOrganization:["GET /orgs/{org}/codespaces",{},{renamedParameters:{org_id:"org"}}],listInRepositoryForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces"],listOrgSecrets:["GET /orgs/{org}/codespaces/secrets"],listRepoSecrets:["GET /repos/{owner}/{repo}/codespaces/secrets"],listRepositoriesForSecretForAuthenticatedUser:["GET /user/codespaces/secrets/{secret_name}/repositories"],listSecretsForAuthenticatedUser:["GET /user/codespaces/secrets"],listSelectedReposForOrgSecret:["GET /orgs/{org}/codespaces/secrets/{secret_name}/repositories"],preFlightWithRepoForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces/new"],publishForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/publish"],removeRepositoryForSecretForAuthenticatedUser:["DELETE /user/codespaces/secrets/{secret_name}/repositories/{repository_id}"],removeSelectedRepoFromOrgSecret:["DELETE /orgs/{org}/codespaces/secrets/{secret_name}/repositories/{repository_id}"],repoMachinesForAuthenticatedUser:["GET /repos/{owner}/{repo}/codespaces/machines"],setRepositoriesForSecretForAuthenticatedUser:["PUT /user/codespaces/secrets/{secret_name}/repositories"],setSelectedReposForOrgSecret:["PUT /orgs/{org}/codespaces/secrets/{secret_name}/repositories"],startForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/start"],stopForAuthenticatedUser:["POST /user/codespaces/{codespace_name}/stop"],stopInOrganization:["POST /orgs/{org}/members/{username}/codespaces/{codespace_name}/stop"],updateForAuthenticatedUser:["PATCH /user/codespaces/{codespace_name}"]},copilot:{addCopilotSeatsForTeams:["POST /orgs/{org}/copilot/billing/selected_teams"],addCopilotSeatsForUsers:["POST /orgs/{org}/copilot/billing/selected_users"],cancelCopilotSeatAssignmentForTeams:["DELETE /orgs/{org}/copilot/billing/selected_teams"],cancelCopilotSeatAssignmentForUsers:["DELETE /orgs/{org}/copilot/billing/selected_users"],getCopilotOrganizationDetails:["GET /orgs/{org}/copilot/billing"],getCopilotSeatDetailsForUser:["GET /orgs/{org}/members/{username}/copilot"],listCopilotSeats:["GET /orgs/{org}/copilot/billing/seats"],usageMetricsForEnterprise:["GET /enterprises/{enterprise}/copilot/usage"],usageMetricsForOrg:["GET /orgs/{org}/copilot/usage"],usageMetricsForTeam:["GET /orgs/{org}/team/{team_slug}/copilot/usage"]},dependabot:{addSelectedRepoToOrgSecret:["PUT /orgs/{org}/dependabot/secrets/{secret_name}/repositories/{repository_id}"],createOrUpdateOrgSecret:["PUT /orgs/{org}/dependabot/secrets/{secret_name}"],createOrUpdateRepoSecret:["PUT /repos/{owner}/{repo}/dependabot/secrets/{secret_name}"],deleteOrgSecret:["DELETE /orgs/{org}/dependabot/secrets/{secret_name}"],deleteRepoSecret:["DELETE /repos/{owner}/{repo}/dependabot/secrets/{secret_name}"],getAlert:["GET /repos/{owner}/{repo}/dependabot/alerts/{alert_number}"],getOrgPublicKey:["GET /orgs/{org}/dependabot/secrets/public-key"],getOrgSecret:["GET /orgs/{org}/dependabot/secrets/{secret_name}"],getRepoPublicKey:["GET /repos/{owner}/{repo}/dependabot/secrets/public-key"],getRepoSecret:["GET /repos/{owner}/{repo}/dependabot/secrets/{secret_name}"],listAlertsForEnterprise:["GET /enterprises/{enterprise}/dependabot/alerts"],listAlertsForOrg:["GET /orgs/{org}/dependabot/alerts"],listAlertsForRepo:["GET /repos/{owner}/{repo}/dependabot/alerts"],listOrgSecrets:["GET /orgs/{org}/dependabot/secrets"],listRepoSecrets:["GET /repos/{owner}/{repo}/dependabot/secrets"],listSelectedReposForOrgSecret:["GET /orgs/{org}/dependabot/secrets/{secret_name}/repositories"],removeSelectedRepoFromOrgSecret:["DELETE /orgs/{org}/dependabot/secrets/{secret_name}/repositories/{repository_id}"],setSelectedReposForOrgSecret:["PUT /orgs/{org}/dependabot/secrets/{secret_name}/repositories"],updateAlert:["PATCH /repos/{owner}/{repo}/dependabot/alerts/{alert_number}"]},dependencyGraph:{createRepositorySnapshot:["POST /repos/{owner}/{repo}/dependency-graph/snapshots"],diffRange:["GET /repos/{owner}/{repo}/dependency-graph/compare/{basehead}"],exportSbom:["GET /repos/{owner}/{repo}/dependency-graph/sbom"]},emojis:{get:["GET /emojis"]},gists:{checkIsStarred:["GET /gists/{gist_id}/star"],create:["POST /gists"],createComment:["POST /gists/{gist_id}/comments"],delete:["DELETE /gists/{gist_id}"],deleteComment:["DELETE /gists/{gist_id}/comments/{comment_id}"],fork:["POST /gists/{gist_id}/forks"],get:["GET /gists/{gist_id}"],getComment:["GET /gists/{gist_id}/comments/{comment_id}"],getRevision:["GET /gists/{gist_id}/{sha}"],list:["GET /gists"],listComments:["GET /gists/{gist_id}/comments"],listCommits:["GET /gists/{gist_id}/commits"],listForUser:["GET /users/{username}/gists"],listForks:["GET /gists/{gist_id}/forks"],listPublic:["GET /gists/public"],listStarred:["GET /gists/starred"],star:["PUT /gists/{gist_id}/star"],unstar:["DELETE /gists/{gist_id}/star"],update:["PATCH /gists/{gist_id}"],updateComment:["PATCH /gists/{gist_id}/comments/{comment_id}"]},git:{createBlob:["POST /repos/{owner}/{repo}/git/blobs"],createCommit:["POST /repos/{owner}/{repo}/git/commits"],createRef:["POST /repos/{owner}/{repo}/git/refs"],createTag:["POST /repos/{owner}/{repo}/git/tags"],createTree:["POST /repos/{owner}/{repo}/git/trees"],deleteRef:["DELETE /repos/{owner}/{repo}/git/refs/{ref}"],getBlob:["GET /repos/{owner}/{repo}/git/blobs/{file_sha}"],getCommit:["GET /repos/{owner}/{repo}/git/commits/{commit_sha}"],getRef:["GET /repos/{owner}/{repo}/git/ref/{ref}"],getTag:["GET /repos/{owner}/{repo}/git/tags/{tag_sha}"],getTree:["GET /repos/{owner}/{repo}/git/trees/{tree_sha}"],listMatchingRefs:["GET /repos/{owner}/{repo}/git/matching-refs/{ref}"],updateRef:["PATCH /repos/{owner}/{repo}/git/refs/{ref}"]},gitignore:{getAllTemplates:["GET /gitignore/templates"],getTemplate:["GET /gitignore/templates/{name}"]},interactions:{getRestrictionsForAuthenticatedUser:["GET /user/interaction-limits"],getRestrictionsForOrg:["GET /orgs/{org}/interaction-limits"],getRestrictionsForRepo:["GET /repos/{owner}/{repo}/interaction-limits"],getRestrictionsForYourPublicRepos:["GET /user/interaction-limits",{},{renamed:["interactions","getRestrictionsForAuthenticatedUser"]}],removeRestrictionsForAuthenticatedUser:["DELETE /user/interaction-limits"],removeRestrictionsForOrg:["DELETE /orgs/{org}/interaction-limits"],removeRestrictionsForRepo:["DELETE /repos/{owner}/{repo}/interaction-limits"],removeRestrictionsForYourPublicRepos:["DELETE /user/interaction-limits",{},{renamed:["interactions","removeRestrictionsForAuthenticatedUser"]}],setRestrictionsForAuthenticatedUser:["PUT /user/interaction-limits"],setRestrictionsForOrg:["PUT /orgs/{org}/interaction-limits"],setRestrictionsForRepo:["PUT /repos/{owner}/{repo}/interaction-limits"],setRestrictionsForYourPublicRepos:["PUT /user/interaction-limits",{},{renamed:["interactions","setRestrictionsForAuthenticatedUser"]}]},issues:{addAssignees:["POST /repos/{owner}/{repo}/issues/{issue_number}/assignees"],addLabels:["POST /repos/{owner}/{repo}/issues/{issue_number}/labels"],checkUserCanBeAssigned:["GET /repos/{owner}/{repo}/assignees/{assignee}"],checkUserCanBeAssignedToIssue:["GET /repos/{owner}/{repo}/issues/{issue_number}/assignees/{assignee}"],create:["POST /repos/{owner}/{repo}/issues"],createComment:["POST /repos/{owner}/{repo}/issues/{issue_number}/comments"],createLabel:["POST /repos/{owner}/{repo}/labels"],createMilestone:["POST /repos/{owner}/{repo}/milestones"],deleteComment:["DELETE /repos/{owner}/{repo}/issues/comments/{comment_id}"],deleteLabel:["DELETE /repos/{owner}/{repo}/labels/{name}"],deleteMilestone:["DELETE /repos/{owner}/{repo}/milestones/{milestone_number}"],get:["GET /repos/{owner}/{repo}/issues/{issue_number}"],getComment:["GET /repos/{owner}/{repo}/issues/comments/{comment_id}"],getEvent:["GET /repos/{owner}/{repo}/issues/events/{event_id}"],getLabel:["GET /repos/{owner}/{repo}/labels/{name}"],getMilestone:["GET /repos/{owner}/{repo}/milestones/{milestone_number}"],list:["GET /issues"],listAssignees:["GET /repos/{owner}/{repo}/assignees"],listComments:["GET /repos/{owner}/{repo}/issues/{issue_number}/comments"],listCommentsForRepo:["GET /repos/{owner}/{repo}/issues/comments"],listEvents:["GET /repos/{owner}/{repo}/issues/{issue_number}/events"],listEventsForRepo:["GET /repos/{owner}/{repo}/issues/events"],listEventsForTimeline:["GET /repos/{owner}/{repo}/issues/{issue_number}/timeline"],listForAuthenticatedUser:["GET /user/issues"],listForOrg:["GET /orgs/{org}/issues"],listForRepo:["GET /repos/{owner}/{repo}/issues"],listLabelsForMilestone:["GET /repos/{owner}/{repo}/milestones/{milestone_number}/labels"],listLabelsForRepo:["GET /repos/{owner}/{repo}/labels"],listLabelsOnIssue:["GET /repos/{owner}/{repo}/issues/{issue_number}/labels"],listMilestones:["GET /repos/{owner}/{repo}/milestones"],lock:["PUT /repos/{owner}/{repo}/issues/{issue_number}/lock"],removeAllLabels:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/labels"],removeAssignees:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/assignees"],removeLabel:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/labels/{name}"],setLabels:["PUT /repos/{owner}/{repo}/issues/{issue_number}/labels"],unlock:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/lock"],update:["PATCH /repos/{owner}/{repo}/issues/{issue_number}"],updateComment:["PATCH /repos/{owner}/{repo}/issues/comments/{comment_id}"],updateLabel:["PATCH /repos/{owner}/{repo}/labels/{name}"],updateMilestone:["PATCH /repos/{owner}/{repo}/milestones/{milestone_number}"]},licenses:{get:["GET /licenses/{license}"],getAllCommonlyUsed:["GET /licenses"],getForRepo:["GET /repos/{owner}/{repo}/license"]},markdown:{render:["POST /markdown"],renderRaw:["POST /markdown/raw",{headers:{"content-type":"text/plain; charset=utf-8"}}]},meta:{get:["GET /meta"],getAllVersions:["GET /versions"],getOctocat:["GET /octocat"],getZen:["GET /zen"],root:["GET /"]},migrations:{deleteArchiveForAuthenticatedUser:["DELETE /user/migrations/{migration_id}/archive"],deleteArchiveForOrg:["DELETE /orgs/{org}/migrations/{migration_id}/archive"],downloadArchiveForOrg:["GET /orgs/{org}/migrations/{migration_id}/archive"],getArchiveForAuthenticatedUser:["GET /user/migrations/{migration_id}/archive"],getStatusForAuthenticatedUser:["GET /user/migrations/{migration_id}"],getStatusForOrg:["GET /orgs/{org}/migrations/{migration_id}"],listForAuthenticatedUser:["GET /user/migrations"],listForOrg:["GET /orgs/{org}/migrations"],listReposForAuthenticatedUser:["GET /user/migrations/{migration_id}/repositories"],listReposForOrg:["GET /orgs/{org}/migrations/{migration_id}/repositories"],listReposForUser:["GET /user/migrations/{migration_id}/repositories",{},{renamed:["migrations","listReposForAuthenticatedUser"]}],startForAuthenticatedUser:["POST /user/migrations"],startForOrg:["POST /orgs/{org}/migrations"],unlockRepoForAuthenticatedUser:["DELETE /user/migrations/{migration_id}/repos/{repo_name}/lock"],unlockRepoForOrg:["DELETE /orgs/{org}/migrations/{migration_id}/repos/{repo_name}/lock"]},oidc:{getOidcCustomSubTemplateForOrg:["GET /orgs/{org}/actions/oidc/customization/sub"],updateOidcCustomSubTemplateForOrg:["PUT /orgs/{org}/actions/oidc/customization/sub"]},orgs:{addSecurityManagerTeam:["PUT /orgs/{org}/security-managers/teams/{team_slug}"],assignTeamToOrgRole:["PUT /orgs/{org}/organization-roles/teams/{team_slug}/{role_id}"],assignUserToOrgRole:["PUT /orgs/{org}/organization-roles/users/{username}/{role_id}"],blockUser:["PUT /orgs/{org}/blocks/{username}"],cancelInvitation:["DELETE /orgs/{org}/invitations/{invitation_id}"],checkBlockedUser:["GET /orgs/{org}/blocks/{username}"],checkMembershipForUser:["GET /orgs/{org}/members/{username}"],checkPublicMembershipForUser:["GET /orgs/{org}/public_members/{username}"],convertMemberToOutsideCollaborator:["PUT /orgs/{org}/outside_collaborators/{username}"],createCustomOrganizationRole:["POST /orgs/{org}/organization-roles"],createInvitation:["POST /orgs/{org}/invitations"],createOrUpdateCustomProperties:["PATCH /orgs/{org}/properties/schema"],createOrUpdateCustomPropertiesValuesForRepos:["PATCH /orgs/{org}/properties/values"],createOrUpdateCustomProperty:["PUT /orgs/{org}/properties/schema/{custom_property_name}"],createWebhook:["POST /orgs/{org}/hooks"],delete:["DELETE /orgs/{org}"],deleteCustomOrganizationRole:["DELETE /orgs/{org}/organization-roles/{role_id}"],deleteWebhook:["DELETE /orgs/{org}/hooks/{hook_id}"],enableOrDisableSecurityProductOnAllOrgRepos:["POST /orgs/{org}/{security_product}/{enablement}"],get:["GET /orgs/{org}"],getAllCustomProperties:["GET /orgs/{org}/properties/schema"],getCustomProperty:["GET /orgs/{org}/properties/schema/{custom_property_name}"],getMembershipForAuthenticatedUser:["GET /user/memberships/orgs/{org}"],getMembershipForUser:["GET /orgs/{org}/memberships/{username}"],getOrgRole:["GET /orgs/{org}/organization-roles/{role_id}"],getWebhook:["GET /orgs/{org}/hooks/{hook_id}"],getWebhookConfigForOrg:["GET /orgs/{org}/hooks/{hook_id}/config"],getWebhookDelivery:["GET /orgs/{org}/hooks/{hook_id}/deliveries/{delivery_id}"],list:["GET /organizations"],listAppInstallations:["GET /orgs/{org}/installations"],listBlockedUsers:["GET /orgs/{org}/blocks"],listCustomPropertiesValuesForRepos:["GET /orgs/{org}/properties/values"],listFailedInvitations:["GET /orgs/{org}/failed_invitations"],listForAuthenticatedUser:["GET /user/orgs"],listForUser:["GET /users/{username}/orgs"],listInvitationTeams:["GET /orgs/{org}/invitations/{invitation_id}/teams"],listMembers:["GET /orgs/{org}/members"],listMembershipsForAuthenticatedUser:["GET /user/memberships/orgs"],listOrgRoleTeams:["GET /orgs/{org}/organization-roles/{role_id}/teams"],listOrgRoleUsers:["GET /orgs/{org}/organization-roles/{role_id}/users"],listOrgRoles:["GET /orgs/{org}/organization-roles"],listOrganizationFineGrainedPermissions:["GET /orgs/{org}/organization-fine-grained-permissions"],listOutsideCollaborators:["GET /orgs/{org}/outside_collaborators"],listPatGrantRepositories:["GET /orgs/{org}/personal-access-tokens/{pat_id}/repositories"],listPatGrantRequestRepositories:["GET /orgs/{org}/personal-access-token-requests/{pat_request_id}/repositories"],listPatGrantRequests:["GET /orgs/{org}/personal-access-token-requests"],listPatGrants:["GET /orgs/{org}/personal-access-tokens"],listPendingInvitations:["GET /orgs/{org}/invitations"],listPublicMembers:["GET /orgs/{org}/public_members"],listSecurityManagerTeams:["GET /orgs/{org}/security-managers"],listWebhookDeliveries:["GET /orgs/{org}/hooks/{hook_id}/deliveries"],listWebhooks:["GET /orgs/{org}/hooks"],patchCustomOrganizationRole:["PATCH /orgs/{org}/organization-roles/{role_id}"],pingWebhook:["POST /orgs/{org}/hooks/{hook_id}/pings"],redeliverWebhookDelivery:["POST /orgs/{org}/hooks/{hook_id}/deliveries/{delivery_id}/attempts"],removeCustomProperty:["DELETE /orgs/{org}/properties/schema/{custom_property_name}"],removeMember:["DELETE /orgs/{org}/members/{username}"],removeMembershipForUser:["DELETE /orgs/{org}/memberships/{username}"],removeOutsideCollaborator:["DELETE /orgs/{org}/outside_collaborators/{username}"],removePublicMembershipForAuthenticatedUser:["DELETE /orgs/{org}/public_members/{username}"],removeSecurityManagerTeam:["DELETE /orgs/{org}/security-managers/teams/{team_slug}"],reviewPatGrantRequest:["POST /orgs/{org}/personal-access-token-requests/{pat_request_id}"],reviewPatGrantRequestsInBulk:["POST /orgs/{org}/personal-access-token-requests"],revokeAllOrgRolesTeam:["DELETE /orgs/{org}/organization-roles/teams/{team_slug}"],revokeAllOrgRolesUser:["DELETE /orgs/{org}/organization-roles/users/{username}"],revokeOrgRoleTeam:["DELETE /orgs/{org}/organization-roles/teams/{team_slug}/{role_id}"],revokeOrgRoleUser:["DELETE /orgs/{org}/organization-roles/users/{username}/{role_id}"],setMembershipForUser:["PUT /orgs/{org}/memberships/{username}"],setPublicMembershipForAuthenticatedUser:["PUT /orgs/{org}/public_members/{username}"],unblockUser:["DELETE /orgs/{org}/blocks/{username}"],update:["PATCH /orgs/{org}"],updateMembershipForAuthenticatedUser:["PATCH /user/memberships/orgs/{org}"],updatePatAccess:["POST /orgs/{org}/personal-access-tokens/{pat_id}"],updatePatAccesses:["POST /orgs/{org}/personal-access-tokens"],updateWebhook:["PATCH /orgs/{org}/hooks/{hook_id}"],updateWebhookConfigForOrg:["PATCH /orgs/{org}/hooks/{hook_id}/config"]},packages:{deletePackageForAuthenticatedUser:["DELETE /user/packages/{package_type}/{package_name}"],deletePackageForOrg:["DELETE /orgs/{org}/packages/{package_type}/{package_name}"],deletePackageForUser:["DELETE /users/{username}/packages/{package_type}/{package_name}"],deletePackageVersionForAuthenticatedUser:["DELETE /user/packages/{package_type}/{package_name}/versions/{package_version_id}"],deletePackageVersionForOrg:["DELETE /orgs/{org}/packages/{package_type}/{package_name}/versions/{package_version_id}"],deletePackageVersionForUser:["DELETE /users/{username}/packages/{package_type}/{package_name}/versions/{package_version_id}"],getAllPackageVersionsForAPackageOwnedByAnOrg:["GET /orgs/{org}/packages/{package_type}/{package_name}/versions",{},{renamed:["packages","getAllPackageVersionsForPackageOwnedByOrg"]}],getAllPackageVersionsForAPackageOwnedByTheAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}/versions",{},{renamed:["packages","getAllPackageVersionsForPackageOwnedByAuthenticatedUser"]}],getAllPackageVersionsForPackageOwnedByAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}/versions"],getAllPackageVersionsForPackageOwnedByOrg:["GET /orgs/{org}/packages/{package_type}/{package_name}/versions"],getAllPackageVersionsForPackageOwnedByUser:["GET /users/{username}/packages/{package_type}/{package_name}/versions"],getPackageForAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}"],getPackageForOrganization:["GET /orgs/{org}/packages/{package_type}/{package_name}"],getPackageForUser:["GET /users/{username}/packages/{package_type}/{package_name}"],getPackageVersionForAuthenticatedUser:["GET /user/packages/{package_type}/{package_name}/versions/{package_version_id}"],getPackageVersionForOrganization:["GET /orgs/{org}/packages/{package_type}/{package_name}/versions/{package_version_id}"],getPackageVersionForUser:["GET /users/{username}/packages/{package_type}/{package_name}/versions/{package_version_id}"],listDockerMigrationConflictingPackagesForAuthenticatedUser:["GET /user/docker/conflicts"],listDockerMigrationConflictingPackagesForOrganization:["GET /orgs/{org}/docker/conflicts"],listDockerMigrationConflictingPackagesForUser:["GET /users/{username}/docker/conflicts"],listPackagesForAuthenticatedUser:["GET /user/packages"],listPackagesForOrganization:["GET /orgs/{org}/packages"],listPackagesForUser:["GET /users/{username}/packages"],restorePackageForAuthenticatedUser:["POST /user/packages/{package_type}/{package_name}/restore{?token}"],restorePackageForOrg:["POST /orgs/{org}/packages/{package_type}/{package_name}/restore{?token}"],restorePackageForUser:["POST /users/{username}/packages/{package_type}/{package_name}/restore{?token}"],restorePackageVersionForAuthenticatedUser:["POST /user/packages/{package_type}/{package_name}/versions/{package_version_id}/restore"],restorePackageVersionForOrg:["POST /orgs/{org}/packages/{package_type}/{package_name}/versions/{package_version_id}/restore"],restorePackageVersionForUser:["POST /users/{username}/packages/{package_type}/{package_name}/versions/{package_version_id}/restore"]},projects:{addCollaborator:["PUT /projects/{project_id}/collaborators/{username}"],createCard:["POST /projects/columns/{column_id}/cards"],createColumn:["POST /projects/{project_id}/columns"],createForAuthenticatedUser:["POST /user/projects"],createForOrg:["POST /orgs/{org}/projects"],createForRepo:["POST /repos/{owner}/{repo}/projects"],delete:["DELETE /projects/{project_id}"],deleteCard:["DELETE /projects/columns/cards/{card_id}"],deleteColumn:["DELETE /projects/columns/{column_id}"],get:["GET /projects/{project_id}"],getCard:["GET /projects/columns/cards/{card_id}"],getColumn:["GET /projects/columns/{column_id}"],getPermissionForUser:["GET /projects/{project_id}/collaborators/{username}/permission"],listCards:["GET /projects/columns/{column_id}/cards"],listCollaborators:["GET /projects/{project_id}/collaborators"],listColumns:["GET /projects/{project_id}/columns"],listForOrg:["GET /orgs/{org}/projects"],listForRepo:["GET /repos/{owner}/{repo}/projects"],listForUser:["GET /users/{username}/projects"],moveCard:["POST /projects/columns/cards/{card_id}/moves"],moveColumn:["POST /projects/columns/{column_id}/moves"],removeCollaborator:["DELETE /projects/{project_id}/collaborators/{username}"],update:["PATCH /projects/{project_id}"],updateCard:["PATCH /projects/columns/cards/{card_id}"],updateColumn:["PATCH /projects/columns/{column_id}"]},pulls:{checkIfMerged:["GET /repos/{owner}/{repo}/pulls/{pull_number}/merge"],create:["POST /repos/{owner}/{repo}/pulls"],createReplyForReviewComment:["POST /repos/{owner}/{repo}/pulls/{pull_number}/comments/{comment_id}/replies"],createReview:["POST /repos/{owner}/{repo}/pulls/{pull_number}/reviews"],createReviewComment:["POST /repos/{owner}/{repo}/pulls/{pull_number}/comments"],deletePendingReview:["DELETE /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}"],deleteReviewComment:["DELETE /repos/{owner}/{repo}/pulls/comments/{comment_id}"],dismissReview:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}/dismissals"],get:["GET /repos/{owner}/{repo}/pulls/{pull_number}"],getReview:["GET /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}"],getReviewComment:["GET /repos/{owner}/{repo}/pulls/comments/{comment_id}"],list:["GET /repos/{owner}/{repo}/pulls"],listCommentsForReview:["GET /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}/comments"],listCommits:["GET /repos/{owner}/{repo}/pulls/{pull_number}/commits"],listFiles:["GET /repos/{owner}/{repo}/pulls/{pull_number}/files"],listRequestedReviewers:["GET /repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers"],listReviewComments:["GET /repos/{owner}/{repo}/pulls/{pull_number}/comments"],listReviewCommentsForRepo:["GET /repos/{owner}/{repo}/pulls/comments"],listReviews:["GET /repos/{owner}/{repo}/pulls/{pull_number}/reviews"],merge:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/merge"],removeRequestedReviewers:["DELETE /repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers"],requestReviewers:["POST /repos/{owner}/{repo}/pulls/{pull_number}/requested_reviewers"],submitReview:["POST /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}/events"],update:["PATCH /repos/{owner}/{repo}/pulls/{pull_number}"],updateBranch:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/update-branch"],updateReview:["PUT /repos/{owner}/{repo}/pulls/{pull_number}/reviews/{review_id}"],updateReviewComment:["PATCH /repos/{owner}/{repo}/pulls/comments/{comment_id}"]},rateLimit:{get:["GET /rate_limit"]},reactions:{createForCommitComment:["POST /repos/{owner}/{repo}/comments/{comment_id}/reactions"],createForIssue:["POST /repos/{owner}/{repo}/issues/{issue_number}/reactions"],createForIssueComment:["POST /repos/{owner}/{repo}/issues/comments/{comment_id}/reactions"],createForPullRequestReviewComment:["POST /repos/{owner}/{repo}/pulls/comments/{comment_id}/reactions"],createForRelease:["POST /repos/{owner}/{repo}/releases/{release_id}/reactions"],createForTeamDiscussionCommentInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}/reactions"],createForTeamDiscussionInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/reactions"],deleteForCommitComment:["DELETE /repos/{owner}/{repo}/comments/{comment_id}/reactions/{reaction_id}"],deleteForIssue:["DELETE /repos/{owner}/{repo}/issues/{issue_number}/reactions/{reaction_id}"],deleteForIssueComment:["DELETE /repos/{owner}/{repo}/issues/comments/{comment_id}/reactions/{reaction_id}"],deleteForPullRequestComment:["DELETE /repos/{owner}/{repo}/pulls/comments/{comment_id}/reactions/{reaction_id}"],deleteForRelease:["DELETE /repos/{owner}/{repo}/releases/{release_id}/reactions/{reaction_id}"],deleteForTeamDiscussion:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/reactions/{reaction_id}"],deleteForTeamDiscussionComment:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}/reactions/{reaction_id}"],listForCommitComment:["GET /repos/{owner}/{repo}/comments/{comment_id}/reactions"],listForIssue:["GET /repos/{owner}/{repo}/issues/{issue_number}/reactions"],listForIssueComment:["GET /repos/{owner}/{repo}/issues/comments/{comment_id}/reactions"],listForPullRequestReviewComment:["GET /repos/{owner}/{repo}/pulls/comments/{comment_id}/reactions"],listForRelease:["GET /repos/{owner}/{repo}/releases/{release_id}/reactions"],listForTeamDiscussionCommentInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}/reactions"],listForTeamDiscussionInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/reactions"]},repos:{acceptInvitation:["PATCH /user/repository_invitations/{invitation_id}",{},{renamed:["repos","acceptInvitationForAuthenticatedUser"]}],acceptInvitationForAuthenticatedUser:["PATCH /user/repository_invitations/{invitation_id}"],addAppAccessRestrictions:["POST /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps",{},{mapToData:"apps"}],addCollaborator:["PUT /repos/{owner}/{repo}/collaborators/{username}"],addStatusCheckContexts:["POST /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts",{},{mapToData:"contexts"}],addTeamAccessRestrictions:["POST /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams",{},{mapToData:"teams"}],addUserAccessRestrictions:["POST /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users",{},{mapToData:"users"}],cancelPagesDeployment:["POST /repos/{owner}/{repo}/pages/deployments/{pages_deployment_id}/cancel"],checkAutomatedSecurityFixes:["GET /repos/{owner}/{repo}/automated-security-fixes"],checkCollaborator:["GET /repos/{owner}/{repo}/collaborators/{username}"],checkPrivateVulnerabilityReporting:["GET /repos/{owner}/{repo}/private-vulnerability-reporting"],checkVulnerabilityAlerts:["GET /repos/{owner}/{repo}/vulnerability-alerts"],codeownersErrors:["GET /repos/{owner}/{repo}/codeowners/errors"],compareCommits:["GET /repos/{owner}/{repo}/compare/{base}...{head}"],compareCommitsWithBasehead:["GET /repos/{owner}/{repo}/compare/{basehead}"],createAutolink:["POST /repos/{owner}/{repo}/autolinks"],createCommitComment:["POST /repos/{owner}/{repo}/commits/{commit_sha}/comments"],createCommitSignatureProtection:["POST /repos/{owner}/{repo}/branches/{branch}/protection/required_signatures"],createCommitStatus:["POST /repos/{owner}/{repo}/statuses/{sha}"],createDeployKey:["POST /repos/{owner}/{repo}/keys"],createDeployment:["POST /repos/{owner}/{repo}/deployments"],createDeploymentBranchPolicy:["POST /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies"],createDeploymentProtectionRule:["POST /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules"],createDeploymentStatus:["POST /repos/{owner}/{repo}/deployments/{deployment_id}/statuses"],createDispatchEvent:["POST /repos/{owner}/{repo}/dispatches"],createForAuthenticatedUser:["POST /user/repos"],createFork:["POST /repos/{owner}/{repo}/forks"],createInOrg:["POST /orgs/{org}/repos"],createOrUpdateCustomPropertiesValues:["PATCH /repos/{owner}/{repo}/properties/values"],createOrUpdateEnvironment:["PUT /repos/{owner}/{repo}/environments/{environment_name}"],createOrUpdateFileContents:["PUT /repos/{owner}/{repo}/contents/{path}"],createOrgRuleset:["POST /orgs/{org}/rulesets"],createPagesDeployment:["POST /repos/{owner}/{repo}/pages/deployments"],createPagesSite:["POST /repos/{owner}/{repo}/pages"],createRelease:["POST /repos/{owner}/{repo}/releases"],createRepoRuleset:["POST /repos/{owner}/{repo}/rulesets"],createTagProtection:["POST /repos/{owner}/{repo}/tags/protection"],createUsingTemplate:["POST /repos/{template_owner}/{template_repo}/generate"],createWebhook:["POST /repos/{owner}/{repo}/hooks"],declineInvitation:["DELETE /user/repository_invitations/{invitation_id}",{},{renamed:["repos","declineInvitationForAuthenticatedUser"]}],declineInvitationForAuthenticatedUser:["DELETE /user/repository_invitations/{invitation_id}"],delete:["DELETE /repos/{owner}/{repo}"],deleteAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions"],deleteAdminBranchProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/enforce_admins"],deleteAnEnvironment:["DELETE /repos/{owner}/{repo}/environments/{environment_name}"],deleteAutolink:["DELETE /repos/{owner}/{repo}/autolinks/{autolink_id}"],deleteBranchProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection"],deleteCommitComment:["DELETE /repos/{owner}/{repo}/comments/{comment_id}"],deleteCommitSignatureProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_signatures"],deleteDeployKey:["DELETE /repos/{owner}/{repo}/keys/{key_id}"],deleteDeployment:["DELETE /repos/{owner}/{repo}/deployments/{deployment_id}"],deleteDeploymentBranchPolicy:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies/{branch_policy_id}"],deleteFile:["DELETE /repos/{owner}/{repo}/contents/{path}"],deleteInvitation:["DELETE /repos/{owner}/{repo}/invitations/{invitation_id}"],deleteOrgRuleset:["DELETE /orgs/{org}/rulesets/{ruleset_id}"],deletePagesSite:["DELETE /repos/{owner}/{repo}/pages"],deletePullRequestReviewProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_pull_request_reviews"],deleteRelease:["DELETE /repos/{owner}/{repo}/releases/{release_id}"],deleteReleaseAsset:["DELETE /repos/{owner}/{repo}/releases/assets/{asset_id}"],deleteRepoRuleset:["DELETE /repos/{owner}/{repo}/rulesets/{ruleset_id}"],deleteTagProtection:["DELETE /repos/{owner}/{repo}/tags/protection/{tag_protection_id}"],deleteWebhook:["DELETE /repos/{owner}/{repo}/hooks/{hook_id}"],disableAutomatedSecurityFixes:["DELETE /repos/{owner}/{repo}/automated-security-fixes"],disableDeploymentProtectionRule:["DELETE /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules/{protection_rule_id}"],disablePrivateVulnerabilityReporting:["DELETE /repos/{owner}/{repo}/private-vulnerability-reporting"],disableVulnerabilityAlerts:["DELETE /repos/{owner}/{repo}/vulnerability-alerts"],downloadArchive:["GET /repos/{owner}/{repo}/zipball/{ref}",{},{renamed:["repos","downloadZipballArchive"]}],downloadTarballArchive:["GET /repos/{owner}/{repo}/tarball/{ref}"],downloadZipballArchive:["GET /repos/{owner}/{repo}/zipball/{ref}"],enableAutomatedSecurityFixes:["PUT /repos/{owner}/{repo}/automated-security-fixes"],enablePrivateVulnerabilityReporting:["PUT /repos/{owner}/{repo}/private-vulnerability-reporting"],enableVulnerabilityAlerts:["PUT /repos/{owner}/{repo}/vulnerability-alerts"],generateReleaseNotes:["POST /repos/{owner}/{repo}/releases/generate-notes"],get:["GET /repos/{owner}/{repo}"],getAccessRestrictions:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions"],getAdminBranchProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/enforce_admins"],getAllDeploymentProtectionRules:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules"],getAllEnvironments:["GET /repos/{owner}/{repo}/environments"],getAllStatusCheckContexts:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts"],getAllTopics:["GET /repos/{owner}/{repo}/topics"],getAppsWithAccessToProtectedBranch:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps"],getAutolink:["GET /repos/{owner}/{repo}/autolinks/{autolink_id}"],getBranch:["GET /repos/{owner}/{repo}/branches/{branch}"],getBranchProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection"],getBranchRules:["GET /repos/{owner}/{repo}/rules/branches/{branch}"],getClones:["GET /repos/{owner}/{repo}/traffic/clones"],getCodeFrequencyStats:["GET /repos/{owner}/{repo}/stats/code_frequency"],getCollaboratorPermissionLevel:["GET /repos/{owner}/{repo}/collaborators/{username}/permission"],getCombinedStatusForRef:["GET /repos/{owner}/{repo}/commits/{ref}/status"],getCommit:["GET /repos/{owner}/{repo}/commits/{ref}"],getCommitActivityStats:["GET /repos/{owner}/{repo}/stats/commit_activity"],getCommitComment:["GET /repos/{owner}/{repo}/comments/{comment_id}"],getCommitSignatureProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_signatures"],getCommunityProfileMetrics:["GET /repos/{owner}/{repo}/community/profile"],getContent:["GET /repos/{owner}/{repo}/contents/{path}"],getContributorsStats:["GET /repos/{owner}/{repo}/stats/contributors"],getCustomDeploymentProtectionRule:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules/{protection_rule_id}"],getCustomPropertiesValues:["GET /repos/{owner}/{repo}/properties/values"],getDeployKey:["GET /repos/{owner}/{repo}/keys/{key_id}"],getDeployment:["GET /repos/{owner}/{repo}/deployments/{deployment_id}"],getDeploymentBranchPolicy:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies/{branch_policy_id}"],getDeploymentStatus:["GET /repos/{owner}/{repo}/deployments/{deployment_id}/statuses/{status_id}"],getEnvironment:["GET /repos/{owner}/{repo}/environments/{environment_name}"],getLatestPagesBuild:["GET /repos/{owner}/{repo}/pages/builds/latest"],getLatestRelease:["GET /repos/{owner}/{repo}/releases/latest"],getOrgRuleSuite:["GET /orgs/{org}/rulesets/rule-suites/{rule_suite_id}"],getOrgRuleSuites:["GET /orgs/{org}/rulesets/rule-suites"],getOrgRuleset:["GET /orgs/{org}/rulesets/{ruleset_id}"],getOrgRulesets:["GET /orgs/{org}/rulesets"],getPages:["GET /repos/{owner}/{repo}/pages"],getPagesBuild:["GET /repos/{owner}/{repo}/pages/builds/{build_id}"],getPagesDeployment:["GET /repos/{owner}/{repo}/pages/deployments/{pages_deployment_id}"],getPagesHealthCheck:["GET /repos/{owner}/{repo}/pages/health"],getParticipationStats:["GET /repos/{owner}/{repo}/stats/participation"],getPullRequestReviewProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_pull_request_reviews"],getPunchCardStats:["GET /repos/{owner}/{repo}/stats/punch_card"],getReadme:["GET /repos/{owner}/{repo}/readme"],getReadmeInDirectory:["GET /repos/{owner}/{repo}/readme/{dir}"],getRelease:["GET /repos/{owner}/{repo}/releases/{release_id}"],getReleaseAsset:["GET /repos/{owner}/{repo}/releases/assets/{asset_id}"],getReleaseByTag:["GET /repos/{owner}/{repo}/releases/tags/{tag}"],getRepoRuleSuite:["GET /repos/{owner}/{repo}/rulesets/rule-suites/{rule_suite_id}"],getRepoRuleSuites:["GET /repos/{owner}/{repo}/rulesets/rule-suites"],getRepoRuleset:["GET /repos/{owner}/{repo}/rulesets/{ruleset_id}"],getRepoRulesets:["GET /repos/{owner}/{repo}/rulesets"],getStatusChecksProtection:["GET /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks"],getTeamsWithAccessToProtectedBranch:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams"],getTopPaths:["GET /repos/{owner}/{repo}/traffic/popular/paths"],getTopReferrers:["GET /repos/{owner}/{repo}/traffic/popular/referrers"],getUsersWithAccessToProtectedBranch:["GET /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users"],getViews:["GET /repos/{owner}/{repo}/traffic/views"],getWebhook:["GET /repos/{owner}/{repo}/hooks/{hook_id}"],getWebhookConfigForRepo:["GET /repos/{owner}/{repo}/hooks/{hook_id}/config"],getWebhookDelivery:["GET /repos/{owner}/{repo}/hooks/{hook_id}/deliveries/{delivery_id}"],listActivities:["GET /repos/{owner}/{repo}/activity"],listAutolinks:["GET /repos/{owner}/{repo}/autolinks"],listBranches:["GET /repos/{owner}/{repo}/branches"],listBranchesForHeadCommit:["GET /repos/{owner}/{repo}/commits/{commit_sha}/branches-where-head"],listCollaborators:["GET /repos/{owner}/{repo}/collaborators"],listCommentsForCommit:["GET /repos/{owner}/{repo}/commits/{commit_sha}/comments"],listCommitCommentsForRepo:["GET /repos/{owner}/{repo}/comments"],listCommitStatusesForRef:["GET /repos/{owner}/{repo}/commits/{ref}/statuses"],listCommits:["GET /repos/{owner}/{repo}/commits"],listContributors:["GET /repos/{owner}/{repo}/contributors"],listCustomDeploymentRuleIntegrations:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment_protection_rules/apps"],listDeployKeys:["GET /repos/{owner}/{repo}/keys"],listDeploymentBranchPolicies:["GET /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies"],listDeploymentStatuses:["GET /repos/{owner}/{repo}/deployments/{deployment_id}/statuses"],listDeployments:["GET /repos/{owner}/{repo}/deployments"],listForAuthenticatedUser:["GET /user/repos"],listForOrg:["GET /orgs/{org}/repos"],listForUser:["GET /users/{username}/repos"],listForks:["GET /repos/{owner}/{repo}/forks"],listInvitations:["GET /repos/{owner}/{repo}/invitations"],listInvitationsForAuthenticatedUser:["GET /user/repository_invitations"],listLanguages:["GET /repos/{owner}/{repo}/languages"],listPagesBuilds:["GET /repos/{owner}/{repo}/pages/builds"],listPublic:["GET /repositories"],listPullRequestsAssociatedWithCommit:["GET /repos/{owner}/{repo}/commits/{commit_sha}/pulls"],listReleaseAssets:["GET /repos/{owner}/{repo}/releases/{release_id}/assets"],listReleases:["GET /repos/{owner}/{repo}/releases"],listTagProtection:["GET /repos/{owner}/{repo}/tags/protection"],listTags:["GET /repos/{owner}/{repo}/tags"],listTeams:["GET /repos/{owner}/{repo}/teams"],listWebhookDeliveries:["GET /repos/{owner}/{repo}/hooks/{hook_id}/deliveries"],listWebhooks:["GET /repos/{owner}/{repo}/hooks"],merge:["POST /repos/{owner}/{repo}/merges"],mergeUpstream:["POST /repos/{owner}/{repo}/merge-upstream"],pingWebhook:["POST /repos/{owner}/{repo}/hooks/{hook_id}/pings"],redeliverWebhookDelivery:["POST /repos/{owner}/{repo}/hooks/{hook_id}/deliveries/{delivery_id}/attempts"],removeAppAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps",{},{mapToData:"apps"}],removeCollaborator:["DELETE /repos/{owner}/{repo}/collaborators/{username}"],removeStatusCheckContexts:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts",{},{mapToData:"contexts"}],removeStatusCheckProtection:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks"],removeTeamAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams",{},{mapToData:"teams"}],removeUserAccessRestrictions:["DELETE /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users",{},{mapToData:"users"}],renameBranch:["POST /repos/{owner}/{repo}/branches/{branch}/rename"],replaceAllTopics:["PUT /repos/{owner}/{repo}/topics"],requestPagesBuild:["POST /repos/{owner}/{repo}/pages/builds"],setAdminBranchProtection:["POST /repos/{owner}/{repo}/branches/{branch}/protection/enforce_admins"],setAppAccessRestrictions:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/apps",{},{mapToData:"apps"}],setStatusCheckContexts:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks/contexts",{},{mapToData:"contexts"}],setTeamAccessRestrictions:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/teams",{},{mapToData:"teams"}],setUserAccessRestrictions:["PUT /repos/{owner}/{repo}/branches/{branch}/protection/restrictions/users",{},{mapToData:"users"}],testPushWebhook:["POST /repos/{owner}/{repo}/hooks/{hook_id}/tests"],transfer:["POST /repos/{owner}/{repo}/transfer"],update:["PATCH /repos/{owner}/{repo}"],updateBranchProtection:["PUT /repos/{owner}/{repo}/branches/{branch}/protection"],updateCommitComment:["PATCH /repos/{owner}/{repo}/comments/{comment_id}"],updateDeploymentBranchPolicy:["PUT /repos/{owner}/{repo}/environments/{environment_name}/deployment-branch-policies/{branch_policy_id}"],updateInformationAboutPagesSite:["PUT /repos/{owner}/{repo}/pages"],updateInvitation:["PATCH /repos/{owner}/{repo}/invitations/{invitation_id}"],updateOrgRuleset:["PUT /orgs/{org}/rulesets/{ruleset_id}"],updatePullRequestReviewProtection:["PATCH /repos/{owner}/{repo}/branches/{branch}/protection/required_pull_request_reviews"],updateRelease:["PATCH /repos/{owner}/{repo}/releases/{release_id}"],updateReleaseAsset:["PATCH /repos/{owner}/{repo}/releases/assets/{asset_id}"],updateRepoRuleset:["PUT /repos/{owner}/{repo}/rulesets/{ruleset_id}"],updateStatusCheckPotection:["PATCH /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks",{},{renamed:["repos","updateStatusCheckProtection"]}],updateStatusCheckProtection:["PATCH /repos/{owner}/{repo}/branches/{branch}/protection/required_status_checks"],updateWebhook:["PATCH /repos/{owner}/{repo}/hooks/{hook_id}"],updateWebhookConfigForRepo:["PATCH /repos/{owner}/{repo}/hooks/{hook_id}/config"],uploadReleaseAsset:["POST /repos/{owner}/{repo}/releases/{release_id}/assets{?name,label}",{baseUrl:"https://uploads.github.com"}]},search:{code:["GET /search/code"],commits:["GET /search/commits"],issuesAndPullRequests:["GET /search/issues"],labels:["GET /search/labels"],repos:["GET /search/repositories"],topics:["GET /search/topics"],users:["GET /search/users"]},secretScanning:{getAlert:["GET /repos/{owner}/{repo}/secret-scanning/alerts/{alert_number}"],listAlertsForEnterprise:["GET /enterprises/{enterprise}/secret-scanning/alerts"],listAlertsForOrg:["GET /orgs/{org}/secret-scanning/alerts"],listAlertsForRepo:["GET /repos/{owner}/{repo}/secret-scanning/alerts"],listLocationsForAlert:["GET /repos/{owner}/{repo}/secret-scanning/alerts/{alert_number}/locations"],updateAlert:["PATCH /repos/{owner}/{repo}/secret-scanning/alerts/{alert_number}"]},securityAdvisories:{createFork:["POST /repos/{owner}/{repo}/security-advisories/{ghsa_id}/forks"],createPrivateVulnerabilityReport:["POST /repos/{owner}/{repo}/security-advisories/reports"],createRepositoryAdvisory:["POST /repos/{owner}/{repo}/security-advisories"],createRepositoryAdvisoryCveRequest:["POST /repos/{owner}/{repo}/security-advisories/{ghsa_id}/cve"],getGlobalAdvisory:["GET /advisories/{ghsa_id}"],getRepositoryAdvisory:["GET /repos/{owner}/{repo}/security-advisories/{ghsa_id}"],listGlobalAdvisories:["GET /advisories"],listOrgRepositoryAdvisories:["GET /orgs/{org}/security-advisories"],listRepositoryAdvisories:["GET /repos/{owner}/{repo}/security-advisories"],updateRepositoryAdvisory:["PATCH /repos/{owner}/{repo}/security-advisories/{ghsa_id}"]},teams:{addOrUpdateMembershipForUserInOrg:["PUT /orgs/{org}/teams/{team_slug}/memberships/{username}"],addOrUpdateProjectPermissionsInOrg:["PUT /orgs/{org}/teams/{team_slug}/projects/{project_id}"],addOrUpdateRepoPermissionsInOrg:["PUT /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}"],checkPermissionsForProjectInOrg:["GET /orgs/{org}/teams/{team_slug}/projects/{project_id}"],checkPermissionsForRepoInOrg:["GET /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}"],create:["POST /orgs/{org}/teams"],createDiscussionCommentInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments"],createDiscussionInOrg:["POST /orgs/{org}/teams/{team_slug}/discussions"],deleteDiscussionCommentInOrg:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}"],deleteDiscussionInOrg:["DELETE /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}"],deleteInOrg:["DELETE /orgs/{org}/teams/{team_slug}"],getByName:["GET /orgs/{org}/teams/{team_slug}"],getDiscussionCommentInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}"],getDiscussionInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}"],getMembershipForUserInOrg:["GET /orgs/{org}/teams/{team_slug}/memberships/{username}"],list:["GET /orgs/{org}/teams"],listChildInOrg:["GET /orgs/{org}/teams/{team_slug}/teams"],listDiscussionCommentsInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments"],listDiscussionsInOrg:["GET /orgs/{org}/teams/{team_slug}/discussions"],listForAuthenticatedUser:["GET /user/teams"],listMembersInOrg:["GET /orgs/{org}/teams/{team_slug}/members"],listPendingInvitationsInOrg:["GET /orgs/{org}/teams/{team_slug}/invitations"],listProjectsInOrg:["GET /orgs/{org}/teams/{team_slug}/projects"],listReposInOrg:["GET /orgs/{org}/teams/{team_slug}/repos"],removeMembershipForUserInOrg:["DELETE /orgs/{org}/teams/{team_slug}/memberships/{username}"],removeProjectInOrg:["DELETE /orgs/{org}/teams/{team_slug}/projects/{project_id}"],removeRepoInOrg:["DELETE /orgs/{org}/teams/{team_slug}/repos/{owner}/{repo}"],updateDiscussionCommentInOrg:["PATCH /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}/comments/{comment_number}"],updateDiscussionInOrg:["PATCH /orgs/{org}/teams/{team_slug}/discussions/{discussion_number}"],updateInOrg:["PATCH /orgs/{org}/teams/{team_slug}"]},users:{addEmailForAuthenticated:["POST /user/emails",{},{renamed:["users","addEmailForAuthenticatedUser"]}],addEmailForAuthenticatedUser:["POST /user/emails"],addSocialAccountForAuthenticatedUser:["POST /user/social_accounts"],block:["PUT /user/blocks/{username}"],checkBlocked:["GET /user/blocks/{username}"],checkFollowingForUser:["GET /users/{username}/following/{target_user}"],checkPersonIsFollowedByAuthenticated:["GET /user/following/{username}"],createGpgKeyForAuthenticated:["POST /user/gpg_keys",{},{renamed:["users","createGpgKeyForAuthenticatedUser"]}],createGpgKeyForAuthenticatedUser:["POST /user/gpg_keys"],createPublicSshKeyForAuthenticated:["POST /user/keys",{},{renamed:["users","createPublicSshKeyForAuthenticatedUser"]}],createPublicSshKeyForAuthenticatedUser:["POST /user/keys"],createSshSigningKeyForAuthenticatedUser:["POST /user/ssh_signing_keys"],deleteEmailForAuthenticated:["DELETE /user/emails",{},{renamed:["users","deleteEmailForAuthenticatedUser"]}],deleteEmailForAuthenticatedUser:["DELETE /user/emails"],deleteGpgKeyForAuthenticated:["DELETE /user/gpg_keys/{gpg_key_id}",{},{renamed:["users","deleteGpgKeyForAuthenticatedUser"]}],deleteGpgKeyForAuthenticatedUser:["DELETE /user/gpg_keys/{gpg_key_id}"],deletePublicSshKeyForAuthenticated:["DELETE /user/keys/{key_id}",{},{renamed:["users","deletePublicSshKeyForAuthenticatedUser"]}],deletePublicSshKeyForAuthenticatedUser:["DELETE /user/keys/{key_id}"],deleteSocialAccountForAuthenticatedUser:["DELETE /user/social_accounts"],deleteSshSigningKeyForAuthenticatedUser:["DELETE /user/ssh_signing_keys/{ssh_signing_key_id}"],follow:["PUT /user/following/{username}"],getAuthenticated:["GET /user"],getByUsername:["GET /users/{username}"],getContextForUser:["GET /users/{username}/hovercard"],getGpgKeyForAuthenticated:["GET /user/gpg_keys/{gpg_key_id}",{},{renamed:["users","getGpgKeyForAuthenticatedUser"]}],getGpgKeyForAuthenticatedUser:["GET /user/gpg_keys/{gpg_key_id}"],getPublicSshKeyForAuthenticated:["GET /user/keys/{key_id}",{},{renamed:["users","getPublicSshKeyForAuthenticatedUser"]}],getPublicSshKeyForAuthenticatedUser:["GET /user/keys/{key_id}"],getSshSigningKeyForAuthenticatedUser:["GET /user/ssh_signing_keys/{ssh_signing_key_id}"],list:["GET /users"],listBlockedByAuthenticated:["GET /user/blocks",{},{renamed:["users","listBlockedByAuthenticatedUser"]}],listBlockedByAuthenticatedUser:["GET /user/blocks"],listEmailsForAuthenticated:["GET /user/emails",{},{renamed:["users","listEmailsForAuthenticatedUser"]}],listEmailsForAuthenticatedUser:["GET /user/emails"],listFollowedByAuthenticated:["GET /user/following",{},{renamed:["users","listFollowedByAuthenticatedUser"]}],listFollowedByAuthenticatedUser:["GET /user/following"],listFollowersForAuthenticatedUser:["GET /user/followers"],listFollowersForUser:["GET /users/{username}/followers"],listFollowingForUser:["GET /users/{username}/following"],listGpgKeysForAuthenticated:["GET /user/gpg_keys",{},{renamed:["users","listGpgKeysForAuthenticatedUser"]}],listGpgKeysForAuthenticatedUser:["GET /user/gpg_keys"],listGpgKeysForUser:["GET /users/{username}/gpg_keys"],listPublicEmailsForAuthenticated:["GET /user/public_emails",{},{renamed:["users","listPublicEmailsForAuthenticatedUser"]}],listPublicEmailsForAuthenticatedUser:["GET /user/public_emails"],listPublicKeysForUser:["GET /users/{username}/keys"],listPublicSshKeysForAuthenticated:["GET /user/keys",{},{renamed:["users","listPublicSshKeysForAuthenticatedUser"]}],listPublicSshKeysForAuthenticatedUser:["GET /user/keys"],listSocialAccountsForAuthenticatedUser:["GET /user/social_accounts"],listSocialAccountsForUser:["GET /users/{username}/social_accounts"],listSshSigningKeysForAuthenticatedUser:["GET /user/ssh_signing_keys"],listSshSigningKeysForUser:["GET /users/{username}/ssh_signing_keys"],setPrimaryEmailVisibilityForAuthenticated:["PATCH /user/email/visibility",{},{renamed:["users","setPrimaryEmailVisibilityForAuthenticatedUser"]}],setPrimaryEmailVisibilityForAuthenticatedUser:["PATCH /user/email/visibility"],unblock:["DELETE /user/blocks/{username}"],unfollow:["DELETE /user/following/{username}"],updateAuthenticated:["PATCH /user"]}};var ppe=fpe;const Rl=new Map;for(const[t,e]of Object.entries(ppe))for(const[r,n]of Object.entries(e)){const[s,i,o]=n,[a,l]=s.split(/ /),c=Object.assign({method:a,url:l},i);Rl.has(t)||Rl.set(t,new Map),Rl.get(t).set(r,{scope:t,methodName:r,endpointDefaults:c,decorations:o})}const mpe={has({scope:t},e){return Rl.get(t).has(e)},getOwnPropertyDescriptor(t,e){return{value:this.get(t,e),configurable:!0,writable:!0,enumerable:!0}},defineProperty(t,e,r){return Object.defineProperty(t.cache,e,r),!0},deleteProperty(t,e){return delete t.cache[e],!0},ownKeys({scope:t}){return[...Rl.get(t).keys()]},set(t,e,r){return t.cache[e]=r},get({octokit:t,scope:e,cache:r},n){if(r[n])return r[n];const s=Rl.get(e).get(n);if(!s)return;const{endpointDefaults:i,decorations:o}=s;return o?r[n]=_pe(t,e,n,i,o):r[n]=t.request.defaults(i),r[n]}};function gpe(t){const e={};for(const r of Rl.keys())e[r]=new Proxy({octokit:t,scope:r,cache:{}},mpe);return e}function _pe(t,e,r,n,s){const i=t.request.defaults(n);function o(...a){let l=i.endpoint.merge(...a);if(s.mapToData)return l=Object.assign({},l,{data:l[s.mapToData],[s.mapToData]:void 0}),i(l);if(s.renamed){const[c,u]=s.renamed;t.log.warn(`octokit.${e}.${r}() has been renamed to octokit.${c}.${u}()`)}if(s.deprecated&&t.log.warn(s.deprecated),s.renamedParameters){const c=i.endpoint.merge(...a);for(const[u,h]of Object.entries(s.renamedParameters))u in c&&(t.log.warn(`"${u}" parameter is deprecated for "octokit.${e}.${r}()". Use "${h}" instead`),h in c||(c[h]=c[u]),delete c[u]);return i(c)}return i(...a)}return Object.assign(o,i)}function ij(t){const e=gpe(t);return{...e,rest:e}}ij.VERSION=dpe;const ype="21.0.2",bpe=lpe.plugin(tj,ij,sj).defaults({userAgent:`octokit-rest.js/${ype}`}),vpe=Fn("ChatHistory");async function wpe(){if(typeof indexedDB>"u"){console.error("indexedDB is not available in this environment.");return}return new Promise(t=>{const e=indexedDB.open("TerretacodeHistory",1);e.onupgradeneeded=r=>{const n=r.target.result;if(!n.objectStoreNames.contains("chats")){const s=n.createObjectStore("chats",{keyPath:"id"});s.createIndex("id","id",{unique:!0}),s.createIndex("urlId","urlId",{unique:!0})}},e.onsuccess=r=>{t(r.target.result)},e.onerror=r=>{t(void 0),vpe.error(r.target.error)}})}async function _x(t){return new Promise((e,r)=>{const i=t.transaction("chats","readonly").objectStore("chats").getAll();i.onsuccess=()=>e(i.result),i.onerror=()=>r(i.error)})}async function ob(t,e,r,n,s,i){return new Promise((o,a)=>{const c=t.transaction("chats","readwrite").objectStore("chats");if(i&&isNaN(Date.parse(i))){a(new Error("Invalid timestamp"));return}const u=c.put({id:e,messages:r,urlId:n,description:s,timestamp:i??new Date().toISOString()});u.onsuccess=()=>o(),u.onerror=()=>a(u.error)})}async function ku(t,e){return await xpe(t,e)||await Epe(t,e)}async function Epe(t,e){return new Promise((r,n)=>{const a=t.transaction("chats","readonly").objectStore("chats").index("urlId").get(e);a.onsuccess=()=>r(a.result),a.onerror=()=>n(a.error)})}async function xpe(t,e){return new Promise((r,n)=>{const o=t.transaction("chats","readonly").objectStore("chats").get(e);o.onsuccess=()=>r(o.result),o.onerror=()=>n(o.error)})}async function oj(t,e){return new Promise((r,n)=>{const o=t.transaction("chats","readwrite").objectStore("chats").delete(e);o.onsuccess=()=>r(void 0),o.onerror=()=>n(o.error)})}async function aj(t){return new Promise((e,r)=>{const i=t.transaction("chats","readonly").objectStore("chats").getAllKeys();i.onsuccess=()=>{const o=i.result.reduce((a,l)=>Math.max(+a,+l),0);e(String(+o+1))},i.onerror=()=>r(i.error)})}async function lj(t,e){const r=await Spe(t);if(r.includes(e)){let n=2;for(;r.includes(`${e}-${n}`);)n++;return`${e}-${n}`}else return e}async function Spe(t){return new Promise((e,r)=>{const s=t.transaction("chats","readonly").objectStore("chats"),i=[],o=s.openCursor();o.onsuccess=a=>{const l=a.target.result;l?(i.push(l.value.urlId),l.continue()):e(i)},o.onerror=()=>{r(o.error)}})}async function Tpe(t,e,r){const n=await ku(t,e);if(!n)throw new Error("Chat not found");const s=n.messages.findIndex(o=>o.id===r);if(s===-1)throw new Error("Message not found");const i=n.messages.slice(0,s+1);return tk(t,n.description?`${n.description} (fork)`:"Forked chat",i)}async function Cpe(t,e){const r=await ku(t,e);if(!r)throw new Error("Chat not found");return tk(t,`${r.description||"Chat"} (copy)`,r.messages)}async function tk(t,e,r){const n=await aj(t),s=await lj(t,n);return await ob(t,n,r,s,e),s}async function kpe(t,e,r){const n=await ku(t,e);if(!n)throw new Error("Chat not found");if(!r.trim())throw new Error("Description cannot be empty");await ob(t,e,n.messages,n.urlId,r,n.timestamp)}const Rt=await wpe(),la=vr(void 0),po=vr(void 0);function cj(){const t=x3(),{id:e}=dq(),[r]=S3(),[n,s]=I.useState([]),[i,o]=I.useState(!1),[a,l]=I.useState();return I.useEffect(()=>{if(!Rt){o(!0);{const c=new Error("Chat persistence is unavailable");ft.logError("Chat persistence initialization failed",c),Ne.error("Chat persistence is unavailable")}return}e&&ku(Rt,e).then(c=>{if(c&&c.messages.length>0){const u=r.get("rewindTo"),h=u?c.messages.slice(0,c.messages.findIndex(d=>d.id===u)+1):c.messages;s(h),l(c.urlId),po.set(c.description),la.set(c.id)}else t("/",{replace:!0});o(!0)}).catch(c=>{ft.logError("Failed to load chat messages",c),Ne.error(c.message)})},[]),{ready:!e||i,initialMessages:n,storeMessageHistory:async c=>{if(!Rt||c.length===0)return;const{firstArtifact:u}=Ze;if(!a&&u?.id){const h=await lj(Rt,u.id);PP(h),l(h)}if(!po.get()&&u?.title&&po.set(u?.title),n.length===0&&!la.get()){const h=await aj(Rt);la.set(h),a||PP(h)}await ob(Rt,la.get(),c,a,po.get())},duplicateCurrentChat:async c=>{if(!(!Rt||!e&&!c))try{const u=await Cpe(Rt,e||c);t(`/chat/${u}`),Ne.success("Chat duplicated successfully")}catch(u){Ne.error("Failed to duplicate chat"),console.log(u)}},importChat:async(c,u)=>{if(Rt)try{const h=await tk(Rt,c,u);window.location.href=`/chat/${h}`,Ne.success("Chat imported successfully")}catch(h){h instanceof Error?Ne.error("Failed to import chat: "+h.message):Ne.error("Failed to import chat")}},exportChat:async(c=a)=>{if(!Rt||!c)return;const u=await ku(Rt,c),h={messages:u.messages,description:u.description,exportDate:new Date().toISOString()},d=new Blob([JSON.stringify(h,null,2)],{type:"application/json"}),f=URL.createObjectURL(d),g=document.createElement("a");g.href=f,g.download=`chat-${new Date().toISOString()}.json`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(f)}}}function PP(t){const e=new URL(window.location.href);e.pathname=`/chat/${t}`,window.history.replaceState({},"",e)}function uj(t,e){let r=null,n=0,s=null;return function(...o){const a=Date.now();if(r=o,a-n<e){s||(s=setTimeout(()=>{s=null,n=Date.now(),r&&(t.apply(this,r),r=null)},e-(a-n)));return}n=a,t.apply(this,o),r=null}}class hj{#t=new ffe(ol);#r=new ufe(ol);#e=new Vde(this.#r);#n=new bfe(ol);#i=new Set;artifacts=rc({});showWorkbench=vr(!1);currentView=vr("code");unsavedFiles=vr(new Set);actionAlert=vr(void 0);modifiedFiles=new Set;artifactIdList=[];#s=Promise.resolve();constructor(){}addToExecutionQueue(e){this.#s=this.#s.then(()=>e())}get previews(){return this.#t.previews}get files(){return this.#r.files}get currentDocument(){return this.#e.currentDocument}get selectedFile(){return this.#e.selectedFile}get firstArtifact(){return this.#o(this.artifactIdList[0])}get filesCount(){return this.#r.filesCount}get showTerminal(){return this.#n.showTerminal}get TerretacodeTerminal(){return this.#n.TerretacodeTerminal}get alert(){return this.actionAlert}clearAlert(){this.actionAlert.set(void 0)}toggleTerminal(e){this.#n.toggleTerminal(e)}attachTerminal(e){this.#n.attachTerminal(e)}attachTerretacodeTerminal(e){this.#n.attachTerretacodeTerminal(e)}onTerminalResize(e,r){this.#n.onTerminalResize(e,r)}setDocuments(e){if(this.#e.setDocuments(e),this.#r.filesCount>0&&this.currentDocument.get()===void 0){for(const[r,n]of Object.entries(e))if(n?.type==="file"){this.setSelectedFile(r);break}}}setShowWorkbench(e){this.showWorkbench.set(e)}setCurrentDocumentContent(e){const r=this.currentDocument.get()?.filePath;if(!r)return;const n=this.#r.getFile(r)?.content,s=n!==void 0&&n!==e;this.#e.updateFile(r,e);const i=this.currentDocument.get();if(i){const o=this.unsavedFiles.get();if(s&&o.has(i.filePath))return;const a=new Set(o);s?a.add(i.filePath):a.delete(i.filePath),this.unsavedFiles.set(a)}}setCurrentDocumentScrollPosition(e){const r=this.currentDocument.get();if(!r)return;const{filePath:n}=r;this.#e.updateScrollPosition(n,e)}setSelectedFile(e){this.#e.setSelectedFile(e)}async saveFile(e){const n=this.#e.documents.get()[e];if(n===void 0)return;await this.#r.saveFile(e,n.value);const s=new Set(this.unsavedFiles.get());s.delete(e),this.unsavedFiles.set(s)}async saveCurrentDocument(){const e=this.currentDocument.get();e!==void 0&&await this.saveFile(e.filePath)}resetCurrentDocument(){const e=this.currentDocument.get();if(e===void 0)return;const{filePath:r}=e,n=this.#r.getFile(r);n&&this.setCurrentDocumentContent(n.content)}async saveAllFiles(){for(const e of this.unsavedFiles.get())await this.saveFile(e)}getFileModifcations(){return this.#r.getFileModifications()}resetAllFileModifications(){this.#r.resetFileModifications()}abortAllActions(){}setReloadedMessages(e){this.#i=new Set(e)}addArtifact({messageId:e,title:r,id:n,type:s}){this.#o(e)||(this.artifactIdList.includes(e)||this.artifactIdList.push(e),this.artifacts.setKey(e,{id:n,title:r,closed:!1,type:s,runner:new ate(ol,()=>this.TerretacodeTerminal,o=>{this.#i.has(e)||this.actionAlert.set(o)})}))}updateArtifact({messageId:e},r){const n=this.#o(e);n&&this.artifacts.setKey(e,{...n,...r})}addAction(e){this.addToExecutionQueue(()=>this._addAction(e))}async _addAction(e){const{messageId:r}=e,n=this.#o(r);return n||Os("Artifact not found"),n.runner.addAction(e)}runAction(e,r=!1){r?this.actionStreamSampler(e,r):this.addToExecutionQueue(()=>this._runAction(e,r))}async _runAction(e,r=!1){const{messageId:n}=e,s=this.#o(n);s||Os("Artifact not found");const i=s.runner.actions.get()[e.actionId];if(!(!i||i.executed))if(e.action.type==="file"){const o=await ol,a=Pe.join(o.workdir,e.action.filePath);this.selectedFile.value!==a&&this.setSelectedFile(a),this.currentView.value!=="code"&&this.currentView.set("code"),this.#e.documents.get()[a]||await s.runner.runAction(e,r),this.#e.updateFile(a,e.action.content),r||(await s.runner.runAction(e),this.resetAllFileModifications())}else await s.runner.runAction(e)}actionStreamSampler=uj(async(e,r=!1)=>await this._runAction(e,r),100);#o(e){return this.artifacts.get()[e]}async downloadZip(){const e=new wfe,r=this.files.get(),n=(po.value??"project").toLocaleLowerCase().split(" ").join("_"),s=Date.now().toString(36).slice(-6),i=`${n}_${s}`;for(const[a,l]of Object.entries(r))if(l?.type==="file"&&!l.isBinary){const c=rw(a),u=c.split("/");if(u.length>1){let h=e;for(let d=0;d<u.length-1;d++)h=h.folder(u[d]);h.file(u[u.length-1],l.content)}else e.file(c,l.content)}const o=await e.generateAsync({type:"blob"});Efe.saveAs(o,`${i}.zip`)}async syncFiles(e){const r=this.files.get(),n=[];for(const[s,i]of Object.entries(r))if(i?.type==="file"&&!i.isBinary){const o=rw(s),a=o.split("/");let l=e;for(let h=0;h<a.length-1;h++)l=await l.getDirectoryHandle(a[h],{create:!0});const u=await(await l.getFileHandle(a[a.length-1],{create:!0})).createWritable();await u.write(i.content),await u.close(),n.push(o)}return n}async pushToGitHub(e,r,n){try{const s=n||Ke.get("githubToken"),i=r||Ke.get("githubUsername");if(!s||!i)throw new Error("GitHub token or username is not set in cookies or provided.");const o=new bpe({auth:s});let a;try{a=(await o.repos.get({owner:i,repo:e})).data}catch(_){if(_ instanceof Error&&"status"in _&&_.status===404){const{data:m}=await o.repos.createForAuthenticatedUser({name:e,private:!1,auto_init:!0});a=m}else throw console.log("cannot create repo!"),_}const l=this.files.get();if(!l||Object.keys(l).length===0)throw new Error("No files found to push");const u=(await Promise.all(Object.entries(l).map(async([_,m])=>{if(m?.type==="file"&&m.content){const{data:p}=await o.git.createBlob({owner:a.owner.login,repo:a.name,content:Ue.from(m.content).toString("base64"),encoding:"base64"});return{path:rw(_),sha:p.sha}}return null}))).filter(Boolean);if(u.length===0)throw new Error("No valid files to push");const{data:h}=await o.git.getRef({owner:a.owner.login,repo:a.name,ref:`heads/${a.default_branch||"main"}`}),d=h.object.sha,{data:f}=await o.git.createTree({owner:a.owner.login,repo:a.name,base_tree:d,tree:u.map(_=>({path:_.path,mode:"100644",type:"blob",sha:_.sha}))}),{data:g}=await o.git.createCommit({owner:a.owner.login,repo:a.name,message:"Initial commit from your app",tree:f.sha,parents:[d]});await o.git.updateRef({owner:a.owner.login,repo:a.name,ref:`heads/${a.default_branch||"main"}`,sha:g.sha}),alert(`Repository created and code pushed: ${a.html_url}`)}catch(s){throw console.error("Error pushing to GitHub:",s),s}}}const Ze=new hj,Ape=Object.freeze(Object.defineProperty({__proto__:null,WorkbenchStore:hj,workbenchStore:Ze},Symbol.toStringTag,{value:"Module"})),Ph=["Ollama","LMStudio","OpenAILike"],dj=["OpenAILike","LMStudio","Ollama"],Rpe=rc({toggleTerminal:{key:"j",ctrlOrMetaKey:!0,action:()=>Ze.toggleTerminal()}}),fj={};sb.forEach(t=>{fj[t.name]={...t,settings:{enabled:!0}}});const Wm=rc(fj),iw=vr(!1),ow=vr(!1),aw=vr(!0),lw=vr("default"),qm=vr(!1),cw=vr(!1),uw=vr(!1),Oh={commit:"31c8451",version:"0.0.5"};function rh(){const t=wt(Wm),e=wt(iw),r=wt(ow),n=wt(lw),s=wt(aw),i=wt(qm),o=wt(cw),[a,l]=I.useState([]),c=wt(uw),u=async()=>{try{const v=await(await fetch(`https://api.github.com/repos/stackblitz-labs/Terretacode.diy/git/refs/tags/v${Oh.version}`)).json();return Oh.commit.slice(0,7)===v.object.sha.slice(0,7)}catch(b){return console.warn("Error checking stable version:",b),!1}};I.useEffect(()=>{const b=Ke.get("providers");if(b)try{const P=JSON.parse(b);Object.keys(t).forEach(D=>{const R=P[D];R&&Wm.setKey(D,{...t[D],settings:{...R,enabled:R.enabled??!0}})})}catch(P){console.error("Failed to parse providers from cookies:",P)}const v=Ke.get("isDebugEnabled");v&&iw.set(v==="true");const w=Ke.get("isEventLogsEnabled");w&&ow.set(w==="true");const E=Ke.get("isLocalModelsEnabled");E&&aw.set(E==="true");const S=Ke.get("promptId");S&&lw.set(S);const x=Ke.get("isLatestBranch");let C=Ke.get("commitHash");C===void 0&&(C=Oh.commit),x===void 0||C!==Oh.commit?u().then(P=>{const D=!P;qm.set(D),Ke.set("isLatestBranch",String(D)),Ke.set("commitHash",String(Oh.commit))}):qm.set(x==="true");const A=Ke.get("autoSelectTemplate");A&&cw.set(A==="true");const M=Ke.get("contextOptimizationEnabled");M&&uw.set(M==="true")},[]),I.useEffect(()=>{const b=Wm.get(),v={};Object.keys(b).forEach(w=>{v[w]=b[w].settings}),Ke.set("providers",JSON.stringify(v))},[t]),I.useEffect(()=>{let b=Object.entries(t).filter(([v,w])=>w.settings.enabled).map(([v,w])=>w);s||(b=b.filter(v=>!dj.includes(v.name))),l(b)},[t,s]);const h=I.useCallback((b,v)=>{const w=t[b].settings;Wm.setKey(b,{...t[b],settings:{...w,...v}})},[t]),d=I.useCallback(b=>{iw.set(b),ft.logSystem(`Debug mode ${b?"enabled":"disabled"}`),Ke.set("isDebugEnabled",String(b))},[]),f=I.useCallback(b=>{ow.set(b),ft.logSystem(`Event logs ${b?"enabled":"disabled"}`),Ke.set("isEventLogsEnabled",String(b))},[]),g=I.useCallback(b=>{aw.set(b),ft.logSystem(`Local models ${b?"enabled":"disabled"}`),Ke.set("isLocalModelsEnabled",String(b))},[]),_=I.useCallback(b=>{lw.set(b),Ke.set("promptId",b)},[]),m=I.useCallback(b=>{qm.set(b),ft.logSystem(`Main branch updates ${b?"enabled":"disabled"}`),Ke.set("isLatestBranch",String(b))},[]),p=I.useCallback(b=>{cw.set(b),ft.logSystem(`Auto select template ${b?"enabled":"disabled"}`),Ke.set("autoSelectTemplate",String(b))},[]),y=I.useCallback(b=>{uw.set(b),ft.logSystem(`Context optimization ${b?"enabled":"disabled"}`),Ke.set("contextOptimizationEnabled",String(b))},[]);return{providers:t,activeProviders:a,updateProviderSettings:h,debug:e,enableDebugMode:d,eventLogs:r,enableEventLogs:f,isLocalModel:s,enableLocalModels:g,promptId:n,setPromptId:_,isLatestBranch:i,enableLatestBranch:m,autoSelectTemplate:o,setAutoSelectTemplate:p,contextOptimizationEnabled:c,enableContextOptimization:y}}const Ipe={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},Ppe="/icons/Default.svg";function Ope(){const{providers:t,updateProviderSettings:e,isLocalModel:r}=rh(),[n,s]=I.useState([]),[i,o]=I.useState("");I.useEffect(()=>{let u=Object.entries(t).map(([f,g])=>({...g,name:f}));i&&i.length>0&&(u=u.filter(f=>f.name.toLowerCase().includes(i.toLowerCase()))),r||(u=u.filter(f=>!dj.includes(f.name))),u.sort((f,g)=>f.name.localeCompare(g.name));const h=u.filter(f=>!Ph.includes(f.name)),d=u.filter(f=>Ph.includes(f.name));s([...h,...d])},[t,i,r]);const a=u=>{const h=YC[u.name].baseUrlKey,d=h?Ipe[h]:void 0,f=Ph.includes(u.name);return T.jsxs("div",{className:"flex flex-col provider-item hover:bg-Terretacode-elements-bg-depth-3 p-4 rounded-lg border border-Terretacode-elements-borderColor",children:[T.jsxs("div",{className:"flex items-center justify-between mb-2",children:[T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("img",{src:`/icons/${u.name}.svg`,onError:g=>{g.currentTarget.src=Ppe},alt:`${u.name} icon`,className:"w-6 h-6 dark:invert"}),T.jsx("span",{className:"text-Terretacode-elements-textPrimary",children:u.name})]}),T.jsx(Qo,{className:"ml-auto",checked:u.settings.enabled,onCheckedChange:g=>{e(u.name,{...u.settings,enabled:g}),g?ft.logProvider(`Provider ${u.name} enabled`,{provider:u.name}):ft.logProvider(`Provider ${u.name} disabled`,{provider:u.name})}})]}),f&&u.settings.enabled&&T.jsxs("div",{className:"mt-2",children:[d&&T.jsxs("label",{className:"block text-xs text-Terretacode-elements-textSecondary text-green-300 mb-2",children:["Set On (.env) : ",d]}),T.jsxs("label",{className:"block text-sm text-Terretacode-elements-textSecondary mb-2",children:[d?"Override Base Url":"Base URL ",":"," "]}),T.jsx("input",{type:"text",value:u.settings.baseUrl||"",onChange:g=>{let _=g.target.value;_&&_.trim().length===0&&(_=void 0),e(u.name,{...u.settings,baseUrl:_}),ft.logProvider(`Base URL updated for ${u.name}`,{provider:u.name,baseUrl:_})},placeholder:`Enter ${u.name} base URL`,className:"w-full bg-white dark:bg-Terretacode-elements-background-depth-4 relative px-2 py-1.5 rounded-md focus:outline-none placeholder-Terretacode-elements-textTertiary text-Terretacode-elements-textPrimary dark:text-Terretacode-elements-textPrimary border border-Terretacode-elements-borderColor"})]})]},u.name)},l=n.filter(u=>!Ph.includes(u.name)),c=n.filter(u=>Ph.includes(u.name));return T.jsxs("div",{className:"p-4",children:[T.jsx("div",{className:"flex mb-4",children:T.jsx("input",{type:"text",placeholder:"Buscar Proveedor...",value:i,onChange:u=>o(u.target.value),className:"w-full bg-white dark:bg-Terretacode-elements-background-depth-4 relative px-2 py-1.5 rounded-md focus:outline-none placeholder-Terretacode-elements-textTertiary text-Terretacode-elements-textPrimary dark:text-Terretacode-elements-textPrimary border border-Terretacode-elements-borderColor"})}),T.jsx("div",{className:"grid grid-cols-2 gap-4 mb-8",children:l.map(a)}),c.length>0&&T.jsxs("div",{className:"mt-8",children:[T.jsx("h3",{className:"text-lg font-semibold mb-2 text-Terretacode-elements-textPrimary",children:"Proveedor Experimental"}),T.jsx("p",{className:"text-sm text-Terretacode-elements-textSecondary mb-4",children:"Estos proveedores son experimentales y te permiten ejecutar modelos de IA localmente o conectarte a tu propia infraestructura. Requieren una configuración adicional, pero ofrecen mayor flexibilidad."}),T.jsx("div",{className:"space-y-4",children:c.map(a)})]})]})}const pj=-1,ab=0,c_=1,u_=2,rk=3,nk=4,sk=5,ik=6,mj=7,gj=8,OP=typeof self=="object"?self:globalThis,Dpe=(t,e)=>{const r=(s,i)=>(t.set(i,s),s),n=s=>{if(t.has(s))return t.get(s);const[i,o]=e[s];switch(i){case ab:case pj:return r(o,s);case c_:{const a=r([],s);for(const l of o)a.push(n(l));return a}case u_:{const a=r({},s);for(const[l,c]of o)a[n(l)]=n(c);return a}case rk:return r(new Date(o),s);case nk:{const{source:a,flags:l}=o;return r(new RegExp(a,l),s)}case sk:{const a=r(new Map,s);for(const[l,c]of o)a.set(n(l),n(c));return a}case ik:{const a=r(new Set,s);for(const l of o)a.add(n(l));return a}case mj:{const{name:a,message:l}=o;return r(new OP[a](l),s)}case gj:return r(BigInt(o),s);case"BigInt":return r(Object(BigInt(o)),s)}return r(new OP[i](o),s)};return n},DP=t=>Dpe(new Map,t)(0),wc="",{toString:Lpe}={},{keys:Npe}=Object,Dh=t=>{const e=typeof t;if(e!=="object"||!t)return[ab,e];const r=Lpe.call(t).slice(8,-1);switch(r){case"Array":return[c_,wc];case"Object":return[u_,wc];case"Date":return[rk,wc];case"RegExp":return[nk,wc];case"Map":return[sk,wc];case"Set":return[ik,wc]}return r.includes("Array")?[c_,r]:r.includes("Error")?[mj,r]:[u_,r]},Km=([t,e])=>t===ab&&(e==="function"||e==="symbol"),Mpe=(t,e,r,n)=>{const s=(o,a)=>{const l=n.push(o)-1;return r.set(a,l),l},i=o=>{if(r.has(o))return r.get(o);let[a,l]=Dh(o);switch(a){case ab:{let u=o;switch(l){case"bigint":a=gj,u=o.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+l);u=null;break;case"undefined":return s([pj],o)}return s([a,u],o)}case c_:{if(l)return s([l,[...o]],o);const u=[],h=s([a,u],o);for(const d of o)u.push(i(d));return h}case u_:{if(l)switch(l){case"BigInt":return s([l,o.toString()],o);case"Boolean":case"Number":case"String":return s([l,o.valueOf()],o)}if(e&&"toJSON"in o)return i(o.toJSON());const u=[],h=s([a,u],o);for(const d of Npe(o))(t||!Km(Dh(o[d])))&&u.push([i(d),i(o[d])]);return h}case rk:return s([a,o.toISOString()],o);case nk:{const{source:u,flags:h}=o;return s([a,{source:u,flags:h}],o)}case sk:{const u=[],h=s([a,u],o);for(const[d,f]of o)(t||!(Km(Dh(d))||Km(Dh(f))))&&u.push([i(d),i(f)]);return h}case ik:{const u=[],h=s([a,u],o);for(const d of o)(t||!Km(Dh(d)))&&u.push(i(d));return h}}const{message:c}=o;return s([a,{name:l,message:c}],o)};return i},LP=(t,{json:e,lossy:r}={})=>{const n=[];return Mpe(!(e||r),!!e,new Map,n)(t),n},Ul=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?DP(LP(t,e)):structuredClone(t):(t,e)=>DP(LP(t,e));class Cp{constructor(e,r,n){this.property=e,this.normal=r,n&&(this.space=n)}}Cp.prototype.property={};Cp.prototype.normal={};Cp.prototype.space=null;function _j(t,e){const r={},n={};let s=-1;for(;++s<t.length;)Object.assign(r,t[s].property),Object.assign(n,t[s].normal);return new Cp(r,n,e)}function wf(t){return t.toLowerCase()}class As{constructor(e,r){this.property=e,this.attribute=r}}As.prototype.space=null;As.prototype.boolean=!1;As.prototype.booleanish=!1;As.prototype.overloadedBoolean=!1;As.prototype.number=!1;As.prototype.commaSeparated=!1;As.prototype.spaceSeparated=!1;As.prototype.commaOrSpaceSeparated=!1;As.prototype.mustUseProperty=!1;As.prototype.defined=!1;let Bpe=0;const it=ic(),dr=ic(),yj=ic(),Be=ic(),Ht=ic(),nu=ic(),Un=ic();function ic(){return 2**++Bpe}const yx=Object.freeze(Object.defineProperty({__proto__:null,boolean:it,booleanish:dr,commaOrSpaceSeparated:Un,commaSeparated:nu,number:Be,overloadedBoolean:yj,spaceSeparated:Ht},Symbol.toStringTag,{value:"Module"})),hw=Object.keys(yx);class ok extends As{constructor(e,r,n,s){let i=-1;if(super(e,r),NP(this,"space",s),typeof n=="number")for(;++i<hw.length;){const o=hw[i];NP(this,hw[i],(n&yx[o])===yx[o])}}}ok.prototype.defined=!0;function NP(t,e,r){r&&(t[e]=r)}const Fpe={}.hasOwnProperty;function nh(t){const e={},r={};let n;for(n in t.properties)if(Fpe.call(t.properties,n)){const s=t.properties[n],i=new ok(n,t.transform(t.attributes||{},n),s,t.space);t.mustUseProperty&&t.mustUseProperty.includes(n)&&(i.mustUseProperty=!0),e[n]=i,r[wf(n)]=n,r[wf(i.attribute)]=n}return new Cp(e,r,t.space)}const bj=nh({space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()},properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null}}),vj=nh({space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()},properties:{xmlLang:null,xmlBase:null,xmlSpace:null}});function wj(t,e){return e in t?t[e]:e}function Ej(t,e){return wj(t,e.toLowerCase())}const xj=nh({space:"xmlns",attributes:{xmlnsxlink:"xmlns:xlink"},transform:Ej,properties:{xmlns:null,xmlnsXLink:null}}),Sj=nh({transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()},properties:{ariaActiveDescendant:null,ariaAtomic:dr,ariaAutoComplete:null,ariaBusy:dr,ariaChecked:dr,ariaColCount:Be,ariaColIndex:Be,ariaColSpan:Be,ariaControls:Ht,ariaCurrent:null,ariaDescribedBy:Ht,ariaDetails:null,ariaDisabled:dr,ariaDropEffect:Ht,ariaErrorMessage:null,ariaExpanded:dr,ariaFlowTo:Ht,ariaGrabbed:dr,ariaHasPopup:null,ariaHidden:dr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Ht,ariaLevel:Be,ariaLive:null,ariaModal:dr,ariaMultiLine:dr,ariaMultiSelectable:dr,ariaOrientation:null,ariaOwns:Ht,ariaPlaceholder:null,ariaPosInSet:Be,ariaPressed:dr,ariaReadOnly:dr,ariaRelevant:null,ariaRequired:dr,ariaRoleDescription:Ht,ariaRowCount:Be,ariaRowIndex:Be,ariaRowSpan:Be,ariaSelected:dr,ariaSetSize:Be,ariaSort:null,ariaValueMax:Be,ariaValueMin:Be,ariaValueNow:Be,ariaValueText:null,role:null}}),jpe=nh({space:"html",attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},transform:Ej,mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:nu,acceptCharset:Ht,accessKey:Ht,action:null,allow:null,allowFullScreen:it,allowPaymentRequest:it,allowUserMedia:it,alt:null,as:null,async:it,autoCapitalize:null,autoComplete:Ht,autoFocus:it,autoPlay:it,blocking:Ht,capture:null,charSet:null,checked:it,cite:null,className:Ht,cols:Be,colSpan:null,content:null,contentEditable:dr,controls:it,controlsList:Ht,coords:Be|nu,crossOrigin:null,data:null,dateTime:null,decoding:null,default:it,defer:it,dir:null,dirName:null,disabled:it,download:yj,draggable:dr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:it,formTarget:null,headers:Ht,height:Be,hidden:it,high:Be,href:null,hrefLang:null,htmlFor:Ht,httpEquiv:Ht,id:null,imageSizes:null,imageSrcSet:null,inert:it,inputMode:null,integrity:null,is:null,isMap:it,itemId:null,itemProp:Ht,itemRef:Ht,itemScope:it,itemType:Ht,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:it,low:Be,manifest:null,max:null,maxLength:Be,media:null,method:null,min:null,minLength:Be,multiple:it,muted:it,name:null,nonce:null,noModule:it,noValidate:it,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:it,optimum:Be,pattern:null,ping:Ht,placeholder:null,playsInline:it,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:it,referrerPolicy:null,rel:Ht,required:it,reversed:it,rows:Be,rowSpan:Be,sandbox:Ht,scope:null,scoped:it,seamless:it,selected:it,shadowRootClonable:it,shadowRootDelegatesFocus:it,shadowRootMode:null,shape:null,size:Be,sizes:null,slot:null,span:Be,spellCheck:dr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Be,step:null,style:null,tabIndex:Be,target:null,title:null,translate:null,type:null,typeMustMatch:it,useMap:null,value:dr,width:Be,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Ht,axis:null,background:null,bgColor:null,border:Be,borderColor:null,bottomMargin:Be,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:it,declare:it,event:null,face:null,frame:null,frameBorder:null,hSpace:Be,leftMargin:Be,link:null,longDesc:null,lowSrc:null,marginHeight:Be,marginWidth:Be,noResize:it,noHref:it,noShade:it,noWrap:it,object:null,profile:null,prompt:null,rev:null,rightMargin:Be,rules:null,scheme:null,scrolling:dr,standby:null,summary:null,text:null,topMargin:Be,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Be,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:it,disableRemotePlayback:it,prefix:null,property:null,results:Be,security:null,unselectable:null}}),Upe=nh({space:"svg",attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},transform:wj,properties:{about:Un,accentHeight:Be,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Be,amplitude:Be,arabicForm:null,ascent:Be,attributeName:null,attributeType:null,azimuth:Be,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Be,by:null,calcMode:null,capHeight:Be,className:Ht,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Be,diffuseConstant:Be,direction:null,display:null,dur:null,divisor:Be,dominantBaseline:null,download:it,dx:null,dy:null,edgeMode:null,editable:null,elevation:Be,enableBackground:null,end:null,event:null,exponent:Be,externalResourcesRequired:null,fill:null,fillOpacity:Be,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:nu,g2:nu,glyphName:nu,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Be,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Be,horizOriginX:Be,horizOriginY:Be,id:null,ideographic:Be,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Be,k:Be,k1:Be,k2:Be,k3:Be,k4:Be,kernelMatrix:Un,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Be,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Be,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Be,overlineThickness:Be,paintOrder:null,panose1:null,path:null,pathLength:Be,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Ht,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Be,pointsAtY:Be,pointsAtZ:Be,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Un,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Un,rev:Un,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Un,requiredFeatures:Un,requiredFonts:Un,requiredFormats:Un,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Be,specularExponent:Be,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Be,strikethroughThickness:Be,string:null,stroke:null,strokeDashArray:Un,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Be,strokeOpacity:Be,strokeWidth:null,style:null,surfaceScale:Be,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Un,tabIndex:Be,tableValues:null,target:null,targetX:Be,targetY:Be,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Un,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Be,underlineThickness:Be,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Be,values:null,vAlphabetic:Be,vMathematical:Be,vectorEffect:null,vHanging:Be,vIdeographic:Be,version:null,vertAdvY:Be,vertOriginX:Be,vertOriginY:Be,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Be,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null}}),$pe=/^data[-\w.:]+$/i,MP=/-[a-z]/g,Hpe=/[A-Z]/g;function kp(t,e){const r=wf(e);let n=e,s=As;if(r in t.normal)return t.property[t.normal[r]];if(r.length>4&&r.slice(0,4)==="data"&&$pe.test(e)){if(e.charAt(4)==="-"){const i=e.slice(5).replace(MP,Vpe);n="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=e.slice(4);if(!MP.test(i)){let o=i.replace(Hpe,zpe);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}s=ok}return new s(n,e)}function zpe(t){return"-"+t.toLowerCase()}function Vpe(t){return t.charAt(1).toUpperCase()}const Gpe={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},sh=_j([vj,bj,xj,Sj,jpe],"html"),Vi=_j([vj,bj,xj,Sj,Upe],"svg");function BP(t){const e=[],r=String(t||"");let n=r.indexOf(","),s=0,i=!1;for(;!i;){n===-1&&(n=r.length,i=!0);const o=r.slice(s,n).trim();(o||!i)&&e.push(o),s=n+1,n=r.indexOf(",",s)}return e}function ak(t,e){const r=e||{};return(t[t.length-1]===""?[...t,""]:t).join((r.padRight?" ":"")+","+(r.padLeft===!1?"":" ")).trim()}const FP=/[#.]/g;function Wpe(t,e){const r=t||"",n={};let s=0,i,o;for(;s<r.length;){FP.lastIndex=s;const a=FP.exec(r),l=r.slice(s,a?a.index:r.length);l&&(i?i==="#"?n.id=l:Array.isArray(n.className)?n.className.push(l):n.className=[l]:o=l,s+=l.length),a&&(i=a[0],s++)}return{type:"element",tagName:o||e||"div",properties:n,children:[]}}function jP(t){const e=String(t||"").trim();return e?e.split(/[ \t\n\r\f]+/g):[]}function lk(t){return t.join(" ").trim()}const bx={}.hasOwnProperty;function Tj(t,e,r){const n=r&&Xpe(r);function s(i,o,...a){let l=-1,c;if(i==null){c={type:"root",children:[]};const u=o;a.unshift(u)}else if(c=Wpe(i,e),c.tagName=c.tagName.toLowerCase(),n&&bx.call(n,c.tagName)&&(c.tagName=n[c.tagName]),qpe(o))a.unshift(o);else{let u;for(u in o)bx.call(o,u)&&Kpe(t,c.properties,u,o[u])}for(;++l<a.length;)vx(c.children,a[l]);return c.type==="element"&&c.tagName==="template"&&(c.content={type:"root",children:c.children},c.children=[]),c}return s}function qpe(t){if(t===null||typeof t!="object"||Array.isArray(t))return!0;if(typeof t.type!="string")return!1;const e=t,r=Object.keys(t);for(const n of r){const s=e[n];if(s&&typeof s=="object"){if(!Array.isArray(s))return!0;const i=s;for(const o of i)if(typeof o!="number"&&typeof o!="string")return!0}}return!!("children"in t&&Array.isArray(t.children))}function Kpe(t,e,r,n){const s=kp(t,r);let i=-1,o;if(n!=null){if(typeof n=="number"){if(Number.isNaN(n))return;o=n}else typeof n=="boolean"?o=n:typeof n=="string"?s.spaceSeparated?o=jP(n):s.commaSeparated?o=BP(n):s.commaOrSpaceSeparated?o=jP(BP(n).join(" ")):o=UP(s,s.property,n):Array.isArray(n)?o=n.concat():o=s.property==="style"?Ype(n):String(n);if(Array.isArray(o)){const a=[];for(;++i<o.length;){const l=UP(s,s.property,o[i]);a[i]=l}o=a}if(s.property==="className"&&Array.isArray(e.className)){const a=o;o=e.className.concat(a)}e[s.property]=o}}function vx(t,e){let r=-1;if(e!=null)if(typeof e=="string"||typeof e=="number")t.push({type:"text",value:String(e)});else if(Array.isArray(e))for(;++r<e.length;)vx(t,e[r]);else if(typeof e=="object"&&"type"in e)e.type==="root"?vx(t,e.children):t.push(e);else throw new Error("Expected node, nodes, or string, got `"+e+"`")}function UP(t,e,r){if(typeof r=="string"){if(t.number&&r&&!Number.isNaN(Number(r)))return Number(r);if((t.boolean||t.overloadedBoolean)&&(r===""||wf(r)===wf(e)))return!0}return r}function Ype(t){const e=[];let r;for(r in t)bx.call(t,r)&&e.push([r,t[r]].join(": "));return e.join("; ")}function Xpe(t){const e={};let r=-1;for(;++r<t.length;)e[t[r].toLowerCase()]=t[r];return e}const Zpe=["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","solidColor","textArea","textPath"],Jpe=Tj(sh,"div"),Qpe=Tj(Vi,"g",Zpe);function eme(t){const e=String(t),r=[];return{toOffset:s,toPoint:n};function n(i){if(typeof i=="number"&&i>-1&&i<=e.length){let o=0;for(;;){let a=r[o];if(a===void 0){const l=$P(e,r[o-1]);a=l===-1?e.length+1:l+1,r[o]=a}if(a>i)return{line:o+1,column:i-(o>0?r[o-1]:0)+1,offset:i};o++}}}function s(i){if(i&&typeof i.line=="number"&&typeof i.column=="number"&&!Number.isNaN(i.line)&&!Number.isNaN(i.column)){for(;r.length<i.line;){const a=r[r.length-1],l=$P(e,a),c=l===-1?e.length+1:l+1;if(a===c)break;r.push(c)}const o=(i.line>1?r[i.line-2]:0)+i.column-1;if(o<r[i.line-1])return o}}}function $P(t,e){const r=t.indexOf("\r",e),n=t.indexOf(`
`,e);return n===-1?r:r===-1||r+1===n?n:r<n?r:n}const fl={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Cj={}.hasOwnProperty,tme=Object.prototype;function rme(t,e){const r=e||{};return ck({file:r.file||void 0,location:!1,schema:r.space==="svg"?Vi:sh,verbose:r.verbose||!1},t)}function ck(t,e){let r;switch(e.nodeName){case"#comment":{const n=e;return r={type:"comment",value:n.data},Qg(t,n,r),r}case"#document":case"#document-fragment":{const n=e,s="mode"in n?n.mode==="quirks"||n.mode==="limited-quirks":!1;if(r={type:"root",children:kj(t,e.childNodes),data:{quirksMode:s}},t.file&&t.location){const i=String(t.file),o=eme(i),a=o.toPoint(0),l=o.toPoint(i.length);r.position={start:a,end:l}}return r}case"#documentType":{const n=e;return r={type:"doctype"},Qg(t,n,r),r}case"#text":{const n=e;return r={type:"text",value:n.value},Qg(t,n,r),r}default:return r=nme(t,e),r}}function kj(t,e){let r=-1;const n=[];for(;++r<e.length;){const s=ck(t,e[r]);n.push(s)}return n}function nme(t,e){const r=t.schema;t.schema=e.namespaceURI===fl.svg?Vi:sh;let n=-1;const s={};for(;++n<e.attrs.length;){const a=e.attrs[n],l=(a.prefix?a.prefix+":":"")+a.name;Cj.call(tme,l)||(s[l]=a.value)}const o=(t.schema.space==="svg"?Qpe:Jpe)(e.tagName,s,kj(t,e.childNodes));if(Qg(t,e,o),o.tagName==="template"){const a=e,l=a.sourceCodeLocation,c=l&&l.startTag&&zc(l.startTag),u=l&&l.endTag&&zc(l.endTag),h=ck(t,a.content);c&&u&&t.file&&(h.position={start:c.end,end:u.start}),o.content=h}return t.schema=r,o}function Qg(t,e,r){if("sourceCodeLocation"in e&&e.sourceCodeLocation&&t.file){const n=sme(t,r,e.sourceCodeLocation);n&&(t.location=!0,r.position=n)}}function sme(t,e,r){const n=zc(r);if(e.type==="element"){const s=e.children[e.children.length-1];if(n&&!r.endTag&&s&&s.position&&s.position.end&&(n.end=Object.assign({},s.position.end)),t.verbose){const i={};let o;if(r.attrs)for(o in r.attrs)Cj.call(r.attrs,o)&&(i[kp(t.schema,o).property]=zc(r.attrs[o]));r.startTag;const a=zc(r.startTag),l=r.endTag?zc(r.endTag):void 0,c={opening:a};l&&(c.closing=l),c.properties=i,e.data={position:c}}}return n}function zc(t){const e=HP({line:t.startLine,column:t.startCol,offset:t.startOffset}),r=HP({line:t.endLine,column:t.endCol,offset:t.endOffset});return e||r?{start:e,end:r}:void 0}function HP(t){return t.line&&t.column?t:void 0}const zP={}.hasOwnProperty;function uk(t,e){const r=e||{};function n(s,...i){let o=n.invalid;const a=n.handlers;if(s&&zP.call(s,t)){const l=String(s[t]);o=zP.call(a,l)?a[l]:n.unknown}if(o)return o.call(this,s,...i)}return n.handlers=r.handlers||{},n.invalid=r.invalid,n.unknown=r.unknown,n}const ime={},ome={}.hasOwnProperty,Aj=uk("type",{handlers:{root:lme,element:fme,text:hme,comment:dme,doctype:ume}});function ame(t,e){const n=(e||ime).space;return Aj(t,n==="svg"?Vi:sh)}function lme(t,e){const r={nodeName:"#document",mode:(t.data||{}).quirksMode?"quirks":"no-quirks",childNodes:[]};return r.childNodes=hk(t.children,r,e),ih(t,r),r}function cme(t,e){const r={nodeName:"#document-fragment",childNodes:[]};return r.childNodes=hk(t.children,r,e),ih(t,r),r}function ume(t){const e={nodeName:"#documentType",name:"html",publicId:"",systemId:"",parentNode:null};return ih(t,e),e}function hme(t){const e={nodeName:"#text",value:t.value,parentNode:null};return ih(t,e),e}function dme(t){const e={nodeName:"#comment",data:t.value,parentNode:null};return ih(t,e),e}function fme(t,e){const r=e;let n=r;t.type==="element"&&t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(n=Vi);const s=[];let i;if(t.properties){for(i in t.properties)if(i!=="children"&&ome.call(t.properties,i)){const l=pme(n,i,t.properties[i]);l&&s.push(l)}}const o=n.space,a={nodeName:t.tagName,tagName:t.tagName,attrs:s,namespaceURI:fl[o],childNodes:[],parentNode:null};return a.childNodes=hk(t.children,a,n),ih(t,a),t.tagName==="template"&&t.content&&(a.content=cme(t.content,n)),a}function pme(t,e,r){const n=kp(t,e);if(r===!1||r===null||r===void 0||typeof r=="number"&&Number.isNaN(r)||!r&&n.boolean)return;Array.isArray(r)&&(r=n.commaSeparated?ak(r):lk(r));const s={name:n.attribute,value:r===!0?"":String(r)};if(n.space&&n.space!=="html"&&n.space!=="svg"){const i=s.name.indexOf(":");i<0?s.prefix="":(s.name=s.name.slice(i+1),s.prefix=n.attribute.slice(0,i)),s.namespace=fl[n.space]}return s}function hk(t,e,r){let n=-1;const s=[];if(t)for(;++n<t.length;){const i=Aj(t[n],r);i.parentNode=e,s.push(i)}return s}function ih(t,e){const r=t.position;r&&r.start&&r.end&&(r.start.offset,r.end.offset,e.sourceCodeLocation={startLine:r.start.line,startCol:r.start.column,startOffset:r.start.offset,endLine:r.end.line,endCol:r.end.column,endOffset:r.end.offset})}const Rj=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"],mme=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),Kt="�";var X;(function(t){t[t.EOF=-1]="EOF",t[t.NULL=0]="NULL",t[t.TABULATION=9]="TABULATION",t[t.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",t[t.LINE_FEED=10]="LINE_FEED",t[t.FORM_FEED=12]="FORM_FEED",t[t.SPACE=32]="SPACE",t[t.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",t[t.QUOTATION_MARK=34]="QUOTATION_MARK",t[t.AMPERSAND=38]="AMPERSAND",t[t.APOSTROPHE=39]="APOSTROPHE",t[t.HYPHEN_MINUS=45]="HYPHEN_MINUS",t[t.SOLIDUS=47]="SOLIDUS",t[t.DIGIT_0=48]="DIGIT_0",t[t.DIGIT_9=57]="DIGIT_9",t[t.SEMICOLON=59]="SEMICOLON",t[t.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",t[t.EQUALS_SIGN=61]="EQUALS_SIGN",t[t.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",t[t.QUESTION_MARK=63]="QUESTION_MARK",t[t.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",t[t.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",t[t.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",t[t.GRAVE_ACCENT=96]="GRAVE_ACCENT",t[t.LATIN_SMALL_A=97]="LATIN_SMALL_A",t[t.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(X||(X={}));const Sn={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function Ij(t){return t>=55296&&t<=57343}function gme(t){return t>=56320&&t<=57343}function _me(t,e){return(t-55296)*1024+9216+e}function Pj(t){return t!==32&&t!==10&&t!==13&&t!==9&&t!==12&&t>=1&&t<=31||t>=127&&t<=159}function Oj(t){return t>=64976&&t<=65007||mme.has(t)}var Ee;(function(t){t.controlCharacterInInputStream="control-character-in-input-stream",t.noncharacterInInputStream="noncharacter-in-input-stream",t.surrogateInInputStream="surrogate-in-input-stream",t.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",t.endTagWithAttributes="end-tag-with-attributes",t.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",t.unexpectedSolidusInTag="unexpected-solidus-in-tag",t.unexpectedNullCharacter="unexpected-null-character",t.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",t.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",t.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",t.missingEndTagName="missing-end-tag-name",t.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",t.unknownNamedCharacterReference="unknown-named-character-reference",t.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",t.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",t.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",t.eofBeforeTagName="eof-before-tag-name",t.eofInTag="eof-in-tag",t.missingAttributeValue="missing-attribute-value",t.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",t.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",t.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",t.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",t.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",t.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",t.missingDoctypePublicIdentifier="missing-doctype-public-identifier",t.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",t.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",t.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",t.cdataInHtmlContent="cdata-in-html-content",t.incorrectlyOpenedComment="incorrectly-opened-comment",t.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",t.eofInDoctype="eof-in-doctype",t.nestedComment="nested-comment",t.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",t.eofInComment="eof-in-comment",t.incorrectlyClosedComment="incorrectly-closed-comment",t.eofInCdata="eof-in-cdata",t.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",t.nullCharacterReference="null-character-reference",t.surrogateCharacterReference="surrogate-character-reference",t.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",t.controlCharacterReference="control-character-reference",t.noncharacterCharacterReference="noncharacter-character-reference",t.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",t.missingDoctypeName="missing-doctype-name",t.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",t.duplicateAttribute="duplicate-attribute",t.nonConformingDoctype="non-conforming-doctype",t.missingDoctype="missing-doctype",t.misplacedDoctype="misplaced-doctype",t.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",t.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",t.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",t.openElementsLeftAfterEof="open-elements-left-after-eof",t.abandonedHeadElementChild="abandoned-head-element-child",t.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",t.nestedNoscriptInHead="nested-noscript-in-head",t.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(Ee||(Ee={}));const yme=65536;class bme{constructor(e){this.handler=e,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=yme,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(e,r){const{line:n,col:s,offset:i}=this,o=s+r,a=i+r;return{code:e,startLine:n,endLine:n,startCol:o,endCol:o,startOffset:a,endOffset:a}}_err(e){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(e,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(e){if(this.pos!==this.html.length-1){const r=this.html.charCodeAt(this.pos+1);if(gme(r))return this.pos++,this._addGap(),_me(e,r)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,X.EOF;return this._err(Ee.surrogateInInputStream),e}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(e,r){this.html.length>0?this.html+=e:this.html=e,this.endOfChunkHit=!1,this.lastChunkWritten=r}insertHtmlAtCurrentPos(e){this.html=this.html.substring(0,this.pos+1)+e+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(e,r){if(this.pos+e.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(r)return this.html.startsWith(e,this.pos);for(let n=0;n<e.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==e.charCodeAt(n))return!1;return!0}peek(e){const r=this.pos+e;if(r>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,X.EOF;const n=this.html.charCodeAt(r);return n===X.CARRIAGE_RETURN?X.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,X.EOF;let e=this.html.charCodeAt(this.pos);return e===X.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,X.LINE_FEED):e===X.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,Ij(e)&&(e=this._processSurrogate(e)),this.handler.onParseError===null||e>31&&e<127||e===X.LINE_FEED||e===X.CARRIAGE_RETURN||e>159&&e<64976||this._checkForProblematicCharacters(e),e)}_checkForProblematicCharacters(e){Pj(e)?this._err(Ee.controlCharacterInInputStream):Oj(e)&&this._err(Ee.noncharacterInInputStream)}retreat(e){for(this.pos-=e;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var dt;(function(t){t[t.CHARACTER=0]="CHARACTER",t[t.NULL_CHARACTER=1]="NULL_CHARACTER",t[t.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",t[t.START_TAG=3]="START_TAG",t[t.END_TAG=4]="END_TAG",t[t.COMMENT=5]="COMMENT",t[t.DOCTYPE=6]="DOCTYPE",t[t.EOF=7]="EOF",t[t.HIBERNATION=8]="HIBERNATION"})(dt||(dt={}));function Dj(t,e){for(let r=t.attrs.length-1;r>=0;r--)if(t.attrs[r].name===e)return t.attrs[r].value;return null}const Lj=new Uint16Array('ᵁ<Õıʊҝջאٵ۞ޢߖࠏ੊ઑඡ๭༉༦჊ረዡᐕᒝᓃᓟᔥ\0\0\0\0\0\0ᕫᛍᦍᰒᷝ὾⁠↰⊍⏀⏻⑂⠤⤒ⴈ⹈⿎〖㊺㘹㞬㣾㨨㩱㫠㬮ࠀEMabcfglmnoprstu\\bfms¦³¹ÈÏlig耻Æ䃆P耻&䀦cute耻Á䃁reve;䄂Āiyx}rc耻Â䃂;䐐r;쀀𝔄rave耻À䃀pha;䎑acr;䄀d;橓Āgp¡on;䄄f;쀀𝔸plyFunction;恡ing耻Å䃅Ācs¾Ãr;쀀𝒜ign;扔ilde耻Ã䃃ml耻Ä䃄ЀaceforsuåûþėĜĢħĪĀcrêòkslash;或Ŷöø;櫧ed;挆y;䐑ƀcrtąċĔause;戵noullis;愬a;䎒r;쀀𝔅pf;쀀𝔹eve;䋘còēmpeq;扎܀HOacdefhilorsuōőŖƀƞƢƵƷƺǜȕɳɸɾcy;䐧PY耻©䂩ƀcpyŝŢźute;䄆Ā;iŧŨ拒talDifferentialD;慅leys;愭ȀaeioƉƎƔƘron;䄌dil耻Ç䃇rc;䄈nint;戰ot;䄊ĀdnƧƭilla;䂸terDot;䂷òſi;䎧rcleȀDMPTǇǋǑǖot;抙inus;抖lus;投imes;抗oĀcsǢǸkwiseContourIntegral;戲eCurlyĀDQȃȏoubleQuote;思uote;怙ȀlnpuȞȨɇɕonĀ;eȥȦ户;橴ƀgitȯȶȺruent;扡nt;戯ourIntegral;戮ĀfrɌɎ;愂oduct;成nterClockwiseContourIntegral;戳oss;樯cr;쀀𝒞pĀ;Cʄʅ拓ap;才րDJSZacefiosʠʬʰʴʸˋ˗ˡ˦̳ҍĀ;oŹʥtrahd;椑cy;䐂cy;䐅cy;䐏ƀgrsʿ˄ˇger;怡r;憡hv;櫤Āayː˕ron;䄎;䐔lĀ;t˝˞戇a;䎔r;쀀𝔇Āaf˫̧Ācm˰̢riticalȀADGT̖̜̀̆cute;䂴oŴ̋̍;䋙bleAcute;䋝rave;䁠ilde;䋜ond;拄ferentialD;慆Ѱ̽\0\0\0͔͂\0Ѕf;쀀𝔻ƀ;DE͈͉͍䂨ot;惜qual;扐blèCDLRUVͣͲ΂ϏϢϸontourIntegraìȹoɴ͹\0\0ͻ»͉nArrow;懓Āeo·ΤftƀARTΐΖΡrrow;懐ightArrow;懔eåˊngĀLRΫτeftĀARγιrrow;柸ightArrow;柺ightArrow;柹ightĀATϘϞrrow;懒ee;抨pɁϩ\0\0ϯrrow;懑ownArrow;懕erticalBar;戥ǹABLRTaВЪаўѿͼrrowƀ;BUНОТ憓ar;椓pArrow;懵reve;䌑eft˒к\0ц\0ѐightVector;楐eeVector;楞ectorĀ;Bљњ憽ar;楖ightǔѧ\0ѱeeVector;楟ectorĀ;BѺѻ懁ar;楗eeĀ;A҆҇护rrow;憧ĀctҒҗr;쀀𝒟rok;䄐ࠀNTacdfglmopqstuxҽӀӄӋӞӢӧӮӵԡԯԶՒ՝ՠեG;䅊H耻Ð䃐cute耻É䃉ƀaiyӒӗӜron;䄚rc耻Ê䃊;䐭ot;䄖r;쀀𝔈rave耻È䃈ement;戈ĀapӺӾcr;䄒tyɓԆ\0\0ԒmallSquare;旻erySmallSquare;斫ĀgpԦԪon;䄘f;쀀𝔼silon;䎕uĀaiԼՉlĀ;TՂՃ橵ilde;扂librium;懌Āci՗՚r;愰m;橳a;䎗ml耻Ë䃋Āipժկsts;戃onentialE;慇ʀcfiosօֈ֍ֲ׌y;䐤r;쀀𝔉lledɓ֗\0\0֣mallSquare;旼erySmallSquare;斪Ͱֺ\0ֿ\0\0ׄf;쀀𝔽All;戀riertrf;愱cò׋؀JTabcdfgorstר׬ׯ׺؀ؒؖ؛؝أ٬ٲcy;䐃耻>䀾mmaĀ;d׷׸䎓;䏜reve;䄞ƀeiy؇،ؐdil;䄢rc;䄜;䐓ot;䄠r;쀀𝔊;拙pf;쀀𝔾eater̀EFGLSTصلَٖٛ٦qualĀ;Lؾؿ扥ess;招ullEqual;执reater;檢ess;扷lantEqual;橾ilde;扳cr;쀀𝒢;扫ЀAacfiosuڅڋږڛڞڪھۊRDcy;䐪Āctڐڔek;䋇;䁞irc;䄤r;愌lbertSpace;愋ǰگ\0ڲf;愍izontalLine;攀Āctۃۅòکrok;䄦mpńېۘownHumðįqual;扏܀EJOacdfgmnostuۺ۾܃܇܎ܚܞܡܨ݄ݸދޏޕcy;䐕lig;䄲cy;䐁cute耻Í䃍Āiyܓܘrc耻Î䃎;䐘ot;䄰r;愑rave耻Ì䃌ƀ;apܠܯܿĀcgܴܷr;䄪inaryI;慈lieóϝǴ݉\0ݢĀ;eݍݎ戬Āgrݓݘral;戫section;拂isibleĀCTݬݲomma;恣imes;恢ƀgptݿރވon;䄮f;쀀𝕀a;䎙cr;愐ilde;䄨ǫޚ\0ޞcy;䐆l耻Ï䃏ʀcfosuެ޷޼߂ߐĀiyޱ޵rc;䄴;䐙r;쀀𝔍pf;쀀𝕁ǣ߇\0ߌr;쀀𝒥rcy;䐈kcy;䐄΀HJacfosߤߨ߽߬߱ࠂࠈcy;䐥cy;䐌ppa;䎚Āey߶߻dil;䄶;䐚r;쀀𝔎pf;쀀𝕂cr;쀀𝒦րJTaceflmostࠥࠩࠬࡐࡣ঳সে্਷ੇcy;䐉耻<䀼ʀcmnpr࠷࠼ࡁࡄࡍute;䄹bda;䎛g;柪lacetrf;愒r;憞ƀaeyࡗ࡜ࡡron;䄽dil;䄻;䐛Āfsࡨ॰tԀACDFRTUVarࡾࢩࢱࣦ࣠ࣼयज़ΐ४Ānrࢃ࢏gleBracket;柨rowƀ;BR࢙࢚࢞憐ar;懤ightArrow;懆eiling;挈oǵࢷ\0ࣃbleBracket;柦nǔࣈ\0࣒eeVector;楡ectorĀ;Bࣛࣜ懃ar;楙loor;挊ightĀAV࣯ࣵrrow;憔ector;楎Āerँगeƀ;AVउऊऐ抣rrow;憤ector;楚iangleƀ;BEतथऩ抲ar;槏qual;抴pƀDTVषूौownVector;楑eeVector;楠ectorĀ;Bॖॗ憿ar;楘ectorĀ;B॥०憼ar;楒ightáΜs̀EFGLSTॾঋকঝঢভqualGreater;拚ullEqual;扦reater;扶ess;檡lantEqual;橽ilde;扲r;쀀𝔏Ā;eঽা拘ftarrow;懚idot;䄿ƀnpw৔ਖਛgȀLRlr৞৷ਂਐeftĀAR০৬rrow;柵ightArrow;柷ightArrow;柶eftĀarγਊightáοightáϊf;쀀𝕃erĀLRਢਬeftArrow;憙ightArrow;憘ƀchtਾੀੂòࡌ;憰rok;䅁;扪Ѐacefiosuਗ਼੝੠੷੼અઋ઎p;椅y;䐜Ādl੥੯iumSpace;恟lintrf;愳r;쀀𝔐nusPlus;戓pf;쀀𝕄cò੶;䎜ҀJacefostuણધભીଔଙඑ඗ඞcy;䐊cute;䅃ƀaey઴હાron;䅇dil;䅅;䐝ƀgswે૰଎ativeƀMTV૓૟૨ediumSpace;怋hiĀcn૦૘ë૙eryThiî૙tedĀGL૸ଆreaterGreateòٳessLesóੈLine;䀊r;쀀𝔑ȀBnptଢନଷ଺reak;恠BreakingSpace;䂠f;愕ڀ;CDEGHLNPRSTV୕ୖ୪୼஡௫ఄ౞಄ದ೘ൡඅ櫬Āou୛୤ngruent;扢pCap;扭oubleVerticalBar;戦ƀlqxஃஊ஛ement;戉ualĀ;Tஒஓ扠ilde;쀀≂̸ists;戄reater΀;EFGLSTஶஷ஽௉௓௘௥扯qual;扱ullEqual;쀀≧̸reater;쀀≫̸ess;批lantEqual;쀀⩾̸ilde;扵umpń௲௽ownHump;쀀≎̸qual;쀀≏̸eĀfsఊధtTriangleƀ;BEచఛడ拪ar;쀀⧏̸qual;括s̀;EGLSTవశ఼ౄోౘ扮qual;扰reater;扸ess;쀀≪̸lantEqual;쀀⩽̸ilde;扴estedĀGL౨౹reaterGreater;쀀⪢̸essLess;쀀⪡̸recedesƀ;ESಒಓಛ技qual;쀀⪯̸lantEqual;拠ĀeiಫಹverseElement;戌ghtTriangleƀ;BEೋೌ೒拫ar;쀀⧐̸qual;拭ĀquೝഌuareSuĀbp೨೹setĀ;E೰ೳ쀀⊏̸qual;拢ersetĀ;Eഃആ쀀⊐̸qual;拣ƀbcpഓതൎsetĀ;Eഛഞ쀀⊂⃒qual;抈ceedsȀ;ESTലള഻െ抁qual;쀀⪰̸lantEqual;拡ilde;쀀≿̸ersetĀ;E൘൛쀀⊃⃒qual;抉ildeȀ;EFT൮൯൵ൿ扁qual;扄ullEqual;扇ilde;扉erticalBar;戤cr;쀀𝒩ilde耻Ñ䃑;䎝܀Eacdfgmoprstuvලෂ෉෕ෛ෠෧෼ขภยา฿ไlig;䅒cute耻Ó䃓Āiy෎ීrc耻Ô䃔;䐞blac;䅐r;쀀𝔒rave耻Ò䃒ƀaei෮ෲ෶cr;䅌ga;䎩cron;䎟pf;쀀𝕆enCurlyĀDQฎบoubleQuote;怜uote;怘;橔Āclวฬr;쀀𝒪ash耻Ø䃘iŬื฼de耻Õ䃕es;樷ml耻Ö䃖erĀBP๋๠Āar๐๓r;怾acĀek๚๜;揞et;掴arenthesis;揜Ҁacfhilors๿ງຊຏຒດຝະ໼rtialD;戂y;䐟r;쀀𝔓i;䎦;䎠usMinus;䂱Āipຢອncareplanåڝf;愙Ȁ;eio຺ູ໠໤檻cedesȀ;EST່້໏໚扺qual;檯lantEqual;扼ilde;找me;怳Ādp໩໮uct;戏ortionĀ;aȥ໹l;戝Āci༁༆r;쀀𝒫;䎨ȀUfos༑༖༛༟OT耻"䀢r;쀀𝔔pf;愚cr;쀀𝒬؀BEacefhiorsu༾གྷཇའཱིྦྷྪྭ႖ႩႴႾarr;椐G耻®䂮ƀcnrཎནབute;䅔g;柫rĀ;tཛྷཝ憠l;椖ƀaeyཧཬཱron;䅘dil;䅖;䐠Ā;vླྀཹ愜erseĀEUྂྙĀlq྇ྎement;戋uilibrium;懋pEquilibrium;楯r»ཹo;䎡ghtЀACDFTUVa࿁࿫࿳ဢဨၛႇϘĀnr࿆࿒gleBracket;柩rowƀ;BL࿜࿝࿡憒ar;懥eftArrow;懄eiling;按oǵ࿹\0စbleBracket;柧nǔည\0နeeVector;楝ectorĀ;Bဝသ懂ar;楕loor;挋Āerိ၃eƀ;AVဵံြ抢rrow;憦ector;楛iangleƀ;BEၐၑၕ抳ar;槐qual;抵pƀDTVၣၮၸownVector;楏eeVector;楜ectorĀ;Bႂႃ憾ar;楔ectorĀ;B႑႒懀ar;楓Āpuႛ႞f;愝ndImplies;楰ightarrow;懛ĀchႹႼr;愛;憱leDelayed;槴ڀHOacfhimoqstuფჱჷჽᄙᄞᅑᅖᅡᅧᆵᆻᆿĀCcჩხHcy;䐩y;䐨FTcy;䐬cute;䅚ʀ;aeiyᄈᄉᄎᄓᄗ檼ron;䅠dil;䅞rc;䅜;䐡r;쀀𝔖ortȀDLRUᄪᄴᄾᅉownArrow»ОeftArrow»࢚ightArrow»࿝pArrow;憑gma;䎣allCircle;战pf;쀀𝕊ɲᅭ\0\0ᅰt;戚areȀ;ISUᅻᅼᆉᆯ斡ntersection;抓uĀbpᆏᆞsetĀ;Eᆗᆘ抏qual;抑ersetĀ;Eᆨᆩ抐qual;抒nion;抔cr;쀀𝒮ar;拆ȀbcmpᇈᇛሉላĀ;sᇍᇎ拐etĀ;Eᇍᇕqual;抆ĀchᇠህeedsȀ;ESTᇭᇮᇴᇿ扻qual;檰lantEqual;扽ilde;承Tháྌ;我ƀ;esሒሓሣ拑rsetĀ;Eሜም抃qual;抇et»ሓրHRSacfhiorsሾቄ቉ቕ቞ቱቶኟዂወዑORN耻Þ䃞ADE;愢ĀHc቎ቒcy;䐋y;䐦Ābuቚቜ;䀉;䎤ƀaeyብቪቯron;䅤dil;䅢;䐢r;쀀𝔗Āeiቻ኉ǲኀ\0ኇefore;戴a;䎘Ācn኎ኘkSpace;쀀  Space;怉ldeȀ;EFTካኬኲኼ戼qual;扃ullEqual;扅ilde;扈pf;쀀𝕋ipleDot;惛Āctዖዛr;쀀𝒯rok;䅦ૡዷጎጚጦ\0ጬጱ\0\0\0\0\0ጸጽ፷ᎅ\0᏿ᐄᐊᐐĀcrዻጁute耻Ú䃚rĀ;oጇገ憟cir;楉rǣጓ\0጖y;䐎ve;䅬Āiyጞጣrc耻Û䃛;䐣blac;䅰r;쀀𝔘rave耻Ù䃙acr;䅪Ādiፁ፩erĀBPፈ፝Āarፍፐr;䁟acĀekፗፙ;揟et;掵arenthesis;揝onĀ;P፰፱拃lus;抎Āgp፻፿on;䅲f;쀀𝕌ЀADETadps᎕ᎮᎸᏄϨᏒᏗᏳrrowƀ;BDᅐᎠᎤar;椒ownArrow;懅ownArrow;憕quilibrium;楮eeĀ;AᏋᏌ报rrow;憥ownáϳerĀLRᏞᏨeftArrow;憖ightArrow;憗iĀ;lᏹᏺ䏒on;䎥ing;䅮cr;쀀𝒰ilde;䅨ml耻Ü䃜ҀDbcdefosvᐧᐬᐰᐳᐾᒅᒊᒐᒖash;披ar;櫫y;䐒ashĀ;lᐻᐼ抩;櫦Āerᑃᑅ;拁ƀbtyᑌᑐᑺar;怖Ā;iᑏᑕcalȀBLSTᑡᑥᑪᑴar;戣ine;䁼eparator;杘ilde;所ThinSpace;怊r;쀀𝔙pf;쀀𝕍cr;쀀𝒱dash;抪ʀcefosᒧᒬᒱᒶᒼirc;䅴dge;拀r;쀀𝔚pf;쀀𝕎cr;쀀𝒲Ȁfiosᓋᓐᓒᓘr;쀀𝔛;䎞pf;쀀𝕏cr;쀀𝒳ҀAIUacfosuᓱᓵᓹᓽᔄᔏᔔᔚᔠcy;䐯cy;䐇cy;䐮cute耻Ý䃝Āiyᔉᔍrc;䅶;䐫r;쀀𝔜pf;쀀𝕐cr;쀀𝒴ml;䅸ЀHacdefosᔵᔹᔿᕋᕏᕝᕠᕤcy;䐖cute;䅹Āayᕄᕉron;䅽;䐗ot;䅻ǲᕔ\0ᕛoWidtè૙a;䎖r;愨pf;愤cr;쀀𝒵௡ᖃᖊᖐ\0ᖰᖶᖿ\0\0\0\0ᗆᗛᗫᙟ᙭\0ᚕ᚛ᚲᚹ\0ᚾcute耻á䃡reve;䄃̀;Ediuyᖜᖝᖡᖣᖨᖭ戾;쀀∾̳;房rc耻â䃢te肻´̆;䐰lig耻æ䃦Ā;r²ᖺ;쀀𝔞rave耻à䃠ĀepᗊᗖĀfpᗏᗔsym;愵èᗓha;䎱ĀapᗟcĀclᗤᗧr;䄁g;樿ɤᗰ\0\0ᘊʀ;adsvᗺᗻᗿᘁᘇ戧nd;橕;橜lope;橘;橚΀;elmrszᘘᘙᘛᘞᘿᙏᙙ戠;榤e»ᘙsdĀ;aᘥᘦ戡ѡᘰᘲᘴᘶᘸᘺᘼᘾ;榨;榩;榪;榫;榬;榭;榮;榯tĀ;vᙅᙆ戟bĀ;dᙌᙍ抾;榝Āptᙔᙗh;戢»¹arr;捼Āgpᙣᙧon;䄅f;쀀𝕒΀;Eaeiop዁ᙻᙽᚂᚄᚇᚊ;橰cir;橯;扊d;手s;䀧roxĀ;e዁ᚒñᚃing耻å䃥ƀctyᚡᚦᚨr;쀀𝒶;䀪mpĀ;e዁ᚯñʈilde耻ã䃣ml耻ä䃤Āciᛂᛈoninôɲnt;樑ࠀNabcdefiklnoprsu᛭ᛱᜰ᜼ᝃᝈ᝸᝽០៦ᠹᡐᜍ᤽᥈ᥰot;櫭Ācrᛶ᜞kȀcepsᜀᜅᜍᜓong;扌psilon;䏶rime;怵imĀ;e᜚᜛戽q;拍Ŷᜢᜦee;抽edĀ;gᜬᜭ挅e»ᜭrkĀ;t፜᜷brk;掶Āoyᜁᝁ;䐱quo;怞ʀcmprtᝓ᝛ᝡᝤᝨausĀ;eĊĉptyv;榰séᜌnoõēƀahwᝯ᝱ᝳ;䎲;愶een;扬r;쀀𝔟g΀costuvwឍឝឳេ៕៛៞ƀaiuបពរðݠrc;旯p»፱ƀdptឤឨឭot;樀lus;樁imes;樂ɱឹ\0\0ើcup;樆ar;昅riangleĀdu៍្own;施p;斳plus;樄eåᑄåᒭarow;植ƀako៭ᠦᠵĀcn៲ᠣkƀlst៺֫᠂ozenge;槫riangleȀ;dlr᠒᠓᠘᠝斴own;斾eft;旂ight;斸k;搣Ʊᠫ\0ᠳƲᠯ\0ᠱ;斒;斑4;斓ck;斈ĀeoᠾᡍĀ;qᡃᡆ쀀=⃥uiv;쀀≡⃥t;挐Ȁptwxᡙᡞᡧᡬf;쀀𝕓Ā;tᏋᡣom»Ꮜtie;拈؀DHUVbdhmptuvᢅᢖᢪᢻᣗᣛᣬ᣿ᤅᤊᤐᤡȀLRlrᢎᢐᢒᢔ;敗;敔;敖;敓ʀ;DUduᢡᢢᢤᢦᢨ敐;敦;敩;敤;敧ȀLRlrᢳᢵᢷᢹ;敝;敚;敜;教΀;HLRhlrᣊᣋᣍᣏᣑᣓᣕ救;敬;散;敠;敫;敢;敟ox;槉ȀLRlrᣤᣦᣨᣪ;敕;敒;攐;攌ʀ;DUduڽ᣷᣹᣻᣽;敥;敨;攬;攴inus;抟lus;択imes;抠ȀLRlrᤙᤛᤝ᤟;敛;敘;攘;攔΀;HLRhlrᤰᤱᤳᤵᤷ᤻᤹攂;敪;敡;敞;攼;攤;攜Āevģ᥂bar耻¦䂦Ȁceioᥑᥖᥚᥠr;쀀𝒷mi;恏mĀ;e᜚᜜lƀ;bhᥨᥩᥫ䁜;槅sub;柈Ŭᥴ᥾lĀ;e᥹᥺怢t»᥺pƀ;Eeįᦅᦇ;檮Ā;qۜۛೡᦧ\0᧨ᨑᨕᨲ\0ᨷᩐ\0\0᪴\0\0᫁\0\0ᬡᬮ᭍᭒\0᯽\0ᰌƀcpr᦭ᦲ᧝ute;䄇̀;abcdsᦿᧀᧄ᧊᧕᧙戩nd;橄rcup;橉Āau᧏᧒p;橋p;橇ot;橀;쀀∩︀Āeo᧢᧥t;恁îړȀaeiu᧰᧻ᨁᨅǰ᧵\0᧸s;橍on;䄍dil耻ç䃧rc;䄉psĀ;sᨌᨍ橌m;橐ot;䄋ƀdmnᨛᨠᨦil肻¸ƭptyv;榲t脀¢;eᨭᨮ䂢räƲr;쀀𝔠ƀceiᨽᩀᩍy;䑇ckĀ;mᩇᩈ朓ark»ᩈ;䏇r΀;Ecefms᩟᩠ᩢᩫ᪤᪪᪮旋;槃ƀ;elᩩᩪᩭ䋆q;扗eɡᩴ\0\0᪈rrowĀlr᩼᪁eft;憺ight;憻ʀRSacd᪒᪔᪖᪚᪟»ཇ;擈st;抛irc;抚ash;抝nint;樐id;櫯cir;槂ubsĀ;u᪻᪼晣it»᪼ˬ᫇᫔᫺\0ᬊonĀ;eᫍᫎ䀺Ā;qÇÆɭ᫙\0\0᫢aĀ;t᫞᫟䀬;䁀ƀ;fl᫨᫩᫫戁îᅠeĀmx᫱᫶ent»᫩eóɍǧ᫾\0ᬇĀ;dኻᬂot;橭nôɆƀfryᬐᬔᬗ;쀀𝕔oäɔ脀©;sŕᬝr;愗Āaoᬥᬩrr;憵ss;朗Ācuᬲᬷr;쀀𝒸Ābpᬼ᭄Ā;eᭁᭂ櫏;櫑Ā;eᭉᭊ櫐;櫒dot;拯΀delprvw᭠᭬᭷ᮂᮬᯔ᯹arrĀlr᭨᭪;椸;椵ɰ᭲\0\0᭵r;拞c;拟arrĀ;p᭿ᮀ憶;椽̀;bcdosᮏᮐᮖᮡᮥᮨ截rcap;橈Āauᮛᮞp;橆p;橊ot;抍r;橅;쀀∪︀Ȁalrv᮵ᮿᯞᯣrrĀ;mᮼᮽ憷;椼yƀevwᯇᯔᯘqɰᯎ\0\0ᯒreã᭳uã᭵ee;拎edge;拏en耻¤䂤earrowĀlrᯮ᯳eft»ᮀight»ᮽeäᯝĀciᰁᰇoninôǷnt;戱lcty;挭ঀAHabcdefhijlorstuwz᰸᰻᰿ᱝᱩᱵᲊᲞᲬᲷ᳻᳿ᴍᵻᶑᶫᶻ᷆᷍rò΁ar;楥Ȁglrs᱈ᱍ᱒᱔ger;怠eth;愸òᄳhĀ;vᱚᱛ怐»ऊūᱡᱧarow;椏aã̕Āayᱮᱳron;䄏;䐴ƀ;ao̲ᱼᲄĀgrʿᲁr;懊tseq;橷ƀglmᲑᲔᲘ耻°䂰ta;䎴ptyv;榱ĀirᲣᲨsht;楿;쀀𝔡arĀlrᲳᲵ»ࣜ»သʀaegsv᳂͸᳖᳜᳠mƀ;oș᳊᳔ndĀ;ș᳑uit;晦amma;䏝in;拲ƀ;io᳧᳨᳸䃷de脀÷;o᳧ᳰntimes;拇nø᳷cy;䑒cɯᴆ\0\0ᴊrn;挞op;挍ʀlptuwᴘᴝᴢᵉᵕlar;䀤f;쀀𝕕ʀ;emps̋ᴭᴷᴽᵂqĀ;d͒ᴳot;扑inus;戸lus;戔quare;抡blebarwedgåúnƀadhᄮᵝᵧownarrowóᲃarpoonĀlrᵲᵶefôᲴighôᲶŢᵿᶅkaro÷གɯᶊ\0\0ᶎrn;挟op;挌ƀcotᶘᶣᶦĀryᶝᶡ;쀀𝒹;䑕l;槶rok;䄑Ādrᶰᶴot;拱iĀ;fᶺ᠖斿Āah᷀᷃ròЩaòྦangle;榦Āci᷒ᷕy;䑟grarr;柿ऀDacdefglmnopqrstuxḁḉḙḸոḼṉṡṾấắẽỡἪἷὄ὎὚ĀDoḆᴴoôᲉĀcsḎḔute耻é䃩ter;橮ȀaioyḢḧḱḶron;䄛rĀ;cḭḮ扖耻ê䃪lon;払;䑍ot;䄗ĀDrṁṅot;扒;쀀𝔢ƀ;rsṐṑṗ檚ave耻è䃨Ā;dṜṝ檖ot;檘Ȁ;ilsṪṫṲṴ檙nters;揧;愓Ā;dṹṺ檕ot;檗ƀapsẅẉẗcr;䄓tyƀ;svẒẓẕ戅et»ẓpĀ1;ẝẤĳạả;怄;怅怃ĀgsẪẬ;䅋p;怂ĀgpẴẸon;䄙f;쀀𝕖ƀalsỄỎỒrĀ;sỊị拕l;槣us;橱iƀ;lvỚớở䎵on»ớ;䏵ȀcsuvỪỳἋἣĀioữḱrc»Ḯɩỹ\0\0ỻíՈantĀglἂἆtr»ṝess»Ṻƀaeiἒ἖Ἒls;䀽st;扟vĀ;DȵἠD;橸parsl;槥ĀDaἯἳot;打rr;楱ƀcdiἾὁỸr;愯oô͒ĀahὉὋ;䎷耻ð䃰Āmrὓὗl耻ë䃫o;悬ƀcipὡὤὧl;䀡sôծĀeoὬὴctatioîՙnentialåչৡᾒ\0ᾞ\0ᾡᾧ\0\0ῆῌ\0ΐ\0ῦῪ \0 ⁚llingdotseñṄy;䑄male;晀ƀilrᾭᾳ῁lig;耀ﬃɩᾹ\0\0᾽g;耀ﬀig;耀ﬄ;쀀𝔣lig;耀ﬁlig;쀀fjƀaltῙ῜ῡt;晭ig;耀ﬂns;斱of;䆒ǰ΅\0ῳf;쀀𝕗ĀakֿῷĀ;vῼ´拔;櫙artint;樍Āao‌⁕Ācs‑⁒α‚‰‸⁅⁈\0⁐β•‥‧‪‬\0‮耻½䂽;慓耻¼䂼;慕;慙;慛Ƴ‴\0‶;慔;慖ʴ‾⁁\0\0⁃耻¾䂾;慗;慜5;慘ƶ⁌\0⁎;慚;慝8;慞l;恄wn;挢cr;쀀𝒻ࢀEabcdefgijlnorstv₂₉₟₥₰₴⃰⃵⃺⃿℃ℒℸ̗ℾ⅒↞Ā;lٍ₇;檌ƀcmpₐₕ₝ute;䇵maĀ;dₜ᳚䎳;檆reve;䄟Āiy₪₮rc;䄝;䐳ot;䄡Ȁ;lqsؾق₽⃉ƀ;qsؾٌ⃄lanô٥Ȁ;cdl٥⃒⃥⃕c;檩otĀ;o⃜⃝檀Ā;l⃢⃣檂;檄Ā;e⃪⃭쀀⋛︀s;檔r;쀀𝔤Ā;gٳ؛mel;愷cy;䑓Ȁ;Eajٚℌℎℐ;檒;檥;檤ȀEaesℛℝ℩ℴ;扩pĀ;p℣ℤ檊rox»ℤĀ;q℮ℯ檈Ā;q℮ℛim;拧pf;쀀𝕘Āci⅃ⅆr;愊mƀ;el٫ⅎ⅐;檎;檐茀>;cdlqr׮ⅠⅪⅮⅳⅹĀciⅥⅧ;檧r;橺ot;拗Par;榕uest;橼ʀadelsↄⅪ←ٖ↛ǰ↉\0↎proø₞r;楸qĀlqؿ↖lesó₈ií٫Āen↣↭rtneqq;쀀≩︀Å↪ԀAabcefkosy⇄⇇⇱⇵⇺∘∝∯≨≽ròΠȀilmr⇐⇔⇗⇛rsðᒄf»․ilôکĀdr⇠⇤cy;䑊ƀ;cwࣴ⇫⇯ir;楈;憭ar;意irc;䄥ƀalr∁∎∓rtsĀ;u∉∊晥it»∊lip;怦con;抹r;쀀𝔥sĀew∣∩arow;椥arow;椦ʀamopr∺∾≃≞≣rr;懿tht;戻kĀlr≉≓eftarrow;憩ightarrow;憪f;쀀𝕙bar;怕ƀclt≯≴≸r;쀀𝒽asè⇴rok;䄧Ābp⊂⊇ull;恃hen»ᱛૡ⊣\0⊪\0⊸⋅⋎\0⋕⋳\0\0⋸⌢⍧⍢⍿\0⎆⎪⎴cute耻í䃭ƀ;iyݱ⊰⊵rc耻î䃮;䐸Ācx⊼⊿y;䐵cl耻¡䂡ĀfrΟ⋉;쀀𝔦rave耻ì䃬Ȁ;inoܾ⋝⋩⋮Āin⋢⋦nt;樌t;戭fin;槜ta;愩lig;䄳ƀaop⋾⌚⌝ƀcgt⌅⌈⌗r;䄫ƀelpܟ⌏⌓inåގarôܠh;䄱f;抷ed;䆵ʀ;cfotӴ⌬⌱⌽⍁are;愅inĀ;t⌸⌹戞ie;槝doô⌙ʀ;celpݗ⍌⍐⍛⍡al;抺Āgr⍕⍙eróᕣã⍍arhk;樗rod;樼Ȁcgpt⍯⍲⍶⍻y;䑑on;䄯f;쀀𝕚a;䎹uest耻¿䂿Āci⎊⎏r;쀀𝒾nʀ;EdsvӴ⎛⎝⎡ӳ;拹ot;拵Ā;v⎦⎧拴;拳Ā;iݷ⎮lde;䄩ǫ⎸\0⎼cy;䑖l耻ï䃯̀cfmosu⏌⏗⏜⏡⏧⏵Āiy⏑⏕rc;䄵;䐹r;쀀𝔧ath;䈷pf;쀀𝕛ǣ⏬\0⏱r;쀀𝒿rcy;䑘kcy;䑔Ѐacfghjos␋␖␢␧␭␱␵␻ppaĀ;v␓␔䎺;䏰Āey␛␠dil;䄷;䐺r;쀀𝔨reen;䄸cy;䑅cy;䑜pf;쀀𝕜cr;쀀𝓀஀ABEHabcdefghjlmnoprstuv⑰⒁⒆⒍⒑┎┽╚▀♎♞♥♹♽⚚⚲⛘❝❨➋⟀⠁⠒ƀart⑷⑺⑼rò৆òΕail;椛arr;椎Ā;gঔ⒋;檋ar;楢ॣ⒥\0⒪\0⒱\0\0\0\0\0⒵Ⓔ\0ⓆⓈⓍ\0⓹ute;䄺mptyv;榴raîࡌbda;䎻gƀ;dlࢎⓁⓃ;榑åࢎ;檅uo耻«䂫rЀ;bfhlpst࢙ⓞⓦⓩ⓫⓮⓱⓵Ā;f࢝ⓣs;椟s;椝ë≒p;憫l;椹im;楳l;憢ƀ;ae⓿─┄檫il;椙Ā;s┉┊檭;쀀⪭︀ƀabr┕┙┝rr;椌rk;杲Āak┢┬cĀek┨┪;䁻;䁛Āes┱┳;榋lĀdu┹┻;榏;榍Ȁaeuy╆╋╖╘ron;䄾Ādi═╔il;䄼ìࢰâ┩;䐻Ȁcqrs╣╦╭╽a;椶uoĀ;rนᝆĀdu╲╷har;楧shar;楋h;憲ʀ;fgqs▋▌উ◳◿扤tʀahlrt▘▤▷◂◨rrowĀ;t࢙□aé⓶arpoonĀdu▯▴own»њp»०eftarrows;懇ightƀahs◍◖◞rrowĀ;sࣴࢧarpoonó྘quigarro÷⇰hreetimes;拋ƀ;qs▋ও◺lanôবʀ;cdgsব☊☍☝☨c;檨otĀ;o☔☕橿Ā;r☚☛檁;檃Ā;e☢☥쀀⋚︀s;檓ʀadegs☳☹☽♉♋pproøⓆot;拖qĀgq♃♅ôউgtò⒌ôছiíলƀilr♕࣡♚sht;楼;쀀𝔩Ā;Eজ♣;檑š♩♶rĀdu▲♮Ā;l॥♳;楪lk;斄cy;䑙ʀ;achtੈ⚈⚋⚑⚖rò◁orneòᴈard;楫ri;旺Āio⚟⚤dot;䅀ustĀ;a⚬⚭掰che»⚭ȀEaes⚻⚽⛉⛔;扨pĀ;p⛃⛄檉rox»⛄Ā;q⛎⛏檇Ā;q⛎⚻im;拦Ѐabnoptwz⛩⛴⛷✚✯❁❇❐Ānr⛮⛱g;柬r;懽rëࣁgƀlmr⛿✍✔eftĀar০✇ightá৲apsto;柼ightá৽parrowĀlr✥✩efô⓭ight;憬ƀafl✶✹✽r;榅;쀀𝕝us;樭imes;樴š❋❏st;戗áፎƀ;ef❗❘᠀旊nge»❘arĀ;l❤❥䀨t;榓ʀachmt❳❶❼➅➇ròࢨorneòᶌarĀ;d྘➃;業;怎ri;抿̀achiqt➘➝ੀ➢➮➻quo;怹r;쀀𝓁mƀ;egল➪➬;檍;檏Ābu┪➳oĀ;rฟ➹;怚rok;䅂萀<;cdhilqrࠫ⟒☹⟜⟠⟥⟪⟰Āci⟗⟙;檦r;橹reå◲mes;拉arr;楶uest;橻ĀPi⟵⟹ar;榖ƀ;ef⠀भ᠛旃rĀdu⠇⠍shar;楊har;楦Āen⠗⠡rtneqq;쀀≨︀Å⠞܀Dacdefhilnopsu⡀⡅⢂⢎⢓⢠⢥⢨⣚⣢⣤ઃ⣳⤂Dot;戺Ȁclpr⡎⡒⡣⡽r耻¯䂯Āet⡗⡙;時Ā;e⡞⡟朠se»⡟Ā;sျ⡨toȀ;dluျ⡳⡷⡻owîҌefôएðᏑker;斮Āoy⢇⢌mma;権;䐼ash;怔asuredangle»ᘦr;쀀𝔪o;愧ƀcdn⢯⢴⣉ro耻µ䂵Ȁ;acdᑤ⢽⣀⣄sôᚧir;櫰ot肻·Ƶusƀ;bd⣒ᤃ⣓戒Ā;uᴼ⣘;横ţ⣞⣡p;櫛ò−ðઁĀdp⣩⣮els;抧f;쀀𝕞Āct⣸⣽r;쀀𝓂pos»ᖝƀ;lm⤉⤊⤍䎼timap;抸ఀGLRVabcdefghijlmoprstuvw⥂⥓⥾⦉⦘⧚⧩⨕⨚⩘⩝⪃⪕⪤⪨⬄⬇⭄⭿⮮ⰴⱧⱼ⳩Āgt⥇⥋;쀀⋙̸Ā;v⥐௏쀀≫⃒ƀelt⥚⥲⥶ftĀar⥡⥧rrow;懍ightarrow;懎;쀀⋘̸Ā;v⥻ే쀀≪⃒ightarrow;懏ĀDd⦎⦓ash;抯ash;抮ʀbcnpt⦣⦧⦬⦱⧌la»˞ute;䅄g;쀀∠⃒ʀ;Eiop඄⦼⧀⧅⧈;쀀⩰̸d;쀀≋̸s;䅉roø඄urĀ;a⧓⧔普lĀ;s⧓ସǳ⧟\0⧣p肻 ଷmpĀ;e௹ఀʀaeouy⧴⧾⨃⨐⨓ǰ⧹\0⧻;橃on;䅈dil;䅆ngĀ;dൾ⨊ot;쀀⩭̸p;橂;䐽ash;怓΀;Aadqsxஒ⨩⨭⨻⩁⩅⩐rr;懗rĀhr⨳⨶k;椤Ā;oᏲᏰot;쀀≐̸uiöୣĀei⩊⩎ar;椨í஘istĀ;s஠டr;쀀𝔫ȀEest௅⩦⩹⩼ƀ;qs஼⩭௡ƀ;qs஼௅⩴lanô௢ií௪Ā;rஶ⪁»ஷƀAap⪊⪍⪑rò⥱rr;憮ar;櫲ƀ;svྍ⪜ྌĀ;d⪡⪢拼;拺cy;䑚΀AEadest⪷⪺⪾⫂⫅⫶⫹rò⥦;쀀≦̸rr;憚r;急Ȁ;fqs఻⫎⫣⫯tĀar⫔⫙rro÷⫁ightarro÷⪐ƀ;qs఻⪺⫪lanôౕĀ;sౕ⫴»శiíౝĀ;rవ⫾iĀ;eచథiäඐĀpt⬌⬑f;쀀𝕟膀¬;in⬙⬚⬶䂬nȀ;Edvஉ⬤⬨⬮;쀀⋹̸ot;쀀⋵̸ǡஉ⬳⬵;拷;拶iĀ;vಸ⬼ǡಸ⭁⭃;拾;拽ƀaor⭋⭣⭩rȀ;ast୻⭕⭚⭟lleì୻l;쀀⫽⃥;쀀∂̸lint;樔ƀ;ceಒ⭰⭳uåಥĀ;cಘ⭸Ā;eಒ⭽ñಘȀAait⮈⮋⮝⮧rò⦈rrƀ;cw⮔⮕⮙憛;쀀⤳̸;쀀↝̸ghtarrow»⮕riĀ;eೋೖ΀chimpqu⮽⯍⯙⬄୸⯤⯯Ȁ;cerല⯆ഷ⯉uå൅;쀀𝓃ortɭ⬅\0\0⯖ará⭖mĀ;e൮⯟Ā;q൴൳suĀbp⯫⯭å೸åഋƀbcp⯶ⰑⰙȀ;Ees⯿ⰀഢⰄ抄;쀀⫅̸etĀ;eഛⰋqĀ;qണⰀcĀ;eലⰗñസȀ;EesⰢⰣൟⰧ抅;쀀⫆̸etĀ;e൘ⰮqĀ;qൠⰣȀgilrⰽⰿⱅⱇìௗlde耻ñ䃱çృiangleĀlrⱒⱜeftĀ;eచⱚñదightĀ;eೋⱥñ೗Ā;mⱬⱭ䎽ƀ;esⱴⱵⱹ䀣ro;愖p;怇ҀDHadgilrsⲏⲔⲙⲞⲣⲰⲶⳓⳣash;抭arr;椄p;쀀≍⃒ash;抬ĀetⲨⲬ;쀀≥⃒;쀀>⃒nfin;槞ƀAetⲽⳁⳅrr;椂;쀀≤⃒Ā;rⳊⳍ쀀<⃒ie;쀀⊴⃒ĀAtⳘⳜrr;椃rie;쀀⊵⃒im;쀀∼⃒ƀAan⳰⳴ⴂrr;懖rĀhr⳺⳽k;椣Ā;oᏧᏥear;椧ቓ᪕\0\0\0\0\0\0\0\0\0\0\0\0\0ⴭ\0ⴸⵈⵠⵥ⵲ⶄᬇ\0\0ⶍⶫ\0ⷈⷎ\0ⷜ⸙⸫⸾⹃Ācsⴱ᪗ute耻ó䃳ĀiyⴼⵅrĀ;c᪞ⵂ耻ô䃴;䐾ʀabios᪠ⵒⵗǈⵚlac;䅑v;樸old;榼lig;䅓Ācr⵩⵭ir;榿;쀀𝔬ͯ⵹\0\0⵼\0ⶂn;䋛ave耻ò䃲;槁Ābmⶈ෴ar;榵Ȁacitⶕ⶘ⶥⶨrò᪀Āir⶝ⶠr;榾oss;榻nå๒;槀ƀaeiⶱⶵⶹcr;䅍ga;䏉ƀcdnⷀⷅǍron;䎿;榶pf;쀀𝕠ƀaelⷔ⷗ǒr;榷rp;榹΀;adiosvⷪⷫⷮ⸈⸍⸐⸖戨rò᪆Ȁ;efmⷷⷸ⸂⸅橝rĀ;oⷾⷿ愴f»ⷿ耻ª䂪耻º䂺gof;抶r;橖lope;橗;橛ƀclo⸟⸡⸧ò⸁ash耻ø䃸l;折iŬⸯ⸴de耻õ䃵esĀ;aǛ⸺s;樶ml耻ö䃶bar;挽ૡ⹞\0⹽\0⺀⺝\0⺢⺹\0\0⻋ຜ\0⼓\0\0⼫⾼\0⿈rȀ;astЃ⹧⹲຅脀¶;l⹭⹮䂶leìЃɩ⹸\0\0⹻m;櫳;櫽y;䐿rʀcimpt⺋⺏⺓ᡥ⺗nt;䀥od;䀮il;怰enk;怱r;쀀𝔭ƀimo⺨⺰⺴Ā;v⺭⺮䏆;䏕maô੶ne;明ƀ;tv⺿⻀⻈䏀chfork»´;䏖Āau⻏⻟nĀck⻕⻝kĀ;h⇴⻛;愎ö⇴sҀ;abcdemst⻳⻴ᤈ⻹⻽⼄⼆⼊⼎䀫cir;樣ir;樢Āouᵀ⼂;樥;橲n肻±ຝim;樦wo;樧ƀipu⼙⼠⼥ntint;樕f;쀀𝕡nd耻£䂣Ԁ;Eaceinosu່⼿⽁⽄⽇⾁⾉⾒⽾⾶;檳p;檷uå໙Ā;c໎⽌̀;acens່⽙⽟⽦⽨⽾pproø⽃urlyeñ໙ñ໎ƀaes⽯⽶⽺pprox;檹qq;檵im;拨iíໟmeĀ;s⾈ຮ怲ƀEas⽸⾐⽺ð⽵ƀdfp໬⾙⾯ƀals⾠⾥⾪lar;挮ine;挒urf;挓Ā;t໻⾴ï໻rel;抰Āci⿀⿅r;쀀𝓅;䏈ncsp;怈̀fiopsu⿚⋢⿟⿥⿫⿱r;쀀𝔮pf;쀀𝕢rime;恗cr;쀀𝓆ƀaeo⿸〉〓tĀei⿾々rnionóڰnt;樖stĀ;e【】䀿ñἙô༔઀ABHabcdefhilmnoprstux぀けさすムㄎㄫㅇㅢㅲㆎ㈆㈕㈤㈩㉘㉮㉲㊐㊰㊷ƀartぇおがròႳòϝail;検aròᱥar;楤΀cdenqrtとふへみわゔヌĀeuねぱ;쀀∽̱te;䅕iãᅮmptyv;榳gȀ;del࿑らるろ;榒;榥å࿑uo耻»䂻rր;abcfhlpstw࿜ガクシスゼゾダッデナp;極Ā;f࿠ゴs;椠;椳s;椞ë≝ð✮l;楅im;楴l;憣;憝Āaiパフil;椚oĀ;nホボ戶aló༞ƀabrョリヮrò៥rk;杳ĀakンヽcĀekヹ・;䁽;䁝Āes㄂㄄;榌lĀduㄊㄌ;榎;榐Ȁaeuyㄗㄜㄧㄩron;䅙Ādiㄡㄥil;䅗ì࿲âヺ;䑀Ȁclqsㄴㄷㄽㅄa;椷dhar;楩uoĀ;rȎȍh;憳ƀacgㅎㅟངlȀ;ipsླྀㅘㅛႜnåႻarôྩt;断ƀilrㅩဣㅮsht;楽;쀀𝔯ĀaoㅷㆆrĀduㅽㅿ»ѻĀ;l႑ㆄ;楬Ā;vㆋㆌ䏁;䏱ƀgns㆕ㇹㇼht̀ahlrstㆤㆰ㇂㇘㇤㇮rrowĀ;t࿜ㆭaéトarpoonĀduㆻㆿowîㅾp»႒eftĀah㇊㇐rrowó࿪arpoonóՑightarrows;應quigarro÷ニhreetimes;拌g;䋚ingdotseñἲƀahm㈍㈐㈓rò࿪aòՑ;怏oustĀ;a㈞㈟掱che»㈟mid;櫮Ȁabpt㈲㈽㉀㉒Ānr㈷㈺g;柭r;懾rëဃƀafl㉇㉊㉎r;榆;쀀𝕣us;樮imes;樵Āap㉝㉧rĀ;g㉣㉤䀩t;榔olint;樒arò㇣Ȁachq㉻㊀Ⴜ㊅quo;怺r;쀀𝓇Ābu・㊊oĀ;rȔȓƀhir㊗㊛㊠reåㇸmes;拊iȀ;efl㊪ၙᠡ㊫方tri;槎luhar;楨;愞ൡ㋕㋛㋟㌬㌸㍱\0㍺㎤\0\0㏬㏰\0㐨㑈㑚㒭㒱㓊㓱\0㘖\0\0㘳cute;䅛quï➺Ԁ;Eaceinpsyᇭ㋳㋵㋿㌂㌋㌏㌟㌦㌩;檴ǰ㋺\0㋼;檸on;䅡uåᇾĀ;dᇳ㌇il;䅟rc;䅝ƀEas㌖㌘㌛;檶p;檺im;择olint;樓iíሄ;䑁otƀ;be㌴ᵇ㌵担;橦΀Aacmstx㍆㍊㍗㍛㍞㍣㍭rr;懘rĀhr㍐㍒ë∨Ā;oਸ਼਴t耻§䂧i;䀻war;椩mĀin㍩ðnuóñt;朶rĀ;o㍶⁕쀀𝔰Ȁacoy㎂㎆㎑㎠rp;景Āhy㎋㎏cy;䑉;䑈rtɭ㎙\0\0㎜iäᑤaraì⹯耻­䂭Āgm㎨㎴maƀ;fv㎱㎲㎲䏃;䏂Ѐ;deglnprካ㏅㏉㏎㏖㏞㏡㏦ot;橪Ā;q኱ኰĀ;E㏓㏔檞;檠Ā;E㏛㏜檝;檟e;扆lus;樤arr;楲aròᄽȀaeit㏸㐈㐏㐗Āls㏽㐄lsetmé㍪hp;樳parsl;槤Ādlᑣ㐔e;挣Ā;e㐜㐝檪Ā;s㐢㐣檬;쀀⪬︀ƀflp㐮㐳㑂tcy;䑌Ā;b㐸㐹䀯Ā;a㐾㐿槄r;挿f;쀀𝕤aĀdr㑍ЂesĀ;u㑔㑕晠it»㑕ƀcsu㑠㑹㒟Āau㑥㑯pĀ;sᆈ㑫;쀀⊓︀pĀ;sᆴ㑵;쀀⊔︀uĀbp㑿㒏ƀ;esᆗᆜ㒆etĀ;eᆗ㒍ñᆝƀ;esᆨᆭ㒖etĀ;eᆨ㒝ñᆮƀ;afᅻ㒦ְrť㒫ֱ»ᅼaròᅈȀcemt㒹㒾㓂㓅r;쀀𝓈tmîñiì㐕aræᆾĀar㓎㓕rĀ;f㓔ឿ昆Āan㓚㓭ightĀep㓣㓪psiloîỠhé⺯s»⡒ʀbcmnp㓻㕞ሉ㖋㖎Ҁ;Edemnprs㔎㔏㔑㔕㔞㔣㔬㔱㔶抂;櫅ot;檽Ā;dᇚ㔚ot;櫃ult;櫁ĀEe㔨㔪;櫋;把lus;檿arr;楹ƀeiu㔽㕒㕕tƀ;en㔎㕅㕋qĀ;qᇚ㔏eqĀ;q㔫㔨m;櫇Ābp㕚㕜;櫕;櫓c̀;acensᇭ㕬㕲㕹㕻㌦pproø㋺urlyeñᇾñᇳƀaes㖂㖈㌛pproø㌚qñ㌗g;晪ڀ123;Edehlmnps㖩㖬㖯ሜ㖲㖴㗀㗉㗕㗚㗟㗨㗭耻¹䂹耻²䂲耻³䂳;櫆Āos㖹㖼t;檾ub;櫘Ā;dሢ㗅ot;櫄sĀou㗏㗒l;柉b;櫗arr;楻ult;櫂ĀEe㗤㗦;櫌;抋lus;櫀ƀeiu㗴㘉㘌tƀ;enሜ㗼㘂qĀ;qሢ㖲eqĀ;q㗧㗤m;櫈Ābp㘑㘓;櫔;櫖ƀAan㘜㘠㘭rr;懙rĀhr㘦㘨ë∮Ā;oਫ਩war;椪lig耻ß䃟௡㙑㙝㙠ዎ㙳㙹\0㙾㛂\0\0\0\0\0㛛㜃\0㜉㝬\0\0\0㞇ɲ㙖\0\0㙛get;挖;䏄rë๟ƀaey㙦㙫㙰ron;䅥dil;䅣;䑂lrec;挕r;쀀𝔱Ȁeiko㚆㚝㚵㚼ǲ㚋\0㚑eĀ4fኄኁaƀ;sv㚘㚙㚛䎸ym;䏑Ācn㚢㚲kĀas㚨㚮pproø዁im»ኬsðኞĀas㚺㚮ð዁rn耻þ䃾Ǭ̟㛆⋧es膀×;bd㛏㛐㛘䃗Ā;aᤏ㛕r;樱;樰ƀeps㛡㛣㜀á⩍Ȁ;bcf҆㛬㛰㛴ot;挶ir;櫱Ā;o㛹㛼쀀𝕥rk;櫚á㍢rime;怴ƀaip㜏㜒㝤dåቈ΀adempst㜡㝍㝀㝑㝗㝜㝟ngleʀ;dlqr㜰㜱㜶㝀㝂斵own»ᶻeftĀ;e⠀㜾ñम;扜ightĀ;e㊪㝋ñၚot;旬inus;樺lus;樹b;槍ime;樻ezium;揢ƀcht㝲㝽㞁Āry㝷㝻;쀀𝓉;䑆cy;䑛rok;䅧Āio㞋㞎xô᝷headĀlr㞗㞠eftarro÷ࡏightarrow»ཝऀAHabcdfghlmoprstuw㟐㟓㟗㟤㟰㟼㠎㠜㠣㠴㡑㡝㡫㢩㣌㣒㣪㣶ròϭar;楣Ācr㟜㟢ute耻ú䃺òᅐrǣ㟪\0㟭y;䑞ve;䅭Āiy㟵㟺rc耻û䃻;䑃ƀabh㠃㠆㠋ròᎭlac;䅱aòᏃĀir㠓㠘sht;楾;쀀𝔲rave耻ù䃹š㠧㠱rĀlr㠬㠮»ॗ»ႃlk;斀Āct㠹㡍ɯ㠿\0\0㡊rnĀ;e㡅㡆挜r»㡆op;挏ri;旸Āal㡖㡚cr;䅫肻¨͉Āgp㡢㡦on;䅳f;쀀𝕦̀adhlsuᅋ㡸㡽፲㢑㢠ownáᎳarpoonĀlr㢈㢌efô㠭ighô㠯iƀ;hl㢙㢚㢜䏅»ᏺon»㢚parrows;懈ƀcit㢰㣄㣈ɯ㢶\0\0㣁rnĀ;e㢼㢽挝r»㢽op;挎ng;䅯ri;旹cr;쀀𝓊ƀdir㣙㣝㣢ot;拰lde;䅩iĀ;f㜰㣨»᠓Āam㣯㣲rò㢨l耻ü䃼angle;榧ހABDacdeflnoprsz㤜㤟㤩㤭㦵㦸㦽㧟㧤㧨㧳㧹㧽㨁㨠ròϷarĀ;v㤦㤧櫨;櫩asèϡĀnr㤲㤷grt;榜΀eknprst㓣㥆㥋㥒㥝㥤㦖appá␕othinçẖƀhir㓫⻈㥙opô⾵Ā;hᎷ㥢ïㆍĀiu㥩㥭gmá㎳Ābp㥲㦄setneqĀ;q㥽㦀쀀⊊︀;쀀⫋︀setneqĀ;q㦏㦒쀀⊋︀;쀀⫌︀Āhr㦛㦟etá㚜iangleĀlr㦪㦯eft»थight»ၑy;䐲ash»ံƀelr㧄㧒㧗ƀ;beⷪ㧋㧏ar;抻q;扚lip;拮Ābt㧜ᑨaòᑩr;쀀𝔳tré㦮suĀbp㧯㧱»ജ»൙pf;쀀𝕧roð໻tré㦴Ācu㨆㨋r;쀀𝓋Ābp㨐㨘nĀEe㦀㨖»㥾nĀEe㦒㨞»㦐igzag;榚΀cefoprs㨶㨻㩖㩛㩔㩡㩪irc;䅵Ādi㩀㩑Ābg㩅㩉ar;機eĀ;qᗺ㩏;扙erp;愘r;쀀𝔴pf;쀀𝕨Ā;eᑹ㩦atèᑹcr;쀀𝓌ૣណ㪇\0㪋\0㪐㪛\0\0㪝㪨㪫㪯\0\0㫃㫎\0㫘ៜ៟tré៑r;쀀𝔵ĀAa㪔㪗ròσrò৶;䎾ĀAa㪡㪤ròθrò৫að✓is;拻ƀdptឤ㪵㪾Āfl㪺ឩ;쀀𝕩imåឲĀAa㫇㫊ròώròਁĀcq㫒ីr;쀀𝓍Āpt៖㫜ré។Ѐacefiosu㫰㫽㬈㬌㬑㬕㬛㬡cĀuy㫶㫻te耻ý䃽;䑏Āiy㬂㬆rc;䅷;䑋n耻¥䂥r;쀀𝔶cy;䑗pf;쀀𝕪cr;쀀𝓎Ācm㬦㬩y;䑎l耻ÿ䃿Ԁacdefhiosw㭂㭈㭔㭘㭤㭩㭭㭴㭺㮀cute;䅺Āay㭍㭒ron;䅾;䐷ot;䅼Āet㭝㭡træᕟa;䎶r;쀀𝔷cy;䐶grarr;懝pf;쀀𝕫cr;쀀𝓏Ājn㮅㮇;怍j;怌'.split("").map(t=>t.charCodeAt(0))),vme=new Uint16Array("Ȁaglq	\x1Bɭ\0\0p;䀦os;䀧t;䀾t;䀼uot;䀢".split("").map(t=>t.charCodeAt(0)));var dw;const wme=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Eme=(dw=String.fromCodePoint)!==null&&dw!==void 0?dw:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function xme(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=wme.get(t))!==null&&e!==void 0?e:t}var Cr;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(Cr||(Cr={}));const Sme=32;var ca;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(ca||(ca={}));function wx(t){return t>=Cr.ZERO&&t<=Cr.NINE}function Tme(t){return t>=Cr.UPPER_A&&t<=Cr.UPPER_F||t>=Cr.LOWER_A&&t<=Cr.LOWER_F}function Cme(t){return t>=Cr.UPPER_A&&t<=Cr.UPPER_Z||t>=Cr.LOWER_A&&t<=Cr.LOWER_Z||wx(t)}function kme(t){return t===Cr.EQUALS||Cme(t)}var Sr;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(Sr||(Sr={}));var ao;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(ao||(ao={}));class Nj{constructor(e,r,n){this.decodeTree=e,this.emitCodePoint=r,this.errors=n,this.state=Sr.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=ao.Strict}startEntity(e){this.decodeMode=e,this.state=Sr.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,r){switch(this.state){case Sr.EntityStart:return e.charCodeAt(r)===Cr.NUM?(this.state=Sr.NumericStart,this.consumed+=1,this.stateNumericStart(e,r+1)):(this.state=Sr.NamedEntity,this.stateNamedEntity(e,r));case Sr.NumericStart:return this.stateNumericStart(e,r);case Sr.NumericDecimal:return this.stateNumericDecimal(e,r);case Sr.NumericHex:return this.stateNumericHex(e,r);case Sr.NamedEntity:return this.stateNamedEntity(e,r)}}stateNumericStart(e,r){return r>=e.length?-1:(e.charCodeAt(r)|Sme)===Cr.LOWER_X?(this.state=Sr.NumericHex,this.consumed+=1,this.stateNumericHex(e,r+1)):(this.state=Sr.NumericDecimal,this.stateNumericDecimal(e,r))}addToNumericResult(e,r,n,s){if(r!==n){const i=n-r;this.result=this.result*Math.pow(s,i)+parseInt(e.substr(r,i),s),this.consumed+=i}}stateNumericHex(e,r){const n=r;for(;r<e.length;){const s=e.charCodeAt(r);if(wx(s)||Tme(s))r+=1;else return this.addToNumericResult(e,n,r,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(e,n,r,16),-1}stateNumericDecimal(e,r){const n=r;for(;r<e.length;){const s=e.charCodeAt(r);if(wx(s))r+=1;else return this.addToNumericResult(e,n,r,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(e,n,r,10),-1}emitNumericEntity(e,r){var n;if(this.consumed<=r)return(n=this.errors)===null||n===void 0||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===Cr.SEMI)this.consumed+=1;else if(this.decodeMode===ao.Strict)return 0;return this.emitCodePoint(xme(this.result),this.consumed),this.errors&&(e!==Cr.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,r){const{decodeTree:n}=this;let s=n[this.treeIndex],i=(s&ca.VALUE_LENGTH)>>14;for(;r<e.length;r++,this.excess++){const o=e.charCodeAt(r);if(this.treeIndex=Ame(n,s,this.treeIndex+Math.max(1,i),o),this.treeIndex<0)return this.result===0||this.decodeMode===ao.Attribute&&(i===0||kme(o))?0:this.emitNotTerminatedNamedEntity();if(s=n[this.treeIndex],i=(s&ca.VALUE_LENGTH)>>14,i!==0){if(o===Cr.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==ao.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:r,decodeTree:n}=this,s=(n[r]&ca.VALUE_LENGTH)>>14;return this.emitNamedEntityData(r,s,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,r,n){const{decodeTree:s}=this;return this.emitCodePoint(r===1?s[e]&~ca.VALUE_LENGTH:s[e+1],n),r===3&&this.emitCodePoint(s[e+2],n),n}end(){var e;switch(this.state){case Sr.NamedEntity:return this.result!==0&&(this.decodeMode!==ao.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Sr.NumericDecimal:return this.emitNumericEntity(0,2);case Sr.NumericHex:return this.emitNumericEntity(0,3);case Sr.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Sr.EntityStart:return 0}}}function Mj(t){let e="";const r=new Nj(t,n=>e+=Eme(n));return function(s,i){let o=0,a=0;for(;(a=s.indexOf("&",a))>=0;){e+=s.slice(o,a),r.startEntity(i);const c=r.write(s,a+1);if(c<0){o=a+r.end();break}o=a+c,a=c===0?o+1:o}const l=e+s.slice(o);return e="",l}}function Ame(t,e,r,n){const s=(e&ca.BRANCH_LENGTH)>>7,i=e&ca.JUMP_TABLE;if(s===0)return i!==0&&n===i?r:-1;if(i){const l=n-i;return l<0||l>=s?-1:t[r+l]-1}let o=r,a=o+s-1;for(;o<=a;){const l=o+a>>>1,c=t[l];if(c<n)o=l+1;else if(c>n)a=l-1;else return t[l+s]}return-1}Mj(Lj);Mj(vme);var De;(function(t){t.HTML="http://www.w3.org/1999/xhtml",t.MATHML="http://www.w3.org/1998/Math/MathML",t.SVG="http://www.w3.org/2000/svg",t.XLINK="http://www.w3.org/1999/xlink",t.XML="http://www.w3.org/XML/1998/namespace",t.XMLNS="http://www.w3.org/2000/xmlns/"})(De||(De={}));var Il;(function(t){t.TYPE="type",t.ACTION="action",t.ENCODING="encoding",t.PROMPT="prompt",t.NAME="name",t.COLOR="color",t.FACE="face",t.SIZE="size"})(Il||(Il={}));var ds;(function(t){t.NO_QUIRKS="no-quirks",t.QUIRKS="quirks",t.LIMITED_QUIRKS="limited-quirks"})(ds||(ds={}));var _e;(function(t){t.A="a",t.ADDRESS="address",t.ANNOTATION_XML="annotation-xml",t.APPLET="applet",t.AREA="area",t.ARTICLE="article",t.ASIDE="aside",t.B="b",t.BASE="base",t.BASEFONT="basefont",t.BGSOUND="bgsound",t.BIG="big",t.BLOCKQUOTE="blockquote",t.BODY="body",t.BR="br",t.BUTTON="button",t.CAPTION="caption",t.CENTER="center",t.CODE="code",t.COL="col",t.COLGROUP="colgroup",t.DD="dd",t.DESC="desc",t.DETAILS="details",t.DIALOG="dialog",t.DIR="dir",t.DIV="div",t.DL="dl",t.DT="dt",t.EM="em",t.EMBED="embed",t.FIELDSET="fieldset",t.FIGCAPTION="figcaption",t.FIGURE="figure",t.FONT="font",t.FOOTER="footer",t.FOREIGN_OBJECT="foreignObject",t.FORM="form",t.FRAME="frame",t.FRAMESET="frameset",t.H1="h1",t.H2="h2",t.H3="h3",t.H4="h4",t.H5="h5",t.H6="h6",t.HEAD="head",t.HEADER="header",t.HGROUP="hgroup",t.HR="hr",t.HTML="html",t.I="i",t.IMG="img",t.IMAGE="image",t.INPUT="input",t.IFRAME="iframe",t.KEYGEN="keygen",t.LABEL="label",t.LI="li",t.LINK="link",t.LISTING="listing",t.MAIN="main",t.MALIGNMARK="malignmark",t.MARQUEE="marquee",t.MATH="math",t.MENU="menu",t.META="meta",t.MGLYPH="mglyph",t.MI="mi",t.MO="mo",t.MN="mn",t.MS="ms",t.MTEXT="mtext",t.NAV="nav",t.NOBR="nobr",t.NOFRAMES="noframes",t.NOEMBED="noembed",t.NOSCRIPT="noscript",t.OBJECT="object",t.OL="ol",t.OPTGROUP="optgroup",t.OPTION="option",t.P="p",t.PARAM="param",t.PLAINTEXT="plaintext",t.PRE="pre",t.RB="rb",t.RP="rp",t.RT="rt",t.RTC="rtc",t.RUBY="ruby",t.S="s",t.SCRIPT="script",t.SEARCH="search",t.SECTION="section",t.SELECT="select",t.SOURCE="source",t.SMALL="small",t.SPAN="span",t.STRIKE="strike",t.STRONG="strong",t.STYLE="style",t.SUB="sub",t.SUMMARY="summary",t.SUP="sup",t.TABLE="table",t.TBODY="tbody",t.TEMPLATE="template",t.TEXTAREA="textarea",t.TFOOT="tfoot",t.TD="td",t.TH="th",t.THEAD="thead",t.TITLE="title",t.TR="tr",t.TRACK="track",t.TT="tt",t.U="u",t.UL="ul",t.SVG="svg",t.VAR="var",t.WBR="wbr",t.XMP="xmp"})(_e||(_e={}));var k;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.A=1]="A",t[t.ADDRESS=2]="ADDRESS",t[t.ANNOTATION_XML=3]="ANNOTATION_XML",t[t.APPLET=4]="APPLET",t[t.AREA=5]="AREA",t[t.ARTICLE=6]="ARTICLE",t[t.ASIDE=7]="ASIDE",t[t.B=8]="B",t[t.BASE=9]="BASE",t[t.BASEFONT=10]="BASEFONT",t[t.BGSOUND=11]="BGSOUND",t[t.BIG=12]="BIG",t[t.BLOCKQUOTE=13]="BLOCKQUOTE",t[t.BODY=14]="BODY",t[t.BR=15]="BR",t[t.BUTTON=16]="BUTTON",t[t.CAPTION=17]="CAPTION",t[t.CENTER=18]="CENTER",t[t.CODE=19]="CODE",t[t.COL=20]="COL",t[t.COLGROUP=21]="COLGROUP",t[t.DD=22]="DD",t[t.DESC=23]="DESC",t[t.DETAILS=24]="DETAILS",t[t.DIALOG=25]="DIALOG",t[t.DIR=26]="DIR",t[t.DIV=27]="DIV",t[t.DL=28]="DL",t[t.DT=29]="DT",t[t.EM=30]="EM",t[t.EMBED=31]="EMBED",t[t.FIELDSET=32]="FIELDSET",t[t.FIGCAPTION=33]="FIGCAPTION",t[t.FIGURE=34]="FIGURE",t[t.FONT=35]="FONT",t[t.FOOTER=36]="FOOTER",t[t.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",t[t.FORM=38]="FORM",t[t.FRAME=39]="FRAME",t[t.FRAMESET=40]="FRAMESET",t[t.H1=41]="H1",t[t.H2=42]="H2",t[t.H3=43]="H3",t[t.H4=44]="H4",t[t.H5=45]="H5",t[t.H6=46]="H6",t[t.HEAD=47]="HEAD",t[t.HEADER=48]="HEADER",t[t.HGROUP=49]="HGROUP",t[t.HR=50]="HR",t[t.HTML=51]="HTML",t[t.I=52]="I",t[t.IMG=53]="IMG",t[t.IMAGE=54]="IMAGE",t[t.INPUT=55]="INPUT",t[t.IFRAME=56]="IFRAME",t[t.KEYGEN=57]="KEYGEN",t[t.LABEL=58]="LABEL",t[t.LI=59]="LI",t[t.LINK=60]="LINK",t[t.LISTING=61]="LISTING",t[t.MAIN=62]="MAIN",t[t.MALIGNMARK=63]="MALIGNMARK",t[t.MARQUEE=64]="MARQUEE",t[t.MATH=65]="MATH",t[t.MENU=66]="MENU",t[t.META=67]="META",t[t.MGLYPH=68]="MGLYPH",t[t.MI=69]="MI",t[t.MO=70]="MO",t[t.MN=71]="MN",t[t.MS=72]="MS",t[t.MTEXT=73]="MTEXT",t[t.NAV=74]="NAV",t[t.NOBR=75]="NOBR",t[t.NOFRAMES=76]="NOFRAMES",t[t.NOEMBED=77]="NOEMBED",t[t.NOSCRIPT=78]="NOSCRIPT",t[t.OBJECT=79]="OBJECT",t[t.OL=80]="OL",t[t.OPTGROUP=81]="OPTGROUP",t[t.OPTION=82]="OPTION",t[t.P=83]="P",t[t.PARAM=84]="PARAM",t[t.PLAINTEXT=85]="PLAINTEXT",t[t.PRE=86]="PRE",t[t.RB=87]="RB",t[t.RP=88]="RP",t[t.RT=89]="RT",t[t.RTC=90]="RTC",t[t.RUBY=91]="RUBY",t[t.S=92]="S",t[t.SCRIPT=93]="SCRIPT",t[t.SEARCH=94]="SEARCH",t[t.SECTION=95]="SECTION",t[t.SELECT=96]="SELECT",t[t.SOURCE=97]="SOURCE",t[t.SMALL=98]="SMALL",t[t.SPAN=99]="SPAN",t[t.STRIKE=100]="STRIKE",t[t.STRONG=101]="STRONG",t[t.STYLE=102]="STYLE",t[t.SUB=103]="SUB",t[t.SUMMARY=104]="SUMMARY",t[t.SUP=105]="SUP",t[t.TABLE=106]="TABLE",t[t.TBODY=107]="TBODY",t[t.TEMPLATE=108]="TEMPLATE",t[t.TEXTAREA=109]="TEXTAREA",t[t.TFOOT=110]="TFOOT",t[t.TD=111]="TD",t[t.TH=112]="TH",t[t.THEAD=113]="THEAD",t[t.TITLE=114]="TITLE",t[t.TR=115]="TR",t[t.TRACK=116]="TRACK",t[t.TT=117]="TT",t[t.U=118]="U",t[t.UL=119]="UL",t[t.SVG=120]="SVG",t[t.VAR=121]="VAR",t[t.WBR=122]="WBR",t[t.XMP=123]="XMP"})(k||(k={}));const Rme=new Map([[_e.A,k.A],[_e.ADDRESS,k.ADDRESS],[_e.ANNOTATION_XML,k.ANNOTATION_XML],[_e.APPLET,k.APPLET],[_e.AREA,k.AREA],[_e.ARTICLE,k.ARTICLE],[_e.ASIDE,k.ASIDE],[_e.B,k.B],[_e.BASE,k.BASE],[_e.BASEFONT,k.BASEFONT],[_e.BGSOUND,k.BGSOUND],[_e.BIG,k.BIG],[_e.BLOCKQUOTE,k.BLOCKQUOTE],[_e.BODY,k.BODY],[_e.BR,k.BR],[_e.BUTTON,k.BUTTON],[_e.CAPTION,k.CAPTION],[_e.CENTER,k.CENTER],[_e.CODE,k.CODE],[_e.COL,k.COL],[_e.COLGROUP,k.COLGROUP],[_e.DD,k.DD],[_e.DESC,k.DESC],[_e.DETAILS,k.DETAILS],[_e.DIALOG,k.DIALOG],[_e.DIR,k.DIR],[_e.DIV,k.DIV],[_e.DL,k.DL],[_e.DT,k.DT],[_e.EM,k.EM],[_e.EMBED,k.EMBED],[_e.FIELDSET,k.FIELDSET],[_e.FIGCAPTION,k.FIGCAPTION],[_e.FIGURE,k.FIGURE],[_e.FONT,k.FONT],[_e.FOOTER,k.FOOTER],[_e.FOREIGN_OBJECT,k.FOREIGN_OBJECT],[_e.FORM,k.FORM],[_e.FRAME,k.FRAME],[_e.FRAMESET,k.FRAMESET],[_e.H1,k.H1],[_e.H2,k.H2],[_e.H3,k.H3],[_e.H4,k.H4],[_e.H5,k.H5],[_e.H6,k.H6],[_e.HEAD,k.HEAD],[_e.HEADER,k.HEADER],[_e.HGROUP,k.HGROUP],[_e.HR,k.HR],[_e.HTML,k.HTML],[_e.I,k.I],[_e.IMG,k.IMG],[_e.IMAGE,k.IMAGE],[_e.INPUT,k.INPUT],[_e.IFRAME,k.IFRAME],[_e.KEYGEN,k.KEYGEN],[_e.LABEL,k.LABEL],[_e.LI,k.LI],[_e.LINK,k.LINK],[_e.LISTING,k.LISTING],[_e.MAIN,k.MAIN],[_e.MALIGNMARK,k.MALIGNMARK],[_e.MARQUEE,k.MARQUEE],[_e.MATH,k.MATH],[_e.MENU,k.MENU],[_e.META,k.META],[_e.MGLYPH,k.MGLYPH],[_e.MI,k.MI],[_e.MO,k.MO],[_e.MN,k.MN],[_e.MS,k.MS],[_e.MTEXT,k.MTEXT],[_e.NAV,k.NAV],[_e.NOBR,k.NOBR],[_e.NOFRAMES,k.NOFRAMES],[_e.NOEMBED,k.NOEMBED],[_e.NOSCRIPT,k.NOSCRIPT],[_e.OBJECT,k.OBJECT],[_e.OL,k.OL],[_e.OPTGROUP,k.OPTGROUP],[_e.OPTION,k.OPTION],[_e.P,k.P],[_e.PARAM,k.PARAM],[_e.PLAINTEXT,k.PLAINTEXT],[_e.PRE,k.PRE],[_e.RB,k.RB],[_e.RP,k.RP],[_e.RT,k.RT],[_e.RTC,k.RTC],[_e.RUBY,k.RUBY],[_e.S,k.S],[_e.SCRIPT,k.SCRIPT],[_e.SEARCH,k.SEARCH],[_e.SECTION,k.SECTION],[_e.SELECT,k.SELECT],[_e.SOURCE,k.SOURCE],[_e.SMALL,k.SMALL],[_e.SPAN,k.SPAN],[_e.STRIKE,k.STRIKE],[_e.STRONG,k.STRONG],[_e.STYLE,k.STYLE],[_e.SUB,k.SUB],[_e.SUMMARY,k.SUMMARY],[_e.SUP,k.SUP],[_e.TABLE,k.TABLE],[_e.TBODY,k.TBODY],[_e.TEMPLATE,k.TEMPLATE],[_e.TEXTAREA,k.TEXTAREA],[_e.TFOOT,k.TFOOT],[_e.TD,k.TD],[_e.TH,k.TH],[_e.THEAD,k.THEAD],[_e.TITLE,k.TITLE],[_e.TR,k.TR],[_e.TRACK,k.TRACK],[_e.TT,k.TT],[_e.U,k.U],[_e.UL,k.UL],[_e.SVG,k.SVG],[_e.VAR,k.VAR],[_e.WBR,k.WBR],[_e.XMP,k.XMP]]);function oh(t){var e;return(e=Rme.get(t))!==null&&e!==void 0?e:k.UNKNOWN}const Le=k,Ime={[De.HTML]:new Set([Le.ADDRESS,Le.APPLET,Le.AREA,Le.ARTICLE,Le.ASIDE,Le.BASE,Le.BASEFONT,Le.BGSOUND,Le.BLOCKQUOTE,Le.BODY,Le.BR,Le.BUTTON,Le.CAPTION,Le.CENTER,Le.COL,Le.COLGROUP,Le.DD,Le.DETAILS,Le.DIR,Le.DIV,Le.DL,Le.DT,Le.EMBED,Le.FIELDSET,Le.FIGCAPTION,Le.FIGURE,Le.FOOTER,Le.FORM,Le.FRAME,Le.FRAMESET,Le.H1,Le.H2,Le.H3,Le.H4,Le.H5,Le.H6,Le.HEAD,Le.HEADER,Le.HGROUP,Le.HR,Le.HTML,Le.IFRAME,Le.IMG,Le.INPUT,Le.LI,Le.LINK,Le.LISTING,Le.MAIN,Le.MARQUEE,Le.MENU,Le.META,Le.NAV,Le.NOEMBED,Le.NOFRAMES,Le.NOSCRIPT,Le.OBJECT,Le.OL,Le.P,Le.PARAM,Le.PLAINTEXT,Le.PRE,Le.SCRIPT,Le.SECTION,Le.SELECT,Le.SOURCE,Le.STYLE,Le.SUMMARY,Le.TABLE,Le.TBODY,Le.TD,Le.TEMPLATE,Le.TEXTAREA,Le.TFOOT,Le.TH,Le.THEAD,Le.TITLE,Le.TR,Le.TRACK,Le.UL,Le.WBR,Le.XMP]),[De.MATHML]:new Set([Le.MI,Le.MO,Le.MN,Le.MS,Le.MTEXT,Le.ANNOTATION_XML]),[De.SVG]:new Set([Le.TITLE,Le.FOREIGN_OBJECT,Le.DESC]),[De.XLINK]:new Set,[De.XML]:new Set,[De.XMLNS]:new Set},Ex=new Set([Le.H1,Le.H2,Le.H3,Le.H4,Le.H5,Le.H6]);_e.STYLE,_e.SCRIPT,_e.XMP,_e.IFRAME,_e.NOEMBED,_e.NOFRAMES,_e.PLAINTEXT;var te;(function(t){t[t.DATA=0]="DATA",t[t.RCDATA=1]="RCDATA",t[t.RAWTEXT=2]="RAWTEXT",t[t.SCRIPT_DATA=3]="SCRIPT_DATA",t[t.PLAINTEXT=4]="PLAINTEXT",t[t.TAG_OPEN=5]="TAG_OPEN",t[t.END_TAG_OPEN=6]="END_TAG_OPEN",t[t.TAG_NAME=7]="TAG_NAME",t[t.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",t[t.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",t[t.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",t[t.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",t[t.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",t[t.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",t[t.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",t[t.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",t[t.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",t[t.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",t[t.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",t[t.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",t[t.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",t[t.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",t[t.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",t[t.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",t[t.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",t[t.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",t[t.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",t[t.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",t[t.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",t[t.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",t[t.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",t[t.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",t[t.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",t[t.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",t[t.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",t[t.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",t[t.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",t[t.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",t[t.BOGUS_COMMENT=40]="BOGUS_COMMENT",t[t.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",t[t.COMMENT_START=42]="COMMENT_START",t[t.COMMENT_START_DASH=43]="COMMENT_START_DASH",t[t.COMMENT=44]="COMMENT",t[t.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",t[t.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",t[t.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",t[t.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",t[t.COMMENT_END_DASH=49]="COMMENT_END_DASH",t[t.COMMENT_END=50]="COMMENT_END",t[t.COMMENT_END_BANG=51]="COMMENT_END_BANG",t[t.DOCTYPE=52]="DOCTYPE",t[t.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",t[t.DOCTYPE_NAME=54]="DOCTYPE_NAME",t[t.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",t[t.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",t[t.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",t[t.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",t[t.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",t[t.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",t[t.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",t[t.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",t[t.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",t[t.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",t[t.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",t[t.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",t[t.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",t[t.CDATA_SECTION=68]="CDATA_SECTION",t[t.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",t[t.CDATA_SECTION_END=70]="CDATA_SECTION_END",t[t.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",t[t.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(te||(te={}));const lr={DATA:te.DATA,RCDATA:te.RCDATA,RAWTEXT:te.RAWTEXT,SCRIPT_DATA:te.SCRIPT_DATA,PLAINTEXT:te.PLAINTEXT,CDATA_SECTION:te.CDATA_SECTION};function Pme(t){return t>=X.DIGIT_0&&t<=X.DIGIT_9}function nd(t){return t>=X.LATIN_CAPITAL_A&&t<=X.LATIN_CAPITAL_Z}function Ome(t){return t>=X.LATIN_SMALL_A&&t<=X.LATIN_SMALL_Z}function Wo(t){return Ome(t)||nd(t)}function VP(t){return Wo(t)||Pme(t)}function Ym(t){return t+32}function Bj(t){return t===X.SPACE||t===X.LINE_FEED||t===X.TABULATION||t===X.FORM_FEED}function GP(t){return Bj(t)||t===X.SOLIDUS||t===X.GREATER_THAN_SIGN}function Dme(t){return t===X.NULL?Ee.nullCharacterReference:t>1114111?Ee.characterReferenceOutsideUnicodeRange:Ij(t)?Ee.surrogateCharacterReference:Oj(t)?Ee.noncharacterCharacterReference:Pj(t)||t===X.CARRIAGE_RETURN?Ee.controlCharacterReference:null}class Lme{constructor(e,r){this.options=e,this.handler=r,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=te.DATA,this.returnState=te.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new bme(r),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new Nj(Lj,(n,s)=>{this.preprocessor.pos=this.entityStartPos+s-1,this._flushCodePointConsumedAsCharacterReference(n)},r.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(Ee.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:n=>{this._err(Ee.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+n)},validateNumericCharacterReference:n=>{const s=Dme(n);s&&this._err(s,1)}}:void 0)}_err(e,r=0){var n,s;(s=(n=this.handler).onParseError)===null||s===void 0||s.call(n,this.preprocessor.getError(e,r))}getCurrentLocation(e){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-e,startOffset:this.preprocessor.offset-e,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const e=this._consume();this._ensureHibernation()||this._callState(e)}this.inLoop=!1}}pause(){this.paused=!0}resume(e){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||e?.())}write(e,r,n){this.active=!0,this.preprocessor.write(e,r),this._runParsingLoop(),this.paused||n?.()}insertHtmlAtCurrentPos(e){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(e),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(e){this.consumedAfterSnapshot+=e;for(let r=0;r<e;r++)this.preprocessor.advance()}_consumeSequenceIfMatch(e,r){return this.preprocessor.startsWith(e,r)?(this._advanceBy(e.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:dt.START_TAG,tagName:"",tagID:k.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:dt.END_TAG,tagName:"",tagID:k.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(e){this.currentToken={type:dt.COMMENT,data:"",location:this.getCurrentLocation(e)}}_createDoctypeToken(e){this.currentToken={type:dt.DOCTYPE,name:e,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(e,r){this.currentCharacterToken={type:e,chars:r,location:this.currentLocation}}_createAttr(e){this.currentAttr={name:e,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var e,r;const n=this.currentToken;if(Dj(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){const s=(e=(r=n.location).attrs)!==null&&e!==void 0?e:r.attrs=Object.create(null);s[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(Ee.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(e){this._emitCurrentCharacterToken(e.location),this.currentToken=null,e.location&&(e.location.endLine=this.preprocessor.line,e.location.endCol=this.preprocessor.col+1,e.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const e=this.currentToken;this.prepareToken(e),e.tagID=oh(e.tagName),e.type===dt.START_TAG?(this.lastStartTagName=e.tagName,this.handler.onStartTag(e)):(e.attrs.length>0&&this._err(Ee.endTagWithAttributes),e.selfClosing&&this._err(Ee.endTagWithTrailingSolidus),this.handler.onEndTag(e)),this.preprocessor.dropParsedChunk()}emitCurrentComment(e){this.prepareToken(e),this.handler.onComment(e),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(e){this.prepareToken(e),this.handler.onDoctype(e),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(e){if(this.currentCharacterToken){switch(e&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=e.startLine,this.currentCharacterToken.location.endCol=e.startCol,this.currentCharacterToken.location.endOffset=e.startOffset),this.currentCharacterToken.type){case dt.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case dt.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case dt.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const e=this.getCurrentLocation(0);e&&(e.endLine=e.startLine,e.endCol=e.startCol,e.endOffset=e.startOffset),this._emitCurrentCharacterToken(e),this.handler.onEof({type:dt.EOF,location:e}),this.active=!1}_appendCharToCurrentCharacterToken(e,r){if(this.currentCharacterToken)if(this.currentCharacterToken.type===e){this.currentCharacterToken.chars+=r;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(e,r)}_emitCodePoint(e){const r=Bj(e)?dt.WHITESPACE_CHARACTER:e===X.NULL?dt.NULL_CHARACTER:dt.CHARACTER;this._appendCharToCurrentCharacterToken(r,String.fromCodePoint(e))}_emitChars(e){this._appendCharToCurrentCharacterToken(dt.CHARACTER,e)}_startCharacterReference(){this.returnState=this.state,this.state=te.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?ao.Attribute:ao.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===te.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===te.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===te.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(e){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(e):this._emitCodePoint(e)}_callState(e){switch(this.state){case te.DATA:{this._stateData(e);break}case te.RCDATA:{this._stateRcdata(e);break}case te.RAWTEXT:{this._stateRawtext(e);break}case te.SCRIPT_DATA:{this._stateScriptData(e);break}case te.PLAINTEXT:{this._statePlaintext(e);break}case te.TAG_OPEN:{this._stateTagOpen(e);break}case te.END_TAG_OPEN:{this._stateEndTagOpen(e);break}case te.TAG_NAME:{this._stateTagName(e);break}case te.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(e);break}case te.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(e);break}case te.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(e);break}case te.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(e);break}case te.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(e);break}case te.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(e);break}case te.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(e);break}case te.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(e);break}case te.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(e);break}case te.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(e);break}case te.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(e);break}case te.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(e);break}case te.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(e);break}case te.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(e);break}case te.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(e);break}case te.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(e);break}case te.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(e);break}case te.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(e);break}case te.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(e);break}case te.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(e);break}case te.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(e);break}case te.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(e);break}case te.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(e);break}case te.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(e);break}case te.ATTRIBUTE_NAME:{this._stateAttributeName(e);break}case te.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(e);break}case te.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(e);break}case te.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(e);break}case te.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(e);break}case te.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(e);break}case te.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(e);break}case te.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(e);break}case te.BOGUS_COMMENT:{this._stateBogusComment(e);break}case te.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(e);break}case te.COMMENT_START:{this._stateCommentStart(e);break}case te.COMMENT_START_DASH:{this._stateCommentStartDash(e);break}case te.COMMENT:{this._stateComment(e);break}case te.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(e);break}case te.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(e);break}case te.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(e);break}case te.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(e);break}case te.COMMENT_END_DASH:{this._stateCommentEndDash(e);break}case te.COMMENT_END:{this._stateCommentEnd(e);break}case te.COMMENT_END_BANG:{this._stateCommentEndBang(e);break}case te.DOCTYPE:{this._stateDoctype(e);break}case te.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(e);break}case te.DOCTYPE_NAME:{this._stateDoctypeName(e);break}case te.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(e);break}case te.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(e);break}case te.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(e);break}case te.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(e);break}case te.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(e);break}case te.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(e);break}case te.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(e);break}case te.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(e);break}case te.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(e);break}case te.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(e);break}case te.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(e);break}case te.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(e);break}case te.BOGUS_DOCTYPE:{this._stateBogusDoctype(e);break}case te.CDATA_SECTION:{this._stateCdataSection(e);break}case te.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(e);break}case te.CDATA_SECTION_END:{this._stateCdataSectionEnd(e);break}case te.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case te.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(e);break}default:throw new Error("Unknown state")}}_stateData(e){switch(e){case X.LESS_THAN_SIGN:{this.state=te.TAG_OPEN;break}case X.AMPERSAND:{this._startCharacterReference();break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this._emitCodePoint(e);break}case X.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRcdata(e){switch(e){case X.AMPERSAND:{this._startCharacterReference();break}case X.LESS_THAN_SIGN:{this.state=te.RCDATA_LESS_THAN_SIGN;break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this._emitChars(Kt);break}case X.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateRawtext(e){switch(e){case X.LESS_THAN_SIGN:{this.state=te.RAWTEXT_LESS_THAN_SIGN;break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this._emitChars(Kt);break}case X.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptData(e){switch(e){case X.LESS_THAN_SIGN:{this.state=te.SCRIPT_DATA_LESS_THAN_SIGN;break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this._emitChars(Kt);break}case X.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_statePlaintext(e){switch(e){case X.NULL:{this._err(Ee.unexpectedNullCharacter),this._emitChars(Kt);break}case X.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateTagOpen(e){if(Wo(e))this._createStartTagToken(),this.state=te.TAG_NAME,this._stateTagName(e);else switch(e){case X.EXCLAMATION_MARK:{this.state=te.MARKUP_DECLARATION_OPEN;break}case X.SOLIDUS:{this.state=te.END_TAG_OPEN;break}case X.QUESTION_MARK:{this._err(Ee.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=te.BOGUS_COMMENT,this._stateBogusComment(e);break}case X.EOF:{this._err(Ee.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(Ee.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=te.DATA,this._stateData(e)}}_stateEndTagOpen(e){if(Wo(e))this._createEndTagToken(),this.state=te.TAG_NAME,this._stateTagName(e);else switch(e){case X.GREATER_THAN_SIGN:{this._err(Ee.missingEndTagName),this.state=te.DATA;break}case X.EOF:{this._err(Ee.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(Ee.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=te.BOGUS_COMMENT,this._stateBogusComment(e)}}_stateTagName(e){const r=this.currentToken;switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:{this.state=te.BEFORE_ATTRIBUTE_NAME;break}case X.SOLIDUS:{this.state=te.SELF_CLOSING_START_TAG;break}case X.GREATER_THAN_SIGN:{this.state=te.DATA,this.emitCurrentTagToken();break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),r.tagName+=Kt;break}case X.EOF:{this._err(Ee.eofInTag),this._emitEOFToken();break}default:r.tagName+=String.fromCodePoint(nd(e)?Ym(e):e)}}_stateRcdataLessThanSign(e){e===X.SOLIDUS?this.state=te.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=te.RCDATA,this._stateRcdata(e))}_stateRcdataEndTagOpen(e){Wo(e)?(this.state=te.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(e)):(this._emitChars("</"),this.state=te.RCDATA,this._stateRcdata(e))}handleSpecialEndTag(e){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const r=this.currentToken;switch(r.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=te.BEFORE_ATTRIBUTE_NAME,!1;case X.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=te.SELF_CLOSING_START_TAG,!1;case X.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=te.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=te.RCDATA,this._stateRcdata(e))}_stateRawtextLessThanSign(e){e===X.SOLIDUS?this.state=te.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=te.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagOpen(e){Wo(e)?(this.state=te.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(e)):(this._emitChars("</"),this.state=te.RAWTEXT,this._stateRawtext(e))}_stateRawtextEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=te.RAWTEXT,this._stateRawtext(e))}_stateScriptDataLessThanSign(e){switch(e){case X.SOLIDUS:{this.state=te.SCRIPT_DATA_END_TAG_OPEN;break}case X.EXCLAMATION_MARK:{this.state=te.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=te.SCRIPT_DATA,this._stateScriptData(e)}}_stateScriptDataEndTagOpen(e){Wo(e)?(this.state=te.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(e)):(this._emitChars("</"),this.state=te.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=te.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStart(e){e===X.HYPHEN_MINUS?(this.state=te.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=te.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscapeStartDash(e){e===X.HYPHEN_MINUS?(this.state=te.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=te.SCRIPT_DATA,this._stateScriptData(e))}_stateScriptDataEscaped(e){switch(e){case X.HYPHEN_MINUS:{this.state=te.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case X.LESS_THAN_SIGN:{this.state=te.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this._emitChars(Kt);break}case X.EOF:{this._err(Ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataEscapedDash(e){switch(e){case X.HYPHEN_MINUS:{this.state=te.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case X.LESS_THAN_SIGN:{this.state=te.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this.state=te.SCRIPT_DATA_ESCAPED,this._emitChars(Kt);break}case X.EOF:{this._err(Ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=te.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedDashDash(e){switch(e){case X.HYPHEN_MINUS:{this._emitChars("-");break}case X.LESS_THAN_SIGN:{this.state=te.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case X.GREATER_THAN_SIGN:{this.state=te.SCRIPT_DATA,this._emitChars(">");break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this.state=te.SCRIPT_DATA_ESCAPED,this._emitChars(Kt);break}case X.EOF:{this._err(Ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=te.SCRIPT_DATA_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataEscapedLessThanSign(e){e===X.SOLIDUS?this.state=te.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:Wo(e)?(this._emitChars("<"),this.state=te.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(e)):(this._emitChars("<"),this.state=te.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagOpen(e){Wo(e)?(this.state=te.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(e)):(this._emitChars("</"),this.state=te.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataEscapedEndTagName(e){this.handleSpecialEndTag(e)&&(this._emitChars("</"),this.state=te.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscapeStart(e){if(this.preprocessor.startsWith(Sn.SCRIPT,!1)&&GP(this.preprocessor.peek(Sn.SCRIPT.length))){this._emitCodePoint(e);for(let r=0;r<Sn.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=te.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=te.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(e))}_stateScriptDataDoubleEscaped(e){switch(e){case X.HYPHEN_MINUS:{this.state=te.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case X.LESS_THAN_SIGN:{this.state=te.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this._emitChars(Kt);break}case X.EOF:{this._err(Ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDash(e){switch(e){case X.HYPHEN_MINUS:{this.state=te.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case X.LESS_THAN_SIGN:{this.state=te.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this.state=te.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(Kt);break}case X.EOF:{this._err(Ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=te.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedDashDash(e){switch(e){case X.HYPHEN_MINUS:{this._emitChars("-");break}case X.LESS_THAN_SIGN:{this.state=te.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case X.GREATER_THAN_SIGN:{this.state=te.SCRIPT_DATA,this._emitChars(">");break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this.state=te.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(Kt);break}case X.EOF:{this._err(Ee.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=te.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(e)}}_stateScriptDataDoubleEscapedLessThanSign(e){e===X.SOLIDUS?(this.state=te.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=te.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateScriptDataDoubleEscapeEnd(e){if(this.preprocessor.startsWith(Sn.SCRIPT,!1)&&GP(this.preprocessor.peek(Sn.SCRIPT.length))){this._emitCodePoint(e);for(let r=0;r<Sn.SCRIPT.length;r++)this._emitCodePoint(this._consume());this.state=te.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=te.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(e))}_stateBeforeAttributeName(e){switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:break;case X.SOLIDUS:case X.GREATER_THAN_SIGN:case X.EOF:{this.state=te.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case X.EQUALS_SIGN:{this._err(Ee.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=te.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=te.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateAttributeName(e){switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:case X.SOLIDUS:case X.GREATER_THAN_SIGN:case X.EOF:{this._leaveAttrName(),this.state=te.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(e);break}case X.EQUALS_SIGN:{this._leaveAttrName(),this.state=te.BEFORE_ATTRIBUTE_VALUE;break}case X.QUOTATION_MARK:case X.APOSTROPHE:case X.LESS_THAN_SIGN:{this._err(Ee.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(e);break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this.currentAttr.name+=Kt;break}default:this.currentAttr.name+=String.fromCodePoint(nd(e)?Ym(e):e)}}_stateAfterAttributeName(e){switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:break;case X.SOLIDUS:{this.state=te.SELF_CLOSING_START_TAG;break}case X.EQUALS_SIGN:{this.state=te.BEFORE_ATTRIBUTE_VALUE;break}case X.GREATER_THAN_SIGN:{this.state=te.DATA,this.emitCurrentTagToken();break}case X.EOF:{this._err(Ee.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=te.ATTRIBUTE_NAME,this._stateAttributeName(e)}}_stateBeforeAttributeValue(e){switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:break;case X.QUOTATION_MARK:{this.state=te.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case X.APOSTROPHE:{this.state=te.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case X.GREATER_THAN_SIGN:{this._err(Ee.missingAttributeValue),this.state=te.DATA,this.emitCurrentTagToken();break}default:this.state=te.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(e)}}_stateAttributeValueDoubleQuoted(e){switch(e){case X.QUOTATION_MARK:{this.state=te.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case X.AMPERSAND:{this._startCharacterReference();break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this.currentAttr.value+=Kt;break}case X.EOF:{this._err(Ee.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueSingleQuoted(e){switch(e){case X.APOSTROPHE:{this.state=te.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case X.AMPERSAND:{this._startCharacterReference();break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this.currentAttr.value+=Kt;break}case X.EOF:{this._err(Ee.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAttributeValueUnquoted(e){switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:{this._leaveAttrValue(),this.state=te.BEFORE_ATTRIBUTE_NAME;break}case X.AMPERSAND:{this._startCharacterReference();break}case X.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=te.DATA,this.emitCurrentTagToken();break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),this.currentAttr.value+=Kt;break}case X.QUOTATION_MARK:case X.APOSTROPHE:case X.LESS_THAN_SIGN:case X.EQUALS_SIGN:case X.GRAVE_ACCENT:{this._err(Ee.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(e);break}case X.EOF:{this._err(Ee.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(e)}}_stateAfterAttributeValueQuoted(e){switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:{this._leaveAttrValue(),this.state=te.BEFORE_ATTRIBUTE_NAME;break}case X.SOLIDUS:{this._leaveAttrValue(),this.state=te.SELF_CLOSING_START_TAG;break}case X.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=te.DATA,this.emitCurrentTagToken();break}case X.EOF:{this._err(Ee.eofInTag),this._emitEOFToken();break}default:this._err(Ee.missingWhitespaceBetweenAttributes),this.state=te.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateSelfClosingStartTag(e){switch(e){case X.GREATER_THAN_SIGN:{const r=this.currentToken;r.selfClosing=!0,this.state=te.DATA,this.emitCurrentTagToken();break}case X.EOF:{this._err(Ee.eofInTag),this._emitEOFToken();break}default:this._err(Ee.unexpectedSolidusInTag),this.state=te.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(e)}}_stateBogusComment(e){const r=this.currentToken;switch(e){case X.GREATER_THAN_SIGN:{this.state=te.DATA,this.emitCurrentComment(r);break}case X.EOF:{this.emitCurrentComment(r),this._emitEOFToken();break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),r.data+=Kt;break}default:r.data+=String.fromCodePoint(e)}}_stateMarkupDeclarationOpen(e){this._consumeSequenceIfMatch(Sn.DASH_DASH,!0)?(this._createCommentToken(Sn.DASH_DASH.length+1),this.state=te.COMMENT_START):this._consumeSequenceIfMatch(Sn.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(Sn.DOCTYPE.length+1),this.state=te.DOCTYPE):this._consumeSequenceIfMatch(Sn.CDATA_START,!0)?this.inForeignNode?this.state=te.CDATA_SECTION:(this._err(Ee.cdataInHtmlContent),this._createCommentToken(Sn.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=te.BOGUS_COMMENT):this._ensureHibernation()||(this._err(Ee.incorrectlyOpenedComment),this._createCommentToken(2),this.state=te.BOGUS_COMMENT,this._stateBogusComment(e))}_stateCommentStart(e){switch(e){case X.HYPHEN_MINUS:{this.state=te.COMMENT_START_DASH;break}case X.GREATER_THAN_SIGN:{this._err(Ee.abruptClosingOfEmptyComment),this.state=te.DATA;const r=this.currentToken;this.emitCurrentComment(r);break}default:this.state=te.COMMENT,this._stateComment(e)}}_stateCommentStartDash(e){const r=this.currentToken;switch(e){case X.HYPHEN_MINUS:{this.state=te.COMMENT_END;break}case X.GREATER_THAN_SIGN:{this._err(Ee.abruptClosingOfEmptyComment),this.state=te.DATA,this.emitCurrentComment(r);break}case X.EOF:{this._err(Ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=te.COMMENT,this._stateComment(e)}}_stateComment(e){const r=this.currentToken;switch(e){case X.HYPHEN_MINUS:{this.state=te.COMMENT_END_DASH;break}case X.LESS_THAN_SIGN:{r.data+="<",this.state=te.COMMENT_LESS_THAN_SIGN;break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),r.data+=Kt;break}case X.EOF:{this._err(Ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+=String.fromCodePoint(e)}}_stateCommentLessThanSign(e){const r=this.currentToken;switch(e){case X.EXCLAMATION_MARK:{r.data+="!",this.state=te.COMMENT_LESS_THAN_SIGN_BANG;break}case X.LESS_THAN_SIGN:{r.data+="<";break}default:this.state=te.COMMENT,this._stateComment(e)}}_stateCommentLessThanSignBang(e){e===X.HYPHEN_MINUS?this.state=te.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=te.COMMENT,this._stateComment(e))}_stateCommentLessThanSignBangDash(e){e===X.HYPHEN_MINUS?this.state=te.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=te.COMMENT_END_DASH,this._stateCommentEndDash(e))}_stateCommentLessThanSignBangDashDash(e){e!==X.GREATER_THAN_SIGN&&e!==X.EOF&&this._err(Ee.nestedComment),this.state=te.COMMENT_END,this._stateCommentEnd(e)}_stateCommentEndDash(e){const r=this.currentToken;switch(e){case X.HYPHEN_MINUS:{this.state=te.COMMENT_END;break}case X.EOF:{this._err(Ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="-",this.state=te.COMMENT,this._stateComment(e)}}_stateCommentEnd(e){const r=this.currentToken;switch(e){case X.GREATER_THAN_SIGN:{this.state=te.DATA,this.emitCurrentComment(r);break}case X.EXCLAMATION_MARK:{this.state=te.COMMENT_END_BANG;break}case X.HYPHEN_MINUS:{r.data+="-";break}case X.EOF:{this._err(Ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--",this.state=te.COMMENT,this._stateComment(e)}}_stateCommentEndBang(e){const r=this.currentToken;switch(e){case X.HYPHEN_MINUS:{r.data+="--!",this.state=te.COMMENT_END_DASH;break}case X.GREATER_THAN_SIGN:{this._err(Ee.incorrectlyClosedComment),this.state=te.DATA,this.emitCurrentComment(r);break}case X.EOF:{this._err(Ee.eofInComment),this.emitCurrentComment(r),this._emitEOFToken();break}default:r.data+="--!",this.state=te.COMMENT,this._stateComment(e)}}_stateDoctype(e){switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:{this.state=te.BEFORE_DOCTYPE_NAME;break}case X.GREATER_THAN_SIGN:{this.state=te.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e);break}case X.EOF:{this._err(Ee.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(Ee.missingWhitespaceBeforeDoctypeName),this.state=te.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(e)}}_stateBeforeDoctypeName(e){if(nd(e))this._createDoctypeToken(String.fromCharCode(Ym(e))),this.state=te.DOCTYPE_NAME;else switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:break;case X.NULL:{this._err(Ee.unexpectedNullCharacter),this._createDoctypeToken(Kt),this.state=te.DOCTYPE_NAME;break}case X.GREATER_THAN_SIGN:{this._err(Ee.missingDoctypeName),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=te.DATA;break}case X.EOF:{this._err(Ee.eofInDoctype),this._createDoctypeToken(null);const r=this.currentToken;r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(e)),this.state=te.DOCTYPE_NAME}}_stateDoctypeName(e){const r=this.currentToken;switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:{this.state=te.AFTER_DOCTYPE_NAME;break}case X.GREATER_THAN_SIGN:{this.state=te.DATA,this.emitCurrentDoctype(r);break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),r.name+=Kt;break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.name+=String.fromCodePoint(nd(e)?Ym(e):e)}}_stateAfterDoctypeName(e){const r=this.currentToken;switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:break;case X.GREATER_THAN_SIGN:{this.state=te.DATA,this.emitCurrentDoctype(r);break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(Sn.PUBLIC,!1)?this.state=te.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(Sn.SYSTEM,!1)?this.state=te.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(Ee.invalidCharacterSequenceAfterDoctypeName),r.forceQuirks=!0,this.state=te.BOGUS_DOCTYPE,this._stateBogusDoctype(e))}}_stateAfterDoctypePublicKeyword(e){const r=this.currentToken;switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:{this.state=te.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case X.QUOTATION_MARK:{this._err(Ee.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=te.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case X.APOSTROPHE:{this._err(Ee.missingWhitespaceAfterDoctypePublicKeyword),r.publicId="",this.state=te.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case X.GREATER_THAN_SIGN:{this._err(Ee.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=te.DATA,this.emitCurrentDoctype(r);break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(Ee.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=te.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypePublicIdentifier(e){const r=this.currentToken;switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:break;case X.QUOTATION_MARK:{r.publicId="",this.state=te.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case X.APOSTROPHE:{r.publicId="",this.state=te.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case X.GREATER_THAN_SIGN:{this._err(Ee.missingDoctypePublicIdentifier),r.forceQuirks=!0,this.state=te.DATA,this.emitCurrentDoctype(r);break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(Ee.missingQuoteBeforeDoctypePublicIdentifier),r.forceQuirks=!0,this.state=te.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypePublicIdentifierDoubleQuoted(e){const r=this.currentToken;switch(e){case X.QUOTATION_MARK:{this.state=te.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),r.publicId+=Kt;break}case X.GREATER_THAN_SIGN:{this._err(Ee.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=te.DATA;break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(e)}}_stateDoctypePublicIdentifierSingleQuoted(e){const r=this.currentToken;switch(e){case X.APOSTROPHE:{this.state=te.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),r.publicId+=Kt;break}case X.GREATER_THAN_SIGN:{this._err(Ee.abruptDoctypePublicIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=te.DATA;break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.publicId+=String.fromCodePoint(e)}}_stateAfterDoctypePublicIdentifier(e){const r=this.currentToken;switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:{this.state=te.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case X.GREATER_THAN_SIGN:{this.state=te.DATA,this.emitCurrentDoctype(r);break}case X.QUOTATION_MARK:{this._err(Ee.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=te.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case X.APOSTROPHE:{this._err(Ee.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),r.systemId="",this.state=te.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(Ee.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=te.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBetweenDoctypePublicAndSystemIdentifiers(e){const r=this.currentToken;switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:break;case X.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=te.DATA;break}case X.QUOTATION_MARK:{r.systemId="",this.state=te.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case X.APOSTROPHE:{r.systemId="",this.state=te.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(Ee.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=te.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateAfterDoctypeSystemKeyword(e){const r=this.currentToken;switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:{this.state=te.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case X.QUOTATION_MARK:{this._err(Ee.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=te.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case X.APOSTROPHE:{this._err(Ee.missingWhitespaceAfterDoctypeSystemKeyword),r.systemId="",this.state=te.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case X.GREATER_THAN_SIGN:{this._err(Ee.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=te.DATA,this.emitCurrentDoctype(r);break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(Ee.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=te.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBeforeDoctypeSystemIdentifier(e){const r=this.currentToken;switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:break;case X.QUOTATION_MARK:{r.systemId="",this.state=te.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case X.APOSTROPHE:{r.systemId="",this.state=te.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case X.GREATER_THAN_SIGN:{this._err(Ee.missingDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=te.DATA,this.emitCurrentDoctype(r);break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(Ee.missingQuoteBeforeDoctypeSystemIdentifier),r.forceQuirks=!0,this.state=te.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateDoctypeSystemIdentifierDoubleQuoted(e){const r=this.currentToken;switch(e){case X.QUOTATION_MARK:{this.state=te.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),r.systemId+=Kt;break}case X.GREATER_THAN_SIGN:{this._err(Ee.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=te.DATA;break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(e)}}_stateDoctypeSystemIdentifierSingleQuoted(e){const r=this.currentToken;switch(e){case X.APOSTROPHE:{this.state=te.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case X.NULL:{this._err(Ee.unexpectedNullCharacter),r.systemId+=Kt;break}case X.GREATER_THAN_SIGN:{this._err(Ee.abruptDoctypeSystemIdentifier),r.forceQuirks=!0,this.emitCurrentDoctype(r),this.state=te.DATA;break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:r.systemId+=String.fromCodePoint(e)}}_stateAfterDoctypeSystemIdentifier(e){const r=this.currentToken;switch(e){case X.SPACE:case X.LINE_FEED:case X.TABULATION:case X.FORM_FEED:break;case X.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=te.DATA;break}case X.EOF:{this._err(Ee.eofInDoctype),r.forceQuirks=!0,this.emitCurrentDoctype(r),this._emitEOFToken();break}default:this._err(Ee.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=te.BOGUS_DOCTYPE,this._stateBogusDoctype(e)}}_stateBogusDoctype(e){const r=this.currentToken;switch(e){case X.GREATER_THAN_SIGN:{this.emitCurrentDoctype(r),this.state=te.DATA;break}case X.NULL:{this._err(Ee.unexpectedNullCharacter);break}case X.EOF:{this.emitCurrentDoctype(r),this._emitEOFToken();break}}}_stateCdataSection(e){switch(e){case X.RIGHT_SQUARE_BRACKET:{this.state=te.CDATA_SECTION_BRACKET;break}case X.EOF:{this._err(Ee.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(e)}}_stateCdataSectionBracket(e){e===X.RIGHT_SQUARE_BRACKET?this.state=te.CDATA_SECTION_END:(this._emitChars("]"),this.state=te.CDATA_SECTION,this._stateCdataSection(e))}_stateCdataSectionEnd(e){switch(e){case X.GREATER_THAN_SIGN:{this.state=te.DATA;break}case X.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=te.CDATA_SECTION,this._stateCdataSection(e)}}_stateCharacterReference(){let e=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(e<0)if(this.preprocessor.lastChunkWritten)e=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}e===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(X.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&VP(this.preprocessor.peek(1))?te.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(e){VP(e)?this._flushCodePointConsumedAsCharacterReference(e):(e===X.SEMICOLON&&this._err(Ee.unknownNamedCharacterReference),this.state=this.returnState,this._callState(e))}}const Fj=new Set([k.DD,k.DT,k.LI,k.OPTGROUP,k.OPTION,k.P,k.RB,k.RP,k.RT,k.RTC]),WP=new Set([...Fj,k.CAPTION,k.COLGROUP,k.TBODY,k.TD,k.TFOOT,k.TH,k.THEAD,k.TR]),h_=new Set([k.APPLET,k.CAPTION,k.HTML,k.MARQUEE,k.OBJECT,k.TABLE,k.TD,k.TEMPLATE,k.TH]),Nme=new Set([...h_,k.OL,k.UL]),Mme=new Set([...h_,k.BUTTON]),qP=new Set([k.ANNOTATION_XML,k.MI,k.MN,k.MO,k.MS,k.MTEXT]),KP=new Set([k.DESC,k.FOREIGN_OBJECT,k.TITLE]),Bme=new Set([k.TR,k.TEMPLATE,k.HTML]),Fme=new Set([k.TBODY,k.TFOOT,k.THEAD,k.TEMPLATE,k.HTML]),jme=new Set([k.TABLE,k.TEMPLATE,k.HTML]),Ume=new Set([k.TD,k.TH]);class $me{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(e,r,n){this.treeAdapter=r,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=k.UNKNOWN,this.current=e}_indexOf(e){return this.items.lastIndexOf(e,this.stackTop)}_isInTemplate(){return this.currentTagId===k.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===De.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(e,r){this.stackTop++,this.items[this.stackTop]=e,this.current=e,this.tagIDs[this.stackTop]=r,this.currentTagId=r,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(e,r,!0)}pop(){const e=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!0)}replace(e,r){const n=this._indexOf(e);this.items[n]=r,n===this.stackTop&&(this.current=r)}insertAfter(e,r,n){const s=this._indexOf(e)+1;this.items.splice(s,0,r),this.tagIDs.splice(s,0,n),this.stackTop++,s===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,s===this.stackTop)}popUntilTagNamePopped(e){let r=this.stackTop+1;do r=this.tagIDs.lastIndexOf(e,r-1);while(r>0&&this.treeAdapter.getNamespaceURI(this.items[r])!==De.HTML);this.shortenToLength(r<0?0:r)}shortenToLength(e){for(;this.stackTop>=e;){const r=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(r,this.stackTop<e)}}popUntilElementPopped(e){const r=this._indexOf(e);this.shortenToLength(r<0?0:r)}popUntilPopped(e,r){const n=this._indexOfTagNames(e,r);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(Ex,De.HTML)}popUntilTableCellPopped(){this.popUntilPopped(Ume,De.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(e,r){for(let n=this.stackTop;n>=0;n--)if(e.has(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===r)return n;return-1}clearBackTo(e,r){const n=this._indexOfTagNames(e,r);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(jme,De.HTML)}clearBackToTableBodyContext(){this.clearBackTo(Fme,De.HTML)}clearBackToTableRowContext(){this.clearBackTo(Bme,De.HTML)}remove(e){const r=this._indexOf(e);r>=0&&(r===this.stackTop?this.pop():(this.items.splice(r,1),this.tagIDs.splice(r,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(e,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===k.BODY?this.items[1]:null}contains(e){return this._indexOf(e)>-1}getCommonAncestor(e){const r=this._indexOf(e)-1;return r>=0?this.items[r]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===k.HTML}hasInDynamicScope(e,r){for(let n=this.stackTop;n>=0;n--){const s=this.tagIDs[n];switch(this.treeAdapter.getNamespaceURI(this.items[n])){case De.HTML:{if(s===e)return!0;if(r.has(s))return!1;break}case De.SVG:{if(KP.has(s))return!1;break}case De.MATHML:{if(qP.has(s))return!1;break}}}return!0}hasInScope(e){return this.hasInDynamicScope(e,h_)}hasInListItemScope(e){return this.hasInDynamicScope(e,Nme)}hasInButtonScope(e){return this.hasInDynamicScope(e,Mme)}hasNumberedHeaderInScope(){for(let e=this.stackTop;e>=0;e--){const r=this.tagIDs[e];switch(this.treeAdapter.getNamespaceURI(this.items[e])){case De.HTML:{if(Ex.has(r))return!0;if(h_.has(r))return!1;break}case De.SVG:{if(KP.has(r))return!1;break}case De.MATHML:{if(qP.has(r))return!1;break}}}return!0}hasInTableScope(e){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===De.HTML)switch(this.tagIDs[r]){case e:return!0;case k.TABLE:case k.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let e=this.stackTop;e>=0;e--)if(this.treeAdapter.getNamespaceURI(this.items[e])===De.HTML)switch(this.tagIDs[e]){case k.TBODY:case k.THEAD:case k.TFOOT:return!0;case k.TABLE:case k.HTML:return!1}return!0}hasInSelectScope(e){for(let r=this.stackTop;r>=0;r--)if(this.treeAdapter.getNamespaceURI(this.items[r])===De.HTML)switch(this.tagIDs[r]){case e:return!0;case k.OPTION:case k.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;Fj.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;WP.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(e){for(;this.currentTagId!==e&&WP.has(this.currentTagId);)this.pop()}}const fw=3;var gi;(function(t){t[t.Marker=0]="Marker",t[t.Element=1]="Element"})(gi||(gi={}));const YP={type:gi.Marker};class Hme{constructor(e){this.treeAdapter=e,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(e,r){const n=[],s=r.length,i=this.treeAdapter.getTagName(e),o=this.treeAdapter.getNamespaceURI(e);for(let a=0;a<this.entries.length;a++){const l=this.entries[a];if(l.type===gi.Marker)break;const{element:c}=l;if(this.treeAdapter.getTagName(c)===i&&this.treeAdapter.getNamespaceURI(c)===o){const u=this.treeAdapter.getAttrList(c);u.length===s&&n.push({idx:a,attrs:u})}}return n}_ensureNoahArkCondition(e){if(this.entries.length<fw)return;const r=this.treeAdapter.getAttrList(e),n=this._getNoahArkConditionCandidates(e,r);if(n.length<fw)return;const s=new Map(r.map(o=>[o.name,o.value]));let i=0;for(let o=0;o<n.length;o++){const a=n[o];a.attrs.every(l=>s.get(l.name)===l.value)&&(i+=1,i>=fw&&this.entries.splice(a.idx,1))}}insertMarker(){this.entries.unshift(YP)}pushElement(e,r){this._ensureNoahArkCondition(e),this.entries.unshift({type:gi.Element,element:e,token:r})}insertElementAfterBookmark(e,r){const n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:gi.Element,element:e,token:r})}removeEntry(e){const r=this.entries.indexOf(e);r>=0&&this.entries.splice(r,1)}clearToLastMarker(){const e=this.entries.indexOf(YP);e>=0?this.entries.splice(0,e+1):this.entries.length=0}getElementEntryInScopeWithTagName(e){const r=this.entries.find(n=>n.type===gi.Marker||this.treeAdapter.getTagName(n.element)===e);return r&&r.type===gi.Element?r:null}getElementEntry(e){return this.entries.find(r=>r.type===gi.Element&&r.element===e)}}const qo={createDocument(){return{nodeName:"#document",mode:ds.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(t,e,r){return{nodeName:t,tagName:t,attrs:r,namespaceURI:e,childNodes:[],parentNode:null}},createCommentNode(t){return{nodeName:"#comment",data:t,parentNode:null}},createTextNode(t){return{nodeName:"#text",value:t,parentNode:null}},appendChild(t,e){t.childNodes.push(e),e.parentNode=t},insertBefore(t,e,r){const n=t.childNodes.indexOf(r);t.childNodes.splice(n,0,e),e.parentNode=t},setTemplateContent(t,e){t.content=e},getTemplateContent(t){return t.content},setDocumentType(t,e,r,n){const s=t.childNodes.find(i=>i.nodeName==="#documentType");if(s)s.name=e,s.publicId=r,s.systemId=n;else{const i={nodeName:"#documentType",name:e,publicId:r,systemId:n,parentNode:null};qo.appendChild(t,i)}},setDocumentMode(t,e){t.mode=e},getDocumentMode(t){return t.mode},detachNode(t){if(t.parentNode){const e=t.parentNode.childNodes.indexOf(t);t.parentNode.childNodes.splice(e,1),t.parentNode=null}},insertText(t,e){if(t.childNodes.length>0){const r=t.childNodes[t.childNodes.length-1];if(qo.isTextNode(r)){r.value+=e;return}}qo.appendChild(t,qo.createTextNode(e))},insertTextBefore(t,e,r){const n=t.childNodes[t.childNodes.indexOf(r)-1];n&&qo.isTextNode(n)?n.value+=e:qo.insertBefore(t,qo.createTextNode(e),r)},adoptAttributes(t,e){const r=new Set(t.attrs.map(n=>n.name));for(let n=0;n<e.length;n++)r.has(e[n].name)||t.attrs.push(e[n])},getFirstChild(t){return t.childNodes[0]},getChildNodes(t){return t.childNodes},getParentNode(t){return t.parentNode},getAttrList(t){return t.attrs},getTagName(t){return t.tagName},getNamespaceURI(t){return t.namespaceURI},getTextNodeContent(t){return t.value},getCommentNodeContent(t){return t.data},getDocumentTypeNodeName(t){return t.name},getDocumentTypeNodePublicId(t){return t.publicId},getDocumentTypeNodeSystemId(t){return t.systemId},isTextNode(t){return t.nodeName==="#text"},isCommentNode(t){return t.nodeName==="#comment"},isDocumentTypeNode(t){return t.nodeName==="#documentType"},isElementNode(t){return Object.prototype.hasOwnProperty.call(t,"tagName")},setNodeSourceCodeLocation(t,e){t.sourceCodeLocation=e},getNodeSourceCodeLocation(t){return t.sourceCodeLocation},updateNodeSourceCodeLocation(t,e){t.sourceCodeLocation={...t.sourceCodeLocation,...e}}},jj="html",zme="about:legacy-compat",Vme="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",Uj=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],Gme=[...Uj,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],Wme=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),$j=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],qme=[...$j,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function XP(t,e){return e.some(r=>t.startsWith(r))}function Kme(t){return t.name===jj&&t.publicId===null&&(t.systemId===null||t.systemId===zme)}function Yme(t){if(t.name!==jj)return ds.QUIRKS;const{systemId:e}=t;if(e&&e.toLowerCase()===Vme)return ds.QUIRKS;let{publicId:r}=t;if(r!==null){if(r=r.toLowerCase(),Wme.has(r))return ds.QUIRKS;let n=e===null?Gme:Uj;if(XP(r,n))return ds.QUIRKS;if(n=e===null?$j:qme,XP(r,n))return ds.LIMITED_QUIRKS}return ds.NO_QUIRKS}const ZP={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},Xme="definitionurl",Zme="definitionURL",Jme=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(t=>[t.toLowerCase(),t])),Qme=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:De.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:De.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:De.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:De.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:De.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:De.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:De.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:De.XML}],["xml:space",{prefix:"xml",name:"space",namespace:De.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:De.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:De.XMLNS}]]),ege=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(t=>[t.toLowerCase(),t])),tge=new Set([k.B,k.BIG,k.BLOCKQUOTE,k.BODY,k.BR,k.CENTER,k.CODE,k.DD,k.DIV,k.DL,k.DT,k.EM,k.EMBED,k.H1,k.H2,k.H3,k.H4,k.H5,k.H6,k.HEAD,k.HR,k.I,k.IMG,k.LI,k.LISTING,k.MENU,k.META,k.NOBR,k.OL,k.P,k.PRE,k.RUBY,k.S,k.SMALL,k.SPAN,k.STRONG,k.STRIKE,k.SUB,k.SUP,k.TABLE,k.TT,k.U,k.UL,k.VAR]);function rge(t){const e=t.tagID;return e===k.FONT&&t.attrs.some(({name:n})=>n===Il.COLOR||n===Il.SIZE||n===Il.FACE)||tge.has(e)}function Hj(t){for(let e=0;e<t.attrs.length;e++)if(t.attrs[e].name===Xme){t.attrs[e].name=Zme;break}}function zj(t){for(let e=0;e<t.attrs.length;e++){const r=Jme.get(t.attrs[e].name);r!=null&&(t.attrs[e].name=r)}}function dk(t){for(let e=0;e<t.attrs.length;e++){const r=Qme.get(t.attrs[e].name);r&&(t.attrs[e].prefix=r.prefix,t.attrs[e].name=r.name,t.attrs[e].namespace=r.namespace)}}function nge(t){const e=ege.get(t.tagName);e!=null&&(t.tagName=e,t.tagID=oh(t.tagName))}function sge(t,e){return e===De.MATHML&&(t===k.MI||t===k.MO||t===k.MN||t===k.MS||t===k.MTEXT)}function ige(t,e,r){if(e===De.MATHML&&t===k.ANNOTATION_XML){for(let n=0;n<r.length;n++)if(r[n].name===Il.ENCODING){const s=r[n].value.toLowerCase();return s===ZP.TEXT_HTML||s===ZP.APPLICATION_XML}}return e===De.SVG&&(t===k.FOREIGN_OBJECT||t===k.DESC||t===k.TITLE)}function oge(t,e,r,n){return(!n||n===De.HTML)&&ige(t,e,r)||(!n||n===De.MATHML)&&sge(t,e)}const age="hidden",lge=8,cge=3;var se;(function(t){t[t.INITIAL=0]="INITIAL",t[t.BEFORE_HTML=1]="BEFORE_HTML",t[t.BEFORE_HEAD=2]="BEFORE_HEAD",t[t.IN_HEAD=3]="IN_HEAD",t[t.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",t[t.AFTER_HEAD=5]="AFTER_HEAD",t[t.IN_BODY=6]="IN_BODY",t[t.TEXT=7]="TEXT",t[t.IN_TABLE=8]="IN_TABLE",t[t.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",t[t.IN_CAPTION=10]="IN_CAPTION",t[t.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",t[t.IN_TABLE_BODY=12]="IN_TABLE_BODY",t[t.IN_ROW=13]="IN_ROW",t[t.IN_CELL=14]="IN_CELL",t[t.IN_SELECT=15]="IN_SELECT",t[t.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",t[t.IN_TEMPLATE=17]="IN_TEMPLATE",t[t.AFTER_BODY=18]="AFTER_BODY",t[t.IN_FRAMESET=19]="IN_FRAMESET",t[t.AFTER_FRAMESET=20]="AFTER_FRAMESET",t[t.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",t[t.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(se||(se={}));const uge={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},Vj=new Set([k.TABLE,k.TBODY,k.TFOOT,k.THEAD,k.TR]),JP={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:qo,onParseError:null};let QP=class{constructor(e,r,n=null,s=null){this.fragmentContext=n,this.scriptHandler=s,this.currentToken=null,this.stopped=!1,this.insertionMode=se.INITIAL,this.originalInsertionMode=se.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...JP,...e},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=r??this.treeAdapter.createDocument(),this.tokenizer=new Lme(this.options,this),this.activeFormattingElements=new Hme(this.treeAdapter),this.fragmentContextID=n?oh(this.treeAdapter.getTagName(n)):k.UNKNOWN,this._setContextModes(n??this.document,this.fragmentContextID),this.openElements=new $me(this.document,this.treeAdapter,this)}static parse(e,r){const n=new this(r);return n.tokenizer.write(e,!0),n.document}static getFragmentParser(e,r){const n={...JP,...r};e??(e=n.treeAdapter.createElement(_e.TEMPLATE,De.HTML,[]));const s=n.treeAdapter.createElement("documentmock",De.HTML,[]),i=new this(n,s,e);return i.fragmentContextID===k.TEMPLATE&&i.tmplInsertionModeStack.unshift(se.IN_TEMPLATE),i._initTokenizerForFragmentParsing(),i._insertFakeRootElement(),i._resetInsertionMode(),i._findFormInFragmentContext(),i}getFragment(){const e=this.treeAdapter.getFirstChild(this.document),r=this.treeAdapter.createDocumentFragment();return this._adoptNodes(e,r),r}_err(e,r,n){var s;if(!this.onParseError)return;const i=(s=e.location)!==null&&s!==void 0?s:uge,o={code:r,startLine:i.startLine,startCol:i.startCol,startOffset:i.startOffset,endLine:n?i.startLine:i.endLine,endCol:n?i.startCol:i.endCol,endOffset:n?i.startOffset:i.endOffset};this.onParseError(o)}onItemPush(e,r,n){var s,i;(i=(s=this.treeAdapter).onItemPush)===null||i===void 0||i.call(s,e),n&&this.openElements.stackTop>0&&this._setContextModes(e,r)}onItemPop(e,r){var n,s;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(e,this.currentToken),(s=(n=this.treeAdapter).onItemPop)===null||s===void 0||s.call(n,e,this.openElements.current),r){let i,o;this.openElements.stackTop===0&&this.fragmentContext?(i=this.fragmentContext,o=this.fragmentContextID):{current:i,currentTagId:o}=this.openElements,this._setContextModes(i,o)}}_setContextModes(e,r){const n=e===this.document||this.treeAdapter.getNamespaceURI(e)===De.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(r,e)}_switchToTextParsing(e,r){this._insertElement(e,De.HTML),this.tokenizer.state=r,this.originalInsertionMode=this.insertionMode,this.insertionMode=se.TEXT}switchToPlaintextParsing(){this.insertionMode=se.TEXT,this.originalInsertionMode=se.IN_BODY,this.tokenizer.state=lr.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let e=this.fragmentContext;for(;e;){if(this.treeAdapter.getTagName(e)===_e.FORM){this.formElement=e;break}e=this.treeAdapter.getParentNode(e)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==De.HTML))switch(this.fragmentContextID){case k.TITLE:case k.TEXTAREA:{this.tokenizer.state=lr.RCDATA;break}case k.STYLE:case k.XMP:case k.IFRAME:case k.NOEMBED:case k.NOFRAMES:case k.NOSCRIPT:{this.tokenizer.state=lr.RAWTEXT;break}case k.SCRIPT:{this.tokenizer.state=lr.SCRIPT_DATA;break}case k.PLAINTEXT:{this.tokenizer.state=lr.PLAINTEXT;break}}}_setDocumentType(e){const r=e.name||"",n=e.publicId||"",s=e.systemId||"";if(this.treeAdapter.setDocumentType(this.document,r,n,s),e.location){const o=this.treeAdapter.getChildNodes(this.document).find(a=>this.treeAdapter.isDocumentTypeNode(a));o&&this.treeAdapter.setNodeSourceCodeLocation(o,e.location)}}_attachElementToTree(e,r){if(this.options.sourceCodeLocationInfo){const n=r&&{...r,startTag:r};this.treeAdapter.setNodeSourceCodeLocation(e,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(e);else{const n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n,e)}}_appendElement(e,r){const n=this.treeAdapter.createElement(e.tagName,r,e.attrs);this._attachElementToTree(n,e.location)}_insertElement(e,r){const n=this.treeAdapter.createElement(e.tagName,r,e.attrs);this._attachElementToTree(n,e.location),this.openElements.push(n,e.tagID)}_insertFakeElement(e,r){const n=this.treeAdapter.createElement(e,De.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,r)}_insertTemplate(e){const r=this.treeAdapter.createElement(e.tagName,De.HTML,e.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(r,n),this._attachElementToTree(r,e.location),this.openElements.push(r,e.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){const e=this.treeAdapter.createElement(_e.HTML,De.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(e,null),this.treeAdapter.appendChild(this.openElements.current,e),this.openElements.push(e,k.HTML)}_appendCommentNode(e,r){const n=this.treeAdapter.createCommentNode(e.data);this.treeAdapter.appendChild(r,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,e.location)}_insertCharacters(e){let r,n;if(this._shouldFosterParentOnInsertion()?({parent:r,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(r,e.chars,n):this.treeAdapter.insertText(r,e.chars)):(r=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(r,e.chars)),!e.location)return;const s=this.treeAdapter.getChildNodes(r),i=n?s.lastIndexOf(n):s.length,o=s[i-1];if(this.treeAdapter.getNodeSourceCodeLocation(o)){const{endLine:l,endCol:c,endOffset:u}=e.location;this.treeAdapter.updateNodeSourceCodeLocation(o,{endLine:l,endCol:c,endOffset:u})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(o,e.location)}_adoptNodes(e,r){for(let n=this.treeAdapter.getFirstChild(e);n;n=this.treeAdapter.getFirstChild(e))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(r,n)}_setEndLocation(e,r){if(this.treeAdapter.getNodeSourceCodeLocation(e)&&r.location){const n=r.location,s=this.treeAdapter.getTagName(e),i=r.type===dt.END_TAG&&s===r.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(e,i)}}shouldProcessStartTagTokenInForeignContent(e){if(!this.currentNotInHTML)return!1;let r,n;return this.openElements.stackTop===0&&this.fragmentContext?(r=this.fragmentContext,n=this.fragmentContextID):{current:r,currentTagId:n}=this.openElements,e.tagID===k.SVG&&this.treeAdapter.getTagName(r)===_e.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(r)===De.MATHML?!1:this.tokenizer.inForeignNode||(e.tagID===k.MGLYPH||e.tagID===k.MALIGNMARK)&&!this._isIntegrationPoint(n,r,De.HTML)}_processToken(e){switch(e.type){case dt.CHARACTER:{this.onCharacter(e);break}case dt.NULL_CHARACTER:{this.onNullCharacter(e);break}case dt.COMMENT:{this.onComment(e);break}case dt.DOCTYPE:{this.onDoctype(e);break}case dt.START_TAG:{this._processStartTag(e);break}case dt.END_TAG:{this.onEndTag(e);break}case dt.EOF:{this.onEof(e);break}case dt.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(e);break}}}_isIntegrationPoint(e,r,n){const s=this.treeAdapter.getNamespaceURI(r),i=this.treeAdapter.getAttrList(r);return oge(e,s,i,n)}_reconstructActiveFormattingElements(){const e=this.activeFormattingElements.entries.length;if(e){const r=this.activeFormattingElements.entries.findIndex(s=>s.type===gi.Marker||this.openElements.contains(s.element)),n=r<0?e-1:r-1;for(let s=n;s>=0;s--){const i=this.activeFormattingElements.entries[s];this._insertElement(i.token,this.treeAdapter.getNamespaceURI(i.element)),i.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=se.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(k.P),this.openElements.popUntilTagNamePopped(k.P)}_resetInsertionMode(){for(let e=this.openElements.stackTop;e>=0;e--)switch(e===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[e]){case k.TR:{this.insertionMode=se.IN_ROW;return}case k.TBODY:case k.THEAD:case k.TFOOT:{this.insertionMode=se.IN_TABLE_BODY;return}case k.CAPTION:{this.insertionMode=se.IN_CAPTION;return}case k.COLGROUP:{this.insertionMode=se.IN_COLUMN_GROUP;return}case k.TABLE:{this.insertionMode=se.IN_TABLE;return}case k.BODY:{this.insertionMode=se.IN_BODY;return}case k.FRAMESET:{this.insertionMode=se.IN_FRAMESET;return}case k.SELECT:{this._resetInsertionModeForSelect(e);return}case k.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case k.HTML:{this.insertionMode=this.headElement?se.AFTER_HEAD:se.BEFORE_HEAD;return}case k.TD:case k.TH:{if(e>0){this.insertionMode=se.IN_CELL;return}break}case k.HEAD:{if(e>0){this.insertionMode=se.IN_HEAD;return}break}}this.insertionMode=se.IN_BODY}_resetInsertionModeForSelect(e){if(e>0)for(let r=e-1;r>0;r--){const n=this.openElements.tagIDs[r];if(n===k.TEMPLATE)break;if(n===k.TABLE){this.insertionMode=se.IN_SELECT_IN_TABLE;return}}this.insertionMode=se.IN_SELECT}_isElementCausesFosterParenting(e){return Vj.has(e)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let e=this.openElements.stackTop;e>=0;e--){const r=this.openElements.items[e];switch(this.openElements.tagIDs[e]){case k.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(r)===De.HTML)return{parent:this.treeAdapter.getTemplateContent(r),beforeElement:null};break}case k.TABLE:{const n=this.treeAdapter.getParentNode(r);return n?{parent:n,beforeElement:r}:{parent:this.openElements.items[e-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(e){const r=this._findFosterParentingLocation();r.beforeElement?this.treeAdapter.insertBefore(r.parent,e,r.beforeElement):this.treeAdapter.appendChild(r.parent,e)}_isSpecialElement(e,r){const n=this.treeAdapter.getNamespaceURI(e);return Ime[n].has(r)}onCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){U0e(this,e);return}switch(this.insertionMode){case se.INITIAL:{Lh(this,e);break}case se.BEFORE_HTML:{Cd(this,e);break}case se.BEFORE_HEAD:{kd(this,e);break}case se.IN_HEAD:{Ad(this,e);break}case se.IN_HEAD_NO_SCRIPT:{Rd(this,e);break}case se.AFTER_HEAD:{Id(this,e);break}case se.IN_BODY:case se.IN_CAPTION:case se.IN_CELL:case se.IN_TEMPLATE:{Wj(this,e);break}case se.TEXT:case se.IN_SELECT:case se.IN_SELECT_IN_TABLE:{this._insertCharacters(e);break}case se.IN_TABLE:case se.IN_TABLE_BODY:case se.IN_ROW:{pw(this,e);break}case se.IN_TABLE_TEXT:{Jj(this,e);break}case se.IN_COLUMN_GROUP:{d_(this,e);break}case se.AFTER_BODY:{f_(this,e);break}case se.AFTER_AFTER_BODY:{e0(this,e);break}}}onNullCharacter(e){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){j0e(this,e);return}switch(this.insertionMode){case se.INITIAL:{Lh(this,e);break}case se.BEFORE_HTML:{Cd(this,e);break}case se.BEFORE_HEAD:{kd(this,e);break}case se.IN_HEAD:{Ad(this,e);break}case se.IN_HEAD_NO_SCRIPT:{Rd(this,e);break}case se.AFTER_HEAD:{Id(this,e);break}case se.TEXT:{this._insertCharacters(e);break}case se.IN_TABLE:case se.IN_TABLE_BODY:case se.IN_ROW:{pw(this,e);break}case se.IN_COLUMN_GROUP:{d_(this,e);break}case se.AFTER_BODY:{f_(this,e);break}case se.AFTER_AFTER_BODY:{e0(this,e);break}}}onComment(e){if(this.skipNextNewLine=!1,this.currentNotInHTML){xx(this,e);return}switch(this.insertionMode){case se.INITIAL:case se.BEFORE_HTML:case se.BEFORE_HEAD:case se.IN_HEAD:case se.IN_HEAD_NO_SCRIPT:case se.AFTER_HEAD:case se.IN_BODY:case se.IN_TABLE:case se.IN_CAPTION:case se.IN_COLUMN_GROUP:case se.IN_TABLE_BODY:case se.IN_ROW:case se.IN_CELL:case se.IN_SELECT:case se.IN_SELECT_IN_TABLE:case se.IN_TEMPLATE:case se.IN_FRAMESET:case se.AFTER_FRAMESET:{xx(this,e);break}case se.IN_TABLE_TEXT:{Nh(this,e);break}case se.AFTER_BODY:{_ge(this,e);break}case se.AFTER_AFTER_BODY:case se.AFTER_AFTER_FRAMESET:{yge(this,e);break}}}onDoctype(e){switch(this.skipNextNewLine=!1,this.insertionMode){case se.INITIAL:{bge(this,e);break}case se.BEFORE_HEAD:case se.IN_HEAD:case se.IN_HEAD_NO_SCRIPT:case se.AFTER_HEAD:{this._err(e,Ee.misplacedDoctype);break}case se.IN_TABLE_TEXT:{Nh(this,e);break}}}onStartTag(e){this.skipNextNewLine=!1,this.currentToken=e,this._processStartTag(e),e.selfClosing&&!e.ackSelfClosing&&this._err(e,Ee.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(e){this.shouldProcessStartTagTokenInForeignContent(e)?$0e(this,e):this._startTagOutsideForeignContent(e)}_startTagOutsideForeignContent(e){switch(this.insertionMode){case se.INITIAL:{Lh(this,e);break}case se.BEFORE_HTML:{vge(this,e);break}case se.BEFORE_HEAD:{Ege(this,e);break}case se.IN_HEAD:{qs(this,e);break}case se.IN_HEAD_NO_SCRIPT:{Tge(this,e);break}case se.AFTER_HEAD:{kge(this,e);break}case se.IN_BODY:{nn(this,e);break}case se.IN_TABLE:{Au(this,e);break}case se.IN_TABLE_TEXT:{Nh(this,e);break}case se.IN_CAPTION:{x0e(this,e);break}case se.IN_COLUMN_GROUP:{mk(this,e);break}case se.IN_TABLE_BODY:{ub(this,e);break}case se.IN_ROW:{hb(this,e);break}case se.IN_CELL:{C0e(this,e);break}case se.IN_SELECT:{tU(this,e);break}case se.IN_SELECT_IN_TABLE:{A0e(this,e);break}case se.IN_TEMPLATE:{I0e(this,e);break}case se.AFTER_BODY:{O0e(this,e);break}case se.IN_FRAMESET:{D0e(this,e);break}case se.AFTER_FRAMESET:{N0e(this,e);break}case se.AFTER_AFTER_BODY:{B0e(this,e);break}case se.AFTER_AFTER_FRAMESET:{F0e(this,e);break}}}onEndTag(e){this.skipNextNewLine=!1,this.currentToken=e,this.currentNotInHTML?H0e(this,e):this._endTagOutsideForeignContent(e)}_endTagOutsideForeignContent(e){switch(this.insertionMode){case se.INITIAL:{Lh(this,e);break}case se.BEFORE_HTML:{wge(this,e);break}case se.BEFORE_HEAD:{xge(this,e);break}case se.IN_HEAD:{Sge(this,e);break}case se.IN_HEAD_NO_SCRIPT:{Cge(this,e);break}case se.AFTER_HEAD:{Age(this,e);break}case se.IN_BODY:{cb(this,e);break}case se.TEXT:{f0e(this,e);break}case se.IN_TABLE:{Ef(this,e);break}case se.IN_TABLE_TEXT:{Nh(this,e);break}case se.IN_CAPTION:{S0e(this,e);break}case se.IN_COLUMN_GROUP:{T0e(this,e);break}case se.IN_TABLE_BODY:{Sx(this,e);break}case se.IN_ROW:{eU(this,e);break}case se.IN_CELL:{k0e(this,e);break}case se.IN_SELECT:{rU(this,e);break}case se.IN_SELECT_IN_TABLE:{R0e(this,e);break}case se.IN_TEMPLATE:{P0e(this,e);break}case se.AFTER_BODY:{sU(this,e);break}case se.IN_FRAMESET:{L0e(this,e);break}case se.AFTER_FRAMESET:{M0e(this,e);break}case se.AFTER_AFTER_BODY:{e0(this,e);break}}}onEof(e){switch(this.insertionMode){case se.INITIAL:{Lh(this,e);break}case se.BEFORE_HTML:{Cd(this,e);break}case se.BEFORE_HEAD:{kd(this,e);break}case se.IN_HEAD:{Ad(this,e);break}case se.IN_HEAD_NO_SCRIPT:{Rd(this,e);break}case se.AFTER_HEAD:{Id(this,e);break}case se.IN_BODY:case se.IN_TABLE:case se.IN_CAPTION:case se.IN_COLUMN_GROUP:case se.IN_TABLE_BODY:case se.IN_ROW:case se.IN_CELL:case se.IN_SELECT:case se.IN_SELECT_IN_TABLE:{Xj(this,e);break}case se.TEXT:{p0e(this,e);break}case se.IN_TABLE_TEXT:{Nh(this,e);break}case se.IN_TEMPLATE:{nU(this,e);break}case se.AFTER_BODY:case se.IN_FRAMESET:case se.AFTER_FRAMESET:case se.AFTER_AFTER_BODY:case se.AFTER_AFTER_FRAMESET:{pk(this,e);break}}}onWhitespaceCharacter(e){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,e.chars.charCodeAt(0)===X.LINE_FEED)){if(e.chars.length===1)return;e.chars=e.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(e);return}switch(this.insertionMode){case se.IN_HEAD:case se.IN_HEAD_NO_SCRIPT:case se.AFTER_HEAD:case se.TEXT:case se.IN_COLUMN_GROUP:case se.IN_SELECT:case se.IN_SELECT_IN_TABLE:case se.IN_FRAMESET:case se.AFTER_FRAMESET:{this._insertCharacters(e);break}case se.IN_BODY:case se.IN_CAPTION:case se.IN_CELL:case se.IN_TEMPLATE:case se.AFTER_BODY:case se.AFTER_AFTER_BODY:case se.AFTER_AFTER_FRAMESET:{Gj(this,e);break}case se.IN_TABLE:case se.IN_TABLE_BODY:case se.IN_ROW:{pw(this,e);break}case se.IN_TABLE_TEXT:{Zj(this,e);break}}}};function hge(t,e){let r=t.activeFormattingElements.getElementEntryInScopeWithTagName(e.tagName);return r?t.openElements.contains(r.element)?t.openElements.hasInScope(e.tagID)||(r=null):(t.activeFormattingElements.removeEntry(r),r=null):Yj(t,e),r}function dge(t,e){let r=null,n=t.openElements.stackTop;for(;n>=0;n--){const s=t.openElements.items[n];if(s===e.element)break;t._isSpecialElement(s,t.openElements.tagIDs[n])&&(r=s)}return r||(t.openElements.shortenToLength(n<0?0:n),t.activeFormattingElements.removeEntry(e)),r}function fge(t,e,r){let n=e,s=t.openElements.getCommonAncestor(e);for(let i=0,o=s;o!==r;i++,o=s){s=t.openElements.getCommonAncestor(o);const a=t.activeFormattingElements.getElementEntry(o),l=a&&i>=cge;!a||l?(l&&t.activeFormattingElements.removeEntry(a),t.openElements.remove(o)):(o=pge(t,a),n===e&&(t.activeFormattingElements.bookmark=a),t.treeAdapter.detachNode(n),t.treeAdapter.appendChild(o,n),n=o)}return n}function pge(t,e){const r=t.treeAdapter.getNamespaceURI(e.element),n=t.treeAdapter.createElement(e.token.tagName,r,e.token.attrs);return t.openElements.replace(e.element,n),e.element=n,n}function mge(t,e,r){const n=t.treeAdapter.getTagName(e),s=oh(n);if(t._isElementCausesFosterParenting(s))t._fosterParentElement(r);else{const i=t.treeAdapter.getNamespaceURI(e);s===k.TEMPLATE&&i===De.HTML&&(e=t.treeAdapter.getTemplateContent(e)),t.treeAdapter.appendChild(e,r)}}function gge(t,e,r){const n=t.treeAdapter.getNamespaceURI(r.element),{token:s}=r,i=t.treeAdapter.createElement(s.tagName,n,s.attrs);t._adoptNodes(e,i),t.treeAdapter.appendChild(e,i),t.activeFormattingElements.insertElementAfterBookmark(i,s),t.activeFormattingElements.removeEntry(r),t.openElements.remove(r.element),t.openElements.insertAfter(e,i,s.tagID)}function fk(t,e){for(let r=0;r<lge;r++){const n=hge(t,e);if(!n)break;const s=dge(t,n);if(!s)break;t.activeFormattingElements.bookmark=n;const i=fge(t,s,n.element),o=t.openElements.getCommonAncestor(n.element);t.treeAdapter.detachNode(i),o&&mge(t,o,i),gge(t,s,n)}}function xx(t,e){t._appendCommentNode(e,t.openElements.currentTmplContentOrNode)}function _ge(t,e){t._appendCommentNode(e,t.openElements.items[0])}function yge(t,e){t._appendCommentNode(e,t.document)}function pk(t,e){if(t.stopped=!0,e.location){const r=t.fragmentContext?0:2;for(let n=t.openElements.stackTop;n>=r;n--)t._setEndLocation(t.openElements.items[n],e);if(!t.fragmentContext&&t.openElements.stackTop>=0){const n=t.openElements.items[0],s=t.treeAdapter.getNodeSourceCodeLocation(n);if(s&&!s.endTag&&(t._setEndLocation(n,e),t.openElements.stackTop>=1)){const i=t.openElements.items[1],o=t.treeAdapter.getNodeSourceCodeLocation(i);o&&!o.endTag&&t._setEndLocation(i,e)}}}}function bge(t,e){t._setDocumentType(e);const r=e.forceQuirks?ds.QUIRKS:Yme(e);Kme(e)||t._err(e,Ee.nonConformingDoctype),t.treeAdapter.setDocumentMode(t.document,r),t.insertionMode=se.BEFORE_HTML}function Lh(t,e){t._err(e,Ee.missingDoctype,!0),t.treeAdapter.setDocumentMode(t.document,ds.QUIRKS),t.insertionMode=se.BEFORE_HTML,t._processToken(e)}function vge(t,e){e.tagID===k.HTML?(t._insertElement(e,De.HTML),t.insertionMode=se.BEFORE_HEAD):Cd(t,e)}function wge(t,e){const r=e.tagID;(r===k.HTML||r===k.HEAD||r===k.BODY||r===k.BR)&&Cd(t,e)}function Cd(t,e){t._insertFakeRootElement(),t.insertionMode=se.BEFORE_HEAD,t._processToken(e)}function Ege(t,e){switch(e.tagID){case k.HTML:{nn(t,e);break}case k.HEAD:{t._insertElement(e,De.HTML),t.headElement=t.openElements.current,t.insertionMode=se.IN_HEAD;break}default:kd(t,e)}}function xge(t,e){const r=e.tagID;r===k.HEAD||r===k.BODY||r===k.HTML||r===k.BR?kd(t,e):t._err(e,Ee.endTagWithoutMatchingOpenElement)}function kd(t,e){t._insertFakeElement(_e.HEAD,k.HEAD),t.headElement=t.openElements.current,t.insertionMode=se.IN_HEAD,t._processToken(e)}function qs(t,e){switch(e.tagID){case k.HTML:{nn(t,e);break}case k.BASE:case k.BASEFONT:case k.BGSOUND:case k.LINK:case k.META:{t._appendElement(e,De.HTML),e.ackSelfClosing=!0;break}case k.TITLE:{t._switchToTextParsing(e,lr.RCDATA);break}case k.NOSCRIPT:{t.options.scriptingEnabled?t._switchToTextParsing(e,lr.RAWTEXT):(t._insertElement(e,De.HTML),t.insertionMode=se.IN_HEAD_NO_SCRIPT);break}case k.NOFRAMES:case k.STYLE:{t._switchToTextParsing(e,lr.RAWTEXT);break}case k.SCRIPT:{t._switchToTextParsing(e,lr.SCRIPT_DATA);break}case k.TEMPLATE:{t._insertTemplate(e),t.activeFormattingElements.insertMarker(),t.framesetOk=!1,t.insertionMode=se.IN_TEMPLATE,t.tmplInsertionModeStack.unshift(se.IN_TEMPLATE);break}case k.HEAD:{t._err(e,Ee.misplacedStartTagForHeadElement);break}default:Ad(t,e)}}function Sge(t,e){switch(e.tagID){case k.HEAD:{t.openElements.pop(),t.insertionMode=se.AFTER_HEAD;break}case k.BODY:case k.BR:case k.HTML:{Ad(t,e);break}case k.TEMPLATE:{oc(t,e);break}default:t._err(e,Ee.endTagWithoutMatchingOpenElement)}}function oc(t,e){t.openElements.tmplCount>0?(t.openElements.generateImpliedEndTagsThoroughly(),t.openElements.currentTagId!==k.TEMPLATE&&t._err(e,Ee.closingOfElementWithOpenChildElements),t.openElements.popUntilTagNamePopped(k.TEMPLATE),t.activeFormattingElements.clearToLastMarker(),t.tmplInsertionModeStack.shift(),t._resetInsertionMode()):t._err(e,Ee.endTagWithoutMatchingOpenElement)}function Ad(t,e){t.openElements.pop(),t.insertionMode=se.AFTER_HEAD,t._processToken(e)}function Tge(t,e){switch(e.tagID){case k.HTML:{nn(t,e);break}case k.BASEFONT:case k.BGSOUND:case k.HEAD:case k.LINK:case k.META:case k.NOFRAMES:case k.STYLE:{qs(t,e);break}case k.NOSCRIPT:{t._err(e,Ee.nestedNoscriptInHead);break}default:Rd(t,e)}}function Cge(t,e){switch(e.tagID){case k.NOSCRIPT:{t.openElements.pop(),t.insertionMode=se.IN_HEAD;break}case k.BR:{Rd(t,e);break}default:t._err(e,Ee.endTagWithoutMatchingOpenElement)}}function Rd(t,e){const r=e.type===dt.EOF?Ee.openElementsLeftAfterEof:Ee.disallowedContentInNoscriptInHead;t._err(e,r),t.openElements.pop(),t.insertionMode=se.IN_HEAD,t._processToken(e)}function kge(t,e){switch(e.tagID){case k.HTML:{nn(t,e);break}case k.BODY:{t._insertElement(e,De.HTML),t.framesetOk=!1,t.insertionMode=se.IN_BODY;break}case k.FRAMESET:{t._insertElement(e,De.HTML),t.insertionMode=se.IN_FRAMESET;break}case k.BASE:case k.BASEFONT:case k.BGSOUND:case k.LINK:case k.META:case k.NOFRAMES:case k.SCRIPT:case k.STYLE:case k.TEMPLATE:case k.TITLE:{t._err(e,Ee.abandonedHeadElementChild),t.openElements.push(t.headElement,k.HEAD),qs(t,e),t.openElements.remove(t.headElement);break}case k.HEAD:{t._err(e,Ee.misplacedStartTagForHeadElement);break}default:Id(t,e)}}function Age(t,e){switch(e.tagID){case k.BODY:case k.HTML:case k.BR:{Id(t,e);break}case k.TEMPLATE:{oc(t,e);break}default:t._err(e,Ee.endTagWithoutMatchingOpenElement)}}function Id(t,e){t._insertFakeElement(_e.BODY,k.BODY),t.insertionMode=se.IN_BODY,lb(t,e)}function lb(t,e){switch(e.type){case dt.CHARACTER:{Wj(t,e);break}case dt.WHITESPACE_CHARACTER:{Gj(t,e);break}case dt.COMMENT:{xx(t,e);break}case dt.START_TAG:{nn(t,e);break}case dt.END_TAG:{cb(t,e);break}case dt.EOF:{Xj(t,e);break}}}function Gj(t,e){t._reconstructActiveFormattingElements(),t._insertCharacters(e)}function Wj(t,e){t._reconstructActiveFormattingElements(),t._insertCharacters(e),t.framesetOk=!1}function Rge(t,e){t.openElements.tmplCount===0&&t.treeAdapter.adoptAttributes(t.openElements.items[0],e.attrs)}function Ige(t,e){const r=t.openElements.tryPeekProperlyNestedBodyElement();r&&t.openElements.tmplCount===0&&(t.framesetOk=!1,t.treeAdapter.adoptAttributes(r,e.attrs))}function Pge(t,e){const r=t.openElements.tryPeekProperlyNestedBodyElement();t.framesetOk&&r&&(t.treeAdapter.detachNode(r),t.openElements.popAllUpToHtmlElement(),t._insertElement(e,De.HTML),t.insertionMode=se.IN_FRAMESET)}function Oge(t,e){t.openElements.hasInButtonScope(k.P)&&t._closePElement(),t._insertElement(e,De.HTML)}function Dge(t,e){t.openElements.hasInButtonScope(k.P)&&t._closePElement(),Ex.has(t.openElements.currentTagId)&&t.openElements.pop(),t._insertElement(e,De.HTML)}function Lge(t,e){t.openElements.hasInButtonScope(k.P)&&t._closePElement(),t._insertElement(e,De.HTML),t.skipNextNewLine=!0,t.framesetOk=!1}function Nge(t,e){const r=t.openElements.tmplCount>0;(!t.formElement||r)&&(t.openElements.hasInButtonScope(k.P)&&t._closePElement(),t._insertElement(e,De.HTML),r||(t.formElement=t.openElements.current))}function Mge(t,e){t.framesetOk=!1;const r=e.tagID;for(let n=t.openElements.stackTop;n>=0;n--){const s=t.openElements.tagIDs[n];if(r===k.LI&&s===k.LI||(r===k.DD||r===k.DT)&&(s===k.DD||s===k.DT)){t.openElements.generateImpliedEndTagsWithExclusion(s),t.openElements.popUntilTagNamePopped(s);break}if(s!==k.ADDRESS&&s!==k.DIV&&s!==k.P&&t._isSpecialElement(t.openElements.items[n],s))break}t.openElements.hasInButtonScope(k.P)&&t._closePElement(),t._insertElement(e,De.HTML)}function Bge(t,e){t.openElements.hasInButtonScope(k.P)&&t._closePElement(),t._insertElement(e,De.HTML),t.tokenizer.state=lr.PLAINTEXT}function Fge(t,e){t.openElements.hasInScope(k.BUTTON)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(k.BUTTON)),t._reconstructActiveFormattingElements(),t._insertElement(e,De.HTML),t.framesetOk=!1}function jge(t,e){const r=t.activeFormattingElements.getElementEntryInScopeWithTagName(_e.A);r&&(fk(t,e),t.openElements.remove(r.element),t.activeFormattingElements.removeEntry(r)),t._reconstructActiveFormattingElements(),t._insertElement(e,De.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function Uge(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,De.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function $ge(t,e){t._reconstructActiveFormattingElements(),t.openElements.hasInScope(k.NOBR)&&(fk(t,e),t._reconstructActiveFormattingElements()),t._insertElement(e,De.HTML),t.activeFormattingElements.pushElement(t.openElements.current,e)}function Hge(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,De.HTML),t.activeFormattingElements.insertMarker(),t.framesetOk=!1}function zge(t,e){t.treeAdapter.getDocumentMode(t.document)!==ds.QUIRKS&&t.openElements.hasInButtonScope(k.P)&&t._closePElement(),t._insertElement(e,De.HTML),t.framesetOk=!1,t.insertionMode=se.IN_TABLE}function qj(t,e){t._reconstructActiveFormattingElements(),t._appendElement(e,De.HTML),t.framesetOk=!1,e.ackSelfClosing=!0}function Kj(t){const e=Dj(t,Il.TYPE);return e!=null&&e.toLowerCase()===age}function Vge(t,e){t._reconstructActiveFormattingElements(),t._appendElement(e,De.HTML),Kj(e)||(t.framesetOk=!1),e.ackSelfClosing=!0}function Gge(t,e){t._appendElement(e,De.HTML),e.ackSelfClosing=!0}function Wge(t,e){t.openElements.hasInButtonScope(k.P)&&t._closePElement(),t._appendElement(e,De.HTML),t.framesetOk=!1,e.ackSelfClosing=!0}function qge(t,e){e.tagName=_e.IMG,e.tagID=k.IMG,qj(t,e)}function Kge(t,e){t._insertElement(e,De.HTML),t.skipNextNewLine=!0,t.tokenizer.state=lr.RCDATA,t.originalInsertionMode=t.insertionMode,t.framesetOk=!1,t.insertionMode=se.TEXT}function Yge(t,e){t.openElements.hasInButtonScope(k.P)&&t._closePElement(),t._reconstructActiveFormattingElements(),t.framesetOk=!1,t._switchToTextParsing(e,lr.RAWTEXT)}function Xge(t,e){t.framesetOk=!1,t._switchToTextParsing(e,lr.RAWTEXT)}function eO(t,e){t._switchToTextParsing(e,lr.RAWTEXT)}function Zge(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,De.HTML),t.framesetOk=!1,t.insertionMode=t.insertionMode===se.IN_TABLE||t.insertionMode===se.IN_CAPTION||t.insertionMode===se.IN_TABLE_BODY||t.insertionMode===se.IN_ROW||t.insertionMode===se.IN_CELL?se.IN_SELECT_IN_TABLE:se.IN_SELECT}function Jge(t,e){t.openElements.currentTagId===k.OPTION&&t.openElements.pop(),t._reconstructActiveFormattingElements(),t._insertElement(e,De.HTML)}function Qge(t,e){t.openElements.hasInScope(k.RUBY)&&t.openElements.generateImpliedEndTags(),t._insertElement(e,De.HTML)}function e0e(t,e){t.openElements.hasInScope(k.RUBY)&&t.openElements.generateImpliedEndTagsWithExclusion(k.RTC),t._insertElement(e,De.HTML)}function t0e(t,e){t._reconstructActiveFormattingElements(),Hj(e),dk(e),e.selfClosing?t._appendElement(e,De.MATHML):t._insertElement(e,De.MATHML),e.ackSelfClosing=!0}function r0e(t,e){t._reconstructActiveFormattingElements(),zj(e),dk(e),e.selfClosing?t._appendElement(e,De.SVG):t._insertElement(e,De.SVG),e.ackSelfClosing=!0}function tO(t,e){t._reconstructActiveFormattingElements(),t._insertElement(e,De.HTML)}function nn(t,e){switch(e.tagID){case k.I:case k.S:case k.B:case k.U:case k.EM:case k.TT:case k.BIG:case k.CODE:case k.FONT:case k.SMALL:case k.STRIKE:case k.STRONG:{Uge(t,e);break}case k.A:{jge(t,e);break}case k.H1:case k.H2:case k.H3:case k.H4:case k.H5:case k.H6:{Dge(t,e);break}case k.P:case k.DL:case k.OL:case k.UL:case k.DIV:case k.DIR:case k.NAV:case k.MAIN:case k.MENU:case k.ASIDE:case k.CENTER:case k.FIGURE:case k.FOOTER:case k.HEADER:case k.HGROUP:case k.DIALOG:case k.DETAILS:case k.ADDRESS:case k.ARTICLE:case k.SEARCH:case k.SECTION:case k.SUMMARY:case k.FIELDSET:case k.BLOCKQUOTE:case k.FIGCAPTION:{Oge(t,e);break}case k.LI:case k.DD:case k.DT:{Mge(t,e);break}case k.BR:case k.IMG:case k.WBR:case k.AREA:case k.EMBED:case k.KEYGEN:{qj(t,e);break}case k.HR:{Wge(t,e);break}case k.RB:case k.RTC:{Qge(t,e);break}case k.RT:case k.RP:{e0e(t,e);break}case k.PRE:case k.LISTING:{Lge(t,e);break}case k.XMP:{Yge(t,e);break}case k.SVG:{r0e(t,e);break}case k.HTML:{Rge(t,e);break}case k.BASE:case k.LINK:case k.META:case k.STYLE:case k.TITLE:case k.SCRIPT:case k.BGSOUND:case k.BASEFONT:case k.TEMPLATE:{qs(t,e);break}case k.BODY:{Ige(t,e);break}case k.FORM:{Nge(t,e);break}case k.NOBR:{$ge(t,e);break}case k.MATH:{t0e(t,e);break}case k.TABLE:{zge(t,e);break}case k.INPUT:{Vge(t,e);break}case k.PARAM:case k.TRACK:case k.SOURCE:{Gge(t,e);break}case k.IMAGE:{qge(t,e);break}case k.BUTTON:{Fge(t,e);break}case k.APPLET:case k.OBJECT:case k.MARQUEE:{Hge(t,e);break}case k.IFRAME:{Xge(t,e);break}case k.SELECT:{Zge(t,e);break}case k.OPTION:case k.OPTGROUP:{Jge(t,e);break}case k.NOEMBED:case k.NOFRAMES:{eO(t,e);break}case k.FRAMESET:{Pge(t,e);break}case k.TEXTAREA:{Kge(t,e);break}case k.NOSCRIPT:{t.options.scriptingEnabled?eO(t,e):tO(t,e);break}case k.PLAINTEXT:{Bge(t,e);break}case k.COL:case k.TH:case k.TD:case k.TR:case k.HEAD:case k.FRAME:case k.TBODY:case k.TFOOT:case k.THEAD:case k.CAPTION:case k.COLGROUP:break;default:tO(t,e)}}function n0e(t,e){if(t.openElements.hasInScope(k.BODY)&&(t.insertionMode=se.AFTER_BODY,t.options.sourceCodeLocationInfo)){const r=t.openElements.tryPeekProperlyNestedBodyElement();r&&t._setEndLocation(r,e)}}function s0e(t,e){t.openElements.hasInScope(k.BODY)&&(t.insertionMode=se.AFTER_BODY,sU(t,e))}function i0e(t,e){const r=e.tagID;t.openElements.hasInScope(r)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(r))}function o0e(t){const e=t.openElements.tmplCount>0,{formElement:r}=t;e||(t.formElement=null),(r||e)&&t.openElements.hasInScope(k.FORM)&&(t.openElements.generateImpliedEndTags(),e?t.openElements.popUntilTagNamePopped(k.FORM):r&&t.openElements.remove(r))}function a0e(t){t.openElements.hasInButtonScope(k.P)||t._insertFakeElement(_e.P,k.P),t._closePElement()}function l0e(t){t.openElements.hasInListItemScope(k.LI)&&(t.openElements.generateImpliedEndTagsWithExclusion(k.LI),t.openElements.popUntilTagNamePopped(k.LI))}function c0e(t,e){const r=e.tagID;t.openElements.hasInScope(r)&&(t.openElements.generateImpliedEndTagsWithExclusion(r),t.openElements.popUntilTagNamePopped(r))}function u0e(t){t.openElements.hasNumberedHeaderInScope()&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilNumberedHeaderPopped())}function h0e(t,e){const r=e.tagID;t.openElements.hasInScope(r)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(r),t.activeFormattingElements.clearToLastMarker())}function d0e(t){t._reconstructActiveFormattingElements(),t._insertFakeElement(_e.BR,k.BR),t.openElements.pop(),t.framesetOk=!1}function Yj(t,e){const r=e.tagName,n=e.tagID;for(let s=t.openElements.stackTop;s>0;s--){const i=t.openElements.items[s],o=t.openElements.tagIDs[s];if(n===o&&(n!==k.UNKNOWN||t.treeAdapter.getTagName(i)===r)){t.openElements.generateImpliedEndTagsWithExclusion(n),t.openElements.stackTop>=s&&t.openElements.shortenToLength(s);break}if(t._isSpecialElement(i,o))break}}function cb(t,e){switch(e.tagID){case k.A:case k.B:case k.I:case k.S:case k.U:case k.EM:case k.TT:case k.BIG:case k.CODE:case k.FONT:case k.NOBR:case k.SMALL:case k.STRIKE:case k.STRONG:{fk(t,e);break}case k.P:{a0e(t);break}case k.DL:case k.UL:case k.OL:case k.DIR:case k.DIV:case k.NAV:case k.PRE:case k.MAIN:case k.MENU:case k.ASIDE:case k.BUTTON:case k.CENTER:case k.FIGURE:case k.FOOTER:case k.HEADER:case k.HGROUP:case k.DIALOG:case k.ADDRESS:case k.ARTICLE:case k.DETAILS:case k.SEARCH:case k.SECTION:case k.SUMMARY:case k.LISTING:case k.FIELDSET:case k.BLOCKQUOTE:case k.FIGCAPTION:{i0e(t,e);break}case k.LI:{l0e(t);break}case k.DD:case k.DT:{c0e(t,e);break}case k.H1:case k.H2:case k.H3:case k.H4:case k.H5:case k.H6:{u0e(t);break}case k.BR:{d0e(t);break}case k.BODY:{n0e(t,e);break}case k.HTML:{s0e(t,e);break}case k.FORM:{o0e(t);break}case k.APPLET:case k.OBJECT:case k.MARQUEE:{h0e(t,e);break}case k.TEMPLATE:{oc(t,e);break}default:Yj(t,e)}}function Xj(t,e){t.tmplInsertionModeStack.length>0?nU(t,e):pk(t,e)}function f0e(t,e){var r;e.tagID===k.SCRIPT&&((r=t.scriptHandler)===null||r===void 0||r.call(t,t.openElements.current)),t.openElements.pop(),t.insertionMode=t.originalInsertionMode}function p0e(t,e){t._err(e,Ee.eofInElementThatCanContainOnlyText),t.openElements.pop(),t.insertionMode=t.originalInsertionMode,t.onEof(e)}function pw(t,e){if(Vj.has(t.openElements.currentTagId))switch(t.pendingCharacterTokens.length=0,t.hasNonWhitespacePendingCharacterToken=!1,t.originalInsertionMode=t.insertionMode,t.insertionMode=se.IN_TABLE_TEXT,e.type){case dt.CHARACTER:{Jj(t,e);break}case dt.WHITESPACE_CHARACTER:{Zj(t,e);break}}else Ap(t,e)}function m0e(t,e){t.openElements.clearBackToTableContext(),t.activeFormattingElements.insertMarker(),t._insertElement(e,De.HTML),t.insertionMode=se.IN_CAPTION}function g0e(t,e){t.openElements.clearBackToTableContext(),t._insertElement(e,De.HTML),t.insertionMode=se.IN_COLUMN_GROUP}function _0e(t,e){t.openElements.clearBackToTableContext(),t._insertFakeElement(_e.COLGROUP,k.COLGROUP),t.insertionMode=se.IN_COLUMN_GROUP,mk(t,e)}function y0e(t,e){t.openElements.clearBackToTableContext(),t._insertElement(e,De.HTML),t.insertionMode=se.IN_TABLE_BODY}function b0e(t,e){t.openElements.clearBackToTableContext(),t._insertFakeElement(_e.TBODY,k.TBODY),t.insertionMode=se.IN_TABLE_BODY,ub(t,e)}function v0e(t,e){t.openElements.hasInTableScope(k.TABLE)&&(t.openElements.popUntilTagNamePopped(k.TABLE),t._resetInsertionMode(),t._processStartTag(e))}function w0e(t,e){Kj(e)?t._appendElement(e,De.HTML):Ap(t,e),e.ackSelfClosing=!0}function E0e(t,e){!t.formElement&&t.openElements.tmplCount===0&&(t._insertElement(e,De.HTML),t.formElement=t.openElements.current,t.openElements.pop())}function Au(t,e){switch(e.tagID){case k.TD:case k.TH:case k.TR:{b0e(t,e);break}case k.STYLE:case k.SCRIPT:case k.TEMPLATE:{qs(t,e);break}case k.COL:{_0e(t,e);break}case k.FORM:{E0e(t,e);break}case k.TABLE:{v0e(t,e);break}case k.TBODY:case k.TFOOT:case k.THEAD:{y0e(t,e);break}case k.INPUT:{w0e(t,e);break}case k.CAPTION:{m0e(t,e);break}case k.COLGROUP:{g0e(t,e);break}default:Ap(t,e)}}function Ef(t,e){switch(e.tagID){case k.TABLE:{t.openElements.hasInTableScope(k.TABLE)&&(t.openElements.popUntilTagNamePopped(k.TABLE),t._resetInsertionMode());break}case k.TEMPLATE:{oc(t,e);break}case k.BODY:case k.CAPTION:case k.COL:case k.COLGROUP:case k.HTML:case k.TBODY:case k.TD:case k.TFOOT:case k.TH:case k.THEAD:case k.TR:break;default:Ap(t,e)}}function Ap(t,e){const r=t.fosterParentingEnabled;t.fosterParentingEnabled=!0,lb(t,e),t.fosterParentingEnabled=r}function Zj(t,e){t.pendingCharacterTokens.push(e)}function Jj(t,e){t.pendingCharacterTokens.push(e),t.hasNonWhitespacePendingCharacterToken=!0}function Nh(t,e){let r=0;if(t.hasNonWhitespacePendingCharacterToken)for(;r<t.pendingCharacterTokens.length;r++)Ap(t,t.pendingCharacterTokens[r]);else for(;r<t.pendingCharacterTokens.length;r++)t._insertCharacters(t.pendingCharacterTokens[r]);t.insertionMode=t.originalInsertionMode,t._processToken(e)}const Qj=new Set([k.CAPTION,k.COL,k.COLGROUP,k.TBODY,k.TD,k.TFOOT,k.TH,k.THEAD,k.TR]);function x0e(t,e){const r=e.tagID;Qj.has(r)?t.openElements.hasInTableScope(k.CAPTION)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(k.CAPTION),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=se.IN_TABLE,Au(t,e)):nn(t,e)}function S0e(t,e){const r=e.tagID;switch(r){case k.CAPTION:case k.TABLE:{t.openElements.hasInTableScope(k.CAPTION)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(k.CAPTION),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=se.IN_TABLE,r===k.TABLE&&Ef(t,e));break}case k.BODY:case k.COL:case k.COLGROUP:case k.HTML:case k.TBODY:case k.TD:case k.TFOOT:case k.TH:case k.THEAD:case k.TR:break;default:cb(t,e)}}function mk(t,e){switch(e.tagID){case k.HTML:{nn(t,e);break}case k.COL:{t._appendElement(e,De.HTML),e.ackSelfClosing=!0;break}case k.TEMPLATE:{qs(t,e);break}default:d_(t,e)}}function T0e(t,e){switch(e.tagID){case k.COLGROUP:{t.openElements.currentTagId===k.COLGROUP&&(t.openElements.pop(),t.insertionMode=se.IN_TABLE);break}case k.TEMPLATE:{oc(t,e);break}case k.COL:break;default:d_(t,e)}}function d_(t,e){t.openElements.currentTagId===k.COLGROUP&&(t.openElements.pop(),t.insertionMode=se.IN_TABLE,t._processToken(e))}function ub(t,e){switch(e.tagID){case k.TR:{t.openElements.clearBackToTableBodyContext(),t._insertElement(e,De.HTML),t.insertionMode=se.IN_ROW;break}case k.TH:case k.TD:{t.openElements.clearBackToTableBodyContext(),t._insertFakeElement(_e.TR,k.TR),t.insertionMode=se.IN_ROW,hb(t,e);break}case k.CAPTION:case k.COL:case k.COLGROUP:case k.TBODY:case k.TFOOT:case k.THEAD:{t.openElements.hasTableBodyContextInTableScope()&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=se.IN_TABLE,Au(t,e));break}default:Au(t,e)}}function Sx(t,e){const r=e.tagID;switch(e.tagID){case k.TBODY:case k.TFOOT:case k.THEAD:{t.openElements.hasInTableScope(r)&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=se.IN_TABLE);break}case k.TABLE:{t.openElements.hasTableBodyContextInTableScope()&&(t.openElements.clearBackToTableBodyContext(),t.openElements.pop(),t.insertionMode=se.IN_TABLE,Ef(t,e));break}case k.BODY:case k.CAPTION:case k.COL:case k.COLGROUP:case k.HTML:case k.TD:case k.TH:case k.TR:break;default:Ef(t,e)}}function hb(t,e){switch(e.tagID){case k.TH:case k.TD:{t.openElements.clearBackToTableRowContext(),t._insertElement(e,De.HTML),t.insertionMode=se.IN_CELL,t.activeFormattingElements.insertMarker();break}case k.CAPTION:case k.COL:case k.COLGROUP:case k.TBODY:case k.TFOOT:case k.THEAD:case k.TR:{t.openElements.hasInTableScope(k.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=se.IN_TABLE_BODY,ub(t,e));break}default:Au(t,e)}}function eU(t,e){switch(e.tagID){case k.TR:{t.openElements.hasInTableScope(k.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=se.IN_TABLE_BODY);break}case k.TABLE:{t.openElements.hasInTableScope(k.TR)&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=se.IN_TABLE_BODY,Sx(t,e));break}case k.TBODY:case k.TFOOT:case k.THEAD:{(t.openElements.hasInTableScope(e.tagID)||t.openElements.hasInTableScope(k.TR))&&(t.openElements.clearBackToTableRowContext(),t.openElements.pop(),t.insertionMode=se.IN_TABLE_BODY,Sx(t,e));break}case k.BODY:case k.CAPTION:case k.COL:case k.COLGROUP:case k.HTML:case k.TD:case k.TH:break;default:Ef(t,e)}}function C0e(t,e){const r=e.tagID;Qj.has(r)?(t.openElements.hasInTableScope(k.TD)||t.openElements.hasInTableScope(k.TH))&&(t._closeTableCell(),hb(t,e)):nn(t,e)}function k0e(t,e){const r=e.tagID;switch(r){case k.TD:case k.TH:{t.openElements.hasInTableScope(r)&&(t.openElements.generateImpliedEndTags(),t.openElements.popUntilTagNamePopped(r),t.activeFormattingElements.clearToLastMarker(),t.insertionMode=se.IN_ROW);break}case k.TABLE:case k.TBODY:case k.TFOOT:case k.THEAD:case k.TR:{t.openElements.hasInTableScope(r)&&(t._closeTableCell(),eU(t,e));break}case k.BODY:case k.CAPTION:case k.COL:case k.COLGROUP:case k.HTML:break;default:cb(t,e)}}function tU(t,e){switch(e.tagID){case k.HTML:{nn(t,e);break}case k.OPTION:{t.openElements.currentTagId===k.OPTION&&t.openElements.pop(),t._insertElement(e,De.HTML);break}case k.OPTGROUP:{t.openElements.currentTagId===k.OPTION&&t.openElements.pop(),t.openElements.currentTagId===k.OPTGROUP&&t.openElements.pop(),t._insertElement(e,De.HTML);break}case k.HR:{t.openElements.currentTagId===k.OPTION&&t.openElements.pop(),t.openElements.currentTagId===k.OPTGROUP&&t.openElements.pop(),t._appendElement(e,De.HTML),e.ackSelfClosing=!0;break}case k.INPUT:case k.KEYGEN:case k.TEXTAREA:case k.SELECT:{t.openElements.hasInSelectScope(k.SELECT)&&(t.openElements.popUntilTagNamePopped(k.SELECT),t._resetInsertionMode(),e.tagID!==k.SELECT&&t._processStartTag(e));break}case k.SCRIPT:case k.TEMPLATE:{qs(t,e);break}}}function rU(t,e){switch(e.tagID){case k.OPTGROUP:{t.openElements.stackTop>0&&t.openElements.currentTagId===k.OPTION&&t.openElements.tagIDs[t.openElements.stackTop-1]===k.OPTGROUP&&t.openElements.pop(),t.openElements.currentTagId===k.OPTGROUP&&t.openElements.pop();break}case k.OPTION:{t.openElements.currentTagId===k.OPTION&&t.openElements.pop();break}case k.SELECT:{t.openElements.hasInSelectScope(k.SELECT)&&(t.openElements.popUntilTagNamePopped(k.SELECT),t._resetInsertionMode());break}case k.TEMPLATE:{oc(t,e);break}}}function A0e(t,e){const r=e.tagID;r===k.CAPTION||r===k.TABLE||r===k.TBODY||r===k.TFOOT||r===k.THEAD||r===k.TR||r===k.TD||r===k.TH?(t.openElements.popUntilTagNamePopped(k.SELECT),t._resetInsertionMode(),t._processStartTag(e)):tU(t,e)}function R0e(t,e){const r=e.tagID;r===k.CAPTION||r===k.TABLE||r===k.TBODY||r===k.TFOOT||r===k.THEAD||r===k.TR||r===k.TD||r===k.TH?t.openElements.hasInTableScope(r)&&(t.openElements.popUntilTagNamePopped(k.SELECT),t._resetInsertionMode(),t.onEndTag(e)):rU(t,e)}function I0e(t,e){switch(e.tagID){case k.BASE:case k.BASEFONT:case k.BGSOUND:case k.LINK:case k.META:case k.NOFRAMES:case k.SCRIPT:case k.STYLE:case k.TEMPLATE:case k.TITLE:{qs(t,e);break}case k.CAPTION:case k.COLGROUP:case k.TBODY:case k.TFOOT:case k.THEAD:{t.tmplInsertionModeStack[0]=se.IN_TABLE,t.insertionMode=se.IN_TABLE,Au(t,e);break}case k.COL:{t.tmplInsertionModeStack[0]=se.IN_COLUMN_GROUP,t.insertionMode=se.IN_COLUMN_GROUP,mk(t,e);break}case k.TR:{t.tmplInsertionModeStack[0]=se.IN_TABLE_BODY,t.insertionMode=se.IN_TABLE_BODY,ub(t,e);break}case k.TD:case k.TH:{t.tmplInsertionModeStack[0]=se.IN_ROW,t.insertionMode=se.IN_ROW,hb(t,e);break}default:t.tmplInsertionModeStack[0]=se.IN_BODY,t.insertionMode=se.IN_BODY,nn(t,e)}}function P0e(t,e){e.tagID===k.TEMPLATE&&oc(t,e)}function nU(t,e){t.openElements.tmplCount>0?(t.openElements.popUntilTagNamePopped(k.TEMPLATE),t.activeFormattingElements.clearToLastMarker(),t.tmplInsertionModeStack.shift(),t._resetInsertionMode(),t.onEof(e)):pk(t,e)}function O0e(t,e){e.tagID===k.HTML?nn(t,e):f_(t,e)}function sU(t,e){var r;if(e.tagID===k.HTML){if(t.fragmentContext||(t.insertionMode=se.AFTER_AFTER_BODY),t.options.sourceCodeLocationInfo&&t.openElements.tagIDs[0]===k.HTML){t._setEndLocation(t.openElements.items[0],e);const n=t.openElements.items[1];n&&!(!((r=t.treeAdapter.getNodeSourceCodeLocation(n))===null||r===void 0)&&r.endTag)&&t._setEndLocation(n,e)}}else f_(t,e)}function f_(t,e){t.insertionMode=se.IN_BODY,lb(t,e)}function D0e(t,e){switch(e.tagID){case k.HTML:{nn(t,e);break}case k.FRAMESET:{t._insertElement(e,De.HTML);break}case k.FRAME:{t._appendElement(e,De.HTML),e.ackSelfClosing=!0;break}case k.NOFRAMES:{qs(t,e);break}}}function L0e(t,e){e.tagID===k.FRAMESET&&!t.openElements.isRootHtmlElementCurrent()&&(t.openElements.pop(),!t.fragmentContext&&t.openElements.currentTagId!==k.FRAMESET&&(t.insertionMode=se.AFTER_FRAMESET))}function N0e(t,e){switch(e.tagID){case k.HTML:{nn(t,e);break}case k.NOFRAMES:{qs(t,e);break}}}function M0e(t,e){e.tagID===k.HTML&&(t.insertionMode=se.AFTER_AFTER_FRAMESET)}function B0e(t,e){e.tagID===k.HTML?nn(t,e):e0(t,e)}function e0(t,e){t.insertionMode=se.IN_BODY,lb(t,e)}function F0e(t,e){switch(e.tagID){case k.HTML:{nn(t,e);break}case k.NOFRAMES:{qs(t,e);break}}}function j0e(t,e){e.chars=Kt,t._insertCharacters(e)}function U0e(t,e){t._insertCharacters(e),t.framesetOk=!1}function iU(t){for(;t.treeAdapter.getNamespaceURI(t.openElements.current)!==De.HTML&&!t._isIntegrationPoint(t.openElements.currentTagId,t.openElements.current);)t.openElements.pop()}function $0e(t,e){if(rge(e))iU(t),t._startTagOutsideForeignContent(e);else{const r=t._getAdjustedCurrentElement(),n=t.treeAdapter.getNamespaceURI(r);n===De.MATHML?Hj(e):n===De.SVG&&(nge(e),zj(e)),dk(e),e.selfClosing?t._appendElement(e,n):t._insertElement(e,n),e.ackSelfClosing=!0}}function H0e(t,e){if(e.tagID===k.P||e.tagID===k.BR){iU(t),t._endTagOutsideForeignContent(e);return}for(let r=t.openElements.stackTop;r>0;r--){const n=t.openElements.items[r];if(t.treeAdapter.getNamespaceURI(n)===De.HTML){t._endTagOutsideForeignContent(e);break}const s=t.treeAdapter.getTagName(n);if(s.toLowerCase()===e.tagName){e.tagName=s,t.openElements.shortenToLength(r);break}}}_e.AREA,_e.BASE,_e.BASEFONT,_e.BGSOUND,_e.BR,_e.COL,_e.EMBED,_e.FRAME,_e.HR,_e.IMG,_e.INPUT,_e.KEYGEN,_e.LINK,_e.META,_e.PARAM,_e.SOURCE,_e.TRACK,_e.WBR;const db=oU("end"),Gi=oU("start");function oU(t){return e;function e(r){const n=r&&r.position&&r.position[t]||{};if(typeof n.line=="number"&&n.line>0&&typeof n.column=="number"&&n.column>0)return{line:n.line,column:n.column,offset:typeof n.offset=="number"&&n.offset>-1?n.offset:void 0}}}function aU(t){const e=Gi(t),r=db(t);if(e&&r)return{start:e,end:r}}const fb=function(t){if(t==null)return W0e;if(typeof t=="function")return pb(t);if(typeof t=="object")return Array.isArray(t)?z0e(t):V0e(t);if(typeof t=="string")return G0e(t);throw new Error("Expected function, string, or object as test")};function z0e(t){const e=[];let r=-1;for(;++r<t.length;)e[r]=fb(t[r]);return pb(n);function n(...s){let i=-1;for(;++i<e.length;)if(e[i].apply(this,s))return!0;return!1}}function V0e(t){const e=t;return pb(r);function r(n){const s=n;let i;for(i in t)if(s[i]!==e[i])return!1;return!0}}function G0e(t){return pb(e);function e(r){return r&&r.type===t}}function pb(t){return e;function e(r,n,s){return!!(q0e(r)&&t.call(this,r,typeof n=="number"?n:void 0,s||void 0))}}function W0e(){return!0}function q0e(t){return t!==null&&typeof t=="object"&&"type"in t}const lU=[],K0e=!0,Tx=!1,cU="skip";function uU(t,e,r,n){let s;typeof e=="function"&&typeof r!="function"?(n=r,r=e):s=e;const i=fb(s),o=n?-1:1;a(t,void 0,[])();function a(l,c,u){const h=l&&typeof l=="object"?l:{};if(typeof h.type=="string"){const f=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(d,"name",{value:"node ("+(l.type+(f?"<"+f+">":""))+")"})}return d;function d(){let f=lU,g,_,m;if((!e||i(l,c,u[u.length-1]||void 0))&&(f=Y0e(r(l,u)),f[0]===Tx))return f;if("children"in l&&l.children){const p=l;if(p.children&&f[0]!==cU)for(_=(n?p.children.length:-1)+o,m=u.concat(p);_>-1&&_<p.children.length;){const y=p.children[_];if(g=a(y,_,m)(),g[0]===Tx)return g;_=typeof g[1]=="number"?g[1]:_+o}}return f}}}function Y0e(t){return Array.isArray(t)?t:typeof t=="number"?[K0e,t]:t==null?lU:[t]}function Rp(t,e,r,n){let s,i,o;typeof e=="function"&&typeof r!="function"?(i=void 0,o=e,s=r):(i=e,o=r,s=n),uU(t,i,a,s);function a(l,c){const u=c[c.length-1],h=u?u.children.indexOf(l):void 0;return o(l,h,u)}}const X0e=/<(\/?)(iframe|noembed|noframes|plaintext|script|style|textarea|title|xmp)(?=[\t\n\f\r />])/gi,Z0e=new Set(["mdxFlowExpression","mdxJsxFlowElement","mdxJsxTextElement","mdxTextExpression","mdxjsEsm"]),rO={sourceCodeLocationInfo:!0,scriptingEnabled:!1};function hU(t,e){const r=a_e(t),n=uk("type",{handlers:{root:J0e,element:Q0e,text:e_e,comment:fU,doctype:t_e,raw:n_e},unknown:s_e}),s={parser:r?new QP(rO):QP.getFragmentParser(void 0,rO),handle(a){n(a,s)},stitches:!1,options:e||{}};n(t,s),ah(s,Gi());const i=r?s.parser.document:s.parser.getFragment(),o=rme(i,{file:s.options.file});return s.stitches&&Rp(o,"comment",function(a,l,c){const u=a;if(u.value.stitch&&c&&l!==void 0){const h=c.children;return h[l]=u.value.stitch,l}}),o.type==="root"&&o.children.length===1&&o.children[0].type===t.type?o.children[0]:o}function dU(t,e){let r=-1;if(t)for(;++r<t.length;)e.handle(t[r])}function J0e(t,e){dU(t.children,e)}function Q0e(t,e){i_e(t,e),dU(t.children,e),o_e(t,e)}function e_e(t,e){e.parser.tokenizer.state>4&&(e.parser.tokenizer.state=0);const r={type:dt.CHARACTER,chars:t.value,location:Ip(t)};ah(e,Gi(t)),e.parser.currentToken=r,e.parser._processToken(e.parser.currentToken)}function t_e(t,e){const r={type:dt.DOCTYPE,name:"html",forceQuirks:!1,publicId:"",systemId:"",location:Ip(t)};ah(e,Gi(t)),e.parser.currentToken=r,e.parser._processToken(e.parser.currentToken)}function r_e(t,e){e.stitches=!0;const r=l_e(t);if("children"in t&&"children"in r){const n=hU({type:"root",children:t.children},e.options);r.children=n.children}fU({type:"comment",value:{stitch:r}},e)}function fU(t,e){const r=t.value,n={type:dt.COMMENT,data:r,location:Ip(t)};ah(e,Gi(t)),e.parser.currentToken=n,e.parser._processToken(e.parser.currentToken)}function n_e(t,e){if(e.parser.tokenizer.preprocessor.html="",e.parser.tokenizer.preprocessor.pos=-1,e.parser.tokenizer.preprocessor.lastGapPos=-2,e.parser.tokenizer.preprocessor.gapStack=[],e.parser.tokenizer.preprocessor.skipNextNewLine=!1,e.parser.tokenizer.preprocessor.lastChunkWritten=!1,e.parser.tokenizer.preprocessor.endOfChunkHit=!1,e.parser.tokenizer.preprocessor.isEol=!1,pU(e,Gi(t)),e.parser.tokenizer.write(e.options.tagfilter?t.value.replace(X0e,"&lt;$1$2"):t.value,!1),e.parser.tokenizer._runParsingLoop(),e.parser.tokenizer.state===72||e.parser.tokenizer.state===78){e.parser.tokenizer.preprocessor.lastChunkWritten=!0;const r=e.parser.tokenizer._consume();e.parser.tokenizer._callState(r)}}function s_e(t,e){const r=t;if(e.options.passThrough&&e.options.passThrough.includes(r.type))r_e(r,e);else{let n="";throw Z0e.has(r.type)&&(n=". It looks like you are using MDX nodes with `hast-util-raw` (or `rehype-raw`). If you use this because you are using remark or rehype plugins that inject `'html'` nodes, then please raise an issue with that plugin, as its a bad and slow idea. If you use this because you are using markdown syntax, then you have to configure this utility (or plugin) to pass through these nodes (see `passThrough` in docs), but you can also migrate to use the MDX syntax"),new Error("Cannot compile `"+r.type+"` node"+n)}}function ah(t,e){pU(t,e);const r=t.parser.tokenizer.currentCharacterToken;r&&r.location&&(r.location.endLine=t.parser.tokenizer.preprocessor.line,r.location.endCol=t.parser.tokenizer.preprocessor.col+1,r.location.endOffset=t.parser.tokenizer.preprocessor.offset+1,t.parser.currentToken=r,t.parser._processToken(t.parser.currentToken)),t.parser.tokenizer.paused=!1,t.parser.tokenizer.inLoop=!1,t.parser.tokenizer.active=!1,t.parser.tokenizer.returnState=lr.DATA,t.parser.tokenizer.charRefCode=-1,t.parser.tokenizer.consumedAfterSnapshot=-1,t.parser.tokenizer.currentLocation=null,t.parser.tokenizer.currentCharacterToken=null,t.parser.tokenizer.currentToken=null,t.parser.tokenizer.currentAttr={name:"",value:""}}function pU(t,e){if(e&&e.offset!==void 0){const r={startLine:e.line,startCol:e.column,startOffset:e.offset,endLine:-1,endCol:-1,endOffset:-1};t.parser.tokenizer.preprocessor.lineStartPos=-e.column+1,t.parser.tokenizer.preprocessor.droppedBufferSize=e.offset,t.parser.tokenizer.preprocessor.line=e.line,t.parser.tokenizer.currentLocation=r}}function i_e(t,e){const r=t.tagName.toLowerCase();if(e.parser.tokenizer.state===lr.PLAINTEXT)return;ah(e,Gi(t));const n=e.parser.openElements.current;let s="namespaceURI"in n?n.namespaceURI:fl.html;s===fl.html&&r==="svg"&&(s=fl.svg);const i=ame({...t,children:[]},{space:s===fl.svg?"svg":"html"}),o={type:dt.START_TAG,tagName:r,tagID:oh(r),selfClosing:!1,ackSelfClosing:!1,attrs:"attrs"in i?i.attrs:[],location:Ip(t)};e.parser.currentToken=o,e.parser._processToken(e.parser.currentToken),e.parser.tokenizer.lastStartTagName=r}function o_e(t,e){const r=t.tagName.toLowerCase();if(!e.parser.tokenizer.inForeignNode&&Rj.includes(r)||e.parser.tokenizer.state===lr.PLAINTEXT)return;ah(e,db(t));const n={type:dt.END_TAG,tagName:r,tagID:oh(r),selfClosing:!1,ackSelfClosing:!1,attrs:[],location:Ip(t)};e.parser.currentToken=n,e.parser._processToken(e.parser.currentToken),r===e.parser.tokenizer.lastStartTagName&&(e.parser.tokenizer.state===lr.RCDATA||e.parser.tokenizer.state===lr.RAWTEXT||e.parser.tokenizer.state===lr.SCRIPT_DATA)&&(e.parser.tokenizer.state=lr.DATA)}function a_e(t){const e=t.type==="root"?t.children[0]:t;return!!(e&&(e.type==="doctype"||e.type==="element"&&e.tagName.toLowerCase()==="html"))}function Ip(t){const e=Gi(t)||{line:void 0,column:void 0,offset:void 0},r=db(t)||{line:void 0,column:void 0,offset:void 0};return{startLine:e.line,startCol:e.column,startOffset:e.offset,endLine:r.line,endCol:r.column,endOffset:r.offset}}function l_e(t){return"children"in t?Ul({...t,children:[]}):Ul(t)}function c_e(t){return function(e,r){return hU(e,{...t,file:r})}}function p_(t,e){const r=String(t);if(typeof e!="string")throw new TypeError("Expected character");let n=0,s=r.indexOf(e);for(;s!==-1;)n++,s=r.indexOf(e,s+e.length);return n}const fn=za(/[A-Za-z]/),Zr=za(/[\dA-Za-z]/),u_e=za(/[#-'*+\--9=?A-Z^-~]/);function m_(t){return t!==null&&(t<32||t===127)}const Cx=za(/\d/),h_e=za(/[\dA-Fa-f]/),d_e=za(/[!-/:-@[-`{-~]/);function Qe(t){return t!==null&&t<-2}function Ut(t){return t!==null&&(t<0||t===32)}function pt(t){return t===-2||t===-1||t===32}const mb=za(/\p{P}|\p{S}/u),$l=za(/\s/);function za(t){return e;function e(r){return r!==null&&r>-1&&t.test(String.fromCharCode(r))}}function f_e(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function p_e(t,e,r){const s=fb((r||{}).ignore||[]),i=m_e(e);let o=-1;for(;++o<i.length;)uU(t,"text",a);function a(c,u){let h=-1,d;for(;++h<u.length;){const f=u[h],g=d?d.children:void 0;if(s(f,g?g.indexOf(f):void 0,d))return;d=f}if(d)return l(c,u)}function l(c,u){const h=u[u.length-1],d=i[o][0],f=i[o][1];let g=0;const m=h.children.indexOf(c);let p=!1,y=[];d.lastIndex=0;let b=d.exec(c.value);for(;b;){const v=b.index,w={index:b.index,input:b.input,stack:[...u,c]};let E=f(...b,w);if(typeof E=="string"&&(E=E.length>0?{type:"text",value:E}:void 0),E===!1?d.lastIndex=v+1:(g!==v&&y.push({type:"text",value:c.value.slice(g,v)}),Array.isArray(E)?y.push(...E):E&&y.push(E),g=v+b[0].length,p=!0),!d.global)break;b=d.exec(c.value)}return p?(g<c.value.length&&y.push({type:"text",value:c.value.slice(g)}),h.children.splice(m,1,...y)):y=[c],m+y.length}}function m_e(t){const e=[];if(!Array.isArray(t))throw new TypeError("Expected find and replace tuple or list of tuples");const r=!t[0]||Array.isArray(t[0])?t:[t];let n=-1;for(;++n<r.length;){const s=r[n];e.push([g_e(s[0]),__e(s[1])])}return e}function g_e(t){return typeof t=="string"?new RegExp(f_e(t),"g"):t}function __e(t){return typeof t=="function"?t:function(){return t}}const mw="phrasing",gw=["autolink","link","image","label"];function y_e(){return{transforms:[T_e],enter:{literalAutolink:v_e,literalAutolinkEmail:_w,literalAutolinkHttp:_w,literalAutolinkWww:_w},exit:{literalAutolink:S_e,literalAutolinkEmail:x_e,literalAutolinkHttp:w_e,literalAutolinkWww:E_e}}}function b_e(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:mw,notInConstruct:gw},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:mw,notInConstruct:gw},{character:":",before:"[ps]",after:"\\/",inConstruct:mw,notInConstruct:gw}]}}function v_e(t){this.enter({type:"link",title:null,url:"",children:[]},t)}function _w(t){this.config.enter.autolinkProtocol.call(this,t)}function w_e(t){this.config.exit.autolinkProtocol.call(this,t)}function E_e(t){this.config.exit.data.call(this,t);const e=this.stack[this.stack.length-1];e.type,e.url="http://"+this.sliceSerialize(t)}function x_e(t){this.config.exit.autolinkEmail.call(this,t)}function S_e(t){this.exit(t)}function T_e(t){p_e(t,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,C_e],[/(?<=^|\s|\p{P}|\p{S})([-.\w+]+)@([-\w]+(?:\.[-\w]+)+)/gu,k_e]],{ignore:["link","linkReference"]})}function C_e(t,e,r,n,s){let i="";if(!mU(s)||(/^w/i.test(e)&&(r=e+r,e="",i="http://"),!A_e(r)))return!1;const o=R_e(r+n);if(!o[0])return!1;const a={type:"link",title:null,url:i+e+o[0],children:[{type:"text",value:e+o[0]}]};return o[1]?[a,{type:"text",value:o[1]}]:a}function k_e(t,e,r,n){return!mU(n,!0)||/[-\d_]$/.test(r)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+r,children:[{type:"text",value:e+"@"+r}]}}function A_e(t){const e=t.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function R_e(t){const e=/[!"&'),.:;<>?\]}]+$/.exec(t);if(!e)return[t,void 0];t=t.slice(0,e.index);let r=e[0],n=r.indexOf(")");const s=p_(t,"(");let i=p_(t,")");for(;n!==-1&&s>i;)t+=r.slice(0,n+1),r=r.slice(n+1),n=r.indexOf(")"),i++;return[t,r]}function mU(t,e){const r=t.input.charCodeAt(t.index-1);return(t.index===0||$l(r)||mb(r))&&(!e||r!==47)}function Bs(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}gU.peek=U_e;function I_e(){return{enter:{gfmFootnoteDefinition:O_e,gfmFootnoteDefinitionLabelString:D_e,gfmFootnoteCall:M_e,gfmFootnoteCallString:B_e},exit:{gfmFootnoteDefinition:N_e,gfmFootnoteDefinitionLabelString:L_e,gfmFootnoteCall:j_e,gfmFootnoteCallString:F_e}}}function P_e(){return{unsafe:[{character:"[",inConstruct:["phrasing","label","reference"]}],handlers:{footnoteDefinition:$_e,footnoteReference:gU}}}function O_e(t){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},t)}function D_e(){this.buffer()}function L_e(t){const e=this.resume(),r=this.stack[this.stack.length-1];r.type,r.label=e,r.identifier=Bs(this.sliceSerialize(t)).toLowerCase()}function N_e(t){this.exit(t)}function M_e(t){this.enter({type:"footnoteReference",identifier:"",label:""},t)}function B_e(){this.buffer()}function F_e(t){const e=this.resume(),r=this.stack[this.stack.length-1];r.type,r.label=e,r.identifier=Bs(this.sliceSerialize(t)).toLowerCase()}function j_e(t){this.exit(t)}function gU(t,e,r,n){const s=r.createTracker(n);let i=s.move("[^");const o=r.enter("footnoteReference"),a=r.enter("reference");return i+=s.move(r.safe(r.associationId(t),{...s.current(),before:i,after:"]"})),a(),o(),i+=s.move("]"),i}function U_e(){return"["}function $_e(t,e,r,n){const s=r.createTracker(n);let i=s.move("[^");const o=r.enter("footnoteDefinition"),a=r.enter("label");return i+=s.move(r.safe(r.associationId(t),{...s.current(),before:i,after:"]"})),a(),i+=s.move("]:"+(t.children&&t.children.length>0?" ":"")),s.shift(4),i+=s.move(r.indentLines(r.containerFlow(t,s.current()),H_e)),o(),i}function H_e(t,e,r){return e===0?t:(r?"":"    ")+t}const z_e=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];_U.peek=K_e;function V_e(){return{canContainEols:["delete"],enter:{strikethrough:W_e},exit:{strikethrough:q_e}}}function G_e(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:z_e}],handlers:{delete:_U}}}function W_e(t){this.enter({type:"delete",children:[]},t)}function q_e(t){this.exit(t)}function _U(t,e,r,n){const s=r.createTracker(n),i=r.enter("strikethrough");let o=s.move("~~");return o+=r.containerPhrasing(t,{...s.current(),before:o,after:"~"}),o+=s.move("~~"),i(),o}function K_e(){return"~"}function Y_e(t){return t.length}function X_e(t,e){const r=e||{},n=(r.align||[]).concat(),s=r.stringLength||Y_e,i=[],o=[],a=[],l=[];let c=0,u=-1;for(;++u<t.length;){const _=[],m=[];let p=-1;for(t[u].length>c&&(c=t[u].length);++p<t[u].length;){const y=Z_e(t[u][p]);if(r.alignDelimiters!==!1){const b=s(y);m[p]=b,(l[p]===void 0||b>l[p])&&(l[p]=b)}_.push(y)}o[u]=_,a[u]=m}let h=-1;if(typeof n=="object"&&"length"in n)for(;++h<c;)i[h]=nO(n[h]);else{const _=nO(n);for(;++h<c;)i[h]=_}h=-1;const d=[],f=[];for(;++h<c;){const _=i[h];let m="",p="";_===99?(m=":",p=":"):_===108?m=":":_===114&&(p=":");let y=r.alignDelimiters===!1?1:Math.max(1,l[h]-m.length-p.length);const b=m+"-".repeat(y)+p;r.alignDelimiters!==!1&&(y=m.length+y+p.length,y>l[h]&&(l[h]=y),f[h]=y),d[h]=b}o.splice(1,0,d),a.splice(1,0,f),u=-1;const g=[];for(;++u<o.length;){const _=o[u],m=a[u];h=-1;const p=[];for(;++h<c;){const y=_[h]||"";let b="",v="";if(r.alignDelimiters!==!1){const w=l[h]-(m[h]||0),E=i[h];E===114?b=" ".repeat(w):E===99?w%2?(b=" ".repeat(w/2+.5),v=" ".repeat(w/2-.5)):(b=" ".repeat(w/2),v=b):v=" ".repeat(w)}r.delimiterStart!==!1&&!h&&p.push("|"),r.padding!==!1&&!(r.alignDelimiters===!1&&y==="")&&(r.delimiterStart!==!1||h)&&p.push(" "),r.alignDelimiters!==!1&&p.push(b),p.push(y),r.alignDelimiters!==!1&&p.push(v),r.padding!==!1&&p.push(" "),(r.delimiterEnd!==!1||h!==c-1)&&p.push("|")}g.push(r.delimiterEnd===!1?p.join("").replace(/ +$/,""):p.join(""))}return g.join(`
`)}function Z_e(t){return t==null?"":String(t)}function nO(t){const e=typeof t=="string"?t.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}function J_e(t,e,r,n){const s=r.enter("blockquote"),i=r.createTracker(n);i.move("> "),i.shift(2);const o=r.indentLines(r.containerFlow(t,i.current()),Q_e);return s(),o}function Q_e(t,e,r){return">"+(r?"":" ")+t}function eye(t,e){return sO(t,e.inConstruct,!0)&&!sO(t,e.notInConstruct,!1)}function sO(t,e,r){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return r;let n=-1;for(;++n<e.length;)if(t.includes(e[n]))return!0;return!1}function iO(t,e,r,n){let s=-1;for(;++s<r.unsafe.length;)if(r.unsafe[s].character===`
`&&eye(r.stack,r.unsafe[s]))return/[ \t]/.test(n.before)?"":" ";return`\\
`}function tye(t,e){const r=String(t);let n=r.indexOf(e),s=n,i=0,o=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;n!==-1;)n===s?++i>o&&(o=i):i=1,s=n+e.length,n=r.indexOf(e,s);return o}function rye(t,e){return!!(e.options.fences===!1&&t.value&&!t.lang&&/[^ \r\n]/.test(t.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(t.value))}function nye(t){const e=t.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function sye(t,e,r,n){const s=nye(r),i=t.value||"",o=s==="`"?"GraveAccent":"Tilde";if(rye(t,r)){const h=r.enter("codeIndented"),d=r.indentLines(i,iye);return h(),d}const a=r.createTracker(n),l=s.repeat(Math.max(tye(i,s)+1,3)),c=r.enter("codeFenced");let u=a.move(l);if(t.lang){const h=r.enter(`codeFencedLang${o}`);u+=a.move(r.safe(t.lang,{before:u,after:" ",encode:["`"],...a.current()})),h()}if(t.lang&&t.meta){const h=r.enter(`codeFencedMeta${o}`);u+=a.move(" "),u+=a.move(r.safe(t.meta,{before:u,after:`
`,encode:["`"],...a.current()})),h()}return u+=a.move(`
`),i&&(u+=a.move(i+`
`)),u+=a.move(l),c(),u}function iye(t,e,r){return(r?"":"    ")+t}function gk(t){const e=t.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function oye(t,e,r,n){const s=gk(r),i=s==='"'?"Quote":"Apostrophe",o=r.enter("definition");let a=r.enter("label");const l=r.createTracker(n);let c=l.move("[");return c+=l.move(r.safe(r.associationId(t),{before:c,after:"]",...l.current()})),c+=l.move("]: "),a(),!t.url||/[\0- \u007F]/.test(t.url)?(a=r.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(r.safe(t.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(a=r.enter("destinationRaw"),c+=l.move(r.safe(t.url,{before:c,after:t.title?" ":`
`,...l.current()}))),a(),t.title&&(a=r.enter(`title${i}`),c+=l.move(" "+s),c+=l.move(r.safe(t.title,{before:c,after:s,...l.current()})),c+=l.move(s),a()),o(),c}function aye(t){const e=t.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}function xf(t){return"&#x"+t.toString(16).toUpperCase()+";"}function Ru(t){if(t===null||Ut(t)||$l(t))return 1;if(mb(t))return 2}function g_(t,e,r){const n=Ru(t),s=Ru(e);return n===void 0?s===void 0?r==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:n===1?s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}yU.peek=lye;function yU(t,e,r,n){const s=aye(r),i=r.enter("emphasis"),o=r.createTracker(n),a=o.move(s);let l=o.move(r.containerPhrasing(t,{after:s,before:a,...o.current()}));const c=l.charCodeAt(0),u=g_(n.before.charCodeAt(n.before.length-1),c,s);u.inside&&(l=xf(c)+l.slice(1));const h=l.charCodeAt(l.length-1),d=g_(n.after.charCodeAt(0),h,s);d.inside&&(l=l.slice(0,-1)+xf(h));const f=o.move(s);return i(),r.attentionEncodeSurroundingInfo={after:d.outside,before:u.outside},a+l+f}function lye(t,e,r){return r.options.emphasis||"*"}const cye={};function _k(t,e){const r=cye,n=typeof r.includeImageAlt=="boolean"?r.includeImageAlt:!0,s=typeof r.includeHtml=="boolean"?r.includeHtml:!0;return bU(t,n,s)}function bU(t,e,r){if(uye(t)){if("value"in t)return t.type==="html"&&!r?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return oO(t.children,e,r)}return Array.isArray(t)?oO(t,e,r):""}function oO(t,e,r){const n=[];let s=-1;for(;++s<t.length;)n[s]=bU(t[s],e,r);return n.join("")}function uye(t){return!!(t&&typeof t=="object")}function hye(t,e){let r=!1;return Rp(t,function(n){if("value"in n&&/\r?\n|\r/.test(n.value)||n.type==="break")return r=!0,Tx}),!!((!t.depth||t.depth<3)&&_k(t)&&(e.options.setext||r))}function dye(t,e,r,n){const s=Math.max(Math.min(6,t.depth||1),1),i=r.createTracker(n);if(hye(t,r)){const u=r.enter("headingSetext"),h=r.enter("phrasing"),d=r.containerPhrasing(t,{...i.current(),before:`
`,after:`
`});return h(),u(),d+`
`+(s===1?"=":"-").repeat(d.length-(Math.max(d.lastIndexOf("\r"),d.lastIndexOf(`
`))+1))}const o="#".repeat(s),a=r.enter("headingAtx"),l=r.enter("phrasing");i.move(o+" ");let c=r.containerPhrasing(t,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(c)&&(c=xf(c.charCodeAt(0))+c.slice(1)),c=c?o+" "+c:o,r.options.closeAtx&&(c+=" "+o),l(),a(),c}vU.peek=fye;function vU(t){return t.value||""}function fye(){return"<"}wU.peek=pye;function wU(t,e,r,n){const s=gk(r),i=s==='"'?"Quote":"Apostrophe",o=r.enter("image");let a=r.enter("label");const l=r.createTracker(n);let c=l.move("![");return c+=l.move(r.safe(t.alt,{before:c,after:"]",...l.current()})),c+=l.move("]("),a(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(a=r.enter("destinationLiteral"),c+=l.move("<"),c+=l.move(r.safe(t.url,{before:c,after:">",...l.current()})),c+=l.move(">")):(a=r.enter("destinationRaw"),c+=l.move(r.safe(t.url,{before:c,after:t.title?" ":")",...l.current()}))),a(),t.title&&(a=r.enter(`title${i}`),c+=l.move(" "+s),c+=l.move(r.safe(t.title,{before:c,after:s,...l.current()})),c+=l.move(s),a()),c+=l.move(")"),o(),c}function pye(){return"!"}EU.peek=mye;function EU(t,e,r,n){const s=t.referenceType,i=r.enter("imageReference");let o=r.enter("label");const a=r.createTracker(n);let l=a.move("![");const c=r.safe(t.alt,{before:l,after:"]",...a.current()});l+=a.move(c+"]["),o();const u=r.stack;r.stack=[],o=r.enter("reference");const h=r.safe(r.associationId(t),{before:l,after:"]",...a.current()});return o(),r.stack=u,i(),s==="full"||!c||c!==h?l+=a.move(h+"]"):s==="shortcut"?l=l.slice(0,-1):l+=a.move("]"),l}function mye(){return"!"}xU.peek=gye;function xU(t,e,r){let n=t.value||"",s="`",i=-1;for(;new RegExp("(^|[^`])"+s+"([^`]|$)").test(n);)s+="`";for(/[^ \r\n]/.test(n)&&(/^[ \r\n]/.test(n)&&/[ \r\n]$/.test(n)||/^`|`$/.test(n))&&(n=" "+n+" ");++i<r.unsafe.length;){const o=r.unsafe[i],a=r.compilePattern(o);let l;if(o.atBreak)for(;l=a.exec(n);){let c=l.index;n.charCodeAt(c)===10&&n.charCodeAt(c-1)===13&&c--,n=n.slice(0,c)+" "+n.slice(l.index+1)}}return s+n+s}function gye(){return"`"}function SU(t,e){const r=_k(t);return!!(!e.options.resourceLink&&t.url&&!t.title&&t.children&&t.children.length===1&&t.children[0].type==="text"&&(r===t.url||"mailto:"+r===t.url)&&/^[a-z][a-z+.-]+:/i.test(t.url)&&!/[\0- <>\u007F]/.test(t.url))}TU.peek=_ye;function TU(t,e,r,n){const s=gk(r),i=s==='"'?"Quote":"Apostrophe",o=r.createTracker(n);let a,l;if(SU(t,r)){const u=r.stack;r.stack=[],a=r.enter("autolink");let h=o.move("<");return h+=o.move(r.containerPhrasing(t,{before:h,after:">",...o.current()})),h+=o.move(">"),a(),r.stack=u,h}a=r.enter("link"),l=r.enter("label");let c=o.move("[");return c+=o.move(r.containerPhrasing(t,{before:c,after:"](",...o.current()})),c+=o.move("]("),l(),!t.url&&t.title||/[\0- \u007F]/.test(t.url)?(l=r.enter("destinationLiteral"),c+=o.move("<"),c+=o.move(r.safe(t.url,{before:c,after:">",...o.current()})),c+=o.move(">")):(l=r.enter("destinationRaw"),c+=o.move(r.safe(t.url,{before:c,after:t.title?" ":")",...o.current()}))),l(),t.title&&(l=r.enter(`title${i}`),c+=o.move(" "+s),c+=o.move(r.safe(t.title,{before:c,after:s,...o.current()})),c+=o.move(s),l()),c+=o.move(")"),a(),c}function _ye(t,e,r){return SU(t,r)?"<":"["}CU.peek=yye;function CU(t,e,r,n){const s=t.referenceType,i=r.enter("linkReference");let o=r.enter("label");const a=r.createTracker(n);let l=a.move("[");const c=r.containerPhrasing(t,{before:l,after:"]",...a.current()});l+=a.move(c+"]["),o();const u=r.stack;r.stack=[],o=r.enter("reference");const h=r.safe(r.associationId(t),{before:l,after:"]",...a.current()});return o(),r.stack=u,i(),s==="full"||!c||c!==h?l+=a.move(h+"]"):s==="shortcut"?l=l.slice(0,-1):l+=a.move("]"),l}function yye(){return"["}function yk(t){const e=t.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function bye(t){const e=yk(t),r=t.options.bulletOther;if(!r)return e==="*"?"-":"*";if(r!=="*"&&r!=="+"&&r!=="-")throw new Error("Cannot serialize items with `"+r+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(r===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+r+"`) to be different");return r}function vye(t){const e=t.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function kU(t){const e=t.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function wye(t,e,r,n){const s=r.enter("list"),i=r.bulletCurrent;let o=t.ordered?vye(r):yk(r);const a=t.ordered?o==="."?")":".":bye(r);let l=e&&r.bulletLastUsed?o===r.bulletLastUsed:!1;if(!t.ordered){const u=t.children?t.children[0]:void 0;if((o==="*"||o==="-")&&u&&(!u.children||!u.children[0])&&r.stack[r.stack.length-1]==="list"&&r.stack[r.stack.length-2]==="listItem"&&r.stack[r.stack.length-3]==="list"&&r.stack[r.stack.length-4]==="listItem"&&r.indexStack[r.indexStack.length-1]===0&&r.indexStack[r.indexStack.length-2]===0&&r.indexStack[r.indexStack.length-3]===0&&(l=!0),kU(r)===o&&u){let h=-1;for(;++h<t.children.length;){const d=t.children[h];if(d&&d.type==="listItem"&&d.children&&d.children[0]&&d.children[0].type==="thematicBreak"){l=!0;break}}}}l&&(o=a),r.bulletCurrent=o;const c=r.containerFlow(t,n);return r.bulletLastUsed=o,r.bulletCurrent=i,s(),c}function Eye(t){const e=t.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function xye(t,e,r,n){const s=Eye(r);let i=r.bulletCurrent||yk(r);e&&e.type==="list"&&e.ordered&&(i=(typeof e.start=="number"&&e.start>-1?e.start:1)+(r.options.incrementListMarker===!1?0:e.children.indexOf(t))+i);let o=i.length+1;(s==="tab"||s==="mixed"&&(e&&e.type==="list"&&e.spread||t.spread))&&(o=Math.ceil(o/4)*4);const a=r.createTracker(n);a.move(i+" ".repeat(o-i.length)),a.shift(o);const l=r.enter("listItem"),c=r.indentLines(r.containerFlow(t,a.current()),u);return l(),c;function u(h,d,f){return d?(f?"":" ".repeat(o))+h:(f?i:i+" ".repeat(o-i.length))+h}}function Sye(t,e,r,n){const s=r.enter("paragraph"),i=r.enter("phrasing"),o=r.containerPhrasing(t,n);return i(),s(),o}const Tye=fb(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function Cye(t,e,r,n){return(t.children.some(function(o){return Tye(o)})?r.containerPhrasing:r.containerFlow).call(r,t,n)}function kye(t){const e=t.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}AU.peek=Aye;function AU(t,e,r,n){const s=kye(r),i=r.enter("strong"),o=r.createTracker(n),a=o.move(s+s);let l=o.move(r.containerPhrasing(t,{after:s,before:a,...o.current()}));const c=l.charCodeAt(0),u=g_(n.before.charCodeAt(n.before.length-1),c,s);u.inside&&(l=xf(c)+l.slice(1));const h=l.charCodeAt(l.length-1),d=g_(n.after.charCodeAt(0),h,s);d.inside&&(l=l.slice(0,-1)+xf(h));const f=o.move(s+s);return i(),r.attentionEncodeSurroundingInfo={after:d.outside,before:u.outside},a+l+f}function Aye(t,e,r){return r.options.strong||"*"}function Rye(t,e,r,n){return r.safe(t.value,n)}function Iye(t){const e=t.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function Pye(t,e,r){const n=(kU(r)+(r.options.ruleSpaces?" ":"")).repeat(Iye(r));return r.options.ruleSpaces?n.slice(0,-1):n}const RU={blockquote:J_e,break:iO,code:sye,definition:oye,emphasis:yU,hardBreak:iO,heading:dye,html:vU,image:wU,imageReference:EU,inlineCode:xU,link:TU,linkReference:CU,list:wye,listItem:xye,paragraph:Sye,root:Cye,strong:AU,text:Rye,thematicBreak:Pye},aO=document.createElement("i");function bk(t){const e="&"+t+";";aO.innerHTML=e;const r=aO.textContent;return r.charCodeAt(r.length-1)===59&&t!=="semi"||r===e?!1:r}function IU(t,e){const r=Number.parseInt(t,e);return r<9||r===11||r>13&&r<32||r>126&&r<160||r>55295&&r<57344||r>64975&&r<65008||(r&65535)===65535||(r&65535)===65534||r>1114111?"�":String.fromCodePoint(r)}const Oye=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function Dye(t){return t.replace(Oye,Lye)}function Lye(t,e,r){if(e)return e;if(r.charCodeAt(0)===35){const s=r.charCodeAt(1),i=s===120||s===88;return IU(r.slice(i?2:1),i?16:10)}return bk(r)||t}function Nye(){return{enter:{table:Mye,tableData:lO,tableHeader:lO,tableRow:Fye},exit:{codeText:jye,table:Bye,tableData:yw,tableHeader:yw,tableRow:yw}}}function Mye(t){const e=t._align;this.enter({type:"table",align:e.map(function(r){return r==="none"?null:r}),children:[]},t),this.data.inTable=!0}function Bye(t){this.exit(t),this.data.inTable=void 0}function Fye(t){this.enter({type:"tableRow",children:[]},t)}function yw(t){this.exit(t)}function lO(t){this.enter({type:"tableCell",children:[]},t)}function jye(t){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,Uye));const r=this.stack[this.stack.length-1];r.type,r.value=e,this.exit(t)}function Uye(t,e){return e==="|"?e:t}function $ye(t){const e=t||{},r=e.tableCellPadding,n=e.tablePipeAlign,s=e.stringLength,i=r?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:d,table:o,tableCell:l,tableRow:a}};function o(f,g,_,m){return c(u(f,_,m),f.align)}function a(f,g,_,m){const p=h(f,_,m),y=c([p]);return y.slice(0,y.indexOf(`
`))}function l(f,g,_,m){const p=_.enter("tableCell"),y=_.enter("phrasing"),b=_.containerPhrasing(f,{...m,before:i,after:i});return y(),p(),b}function c(f,g){return X_e(f,{align:g,alignDelimiters:n,padding:r,stringLength:s})}function u(f,g,_){const m=f.children;let p=-1;const y=[],b=g.enter("table");for(;++p<m.length;)y[p]=h(m[p],g,_);return b(),y}function h(f,g,_){const m=f.children;let p=-1;const y=[],b=g.enter("tableRow");for(;++p<m.length;)y[p]=l(m[p],f,g,_);return b(),y}function d(f,g,_){let m=RU.inlineCode(f,g,_);return _.stack.includes("tableCell")&&(m=m.replace(/\|/g,"\\$&")),m}}function Hye(){return{exit:{taskListCheckValueChecked:cO,taskListCheckValueUnchecked:cO,paragraph:Vye}}}function zye(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:Gye}}}function cO(t){const e=this.stack[this.stack.length-2];e.type,e.checked=t.type==="taskListCheckValueChecked"}function Vye(t){const e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){const r=this.stack[this.stack.length-1];r.type;const n=r.children[0];if(n&&n.type==="text"){const s=e.children;let i=-1,o;for(;++i<s.length;){const a=s[i];if(a.type==="paragraph"){o=a;break}}o===r&&(n.value=n.value.slice(1),n.value.length===0?r.children.shift():r.position&&n.position&&typeof n.position.start.offset=="number"&&(n.position.start.column++,n.position.start.offset++,r.position.start=Object.assign({},n.position.start)))}}this.exit(t)}function Gye(t,e,r,n){const s=t.children[0],i=typeof t.checked=="boolean"&&s&&s.type==="paragraph",o="["+(t.checked?"x":" ")+"] ",a=r.createTracker(n);i&&a.move(o);let l=RU.listItem(t,e,r,{...n,...a.current()});return i&&(l=l.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,c)),l;function c(u){return u+o}}function Wye(){return[y_e(),I_e(),V_e(),Nye(),Hye()]}function qye(t){return{extensions:[b_e(),P_e(),G_e(),$ye(t),zye()]}}function Xn(t,e,r,n){const s=t.length;let i=0,o;if(e<0?e=-e>s?0:s+e:e=e>s?s:e,r=r>0?r:0,n.length<1e4)o=Array.from(n),o.unshift(e,r),t.splice(...o);else for(r&&t.splice(e,r);i<n.length;)o=n.slice(i,i+1e4),o.unshift(e,0),t.splice(...o),i+=1e4,e+=1e4}function fs(t,e){return t.length>0?(Xn(t,t.length,0,e),t):e}const uO={}.hasOwnProperty;function PU(t){const e={};let r=-1;for(;++r<t.length;)Kye(e,t[r]);return e}function Kye(t,e){let r;for(r in e){const s=(uO.call(t,r)?t[r]:void 0)||(t[r]={}),i=e[r];let o;if(i)for(o in i){uO.call(s,o)||(s[o]=[]);const a=i[o];Yye(s[o],Array.isArray(a)?a:a?[a]:[])}}}function Yye(t,e){let r=-1;const n=[];for(;++r<e.length;)(e[r].add==="after"?t:n).push(e[r]);Xn(t,0,0,n)}const Xye={tokenize:rbe,partial:!0},OU={tokenize:nbe,partial:!0},DU={tokenize:sbe,partial:!0},LU={tokenize:ibe,partial:!0},Zye={tokenize:obe,partial:!0},NU={name:"wwwAutolink",tokenize:ebe,previous:BU},MU={name:"protocolAutolink",tokenize:tbe,previous:FU},Lo={name:"emailAutolink",tokenize:Qye,previous:jU},Wi={};function Jye(){return{text:Wi}}let Ka=48;for(;Ka<123;)Wi[Ka]=Lo,Ka++,Ka===58?Ka=65:Ka===91&&(Ka=97);Wi[43]=Lo;Wi[45]=Lo;Wi[46]=Lo;Wi[95]=Lo;Wi[72]=[Lo,MU];Wi[104]=[Lo,MU];Wi[87]=[Lo,NU];Wi[119]=[Lo,NU];function Qye(t,e,r){const n=this;let s,i;return o;function o(h){return!kx(h)||!jU.call(n,n.previous)||vk(n.events)?r(h):(t.enter("literalAutolink"),t.enter("literalAutolinkEmail"),a(h))}function a(h){return kx(h)?(t.consume(h),a):h===64?(t.consume(h),l):r(h)}function l(h){return h===46?t.check(Zye,u,c)(h):h===45||h===95||Zr(h)?(i=!0,t.consume(h),l):u(h)}function c(h){return t.consume(h),s=!0,l}function u(h){return i&&s&&fn(n.previous)?(t.exit("literalAutolinkEmail"),t.exit("literalAutolink"),e(h)):r(h)}}function ebe(t,e,r){const n=this;return s;function s(o){return o!==87&&o!==119||!BU.call(n,n.previous)||vk(n.events)?r(o):(t.enter("literalAutolink"),t.enter("literalAutolinkWww"),t.check(Xye,t.attempt(OU,t.attempt(DU,i),r),r)(o))}function i(o){return t.exit("literalAutolinkWww"),t.exit("literalAutolink"),e(o)}}function tbe(t,e,r){const n=this;let s="",i=!1;return o;function o(h){return(h===72||h===104)&&FU.call(n,n.previous)&&!vk(n.events)?(t.enter("literalAutolink"),t.enter("literalAutolinkHttp"),s+=String.fromCodePoint(h),t.consume(h),a):r(h)}function a(h){if(fn(h)&&s.length<5)return s+=String.fromCodePoint(h),t.consume(h),a;if(h===58){const d=s.toLowerCase();if(d==="http"||d==="https")return t.consume(h),l}return r(h)}function l(h){return h===47?(t.consume(h),i?c:(i=!0,l)):r(h)}function c(h){return h===null||m_(h)||Ut(h)||$l(h)||mb(h)?r(h):t.attempt(OU,t.attempt(DU,u),r)(h)}function u(h){return t.exit("literalAutolinkHttp"),t.exit("literalAutolink"),e(h)}}function rbe(t,e,r){let n=0;return s;function s(o){return(o===87||o===119)&&n<3?(n++,t.consume(o),s):o===46&&n===3?(t.consume(o),i):r(o)}function i(o){return o===null?r(o):e(o)}}function nbe(t,e,r){let n,s,i;return o;function o(c){return c===46||c===95?t.check(LU,l,a)(c):c===null||Ut(c)||$l(c)||c!==45&&mb(c)?l(c):(i=!0,t.consume(c),o)}function a(c){return c===95?n=!0:(s=n,n=void 0),t.consume(c),o}function l(c){return s||n||!i?r(c):e(c)}}function sbe(t,e){let r=0,n=0;return s;function s(o){return o===40?(r++,t.consume(o),s):o===41&&n<r?i(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?t.check(LU,e,i)(o):o===null||Ut(o)||$l(o)?e(o):(t.consume(o),s)}function i(o){return o===41&&n++,t.consume(o),s}}function ibe(t,e,r){return n;function n(a){return a===33||a===34||a===39||a===41||a===42||a===44||a===46||a===58||a===59||a===63||a===95||a===126?(t.consume(a),n):a===38?(t.consume(a),i):a===93?(t.consume(a),s):a===60||a===null||Ut(a)||$l(a)?e(a):r(a)}function s(a){return a===null||a===40||a===91||Ut(a)||$l(a)?e(a):n(a)}function i(a){return fn(a)?o(a):r(a)}function o(a){return a===59?(t.consume(a),n):fn(a)?(t.consume(a),o):r(a)}}function obe(t,e,r){return n;function n(i){return t.consume(i),s}function s(i){return Zr(i)?r(i):e(i)}}function BU(t){return t===null||t===40||t===42||t===95||t===91||t===93||t===126||Ut(t)}function FU(t){return!fn(t)}function jU(t){return!(t===47||kx(t))}function kx(t){return t===43||t===45||t===46||t===95||Zr(t)}function vk(t){let e=t.length,r=!1;for(;e--;){const n=t[e][1];if((n.type==="labelLink"||n.type==="labelImage")&&!n._balanced){r=!0;break}if(n._gfmAutolinkLiteralWalkedInto){r=!1;break}}return t.length>0&&!r&&(t[t.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),r}function lh(t){const e=[];let r=-1,n=0,s=0;for(;++r<t.length;){const i=t.charCodeAt(r);let o="";if(i===37&&Zr(t.charCodeAt(r+1))&&Zr(t.charCodeAt(r+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(o=String.fromCharCode(i));else if(i>55295&&i<57344){const a=t.charCodeAt(r+1);i<56320&&a>56319&&a<57344?(o=String.fromCharCode(i,a),s=1):o="�"}else o=String.fromCharCode(i);o&&(e.push(t.slice(n,r),encodeURIComponent(o)),n=r+s+1,o=""),s&&(r+=s,s=0)}return e.join("")+t.slice(n)}function gb(t,e,r){const n=[];let s=-1;for(;++s<t.length;){const i=t[s].resolveAll;i&&!n.includes(i)&&(e=i(e,r),n.push(i))}return e}const Ax={name:"attention",resolveAll:abe,tokenize:lbe};function abe(t,e){let r=-1,n,s,i,o,a,l,c,u;for(;++r<t.length;)if(t[r][0]==="enter"&&t[r][1].type==="attentionSequence"&&t[r][1]._close){for(n=r;n--;)if(t[n][0]==="exit"&&t[n][1].type==="attentionSequence"&&t[n][1]._open&&e.sliceSerialize(t[n][1]).charCodeAt(0)===e.sliceSerialize(t[r][1]).charCodeAt(0)){if((t[n][1]._close||t[r][1]._open)&&(t[r][1].end.offset-t[r][1].start.offset)%3&&!((t[n][1].end.offset-t[n][1].start.offset+t[r][1].end.offset-t[r][1].start.offset)%3))continue;l=t[n][1].end.offset-t[n][1].start.offset>1&&t[r][1].end.offset-t[r][1].start.offset>1?2:1;const h={...t[n][1].end},d={...t[r][1].start};hO(h,-l),hO(d,l),o={type:l>1?"strongSequence":"emphasisSequence",start:h,end:{...t[n][1].end}},a={type:l>1?"strongSequence":"emphasisSequence",start:{...t[r][1].start},end:d},i={type:l>1?"strongText":"emphasisText",start:{...t[n][1].end},end:{...t[r][1].start}},s={type:l>1?"strong":"emphasis",start:{...o.start},end:{...a.end}},t[n][1].end={...o.start},t[r][1].start={...a.end},c=[],t[n][1].end.offset-t[n][1].start.offset&&(c=fs(c,[["enter",t[n][1],e],["exit",t[n][1],e]])),c=fs(c,[["enter",s,e],["enter",o,e],["exit",o,e],["enter",i,e]]),c=fs(c,gb(e.parser.constructs.insideSpan.null,t.slice(n+1,r),e)),c=fs(c,[["exit",i,e],["enter",a,e],["exit",a,e],["exit",s,e]]),t[r][1].end.offset-t[r][1].start.offset?(u=2,c=fs(c,[["enter",t[r][1],e],["exit",t[r][1],e]])):u=0,Xn(t,n-1,r-n+3,c),r=n+c.length-u-2;break}}for(r=-1;++r<t.length;)t[r][1].type==="attentionSequence"&&(t[r][1].type="data");return t}function lbe(t,e){const r=this.parser.constructs.attentionMarkers.null,n=this.previous,s=Ru(n);let i;return o;function o(l){return i=l,t.enter("attentionSequence"),a(l)}function a(l){if(l===i)return t.consume(l),a;const c=t.exit("attentionSequence"),u=Ru(l),h=!u||u===2&&s||r.includes(l),d=!s||s===2&&u||r.includes(n);return c._open=!!(i===42?h:h&&(s||!d)),c._close=!!(i===42?d:d&&(u||!h)),e(l)}}function hO(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const cbe={name:"autolink",tokenize:ube};function ube(t,e,r){let n=0;return s;function s(f){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(f),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),i}function i(f){return fn(f)?(t.consume(f),o):f===64?r(f):c(f)}function o(f){return f===43||f===45||f===46||Zr(f)?(n=1,a(f)):c(f)}function a(f){return f===58?(t.consume(f),n=0,l):(f===43||f===45||f===46||Zr(f))&&n++<32?(t.consume(f),a):(n=0,c(f))}function l(f){return f===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(f),t.exit("autolinkMarker"),t.exit("autolink"),e):f===null||f===32||f===60||m_(f)?r(f):(t.consume(f),l)}function c(f){return f===64?(t.consume(f),u):u_e(f)?(t.consume(f),c):r(f)}function u(f){return Zr(f)?h(f):r(f)}function h(f){return f===46?(t.consume(f),n=0,u):f===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(f),t.exit("autolinkMarker"),t.exit("autolink"),e):d(f)}function d(f){if((f===45||Zr(f))&&n++<63){const g=f===45?d:h;return t.consume(f),g}return r(f)}}function xt(t,e,r,n){const s=n?n-1:Number.POSITIVE_INFINITY;let i=0;return o;function o(l){return pt(l)?(t.enter(r),a(l)):e(l)}function a(l){return pt(l)&&i++<s?(t.consume(l),a):(t.exit(r),e(l))}}const Pp={partial:!0,tokenize:hbe};function hbe(t,e,r){return n;function n(i){return pt(i)?xt(t,s,"linePrefix")(i):s(i)}function s(i){return i===null||Qe(i)?e(i):r(i)}}const UU={continuation:{tokenize:fbe},exit:pbe,name:"blockQuote",tokenize:dbe};function dbe(t,e,r){const n=this;return s;function s(o){if(o===62){const a=n.containerState;return a.open||(t.enter("blockQuote",{_container:!0}),a.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(o),t.exit("blockQuoteMarker"),i}return r(o)}function i(o){return pt(o)?(t.enter("blockQuotePrefixWhitespace"),t.consume(o),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(o))}}function fbe(t,e,r){const n=this;return s;function s(o){return pt(o)?xt(t,i,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):i(o)}function i(o){return t.attempt(UU,e,r)(o)}}function pbe(t){t.exit("blockQuote")}const $U={name:"characterEscape",tokenize:mbe};function mbe(t,e,r){return n;function n(i){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(i),t.exit("escapeMarker"),s}function s(i){return d_e(i)?(t.enter("characterEscapeValue"),t.consume(i),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):r(i)}}const HU={name:"characterReference",tokenize:gbe};function gbe(t,e,r){const n=this;let s=0,i,o;return a;function a(h){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),l}function l(h){return h===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(h),t.exit("characterReferenceMarkerNumeric"),c):(t.enter("characterReferenceValue"),i=31,o=Zr,u(h))}function c(h){return h===88||h===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(h),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),i=6,o=h_e,u):(t.enter("characterReferenceValue"),i=7,o=Cx,u(h))}function u(h){if(h===59&&s){const d=t.exit("characterReferenceValue");return o===Zr&&!bk(n.sliceSerialize(d))?r(h):(t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return o(h)&&s++<i?(t.consume(h),u):r(h)}}const dO={partial:!0,tokenize:ybe},fO={concrete:!0,name:"codeFenced",tokenize:_be};function _be(t,e,r){const n=this,s={partial:!0,tokenize:w};let i=0,o=0,a;return l;function l(E){return c(E)}function c(E){const S=n.events[n.events.length-1];return i=S&&S[1].type==="linePrefix"?S[2].sliceSerialize(S[1],!0).length:0,a=E,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),u(E)}function u(E){return E===a?(o++,t.consume(E),u):o<3?r(E):(t.exit("codeFencedFenceSequence"),pt(E)?xt(t,h,"whitespace")(E):h(E))}function h(E){return E===null||Qe(E)?(t.exit("codeFencedFence"),n.interrupt?e(E):t.check(dO,_,v)(E)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),d(E))}function d(E){return E===null||Qe(E)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),h(E)):pt(E)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),xt(t,f,"whitespace")(E)):E===96&&E===a?r(E):(t.consume(E),d)}function f(E){return E===null||Qe(E)?h(E):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),g(E))}function g(E){return E===null||Qe(E)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),h(E)):E===96&&E===a?r(E):(t.consume(E),g)}function _(E){return t.attempt(s,v,m)(E)}function m(E){return t.enter("lineEnding"),t.consume(E),t.exit("lineEnding"),p}function p(E){return i>0&&pt(E)?xt(t,y,"linePrefix",i+1)(E):y(E)}function y(E){return E===null||Qe(E)?t.check(dO,_,v)(E):(t.enter("codeFlowValue"),b(E))}function b(E){return E===null||Qe(E)?(t.exit("codeFlowValue"),y(E)):(t.consume(E),b)}function v(E){return t.exit("codeFenced"),e(E)}function w(E,S,x){let C=0;return A;function A(G){return E.enter("lineEnding"),E.consume(G),E.exit("lineEnding"),M}function M(G){return E.enter("codeFencedFence"),pt(G)?xt(E,P,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(G):P(G)}function P(G){return G===a?(E.enter("codeFencedFenceSequence"),D(G)):x(G)}function D(G){return G===a?(C++,E.consume(G),D):C>=o?(E.exit("codeFencedFenceSequence"),pt(G)?xt(E,R,"whitespace")(G):R(G)):x(G)}function R(G){return G===null||Qe(G)?(E.exit("codeFencedFence"),S(G)):x(G)}}}function ybe(t,e,r){const n=this;return s;function s(o){return o===null?r(o):(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i)}function i(o){return n.parser.lazy[n.now().line]?r(o):e(o)}}const bw={name:"codeIndented",tokenize:vbe},bbe={partial:!0,tokenize:wbe};function vbe(t,e,r){const n=this;return s;function s(c){return t.enter("codeIndented"),xt(t,i,"linePrefix",5)(c)}function i(c){const u=n.events[n.events.length-1];return u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?o(c):r(c)}function o(c){return c===null?l(c):Qe(c)?t.attempt(bbe,o,l)(c):(t.enter("codeFlowValue"),a(c))}function a(c){return c===null||Qe(c)?(t.exit("codeFlowValue"),o(c)):(t.consume(c),a)}function l(c){return t.exit("codeIndented"),e(c)}}function wbe(t,e,r){const n=this;return s;function s(o){return n.parser.lazy[n.now().line]?r(o):Qe(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),s):xt(t,i,"linePrefix",5)(o)}function i(o){const a=n.events[n.events.length-1];return a&&a[1].type==="linePrefix"&&a[2].sliceSerialize(a[1],!0).length>=4?e(o):Qe(o)?s(o):r(o)}}const Ebe={name:"codeText",previous:Sbe,resolve:xbe,tokenize:Tbe};function xbe(t){let e=t.length-4,r=3,n,s;if((t[r][1].type==="lineEnding"||t[r][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(n=r;++n<e;)if(t[n][1].type==="codeTextData"){t[r][1].type="codeTextPadding",t[e][1].type="codeTextPadding",r+=2,e-=2;break}}for(n=r-1,e++;++n<=e;)s===void 0?n!==e&&t[n][1].type!=="lineEnding"&&(s=n):(n===e||t[n][1].type==="lineEnding")&&(t[s][1].type="codeTextData",n!==s+2&&(t[s][1].end=t[n-1][1].end,t.splice(s+2,n-s-2),e-=n-s-2,n=s+2),s=void 0);return t}function Sbe(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Tbe(t,e,r){let n=0,s,i;return o;function o(h){return t.enter("codeText"),t.enter("codeTextSequence"),a(h)}function a(h){return h===96?(t.consume(h),n++,a):(t.exit("codeTextSequence"),l(h))}function l(h){return h===null?r(h):h===32?(t.enter("space"),t.consume(h),t.exit("space"),l):h===96?(i=t.enter("codeTextSequence"),s=0,u(h)):Qe(h)?(t.enter("lineEnding"),t.consume(h),t.exit("lineEnding"),l):(t.enter("codeTextData"),c(h))}function c(h){return h===null||h===32||h===96||Qe(h)?(t.exit("codeTextData"),l(h)):(t.consume(h),c)}function u(h){return h===96?(t.consume(h),s++,u):s===n?(t.exit("codeTextSequence"),t.exit("codeText"),e(h)):(i.type="codeTextData",c(h))}}class Cbe{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,r){const n=r??Number.POSITIVE_INFINITY;return n<this.left.length?this.left.slice(e,n):e>this.left.length?this.right.slice(this.right.length-n+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-n+this.left.length).reverse())}splice(e,r,n){const s=r||0;this.setCursor(Math.trunc(e));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return n&&Mh(this.left,n),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),Mh(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),Mh(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const r=this.left.splice(e,Number.POSITIVE_INFINITY);Mh(this.right,r.reverse())}else{const r=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);Mh(this.left,r.reverse())}}}function Mh(t,e){let r=0;if(e.length<1e4)t.push(...e);else for(;r<e.length;)t.push(...e.slice(r,r+1e4)),r+=1e4}function zU(t){const e={};let r=-1,n,s,i,o,a,l,c;const u=new Cbe(t);for(;++r<u.length;){for(;r in e;)r=e[r];if(n=u.get(r),r&&n[1].type==="chunkFlow"&&u.get(r-1)[1].type==="listItemPrefix"&&(l=n[1]._tokenizer.events,i=0,i<l.length&&l[i][1].type==="lineEndingBlank"&&(i+=2),i<l.length&&l[i][1].type==="content"))for(;++i<l.length&&l[i][1].type!=="content";)l[i][1].type==="chunkText"&&(l[i][1]._isInFirstContentOfListItem=!0,i++);if(n[0]==="enter")n[1].contentType&&(Object.assign(e,kbe(u,r)),r=e[r],c=!0);else if(n[1]._container){for(i=r,s=void 0;i--&&(o=u.get(i),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank");)o[0]==="enter"&&(s&&(u.get(s)[1].type="lineEndingBlank"),o[1].type="lineEnding",s=i);s&&(n[1].end={...u.get(s)[1].start},a=u.slice(s,r),a.unshift(n),u.splice(s,r-s+1,a))}}return Xn(t,0,Number.POSITIVE_INFINITY,u.slice(0)),!c}function kbe(t,e){const r=t.get(e)[1],n=t.get(e)[2];let s=e-1;const i=[],o=r._tokenizer||n.parser[r.contentType](r.start),a=o.events,l=[],c={};let u,h,d=-1,f=r,g=0,_=0;const m=[_];for(;f;){for(;t.get(++s)[1]!==f;);i.push(s),f._tokenizer||(u=n.sliceStream(f),f.next||u.push(null),h&&o.defineSkip(f.start),f._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(u),f._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),h=f,f=f.next}for(f=r;++d<a.length;)a[d][0]==="exit"&&a[d-1][0]==="enter"&&a[d][1].type===a[d-1][1].type&&a[d][1].start.line!==a[d][1].end.line&&(_=d+1,m.push(_),f._tokenizer=void 0,f.previous=void 0,f=f.next);for(o.events=[],f?(f._tokenizer=void 0,f.previous=void 0):m.pop(),d=m.length;d--;){const p=a.slice(m[d],m[d+1]),y=i.pop();l.push([y,y+p.length-1]),t.splice(y,2,p)}for(l.reverse(),d=-1;++d<l.length;)c[g+l[d][0]]=g+l[d][1],g+=l[d][1]-l[d][0]-1;return c}const Abe={resolve:Ibe,tokenize:Pbe},Rbe={partial:!0,tokenize:Obe};function Ibe(t){return zU(t),t}function Pbe(t,e){let r;return n;function n(a){return t.enter("content"),r=t.enter("chunkContent",{contentType:"content"}),s(a)}function s(a){return a===null?i(a):Qe(a)?t.check(Rbe,o,i)(a):(t.consume(a),s)}function i(a){return t.exit("chunkContent"),t.exit("content"),e(a)}function o(a){return t.consume(a),t.exit("chunkContent"),r.next=t.enter("chunkContent",{contentType:"content",previous:r}),r=r.next,s}}function Obe(t,e,r){const n=this;return s;function s(o){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),xt(t,i,"linePrefix")}function i(o){if(o===null||Qe(o))return r(o);const a=n.events[n.events.length-1];return!n.parser.constructs.disable.null.includes("codeIndented")&&a&&a[1].type==="linePrefix"&&a[2].sliceSerialize(a[1],!0).length>=4?e(o):t.interrupt(n.parser.constructs.flow,r,e)(o)}}function VU(t,e,r,n,s,i,o,a,l){const c=l||Number.POSITIVE_INFINITY;let u=0;return h;function h(p){return p===60?(t.enter(n),t.enter(s),t.enter(i),t.consume(p),t.exit(i),d):p===null||p===32||p===41||m_(p)?r(p):(t.enter(n),t.enter(o),t.enter(a),t.enter("chunkString",{contentType:"string"}),_(p))}function d(p){return p===62?(t.enter(i),t.consume(p),t.exit(i),t.exit(s),t.exit(n),e):(t.enter(a),t.enter("chunkString",{contentType:"string"}),f(p))}function f(p){return p===62?(t.exit("chunkString"),t.exit(a),d(p)):p===null||p===60||Qe(p)?r(p):(t.consume(p),p===92?g:f)}function g(p){return p===60||p===62||p===92?(t.consume(p),f):f(p)}function _(p){return!u&&(p===null||p===41||Ut(p))?(t.exit("chunkString"),t.exit(a),t.exit(o),t.exit(n),e(p)):u<c&&p===40?(t.consume(p),u++,_):p===41?(t.consume(p),u--,_):p===null||p===32||p===40||m_(p)?r(p):(t.consume(p),p===92?m:_)}function m(p){return p===40||p===41||p===92?(t.consume(p),_):_(p)}}function GU(t,e,r,n,s,i){const o=this;let a=0,l;return c;function c(f){return t.enter(n),t.enter(s),t.consume(f),t.exit(s),t.enter(i),u}function u(f){return a>999||f===null||f===91||f===93&&!l||f===94&&!a&&"_hiddenFootnoteSupport"in o.parser.constructs?r(f):f===93?(t.exit(i),t.enter(s),t.consume(f),t.exit(s),t.exit(n),e):Qe(f)?(t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),u):(t.enter("chunkString",{contentType:"string"}),h(f))}function h(f){return f===null||f===91||f===93||Qe(f)||a++>999?(t.exit("chunkString"),u(f)):(t.consume(f),l||(l=!pt(f)),f===92?d:h)}function d(f){return f===91||f===92||f===93?(t.consume(f),a++,h):h(f)}}function WU(t,e,r,n,s,i){let o;return a;function a(d){return d===34||d===39||d===40?(t.enter(n),t.enter(s),t.consume(d),t.exit(s),o=d===40?41:d,l):r(d)}function l(d){return d===o?(t.enter(s),t.consume(d),t.exit(s),t.exit(n),e):(t.enter(i),c(d))}function c(d){return d===o?(t.exit(i),l(o)):d===null?r(d):Qe(d)?(t.enter("lineEnding"),t.consume(d),t.exit("lineEnding"),xt(t,c,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),u(d))}function u(d){return d===o||d===null||Qe(d)?(t.exit("chunkString"),c(d)):(t.consume(d),d===92?h:u)}function h(d){return d===o||d===92?(t.consume(d),u):u(d)}}function Pd(t,e){let r;return n;function n(s){return Qe(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),r=!0,n):pt(s)?xt(t,n,r?"linePrefix":"lineSuffix")(s):e(s)}}const Dbe={name:"definition",tokenize:Nbe},Lbe={partial:!0,tokenize:Mbe};function Nbe(t,e,r){const n=this;let s;return i;function i(f){return t.enter("definition"),o(f)}function o(f){return GU.call(n,t,a,r,"definitionLabel","definitionLabelMarker","definitionLabelString")(f)}function a(f){return s=Bs(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)),f===58?(t.enter("definitionMarker"),t.consume(f),t.exit("definitionMarker"),l):r(f)}function l(f){return Ut(f)?Pd(t,c)(f):c(f)}function c(f){return VU(t,u,r,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(f)}function u(f){return t.attempt(Lbe,h,h)(f)}function h(f){return pt(f)?xt(t,d,"whitespace")(f):d(f)}function d(f){return f===null||Qe(f)?(t.exit("definition"),n.parser.defined.push(s),e(f)):r(f)}}function Mbe(t,e,r){return n;function n(a){return Ut(a)?Pd(t,s)(a):r(a)}function s(a){return WU(t,i,r,"definitionTitle","definitionTitleMarker","definitionTitleString")(a)}function i(a){return pt(a)?xt(t,o,"whitespace")(a):o(a)}function o(a){return a===null||Qe(a)?e(a):r(a)}}const Bbe={name:"hardBreakEscape",tokenize:Fbe};function Fbe(t,e,r){return n;function n(i){return t.enter("hardBreakEscape"),t.consume(i),s}function s(i){return Qe(i)?(t.exit("hardBreakEscape"),e(i)):r(i)}}const jbe={name:"headingAtx",resolve:Ube,tokenize:$be};function Ube(t,e){let r=t.length-2,n=3,s,i;return t[n][1].type==="whitespace"&&(n+=2),r-2>n&&t[r][1].type==="whitespace"&&(r-=2),t[r][1].type==="atxHeadingSequence"&&(n===r-1||r-4>n&&t[r-2][1].type==="whitespace")&&(r-=n+1===r?2:4),r>n&&(s={type:"atxHeadingText",start:t[n][1].start,end:t[r][1].end},i={type:"chunkText",start:t[n][1].start,end:t[r][1].end,contentType:"text"},Xn(t,n,r-n+1,[["enter",s,e],["enter",i,e],["exit",i,e],["exit",s,e]])),t}function $be(t,e,r){let n=0;return s;function s(u){return t.enter("atxHeading"),i(u)}function i(u){return t.enter("atxHeadingSequence"),o(u)}function o(u){return u===35&&n++<6?(t.consume(u),o):u===null||Ut(u)?(t.exit("atxHeadingSequence"),a(u)):r(u)}function a(u){return u===35?(t.enter("atxHeadingSequence"),l(u)):u===null||Qe(u)?(t.exit("atxHeading"),e(u)):pt(u)?xt(t,a,"whitespace")(u):(t.enter("atxHeadingText"),c(u))}function l(u){return u===35?(t.consume(u),l):(t.exit("atxHeadingSequence"),a(u))}function c(u){return u===null||u===35||Ut(u)?(t.exit("atxHeadingText"),a(u)):(t.consume(u),c)}}const Hbe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],pO=["pre","script","style","textarea"],zbe={concrete:!0,name:"htmlFlow",resolveTo:Wbe,tokenize:qbe},Vbe={partial:!0,tokenize:Ybe},Gbe={partial:!0,tokenize:Kbe};function Wbe(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function qbe(t,e,r){const n=this;let s,i,o,a,l;return c;function c(U){return u(U)}function u(U){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(U),h}function h(U){return U===33?(t.consume(U),d):U===47?(t.consume(U),i=!0,_):U===63?(t.consume(U),s=3,n.interrupt?e:B):fn(U)?(t.consume(U),o=String.fromCharCode(U),m):r(U)}function d(U){return U===45?(t.consume(U),s=2,f):U===91?(t.consume(U),s=5,a=0,g):fn(U)?(t.consume(U),s=4,n.interrupt?e:B):r(U)}function f(U){return U===45?(t.consume(U),n.interrupt?e:B):r(U)}function g(U){const Q="CDATA[";return U===Q.charCodeAt(a++)?(t.consume(U),a===Q.length?n.interrupt?e:P:g):r(U)}function _(U){return fn(U)?(t.consume(U),o=String.fromCharCode(U),m):r(U)}function m(U){if(U===null||U===47||U===62||Ut(U)){const Q=U===47,ne=o.toLowerCase();return!Q&&!i&&pO.includes(ne)?(s=1,n.interrupt?e(U):P(U)):Hbe.includes(o.toLowerCase())?(s=6,Q?(t.consume(U),p):n.interrupt?e(U):P(U)):(s=7,n.interrupt&&!n.parser.lazy[n.now().line]?r(U):i?y(U):b(U))}return U===45||Zr(U)?(t.consume(U),o+=String.fromCharCode(U),m):r(U)}function p(U){return U===62?(t.consume(U),n.interrupt?e:P):r(U)}function y(U){return pt(U)?(t.consume(U),y):A(U)}function b(U){return U===47?(t.consume(U),A):U===58||U===95||fn(U)?(t.consume(U),v):pt(U)?(t.consume(U),b):A(U)}function v(U){return U===45||U===46||U===58||U===95||Zr(U)?(t.consume(U),v):w(U)}function w(U){return U===61?(t.consume(U),E):pt(U)?(t.consume(U),w):b(U)}function E(U){return U===null||U===60||U===61||U===62||U===96?r(U):U===34||U===39?(t.consume(U),l=U,S):pt(U)?(t.consume(U),E):x(U)}function S(U){return U===l?(t.consume(U),l=null,C):U===null||Qe(U)?r(U):(t.consume(U),S)}function x(U){return U===null||U===34||U===39||U===47||U===60||U===61||U===62||U===96||Ut(U)?w(U):(t.consume(U),x)}function C(U){return U===47||U===62||pt(U)?b(U):r(U)}function A(U){return U===62?(t.consume(U),M):r(U)}function M(U){return U===null||Qe(U)?P(U):pt(U)?(t.consume(U),M):r(U)}function P(U){return U===45&&s===2?(t.consume(U),ee):U===60&&s===1?(t.consume(U),q):U===62&&s===4?(t.consume(U),$):U===63&&s===3?(t.consume(U),B):U===93&&s===5?(t.consume(U),N):Qe(U)&&(s===6||s===7)?(t.exit("htmlFlowData"),t.check(Vbe,H,D)(U)):U===null||Qe(U)?(t.exit("htmlFlowData"),D(U)):(t.consume(U),P)}function D(U){return t.check(Gbe,R,H)(U)}function R(U){return t.enter("lineEnding"),t.consume(U),t.exit("lineEnding"),G}function G(U){return U===null||Qe(U)?D(U):(t.enter("htmlFlowData"),P(U))}function ee(U){return U===45?(t.consume(U),B):P(U)}function q(U){return U===47?(t.consume(U),o="",re):P(U)}function re(U){if(U===62){const Q=o.toLowerCase();return pO.includes(Q)?(t.consume(U),$):P(U)}return fn(U)&&o.length<8?(t.consume(U),o+=String.fromCharCode(U),re):P(U)}function N(U){return U===93?(t.consume(U),B):P(U)}function B(U){return U===62?(t.consume(U),$):U===45&&s===2?(t.consume(U),B):P(U)}function $(U){return U===null||Qe(U)?(t.exit("htmlFlowData"),H(U)):(t.consume(U),$)}function H(U){return t.exit("htmlFlow"),e(U)}}function Kbe(t,e,r){const n=this;return s;function s(o){return Qe(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i):r(o)}function i(o){return n.parser.lazy[n.now().line]?r(o):e(o)}}function Ybe(t,e,r){return n;function n(s){return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),t.attempt(Pp,e,r)}}const Xbe={name:"htmlText",tokenize:Zbe};function Zbe(t,e,r){const n=this;let s,i,o;return a;function a(B){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(B),l}function l(B){return B===33?(t.consume(B),c):B===47?(t.consume(B),w):B===63?(t.consume(B),b):fn(B)?(t.consume(B),x):r(B)}function c(B){return B===45?(t.consume(B),u):B===91?(t.consume(B),i=0,g):fn(B)?(t.consume(B),y):r(B)}function u(B){return B===45?(t.consume(B),f):r(B)}function h(B){return B===null?r(B):B===45?(t.consume(B),d):Qe(B)?(o=h,q(B)):(t.consume(B),h)}function d(B){return B===45?(t.consume(B),f):h(B)}function f(B){return B===62?ee(B):B===45?d(B):h(B)}function g(B){const $="CDATA[";return B===$.charCodeAt(i++)?(t.consume(B),i===$.length?_:g):r(B)}function _(B){return B===null?r(B):B===93?(t.consume(B),m):Qe(B)?(o=_,q(B)):(t.consume(B),_)}function m(B){return B===93?(t.consume(B),p):_(B)}function p(B){return B===62?ee(B):B===93?(t.consume(B),p):_(B)}function y(B){return B===null||B===62?ee(B):Qe(B)?(o=y,q(B)):(t.consume(B),y)}function b(B){return B===null?r(B):B===63?(t.consume(B),v):Qe(B)?(o=b,q(B)):(t.consume(B),b)}function v(B){return B===62?ee(B):b(B)}function w(B){return fn(B)?(t.consume(B),E):r(B)}function E(B){return B===45||Zr(B)?(t.consume(B),E):S(B)}function S(B){return Qe(B)?(o=S,q(B)):pt(B)?(t.consume(B),S):ee(B)}function x(B){return B===45||Zr(B)?(t.consume(B),x):B===47||B===62||Ut(B)?C(B):r(B)}function C(B){return B===47?(t.consume(B),ee):B===58||B===95||fn(B)?(t.consume(B),A):Qe(B)?(o=C,q(B)):pt(B)?(t.consume(B),C):ee(B)}function A(B){return B===45||B===46||B===58||B===95||Zr(B)?(t.consume(B),A):M(B)}function M(B){return B===61?(t.consume(B),P):Qe(B)?(o=M,q(B)):pt(B)?(t.consume(B),M):C(B)}function P(B){return B===null||B===60||B===61||B===62||B===96?r(B):B===34||B===39?(t.consume(B),s=B,D):Qe(B)?(o=P,q(B)):pt(B)?(t.consume(B),P):(t.consume(B),R)}function D(B){return B===s?(t.consume(B),s=void 0,G):B===null?r(B):Qe(B)?(o=D,q(B)):(t.consume(B),D)}function R(B){return B===null||B===34||B===39||B===60||B===61||B===96?r(B):B===47||B===62||Ut(B)?C(B):(t.consume(B),R)}function G(B){return B===47||B===62||Ut(B)?C(B):r(B)}function ee(B){return B===62?(t.consume(B),t.exit("htmlTextData"),t.exit("htmlText"),e):r(B)}function q(B){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(B),t.exit("lineEnding"),re}function re(B){return pt(B)?xt(t,N,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(B):N(B)}function N(B){return t.enter("htmlTextData"),o(B)}}const wk={name:"labelEnd",resolveAll:tve,resolveTo:rve,tokenize:nve},Jbe={tokenize:sve},Qbe={tokenize:ive},eve={tokenize:ove};function tve(t){let e=-1;const r=[];for(;++e<t.length;){const n=t[e][1];if(r.push(t[e]),n.type==="labelImage"||n.type==="labelLink"||n.type==="labelEnd"){const s=n.type==="labelImage"?4:2;n.type="data",e+=s}}return t.length!==r.length&&Xn(t,0,t.length,r),t}function rve(t,e){let r=t.length,n=0,s,i,o,a;for(;r--;)if(s=t[r][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;t[r][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(o){if(t[r][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=r,s.type!=="labelLink")){n=2;break}}else s.type==="labelEnd"&&(o=r);const l={type:t[i][1].type==="labelLink"?"link":"image",start:{...t[i][1].start},end:{...t[t.length-1][1].end}},c={type:"label",start:{...t[i][1].start},end:{...t[o][1].end}},u={type:"labelText",start:{...t[i+n+2][1].end},end:{...t[o-2][1].start}};return a=[["enter",l,e],["enter",c,e]],a=fs(a,t.slice(i+1,i+n+3)),a=fs(a,[["enter",u,e]]),a=fs(a,gb(e.parser.constructs.insideSpan.null,t.slice(i+n+4,o-3),e)),a=fs(a,[["exit",u,e],t[o-2],t[o-1],["exit",c,e]]),a=fs(a,t.slice(o+1)),a=fs(a,[["exit",l,e]]),Xn(t,i,t.length,a),t}function nve(t,e,r){const n=this;let s=n.events.length,i,o;for(;s--;)if((n.events[s][1].type==="labelImage"||n.events[s][1].type==="labelLink")&&!n.events[s][1]._balanced){i=n.events[s][1];break}return a;function a(d){return i?i._inactive?h(d):(o=n.parser.defined.includes(Bs(n.sliceSerialize({start:i.end,end:n.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(d),t.exit("labelMarker"),t.exit("labelEnd"),l):r(d)}function l(d){return d===40?t.attempt(Jbe,u,o?u:h)(d):d===91?t.attempt(Qbe,u,o?c:h)(d):o?u(d):h(d)}function c(d){return t.attempt(eve,u,h)(d)}function u(d){return e(d)}function h(d){return i._balanced=!0,r(d)}}function sve(t,e,r){return n;function n(h){return t.enter("resource"),t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),s}function s(h){return Ut(h)?Pd(t,i)(h):i(h)}function i(h){return h===41?u(h):VU(t,o,a,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function o(h){return Ut(h)?Pd(t,l)(h):u(h)}function a(h){return r(h)}function l(h){return h===34||h===39||h===40?WU(t,c,r,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):u(h)}function c(h){return Ut(h)?Pd(t,u)(h):u(h)}function u(h){return h===41?(t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),t.exit("resource"),e):r(h)}}function ive(t,e,r){const n=this;return s;function s(a){return GU.call(n,t,i,o,"reference","referenceMarker","referenceString")(a)}function i(a){return n.parser.defined.includes(Bs(n.sliceSerialize(n.events[n.events.length-1][1]).slice(1,-1)))?e(a):r(a)}function o(a){return r(a)}}function ove(t,e,r){return n;function n(i){return t.enter("reference"),t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),s}function s(i){return i===93?(t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),t.exit("reference"),e):r(i)}}const ave={name:"labelStartImage",resolveAll:wk.resolveAll,tokenize:lve};function lve(t,e,r){const n=this;return s;function s(a){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(a),t.exit("labelImageMarker"),i}function i(a){return a===91?(t.enter("labelMarker"),t.consume(a),t.exit("labelMarker"),t.exit("labelImage"),o):r(a)}function o(a){return a===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(a):e(a)}}const cve={name:"labelStartLink",resolveAll:wk.resolveAll,tokenize:uve};function uve(t,e,r){const n=this;return s;function s(o){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelLink"),i}function i(o){return o===94&&"_hiddenFootnoteSupport"in n.parser.constructs?r(o):e(o)}}const vw={name:"lineEnding",tokenize:hve};function hve(t,e){return r;function r(n){return t.enter("lineEnding"),t.consume(n),t.exit("lineEnding"),xt(t,e,"linePrefix")}}const t0={name:"thematicBreak",tokenize:dve};function dve(t,e,r){let n=0,s;return i;function i(c){return t.enter("thematicBreak"),o(c)}function o(c){return s=c,a(c)}function a(c){return c===s?(t.enter("thematicBreakSequence"),l(c)):n>=3&&(c===null||Qe(c))?(t.exit("thematicBreak"),e(c)):r(c)}function l(c){return c===s?(t.consume(c),n++,l):(t.exit("thematicBreakSequence"),pt(c)?xt(t,a,"whitespace")(c):a(c))}}const Tn={continuation:{tokenize:gve},exit:yve,name:"list",tokenize:mve},fve={partial:!0,tokenize:bve},pve={partial:!0,tokenize:_ve};function mve(t,e,r){const n=this,s=n.events[n.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,o=0;return a;function a(f){const g=n.containerState.type||(f===42||f===43||f===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!n.containerState.marker||f===n.containerState.marker:Cx(f)){if(n.containerState.type||(n.containerState.type=g,t.enter(g,{_container:!0})),g==="listUnordered")return t.enter("listItemPrefix"),f===42||f===45?t.check(t0,r,c)(f):c(f);if(!n.interrupt||f===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),l(f)}return r(f)}function l(f){return Cx(f)&&++o<10?(t.consume(f),l):(!n.interrupt||o<2)&&(n.containerState.marker?f===n.containerState.marker:f===41||f===46)?(t.exit("listItemValue"),c(f)):r(f)}function c(f){return t.enter("listItemMarker"),t.consume(f),t.exit("listItemMarker"),n.containerState.marker=n.containerState.marker||f,t.check(Pp,n.interrupt?r:u,t.attempt(fve,d,h))}function u(f){return n.containerState.initialBlankLine=!0,i++,d(f)}function h(f){return pt(f)?(t.enter("listItemPrefixWhitespace"),t.consume(f),t.exit("listItemPrefixWhitespace"),d):r(f)}function d(f){return n.containerState.size=i+n.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(f)}}function gve(t,e,r){const n=this;return n.containerState._closeFlow=void 0,t.check(Pp,s,i);function s(a){return n.containerState.furtherBlankLines=n.containerState.furtherBlankLines||n.containerState.initialBlankLine,xt(t,e,"listItemIndent",n.containerState.size+1)(a)}function i(a){return n.containerState.furtherBlankLines||!pt(a)?(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,o(a)):(n.containerState.furtherBlankLines=void 0,n.containerState.initialBlankLine=void 0,t.attempt(pve,e,o)(a))}function o(a){return n.containerState._closeFlow=!0,n.interrupt=void 0,xt(t,t.attempt(Tn,e,r),"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(a)}}function _ve(t,e,r){const n=this;return xt(t,s,"listItemIndent",n.containerState.size+1);function s(i){const o=n.events[n.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===n.containerState.size?e(i):r(i)}}function yve(t){t.exit(this.containerState.type)}function bve(t,e,r){const n=this;return xt(t,s,"listItemPrefixWhitespace",n.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function s(i){const o=n.events[n.events.length-1];return!pt(i)&&o&&o[1].type==="listItemPrefixWhitespace"?e(i):r(i)}}const mO={name:"setextUnderline",resolveTo:vve,tokenize:wve};function vve(t,e){let r=t.length,n,s,i;for(;r--;)if(t[r][0]==="enter"){if(t[r][1].type==="content"){n=r;break}t[r][1].type==="paragraph"&&(s=r)}else t[r][1].type==="content"&&t.splice(r,1),!i&&t[r][1].type==="definition"&&(i=r);const o={type:"setextHeading",start:{...t[s][1].start},end:{...t[t.length-1][1].end}};return t[s][1].type="setextHeadingText",i?(t.splice(s,0,["enter",o,e]),t.splice(i+1,0,["exit",t[n][1],e]),t[n][1].end={...t[i][1].end}):t[n][1]=o,t.push(["exit",o,e]),t}function wve(t,e,r){const n=this;let s;return i;function i(c){let u=n.events.length,h;for(;u--;)if(n.events[u][1].type!=="lineEnding"&&n.events[u][1].type!=="linePrefix"&&n.events[u][1].type!=="content"){h=n.events[u][1].type==="paragraph";break}return!n.parser.lazy[n.now().line]&&(n.interrupt||h)?(t.enter("setextHeadingLine"),s=c,o(c)):r(c)}function o(c){return t.enter("setextHeadingLineSequence"),a(c)}function a(c){return c===s?(t.consume(c),a):(t.exit("setextHeadingLineSequence"),pt(c)?xt(t,l,"lineSuffix")(c):l(c))}function l(c){return c===null||Qe(c)?(t.exit("setextHeadingLine"),e(c)):r(c)}}const Eve={tokenize:Ive,partial:!0};function xve(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:kve,continuation:{tokenize:Ave},exit:Rve}},text:{91:{name:"gfmFootnoteCall",tokenize:Cve},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:Sve,resolveTo:Tve}}}}function Sve(t,e,r){const n=this;let s=n.events.length;const i=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let o;for(;s--;){const l=n.events[s][1];if(l.type==="labelImage"){o=l;break}if(l.type==="gfmFootnoteCall"||l.type==="labelLink"||l.type==="label"||l.type==="image"||l.type==="link")break}return a;function a(l){if(!o||!o._balanced)return r(l);const c=Bs(n.sliceSerialize({start:o.end,end:n.now()}));return c.codePointAt(0)!==94||!i.includes(c.slice(1))?r(l):(t.enter("gfmFootnoteCallLabelMarker"),t.consume(l),t.exit("gfmFootnoteCallLabelMarker"),e(l))}}function Tve(t,e){let r=t.length;for(;r--;)if(t[r][1].type==="labelImage"&&t[r][0]==="enter"){t[r][1];break}t[r+1][1].type="data",t[r+3][1].type="gfmFootnoteCallLabelMarker";const n={type:"gfmFootnoteCall",start:Object.assign({},t[r+3][1].start),end:Object.assign({},t[t.length-1][1].end)},s={type:"gfmFootnoteCallMarker",start:Object.assign({},t[r+3][1].end),end:Object.assign({},t[r+3][1].end)};s.end.column++,s.end.offset++,s.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},s.end),end:Object.assign({},t[t.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},a=[t[r+1],t[r+2],["enter",n,e],t[r+3],t[r+4],["enter",s,e],["exit",s,e],["enter",i,e],["enter",o,e],["exit",o,e],["exit",i,e],t[t.length-2],t[t.length-1],["exit",n,e]];return t.splice(r,t.length-r+1,...a),t}function Cve(t,e,r){const n=this,s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i=0,o;return a;function a(h){return t.enter("gfmFootnoteCall"),t.enter("gfmFootnoteCallLabelMarker"),t.consume(h),t.exit("gfmFootnoteCallLabelMarker"),l}function l(h){return h!==94?r(h):(t.enter("gfmFootnoteCallMarker"),t.consume(h),t.exit("gfmFootnoteCallMarker"),t.enter("gfmFootnoteCallString"),t.enter("chunkString").contentType="string",c)}function c(h){if(i>999||h===93&&!o||h===null||h===91||Ut(h))return r(h);if(h===93){t.exit("chunkString");const d=t.exit("gfmFootnoteCallString");return s.includes(Bs(n.sliceSerialize(d)))?(t.enter("gfmFootnoteCallLabelMarker"),t.consume(h),t.exit("gfmFootnoteCallLabelMarker"),t.exit("gfmFootnoteCall"),e):r(h)}return Ut(h)||(o=!0),i++,t.consume(h),h===92?u:c}function u(h){return h===91||h===92||h===93?(t.consume(h),i++,c):c(h)}}function kve(t,e,r){const n=this,s=n.parser.gfmFootnotes||(n.parser.gfmFootnotes=[]);let i,o=0,a;return l;function l(g){return t.enter("gfmFootnoteDefinition")._container=!0,t.enter("gfmFootnoteDefinitionLabel"),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(g),t.exit("gfmFootnoteDefinitionLabelMarker"),c}function c(g){return g===94?(t.enter("gfmFootnoteDefinitionMarker"),t.consume(g),t.exit("gfmFootnoteDefinitionMarker"),t.enter("gfmFootnoteDefinitionLabelString"),t.enter("chunkString").contentType="string",u):r(g)}function u(g){if(o>999||g===93&&!a||g===null||g===91||Ut(g))return r(g);if(g===93){t.exit("chunkString");const _=t.exit("gfmFootnoteDefinitionLabelString");return i=Bs(n.sliceSerialize(_)),t.enter("gfmFootnoteDefinitionLabelMarker"),t.consume(g),t.exit("gfmFootnoteDefinitionLabelMarker"),t.exit("gfmFootnoteDefinitionLabel"),d}return Ut(g)||(a=!0),o++,t.consume(g),g===92?h:u}function h(g){return g===91||g===92||g===93?(t.consume(g),o++,u):u(g)}function d(g){return g===58?(t.enter("definitionMarker"),t.consume(g),t.exit("definitionMarker"),s.includes(i)||s.push(i),xt(t,f,"gfmFootnoteDefinitionWhitespace")):r(g)}function f(g){return e(g)}}function Ave(t,e,r){return t.check(Pp,e,t.attempt(Eve,e,r))}function Rve(t){t.exit("gfmFootnoteDefinition")}function Ive(t,e,r){const n=this;return xt(t,s,"gfmFootnoteDefinitionIndent",5);function s(i){const o=n.events[n.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?e(i):r(i)}}function Pve(t){let r=(t||{}).singleTilde;const n={name:"strikethrough",tokenize:i,resolveAll:s};return r==null&&(r=!0),{text:{126:n},insideSpan:{null:[n]},attentionMarkers:{null:[126]}};function s(o,a){let l=-1;for(;++l<o.length;)if(o[l][0]==="enter"&&o[l][1].type==="strikethroughSequenceTemporary"&&o[l][1]._close){let c=l;for(;c--;)if(o[c][0]==="exit"&&o[c][1].type==="strikethroughSequenceTemporary"&&o[c][1]._open&&o[l][1].end.offset-o[l][1].start.offset===o[c][1].end.offset-o[c][1].start.offset){o[l][1].type="strikethroughSequence",o[c][1].type="strikethroughSequence";const u={type:"strikethrough",start:Object.assign({},o[c][1].start),end:Object.assign({},o[l][1].end)},h={type:"strikethroughText",start:Object.assign({},o[c][1].end),end:Object.assign({},o[l][1].start)},d=[["enter",u,a],["enter",o[c][1],a],["exit",o[c][1],a],["enter",h,a]],f=a.parser.constructs.insideSpan.null;f&&Xn(d,d.length,0,gb(f,o.slice(c+1,l),a)),Xn(d,d.length,0,[["exit",h,a],["enter",o[l][1],a],["exit",o[l][1],a],["exit",u,a]]),Xn(o,c-1,l-c+3,d),l=c+d.length-2;break}}for(l=-1;++l<o.length;)o[l][1].type==="strikethroughSequenceTemporary"&&(o[l][1].type="data");return o}function i(o,a,l){const c=this.previous,u=this.events;let h=0;return d;function d(g){return c===126&&u[u.length-1][1].type!=="characterEscape"?l(g):(o.enter("strikethroughSequenceTemporary"),f(g))}function f(g){const _=Ru(c);if(g===126)return h>1?l(g):(o.consume(g),h++,f);if(h<2&&!r)return l(g);const m=o.exit("strikethroughSequenceTemporary"),p=Ru(g);return m._open=!p||p===2&&!!_,m._close=!_||_===2&&!!p,a(g)}}}class Ove{constructor(){this.map=[]}add(e,r,n){Dve(this,e,r,n)}consume(e){if(this.map.sort(function(i,o){return i[0]-o[0]}),this.map.length===0)return;let r=this.map.length;const n=[];for(;r>0;)r-=1,n.push(e.slice(this.map[r][0]+this.map[r][1]),this.map[r][2]),e.length=this.map[r][0];n.push([...e]),e.length=0;let s=n.pop();for(;s;)e.push(...s),s=n.pop();this.map.length=0}}function Dve(t,e,r,n){let s=0;if(!(r===0&&n.length===0)){for(;s<t.map.length;){if(t.map[s][0]===e){t.map[s][1]+=r,t.map[s][2].push(...n);return}s+=1}t.map.push([e,r,n])}}function Lve(t,e){let r=!1;const n=[];for(;e<t.length;){const s=t[e];if(r){if(s[0]==="enter")s[1].type==="tableContent"&&n.push(t[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(s[1].type==="tableContent"){if(t[e-1][1].type==="tableDelimiterMarker"){const i=n.length-1;n[i]=n[i]==="left"?"center":"right"}}else if(s[1].type==="tableDelimiterRow")break}else s[0]==="enter"&&s[1].type==="tableDelimiterRow"&&(r=!0);e+=1}return n}function Nve(){return{flow:{null:{name:"table",tokenize:Mve,resolveAll:Bve}}}}function Mve(t,e,r){const n=this;let s=0,i=0,o;return a;function a(A){let M=n.events.length-1;for(;M>-1;){const R=n.events[M][1].type;if(R==="lineEnding"||R==="linePrefix")M--;else break}const P=M>-1?n.events[M][1].type:null,D=P==="tableHead"||P==="tableRow"?E:l;return D===E&&n.parser.lazy[n.now().line]?r(A):D(A)}function l(A){return t.enter("tableHead"),t.enter("tableRow"),c(A)}function c(A){return A===124||(o=!0,i+=1),u(A)}function u(A){return A===null?r(A):Qe(A)?i>1?(i=0,n.interrupt=!0,t.exit("tableRow"),t.enter("lineEnding"),t.consume(A),t.exit("lineEnding"),f):r(A):pt(A)?xt(t,u,"whitespace")(A):(i+=1,o&&(o=!1,s+=1),A===124?(t.enter("tableCellDivider"),t.consume(A),t.exit("tableCellDivider"),o=!0,u):(t.enter("data"),h(A)))}function h(A){return A===null||A===124||Ut(A)?(t.exit("data"),u(A)):(t.consume(A),A===92?d:h)}function d(A){return A===92||A===124?(t.consume(A),h):h(A)}function f(A){return n.interrupt=!1,n.parser.lazy[n.now().line]?r(A):(t.enter("tableDelimiterRow"),o=!1,pt(A)?xt(t,g,"linePrefix",n.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):g(A))}function g(A){return A===45||A===58?m(A):A===124?(o=!0,t.enter("tableCellDivider"),t.consume(A),t.exit("tableCellDivider"),_):w(A)}function _(A){return pt(A)?xt(t,m,"whitespace")(A):m(A)}function m(A){return A===58?(i+=1,o=!0,t.enter("tableDelimiterMarker"),t.consume(A),t.exit("tableDelimiterMarker"),p):A===45?(i+=1,p(A)):A===null||Qe(A)?v(A):w(A)}function p(A){return A===45?(t.enter("tableDelimiterFiller"),y(A)):w(A)}function y(A){return A===45?(t.consume(A),y):A===58?(o=!0,t.exit("tableDelimiterFiller"),t.enter("tableDelimiterMarker"),t.consume(A),t.exit("tableDelimiterMarker"),b):(t.exit("tableDelimiterFiller"),b(A))}function b(A){return pt(A)?xt(t,v,"whitespace")(A):v(A)}function v(A){return A===124?g(A):A===null||Qe(A)?!o||s!==i?w(A):(t.exit("tableDelimiterRow"),t.exit("tableHead"),e(A)):w(A)}function w(A){return r(A)}function E(A){return t.enter("tableRow"),S(A)}function S(A){return A===124?(t.enter("tableCellDivider"),t.consume(A),t.exit("tableCellDivider"),S):A===null||Qe(A)?(t.exit("tableRow"),e(A)):pt(A)?xt(t,S,"whitespace")(A):(t.enter("data"),x(A))}function x(A){return A===null||A===124||Ut(A)?(t.exit("data"),S(A)):(t.consume(A),A===92?C:x)}function C(A){return A===92||A===124?(t.consume(A),x):x(A)}}function Bve(t,e){let r=-1,n=!0,s=0,i=[0,0,0,0],o=[0,0,0,0],a=!1,l=0,c,u,h;const d=new Ove;for(;++r<t.length;){const f=t[r],g=f[1];f[0]==="enter"?g.type==="tableHead"?(a=!1,l!==0&&(gO(d,e,l,c,u),u=void 0,l=0),c={type:"table",start:Object.assign({},g.start),end:Object.assign({},g.end)},d.add(r,0,[["enter",c,e]])):g.type==="tableRow"||g.type==="tableDelimiterRow"?(n=!0,h=void 0,i=[0,0,0,0],o=[0,r+1,0,0],a&&(a=!1,u={type:"tableBody",start:Object.assign({},g.start),end:Object.assign({},g.end)},d.add(r,0,[["enter",u,e]])),s=g.type==="tableDelimiterRow"?2:u?3:1):s&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")?(n=!1,o[2]===0&&(i[1]!==0&&(o[0]=o[1],h=Xm(d,e,i,s,void 0,h),i=[0,0,0,0]),o[2]=r)):g.type==="tableCellDivider"&&(n?n=!1:(i[1]!==0&&(o[0]=o[1],h=Xm(d,e,i,s,void 0,h)),i=o,o=[i[1],r,0,0])):g.type==="tableHead"?(a=!0,l=r):g.type==="tableRow"||g.type==="tableDelimiterRow"?(l=r,i[1]!==0?(o[0]=o[1],h=Xm(d,e,i,s,r,h)):o[1]!==0&&(h=Xm(d,e,o,s,r,h)),s=0):s&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")&&(o[3]=r)}for(l!==0&&gO(d,e,l,c,u),d.consume(e.events),r=-1;++r<e.events.length;){const f=e.events[r];f[0]==="enter"&&f[1].type==="table"&&(f[1]._align=Lve(e.events,r))}return t}function Xm(t,e,r,n,s,i){const o=n===1?"tableHeader":n===2?"tableDelimiter":"tableData",a="tableContent";r[0]!==0&&(i.end=Object.assign({},Ic(e.events,r[0])),t.add(r[0],0,[["exit",i,e]]));const l=Ic(e.events,r[1]);if(i={type:o,start:Object.assign({},l),end:Object.assign({},l)},t.add(r[1],0,[["enter",i,e]]),r[2]!==0){const c=Ic(e.events,r[2]),u=Ic(e.events,r[3]),h={type:a,start:Object.assign({},c),end:Object.assign({},u)};if(t.add(r[2],0,[["enter",h,e]]),n!==2){const d=e.events[r[2]],f=e.events[r[3]];if(d[1].end=Object.assign({},f[1].end),d[1].type="chunkText",d[1].contentType="text",r[3]>r[2]+1){const g=r[2]+1,_=r[3]-r[2]-1;t.add(g,_,[])}}t.add(r[3]+1,0,[["exit",h,e]])}return s!==void 0&&(i.end=Object.assign({},Ic(e.events,s)),t.add(s,0,[["exit",i,e]]),i=void 0),i}function gO(t,e,r,n,s){const i=[],o=Ic(e.events,r);s&&(s.end=Object.assign({},o),i.push(["exit",s,e])),n.end=Object.assign({},o),i.push(["exit",n,e]),t.add(r+1,0,i)}function Ic(t,e){const r=t[e],n=r[0]==="enter"?"start":"end";return r[1][n]}const Fve={name:"tasklistCheck",tokenize:Uve};function jve(){return{text:{91:Fve}}}function Uve(t,e,r){const n=this;return s;function s(l){return n.previous!==null||!n._gfmTasklistFirstContentOfListItem?r(l):(t.enter("taskListCheck"),t.enter("taskListCheckMarker"),t.consume(l),t.exit("taskListCheckMarker"),i)}function i(l){return Ut(l)?(t.enter("taskListCheckValueUnchecked"),t.consume(l),t.exit("taskListCheckValueUnchecked"),o):l===88||l===120?(t.enter("taskListCheckValueChecked"),t.consume(l),t.exit("taskListCheckValueChecked"),o):r(l)}function o(l){return l===93?(t.enter("taskListCheckMarker"),t.consume(l),t.exit("taskListCheckMarker"),t.exit("taskListCheck"),a):r(l)}function a(l){return Qe(l)?e(l):pt(l)?t.check({tokenize:$ve},e,r)(l):r(l)}}function $ve(t,e,r){return xt(t,n,"whitespace");function n(s){return s===null?r(s):e(s)}}function Hve(t){return PU([Jye(),xve(),Pve(t),Nve(),jve()])}const zve={};function Vve(t){const e=this,r=t||zve,n=e.data(),s=n.micromarkExtensions||(n.micromarkExtensions=[]),i=n.fromMarkdownExtensions||(n.fromMarkdownExtensions=[]),o=n.toMarkdownExtensions||(n.toMarkdownExtensions=[]);s.push(Hve(r)),i.push(Wye()),o.push(qye(r))}const Ya=["ariaDescribedBy","ariaLabel","ariaLabelledBy"],Od={ancestors:{tbody:["table"],td:["table"],th:["table"],thead:["table"],tfoot:["table"],tr:["table"]},attributes:{a:[...Ya,"dataFootnoteBackref","dataFootnoteRef",["className","data-footnote-backref"],"href"],blockquote:["cite"],code:[["className",/^language-./]],del:["cite"],div:["itemScope","itemType"],dl:[...Ya],h2:[["className","sr-only"]],img:[...Ya,"longDesc","src"],input:[["disabled",!0],["type","checkbox"]],ins:["cite"],li:[["className","task-list-item"]],ol:[...Ya,["className","contains-task-list"]],q:["cite"],section:["dataFootnotes",["className","footnotes"]],source:["srcSet"],summary:[...Ya],table:[...Ya],ul:[...Ya,["className","contains-task-list"]],"*":["abbr","accept","acceptCharset","accessKey","action","align","alt","axis","border","cellPadding","cellSpacing","char","charOff","charSet","checked","clear","colSpan","color","cols","compact","coords","dateTime","dir","encType","frame","hSpace","headers","height","hrefLang","htmlFor","id","isMap","itemProp","label","lang","maxLength","media","method","multiple","name","noHref","noShade","noWrap","open","prompt","readOnly","rev","rowSpan","rows","rules","scope","selected","shape","size","span","start","summary","tabIndex","title","useMap","vAlign","value","width"]},clobber:["ariaDescribedBy","ariaLabelledBy","id","name"],clobberPrefix:"user-content-",protocols:{cite:["http","https"],href:["http","https","irc","ircs","mailto","xmpp"],longDesc:["http","https"],src:["http","https"]},required:{input:{disabled:!0,type:"checkbox"}},strip:["script"],tagNames:["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","img","input","ins","kbd","li","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","tt","ul","var"]},Xo={}.hasOwnProperty;function Gve(t,e){let r={type:"root",children:[]};const n={schema:e?{...Od,...e}:Od,stack:[]},s=qU(n,t);return s&&(Array.isArray(s)?s.length===1?r=s[0]:r.children=s:r=s),r}function qU(t,e){if(e&&typeof e=="object"){const r=e;switch(typeof r.type=="string"?r.type:""){case"comment":return Wve(t,r);case"doctype":return qve(t,r);case"element":return Kve(t,r);case"root":return Yve(t,r);case"text":return Xve(t,r)}}}function Wve(t,e){if(t.schema.allowComments){const r=typeof e.value=="string"?e.value:"",n=r.indexOf("-->"),i={type:"comment",value:n<0?r:r.slice(0,n)};return Op(i,e),i}}function qve(t,e){if(t.schema.allowDoctypes){const r={type:"doctype"};return Op(r,e),r}}function Kve(t,e){const r=typeof e.tagName=="string"?e.tagName:"";t.stack.push(r);const n=KU(t,e.children),s=Zve(t,e.properties);t.stack.pop();let i=!1;if(r&&r!=="*"&&(!t.schema.tagNames||t.schema.tagNames.includes(r))&&(i=!0,t.schema.ancestors&&Xo.call(t.schema.ancestors,r))){const a=t.schema.ancestors[r];let l=-1;for(i=!1;++l<a.length;)t.stack.includes(a[l])&&(i=!0)}if(!i)return t.schema.strip&&!t.schema.strip.includes(r)?n:void 0;const o={type:"element",tagName:r,properties:s,children:n};return Op(o,e),o}function Yve(t,e){const n={type:"root",children:KU(t,e.children)};return Op(n,e),n}function Xve(t,e){const n={type:"text",value:typeof e.value=="string"?e.value:""};return Op(n,e),n}function KU(t,e){const r=[];if(Array.isArray(e)){const n=e;let s=-1;for(;++s<n.length;){const i=qU(t,n[s]);i&&(Array.isArray(i)?r.push(...i):r.push(i))}}return r}function Zve(t,e){const r=t.stack[t.stack.length-1],n=t.schema.attributes,s=t.schema.required,i=n&&Xo.call(n,r)?n[r]:void 0,o=n&&Xo.call(n,"*")?n["*"]:void 0,a=e&&typeof e=="object"?e:{},l={};let c;for(c in a)if(Xo.call(a,c)){const u=a[c];let h=_O(t,yO(i,c),c,u);h==null&&(h=_O(t,yO(o,c),c,u)),h!=null&&(l[c]=h)}if(s&&Xo.call(s,r)){const u=s[r];for(c in u)Xo.call(u,c)&&!Xo.call(l,c)&&(l[c]=u[c])}return l}function _O(t,e,r,n){return e?Array.isArray(n)?Jve(t,e,r,n):YU(t,e,r,n):void 0}function Jve(t,e,r,n){let s=-1;const i=[];for(;++s<n.length;){const o=YU(t,e,r,n[s]);(typeof o=="number"||typeof o=="string")&&i.push(o)}return i}function YU(t,e,r,n){if(!(typeof n!="boolean"&&typeof n!="number"&&typeof n!="string")&&Qve(t,r,n)){if(typeof e=="object"&&e.length>1){let s=!1,i=0;for(;++i<e.length;){const o=e[i];if(o&&typeof o=="object"&&"flags"in o){if(o.test(String(n))){s=!0;break}}else if(o===n){s=!0;break}}if(!s)return}return t.schema.clobber&&t.schema.clobberPrefix&&t.schema.clobber.includes(r)?t.schema.clobberPrefix+n:n}}function Qve(t,e,r){const n=t.schema.protocols&&Xo.call(t.schema.protocols,e)?t.schema.protocols[e]:void 0;if(!n||n.length===0)return!0;const s=String(r),i=s.indexOf(":"),o=s.indexOf("?"),a=s.indexOf("#"),l=s.indexOf("/");if(i<0||l>-1&&i>l||o>-1&&i>o||a>-1&&i>a)return!0;let c=-1;for(;++c<n.length;){const u=n[c];if(i===u.length&&s.slice(0,u.length)===u)return!0}return!1}function Op(t,e){const r=aU(e);e.data&&(t.data=Ul(e.data)),r&&(t.position=r)}function yO(t,e){let r,n=-1;if(t)for(;++n<t.length;){const s=t[n],i=typeof s=="string"?s:s[0];if(i===e)return s;i==="data*"&&(r=s)}if(e.length>4&&e.slice(0,4).toLowerCase()==="data")return r}function ewe(t){return function(e){return Gve(e,t)}}const Ek=["a","b","blockquote","br","code","dd","del","details","div","dl","dt","em","h1","h2","h3","h4","h5","h6","hr","i","ins","kbd","li","ol","p","pre","q","rp","rt","ruby","s","samp","source","span","strike","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","tr","ul","var"],twe={...Od,tagNames:Ek,attributes:{...Od.attributes,div:[...Od.attributes?.div??[],"data*",["className","__TerretacodeArtifact__"]]},strip:[]};function rwe(t){const e=[Vve];return t&&e.unshift(swe),e}function nwe(t){const e=[];return t&&e.push(c_e,[ewe,twe]),e}const swe=()=>(t,e)=>{const r=e.toString();Rp(t,(n,s,i)=>{if(s==null||["paragraph","text","inlineCode","code","strong","emphasis"].includes(n.type)||!n.position)return!0;let o=r.slice(n.position.start.offset,n.position.end.offset);return n.type==="heading"&&(o=`
${o}`),i.children[s]={type:"text",value:o},[cU,s]})},iwe=(t=ya)=>`
You are Terretacode, an expert AI assistant and exceptional senior software developer with vast knowledge across multiple programming languages, frameworks, and best practices.

<system_constraints>
  You are operating in an environment called WebContainer, an in-browser Node.js runtime that emulates a Linux system to some degree. However, it runs in the browser and doesn't run a full-fledged Linux system and doesn't rely on a cloud VM to execute code. All code is executed in the browser. It does come with a shell that emulates zsh. The container cannot run native binaries since those cannot be executed in the browser. That means it can only execute code that is native to a browser including JS, WebAssembly, etc.

  The shell comes with \`python\` and \`python3\` binaries, but they are LIMITED TO THE PYTHON STANDARD LIBRARY ONLY This means:

    - There is NO \`pip\` support! If you attempt to use \`pip\`, you should explicitly state that it's not available.
    - CRITICAL: Third-party libraries cannot be installed or imported.
    - Even some standard library modules that require additional system dependencies (like \`curses\`) are not available.
    - Only modules from the core Python standard library can be used.

  Additionally, there is no \`g++\` or any C/C++ compiler available. WebContainer CANNOT run native binaries or compile C/C++ code!

  Keep these limitations in mind when suggesting Python or C++ solutions and explicitly mention these constraints if relevant to the task at hand.

  WebContainer has the ability to run a web server but requires to use an npm package (e.g., Vite, servor, serve, http-server) or use the Node.js APIs to implement a web server.

  IMPORTANT: Prefer using Vite instead of implementing a custom web server.

  IMPORTANT: Git is NOT available.

  IMPORTANT: Prefer writing Node.js scripts instead of shell scripts. The environment doesn't fully support shell scripts, so use Node.js for scripting tasks whenever possible!

  IMPORTANT: When choosing databases or npm packages, prefer options that don't rely on native binaries. For databases, prefer libsql, sqlite, or other solutions that don't involve native code. WebContainer CANNOT execute arbitrary native binaries.

  Available shell commands:
    File Operations:
      - cat: Display file contents
      - cp: Copy files/directories
      - ls: List directory contents
      - mkdir: Create directory
      - mv: Move/rename files
      - rm: Remove files
      - rmdir: Remove empty directories
      - touch: Create empty file/update timestamp
    
    System Information:
      - hostname: Show system name
      - ps: Display running processes
      - pwd: Print working directory
      - uptime: Show system uptime
      - env: Environment variables
    
    Development Tools:
      - node: Execute Node.js code
      - python3: Run Python scripts
      - code: VSCode operations
      - jq: Process JSON
    
    Other Utilities:
      - curl, head, sort, tail, clear, which, export, chmod, scho, hostname, kill, ln, xxd, alias, false,  getconf, true, loadenv, wasm, xdg-open, command, exit, source
</system_constraints>

<code_formatting_info>
  Use 2 spaces for code indentation
</code_formatting_info>

<message_formatting_info>
  You can make the output pretty by using only the following available HTML elements: ${Ek.map(e=>`<${e}>`).join(", ")}
</message_formatting_info>

<diff_spec>
  For user-made file modifications, a \`<${Qv}>\` section will appear at the start of the user message. It will contain either \`<diff>\` or \`<file>\` elements for each modified file:

    - \`<diff path="/some/file/path.ext">\`: Contains GNU unified diff format changes
    - \`<file path="/some/file/path.ext">\`: Contains the full new content of the file

  The system chooses \`<file>\` if the diff exceeds the new content size, otherwise \`<diff>\`.

  GNU unified diff format structure:

    - For diffs the header with original and modified file names is omitted!
    - Changed sections start with @@ -X,Y +A,B @@ where:
      - X: Original file starting line
      - Y: Original file line count
      - A: Modified file starting line
      - B: Modified file line count
    - (-) lines: Removed from original
    - (+) lines: Added in modified version
    - Unmarked lines: Unchanged context

  Example:

  <${Qv}>
    <diff path="${ya}/src/main.js">
      @@ -2,7 +2,10 @@
        return a + b;
      }

      -console.log('Hello, World!');
      +console.log('Hello, Terretacode!');
      +
      function greet() {
      -  return 'Greetings!';
      +  return 'Greetings!!';
      }
      +
      +console.log('The End');
    </diff>
    <file path="${ya}/package.json">
      // full file content here
    </file>
  </${Qv}>
</diff_spec>

<chain_of_thought_instructions>
  Before providing a solution, BRIEFLY outline your implementation steps. This helps ensure systematic thinking and clear communication. Your planning should:
  - List concrete steps you'll take
  - Identify key components needed
  - Note potential challenges
  - Be concise (2-4 lines maximum)

  Example responses:

  User: "Create a todo list app with local storage"
  Assistant: "Sure. I'll start by:
  1. Set up Vite + React
  2. Create TodoList and TodoItem components
  3. Implement localStorage for persistence
  4. Add CRUD operations
  
  Let's start now.

  [Rest of response...]"

  User: "Help debug why my API calls aren't working"
  Assistant: "Great. My first steps will be:
  1. Check network requests
  2. Verify API endpoint format
  3. Examine error handling
  
  [Rest of response...]"

</chain_of_thought_instructions>

<artifact_info>
  Terretacode creates a SINGLE, comprehensive artifact for each project. The artifact contains all necessary steps and components, including:

  - Shell commands to run including dependencies to install using a package manager (NPM)
  - Files to create and their contents
  - Folders to create if necessary

  <artifact_instructions>
    1. CRITICAL: Think HOLISTICALLY and COMPREHENSIVELY BEFORE creating an artifact. This means:

      - Consider ALL relevant files in the project
      - Review ALL previous file changes and user modifications (as shown in diffs, see diff_spec)
      - Analyze the entire project context and dependencies
      - Anticipate potential impacts on other parts of the system

      This holistic approach is ABSOLUTELY ESSENTIAL for creating coherent and effective solutions.

    2. IMPORTANT: When receiving file modifications, ALWAYS use the latest file modifications and make any edits to the latest content of a file. This ensures that all changes are applied to the most up-to-date version of the file.

    3. The current working directory is \`${t}\`.

    4. Wrap the content in opening and closing \`<TerretacodeArtifact>\` tags. These tags contain more specific \`<TerretacodeAction>\` elements.

    5. Add a title for the artifact to the \`title\` attribute of the opening \`<TerretacodeArtifact>\`.

    6. Add a unique identifier to the \`id\` attribute of the of the opening \`<TerretacodeArtifact>\`. For updates, reuse the prior identifier. The identifier should be descriptive and relevant to the content, using kebab-case (e.g., "example-code-snippet"). This identifier will be used consistently throughout the artifact's lifecycle, even when updating or iterating on the artifact.

    7. Use \`<TerretacodeAction>\` tags to define specific actions to perform.

    8. For each \`<TerretacodeAction>\`, add a type to the \`type\` attribute of the opening \`<TerretacodeAction>\` tag to specify the type of the action. Assign one of the following values to the \`type\` attribute:

      - shell: For running shell commands.

        - When Using \`npx\`, ALWAYS provide the \`--yes\` flag.
        - When running multiple shell commands, use \`&&\` to run them sequentially.
        - ULTRA IMPORTANT: Do NOT run a dev command with shell action use start action to run dev commands

      - file: For writing new files or updating existing files. For each file add a \`filePath\` attribute to the opening \`<TerretacodeAction>\` tag to specify the file path. The content of the file artifact is the file contents. All file paths MUST BE relative to the current working directory.

      - start: For starting a development server.
        - Use to start application if it hasn’t been started yet or when NEW dependencies have been added.
        - Only use this action when you need to run a dev server or start the application
        - ULTRA IMPORTANT: do NOT re-run a dev server if files are updated. The existing dev server can automatically detect changes and executes the file changes


    9. The order of the actions is VERY IMPORTANT. For example, if you decide to run a file it's important that the file exists in the first place and you need to create it before running a shell command that would execute the file.

    10. ALWAYS install necessary dependencies FIRST before generating any other artifact. If that requires a \`package.json\` then you should create that first!

      IMPORTANT: Add all required dependencies to the \`package.json\` already and try to avoid \`npm i <pkg>\` if possible!

    11. CRITICAL: Always provide the FULL, updated content of the artifact. This means:

      - Include ALL code, even if parts are unchanged
      - NEVER use placeholders like "// rest of the code remains the same..." or "<- leave original code here ->"
      - ALWAYS show the complete, up-to-date file contents when updating files
      - Avoid any form of truncation or summarization

    12. When running a dev server NEVER say something like "You can now view X by opening the provided local server URL in your browser. The preview will be opened automatically or by the user manually!

    13. If a dev server has already been started, do not re-run the dev command when new dependencies are installed or files were updated. Assume that installing new dependencies will be executed in a different process and changes will be picked up by the dev server.

    14. IMPORTANT: Use coding best practices and split functionality into smaller modules instead of putting everything in a single gigantic file. Files should be as small as possible, and functionality should be extracted into separate modules when possible.

      - Ensure code is clean, readable, and maintainable.
      - Adhere to proper naming conventions and consistent formatting.
      - Split functionality into smaller, reusable modules instead of placing everything in a single large file.
      - Keep files as small as possible by extracting related functionalities into separate modules.
      - Use imports to connect these modules together effectively.
  </artifact_instructions>
</artifact_info>

NEVER use the word "artifact". For example:
  - DO NOT SAY: "This artifact sets up a simple Snake game using HTML, CSS, and JavaScript."
  - INSTEAD SAY: "We set up a simple Snake game using HTML, CSS, and JavaScript."

IMPORTANT: Use valid markdown only for all your responses and DO NOT use HTML tags except for artifacts!

ULTRA IMPORTANT: Do NOT be verbose and DO NOT explain anything unless the user is asking for more information. That is VERY important.

ULTRA IMPORTANT: Think first and reply with the artifact that contains all necessary steps to set up the project, files, shell commands to run. It is SUPER IMPORTANT to respond with this first.

Here are some examples of correct usage of artifacts:

<examples>
  <example>
    <user_query>Can you help me create a JavaScript function to calculate the factorial of a number?</user_query>

    <assistant_response>
      Certainly, I can help you create a JavaScript function to calculate the factorial of a number.

      <TerretacodeArtifact id="factorial-function" title="JavaScript Factorial Function">
        <TerretacodeAction type="file" filePath="index.js">
          function factorial(n) {
           ...
          }

          ...
        </TerretacodeAction>

        <TerretacodeAction type="shell">
          node index.js
        </TerretacodeAction>
      </TerretacodeArtifact>
    </assistant_response>
  </example>

  <example>
    <user_query>Build a snake game</user_query>

    <assistant_response>
      Certainly! I'd be happy to help you build a snake game using JavaScript and HTML5 Canvas. This will be a basic implementation that you can later expand upon. Let's create the game step by step.

      <TerretacodeArtifact id="snake-game" title="Snake Game in HTML and JavaScript">
        <TerretacodeAction type="file" filePath="package.json">
          {
            "name": "snake",
            "scripts": {
              "dev": "vite"
            }
            ...
          }
        </TerretacodeAction>

        <TerretacodeAction type="shell">
          npm install --save-dev vite
        </TerretacodeAction>

        <TerretacodeAction type="file" filePath="index.html">
          ...
        </TerretacodeAction>

        <TerretacodeAction type="start">
          npm run dev
        </TerretacodeAction>
      </TerretacodeArtifact>

      Now you can play the Snake game by opening the provided local server URL in your browser. Use the arrow keys to control the snake. Eat the red food to grow and increase your score. The game ends if you hit the wall or your own tail.
    </assistant_response>
  </example>

  <example>
    <user_query>Make a bouncing ball with real gravity using React</user_query>

    <assistant_response>
      Certainly! I'll create a bouncing ball with real gravity using React. We'll use the react-spring library for physics-based animations.

      <TerretacodeArtifact id="bouncing-ball-react" title="Bouncing Ball with Gravity in React">
        <TerretacodeAction type="file" filePath="package.json">
          {
            "name": "bouncing-ball",
            "private": true,
            "version": "0.0.0",
            "type": "module",
            "scripts": {
              "dev": "vite",
              "build": "vite build",
              "preview": "vite preview"
            },
            "dependencies": {
              "react": "^18.2.0",
              "react-dom": "^18.2.0",
              "react-spring": "^9.7.1"
            },
            "devDependencies": {
              "@types/react": "^18.0.28",
              "@types/react-dom": "^18.0.11",
              "@vitejs/plugin-react": "^3.1.0",
              "vite": "^4.2.0"
            }
          }
        </TerretacodeAction>

        <TerretacodeAction type="file" filePath="index.html">
          ...
        </TerretacodeAction>

        <TerretacodeAction type="file" filePath="src/main.jsx">
          ...
        </TerretacodeAction>

        <TerretacodeAction type="file" filePath="src/index.css">
          ...
        </TerretacodeAction>

        <TerretacodeAction type="file" filePath="src/App.jsx">
          ...
        </TerretacodeAction>

        <TerretacodeAction type="start">
          npm run dev
        </TerretacodeAction>
      </TerretacodeArtifact>

      You can now view the bouncing ball animation in the preview. The ball will start falling from the top of the screen and bounce realistically when it hits the bottom.
    </assistant_response>
  </example>
</examples>
`;_q`
  Continue your prior response. IMPORTANT: Immediately begin from where you left off without any interruptions.
  Do not repeat any content, including artifact and action tags.
`;const owe=t=>{const{cwd:e,allowedHtmlElements:r,modificationTagName:n}=t;return`
You are Terretacode, an expert AI assistant and exceptional senior software developer with vast knowledge across multiple programming languages, frameworks, and best practices.

<system_constraints>
  - Operating in WebContainer, an in-browser Node.js runtime
  - Limited Python support: standard library only, no pip
  - No C/C++ compiler, native binaries, or Git
  - Prefer Node.js scripts over shell scripts
  - Use Vite for web servers
  - Databases: prefer libsql, sqlite, or non-native solutions
  - When for react dont forget to write vite config and index.html to the project

  Available shell commands: cat, cp, ls, mkdir, mv, rm, rmdir, touch, hostname, ps, pwd, uptime, env, node, python3, code, jq, curl, head, sort, tail, clear, which, export, chmod, scho, kill, ln, xxd, alias, getconf, loadenv, wasm, xdg-open, command, exit, source
</system_constraints>

<code_formatting_info>
  Use 2 spaces for indentation
</code_formatting_info>

<message_formatting_info>
  Available HTML elements: ${r.join(", ")}
</message_formatting_info>

<diff_spec>
  File modifications in \`<${n}>\` section:
  - \`<diff path="/path/to/file">\`: GNU unified diff format
  - \`<file path="/path/to/file">\`: Full new content
</diff_spec>

<chain_of_thought_instructions>
  do not mention the phrase "chain of thought"
  Before solutions, briefly outline implementation steps (2-4 lines max):
  - List concrete steps
  - Identify key components
  - Note potential challenges
  - Do not write the actual code just the plan and structure if needed 
  - Once completed planning start writing the artifacts
</chain_of_thought_instructions>

<artifact_info>
  Create a single, comprehensive artifact for each project:
  - Use \`<TerretacodeArtifact>\` tags with \`title\` and \`id\` attributes
  - Use \`<TerretacodeAction>\` tags with \`type\` attribute:
    - shell: Run commands
    - file: Write/update files (use \`filePath\` attribute)
    - start: Start dev server (only when necessary)
  - Order actions logically
  - Install dependencies first
  - Provide full, updated content for all files
  - Use coding best practices: modular, clean, readable code
</artifact_info>


# CRITICAL RULES - NEVER IGNORE

## File and Command Handling
1. ALWAYS use artifacts for file contents and commands - NO EXCEPTIONS
2. When writing a file, INCLUDE THE ENTIRE FILE CONTENT - NO PARTIAL UPDATES
3. For modifications, ONLY alter files that require changes - DO NOT touch unaffected files

## Response Format
4. Use markdown EXCLUSIVELY - HTML tags are ONLY allowed within artifacts
5. Be concise - Explain ONLY when explicitly requested
6. NEVER use the word "artifact" in responses

## Development Process
7. ALWAYS think and plan comprehensively before providing a solution
8. Current working directory: \`${e} \` - Use this for all file paths
9. Don't use cli scaffolding to steup the project, use cwd as Root of the project
11. For nodejs projects ALWAYS install dependencies after writing package.json file

## Coding Standards
10. ALWAYS create smaller, atomic components and modules
11. Modularity is PARAMOUNT - Break down functionality into logical, reusable parts
12. IMMEDIATELY refactor any file exceeding 250 lines
13. ALWAYS plan refactoring before implementation - Consider impacts on the entire system

## Artifact Usage
22. Use \`<TerretacodeArtifact>\` tags with \`title\` and \`id\` attributes for each project
23. Use \`<TerretacodeAction>\` tags with appropriate \`type\` attribute:
    - \`shell\`: For running commands
    - \`file\`: For writing/updating files (include \`filePath\` attribute)
    - \`start\`: For starting dev servers (use only when necessary/ or new dependencies are installed)
24. Order actions logically - dependencies MUST be installed first
25. For Vite project must include vite config and index.html for entry point
26. Provide COMPLETE, up-to-date content for all files - NO placeholders or partial updates

CRITICAL: These rules are ABSOLUTE and MUST be followed WITHOUT EXCEPTION in EVERY response.

Examples:
<examples>
  <example>
    <user_query>Can you help me create a JavaScript function to calculate the factorial of a number?</user_query>
    <assistant_response>
      Certainly, I can help you create a JavaScript function to calculate the factorial of a number.

      <TerretacodeArtifact id="factorial-function" title="JavaScript Factorial Function">
        <TerretacodeAction type="file" filePath="index.js">
function factorial(n) {
  ...
}

...
        </TerretacodeAction>
        <TerretacodeAction type="shell">
node index.js
        </TerretacodeAction>
      </TerretacodeArtifact>
    </assistant_response>
  </example>

  <example>
    <user_query>Build a snake game</user_query>
    <assistant_response>
      Certainly! I'd be happy to help you build a snake game using JavaScript and HTML5 Canvas. This will be a basic implementation that you can later expand upon. Let's create the game step by step.

      <TerretacodeArtifact id="snake-game" title="Snake Game in HTML and JavaScript">
        <TerretacodeAction type="file" filePath="package.json">
{
  "name": "snake",
  "scripts": {
    "dev": "vite"
  }
  ...
}
        </TerretacodeAction>
        <TerretacodeAction type="shell">
npm install --save-dev vite
        </TerretacodeAction>
        <TerretacodeAction type="file" filePath="index.html">
...
        </TerretacodeAction>
        <TerretacodeAction type="start">
npm run dev
        </TerretacodeAction>
      </TerretacodeArtifact>

      Now you can play the Snake game by opening the provided local server URL in your browser. Use the arrow keys to control the snake. Eat the red food to grow and increase your score. The game ends if you hit the wall or your own tail.
    </assistant_response>
  </example>

  <example>
    <user_query>Make a bouncing ball with real gravity using React</user_query>
    <assistant_response>
      Certainly! I'll create a bouncing ball with real gravity using React. We'll use the react-spring library for physics-based animations.

      <TerretacodeArtifact id="bouncing-ball-react" title="Bouncing Ball with Gravity in React">
        <TerretacodeAction type="file" filePath="package.json">
{
  "name": "bouncing-ball",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-spring": "^9.7.1"
  },
  "devDependencies": {
    "@types/react": "^18.0.28",
    "@types/react-dom": "^18.0.11",
    "@vitejs/plugin-react": "^3.1.0",
    "vite": "^4.2.0"
  }
}
        </TerretacodeAction>
        <TerretacodeAction type="file" filePath="index.html">
...
        </TerretacodeAction>
        <TerretacodeAction type="file" filePath="src/main.jsx">
...
        </TerretacodeAction>
        <TerretacodeAction type="file" filePath="src/index.css">
...
        </TerretacodeAction>
        <TerretacodeAction type="file" filePath="src/App.jsx">
...
        </TerretacodeAction>
        <TerretacodeAction type="start">
npm run dev
        </TerretacodeAction>
      </TerretacodeArtifact>

      You can now view the bouncing ball animation in the preview. The ball will start falling from the top of the screen and bounce realistically when it hits the bottom.
    </assistant_response>
  </example>
</examples>
Always use artifacts for file contents and commands, following the format shown in these examples.
`};class awe{static library={default:{label:"Prompt Predeterminado",description:"This is the battle tested default system Prompt",get:e=>iwe(e.cwd)},optimized:{label:"Prompt Optimizado (Experimental)",description:"an Experimental version of the prompt for lower token usage",get:e=>owe(e)}};static getList(){return Object.entries(this.library).map(([e,r])=>{const{label:n,description:s}=r;return{id:e,label:n,description:s}})}static getPropmtFromLibrary(e,r){if(!this.library[e])throw"Prompt Now Found";return this.library[e]?.get(r)}}function lwe(){const{debug:t,enableDebugMode:e,isLocalModel:r,enableLocalModels:n,enableEventLogs:s,isLatestBranch:i,enableLatestBranch:o,promptId:a,setPromptId:l,autoSelectTemplate:c,setAutoSelectTemplate:u,enableContextOptimization:h,contextOptimizationEnabled:d}=rh(),f=g=>{e(g),s(g)};return T.jsxs("div",{className:"p-4 bg-Terretacode-elements-bg-depth-2 border border-Terretacode-elements-borderColor rounded-lg mb-4",children:[T.jsxs("div",{className:"mb-6",children:[T.jsx("h3",{className:"text-lg font-medium text-Terretacode-elements-textPrimary mb-4",children:"Funciones Opcionales"}),T.jsxs("div",{className:"space-y-4",children:[T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsx("span",{className:"text-Terretacode-elements-textPrimary",children:"Funciones de Depuración"}),T.jsx(Qo,{className:"ml-auto",checked:t,onCheckedChange:f})]}),T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{children:[T.jsx("span",{className:"text-Terretacode-elements-textPrimary",children:"Usar la Rama Principal"}),T.jsx("p",{className:"text-xs text-Terretacode-elements-textTertiary",children:"Buscar actualizaciones en la rama principal en lugar de la versión estable."})]}),T.jsx(Qo,{className:"ml-auto",checked:i,onCheckedChange:o})]}),T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{children:[T.jsx("span",{className:"text-Terretacode-elements-textPrimary",children:"Seleccionar automáticamente la plantilla de código."}),T.jsx("p",{className:"text-xs text-Terretacode-elements-textTertiary",children:"Permite que Terretacode seleccione la mejor plantilla inicial para tu proyecto."})]}),T.jsx(Qo,{className:"ml-auto",checked:c,onCheckedChange:u})]}),T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{children:[T.jsx("span",{className:"text-Terretacode-elements-textPrimary",children:"Usar Optimización de Contexto"}),T.jsx("p",{className:"text-sm text-Terretacode-elements-textSecondary",children:"Redacta el contenido del archivo desde el chat y coloca el contenido más reciente del archivo en el mensaje del sistema."})]}),T.jsx(Qo,{className:"ml-auto",checked:d,onCheckedChange:h})]})]})]}),T.jsxs("div",{className:"mb-6 border-t border-Terretacode-elements-borderColor pt-4",children:[T.jsx("h3",{className:"text-lg font-medium text-Terretacode-elements-textPrimary mb-4",children:"Funciones Experimentales"}),T.jsx("p",{className:"text-sm text-Terretacode-elements-textSecondary mb-10",children:"Aviso: Las Funciones Experimentales pueden ser inestables y están sujetas a cambios."}),T.jsxs("div",{className:"flex flex-col",children:[T.jsxs("div",{className:"flex items-center justify-between mb-2",children:[T.jsx("span",{className:"text-Terretacode-elements-textPrimary",children:"Proveedor Experimental"}),T.jsx(Qo,{className:"ml-auto",checked:r,onCheckedChange:n})]}),T.jsx("p",{className:"text-xs text-Terretacode-elements-textTertiary mb-4",children:"Habilitar Proveedores Experimentales como Ollama, LMStudio y OpenAILike."})]}),T.jsxs("div",{className:"flex items-start justify-between pt-4 mb-2 gap-2",children:[T.jsxs("div",{className:"flex-1 max-w-[200px]",children:[T.jsx("span",{className:"text-Terretacode-elements-textPrimary",children:"Biblioteca Prompt"}),T.jsx("p",{className:"text-xs text-Terretacode-elements-textTertiary mb-4",children:"Elige un mensaje de la biblioteca para usarlo como mensaje del sistema."})]}),T.jsx("select",{value:a,onChange:g=>l(g.target.value),className:"flex-1 p-2 ml-auto rounded-lg border border-Terretacode-elements-borderColor bg-Terretacode-elements-prompt-background text-Terretacode-elements-textPrimary focus:outline-none focus:ring-2 focus:ring-Terretacode-elements-focus transition-all text-sm min-w-[100px]",children:awe.getList().map(g=>T.jsx("option",{value:g.id,children:g.label},g.id))})]})]})]})}const cwe={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},xk={commit:"31c8451",version:"0.0.5"},uwe=["Ollama","LMStudio","OpenAILike"],bO=xk.commit,hwe=xk.version,dwe={original:"https://api.github.com/repos/stackblitz-labs/Terretacode.diy/commits/main",fork:"https://api.github.com/repos/Stijnus/Terretacode.new-any-llm/commits/main",commitJson:async t=>{try{const r=await(await fetch(`https://api.github.com/repos/stackblitz-labs/Terretacode.diy/commits/${t}`)).json(),s=await(await fetch(`https://raw.githubusercontent.com/stackblitz-labs/Terretacode.diy/${t}/package.json`)).json();return{commit:r.sha.slice(0,7),version:s.version}}catch(e){throw console.log("Failed to fetch local commit info:",e),new Error("Failed to fetch local commit info")}}};function fwe(){const t=i=>{if(i===0)return"0 Bytes";const o=1024,a=["Bytes","KB","MB","GB"],l=Math.floor(Math.log(i)/Math.log(o));return parseFloat((i/Math.pow(o,l)).toFixed(2))+" "+a[l]},e=()=>{const i=navigator.userAgent;let o="Unknown";i.includes("Firefox/")?o="Firefox":i.includes("Chrome/")?i.includes("Edg/")?o="Edge":i.includes("OPR/")?o="Opera":o="Chrome":i.includes("Safari/")&&(i.includes("Chrome")||(o="Safari"));const a=i.match(new RegExp(`${o}\\/([\\d.]+)`)),l=a?` ${a[1]}`:"";return`${o}${l}`},r=()=>{const i=navigator.userAgent,o=navigator.platform;return i.includes("Win")?"Windows":i.includes("Mac")?i.includes("iPhone")||i.includes("iPad")?"iOS":"macOS":i.includes("Linux")?"Linux":i.includes("Android")?"Android":o||"Unknown"},n=()=>{const i=navigator.userAgent;return i.includes("Mobile")?"Mobile":i.includes("Tablet")?"Tablet":"Desktop"},s=()=>{if("memory"in performance){const i=performance.memory;return`${t(i.jsHeapSizeLimit)} (Used: ${t(i.usedJSHeapSize)})`}return"Not available"};return{os:r(),browser:e(),screen:`${window.screen.width}x${window.screen.height}`,language:navigator.language,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,memory:s(),cores:navigator.hardwareConcurrency||0,deviceType:n(),colorDepth:`${window.screen.colorDepth}-bit`,pixelRatio:window.devicePixelRatio,online:navigator.onLine,cookiesEnabled:navigator.cookieEnabled,doNotTrack:navigator.doNotTrack==="1"}}const pwe=async(t,e)=>{if(!t)return console.log(`[Debug] No URL provided for ${e}`),{name:e,enabled:!1,isLocal:!0,isRunning:!1,error:"No URL configured",lastChecked:new Date,url:null};console.log(`[Debug] Checking status for ${e} at ${t}`);const r=performance.now();try{if(e.toLowerCase()==="ollama")try{console.log(`[Debug] Checking Ollama root endpoint: ${t}`);const o=new AbortController,a=setTimeout(()=>o.abort(),5e3),l=await fetch(t,{signal:o.signal,headers:{Accept:"text/plain,application/json"}});clearTimeout(a);const c=await l.text();if(console.log("[Debug] Ollama root response:",c),c.includes("Ollama is running"))return console.log("[Debug] Ollama running confirmed via root endpoint"),{name:e,enabled:!1,isLocal:!0,isRunning:!0,lastChecked:new Date,responseTime:performance.now()-r,url:t}}catch(o){if(console.log("[Debug] Ollama root check failed:",o),(o instanceof Error?o.message:"Unknown error").includes("aborted"))return{name:e,enabled:!1,isLocal:!0,isRunning:!1,error:"Connection timeout",lastChecked:new Date,responseTime:performance.now()-r,url:t}}const n=[`${t}/api/health`,t.endsWith("v1")?`${t}/models`:`${t}/v1/models`];console.log("[Debug] Checking additional endpoints:",n);const i=(await Promise.all(n.map(async o=>{try{console.log(`[Debug] Trying endpoint: ${o}`);const a=new AbortController,l=setTimeout(()=>a.abort(),5e3),c=await fetch(o,{signal:a.signal,headers:{Accept:"application/json"}});clearTimeout(l);const u=c.ok;if(console.log(`[Debug] Endpoint ${o} response:`,u),u)try{const h=await c.json();console.log(`[Debug] Endpoint ${o} data:`,h)}catch{console.log(`[Debug] Could not parse JSON from ${o}`)}return u}catch(a){return console.log(`[Debug] Endpoint ${o} failed:`,a),!1}}))).some(o=>o);return console.log(`[Debug] Final status for ${e}:`,i),{name:e,enabled:!1,isLocal:!0,isRunning:i,lastChecked:new Date,responseTime:performance.now()-r,url:t}}catch(n){return console.log(`[Debug] Provider check failed for ${e}:`,n),{name:e,enabled:!1,isLocal:!0,isRunning:!1,error:n instanceof Error?n.message:"Unknown error",lastChecked:new Date,responseTime:performance.now()-r,url:t}}};function mwe(){const{providers:t,isLatestBranch:e}=rh(),[r,n]=I.useState([]),[s,i]=I.useState(""),[o]=I.useState(fwe()),[a,l]=I.useState(!1),c=async()=>{if(t)try{const d=Object.entries(t),f=await Promise.all(d.filter(([,g])=>uwe.includes(g.name)).map(async([,g])=>{const _=YC[g.name].baseUrlKey||`REACT_APP_${g.name.toUpperCase()}_URL`;let m=g.settings.baseUrl;m&&m.trim().length===0&&(m=void 0);const p=m||cwe[_]||null;return console.log(`[Debug] Using URL for ${g.name}:`,p,`(from ${_})`),{...await pwe(p,g.name),enabled:g.settings.enabled??!1}}));n(f)}catch(d){console.error("[Debug] Failed to update provider statuses:",d)}};I.useEffect(()=>{c();const d=setInterval(c,3e4);return()=>clearInterval(d)},[t]);const u=I.useCallback(async()=>{if(!a)try{l(!0),i("Checking for updates...");const d=e?"main":"stable";console.log(`[Debug] Checking for updates against ${d} branch`);const g=(await dwe.commitJson(d)).commit,_=bO;i(g!==_?`Update available from ${d} branch!
Current: ${_.slice(0,7)}
Latest: ${g.slice(0,7)}`:`You are on the latest version from the ${d} branch`)}catch(d){i("Failed to check for updates"),console.error("[Debug] Failed to check for updates:",d)}finally{l(!1)}},[a,e]),h=I.useCallback(()=>{const d={System:o,Providers:r.map(f=>({name:f.name,enabled:f.enabled,isLocal:f.isLocal,running:f.isRunning,error:f.error,lastChecked:f.lastChecked,responseTime:f.responseTime,url:f.url})),Version:{hash:bO.slice(0,7),branch:e?"main":"stable"},Timestamp:new Date().toISOString()};navigator.clipboard.writeText(JSON.stringify(d,null,2)).then(()=>{Ne.success("Debug information copied to clipboard!")})},[r,o,e]);return T.jsxs("div",{className:"p-4 space-y-6",children:[T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsx("h3",{className:"text-lg font-medium text-Terretacode-elements-textPrimary",children:"Debug Information"}),T.jsxs("div",{className:"flex gap-2",children:[T.jsx("button",{onClick:h,className:"bg-Terretacode-elements-button-primary-background rounded-lg px-4 py-2 transition-colors duration-200 hover:bg-Terretacode-elements-button-primary-backgroundHover text-Terretacode-elements-button-primary-text",children:"Copy Debug Info"}),T.jsx("button",{onClick:u,disabled:a,className:`bg-Terretacode-elements-button-primary-background rounded-lg px-4 py-2 transition-colors duration-200
              ${a?"opacity-75 cursor-not-allowed":"hover:bg-Terretacode-elements-button-primary-backgroundHover"}
              text-Terretacode-elements-button-primary-text`,children:a?"Checking...":"Check for Updates"})]})]}),s&&T.jsxs("div",{className:`bg-Terretacode-elements-surface rounded-lg p-3 ${s.includes("Update available")?"border-l-4 border-yellow-400":""}`,children:[T.jsx("p",{className:"text-Terretacode-elements-textSecondary whitespace-pre-line",children:s}),s.includes("Update available")&&T.jsxs("div",{className:"mt-3 text-sm",children:[T.jsx("p",{className:"font-medium text-Terretacode-elements-textPrimary",children:"To update:"}),T.jsxs("ol",{className:"list-decimal ml-4 mt-1 text-Terretacode-elements-textSecondary",children:[T.jsxs("li",{children:["Pull the latest changes:"," ",T.jsx("code",{className:"bg-Terretacode-elements-surface-hover px-1 rounded",children:"git pull upstream main"})]}),T.jsxs("li",{children:["Install any new dependencies:"," ",T.jsx("code",{className:"bg-Terretacode-elements-surface-hover px-1 rounded",children:"pnpm install"})]}),T.jsx("li",{children:"Restart the application"})]})]})]}),T.jsxs("section",{className:"space-y-4",children:[T.jsxs("div",{children:[T.jsx("h4",{className:"text-md font-medium text-Terretacode-elements-textPrimary mb-2",children:"System Information"}),T.jsxs("div",{className:"bg-Terretacode-elements-surface rounded-lg p-4",children:[T.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-Terretacode-elements-textSecondary",children:"Operating System"}),T.jsx("p",{className:"text-sm font-medium text-Terretacode-elements-textPrimary",children:o.os})]}),T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-Terretacode-elements-textSecondary",children:"Device Type"}),T.jsx("p",{className:"text-sm font-medium text-Terretacode-elements-textPrimary",children:o.deviceType})]}),T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-Terretacode-elements-textSecondary",children:"Browser"}),T.jsx("p",{className:"text-sm font-medium text-Terretacode-elements-textPrimary",children:o.browser})]}),T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-Terretacode-elements-textSecondary",children:"Display"}),T.jsxs("p",{className:"text-sm font-medium text-Terretacode-elements-textPrimary",children:[o.screen," (",o.colorDepth,") @",o.pixelRatio,"x"]})]}),T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-Terretacode-elements-textSecondary",children:"Connection"}),T.jsxs("p",{className:"text-sm font-medium flex items-center gap-2",children:[T.jsx("span",{className:`inline-block w-2 h-2 rounded-full ${o.online?"bg-green-500":"bg-red-500"}`}),T.jsx("span",{className:`${o.online?"text-green-600":"text-red-600"}`,children:o.online?"Online":"Offline"})]})]}),T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-Terretacode-elements-textSecondary",children:"Screen Resolution"}),T.jsx("p",{className:"text-sm font-medium text-Terretacode-elements-textPrimary",children:o.screen})]}),T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-Terretacode-elements-textSecondary",children:"Language"}),T.jsx("p",{className:"text-sm font-medium text-Terretacode-elements-textPrimary",children:o.language})]}),T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-Terretacode-elements-textSecondary",children:"Timezone"}),T.jsx("p",{className:"text-sm font-medium text-Terretacode-elements-textPrimary",children:o.timezone})]}),T.jsxs("div",{children:[T.jsx("p",{className:"text-xs text-Terretacode-elements-textSecondary",children:"CPU Cores"}),T.jsx("p",{className:"text-sm font-medium text-Terretacode-elements-textPrimary",children:o.cores})]})]}),T.jsxs("div",{className:"mt-3 pt-3 border-t border-Terretacode-elements-surface-hover",children:[T.jsx("p",{className:"text-xs text-Terretacode-elements-textSecondary",children:"Version"}),T.jsxs("p",{className:"text-sm font-medium text-Terretacode-elements-textPrimary font-mono",children:[xk.commit.slice(0,7),T.jsxs("span",{className:"ml-2 text-xs text-Terretacode-elements-textSecondary",children:["(v",hwe,") - ",e?"nightly":"stable"]})]})]})]})]}),T.jsxs("div",{children:[T.jsx("h4",{className:"text-md font-medium text-Terretacode-elements-textPrimary mb-2",children:"Local LLM Status"}),T.jsx("div",{className:"bg-Terretacode-elements-surface rounded-lg",children:T.jsxs("div",{className:"grid grid-cols-1 divide-y",children:[r.map(d=>T.jsxs("div",{className:"p-3 flex flex-col space-y-2",children:[T.jsxs("div",{className:"flex items-center justify-between",children:[T.jsxs("div",{className:"flex items-center gap-3",children:[T.jsx("div",{className:"flex-shrink-0",children:T.jsx("div",{className:`w-2 h-2 rounded-full ${d.enabled?d.isRunning?"bg-green-400":"bg-red-400":"bg-gray-300"}`})}),T.jsxs("div",{children:[T.jsx("p",{className:"text-sm font-medium text-Terretacode-elements-textPrimary",children:d.name}),d.url&&T.jsx("p",{className:"text-xs text-Terretacode-elements-textSecondary truncate max-w-[300px]",children:d.url})]})]}),T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${d.enabled?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:d.enabled?"Enabled":"Disabled"}),d.enabled&&T.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full ${d.isRunning?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:d.isRunning?"Running":"Not Running"})]})]}),T.jsxs("div",{className:"pl-5 flex flex-col space-y-1 text-xs",children:[T.jsxs("div",{className:"flex flex-wrap gap-2",children:[T.jsxs("span",{className:"text-Terretacode-elements-textSecondary",children:["Last checked: ",new Date(d.lastChecked).toLocaleTimeString()]}),d.responseTime&&T.jsxs("span",{className:"text-Terretacode-elements-textSecondary",children:["Response time: ",Math.round(d.responseTime),"ms"]})]}),d.error&&T.jsxs("div",{className:"mt-1 text-red-600 bg-red-50 rounded-md p-2",children:[T.jsx("span",{className:"font-medium",children:"Error:"})," ",d.error]}),d.url&&T.jsxs("div",{className:"text-Terretacode-elements-textSecondary",children:[T.jsx("span",{className:"font-medium",children:"Endpoints checked:"}),T.jsxs("ul",{className:"list-disc list-inside pl-2 mt-1",children:[T.jsxs("li",{children:[d.url," (root)"]}),T.jsxs("li",{children:[d.url,"/api/health"]}),T.jsxs("li",{children:[d.url,"/v1/models"]})]})]})]})]},d.name)),r.length===0&&T.jsx("div",{className:"p-4 text-center text-Terretacode-elements-textSecondary",children:"No local LLMs configured"})]})})]})]})]})}var gwe={};function _we(){rh();const t=wt(ft.showLogs),[e,r]=I.useState("info"),[n,s]=I.useState(!0),[i,o]=I.useState(""),[,a]=I.useState({}),l=I.useMemo(()=>ft.getLogs().filter(f=>{const g=!e||f.level===e||e==="all",_=!i||f.message?.toLowerCase().includes(i.toLowerCase())||JSON.stringify(f.details)?.toLowerCase()?.includes(i?.toLowerCase());return g&&_}),[e,i]);I.useEffect(()=>{ft.showLogs.set(!0)},[]),I.useEffect(()=>{ft.logSystem("Application initialized",{version:gwe.NEXT_PUBLIC_APP_VERSION,environment:"production"}),ft.logDebug("System configuration loaded",{runtime:"Next.js",features:["AI Chat","Event Logging"]}),ft.logWarning("Resource usage threshold approaching",{memoryUsage:"75%",cpuLoad:"60%"}),ft.logError("API connection failed",new Error("Connection timeout"),{endpoint:"/api/chat",retryCount:3,lastAttempt:new Date().toISOString()})},[]),I.useEffect(()=>{const d=document.querySelector(".logs-container");d&&n&&(d.scrollTop=d.scrollHeight)},[l,n]);const c=I.useCallback(()=>{confirm("Are you sure you want to clear all logs?")&&(ft.clearLogs(),Ne.success("Logs cleared successfully"),a({}))},[]),u=I.useCallback(()=>{try{const d=ft.getLogs().map(m=>`[${m.level.toUpperCase()}] ${m.timestamp} - ${m.message}${m.details?`
Details: `+JSON.stringify(m.details,null,2):""}`).join(`

`),f=new Blob([d],{type:"text/plain"}),g=URL.createObjectURL(f),_=document.createElement("a");_.href=g,_.download=`event-logs-${new Date().toISOString()}.txt`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(g),Ne.success("Logs exported successfully")}catch(d){Ne.error("Failed to export logs"),console.error("Export error:",d)}},[]),h=d=>{switch(d){case"info":return"text-blue-500";case"warning":return"text-yellow-500";case"error":return"text-red-500";case"debug":return"text-gray-500";default:return"text-Terretacode-elements-textPrimary"}};return T.jsxs("div",{className:"p-4 h-full flex flex-col",children:[T.jsxs("div",{className:"flex flex-col space-y-4 mb-4",children:[T.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[T.jsx("h3",{className:"text-lg font-medium text-Terretacode-elements-textPrimary",children:"Event Logs"}),T.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[T.jsxs("div",{className:"flex items-center space-x-2",children:[T.jsx("span",{className:"text-sm text-Terretacode-elements-textSecondary whitespace-nowrap",children:"Show Actions"}),T.jsx(Qo,{checked:t,onCheckedChange:d=>ft.showLogs.set(d)})]}),T.jsxs("div",{className:"flex items-center space-x-2",children:[T.jsx("span",{className:"text-sm text-Terretacode-elements-textSecondary whitespace-nowrap",children:"Auto-scroll"}),T.jsx(Qo,{checked:n,onCheckedChange:s})]})]})]}),T.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[T.jsxs("select",{value:e,onChange:d=>r(d.target.value),className:"flex-1 p-2 rounded-lg border border-Terretacode-elements-borderColor bg-Terretacode-elements-prompt-background text-Terretacode-elements-textPrimary focus:outline-none focus:ring-2 focus:ring-Terretacode-elements-focus transition-all lg:max-w-[20%] text-sm min-w-[100px]",children:[T.jsx("option",{value:"all",children:"All"}),T.jsx("option",{value:"info",children:"Info"}),T.jsx("option",{value:"warning",children:"Warning"}),T.jsx("option",{value:"error",children:"Error"}),T.jsx("option",{value:"debug",children:"Debug"})]}),T.jsx("div",{className:"flex-1 min-w-[200px]",children:T.jsx("input",{type:"text",placeholder:"Search logs...",value:i,onChange:d=>o(d.target.value),className:"w-full bg-white dark:bg-Terretacode-elements-background-depth-4 relative px-2 py-1.5 rounded-md focus:outline-none placeholder-Terretacode-elements-textTertiary text-Terretacode-elements-textPrimary dark:text-Terretacode-elements-textPrimary border border-Terretacode-elements-borderColor"})}),t&&T.jsxs("div",{className:"flex items-center gap-2 flex-nowrap",children:[T.jsx("button",{onClick:u,className:qe("bg-Terretacode-elements-button-primary-background","rounded-lg px-4 py-2 transition-colors duration-200","hover:bg-Terretacode-elements-button-primary-backgroundHover","text-Terretacode-elements-button-primary-text"),children:"Export Logs"}),T.jsx("button",{onClick:c,className:qe("bg-Terretacode-elements-button-danger-background","rounded-lg px-4 py-2 transition-colors duration-200","hover:bg-Terretacode-elements-button-danger-backgroundHover","text-Terretacode-elements-button-danger-text"),children:"Clear Logs"})]})]})]}),T.jsx("div",{className:"bg-Terretacode-elements-bg-depth-1 rounded-lg p-4 h-[calc(100vh - 250px)] min-h-[400px] overflow-y-auto logs-container overflow-y-auto",children:l.length===0?T.jsx("div",{className:"text-center text-Terretacode-elements-textSecondary py-8",children:"No logs found"}):l.map((d,f)=>T.jsxs("div",{className:"text-sm mb-3 font-mono border-b border-Terretacode-elements-borderColor pb-2 last:border-0",children:[T.jsxs("div",{className:"flex items-start space-x-2 flex-wrap",children:[T.jsxs("span",{className:`font-bold ${h(d.level)} whitespace-nowrap`,children:["[",d.level.toUpperCase(),"]"]}),T.jsx("span",{className:"text-Terretacode-elements-textSecondary whitespace-nowrap",children:new Date(d.timestamp).toLocaleString()}),T.jsx("span",{className:"text-Terretacode-elements-textPrimary break-all",children:d.message})]}),d.details&&T.jsx("pre",{className:"mt-2 text-xs text-Terretacode-elements-textSecondary overflow-x-auto whitespace-pre-wrap break-all",children:JSON.stringify(d.details,null,2)})]},f))})]})}function ywe(){const[t,e]=I.useState(Ke.get("githubUsername")||""),[r,n]=I.useState(Ke.get("githubToken")||""),[s,i]=I.useState(!1),[o,a]=I.useState(!1);I.useEffect(()=>{t&&r&&l()},[]);const l=async()=>{a(!0);try{const h=await fetch("https://api.github.com/user",{headers:{Authorization:`Bearer ${r}`}});return h.ok&&(await h.json()).login===t?(i(!0),!0):(i(!1),!1)}catch(h){return console.error("Error verifying GitHub credentials:",h),i(!1),!1}finally{a(!1)}},c=async()=>{if(!t||!r){Ne.error("Please provide both GitHub username and token");return}a(!0),await l()?(Ke.set("githubUsername",t),Ke.set("githubToken",r),ft.logSystem("GitHub connection settings updated",{username:t,hasToken:!!r}),Ne.success("GitHub credentials verified and saved successfully!"),Ke.set("git:github.com",JSON.stringify({username:r,password:"x-oauth-basic"})),i(!0)):Ne.error("Invalid GitHub credentials. Please check your username and token.")},u=()=>{Ke.remove("githubUsername"),Ke.remove("githubToken"),Ke.remove("git:github.com"),e(""),n(""),i(!1),ft.logSystem("GitHub connection removed"),Ne.success("GitHub connection removed successfully!")};return T.jsxs("div",{className:"p-4 mb-4 border border-Terretacode-elements-borderColor rounded-lg bg-Terretacode-elements-background-depth-3",children:[T.jsx("h3",{className:"text-lg font-medium text-Terretacode-elements-textPrimary mb-4",children:"Conexión GitHub"}),T.jsxs("div",{className:"flex mb-4",children:[T.jsxs("div",{className:"flex-1 mr-2",children:[T.jsx("label",{className:"block text-sm text-Terretacode-elements-textSecondary mb-1",children:"GitHub Nombre de Usuario:"}),T.jsx("input",{type:"text",value:t,onChange:h=>e(h.target.value),disabled:o,className:"w-full bg-white dark:bg-Terretacode-elements-background-depth-4 relative px-2 py-1.5 rounded-md focus:outline-none placeholder-Terretacode-elements-textTertiary text-Terretacode-elements-textPrimary dark:text-Terretacode-elements-textPrimary border border-Terretacode-elements-borderColor disabled:opacity-50"})]}),T.jsxs("div",{className:"flex-1",children:[T.jsx("label",{className:"block text-sm text-Terretacode-elements-textSecondary mb-1",children:"Token de acceso Personal:"}),T.jsx("input",{type:"password",value:r,onChange:h=>n(h.target.value),disabled:o,className:"w-full bg-white dark:bg-Terretacode-elements-background-depth-4 relative px-2 py-1.5 rounded-md focus:outline-none placeholder-Terretacode-elements-textTertiary text-Terretacode-elements-textPrimary dark:text-Terretacode-elements-textPrimary border border-Terretacode-elements-borderColor disabled:opacity-50"})]})]}),T.jsxs("div",{className:"flex mb-4 items-center",children:[s?T.jsx("button",{onClick:u,className:"bg-Terretacode-elements-button-danger-background rounded-lg px-4 py-2 mr-2 transition-colors duration-200 hover:bg-Terretacode-elements-button-danger-backgroundHover text-Terretacode-elements-button-danger-text",children:"Desconectar"}):T.jsx("button",{onClick:c,disabled:o||!t||!r,className:"bg-Terretacode-elements-button-primary-background rounded-lg px-4 py-2 mr-2 transition-colors duration-200 hover:bg-Terretacode-elements-button-primary-backgroundHover text-Terretacode-elements-button-primary-text disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:o?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"i-ph:spinner animate-spin mr-2"}),"Verificando..."]}):"Conectar"}),s&&T.jsxs("span",{className:"text-sm text-green-600 flex items-center",children:[T.jsx("div",{className:"i-ph:check-circle mr-1"}),"Conectado a GitHub"]})]})]})}const vO=["Anthropic","OpenAI","Google","Groq","HuggingFace","OpenRouter","Deepseek","Mistral","OpenAILike","Together","xAI","Perplexity","Cohere","AzureOpenAI","AmazonBedrock"];function bwe(){const t=x3(),[e,r]=I.useState(!1),n=(d,f)=>{const g=new Blob([JSON.stringify(d,null,2)],{type:"application/json"}),_=URL.createObjectURL(g),m=document.createElement("a");m.href=_,m.download=f,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(_)},s=async()=>{if(!Rt){const d=new Error("Database is not available");ft.logError("Failed to export chats - DB unavailable",d),Ne.error("Database is not available");return}try{const d=await _x(Rt),f={chats:d,exportDate:new Date().toISOString()};n(f,`all-chats-${new Date().toISOString()}.json`),ft.logSystem("Chats exported successfully",{count:d.length}),Ne.success("Chats exported successfully")}catch(d){ft.logError("Failed to export chats",d),Ne.error("Failed to export chats"),console.error(d)}},i=async()=>{if(window.confirm("Are you sure you want to Borrar Chats? This action cannot be undone.")){if(!Rt){const f=new Error("Database is not available");ft.logError("Failed to delete chats - DB unavailable",f),Ne.error("Database is not available");return}try{r(!0);const f=await _x(Rt);await Promise.all(f.map(g=>oj(Rt,g.id))),ft.logSystem("All chats deleted successfully",{count:f.length}),Ne.success("All chats deleted successfully"),t("/",{replace:!0})}catch(f){ft.logError("Failed to delete chats",f),Ne.error("Failed to delete chats"),console.error(f)}finally{r(!1)}}},o=()=>{const d={providers:Ke.get("providers"),isDebugEnabled:Ke.get("isDebugEnabled"),isEventLogsEnabled:Ke.get("isEventLogsEnabled"),isLocalModelsEnabled:Ke.get("isLocalModelsEnabled"),promptId:Ke.get("promptId"),isLatestBranch:Ke.get("isLatestBranch"),commitHash:Ke.get("commitHash"),eventLogs:Ke.get("eventLogs"),selectedModel:Ke.get("selectedModel"),selectedProvider:Ke.get("selectedProvider"),githubUsername:Ke.get("githubUsername"),githubToken:Ke.get("githubToken"),Terretacode_theme:localStorage.getItem("Terretacode_theme")};n(d,"Terretacode-settings.json"),Ne.success("Settings exported successfully")},a=d=>{const f=d.target.files?.[0];if(!f)return;const g=new FileReader;g.onload=_=>{try{const m=JSON.parse(_.target?.result);Object.entries(m).forEach(([p,y])=>{p==="Terretacode_theme"?y&&localStorage.setItem(p,y):y&&Ke.set(p,y)}),Ne.success("Settings imported successfully. Please refresh the page for changes to take effect.")}catch(m){Ne.error("Failed to Importar Ajustes. Make sure the file is a valid JSON file."),console.error("Failed to Importar Ajustes:",m)}},g.readAsText(f),d.target.value=""},l=()=>{const d={};vO.forEach(f=>{d[`${f}_API_KEY`]=""}),d.OPENAI_LIKE_API_BASE_URL="",d.LMSTUDIO_API_BASE_URL="",d.OLLAMA_API_BASE_URL="",d.TOGETHER_API_BASE_URL="",n(d,"api-keys-template.json"),Ne.success("API keys template exported successfully")},c=d=>{const f=d.target.files?.[0];if(!f)return;const g=new FileReader;g.onload=_=>{try{const m=JSON.parse(_.target?.result);let p=0;const y={};vO.forEach(b=>{const v=`${b}_API_KEY`;m[v]&&(y[b]=m[v],p++)}),p>0?(Ke.set("apiKeys",JSON.stringify(y)),Object.entries(y).forEach(([b,v])=>{Ke.set(`${b}_API_KEY`,v)}),Ne.success(`Successfully imported ${p} API keys/URLs. Refreshing page to apply changes...`),setTimeout(()=>{window.location.reload()},1500)):Ne.warn("No valid API keys found in the file"),["OPENAI_LIKE_API_BASE_URL","LMSTUDIO_API_BASE_URL","OLLAMA_API_BASE_URL","TOGETHER_API_BASE_URL"].forEach(b=>{m[b]&&Ke.set(b,m[b])})}catch(m){Ne.error("Failed to Importar API Keys. Make sure the file is a valid JSON file."),console.error("Failed to Importar API Keys:",m)}},g.readAsText(f),d.target.value=""},u=d=>{if(d.messages&&Array.isArray(d.messages)){const f=crypto.randomUUID();return[{id:f,messages:d.messages,description:d.description||"Imported Chat",urlId:f}]}if(d.chats&&Array.isArray(d.chats))return d.chats.map(f=>({id:f.id||crypto.randomUUID(),messages:f.messages,description:f.description||"Imported Chat",urlId:f.urlId}));throw console.error("No matching format found for:",d),new Error("Unsupported chat format")},h=()=>{const d=document.createElement("input");d.type="file",d.accept=".json",d.onchange=async f=>{const g=f.target.files?.[0];if(!g||!Rt){Ne.error("Something went wrong");return}try{const _=await g.text(),m=JSON.parse(_),p=u(m);for(const y of p)await ob(Rt,y.id,y.messages,y.urlId,y.description);ft.logSystem("Chats imported successfully",{count:p.length}),Ne.success(`Successfully imported ${p.length} chat${p.length>1?"s":""}`),window.location.reload()}catch(_){_ instanceof Error?(ft.logError("Failed to Importar Chats:",_),Ne.error("Failed to Importar Chats: "+_.message)):Ne.error("Failed to Importar Chats"),console.error(_)}},d.click()};return T.jsx("div",{className:"p-4 bg-Terretacode-elements-bg-depth-2 border border-Terretacode-elements-borderColor rounded-lg mb-4",children:T.jsxs("div",{className:"mb-6",children:[T.jsx("h3",{className:"text-lg font-medium text-Terretacode-elements-textPrimary mb-4",children:"Gestión de Datos"}),T.jsx("div",{className:"space-y-8",children:T.jsxs("div",{className:"flex flex-col gap-4",children:[T.jsxs("div",{children:[T.jsx("h4",{className:"text-Terretacode-elements-textPrimary mb-2",children:"Historial de Chat"}),T.jsx("p",{className:"text-sm text-Terretacode-elements-textSecondary mb-4",children:"Exportar o eliminar todo tu Historial de Chat."}),T.jsxs("div",{className:"flex gap-4",children:[T.jsx("button",{onClick:s,className:"px-4 py-2 bg-Terretacode-elements-button-primary-background hover:bg-Terretacode-elements-button-primary-backgroundHover text-Terretacode-elements-textPrimary rounded-lg transition-colors",children:"Exportar Chats"}),T.jsx("button",{onClick:h,className:"px-4 py-2 bg-Terretacode-elements-button-primary-background hover:bg-Terretacode-elements-button-primary-backgroundHover text-Terretacode-elements-textPrimary rounded-lg transition-colors",children:"Importar Chats"}),T.jsx("button",{onClick:i,disabled:e,className:qe("px-4 py-2 bg-Terretacode-elements-button-danger-background hover:bg-Terretacode-elements-button-danger-backgroundHover text-Terretacode-elements-button-danger-text rounded-lg transition-colors",e?"opacity-50 cursor-not-allowed":""),children:e?"Deleting...":"Borrar Chats"})]})]}),T.jsxs("div",{children:[T.jsx("h4",{className:"text-Terretacode-elements-textPrimary mb-2",children:"Ajustes Backup"}),T.jsx("p",{className:"text-sm text-Terretacode-elements-textSecondary mb-4",children:"Exporta tus configuraciones a un archivo JSON o importa configuraciones desde un archivo previamente exportado."}),T.jsxs("div",{className:"flex gap-4",children:[T.jsx("button",{onClick:o,className:"px-4 py-2 bg-Terretacode-elements-button-primary-background hover:bg-Terretacode-elements-button-primary-backgroundHover text-Terretacode-elements-textPrimary rounded-lg transition-colors",children:"Exportar Ajustes"}),T.jsxs("label",{className:"px-4 py-2 bg-Terretacode-elements-button-primary-background hover:bg-Terretacode-elements-button-primary-backgroundHover text-Terretacode-elements-textPrimary rounded-lg transition-colors cursor-pointer",children:["Importar Ajustes",T.jsx("input",{type:"file",accept:".json",onChange:a,className:"hidden"})]})]})]}),T.jsxs("div",{children:[T.jsx("h4",{className:"text-Terretacode-elements-textPrimary mb-2",children:"Gestion API Keys"}),T.jsx("p",{className:"text-sm text-Terretacode-elements-textSecondary mb-4",children:"Importa claves API desde un archivo JSON o descarga una plantilla para completar con tus claves."}),T.jsxs("div",{className:"flex gap-4",children:[T.jsx("button",{onClick:l,className:"px-4 py-2 bg-Terretacode-elements-button-primary-background hover:bg-Terretacode-elements-button-primary-backgroundHover text-Terretacode-elements-textPrimary rounded-lg transition-colors",children:"Descargar Plantilla"}),T.jsxs("label",{className:"px-4 py-2 bg-Terretacode-elements-button-primary-background hover:bg-Terretacode-elements-button-primary-backgroundHover text-Terretacode-elements-textPrimary rounded-lg transition-colors cursor-pointer",children:["Importar API Keys",T.jsx("input",{type:"file",accept:".json",onChange:c,className:"hidden"})]})]})]})]})})]})})}const vwe=({open:t,onClose:e})=>{const{debug:r,eventLogs:n}=rh(),[s,i]=I.useState("data"),o=[{id:"data",label:"Datos",icon:"i-ph:database",component:T.jsx(bwe,{})},{id:"providers",label:"Proveedores",icon:"i-ph:key",component:T.jsx(Ope,{})},{id:"connection",label:"Conexiones",icon:"i-ph:link",component:T.jsx(ywe,{})},{id:"features",label:"Funciones",icon:"i-ph:star",component:T.jsx(lwe,{})},...r?[{id:"debug",label:"Debug Tab",icon:"i-ph:bug",component:T.jsx(mwe,{})}]:[],...n?[{id:"event-logs",label:"Event Logs",icon:"i-ph:list-bullets",component:T.jsx(_we,{})}]:[]];return T.jsx(z6,{open:t,children:T.jsxs(V6,{children:[T.jsx(G6,{asChild:!0,onClick:e,children:T.jsx(yr.div,{className:"bg-black/50 fixed inset-0 z-max backdrop-blur-sm",initial:"closed",animate:"open",exit:"closed",variants:Y6})}),T.jsx(W6,{"aria-describedby":void 0,asChild:!0,children:T.jsxs(yr.div,{className:"fixed top-[50%] left-[50%] z-max h-[85vh] w-[90vw] max-w-[900px] translate-x-[-50%] translate-y-[-50%] border border-Terretacode-elements-borderColor rounded-lg shadow-lg focus:outline-none overflow-hidden",initial:"closed",animate:"open",exit:"closed",variants:X6,children:[T.jsxs("div",{className:"flex h-full",children:[T.jsxs("div",{className:qe("w-48 border-r border-Terretacode-elements-borderColor bg-Terretacode-elements-background-depth-1 p-4 flex flex-col justify-between",Am["settings-tabs"]),children:[T.jsx(Z6,{className:"flex-shrink-0 text-lg font-semibold text-Terretacode-elements-textPrimary mb-2",children:"Ajustes"}),o.map(a=>T.jsxs("button",{onClick:()=>i(a.id),className:qe(s===a.id?Am.active:""),children:[T.jsx("div",{className:a.icon}),a.label]},a.id)),T.jsxs("div",{className:"mt-auto flex flex-col gap-2",children:[T.jsxs("a",{href:"https://Terretacode.com",target:"_blank",rel:"noopener noreferrer",className:qe(Am["settings-button"],"flex items-center gap-2"),children:[T.jsx("div",{className:"i-ph:github-logo"}),"GitHub"]}),T.jsxs("a",{href:"https://Terretacode.com",target:"_blank",rel:"noopener noreferrer",className:qe(Am["settings-button"],"flex items-center gap-2"),children:[T.jsx("div",{className:"i-ph:book"}),"Terretacode"]})]})]}),T.jsx("div",{className:"flex-1 flex flex-col p-8 pt-10 bg-Terretacode-elements-background-depth-2",children:T.jsx("div",{className:"flex-1 overflow-y-auto",children:o.find(a=>a.id===s)?.component})})]}),T.jsx(q6,{asChild:!0,onClick:e,children:T.jsx(cr,{icon:"i-ph:x",className:"absolute top-[10px] right-[10px]"})})]})})]})})},wwe=I.memo(({onClick:t})=>T.jsx(cr,{onClick:t,icon:"i-ph:gear",size:"xl",title:"Settings",className:"text-[#666] hover:text-Terretacode-elements-textPrimary hover:bg-Terretacode-elements-item-backgroundActive/10 transition-colors"})),Ewe=["top","right","bottom","left"],Ra=Math.min,zn=Math.max,__=Math.round,Zm=Math.floor,Mi=t=>({x:t,y:t}),xwe={left:"right",right:"left",bottom:"top",top:"bottom"},Swe={start:"end",end:"start"};function Rx(t,e,r){return zn(t,Ra(e,r))}function xo(t,e){return typeof t=="function"?t(e):t}function So(t){return t.split("-")[0]}function ch(t){return t.split("-")[1]}function Sk(t){return t==="x"?"y":"x"}function Tk(t){return t==="y"?"height":"width"}function Ia(t){return["top","bottom"].includes(So(t))?"y":"x"}function Ck(t){return Sk(Ia(t))}function Twe(t,e,r){r===void 0&&(r=!1);const n=ch(t),s=Ck(t),i=Tk(s);let o=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=y_(o)),[o,y_(o)]}function Cwe(t){const e=y_(t);return[Ix(t),e,Ix(e)]}function Ix(t){return t.replace(/start|end/g,e=>Swe[e])}function kwe(t,e,r){const n=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return r?e?s:n:e?n:s;case"left":case"right":return e?i:o;default:return[]}}function Awe(t,e,r,n){const s=ch(t);let i=kwe(So(t),r==="start",n);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(Ix)))),i}function y_(t){return t.replace(/left|right|bottom|top/g,e=>xwe[e])}function Rwe(t){return{top:0,right:0,bottom:0,left:0,...t}}function XU(t){return typeof t!="number"?Rwe(t):{top:t,right:t,bottom:t,left:t}}function b_(t){const{x:e,y:r,width:n,height:s}=t;return{width:n,height:s,top:r,left:e,right:e+n,bottom:r+s,x:e,y:r}}function wO(t,e,r){let{reference:n,floating:s}=t;const i=Ia(e),o=Ck(e),a=Tk(o),l=So(e),c=i==="y",u=n.x+n.width/2-s.width/2,h=n.y+n.height/2-s.height/2,d=n[a]/2-s[a]/2;let f;switch(l){case"top":f={x:u,y:n.y-s.height};break;case"bottom":f={x:u,y:n.y+n.height};break;case"right":f={x:n.x+n.width,y:h};break;case"left":f={x:n.x-s.width,y:h};break;default:f={x:n.x,y:n.y}}switch(ch(e)){case"start":f[o]-=d*(r&&c?-1:1);break;case"end":f[o]+=d*(r&&c?-1:1);break}return f}const Iwe=async(t,e,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:i=[],platform:o}=r,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:u,y:h}=wO(c,n,l),d=n,f={},g=0;for(let _=0;_<a.length;_++){const{name:m,fn:p}=a[_],{x:y,y:b,data:v,reset:w}=await p({x:u,y:h,initialPlacement:n,placement:d,strategy:s,middlewareData:f,rects:c,platform:o,elements:{reference:t,floating:e}});u=y??u,h=b??h,f={...f,[m]:{...f[m],...v}},w&&g<=50&&(g++,typeof w=="object"&&(w.placement&&(d=w.placement),w.rects&&(c=w.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):w.rects),{x:u,y:h}=wO(c,d,l)),_=-1)}return{x:u,y:h,placement:d,strategy:s,middlewareData:f}};async function Sf(t,e){var r;e===void 0&&(e={});const{x:n,y:s,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:d=!1,padding:f=0}=xo(e,t),g=XU(f),m=a[d?h==="floating"?"reference":"floating":h],p=b_(await i.getClippingRect({element:(r=await(i.isElement==null?void 0:i.isElement(m)))==null||r?m:m.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),y=h==="floating"?{x:n,y:s,width:o.floating.width,height:o.floating.height}:o.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),v=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},w=b_(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:y,offsetParent:b,strategy:l}):y);return{top:(p.top-w.top+g.top)/v.y,bottom:(w.bottom-p.bottom+g.bottom)/v.y,left:(p.left-w.left+g.left)/v.x,right:(w.right-p.right+g.right)/v.x}}const Pwe=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:n,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=xo(t,e)||{};if(c==null)return{};const h=XU(u),d={x:r,y:n},f=Ck(s),g=Tk(f),_=await o.getDimensions(c),m=f==="y",p=m?"top":"left",y=m?"bottom":"right",b=m?"clientHeight":"clientWidth",v=i.reference[g]+i.reference[f]-d[f]-i.floating[g],w=d[f]-i.reference[f],E=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let S=E?E[b]:0;(!S||!await(o.isElement==null?void 0:o.isElement(E)))&&(S=a.floating[b]||i.floating[g]);const x=v/2-w/2,C=S/2-_[g]/2-1,A=Ra(h[p],C),M=Ra(h[y],C),P=A,D=S-_[g]-M,R=S/2-_[g]/2+x,G=Rx(P,R,D),ee=!l.arrow&&ch(s)!=null&&R!==G&&i.reference[g]/2-(R<P?A:M)-_[g]/2<0,q=ee?R<P?R-P:R-D:0;return{[f]:d[f]+q,data:{[f]:G,centerOffset:R-G-q,...ee&&{alignmentOffset:q}},reset:ee}}}),Owe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:d,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:_=!0,...m}=xo(t,e);if((r=i.arrow)!=null&&r.alignmentOffset)return{};const p=So(s),y=Ia(a),b=So(a)===a,v=await(l.isRTL==null?void 0:l.isRTL(c.floating)),w=d||(b||!_?[y_(a)]:Cwe(a)),E=g!=="none";!d&&E&&w.push(...Awe(a,_,g,v));const S=[a,...w],x=await Sf(e,m),C=[];let A=((n=i.flip)==null?void 0:n.overflows)||[];if(u&&C.push(x[p]),h){const R=Twe(s,o,v);C.push(x[R[0]],x[R[1]])}if(A=[...A,{placement:s,overflows:C}],!C.every(R=>R<=0)){var M,P;const R=(((M=i.flip)==null?void 0:M.index)||0)+1,G=S[R];if(G)return{data:{index:R,overflows:A},reset:{placement:G}};let ee=(P=A.filter(q=>q.overflows[0]<=0).sort((q,re)=>q.overflows[1]-re.overflows[1])[0])==null?void 0:P.placement;if(!ee)switch(f){case"bestFit":{var D;const q=(D=A.filter(re=>{if(E){const N=Ia(re.placement);return N===y||N==="y"}return!0}).map(re=>[re.placement,re.overflows.filter(N=>N>0).reduce((N,B)=>N+B,0)]).sort((re,N)=>re[1]-N[1])[0])==null?void 0:D[0];q&&(ee=q);break}case"initialPlacement":ee=a;break}if(s!==ee)return{reset:{placement:ee}}}return{}}}};function EO(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function xO(t){return Ewe.some(e=>t[e]>=0)}const Dwe=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:n="referenceHidden",...s}=xo(t,e);switch(n){case"referenceHidden":{const i=await Sf(e,{...s,elementContext:"reference"}),o=EO(i,r.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:xO(o)}}}case"escaped":{const i=await Sf(e,{...s,altBoundary:!0}),o=EO(i,r.floating);return{data:{escapedOffsets:o,escaped:xO(o)}}}default:return{}}}}};async function Lwe(t,e){const{placement:r,platform:n,elements:s}=t,i=await(n.isRTL==null?void 0:n.isRTL(s.floating)),o=So(r),a=ch(r),l=Ia(r)==="y",c=["left","top"].includes(o)?-1:1,u=i&&l?-1:1,h=xo(e,t);let{mainAxis:d,crossAxis:f,alignmentAxis:g}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return a&&typeof g=="number"&&(f=a==="end"?g*-1:g),l?{x:f*u,y:d*c}:{x:d*c,y:f*u}}const Nwe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await Lwe(e,t);return o===((r=a.offset)==null?void 0:r.placement)&&(n=a.arrow)!=null&&n.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},Mwe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:m=>{let{x:p,y}=m;return{x:p,y}}},...l}=xo(t,e),c={x:r,y:n},u=await Sf(e,l),h=Ia(So(s)),d=Sk(h);let f=c[d],g=c[h];if(i){const m=d==="y"?"top":"left",p=d==="y"?"bottom":"right",y=f+u[m],b=f-u[p];f=Rx(y,f,b)}if(o){const m=h==="y"?"top":"left",p=h==="y"?"bottom":"right",y=g+u[m],b=g-u[p];g=Rx(y,g,b)}const _=a.fn({...e,[d]:f,[h]:g});return{..._,data:{x:_.x-r,y:_.y-n,enabled:{[d]:i,[h]:o}}}}}},Bwe=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:n,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=xo(t,e),u={x:r,y:n},h=Ia(s),d=Sk(h);let f=u[d],g=u[h];const _=xo(a,e),m=typeof _=="number"?{mainAxis:_,crossAxis:0}:{mainAxis:0,crossAxis:0,..._};if(l){const b=d==="y"?"height":"width",v=i.reference[d]-i.floating[b]+m.mainAxis,w=i.reference[d]+i.reference[b]-m.mainAxis;f<v?f=v:f>w&&(f=w)}if(c){var p,y;const b=d==="y"?"width":"height",v=["top","left"].includes(So(s)),w=i.reference[h]-i.floating[b]+(v&&((p=o.offset)==null?void 0:p[h])||0)+(v?0:m.crossAxis),E=i.reference[h]+i.reference[b]+(v?0:((y=o.offset)==null?void 0:y[h])||0)-(v?m.crossAxis:0);g<w?g=w:g>E&&(g=E)}return{[d]:f,[h]:g}}}},Fwe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,n;const{placement:s,rects:i,platform:o,elements:a}=e,{apply:l=()=>{},...c}=xo(t,e),u=await Sf(e,c),h=So(s),d=ch(s),f=Ia(s)==="y",{width:g,height:_}=i.floating;let m,p;h==="top"||h==="bottom"?(m=h,p=d===(await(o.isRTL==null?void 0:o.isRTL(a.floating))?"start":"end")?"left":"right"):(p=h,m=d==="end"?"top":"bottom");const y=_-u.top-u.bottom,b=g-u.left-u.right,v=Ra(_-u[m],y),w=Ra(g-u[p],b),E=!e.middlewareData.shift;let S=v,x=w;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(x=b),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(S=y),E&&!d){const A=zn(u.left,0),M=zn(u.right,0),P=zn(u.top,0),D=zn(u.bottom,0);f?x=g-2*(A!==0||M!==0?A+M:zn(u.left,u.right)):S=_-2*(P!==0||D!==0?P+D:zn(u.top,u.bottom))}await l({...e,availableWidth:x,availableHeight:S});const C=await o.getDimensions(a.floating);return g!==C.width||_!==C.height?{reset:{rects:!0}}:{}}}};function _b(){return typeof window<"u"}function uh(t){return ZU(t)?(t.nodeName||"").toLowerCase():"#document"}function Zn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function qi(t){var e;return(e=(ZU(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function ZU(t){return _b()?t instanceof Node||t instanceof Zn(t).Node:!1}function $s(t){return _b()?t instanceof Element||t instanceof Zn(t).Element:!1}function Ui(t){return _b()?t instanceof HTMLElement||t instanceof Zn(t).HTMLElement:!1}function SO(t){return!_b()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Zn(t).ShadowRoot}function Dp(t){const{overflow:e,overflowX:r,overflowY:n,display:s}=Hs(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(s)}function jwe(t){return["table","td","th"].includes(uh(t))}function yb(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function kk(t){const e=Ak(),r=$s(t)?Hs(t):t;return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function Uwe(t){let e=Pa(t);for(;Ui(e)&&!Iu(e);){if(kk(e))return e;if(yb(e))return null;e=Pa(e)}return null}function Ak(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Iu(t){return["html","body","#document"].includes(uh(t))}function Hs(t){return Zn(t).getComputedStyle(t)}function bb(t){return $s(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Pa(t){if(uh(t)==="html")return t;const e=t.assignedSlot||t.parentNode||SO(t)&&t.host||qi(t);return SO(e)?e.host:e}function JU(t){const e=Pa(t);return Iu(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ui(e)&&Dp(e)?e:JU(e)}function Tf(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const s=JU(t),i=s===((n=t.ownerDocument)==null?void 0:n.body),o=Zn(s);if(i){const a=Px(o);return e.concat(o,o.visualViewport||[],Dp(s)?s:[],a&&r?Tf(a):[])}return e.concat(s,Tf(s,[],r))}function Px(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function QU(t){const e=Hs(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const s=Ui(t),i=s?t.offsetWidth:r,o=s?t.offsetHeight:n,a=__(r)!==i||__(n)!==o;return a&&(r=i,n=o),{width:r,height:n,$:a}}function Rk(t){return $s(t)?t:t.contextElement}function su(t){const e=Rk(t);if(!Ui(e))return Mi(1);const r=e.getBoundingClientRect(),{width:n,height:s,$:i}=QU(e);let o=(i?__(r.width):r.width)/n,a=(i?__(r.height):r.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const $we=Mi(0);function e$(t){const e=Zn(t);return!Ak()||!e.visualViewport?$we:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Hwe(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Zn(t)?!1:e}function Hl(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const s=t.getBoundingClientRect(),i=Rk(t);let o=Mi(1);e&&(n?$s(n)&&(o=su(n)):o=su(t));const a=Hwe(i,r,n)?e$(i):Mi(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,h=s.height/o.y;if(i){const d=Zn(i),f=n&&$s(n)?Zn(n):n;let g=d,_=Px(g);for(;_&&n&&f!==g;){const m=su(_),p=_.getBoundingClientRect(),y=Hs(_),b=p.left+(_.clientLeft+parseFloat(y.paddingLeft))*m.x,v=p.top+(_.clientTop+parseFloat(y.paddingTop))*m.y;l*=m.x,c*=m.y,u*=m.x,h*=m.y,l+=b,c+=v,g=Zn(_),_=Px(g)}}return b_({width:u,height:h,x:l,y:c})}function Ik(t,e){const r=bb(t).scrollLeft;return e?e.left+r:Hl(qi(t)).left+r}function t$(t,e,r){r===void 0&&(r=!1);const n=t.getBoundingClientRect(),s=n.left+e.scrollLeft-(r?0:Ik(t,n)),i=n.top+e.scrollTop;return{x:s,y:i}}function zwe(t){let{elements:e,rect:r,offsetParent:n,strategy:s}=t;const i=s==="fixed",o=qi(n),a=e?yb(e.floating):!1;if(n===o||a&&i)return r;let l={scrollLeft:0,scrollTop:0},c=Mi(1);const u=Mi(0),h=Ui(n);if((h||!h&&!i)&&((uh(n)!=="body"||Dp(o))&&(l=bb(n)),Ui(n))){const f=Hl(n);c=su(n),u.x=f.x+n.clientLeft,u.y=f.y+n.clientTop}const d=o&&!h&&!i?t$(o,l,!0):Mi(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-l.scrollLeft*c.x+u.x+d.x,y:r.y*c.y-l.scrollTop*c.y+u.y+d.y}}function Vwe(t){return Array.from(t.getClientRects())}function Gwe(t){const e=qi(t),r=bb(t),n=t.ownerDocument.body,s=zn(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),i=zn(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let o=-r.scrollLeft+Ik(t);const a=-r.scrollTop;return Hs(n).direction==="rtl"&&(o+=zn(e.clientWidth,n.clientWidth)-s),{width:s,height:i,x:o,y:a}}function Wwe(t,e){const r=Zn(t),n=qi(t),s=r.visualViewport;let i=n.clientWidth,o=n.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const c=Ak();(!c||c&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:i,height:o,x:a,y:l}}function qwe(t,e){const r=Hl(t,!0,e==="fixed"),n=r.top+t.clientTop,s=r.left+t.clientLeft,i=Ui(t)?su(t):Mi(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=s*i.x,c=n*i.y;return{width:o,height:a,x:l,y:c}}function TO(t,e,r){let n;if(e==="viewport")n=Wwe(t,r);else if(e==="document")n=Gwe(qi(t));else if($s(e))n=qwe(e,r);else{const s=e$(t);n={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return b_(n)}function r$(t,e){const r=Pa(t);return r===e||!$s(r)||Iu(r)?!1:Hs(r).position==="fixed"||r$(r,e)}function Kwe(t,e){const r=e.get(t);if(r)return r;let n=Tf(t,[],!1).filter(a=>$s(a)&&uh(a)!=="body"),s=null;const i=Hs(t).position==="fixed";let o=i?Pa(t):t;for(;$s(o)&&!Iu(o);){const a=Hs(o),l=kk(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||Dp(o)&&!l&&r$(t,o))?n=n.filter(u=>u!==o):s=a,o=Pa(o)}return e.set(t,n),n}function Ywe(t){let{element:e,boundary:r,rootBoundary:n,strategy:s}=t;const o=[...r==="clippingAncestors"?yb(e)?[]:Kwe(e,this._c):[].concat(r),n],a=o[0],l=o.reduce((c,u)=>{const h=TO(e,u,s);return c.top=zn(h.top,c.top),c.right=Ra(h.right,c.right),c.bottom=Ra(h.bottom,c.bottom),c.left=zn(h.left,c.left),c},TO(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Xwe(t){const{width:e,height:r}=QU(t);return{width:e,height:r}}function Zwe(t,e,r){const n=Ui(e),s=qi(e),i=r==="fixed",o=Hl(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=Mi(0);if(n||!n&&!i)if((uh(e)!=="body"||Dp(s))&&(a=bb(e)),n){const d=Hl(e,!0,i,e);l.x=d.x+e.clientLeft,l.y=d.y+e.clientTop}else s&&(l.x=Ik(s));const c=s&&!n&&!i?t$(s,a):Mi(0),u=o.left+a.scrollLeft-l.x-c.x,h=o.top+a.scrollTop-l.y-c.y;return{x:u,y:h,width:o.width,height:o.height}}function ww(t){return Hs(t).position==="static"}function CO(t,e){if(!Ui(t)||Hs(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return qi(t)===r&&(r=r.ownerDocument.body),r}function n$(t,e){const r=Zn(t);if(yb(t))return r;if(!Ui(t)){let s=Pa(t);for(;s&&!Iu(s);){if($s(s)&&!ww(s))return s;s=Pa(s)}return r}let n=CO(t,e);for(;n&&jwe(n)&&ww(n);)n=CO(n,e);return n&&Iu(n)&&ww(n)&&!kk(n)?r:n||Uwe(t)||r}const Jwe=async function(t){const e=this.getOffsetParent||n$,r=this.getDimensions,n=await r(t.floating);return{reference:Zwe(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Qwe(t){return Hs(t).direction==="rtl"}const e1e={convertOffsetParentRelativeRectToViewportRelativeRect:zwe,getDocumentElement:qi,getClippingRect:Ywe,getOffsetParent:n$,getElementRects:Jwe,getClientRects:Vwe,getDimensions:Xwe,getScale:su,isElement:$s,isRTL:Qwe};function t1e(t,e){let r=null,n;const s=qi(t);function i(){var a;clearTimeout(n),(a=r)==null||a.disconnect(),r=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const{left:c,top:u,width:h,height:d}=t.getBoundingClientRect();if(a||e(),!h||!d)return;const f=Zm(u),g=Zm(s.clientWidth-(c+h)),_=Zm(s.clientHeight-(u+d)),m=Zm(c),y={rootMargin:-f+"px "+-g+"px "+-_+"px "+-m+"px",threshold:zn(0,Ra(1,l))||1};let b=!0;function v(w){const E=w[0].intersectionRatio;if(E!==l){if(!b)return o();E?o(!1,E):n=setTimeout(()=>{o(!1,1e-7)},1e3)}b=!1}try{r=new IntersectionObserver(v,{...y,root:s.ownerDocument})}catch{r=new IntersectionObserver(v,y)}r.observe(t)}return o(!0),i}function r1e(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=Rk(t),u=s||i?[...c?Tf(c):[],...Tf(e)]:[];u.forEach(p=>{s&&p.addEventListener("scroll",r,{passive:!0}),i&&p.addEventListener("resize",r)});const h=c&&a?t1e(c,r):null;let d=-1,f=null;o&&(f=new ResizeObserver(p=>{let[y]=p;y&&y.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(e)})),r()}),c&&!l&&f.observe(c),f.observe(e));let g,_=l?Hl(t):null;l&&m();function m(){const p=Hl(t);_&&(p.x!==_.x||p.y!==_.y||p.width!==_.width||p.height!==_.height)&&r(),_=p,g=requestAnimationFrame(m)}return r(),()=>{var p;u.forEach(y=>{s&&y.removeEventListener("scroll",r),i&&y.removeEventListener("resize",r)}),h?.(),(p=f)==null||p.disconnect(),f=null,l&&cancelAnimationFrame(g)}}const n1e=Nwe,s1e=Mwe,i1e=Owe,o1e=Fwe,a1e=Dwe,kO=Pwe,l1e=Bwe,c1e=(t,e,r)=>{const n=new Map,s={platform:e1e,...r},i={...s.platform,_c:n};return Iwe(t,e,{...s,platform:i})};var r0=typeof document<"u"?I.useLayoutEffect:I.useEffect;function v_(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,n,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(n=r;n--!==0;)if(!v_(t[n],e[n]))return!1;return!0}if(s=Object.keys(t),r=s.length,r!==Object.keys(e).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(e,s[n]))return!1;for(n=r;n--!==0;){const i=s[n];if(!(i==="_owner"&&t.$$typeof)&&!v_(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function s$(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function AO(t,e){const r=s$(t);return Math.round(e*r)/r}function Ew(t){const e=I.useRef(t);return r0(()=>{e.current=t}),e}function u1e(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,h]=I.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[d,f]=I.useState(n);v_(d,n)||f(n);const[g,_]=I.useState(null),[m,p]=I.useState(null),y=I.useCallback(re=>{re!==E.current&&(E.current=re,_(re))},[]),b=I.useCallback(re=>{re!==S.current&&(S.current=re,p(re))},[]),v=i||g,w=o||m,E=I.useRef(null),S=I.useRef(null),x=I.useRef(u),C=l!=null,A=Ew(l),M=Ew(s),P=Ew(c),D=I.useCallback(()=>{if(!E.current||!S.current)return;const re={placement:e,strategy:r,middleware:d};M.current&&(re.platform=M.current),c1e(E.current,S.current,re).then(N=>{const B={...N,isPositioned:P.current!==!1};R.current&&!v_(x.current,B)&&(x.current=B,E3.flushSync(()=>{h(B)}))})},[d,e,r,M,P]);r0(()=>{c===!1&&x.current.isPositioned&&(x.current.isPositioned=!1,h(re=>({...re,isPositioned:!1})))},[c]);const R=I.useRef(!1);r0(()=>(R.current=!0,()=>{R.current=!1}),[]),r0(()=>{if(v&&(E.current=v),w&&(S.current=w),v&&w){if(A.current)return A.current(v,w,D);D()}},[v,w,D,A,C]);const G=I.useMemo(()=>({reference:E,floating:S,setReference:y,setFloating:b}),[y,b]),ee=I.useMemo(()=>({reference:v,floating:w}),[v,w]),q=I.useMemo(()=>{const re={position:r,left:0,top:0};if(!ee.floating)return re;const N=AO(ee.floating,u.x),B=AO(ee.floating,u.y);return a?{...re,transform:"translate("+N+"px, "+B+"px)",...s$(ee.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:N,top:B}},[r,a,ee.floating,u.x,u.y]);return I.useMemo(()=>({...u,update:D,refs:G,elements:ee,floatingStyles:q}),[u,D,G,ee,q])}const h1e=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:n,padding:s}=typeof t=="function"?t(r):t;return n&&e(n)?n.current!=null?kO({element:n.current,padding:s}).fn(r):{}:n?kO({element:n,padding:s}).fn(r):{}}}},d1e=(t,e)=>({...n1e(t),options:[t,e]}),f1e=(t,e)=>({...s1e(t),options:[t,e]}),p1e=(t,e)=>({...l1e(t),options:[t,e]}),m1e=(t,e)=>({...i1e(t),options:[t,e]}),g1e=(t,e)=>({...o1e(t),options:[t,e]}),_1e=(t,e)=>({...a1e(t),options:[t,e]}),y1e=(t,e)=>({...h1e(t),options:[t,e]});var b1e="Arrow",i$=I.forwardRef((t,e)=>{const{children:r,width:n=10,height:s=5,...i}=t;return T.jsx(Gt.svg,{...i,ref:e,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:T.jsx("polygon",{points:"0,0 30,0 15,10"})})});i$.displayName=b1e;var v1e=i$;function Pk(t,e=[]){let r=[];function n(i,o){const a=I.createContext(o),l=r.length;r=[...r,o];function c(h){const{scope:d,children:f,...g}=h,_=d?.[t][l]||a,m=I.useMemo(()=>g,Object.values(g));return T.jsx(_.Provider,{value:m,children:f})}function u(h,d){const f=d?.[t][l]||a,g=I.useContext(f);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return c.displayName=i+"Provider",[c,u]}const s=()=>{const i=r.map(o=>I.createContext(o));return function(a){const l=a?.[t]||i;return I.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[n,w1e(s,...e)]}function w1e(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const n=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=n.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return I.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return r.scopeName=e.scopeName,r}var Ok="Popper",[o$,vb]=Pk(Ok),[E1e,a$]=o$(Ok),l$=t=>{const{__scopePopper:e,children:r}=t,[n,s]=I.useState(null);return T.jsx(E1e,{scope:e,anchor:n,onAnchorChange:s,children:r})};l$.displayName=Ok;var c$="PopperAnchor",u$=I.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:n,...s}=t,i=a$(c$,r),o=I.useRef(null),a=gr(e,o);return I.useEffect(()=>{i.onAnchorChange(n?.current||o.current)}),n?null:T.jsx(Gt.div,{...s,ref:a})});u$.displayName=c$;var Dk="PopperContent",[x1e,S1e]=o$(Dk),h$=I.forwardRef((t,e)=>{const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:d=!1,updatePositionStrategy:f="optimized",onPlaced:g,..._}=t,m=a$(Dk,r),[p,y]=I.useState(null),b=gr(e,J=>y(J)),[v,w]=I.useState(null),E=J6(v),S=E?.width??0,x=E?.height??0,C=n+(i!=="center"?"-"+i:""),A=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},M=Array.isArray(c)?c:[c],P=M.length>0,D={padding:A,boundary:M.filter(C1e),altBoundary:P},{refs:R,floatingStyles:G,placement:ee,isPositioned:q,middlewareData:re}=u1e({strategy:"fixed",placement:C,whileElementsMounted:(...J)=>r1e(...J,{animationFrame:f==="always"}),elements:{reference:m.anchor},middleware:[d1e({mainAxis:s+x,alignmentAxis:o}),l&&f1e({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?p1e():void 0,...D}),l&&m1e({...D}),g1e({...D,apply:({elements:J,rects:V,availableWidth:fe,availableHeight:de})=>{const{width:be,height:me}=V.reference,ve=J.floating.style;ve.setProperty("--radix-popper-available-width",`${fe}px`),ve.setProperty("--radix-popper-available-height",`${de}px`),ve.setProperty("--radix-popper-anchor-width",`${be}px`),ve.setProperty("--radix-popper-anchor-height",`${me}px`)}}),v&&y1e({element:v,padding:a}),k1e({arrowWidth:S,arrowHeight:x}),d&&_1e({strategy:"referenceHidden",...D})]}),[N,B]=p$(ee),$=xs(g);Nl(()=>{q&&$?.()},[q,$]);const H=re.arrow?.x,U=re.arrow?.y,Q=re.arrow?.centerOffset!==0,[ne,ge]=I.useState();return Nl(()=>{p&&ge(window.getComputedStyle(p).zIndex)},[p]),T.jsx("div",{ref:R.setFloating,"data-radix-popper-content-wrapper":"",style:{...G,transform:q?G.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ne,"--radix-popper-transform-origin":[re.transformOrigin?.x,re.transformOrigin?.y].join(" "),...re.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:T.jsx(x1e,{scope:r,placedSide:N,onArrowChange:w,arrowX:H,arrowY:U,shouldHideArrow:Q,children:T.jsx(Gt.div,{"data-side":N,"data-align":B,..._,ref:b,style:{..._.style,animation:q?void 0:"none"}})})})});h$.displayName=Dk;var d$="PopperArrow",T1e={top:"bottom",right:"left",bottom:"top",left:"right"},f$=I.forwardRef(function(e,r){const{__scopePopper:n,...s}=e,i=S1e(d$,n),o=T1e[i.placedSide];return T.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:T.jsx(v1e,{...s,ref:r,style:{...s.style,display:"block"}})})});f$.displayName=d$;function C1e(t){return t!==null}var k1e=t=>({name:"transformOrigin",options:t,fn(e){const{placement:r,rects:n,middlewareData:s}=e,o=s.arrow?.centerOffset!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=p$(r),h={start:"0%",center:"50%",end:"100%"}[u],d=(s.arrow?.x??0)+a/2,f=(s.arrow?.y??0)+l/2;let g="",_="";return c==="bottom"?(g=o?h:`${d}px`,_=`${-l}px`):c==="top"?(g=o?h:`${d}px`,_=`${n.floating.height+l}px`):c==="right"?(g=`${-l}px`,_=o?h:`${f}px`):c==="left"&&(g=`${n.floating.width+l}px`,_=o?h:`${f}px`),{data:{x:g,y:_}}}});function p$(t){const[e,r="center"]=t.split("-");return[e,r]}var m$=l$,g$=u$,_$=h$,y$=f$,A1e="VisuallyHidden",b$=I.forwardRef((t,e)=>T.jsx(Gt.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));b$.displayName=A1e;var R1e=b$,[wb,n9e]=Ju("Tooltip",[vb]),Eb=vb(),v$="TooltipProvider",I1e=700,Ox="tooltip.open",[P1e,Lk]=wb(v$),w_=t=>{const{__scopeTooltip:e,delayDuration:r=I1e,skipDelayDuration:n=300,disableHoverableContent:s=!1,children:i}=t,[o,a]=I.useState(!0),l=I.useRef(!1),c=I.useRef(0);return I.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),T.jsx(P1e,{scope:e,isOpenDelayed:o,delayDuration:r,onOpen:I.useCallback(()=>{window.clearTimeout(c.current),a(!1)},[]),onClose:I.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>a(!0),n)},[n]),isPointerInTransitRef:l,onPointerInTransitChange:I.useCallback(u=>{l.current=u},[]),disableHoverableContent:s,children:i})};w_.displayName=v$;var xb="Tooltip",[O1e,Lp]=wb(xb),w$=t=>{const{__scopeTooltip:e,children:r,open:n,defaultOpen:s=!1,onOpenChange:i,disableHoverableContent:o,delayDuration:a}=t,l=Lk(xb,t.__scopeTooltip),c=Eb(e),[u,h]=I.useState(null),d=Tl(),f=I.useRef(0),g=o??l.disableHoverableContent,_=a??l.delayDuration,m=I.useRef(!1),[p=!1,y]=Ep({prop:n,defaultProp:s,onChange:S=>{S?(l.onOpen(),document.dispatchEvent(new CustomEvent(Ox))):l.onClose(),i?.(S)}}),b=I.useMemo(()=>p?m.current?"delayed-open":"instant-open":"closed",[p]),v=I.useCallback(()=>{window.clearTimeout(f.current),f.current=0,m.current=!1,y(!0)},[y]),w=I.useCallback(()=>{window.clearTimeout(f.current),f.current=0,y(!1)},[y]),E=I.useCallback(()=>{window.clearTimeout(f.current),f.current=window.setTimeout(()=>{m.current=!0,y(!0),f.current=0},_)},[_,y]);return I.useEffect(()=>()=>{f.current&&(window.clearTimeout(f.current),f.current=0)},[]),T.jsx(m$,{...c,children:T.jsx(O1e,{scope:e,contentId:d,open:p,stateAttribute:b,trigger:u,onTriggerChange:h,onTriggerEnter:I.useCallback(()=>{l.isOpenDelayed?E():v()},[l.isOpenDelayed,E,v]),onTriggerLeave:I.useCallback(()=>{g?w():(window.clearTimeout(f.current),f.current=0)},[w,g]),onOpen:v,onClose:w,disableHoverableContent:g,children:r})})};w$.displayName=xb;var Dx="TooltipTrigger",E$=I.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=Lp(Dx,r),i=Lk(Dx,r),o=Eb(r),a=I.useRef(null),l=gr(e,a,s.onTriggerChange),c=I.useRef(!1),u=I.useRef(!1),h=I.useCallback(()=>c.current=!1,[]);return I.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),T.jsx(g$,{asChild:!0,...o,children:T.jsx(Gt.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...n,ref:l,onPointerMove:et(t.onPointerMove,d=>{d.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:et(t.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:et(t.onPointerDown,()=>{c.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:et(t.onFocus,()=>{c.current||s.onOpen()}),onBlur:et(t.onBlur,s.onClose),onClick:et(t.onClick,s.onClose)})})});E$.displayName=Dx;var Nk="TooltipPortal",[D1e,L1e]=wb(Nk,{forceMount:void 0}),x$=t=>{const{__scopeTooltip:e,forceMount:r,children:n,container:s}=t,i=Lp(Nk,e);return T.jsx(D1e,{scope:e,forceMount:r,children:T.jsx(Hi,{present:r||i.open,children:T.jsx(Uy,{asChild:!0,container:s,children:n})})})};x$.displayName=Nk;var Pu="TooltipContent",S$=I.forwardRef((t,e)=>{const r=L1e(Pu,t.__scopeTooltip),{forceMount:n=r.forceMount,side:s="top",...i}=t,o=Lp(Pu,t.__scopeTooltip);return T.jsx(Hi,{present:n||o.open,children:o.disableHoverableContent?T.jsx(T$,{side:s,...i,ref:e}):T.jsx(N1e,{side:s,...i,ref:e})})}),N1e=I.forwardRef((t,e)=>{const r=Lp(Pu,t.__scopeTooltip),n=Lk(Pu,t.__scopeTooltip),s=I.useRef(null),i=gr(e,s),[o,a]=I.useState(null),{trigger:l,onClose:c}=r,u=s.current,{onPointerInTransitChange:h}=n,d=I.useCallback(()=>{a(null),h(!1)},[h]),f=I.useCallback((g,_)=>{const m=g.currentTarget,p={x:g.clientX,y:g.clientY},y=F1e(p,m.getBoundingClientRect()),b=j1e(p,y),v=U1e(_.getBoundingClientRect()),w=H1e([...b,...v]);a(w),h(!0)},[h]);return I.useEffect(()=>()=>d(),[d]),I.useEffect(()=>{if(l&&u){const g=m=>f(m,u),_=m=>f(m,l);return l.addEventListener("pointerleave",g),u.addEventListener("pointerleave",_),()=>{l.removeEventListener("pointerleave",g),u.removeEventListener("pointerleave",_)}}},[l,u,f,d]),I.useEffect(()=>{if(o){const g=_=>{const m=_.target,p={x:_.clientX,y:_.clientY},y=l?.contains(m)||u?.contains(m),b=!$1e(p,o);y?d():b&&(d(),c())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[l,u,o,c,d]),T.jsx(T$,{...t,ref:i})}),[M1e,B1e]=wb(xb,{isInside:!1}),T$=I.forwardRef((t,e)=>{const{__scopeTooltip:r,children:n,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...a}=t,l=Lp(Pu,r),c=Eb(r),{onClose:u}=l;return I.useEffect(()=>(document.addEventListener(Ox,u),()=>document.removeEventListener(Ox,u)),[u]),I.useEffect(()=>{if(l.trigger){const h=d=>{d.target?.contains(l.trigger)&&u()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[l.trigger,u]),T.jsx(jy,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:u,children:T.jsxs(_$,{"data-state":l.stateAttribute,...c,...a,ref:e,style:{...a.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[T.jsx(d6,{children:n}),T.jsx(M1e,{scope:r,isInside:!0,children:T.jsx(R1e,{id:l.contentId,role:"tooltip",children:s||n})})]})})});S$.displayName=Pu;var C$="TooltipArrow",k$=I.forwardRef((t,e)=>{const{__scopeTooltip:r,...n}=t,s=Eb(r);return B1e(C$,r).isInside?null:T.jsx(y$,{...s,...n,ref:e})});k$.displayName=C$;function F1e(t,e){const r=Math.abs(e.top-t.y),n=Math.abs(e.bottom-t.y),s=Math.abs(e.right-t.x),i=Math.abs(e.left-t.x);switch(Math.min(r,n,s,i)){case i:return"left";case s:return"right";case r:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function j1e(t,e,r=5){const n=[];switch(e){case"top":n.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":n.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":n.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":n.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return n}function U1e(t){const{top:e,right:r,bottom:n,left:s}=t;return[{x:s,y:e},{x:r,y:e},{x:r,y:n},{x:s,y:n}]}function $1e(t,e){const{x:r,y:n}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i].x,l=e[i].y,c=e[o].x,u=e[o].y;l>n!=u>n&&r<(c-a)*(n-l)/(u-l)+a&&(s=!s)}return s}function H1e(t){const e=t.slice();return e.sort((r,n)=>r.x<n.x?-1:r.x>n.x?1:r.y<n.y?-1:r.y>n.y?1:0),z1e(e)}function z1e(t){if(t.length<=1)return t.slice();const e=[];for(let n=0;n<t.length;n++){const s=t[n];for(;e.length>=2;){const i=e[e.length-1],o=e[e.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))e.pop();else break}e.push(s)}e.pop();const r=[];for(let n=t.length-1;n>=0;n--){const s=t[n];for(;r.length>=2;){const i=r[r.length-1],o=r[r.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))r.pop();else break}r.push(s)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var V1e=w_,G1e=w$,W1e=E$,q1e=x$,K1e=S$,Y1e=k$;const Ou=I.forwardRef(({tooltip:t,children:e,sideOffset:r=5,className:n="",arrowClassName:s="",tooltipStyle:i={},position:o="top",maxWidth:a=250,delay:l=0},c)=>T.jsxs(G1e,{delayDuration:l,children:[T.jsx(W1e,{asChild:!0,children:e}),T.jsx(q1e,{children:T.jsxs(K1e,{side:o,className:`
              z-[2000]
              px-2.5
              py-1.5
              max-h-[300px]
              select-none
              rounded-md
              bg-Terretacode-elements-background-depth-3
              text-Terretacode-elements-textPrimary
              text-sm
              leading-tight
              shadow-lg
              animate-in
              fade-in-0
              zoom-in-95
              data-[state=closed]:animate-out
              data-[state=closed]:fade-out-0
              data-[state=closed]:zoom-out-95
              ${n}
            `,sideOffset:r,style:{maxWidth:a,...i},children:[T.jsx("div",{className:"break-words",children:t}),T.jsx(Y1e,{className:`
                fill-Terretacode-elements-background-depth-3
                ${s}
              `,width:12,height:6})]})})]})),Jm="<TerretacodeArtifact",RO="</TerretacodeArtifact>",X1e="<TerretacodeAction",IO="</TerretacodeAction>",Qm=Fn("MessageParser");function PO(t){const e=/^\s*```\w*\n([\s\S]*?)\n\s*```\s*$/,r=t.match(e);return r?r[1]:t}class Z1e{constructor(e={}){this._options=e}#t=new Map;parse(e,r){let n=this.#t.get(e);n||(n={position:0,insideAction:!1,insideArtifact:!1,currentAction:{content:""},actionId:0},this.#t.set(e,n));let s="",i=n.position,o=!1;for(;i<r.length;){if(n.insideArtifact){const a=n.currentArtifact;if(a===void 0&&Os("Artifact not initialized"),n.insideAction){const l=r.indexOf(IO,i),c=n.currentAction;if(l!==-1){c.content+=r.slice(i,l);let u=c.content.trim();"type"in c&&c.type==="file"&&(c.filePath.endsWith(".md")||(u=PO(u)),u+=`
`),c.content=u,this._options.callbacks?.onActionClose?.({artifactId:a.id,messageId:e,actionId:String(n.actionId-1),action:c}),n.insideAction=!1,n.currentAction={content:""},i=l+IO.length}else{if("type"in c&&c.type==="file"){let u=r.slice(i);c.filePath.endsWith(".md")||(u=PO(u)),this._options.callbacks?.onActionStream?.({artifactId:a.id,messageId:e,actionId:String(n.actionId-1),action:{...c,content:u,filePath:c.filePath}})}break}}else{const l=r.indexOf(X1e,i),c=r.indexOf(RO,i);if(l!==-1&&(c===-1||l<c)){const u=r.indexOf(">",l);if(u!==-1)n.insideAction=!0,n.currentAction=this.#r(r,l,u),this._options.callbacks?.onActionOpen?.({artifactId:a.id,messageId:e,actionId:String(n.actionId++),action:n.currentAction}),i=u+1;else break}else if(c!==-1)this._options.callbacks?.onArtifactClose?.({messageId:e,...a}),n.insideArtifact=!1,n.currentArtifact=void 0,i=c+RO.length;else break}}else if(r[i]==="<"&&r[i+1]!=="/"){let a=i,l="";for(;a<r.length&&l.length<Jm.length;){if(l+=r[a],l===Jm){const c=r[a+1];if(c&&c!==">"&&c!==" "){s+=r.slice(i,a+1),i=a+1;break}const u=r.indexOf(">",a);if(u!==-1){const h=r.slice(i,u+1),d=this.#e(h,"title"),f=this.#e(h,"type"),g=this.#e(h,"id");d||Qm.warn("Artifact title missing"),g||Qm.warn("Artifact id missing"),n.insideArtifact=!0;const _={id:g,title:d,type:f};n.currentArtifact=_,this._options.callbacks?.onArtifactOpen?.({messageId:e,..._});const m=this._options.artifactElement??J1e;s+=m({messageId:e}),i=u+1}else o=!0;break}else if(!Jm.startsWith(l)){s+=r.slice(i,a+1),i=a+1;break}a++}if(a===r.length&&Jm.startsWith(l))break}else s+=r[i],i++;if(o)break}return n.position=i,s}reset(){this.#t.clear()}#r(e,r,n){const s=e.slice(r,n+1),i=this.#e(s,"type"),o={type:i,content:""};if(i==="file"){const a=this.#e(s,"filePath");a||Qm.debug("File path not specified"),o.filePath=a}else["shell","start"].includes(i)||Qm.warn(`Unknown action type '${i}'`);return o}#e(e,r){const n=e.match(new RegExp(`${r}="([^"]*)"`,"i"));return n?n[1]:void 0}}const J1e=t=>`<div ${['class="__TerretacodeArtifact__"',...Object.entries(t).map(([r,n])=>`data-${Q1e(r)}=${JSON.stringify(n)}`)].join(" ")}></div>`;function Q1e(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}const Bh=Fn("useMessageParser"),eEe=new Z1e({callbacks:{onArtifactOpen:t=>{Bh.trace("onArtifactOpen",t),Ze.showWorkbench.set(!0),Ze.addArtifact(t)},onArtifactClose:t=>{Bh.trace("onArtifactClose"),Ze.updateArtifact(t,{closed:!0})},onActionOpen:t=>{Bh.trace("onActionOpen",t.action),t.action.type==="file"&&Ze.addAction(t)},onActionClose:t=>{Bh.trace("onActionClose",t.action),t.action.type!=="file"&&Ze.addAction(t),Ze.runAction(t)},onActionStream:t=>{Bh.trace("onActionStream",t.action),Ze.runAction(t,!0)}}});function tEe(){const[t,e]=I.useState({}),r=I.useCallback((n,s)=>{for(const[i,o]of n.entries())if(o.role==="assistant"){const a=eEe.parse(o.id,o.content);e(l=>({...l,[i]:(l[i]||"")+a}))}},[]);return{parsedMessages:t,parseMessages:r}}const OO=Fn("usePromptEnhancement");function rEe(){const[t,e]=I.useState(!1),[r,n]=I.useState(!1);return{enhancingPrompt:t,promptEnhanced:r,enhancePrompt:async(o,a,l,c,u)=>{e(!0),n(!1);const h={message:o,model:l,provider:c};u&&(h.apiKeys=u);const f=(await fetch("/api/enhancer",{method:"POST",body:JSON.stringify(h)})).body?.getReader(),g=o;if(f){const _=new TextDecoder;let m="",p;try{for(a("");;){const{value:y,done:b}=await f.read();if(b)break;m+=_.decode(y),OO.trace("Set input",m),a(m)}}catch(y){p=y,a(g)}finally{p&&OO.error(p),e(!1),n(!0),setTimeout(()=>{a(m)})}}},resetEnhancer:()=>{e(!1),n(!1)}}}class nEe{#t=new EventTarget;dispatch(e){this.#t.dispatchEvent(new Event(e))}on(e,r){return this.#t.addEventListener(e,r),()=>{this.#t.removeEventListener(e,r)}}}const A$=new nEe;function sEe(){const t=wt(Rpe);I.useEffect(()=>{const e=r=>{const{key:n,ctrlKey:s,shiftKey:i,altKey:o,metaKey:a}=r;for(const l in t){const c=t[l];if(c.key.toLowerCase()===n.toLowerCase()&&(c.ctrlOrMetaKey?s||a:(c.ctrlKey===void 0||c.ctrlKey===s)&&(c.metaKey===void 0||c.metaKey===a))&&(c.shiftKey===void 0||c.shiftKey===i)&&(c.altKey===void 0||c.altKey===o)){A$.dispatch(l),r.preventDefault(),r.stopPropagation(),c.action();break}}};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[t])}function iEe(){const t=I.useRef(!0),e=I.useRef(),r=I.useRef(),n=I.useRef(),s=I.useCallback(o=>{o?new ResizeObserver(()=>{if(t.current&&e.current){const{scrollHeight:l,clientHeight:c}=e.current,u=l-c;e.current.scrollTo({top:u})}}).observe(o):(n.current?.disconnect(),n.current=void 0)},[]),i=I.useCallback(o=>{o?(r.current=()=>{const{scrollTop:a,scrollHeight:l,clientHeight:c}=o,u=l-c;t.current=Math.abs(a-u)<=10},o.addEventListener("scroll",r.current),e.current=o):(r.current&&e.current?.removeEventListener("scroll",r.current),e.current=void 0,r.current=void 0)},[]);return[s,i]}function R$({initialDescription:t=po.get(),customChatId:e,syncWithGlobalStore:r}){const n=wt(la),[s,i]=I.useState(!1),[o,a]=I.useState(t),[l,c]=I.useState();I.useEffect(()=>{c(e||n)},[e,n]),I.useEffect(()=>{a(t)},[t]);const u=I.useCallback(()=>i(p=>!p),[]),h=I.useCallback(p=>{a(p.target.value)},[]),d=I.useCallback(async()=>{if(!Rt||!l)return t;try{return(await ku(Rt,l))?.description||t}catch(p){return console.error("Failed to fetch latest description:",p),t}},[Rt,l,t]),f=I.useCallback(async()=>{const p=await d();a(p),u()},[d,u]),g=I.useCallback(p=>{const y=p.trim();if(y===t)return u(),!1;const b=y.length>0&&y.length<=100,v=/^[a-zA-Z0-9\s\-_.,!?()[\]{}'"]+$/.test(y);return b?v?!0:(Ne.error("Description can only contain letters, numbers, spaces, and basic punctuation."),!1):(Ne.error("Description must be between 1 and 100 characters."),!1)},[]),_=I.useCallback(async p=>{if(p.preventDefault(),!!g(o)){try{if(!Rt){Ne.error("Chat persistence is not available");return}if(!l){Ne.error("Chat Id is not available");return}await kpe(Rt,l,o),r&&po.set(o),Ne.success("Chat description updated successfully")}catch(y){Ne.error("Failed to update chat description: "+y.message)}u()}},[o,Rt,l,t,e]),m=I.useCallback(async p=>{p.key==="Escape"&&await f()},[f]);return{editing:s,handleChange:h,handleBlur:f,handleSubmit:_,handleKeyDown:m,currentDescription:o,toggleEditMode:u}}const I$=(t=1024)=>{const[e,r]=I.useState(window.innerWidth<t);return I.useEffect(()=>{const n=()=>r(window.innerWidth<t);return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[t]),e};function oEe({item:t,onDelete:e,onDuplicate:r,exportChat:n}){const{id:s}=fq(),i=s===t.urlId,{editing:o,handleChange:a,handleBlur:l,handleSubmit:c,handleKeyDown:u,currentDescription:h,toggleEditMode:d}=R$({initialDescription:t.description,customChatId:t.id,syncWithGlobalStore:i}),f=T.jsxs("form",{onSubmit:c,className:"flex-1 flex items-center",children:[T.jsx("input",{type:"text",className:"flex-1 bg-Terretacode-elements-background-depth-1 text-Terretacode-elements-textPrimary rounded px-2 mr-2",autoFocus:!0,value:h,onChange:a,onBlur:l,onKeyDown:u}),T.jsx("button",{type:"submit",className:"i-ph:check scale-110 hover:text-Terretacode-elements-item-contentAccent",onMouseDown:c})]});return T.jsx("div",{className:qe("group rounded-md text-Terretacode-elements-textSecondary hover:text-Terretacode-elements-textPrimary hover:bg-Terretacode-elements-background-depth-3 overflow-hidden flex justify-between items-center px-2 py-1",{"[&&]:text-Terretacode-elements-textPrimary bg-Terretacode-elements-background-depth-3":i}),children:o?f:T.jsxs("a",{href:`/chat/${t.urlId}`,className:"flex w-full relative truncate block",children:[h,T.jsx("div",{className:qe("absolute right-0 z-1 top-0 bottom-0 bg-gradient-to-l from-Terretacode-elements-background-depth-2 group-hover:from-Terretacode-elements-background-depth-3 box-content pl-3 to-transparent w-10 flex justify-end group-hover:w-22 group-hover:from-99%",{"from-Terretacode-elements-background-depth-3 w-10 ":i}),children:T.jsxs("div",{className:"flex items-center p-1 text-Terretacode-elements-textSecondary opacity-0 group-hover:opacity-100 transition-opacity",children:[T.jsx(eg,{toolTipContent:"Export chat",icon:"i-ph:download-simple",onClick:g=>{g.preventDefault(),n(t.id)}}),r&&T.jsx(eg,{toolTipContent:"Duplicate chat",icon:"i-ph:copy",onClick:()=>r?.(t.id)}),T.jsx(eg,{toolTipContent:"Rename chat",icon:"i-ph:pencil-fill",onClick:g=>{g.preventDefault(),d()}}),T.jsx(UQ,{asChild:!0,children:T.jsx(eg,{toolTipContent:"Delete chat",icon:"i-ph:trash",className:"[&&]:hover:text-Terretacode-elements-button-danger-text",onClick:g=>{g.preventDefault(),e?.(g)}})})]})})]})})}const eg=I.forwardRef(({toolTipContent:t,icon:e,className:r,onClick:n},s)=>T.jsx(Ou,{tooltip:t,children:T.jsx("button",{ref:s,type:"button",className:`scale-110 mr-2 hover:text-Terretacode-elements-item-contentAccent ${e} ${r||""}`,onClick:n})}));function rn(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function To(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function aEe(t,e){const r=rn(t);return isNaN(e)?To(t,NaN):(e&&r.setDate(r.getDate()+e),r)}const P$=6048e5,lEe=864e5;let cEe={};function Sb(){return cEe}function zl(t,e){const r=Sb(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,s=rn(t),i=s.getDay(),o=(i<n?7:0)+i-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function E_(t){return zl(t,{weekStartsOn:1})}function O$(t){const e=rn(t),r=e.getFullYear(),n=To(t,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=E_(n),i=To(t,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=E_(i);return e.getTime()>=s.getTime()?r+1:e.getTime()>=o.getTime()?r:r-1}function x_(t){const e=rn(t);return e.setHours(0,0,0,0),e}function DO(t){const e=rn(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function uEe(t,e){const r=x_(t),n=x_(e),s=+r-DO(r),i=+n-DO(n);return Math.round((s-i)/lEe)}function hEe(t){const e=O$(t),r=To(t,0);return r.setFullYear(e,0,4),r.setHours(0,0,0,0),E_(r)}function Tb(t){return To(t,Date.now())}function D$(t,e){const r=x_(t),n=x_(e);return+r==+n}function dEe(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function fEe(t){if(!dEe(t)&&typeof t!="number")return!1;const e=rn(t);return!isNaN(Number(e))}function pEe(t){const e=rn(t),r=To(t,0);return r.setFullYear(e.getFullYear(),0,1),r.setHours(0,0,0,0),r}const mEe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},gEe=(t,e,r)=>{let n;const s=mEe[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function xw(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const _Ee={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},yEe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},bEe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},vEe={date:xw({formats:_Ee,defaultWidth:"full"}),time:xw({formats:yEe,defaultWidth:"full"}),dateTime:xw({formats:bEe,defaultWidth:"full"})},wEe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},EEe=(t,e,r,n)=>wEe[t];function Fh(t){return(e,r)=>{const n=r?.context?String(r.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,a=r?.width?String(r.width):o;s=t.formattingValues[a]||t.formattingValues[o]}else{const o=t.defaultWidth,a=r?.width?String(r.width):t.defaultWidth;s=t.values[a]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return s[i]}}const xEe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},SEe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},TEe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},CEe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},kEe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},AEe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},REe=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},IEe={ordinalNumber:REe,era:Fh({values:xEe,defaultWidth:"wide"}),quarter:Fh({values:SEe,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Fh({values:TEe,defaultWidth:"wide"}),day:Fh({values:CEe,defaultWidth:"wide"}),dayPeriod:Fh({values:kEe,defaultWidth:"wide",formattingValues:AEe,defaultFormattingWidth:"wide"})};function jh(t){return(e,r={})=>{const n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],a=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(a)?OEe(a,h=>h.test(o)):PEe(a,h=>h.test(o));let c;c=t.valueCallback?t.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;const u=e.slice(o.length);return{value:c,rest:u}}}function PEe(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function OEe(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function DEe(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const a=e.slice(s.length);return{value:o,rest:a}}}const LEe=/^(\d+)(th|st|nd|rd)?/i,NEe=/\d+/i,MEe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},BEe={any:[/^b/i,/^(a|c)/i]},FEe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},jEe={any:[/1/i,/2/i,/3/i,/4/i]},UEe={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},$Ee={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},HEe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},zEe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},VEe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},GEe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},WEe={ordinalNumber:DEe({matchPattern:LEe,parsePattern:NEe,valueCallback:t=>parseInt(t,10)}),era:jh({matchPatterns:MEe,defaultMatchWidth:"wide",parsePatterns:BEe,defaultParseWidth:"any"}),quarter:jh({matchPatterns:FEe,defaultMatchWidth:"wide",parsePatterns:jEe,defaultParseWidth:"any",valueCallback:t=>t+1}),month:jh({matchPatterns:UEe,defaultMatchWidth:"wide",parsePatterns:$Ee,defaultParseWidth:"any"}),day:jh({matchPatterns:HEe,defaultMatchWidth:"wide",parsePatterns:zEe,defaultParseWidth:"any"}),dayPeriod:jh({matchPatterns:VEe,defaultMatchWidth:"any",parsePatterns:GEe,defaultParseWidth:"any"})},qEe={code:"en-US",formatDistance:gEe,formatLong:vEe,formatRelative:EEe,localize:IEe,match:WEe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function KEe(t){const e=rn(t);return uEe(e,pEe(e))+1}function YEe(t){const e=rn(t),r=+E_(e)-+hEe(e);return Math.round(r/P$)+1}function L$(t,e){const r=rn(t),n=r.getFullYear(),s=Sb(),i=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=To(t,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const a=zl(o,e),l=To(t,0);l.setFullYear(n,0,i),l.setHours(0,0,0,0);const c=zl(l,e);return r.getTime()>=a.getTime()?n+1:r.getTime()>=c.getTime()?n:n-1}function XEe(t,e){const r=Sb(),n=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,s=L$(t,e),i=To(t,0);return i.setFullYear(s,0,n),i.setHours(0,0,0,0),zl(i,e)}function ZEe(t,e){const r=rn(t),n=+zl(r,e)-+XEe(r,e);return Math.round(n/P$)+1}function Lt(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const Fo={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return Lt(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):Lt(r+1,2)},d(t,e){return Lt(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return Lt(t.getHours()%12||12,e.length)},H(t,e){return Lt(t.getHours(),e.length)},m(t,e){return Lt(t.getMinutes(),e.length)},s(t,e){return Lt(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return Lt(s,e.length)}},Ec={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},LO={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return Fo.y(t,e)},Y:function(t,e,r,n){const s=L$(t,n),i=s>0?s:1-s;if(e==="YY"){const o=i%100;return Lt(o,2)}return e==="Yo"?r.ordinalNumber(i,{unit:"year"}):Lt(i,e.length)},R:function(t,e){const r=O$(t);return Lt(r,e.length)},u:function(t,e){const r=t.getFullYear();return Lt(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return Lt(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return Lt(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return Fo.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return Lt(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const s=ZEe(t,n);return e==="wo"?r.ordinalNumber(s,{unit:"week"}):Lt(s,e.length)},I:function(t,e,r){const n=YEe(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):Lt(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):Fo.d(t,e)},D:function(t,e,r){const n=KEe(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Lt(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const s=t.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return Lt(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const s=t.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return Lt(i,e.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return Lt(s,e.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let s;switch(n===12?s=Ec.noon:n===0?s=Ec.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let s;switch(n>=17?s=Ec.evening:n>=12?s=Ec.afternoon:n>=4?s=Ec.morning:s=Ec.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Fo.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):Fo.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Lt(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):Lt(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):Fo.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):Fo.s(t,e)},S:function(t,e){return Fo.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return MO(n);case"XXXX":case"XX":return sl(n);case"XXXXX":case"XXX":default:return sl(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return MO(n);case"xxxx":case"xx":return sl(n);case"xxxxx":case"xxx":default:return sl(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+NO(n,":");case"OOOO":default:return"GMT"+sl(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+NO(n,":");case"zzzz":default:return"GMT"+sl(n,":")}},t:function(t,e,r){const n=Math.trunc(t.getTime()/1e3);return Lt(n,e.length)},T:function(t,e,r){const n=t.getTime();return Lt(n,e.length)}};function NO(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Math.trunc(n/60),i=n%60;return i===0?r+String(s):r+String(s)+e+Lt(i,2)}function MO(t,e){return t%60===0?(t>0?"-":"+")+Lt(Math.abs(t)/60,2):sl(t,e)}function sl(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Lt(Math.trunc(n/60),2),i=Lt(n%60,2);return r+s+e+i}const BO=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},N$=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},JEe=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return BO(t,e);let i;switch(n){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",BO(n,e)).replace("{{time}}",N$(s,e))},QEe={p:N$,P:JEe},exe=/^D+$/,txe=/^Y+$/,rxe=["D","DD","YY","YYYY"];function nxe(t){return exe.test(t)}function sxe(t){return txe.test(t)}function ixe(t,e,r){const n=oxe(t,e,r);if(console.warn(n),rxe.includes(t))throw new RangeError(n)}function oxe(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const axe=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,lxe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,cxe=/^'([^]*?)'?$/,uxe=/''/g,hxe=/[a-zA-Z]/;function Sw(t,e,r){const n=Sb(),s=n.locale??qEe,i=n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,o=n.weekStartsOn??n.locale?.options?.weekStartsOn??0,a=rn(t);if(!fEe(a))throw new RangeError("Invalid time value");let l=e.match(lxe).map(u=>{const h=u[0];if(h==="p"||h==="P"){const d=QEe[h];return d(u,s.formatLong)}return u}).join("").match(axe).map(u=>{if(u==="''")return{isToken:!1,value:"'"};const h=u[0];if(h==="'")return{isToken:!1,value:dxe(u)};if(LO[h])return{isToken:!0,value:u};if(h.match(hxe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+h+"`");return{isToken:!1,value:u}});s.localize.preprocessor&&(l=s.localize.preprocessor(a,l));const c={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return l.map(u=>{if(!u.isToken)return u.value;const h=u.value;(sxe(h)||nxe(h))&&ixe(h,e,String(t));const d=LO[h[0]];return d(a,h,s.localize,c)}).join("")}function dxe(t){const e=t.match(cxe);return e?e[1].replace(uxe,"'"):t}function fxe(t,e){const r=rn(t),n=rn(e);return r.getTime()>n.getTime()}function pxe(t,e,r){const n=zl(t,r),s=zl(e,r);return+n==+s}function mxe(t,e){const r=rn(t),n=rn(e);return r.getFullYear()===n.getFullYear()}function gxe(t,e){return pxe(t,Tb(t),e)}function _xe(t){return mxe(t,Tb(t))}function yxe(t){return D$(t,Tb(t))}function M$(t,e){return aEe(t,-e)}function bxe(t){return D$(t,M$(Tb(t),1))}function vxe(t){const e=t.toSorted((s,i)=>Date.parse(i.timestamp)-Date.parse(s.timestamp)),r={},n=[];return e.forEach(s=>{const i=wxe(new Date(s.timestamp));if(i in r)r[i].items.push(s);else{const o={category:i,items:[s]};r[i]=o,n.push(o)}}),n}function wxe(t){if(yxe(t))return"Hoy";if(bxe(t))return"Ayer";if(gxe(t))return Sw(t,"eeee");const e=M$(new Date,30);return fxe(t,e)?"Últimos 30 Días":_xe(t)?Sw(t,"MMMM"):Sw(t,"MMMM yyyy")}function Cb(t,e=100){if(e===0)return t;let r;return function(...n){const s=this;clearTimeout(r),r=window.setTimeout(()=>{t.apply(s,n)},e)}}function Exe({items:t=[],searchFields:e=["description"],debounceMs:r=300}){const[n,s]=I.useState(""),i=I.useCallback(Cb(s,r),[]),o=I.useCallback(l=>{i(l.target.value)},[i]),a=I.useMemo(()=>{if(!n.trim())return t;const l=n.toLowerCase();return t.filter(c=>e.some(u=>{const h=c[u];return typeof h=="string"?h.toLowerCase().includes(l):!1}))},[t,n,e]);return{searchQuery:n,filteredItems:a,handleSearchChange:o}}const xxe={closed:{opacity:0,visibility:"hidden",left:"-150px",transition:{duration:.2,ease:Ss}},open:{opacity:1,visibility:"initial",left:0,transition:{duration:.2,ease:Ss}}};function Sxe(){const[t,e]=I.useState(new Date);return I.useEffect(()=>{const r=setInterval(()=>{e(new Date)},6e4);return()=>clearInterval(r)},[]),T.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 font-bold text-gray-700 dark:text-gray-300 border-b border-Terretacode-elements-borderColor",children:[T.jsx("div",{className:"h-4 w-4 i-ph:clock-thin"}),t.toLocaleDateString()," ",t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})}const Txe=()=>{const{duplicateCurrentChat:t,exportChat:e}=cj(),r=I.useRef(null),[n,s]=I.useState([]),[i,o]=I.useState(!1),[a,l]=I.useState(null),[c,u]=I.useState(!1),{filteredItems:h,handleSearchChange:d}=Exe({items:n,searchFields:["description"]}),f=I.useCallback(()=>{Rt&&_x(Rt).then(y=>y.filter(b=>b.urlId&&b.description)).then(s).catch(y=>Ne.error(y.message))},[]),g=I.useCallback((y,b)=>{y.preventDefault(),Rt&&oj(Rt,b.id).then(()=>{f(),la.get()===b.id&&(window.location.pathname="/")}).catch(v=>{Ne.error("Failed to delete conversation"),ET.error(v)})},[]),_=()=>{l(null)};I.useEffect(()=>{i&&f()},[i]),I.useEffect(()=>{function v(w){w.pageX<40&&o(!0),r.current&&w.clientX>r.current.getBoundingClientRect().right+40&&o(!1)}return window.addEventListener("mousemove",v),()=>{window.removeEventListener("mousemove",v)}},[]);const m=(y,b)=>{y.preventDefault(),l({type:"delete",item:b})},p=async y=>{await t(y),f()};return T.jsxs(yr.div,{ref:r,initial:"closed",animate:i?"open":"closed",variants:xxe,className:"flex selection-accent flex-col side-menu fixed top-0 w-[350px] h-full bg-Terretacode-elements-background-depth-2 border-r rounded-r-3xl border-Terretacode-elements-borderColor z-sidebar shadow-xl shadow-Terretacode-elements-sidebar-dropdownShadow text-sm",children:[T.jsx("div",{className:"h-[60px]"})," ",T.jsx(Sxe,{}),T.jsxs("div",{className:"flex-1 flex flex-col h-full w-full overflow-hidden",children:[T.jsxs("div",{className:"p-4 select-none",children:[T.jsxs("a",{href:"/",className:"flex gap-2 items-center bg-Terretacode-elements-sidebar-buttonBackgroundDefault text-Terretacode-elements-sidebar-buttonText hover:bg-Terretacode-elements-sidebar-buttonBackgroundHover rounded-md p-2 transition-theme mb-4",children:[T.jsx("span",{className:"inline-block i-Terretacode:chat scale-110"}),"Empezar nuevo chat"]}),T.jsx("div",{className:"relative w-full",children:T.jsx("input",{className:"w-full bg-white dark:bg-Terretacode-elements-background-depth-4 relative px-2 py-1.5 rounded-md focus:outline-none placeholder-Terretacode-elements-textTertiary text-Terretacode-elements-textPrimary dark:text-Terretacode-elements-textPrimary border border-Terretacode-elements-borderColor",type:"search",placeholder:"Buscar",onChange:d,"aria-label":"Buscar chats"})})]}),T.jsx("div",{className:"text-Terretacode-elements-textPrimary font-medium pl-6 pr-5 my-2",children:"Tus Chats"}),T.jsxs("div",{className:"flex-1 overflow-auto pl-4 pr-5 pb-5",children:[h.length===0&&T.jsx("div",{className:"pl-2 text-Terretacode-elements-textTertiary",children:n.length===0?"Sin conversaciones previas.":"No matches found"}),T.jsxs(z6,{open:a!==null,children:[vxe(h).map(({category:y,items:b})=>T.jsxs("div",{className:"mt-4 first:mt-0 space-y-1",children:[T.jsx("div",{className:"text-Terretacode-elements-textTertiary sticky top-0 z-1 bg-Terretacode-elements-background-depth-2 pl-2 pt-2 pb-1",children:y}),b.map(v=>T.jsx(oEe,{item:v,exportChat:e,onDelete:w=>m(w,v),onDuplicate:()=>p(v.id)},v.id))]},y)),T.jsx(WQ,{onBackdrop:_,onClose:_,children:a?.type==="delete"&&T.jsxs(T.Fragment,{children:[T.jsx(Z6,{children:"¿Borrar Chat?"}),T.jsx(GQ,{asChild:!0,children:T.jsxs("div",{children:[T.jsxs("p",{children:["Estás a punto de eliminar. ",T.jsx("strong",{children:a.item.description}),"."]}),T.jsx("p",{className:"mt-1",children:"¿Estás seguro de que deseas eliminar este chat?"})]})}),T.jsxs("div",{className:"px-5 pb-4 bg-Terretacode-elements-background-depth-2 flex gap-2 justify-end",children:[T.jsx(FR,{type:"secondary",onClick:_,children:"Cancelar"}),T.jsx(FR,{type:"danger",onClick:y=>{g(y,a.item),_()},children:"Borrar"})]})]})})]})]}),T.jsxs("div",{className:"flex items-center justify-between border-t border-Terretacode-elements-borderColor p-4",children:[T.jsx(wwe,{onClick:()=>u(!0)}),T.jsx(qQ,{})]})]}),T.jsx(vwe,{open:c,onClose:()=>u(!1)})]})};let It=class B${lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,r,n){[e,r]=Du(this,e,r);let s=[];return this.decompose(0,e,s,2),n.length&&n.decompose(0,n.length,s,3),this.decompose(r,this.length,s,1),wi.from(s,this.length-(r-e)+n.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,r=this.length){[e,r]=Du(this,e,r);let n=[];return this.decompose(e,r,n,0),wi.from(n,r-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let r=this.scanIdentical(e,1),n=this.length-this.scanIdentical(e,-1),s=new Dd(this),i=new Dd(e);for(let o=r,a=r;;){if(s.next(o),i.next(o),o=0,s.lineBreak!=i.lineBreak||s.done!=i.done||s.value!=i.value)return!1;if(a+=s.value.length,s.done||a>=n)return!0}}iter(e=1){return new Dd(this,e)}iterRange(e,r=this.length){return new F$(this,e,r)}iterLines(e,r){let n;if(e==null)n=this.iter();else{r==null&&(r=this.lines+1);let s=this.line(e).from;n=this.iterRange(s,Math.max(s,r==this.lines+1?this.length:r<=1?0:this.line(r-1).to))}return new j$(n)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?B$.empty:e.length<=32?new or(e):wi.from(or.split(e,[]))}};class or extends It{constructor(e,r=Cxe(e)){super(),this.text=e,this.length=r}get lines(){return this.text.length}get children(){return null}lineInner(e,r,n,s){for(let i=0;;i++){let o=this.text[i],a=s+o.length;if((r?n:a)>=e)return new kxe(s,a,n,o);s=a+1,n++}}decompose(e,r,n,s){let i=e<=0&&r>=this.length?this:new or(FO(this.text,e,r),Math.min(r,this.length)-Math.max(0,e));if(s&1){let o=n.pop(),a=n0(i.text,o.text.slice(),0,i.length);if(a.length<=32)n.push(new or(a,o.length+i.length));else{let l=a.length>>1;n.push(new or(a.slice(0,l)),new or(a.slice(l)))}}else n.push(i)}replace(e,r,n){if(!(n instanceof or))return super.replace(e,r,n);[e,r]=Du(this,e,r);let s=n0(this.text,n0(n.text,FO(this.text,0,e)),r),i=this.length+n.length-(r-e);return s.length<=32?new or(s,i):wi.from(or.split(s,[]),i)}sliceString(e,r=this.length,n=`
`){[e,r]=Du(this,e,r);let s="";for(let i=0,o=0;i<=r&&o<this.text.length;o++){let a=this.text[o],l=i+a.length;i>e&&o&&(s+=n),e<l&&r>i&&(s+=a.slice(Math.max(0,e-i),r-i)),i=l+1}return s}flatten(e){for(let r of this.text)e.push(r)}scanIdentical(){return 0}static split(e,r){let n=[],s=-1;for(let i of e)n.push(i),s+=i.length+1,n.length==32&&(r.push(new or(n,s)),n=[],s=-1);return s>-1&&r.push(new or(n,s)),r}}class wi extends It{constructor(e,r){super(),this.children=e,this.length=r,this.lines=0;for(let n of e)this.lines+=n.lines}lineInner(e,r,n,s){for(let i=0;;i++){let o=this.children[i],a=s+o.length,l=n+o.lines-1;if((r?l:a)>=e)return o.lineInner(e,r,n,s);s=a+1,n=l+1}}decompose(e,r,n,s){for(let i=0,o=0;o<=r&&i<this.children.length;i++){let a=this.children[i],l=o+a.length;if(e<=l&&r>=o){let c=s&((o<=e?1:0)|(l>=r?2:0));o>=e&&l<=r&&!c?n.push(a):a.decompose(e-o,r-o,n,c)}o=l+1}}replace(e,r,n){if([e,r]=Du(this,e,r),n.lines<this.lines)for(let s=0,i=0;s<this.children.length;s++){let o=this.children[s],a=i+o.length;if(e>=i&&r<=a){let l=o.replace(e-i,r-i,n),c=this.lines-o.lines+l.lines;if(l.lines<c>>4&&l.lines>c>>6){let u=this.children.slice();return u[s]=l,new wi(u,this.length-(r-e)+n.length)}return super.replace(i,a,l)}i=a+1}return super.replace(e,r,n)}sliceString(e,r=this.length,n=`
`){[e,r]=Du(this,e,r);let s="";for(let i=0,o=0;i<this.children.length&&o<=r;i++){let a=this.children[i],l=o+a.length;o>e&&i&&(s+=n),e<l&&r>o&&(s+=a.sliceString(e-o,r-o,n)),o=l+1}return s}flatten(e){for(let r of this.children)r.flatten(e)}scanIdentical(e,r){if(!(e instanceof wi))return 0;let n=0,[s,i,o,a]=r>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;s+=r,i+=r){if(s==o||i==a)return n;let l=this.children[s],c=e.children[i];if(l!=c)return n+l.scanIdentical(c,r);n+=l.length+1}}static from(e,r=e.reduce((n,s)=>n+s.length+1,-1)){let n=0;for(let f of e)n+=f.lines;if(n<32){let f=[];for(let g of e)g.flatten(f);return new or(f,r)}let s=Math.max(32,n>>5),i=s<<1,o=s>>1,a=[],l=0,c=-1,u=[];function h(f){let g;if(f.lines>i&&f instanceof wi)for(let _ of f.children)h(_);else f.lines>o&&(l>o||!l)?(d(),a.push(f)):f instanceof or&&l&&(g=u[u.length-1])instanceof or&&f.lines+g.lines<=32?(l+=f.lines,c+=f.length+1,u[u.length-1]=new or(g.text.concat(f.text),g.length+1+f.length)):(l+f.lines>s&&d(),l+=f.lines,c+=f.length+1,u.push(f))}function d(){l!=0&&(a.push(u.length==1?u[0]:wi.from(u,c)),c=-1,l=u.length=0)}for(let f of e)h(f);return d(),a.length==1?a[0]:new wi(a,r)}}It.empty=new or([""],0);function Cxe(t){let e=-1;for(let r of t)e+=r.length+1;return e}function n0(t,e,r=0,n=1e9){for(let s=0,i=0,o=!0;i<t.length&&s<=n;i++){let a=t[i],l=s+a.length;l>=r&&(l>n&&(a=a.slice(0,n-s)),s<r&&(a=a.slice(r-s)),o?(e[e.length-1]+=a,o=!1):e.push(a)),s=l+1}return e}function FO(t,e,r){return n0(t,[""],e,r)}class Dd{constructor(e,r=1){this.dir=r,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[r>0?1:(e instanceof or?e.text.length:e.children.length)<<1]}nextInner(e,r){for(this.done=this.lineBreak=!1;;){let n=this.nodes.length-1,s=this.nodes[n],i=this.offsets[n],o=i>>1,a=s instanceof or?s.text.length:s.children.length;if(o==(r>0?a:0)){if(n==0)return this.done=!0,this.value="",this;r>0&&this.offsets[n-1]++,this.nodes.pop(),this.offsets.pop()}else if((i&1)==(r>0?0:1)){if(this.offsets[n]+=r,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(s instanceof or){let l=s.text[o+(r<0?-1:0)];if(this.offsets[n]+=r,l.length>Math.max(0,e))return this.value=e==0?l:r>0?l.slice(e):l.slice(0,l.length-e),this;e-=l.length}else{let l=s.children[o+(r<0?-1:0)];e>l.length?(e-=l.length,this.offsets[n]+=r):(r<0&&this.offsets[n]--,this.nodes.push(l),this.offsets.push(r>0?1:(l instanceof or?l.text.length:l.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class F${constructor(e,r,n){this.value="",this.done=!1,this.cursor=new Dd(e,r>n?-1:1),this.pos=r>n?e.length:0,this.from=Math.min(r,n),this.to=Math.max(r,n)}nextInner(e,r){if(r<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,r<0?this.pos-this.to:this.from-this.pos);let n=r<0?this.pos-this.from:this.to-this.pos;e>n&&(e=n),n-=e;let{value:s}=this.cursor.next(e);return this.pos+=(s.length+e)*r,this.value=s.length<=n?s:r<0?s.slice(s.length-n):s.slice(0,n),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class j${constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:r,lineBreak:n,value:s}=this.inner.next(e);return r&&this.afterBreak?(this.value="",this.afterBreak=!1):r?(this.done=!0,this.value=""):n?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=s,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(It.prototype[Symbol.iterator]=function(){return this.iter()},Dd.prototype[Symbol.iterator]=F$.prototype[Symbol.iterator]=j$.prototype[Symbol.iterator]=function(){return this});class kxe{constructor(e,r,n,s){this.from=e,this.to=r,this.number=n,this.text=s}get length(){return this.to-this.from}}function Du(t,e,r){return e=Math.max(0,Math.min(t.length,e)),[e,Math.max(e,Math.min(t.length,r))]}let iu="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(t=>t?parseInt(t,36):1);for(let t=1;t<iu.length;t++)iu[t]+=iu[t-1];function Axe(t){for(let e=1;e<iu.length;e+=2)if(iu[e]>t)return iu[e-1]<=t;return!1}function jO(t){return t>=127462&&t<=127487}const UO=8205;function jr(t,e,r=!0,n=!0){return(r?U$:Rxe)(t,e,n)}function U$(t,e,r){if(e==t.length)return e;e&&$$(t.charCodeAt(e))&&H$(t.charCodeAt(e-1))&&e--;let n=An(t,e);for(e+=Ds(n);e<t.length;){let s=An(t,e);if(n==UO||s==UO||r&&Axe(s))e+=Ds(s),n=s;else if(jO(s)){let i=0,o=e-2;for(;o>=0&&jO(An(t,o));)i++,o-=2;if(i%2==0)break;e+=2}else break}return e}function Rxe(t,e,r){for(;e>0;){let n=U$(t,e-2,r);if(n<e)return n;e--}return 0}function $$(t){return t>=56320&&t<57344}function H$(t){return t>=55296&&t<56320}function An(t,e){let r=t.charCodeAt(e);if(!H$(r)||e+1==t.length)return r;let n=t.charCodeAt(e+1);return $$(n)?(r-55296<<10)+(n-56320)+65536:r}function Mk(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode((t>>10)+55296,(t&1023)+56320))}function Ds(t){return t<65536?1:2}const Lx=/\r\n?|\n/;var Yr=function(t){return t[t.Simple=0]="Simple",t[t.TrackDel=1]="TrackDel",t[t.TrackBefore=2]="TrackBefore",t[t.TrackAfter=3]="TrackAfter",t}(Yr||(Yr={}));class Bi{constructor(e){this.sections=e}get length(){let e=0;for(let r=0;r<this.sections.length;r+=2)e+=this.sections[r];return e}get newLength(){let e=0;for(let r=0;r<this.sections.length;r+=2){let n=this.sections[r+1];e+=n<0?this.sections[r]:n}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let r=0,n=0,s=0;r<this.sections.length;){let i=this.sections[r++],o=this.sections[r++];o<0?(e(n,s,i),s+=i):s+=o,n+=i}}iterChangedRanges(e,r=!1){Nx(this,e,r)}get invertedDesc(){let e=[];for(let r=0;r<this.sections.length;){let n=this.sections[r++],s=this.sections[r++];s<0?e.push(n,s):e.push(s,n)}return new Bi(e)}composeDesc(e){return this.empty?e:e.empty?this:z$(this,e)}mapDesc(e,r=!1){return e.empty?this:Mx(this,e,r)}mapPos(e,r=-1,n=Yr.Simple){let s=0,i=0;for(let o=0;o<this.sections.length;){let a=this.sections[o++],l=this.sections[o++],c=s+a;if(l<0){if(c>e)return i+(e-s);i+=a}else{if(n!=Yr.Simple&&c>=e&&(n==Yr.TrackDel&&s<e&&c>e||n==Yr.TrackBefore&&s<e||n==Yr.TrackAfter&&c>e))return null;if(c>e||c==e&&r<0&&!a)return e==s||r<0?i:i+l;i+=l}s=c}if(e>s)throw new RangeError(`Position ${e} is out of range for changeset of length ${s}`);return i}touchesRange(e,r=e){for(let n=0,s=0;n<this.sections.length&&s<=r;){let i=this.sections[n++],o=this.sections[n++],a=s+i;if(o>=0&&s<=r&&a>=e)return s<e&&a>r?"cover":!0;s=a}return!1}toString(){let e="";for(let r=0;r<this.sections.length;){let n=this.sections[r++],s=this.sections[r++];e+=(e?" ":"")+n+(s>=0?":"+s:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(r=>typeof r!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Bi(e)}static create(e){return new Bi(e)}}class _r extends Bi{constructor(e,r){super(e),this.inserted=r}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return Nx(this,(r,n,s,i,o)=>e=e.replace(s,s+(n-r),o),!1),e}mapDesc(e,r=!1){return Mx(this,e,r,!0)}invert(e){let r=this.sections.slice(),n=[];for(let s=0,i=0;s<r.length;s+=2){let o=r[s],a=r[s+1];if(a>=0){r[s]=a,r[s+1]=o;let l=s>>1;for(;n.length<l;)n.push(It.empty);n.push(o?e.slice(i,i+o):It.empty)}i+=o}return new _r(r,n)}compose(e){return this.empty?e:e.empty?this:z$(this,e,!0)}map(e,r=!1){return e.empty?this:Mx(this,e,r,!0)}iterChanges(e,r=!1){Nx(this,e,r)}get desc(){return Bi.create(this.sections)}filter(e){let r=[],n=[],s=[],i=new Cf(this);e:for(let o=0,a=0;;){let l=o==e.length?1e9:e[o++];for(;a<l||a==l&&i.len==0;){if(i.done)break e;let u=Math.min(i.len,l-a);Kr(s,u,-1);let h=i.ins==-1?-1:i.off==0?i.ins:0;Kr(r,u,h),h>0&&ua(n,r,i.text),i.forward(u),a+=u}let c=e[o++];for(;a<c;){if(i.done)break e;let u=Math.min(i.len,c-a);Kr(r,u,-1),Kr(s,u,i.ins==-1?-1:i.off==0?i.ins:0),i.forward(u),a+=u}}return{changes:new _r(r,n),filtered:Bi.create(s)}}toJSON(){let e=[];for(let r=0;r<this.sections.length;r+=2){let n=this.sections[r],s=this.sections[r+1];s<0?e.push(n):s==0?e.push([n]):e.push([n].concat(this.inserted[r>>1].toJSON()))}return e}static of(e,r,n){let s=[],i=[],o=0,a=null;function l(u=!1){if(!u&&!s.length)return;o<r&&Kr(s,r-o,-1);let h=new _r(s,i);a=a?a.compose(h.map(a)):h,s=[],i=[],o=0}function c(u){if(Array.isArray(u))for(let h of u)c(h);else if(u instanceof _r){if(u.length!=r)throw new RangeError(`Mismatched change set length (got ${u.length}, expected ${r})`);l(),a=a?a.compose(u.map(a)):u}else{let{from:h,to:d=h,insert:f}=u;if(h>d||h<0||d>r)throw new RangeError(`Invalid change range ${h} to ${d} (in doc of length ${r})`);let g=f?typeof f=="string"?It.of(f.split(n||Lx)):f:It.empty,_=g.length;if(h==d&&_==0)return;h<o&&l(),h>o&&Kr(s,h-o,-1),Kr(s,d-h,_),ua(i,s,g),o=d}}return c(e),l(!a),a}static empty(e){return new _r(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let r=[],n=[];for(let s=0;s<e.length;s++){let i=e[s];if(typeof i=="number")r.push(i,-1);else{if(!Array.isArray(i)||typeof i[0]!="number"||i.some((o,a)=>a&&typeof o!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(i.length==1)r.push(i[0],0);else{for(;n.length<s;)n.push(It.empty);n[s]=It.of(i.slice(1)),r.push(i[0],n[s].length)}}}return new _r(r,n)}static createSet(e,r){return new _r(e,r)}}function Kr(t,e,r,n=!1){if(e==0&&r<=0)return;let s=t.length-2;s>=0&&r<=0&&r==t[s+1]?t[s]+=e:e==0&&t[s]==0?t[s+1]+=r:n?(t[s]+=e,t[s+1]+=r):t.push(e,r)}function ua(t,e,r){if(r.length==0)return;let n=e.length-2>>1;if(n<t.length)t[t.length-1]=t[t.length-1].append(r);else{for(;t.length<n;)t.push(It.empty);t.push(r)}}function Nx(t,e,r){let n=t.inserted;for(let s=0,i=0,o=0;o<t.sections.length;){let a=t.sections[o++],l=t.sections[o++];if(l<0)s+=a,i+=a;else{let c=s,u=i,h=It.empty;for(;c+=a,u+=l,l&&n&&(h=h.append(n[o-2>>1])),!(r||o==t.sections.length||t.sections[o+1]<0);)a=t.sections[o++],l=t.sections[o++];e(s,c,i,u,h),s=c,i=u}}}function Mx(t,e,r,n=!1){let s=[],i=n?[]:null,o=new Cf(t),a=new Cf(e);for(let l=-1;;)if(o.ins==-1&&a.ins==-1){let c=Math.min(o.len,a.len);Kr(s,c,-1),o.forward(c),a.forward(c)}else if(a.ins>=0&&(o.ins<0||l==o.i||o.off==0&&(a.len<o.len||a.len==o.len&&!r))){let c=a.len;for(Kr(s,a.ins,-1);c;){let u=Math.min(o.len,c);o.ins>=0&&l<o.i&&o.len<=u&&(Kr(s,0,o.ins),i&&ua(i,s,o.text),l=o.i),o.forward(u),c-=u}a.next()}else if(o.ins>=0){let c=0,u=o.len;for(;u;)if(a.ins==-1){let h=Math.min(u,a.len);c+=h,u-=h,a.forward(h)}else if(a.ins==0&&a.len<u)u-=a.len,a.next();else break;Kr(s,c,l<o.i?o.ins:0),i&&l<o.i&&ua(i,s,o.text),l=o.i,o.forward(o.len-u)}else{if(o.done&&a.done)return i?_r.createSet(s,i):Bi.create(s);throw new Error("Mismatched change set lengths")}}function z$(t,e,r=!1){let n=[],s=r?[]:null,i=new Cf(t),o=new Cf(e);for(let a=!1;;){if(i.done&&o.done)return s?_r.createSet(n,s):Bi.create(n);if(i.ins==0)Kr(n,i.len,0,a),i.next();else if(o.len==0&&!o.done)Kr(n,0,o.ins,a),s&&ua(s,n,o.text),o.next();else{if(i.done||o.done)throw new Error("Mismatched change set lengths");{let l=Math.min(i.len2,o.len),c=n.length;if(i.ins==-1){let u=o.ins==-1?-1:o.off?0:o.ins;Kr(n,l,u,a),s&&u&&ua(s,n,o.text)}else o.ins==-1?(Kr(n,i.off?0:i.len,l,a),s&&ua(s,n,i.textBit(l))):(Kr(n,i.off?0:i.len,o.off?0:o.ins,a),s&&!o.off&&ua(s,n,o.text));a=(i.ins>l||o.ins>=0&&o.len>l)&&(a||n.length>c),i.forward2(l),o.forward(l)}}}}class Cf{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,r=this.i-2>>1;return r>=e.length?It.empty:e[r]}textBit(e){let{inserted:r}=this.set,n=this.i-2>>1;return n>=r.length&&!e?It.empty:r[n].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class pl{constructor(e,r,n){this.from=e,this.to=r,this.flags=n}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,r=-1){let n,s;return this.empty?n=s=e.mapPos(this.from,r):(n=e.mapPos(this.from,1),s=e.mapPos(this.to,-1)),n==this.from&&s==this.to?this:new pl(n,s,this.flags)}extend(e,r=e){if(e<=this.anchor&&r>=this.anchor)return Re.range(e,r);let n=Math.abs(e-this.anchor)>Math.abs(r-this.anchor)?e:r;return Re.range(this.anchor,n)}eq(e,r=!1){return this.anchor==e.anchor&&this.head==e.head&&(!r||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return Re.range(e.anchor,e.head)}static create(e,r,n){return new pl(e,r,n)}}class Re{constructor(e,r){this.ranges=e,this.mainIndex=r}map(e,r=-1){return e.empty?this:Re.create(this.ranges.map(n=>n.map(e,r)),this.mainIndex)}eq(e,r=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let n=0;n<this.ranges.length;n++)if(!this.ranges[n].eq(e.ranges[n],r))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new Re([this.main],0)}addRange(e,r=!0){return Re.create([e].concat(this.ranges),r?0:this.mainIndex+1)}replaceRange(e,r=this.mainIndex){let n=this.ranges.slice();return n[r]=e,Re.create(n,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new Re(e.ranges.map(r=>pl.fromJSON(r)),e.main)}static single(e,r=e){return new Re([Re.range(e,r)],0)}static create(e,r=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let n=0,s=0;s<e.length;s++){let i=e[s];if(i.empty?i.from<=n:i.from<n)return Re.normalized(e.slice(),r);n=i.to}return new Re(e,r)}static cursor(e,r=0,n,s){return pl.create(e,e,(r==0?0:r<0?8:16)|(n==null?7:Math.min(6,n))|(s??16777215)<<6)}static range(e,r,n,s){let i=(n??16777215)<<6|(s==null?7:Math.min(6,s));return r<e?pl.create(r,e,48|i):pl.create(e,r,(r>e?8:0)|i)}static normalized(e,r=0){let n=e[r];e.sort((s,i)=>s.from-i.from),r=e.indexOf(n);for(let s=1;s<e.length;s++){let i=e[s],o=e[s-1];if(i.empty?i.from<=o.to:i.from<o.to){let a=o.from,l=Math.max(i.to,o.to);s<=r&&r--,e.splice(--s,2,i.anchor>i.head?Re.range(l,a):Re.range(a,l))}}return new Re(e,r)}}function V$(t,e){for(let r of t.ranges)if(r.to>e)throw new RangeError("Selection points outside of document")}let Bk=0;class We{constructor(e,r,n,s,i){this.combine=e,this.compareInput=r,this.compare=n,this.isStatic=s,this.id=Bk++,this.default=e([]),this.extensions=typeof i=="function"?i(this):i}get reader(){return this}static define(e={}){return new We(e.combine||(r=>r),e.compareInput||((r,n)=>r===n),e.compare||(e.combine?(r,n)=>r===n:Fk),!!e.static,e.enables)}of(e){return new s0([],this,0,e)}compute(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new s0(e,this,1,r)}computeN(e,r){if(this.isStatic)throw new Error("Can't compute a static facet");return new s0(e,this,2,r)}from(e,r){return r||(r=n=>n),this.compute([e],n=>r(n.field(e)))}}function Fk(t,e){return t==e||t.length==e.length&&t.every((r,n)=>r===e[n])}class s0{constructor(e,r,n,s){this.dependencies=e,this.facet=r,this.type=n,this.value=s,this.id=Bk++}dynamicSlot(e){var r;let n=this.value,s=this.facet.compareInput,i=this.id,o=e[i]>>1,a=this.type==2,l=!1,c=!1,u=[];for(let h of this.dependencies)h=="doc"?l=!0:h=="selection"?c=!0:((r=e[h.id])!==null&&r!==void 0?r:1)&1||u.push(e[h.id]);return{create(h){return h.values[o]=n(h),1},update(h,d){if(l&&d.docChanged||c&&(d.docChanged||d.selection)||Bx(h,u)){let f=n(h);if(a?!$O(f,h.values[o],s):!s(f,h.values[o]))return h.values[o]=f,1}return 0},reconfigure:(h,d)=>{let f,g=d.config.address[i];if(g!=null){let _=T_(d,g);if(this.dependencies.every(m=>m instanceof We?d.facet(m)===h.facet(m):m instanceof Pr?d.field(m,!1)==h.field(m,!1):!0)||(a?$O(f=n(h),_,s):s(f=n(h),_)))return h.values[o]=_,0}else f=n(h);return h.values[o]=f,1}}}}function $O(t,e,r){if(t.length!=e.length)return!1;for(let n=0;n<t.length;n++)if(!r(t[n],e[n]))return!1;return!0}function Bx(t,e){let r=!1;for(let n of e)Ld(t,n)&1&&(r=!0);return r}function Ixe(t,e,r){let n=r.map(l=>t[l.id]),s=r.map(l=>l.type),i=n.filter(l=>!(l&1)),o=t[e.id]>>1;function a(l){let c=[];for(let u=0;u<n.length;u++){let h=T_(l,n[u]);if(s[u]==2)for(let d of h)c.push(d);else c.push(h)}return e.combine(c)}return{create(l){for(let c of n)Ld(l,c);return l.values[o]=a(l),1},update(l,c){if(!Bx(l,i))return 0;let u=a(l);return e.compare(u,l.values[o])?0:(l.values[o]=u,1)},reconfigure(l,c){let u=Bx(l,n),h=c.config.facets[e.id],d=c.facet(e);if(h&&!u&&Fk(r,h))return l.values[o]=d,0;let f=a(l);return e.compare(f,d)?(l.values[o]=d,0):(l.values[o]=f,1)}}}const HO=We.define({static:!0});class Pr{constructor(e,r,n,s,i){this.id=e,this.createF=r,this.updateF=n,this.compareF=s,this.spec=i,this.provides=void 0}static define(e){let r=new Pr(Bk++,e.create,e.update,e.compare||((n,s)=>n===s),e);return e.provide&&(r.provides=e.provide(r)),r}create(e){let r=e.facet(HO).find(n=>n.field==this);return(r?.create||this.createF)(e)}slot(e){let r=e[this.id]>>1;return{create:n=>(n.values[r]=this.create(n),1),update:(n,s)=>{let i=n.values[r],o=this.updateF(i,s);return this.compareF(i,o)?0:(n.values[r]=o,1)},reconfigure:(n,s)=>s.config.address[this.id]!=null?(n.values[r]=s.field(this),0):(n.values[r]=this.create(n),1)}}init(e){return[this,HO.of({field:this,create:e})]}get extension(){return this}}const al={lowest:4,low:3,default:2,high:1,highest:0};function Uh(t){return e=>new G$(e,t)}const Va={highest:Uh(al.highest),high:Uh(al.high),default:Uh(al.default),low:Uh(al.low),lowest:Uh(al.lowest)};class G${constructor(e,r){this.inner=e,this.prec=r}}class hh{of(e){return new Fx(this,e)}reconfigure(e){return hh.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class Fx{constructor(e,r){this.compartment=e,this.inner=r}}class S_{constructor(e,r,n,s,i,o){for(this.base=e,this.compartments=r,this.dynamicSlots=n,this.address=s,this.staticValues=i,this.facets=o,this.statusTemplate=[];this.statusTemplate.length<n.length;)this.statusTemplate.push(0)}staticFacet(e){let r=this.address[e.id];return r==null?e.default:this.staticValues[r>>1]}static resolve(e,r,n){let s=[],i=Object.create(null),o=new Map;for(let d of Pxe(e,r,o))d instanceof Pr?s.push(d):(i[d.facet.id]||(i[d.facet.id]=[])).push(d);let a=Object.create(null),l=[],c=[];for(let d of s)a[d.id]=c.length<<1,c.push(f=>d.slot(f));let u=n?.config.facets;for(let d in i){let f=i[d],g=f[0].facet,_=u&&u[d]||[];if(f.every(m=>m.type==0))if(a[g.id]=l.length<<1|1,Fk(_,f))l.push(n.facet(g));else{let m=g.combine(f.map(p=>p.value));l.push(n&&g.compare(m,n.facet(g))?n.facet(g):m)}else{for(let m of f)m.type==0?(a[m.id]=l.length<<1|1,l.push(m.value)):(a[m.id]=c.length<<1,c.push(p=>m.dynamicSlot(p)));a[g.id]=c.length<<1,c.push(m=>Ixe(m,g,f))}}let h=c.map(d=>d(a));return new S_(e,o,h,a,l,i)}}function Pxe(t,e,r){let n=[[],[],[],[],[]],s=new Map;function i(o,a){let l=s.get(o);if(l!=null){if(l<=a)return;let c=n[l].indexOf(o);c>-1&&n[l].splice(c,1),o instanceof Fx&&r.delete(o.compartment)}if(s.set(o,a),Array.isArray(o))for(let c of o)i(c,a);else if(o instanceof Fx){if(r.has(o.compartment))throw new RangeError("Duplicate use of compartment in extensions");let c=e.get(o.compartment)||o.inner;r.set(o.compartment,c),i(c,a)}else if(o instanceof G$)i(o.inner,o.prec);else if(o instanceof Pr)n[a].push(o),o.provides&&i(o.provides,a);else if(o instanceof s0)n[a].push(o),o.facet.extensions&&i(o.facet.extensions,al.default);else{let c=o.extension;if(!c)throw new Error(`Unrecognized extension value in extension set (${o}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);i(c,a)}}return i(t,al.default),n.reduce((o,a)=>o.concat(a))}function Ld(t,e){if(e&1)return 2;let r=e>>1,n=t.status[r];if(n==4)throw new Error("Cyclic dependency between fields and/or facets");if(n&2)return n;t.status[r]=4;let s=t.computeSlot(t,t.config.dynamicSlots[r]);return t.status[r]=2|s}function T_(t,e){return e&1?t.config.staticValues[e>>1]:t.values[e>>1]}const W$=We.define(),jx=We.define({combine:t=>t.some(e=>e),static:!0}),q$=We.define({combine:t=>t.length?t[0]:void 0,static:!0}),K$=We.define(),Y$=We.define(),X$=We.define(),Z$=We.define({combine:t=>t.length?t[0]:!1});class No{constructor(e,r){this.type=e,this.value=r}static define(){return new Oxe}}class Oxe{of(e){return new No(this,e)}}class Dxe{constructor(e){this.map=e}of(e){return new ht(this,e)}}class ht{constructor(e,r){this.type=e,this.value=r}map(e){let r=this.type.map(this.value,e);return r===void 0?void 0:r==this.value?this:new ht(this.type,r)}is(e){return this.type==e}static define(e={}){return new Dxe(e.map||(r=>r))}static mapEffects(e,r){if(!e.length)return e;let n=[];for(let s of e){let i=s.map(r);i&&n.push(i)}return n}}ht.reconfigure=ht.define();ht.appendConfig=ht.define();class pr{constructor(e,r,n,s,i,o){this.startState=e,this.changes=r,this.selection=n,this.effects=s,this.annotations=i,this.scrollIntoView=o,this._doc=null,this._state=null,n&&V$(n,r.newLength),i.some(a=>a.type==pr.time)||(this.annotations=i.concat(pr.time.of(Date.now())))}static create(e,r,n,s,i,o){return new pr(e,r,n,s,i,o)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let r of this.annotations)if(r.type==e)return r.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let r=this.annotation(pr.userEvent);return!!(r&&(r==e||r.length>e.length&&r.slice(0,e.length)==e&&r[e.length]=="."))}}pr.time=No.define();pr.userEvent=No.define();pr.addToHistory=No.define();pr.remote=No.define();function Lxe(t,e){let r=[];for(let n=0,s=0;;){let i,o;if(n<t.length&&(s==e.length||e[s]>=t[n]))i=t[n++],o=t[n++];else if(s<e.length)i=e[s++],o=e[s++];else return r;!r.length||r[r.length-1]<i?r.push(i,o):r[r.length-1]<o&&(r[r.length-1]=o)}}function J$(t,e,r){var n;let s,i,o;return r?(s=e.changes,i=_r.empty(e.changes.length),o=t.changes.compose(e.changes)):(s=e.changes.map(t.changes),i=t.changes.mapDesc(e.changes,!0),o=t.changes.compose(s)),{changes:o,selection:e.selection?e.selection.map(i):(n=t.selection)===null||n===void 0?void 0:n.map(s),effects:ht.mapEffects(t.effects,s).concat(ht.mapEffects(e.effects,i)),annotations:t.annotations.length?t.annotations.concat(e.annotations):e.annotations,scrollIntoView:t.scrollIntoView||e.scrollIntoView}}function Ux(t,e,r){let n=e.selection,s=ou(e.annotations);return e.userEvent&&(s=s.concat(pr.userEvent.of(e.userEvent))),{changes:e.changes instanceof _r?e.changes:_r.of(e.changes||[],r,t.facet(q$)),selection:n&&(n instanceof Re?n:Re.single(n.anchor,n.head)),effects:ou(e.effects),annotations:s,scrollIntoView:!!e.scrollIntoView}}function Q$(t,e,r){let n=Ux(t,e.length?e[0]:{},t.doc.length);e.length&&e[0].filter===!1&&(r=!1);for(let i=1;i<e.length;i++){e[i].filter===!1&&(r=!1);let o=!!e[i].sequential;n=J$(n,Ux(t,e[i],o?n.changes.newLength:t.doc.length),o)}let s=pr.create(t,n.changes,n.selection,n.effects,n.annotations,n.scrollIntoView);return Mxe(r?Nxe(s):s)}function Nxe(t){let e=t.startState,r=!0;for(let s of e.facet(K$)){let i=s(t);if(i===!1){r=!1;break}Array.isArray(i)&&(r=r===!0?i:Lxe(r,i))}if(r!==!0){let s,i;if(r===!1)i=t.changes.invertedDesc,s=_r.empty(e.doc.length);else{let o=t.changes.filter(r);s=o.changes,i=o.filtered.mapDesc(o.changes).invertedDesc}t=pr.create(e,s,t.selection&&t.selection.map(i),ht.mapEffects(t.effects,i),t.annotations,t.scrollIntoView)}let n=e.facet(Y$);for(let s=n.length-1;s>=0;s--){let i=n[s](t);i instanceof pr?t=i:Array.isArray(i)&&i.length==1&&i[0]instanceof pr?t=i[0]:t=Q$(e,ou(i),!1)}return t}function Mxe(t){let e=t.startState,r=e.facet(X$),n=t;for(let s=r.length-1;s>=0;s--){let i=r[s](t);i&&Object.keys(i).length&&(n=J$(n,Ux(e,i,t.changes.newLength),!0))}return n==t?t:pr.create(e,t.changes,t.selection,n.effects,n.annotations,n.scrollIntoView)}const Bxe=[];function ou(t){return t==null?Bxe:Array.isArray(t)?t:[t]}var mr=function(t){return t[t.Word=0]="Word",t[t.Space=1]="Space",t[t.Other=2]="Other",t}(mr||(mr={}));const Fxe=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let $x;try{$x=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function jxe(t){if($x)return $x.test(t);for(let e=0;e<t.length;e++){let r=t[e];if(/\w/.test(r)||r>""&&(r.toUpperCase()!=r.toLowerCase()||Fxe.test(r)))return!0}return!1}function Uxe(t){return e=>{if(!/\S/.test(e))return mr.Space;if(jxe(e))return mr.Word;for(let r=0;r<t.length;r++)if(e.indexOf(t[r])>-1)return mr.Word;return mr.Other}}class vt{constructor(e,r,n,s,i,o){this.config=e,this.doc=r,this.selection=n,this.values=s,this.status=e.statusTemplate.slice(),this.computeSlot=i,o&&(o._state=this);for(let a=0;a<this.config.dynamicSlots.length;a++)Ld(this,a<<1);this.computeSlot=null}field(e,r=!0){let n=this.config.address[e.id];if(n==null){if(r)throw new RangeError("Field is not present in this state");return}return Ld(this,n),T_(this,n)}update(...e){return Q$(this,e,!0)}applyTransaction(e){let r=this.config,{base:n,compartments:s}=r;for(let a of e.effects)a.is(hh.reconfigure)?(r&&(s=new Map,r.compartments.forEach((l,c)=>s.set(c,l)),r=null),s.set(a.value.compartment,a.value.extension)):a.is(ht.reconfigure)?(r=null,n=a.value):a.is(ht.appendConfig)&&(r=null,n=ou(n).concat(a.value));let i;r?i=e.startState.values.slice():(r=S_.resolve(n,s,this),i=new vt(r,this.doc,this.selection,r.dynamicSlots.map(()=>null),(l,c)=>c.reconfigure(l,this),null).values);let o=e.startState.facet(jx)?e.newSelection:e.newSelection.asSingle();new vt(r,e.newDoc,o,i,(a,l)=>l.update(a,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(r=>({changes:{from:r.from,to:r.to,insert:e},range:Re.cursor(r.from+e.length)}))}changeByRange(e){let r=this.selection,n=e(r.ranges[0]),s=this.changes(n.changes),i=[n.range],o=ou(n.effects);for(let a=1;a<r.ranges.length;a++){let l=e(r.ranges[a]),c=this.changes(l.changes),u=c.map(s);for(let d=0;d<a;d++)i[d]=i[d].map(u);let h=s.mapDesc(c,!0);i.push(l.range.map(h)),s=s.compose(u),o=ht.mapEffects(o,u).concat(ht.mapEffects(ou(l.effects),h))}return{changes:s,selection:Re.create(i,r.mainIndex),effects:o}}changes(e=[]){return e instanceof _r?e:_r.of(e,this.doc.length,this.facet(vt.lineSeparator))}toText(e){return It.of(e.split(this.facet(vt.lineSeparator)||Lx))}sliceDoc(e=0,r=this.doc.length){return this.doc.sliceString(e,r,this.lineBreak)}facet(e){let r=this.config.address[e.id];return r==null?e.default:(Ld(this,r),T_(this,r))}toJSON(e){let r={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let n in e){let s=e[n];s instanceof Pr&&this.config.address[s.id]!=null&&(r[n]=s.spec.toJSON(this.field(e[n]),this))}return r}static fromJSON(e,r={},n){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let s=[];if(n){for(let i in n)if(Object.prototype.hasOwnProperty.call(e,i)){let o=n[i],a=e[i];s.push(o.init(l=>o.spec.fromJSON(a,l)))}}return vt.create({doc:e.doc,selection:Re.fromJSON(e.selection),extensions:r.extensions?s.concat([r.extensions]):s})}static create(e={}){let r=S_.resolve(e.extensions||[],new Map),n=e.doc instanceof It?e.doc:It.of((e.doc||"").split(r.staticFacet(vt.lineSeparator)||Lx)),s=e.selection?e.selection instanceof Re?e.selection:Re.single(e.selection.anchor,e.selection.head):Re.single(0);return V$(s,n.length),r.staticFacet(jx)||(s=s.asSingle()),new vt(r,n,s,r.dynamicSlots.map(()=>null),(i,o)=>o.create(i),null)}get tabSize(){return this.facet(vt.tabSize)}get lineBreak(){return this.facet(vt.lineSeparator)||`
`}get readOnly(){return this.facet(Z$)}phrase(e,...r){for(let n of this.facet(vt.phrases))if(Object.prototype.hasOwnProperty.call(n,e)){e=n[e];break}return r.length&&(e=e.replace(/\$(\$|\d*)/g,(n,s)=>{if(s=="$")return"$";let i=+(s||1);return!i||i>r.length?n:r[i-1]})),e}languageDataAt(e,r,n=-1){let s=[];for(let i of this.facet(W$))for(let o of i(this,r,n))Object.prototype.hasOwnProperty.call(o,e)&&s.push(o[e]);return s}charCategorizer(e){return Uxe(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:r,from:n,length:s}=this.doc.lineAt(e),i=this.charCategorizer(e),o=e-n,a=e-n;for(;o>0;){let l=jr(r,o,!1);if(i(r.slice(l,o))!=mr.Word)break;o=l}for(;a<s;){let l=jr(r,a);if(i(r.slice(a,l))!=mr.Word)break;a=l}return o==a?null:Re.range(o+n,a+n)}}vt.allowMultipleSelections=jx;vt.tabSize=We.define({combine:t=>t.length?t[0]:4});vt.lineSeparator=q$;vt.readOnly=Z$;vt.phrases=We.define({compare(t,e){let r=Object.keys(t),n=Object.keys(e);return r.length==n.length&&r.every(s=>t[s]==e[s])}});vt.languageData=W$;vt.changeFilter=K$;vt.transactionFilter=Y$;vt.transactionExtender=X$;hh.reconfigure=ht.define();function ac(t,e,r={}){let n={};for(let s of t)for(let i of Object.keys(s)){let o=s[i],a=n[i];if(a===void 0)n[i]=o;else if(!(a===o||o===void 0))if(Object.hasOwnProperty.call(r,i))n[i]=r[i](a,o);else throw new Error("Config merge conflict for field "+i)}for(let s in e)n[s]===void 0&&(n[s]=e[s]);return n}class Vl{eq(e){return this==e}range(e,r=e){return Hx.create(e,r,this)}}Vl.prototype.startSide=Vl.prototype.endSide=0;Vl.prototype.point=!1;Vl.prototype.mapMode=Yr.TrackDel;let Hx=class eH{constructor(e,r,n){this.from=e,this.to=r,this.value=n}static create(e,r,n){return new eH(e,r,n)}};function zx(t,e){return t.from-e.from||t.value.startSide-e.value.startSide}class jk{constructor(e,r,n,s){this.from=e,this.to=r,this.value=n,this.maxPoint=s}get length(){return this.to[this.to.length-1]}findIndex(e,r,n,s=0){let i=n?this.to:this.from;for(let o=s,a=i.length;;){if(o==a)return o;let l=o+a>>1,c=i[l]-e||(n?this.value[l].endSide:this.value[l].startSide)-r;if(l==o)return c>=0?o:a;c>=0?a=l:o=l+1}}between(e,r,n,s){for(let i=this.findIndex(r,-1e9,!0),o=this.findIndex(n,1e9,!1,i);i<o;i++)if(s(this.from[i]+e,this.to[i]+e,this.value[i])===!1)return!1}map(e,r){let n=[],s=[],i=[],o=-1,a=-1;for(let l=0;l<this.value.length;l++){let c=this.value[l],u=this.from[l]+e,h=this.to[l]+e,d,f;if(u==h){let g=r.mapPos(u,c.startSide,c.mapMode);if(g==null||(d=f=g,c.startSide!=c.endSide&&(f=r.mapPos(u,c.endSide),f<d)))continue}else if(d=r.mapPos(u,c.startSide),f=r.mapPos(h,c.endSide),d>f||d==f&&c.startSide>0&&c.endSide<=0)continue;(f-d||c.endSide-c.startSide)<0||(o<0&&(o=d),c.point&&(a=Math.max(a,f-d)),n.push(c),s.push(d-o),i.push(f-o))}return{mapped:n.length?new jk(s,i,n,a):null,pos:o}}}class Tt{constructor(e,r,n,s){this.chunkPos=e,this.chunk=r,this.nextLayer=n,this.maxPoint=s}static create(e,r,n,s){return new Tt(e,r,n,s)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let r of this.chunk)e+=r.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:r=[],sort:n=!1,filterFrom:s=0,filterTo:i=this.length}=e,o=e.filter;if(r.length==0&&!o)return this;if(n&&(r=r.slice().sort(zx)),this.isEmpty)return r.length?Tt.of(r):this;let a=new tH(this,null,-1).goto(0),l=0,c=[],u=new Gl;for(;a.value||l<r.length;)if(l<r.length&&(a.from-r[l].from||a.startSide-r[l].value.startSide)>=0){let h=r[l++];u.addInner(h.from,h.to,h.value)||c.push(h)}else a.rangeIndex==1&&a.chunkIndex<this.chunk.length&&(l==r.length||this.chunkEnd(a.chunkIndex)<r[l].from)&&(!o||s>this.chunkEnd(a.chunkIndex)||i<this.chunkPos[a.chunkIndex])&&u.addChunk(this.chunkPos[a.chunkIndex],this.chunk[a.chunkIndex])?a.nextChunk():((!o||s>a.to||i<a.from||o(a.from,a.to,a.value))&&(u.addInner(a.from,a.to,a.value)||c.push(Hx.create(a.from,a.to,a.value))),a.next());return u.finishInner(this.nextLayer.isEmpty&&!c.length?Tt.empty:this.nextLayer.update({add:c,filter:o,filterFrom:s,filterTo:i}))}map(e){if(e.empty||this.isEmpty)return this;let r=[],n=[],s=-1;for(let o=0;o<this.chunk.length;o++){let a=this.chunkPos[o],l=this.chunk[o],c=e.touchesRange(a,a+l.length);if(c===!1)s=Math.max(s,l.maxPoint),r.push(l),n.push(e.mapPos(a));else if(c===!0){let{mapped:u,pos:h}=l.map(a,e);u&&(s=Math.max(s,u.maxPoint),r.push(u),n.push(h))}}let i=this.nextLayer.map(e);return r.length==0?i:new Tt(n,r,i||Tt.empty,s)}between(e,r,n){if(!this.isEmpty){for(let s=0;s<this.chunk.length;s++){let i=this.chunkPos[s],o=this.chunk[s];if(r>=i&&e<=i+o.length&&o.between(i,e-i,r-i,n)===!1)return}this.nextLayer.between(e,r,n)}}iter(e=0){return kf.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,r=0){return kf.from(e).goto(r)}static compare(e,r,n,s,i=-1){let o=e.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=i),a=r.filter(h=>h.maxPoint>0||!h.isEmpty&&h.maxPoint>=i),l=zO(o,a,n),c=new $h(o,l,i),u=new $h(a,l,i);n.iterGaps((h,d,f)=>VO(c,h,u,d,f,s)),n.empty&&n.length==0&&VO(c,0,u,0,0,s)}static eq(e,r,n=0,s){s==null&&(s=999999999);let i=e.filter(u=>!u.isEmpty&&r.indexOf(u)<0),o=r.filter(u=>!u.isEmpty&&e.indexOf(u)<0);if(i.length!=o.length)return!1;if(!i.length)return!0;let a=zO(i,o),l=new $h(i,a,0).goto(n),c=new $h(o,a,0).goto(n);for(;;){if(l.to!=c.to||!Vx(l.active,c.active)||l.point&&(!c.point||!l.point.eq(c.point)))return!1;if(l.to>s)return!0;l.next(),c.next()}}static spans(e,r,n,s,i=-1){let o=new $h(e,null,i).goto(r),a=r,l=o.openStart;for(;;){let c=Math.min(o.to,n);if(o.point){let u=o.activeForPoint(o.to),h=o.pointFrom<r?u.length+1:o.point.startSide<0?u.length:Math.min(u.length,l);s.point(a,c,o.point,u,h,o.pointRank),l=Math.min(o.openEnd(c),u.length)}else c>a&&(s.span(a,c,o.active,l),l=o.openEnd(c));if(o.to>n)return l+(o.point&&o.to>n?1:0);a=o.to,o.next()}}static of(e,r=!1){let n=new Gl;for(let s of e instanceof Hx?[e]:r?$xe(e):e)n.add(s.from,s.to,s.value);return n.finish()}static join(e){if(!e.length)return Tt.empty;let r=e[e.length-1];for(let n=e.length-2;n>=0;n--)for(let s=e[n];s!=Tt.empty;s=s.nextLayer)r=new Tt(s.chunkPos,s.chunk,r,Math.max(s.maxPoint,r.maxPoint));return r}}Tt.empty=new Tt([],[],null,-1);function $xe(t){if(t.length>1)for(let e=t[0],r=1;r<t.length;r++){let n=t[r];if(zx(e,n)>0)return t.slice().sort(zx);e=n}return t}Tt.empty.nextLayer=Tt.empty;class Gl{finishChunk(e){this.chunks.push(new jk(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,r,n){this.addInner(e,r,n)||(this.nextLayer||(this.nextLayer=new Gl)).add(e,r,n)}addInner(e,r,n){let s=e-this.lastTo||n.startSide-this.last.endSide;if(s<=0&&(e-this.lastFrom||n.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return s<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(r-this.chunkStart),this.last=n,this.lastFrom=e,this.lastTo=r,this.value.push(n),n.point&&(this.maxPoint=Math.max(this.maxPoint,r-e)),!0)}addChunk(e,r){if((e-this.lastTo||r.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,r.maxPoint),this.chunks.push(r),this.chunkPos.push(e);let n=r.value.length-1;return this.last=r.value[n],this.lastFrom=r.from[n]+e,this.lastTo=r.to[n]+e,!0}finish(){return this.finishInner(Tt.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let r=Tt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,r}}function zO(t,e,r){let n=new Map;for(let i of t)for(let o=0;o<i.chunk.length;o++)i.chunk[o].maxPoint<=0&&n.set(i.chunk[o],i.chunkPos[o]);let s=new Set;for(let i of e)for(let o=0;o<i.chunk.length;o++){let a=n.get(i.chunk[o]);a!=null&&(r?r.mapPos(a):a)==i.chunkPos[o]&&!r?.touchesRange(a,a+i.chunk[o].length)&&s.add(i.chunk[o])}return s}class tH{constructor(e,r,n,s=0){this.layer=e,this.skip=r,this.minPoint=n,this.rank=s}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,r=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,r,!1),this}gotoInner(e,r,n){for(;this.chunkIndex<this.layer.chunk.length;){let s=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(s)||this.layer.chunkEnd(this.chunkIndex)<e||s.maxPoint<this.minPoint))break;this.chunkIndex++,n=!1}if(this.chunkIndex<this.layer.chunk.length){let s=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],r,!0);(!n||this.rangeIndex<s)&&this.setRangeIndex(s)}this.next()}forward(e,r){(this.to-e||this.endSide-r)<0&&this.gotoInner(e,r,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],r=this.layer.chunk[this.chunkIndex],n=e+r.from[this.rangeIndex];if(this.from=n,this.to=e+r.to[this.rangeIndex],this.value=r.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class kf{constructor(e){this.heap=e}static from(e,r=null,n=-1){let s=[];for(let i=0;i<e.length;i++)for(let o=e[i];!o.isEmpty;o=o.nextLayer)o.maxPoint>=n&&s.push(new tH(o,r,n,i));return s.length==1?s[0]:new kf(s)}get startSide(){return this.value?this.value.startSide:0}goto(e,r=-1e9){for(let n of this.heap)n.goto(e,r);for(let n=this.heap.length>>1;n>=0;n--)Tw(this.heap,n);return this.next(),this}forward(e,r){for(let n of this.heap)n.forward(e,r);for(let n=this.heap.length>>1;n>=0;n--)Tw(this.heap,n);(this.to-e||this.value.endSide-r)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),Tw(this.heap,0)}}}function Tw(t,e){for(let r=t[e];;){let n=(e<<1)+1;if(n>=t.length)break;let s=t[n];if(n+1<t.length&&s.compare(t[n+1])>=0&&(s=t[n+1],n++),r.compare(s)<0)break;t[n]=r,t[e]=s,e=n}}class $h{constructor(e,r,n){this.minPoint=n,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=kf.from(e,r,n)}goto(e,r=-1e9){return this.cursor.goto(e,r),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=r,this.openStart=-1,this.next(),this}forward(e,r){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-r)<0;)this.removeActive(this.minActive);this.cursor.forward(e,r)}removeActive(e){tg(this.active,e),tg(this.activeTo,e),tg(this.activeRank,e),this.minActive=GO(this.active,this.activeTo)}addActive(e){let r=0,{value:n,to:s,rank:i}=this.cursor;for(;r<this.activeRank.length&&(i-this.activeRank[r]||s-this.activeTo[r])>0;)r++;rg(this.active,r,n),rg(this.activeTo,r,s),rg(this.activeRank,r,i),e&&rg(e,r,this.cursor.from),this.minActive=GO(this.active,this.activeTo)}next(){let e=this.to,r=this.point;this.point=null;let n=this.openStart<0?[]:null;for(;;){let s=this.minActive;if(s>-1&&(this.activeTo[s]-this.cursor.from||this.active[s].endSide-this.cursor.startSide)<0){if(this.activeTo[s]>e){this.to=this.activeTo[s],this.endSide=this.active[s].endSide;break}this.removeActive(s),n&&tg(n,s)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let i=this.cursor.value;if(!i.point)this.addActive(n),this.cursor.next();else if(r&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=i,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=i.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(n){this.openStart=0;for(let s=n.length-1;s>=0&&n[s]<e;s--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let r=[];for(let n=this.active.length-1;n>=0&&!(this.activeRank[n]<this.pointRank);n--)(this.activeTo[n]>e||this.activeTo[n]==e&&this.active[n].endSide>=this.point.endSide)&&r.push(this.active[n]);return r.reverse()}openEnd(e){let r=0;for(let n=this.activeTo.length-1;n>=0&&this.activeTo[n]>e;n--)r++;return r}}function VO(t,e,r,n,s,i){t.goto(e),r.goto(n);let o=n+s,a=n,l=n-e;for(;;){let c=t.to+l-r.to||t.endSide-r.endSide,u=c<0?t.to+l:r.to,h=Math.min(u,o);if(t.point||r.point?t.point&&r.point&&(t.point==r.point||t.point.eq(r.point))&&Vx(t.activeForPoint(t.to),r.activeForPoint(r.to))||i.comparePoint(a,h,t.point,r.point):h>a&&!Vx(t.active,r.active)&&i.compareRange(a,h,t.active,r.active),u>o)break;a=u,c<=0&&t.next(),c>=0&&r.next()}}function Vx(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!=e[r]&&!t[r].eq(e[r]))return!1;return!0}function tg(t,e){for(let r=e,n=t.length-1;r<n;r++)t[r]=t[r+1];t.pop()}function rg(t,e,r){for(let n=t.length-1;n>=e;n--)t[n+1]=t[n];t[e]=r}function GO(t,e){let r=-1,n=1e9;for(let s=0;s<e.length;s++)(e[s]-n||t[s].endSide-t[r].endSide)<0&&(r=s,n=e[s]);return r}function kb(t,e,r=t.length){let n=0;for(let s=0;s<r;)t.charCodeAt(s)==9?(n+=e-n%e,s++):(n++,s=jr(t,s));return n}function Hxe(t,e,r,n){for(let s=0,i=0;;){if(i>=e)return s;if(s==t.length)break;i+=t.charCodeAt(s)==9?r-i%r:1,s=jr(t,s)}return n===!0?-1:t.length}const Gx="ͼ",WO=typeof Symbol>"u"?"__"+Gx:Symbol.for(Gx),Wx=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),qO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Oa{constructor(e,r){this.rules=[];let{finish:n}=r||{};function s(o){return/^@/.test(o)?[o]:o.split(/,\s*/)}function i(o,a,l,c){let u=[],h=/^@(\w+)\b/.exec(o[0]),d=h&&h[1]=="keyframes";if(h&&a==null)return l.push(o[0]+";");for(let f in a){let g=a[f];if(/&/.test(f))i(f.split(/,\s*/).map(_=>o.map(m=>_.replace(/&/,m))).reduce((_,m)=>_.concat(m)),g,l);else if(g&&typeof g=="object"){if(!h)throw new RangeError("The value of a property ("+f+") should be a primitive value.");i(s(f),g,u,d)}else g!=null&&u.push(f.replace(/_.*/,"").replace(/[A-Z]/g,_=>"-"+_.toLowerCase())+": "+g+";")}(u.length||d)&&l.push((n&&!h&&!c?o.map(n):o).join(", ")+" {"+u.join(" ")+"}")}for(let o in e)i(s(o),e[o],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=qO[WO]||1;return qO[WO]=e+1,Gx+e.toString(36)}static mount(e,r,n){let s=e[Wx],i=n&&n.nonce;s?i&&s.setNonce(i):s=new zxe(e,i),s.mount(Array.isArray(r)?r:[r],e)}}let KO=new Map;class zxe{constructor(e,r){let n=e.ownerDocument||e,s=n.defaultView;if(!e.head&&e.adoptedStyleSheets&&s.CSSStyleSheet){let i=KO.get(n);if(i)return e[Wx]=i;this.sheet=new s.CSSStyleSheet,KO.set(n,this)}else this.styleTag=n.createElement("style"),r&&this.styleTag.setAttribute("nonce",r);this.modules=[],e[Wx]=this}mount(e,r){let n=this.sheet,s=0,i=0;for(let o=0;o<e.length;o++){let a=e[o],l=this.modules.indexOf(a);if(l<i&&l>-1&&(this.modules.splice(l,1),i--,l=-1),l==-1){if(this.modules.splice(i++,0,a),n)for(let c=0;c<a.rules.length;c++)n.insertRule(a.rules[c],s++)}else{for(;i<l;)s+=this.modules[i++].rules.length;s+=a.rules.length,i++}}if(n)r.adoptedStyleSheets.indexOf(this.sheet)<0&&(r.adoptedStyleSheets=[this.sheet,...r.adoptedStyleSheets]);else{let o="";for(let l=0;l<this.modules.length;l++)o+=this.modules[l].getRules()+`
`;this.styleTag.textContent=o;let a=r.head||r;this.styleTag.parentNode!=a&&a.insertBefore(this.styleTag,a.firstChild)}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var Da={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Af={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Vxe=typeof navigator<"u"&&/Mac/.test(navigator.platform),Gxe=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Br=0;Br<10;Br++)Da[48+Br]=Da[96+Br]=String(Br);for(var Br=1;Br<=24;Br++)Da[Br+111]="F"+Br;for(var Br=65;Br<=90;Br++)Da[Br]=String.fromCharCode(Br+32),Af[Br]=String.fromCharCode(Br);for(var Cw in Da)Af.hasOwnProperty(Cw)||(Af[Cw]=Da[Cw]);function Wxe(t){var e=Vxe&&t.metaKey&&t.shiftKey&&!t.ctrlKey&&!t.altKey||Gxe&&t.shiftKey&&t.key&&t.key.length==1||t.key=="Unidentified",r=!e&&t.key||(t.shiftKey?Af:Da)[t.keyCode]||t.key||"Unidentified";return r=="Esc"&&(r="Escape"),r=="Del"&&(r="Delete"),r=="Left"&&(r="ArrowLeft"),r=="Up"&&(r="ArrowUp"),r=="Right"&&(r="ArrowRight"),r=="Down"&&(r="ArrowDown"),r}function Rf(t){let e;return t.nodeType==11?e=t.getSelection?t:t.ownerDocument:e=t,e.getSelection()}function qx(t,e){return e?t==e||t.contains(e.nodeType!=1?e.parentNode:e):!1}function i0(t,e){if(!e.anchorNode)return!1;try{return qx(t,e.anchorNode)}catch{return!1}}function If(t){return t.nodeType==3?ql(t,0,t.nodeValue.length).getClientRects():t.nodeType==1?t.getClientRects():[]}function Nd(t,e,r,n){return r?YO(t,e,r,n,-1)||YO(t,e,r,n,1):!1}function Wl(t){for(var e=0;;e++)if(t=t.previousSibling,!t)return e}function C_(t){return t.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(t.nodeName)}function YO(t,e,r,n,s){for(;;){if(t==r&&e==n)return!0;if(e==(s<0?0:$i(t))){if(t.nodeName=="DIV")return!1;let i=t.parentNode;if(!i||i.nodeType!=1)return!1;e=Wl(t)+(s<0?0:1),t=i}else if(t.nodeType==1){if(t=t.childNodes[e+(s<0?-1:0)],t.nodeType==1&&t.contentEditable=="false")return!1;e=s<0?$i(t):0}else return!1}}function $i(t){return t.nodeType==3?t.nodeValue.length:t.childNodes.length}function Ab(t,e){let r=e?t.left:t.right;return{left:r,right:r,top:t.top,bottom:t.bottom}}function qxe(t){let e=t.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:t.innerWidth,top:0,bottom:t.innerHeight}}function rH(t,e){let r=e.width/t.offsetWidth,n=e.height/t.offsetHeight;return(r>.995&&r<1.005||!isFinite(r)||Math.abs(e.width-t.offsetWidth)<1)&&(r=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-t.offsetHeight)<1)&&(n=1),{scaleX:r,scaleY:n}}function Kxe(t,e,r,n,s,i,o,a){let l=t.ownerDocument,c=l.defaultView||window;for(let u=t,h=!1;u&&!h;)if(u.nodeType==1){let d,f=u==l.body,g=1,_=1;if(f)d=qxe(c);else{if(/^(fixed|sticky)$/.test(getComputedStyle(u).position)&&(h=!0),u.scrollHeight<=u.clientHeight&&u.scrollWidth<=u.clientWidth){u=u.assignedSlot||u.parentNode;continue}let y=u.getBoundingClientRect();({scaleX:g,scaleY:_}=rH(u,y)),d={left:y.left,right:y.left+u.clientWidth*g,top:y.top,bottom:y.top+u.clientHeight*_}}let m=0,p=0;if(s=="nearest")e.top<d.top?(p=-(d.top-e.top+o),r>0&&e.bottom>d.bottom+p&&(p=e.bottom-d.bottom+p+o)):e.bottom>d.bottom&&(p=e.bottom-d.bottom+o,r<0&&e.top-p<d.top&&(p=-(d.top+p-e.top+o)));else{let y=e.bottom-e.top,b=d.bottom-d.top;p=(s=="center"&&y<=b?e.top+y/2-b/2:s=="start"||s=="center"&&r<0?e.top-o:e.bottom-b+o)-d.top}if(n=="nearest"?e.left<d.left?(m=-(d.left-e.left+i),r>0&&e.right>d.right+m&&(m=e.right-d.right+m+i)):e.right>d.right&&(m=e.right-d.right+i,r<0&&e.left<d.left+m&&(m=-(d.left+m-e.left+i))):m=(n=="center"?e.left+(e.right-e.left)/2-(d.right-d.left)/2:n=="start"==a?e.left-i:e.right-(d.right-d.left)+i)-d.left,m||p)if(f)c.scrollBy(m,p);else{let y=0,b=0;if(p){let v=u.scrollTop;u.scrollTop+=p/_,b=(u.scrollTop-v)*_}if(m){let v=u.scrollLeft;u.scrollLeft+=m/g,y=(u.scrollLeft-v)*g}e={left:e.left-y,top:e.top-b,right:e.right-y,bottom:e.bottom-b},y&&Math.abs(y-m)<1&&(n="nearest"),b&&Math.abs(b-p)<1&&(s="nearest")}if(f)break;u=u.assignedSlot||u.parentNode}else if(u.nodeType==11)u=u.host;else break}function Yxe(t){let e=t.ownerDocument,r,n;for(let s=t.parentNode;s&&!(s==e.body||r&&n);)if(s.nodeType==1)!n&&s.scrollHeight>s.clientHeight&&(n=s),!r&&s.scrollWidth>s.clientWidth&&(r=s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;return{x:r,y:n}}class Xxe{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:r,focusNode:n}=e;this.set(r,Math.min(e.anchorOffset,r?$i(r):0),n,Math.min(e.focusOffset,n?$i(n):0))}set(e,r,n,s){this.anchorNode=e,this.anchorOffset=r,this.focusNode=n,this.focusOffset=s}}let xc=null;function nH(t){if(t.setActive)return t.setActive();if(xc)return t.focus(xc);let e=[];for(let r=t;r&&(e.push(r,r.scrollTop,r.scrollLeft),r!=r.ownerDocument);r=r.parentNode);if(t.focus(xc==null?{get preventScroll(){return xc={preventScroll:!0},!0}}:void 0),!xc){xc=!1;for(let r=0;r<e.length;){let n=e[r++],s=e[r++],i=e[r++];n.scrollTop!=s&&(n.scrollTop=s),n.scrollLeft!=i&&(n.scrollLeft=i)}}}let XO;function ql(t,e,r=e){let n=XO||(XO=document.createRange());return n.setEnd(t,r),n.setStart(t,e),n}function au(t,e,r,n){let s={key:e,code:e,keyCode:r,which:r,cancelable:!0};n&&({altKey:s.altKey,ctrlKey:s.ctrlKey,shiftKey:s.shiftKey,metaKey:s.metaKey}=n);let i=new KeyboardEvent("keydown",s);i.synthetic=!0,t.dispatchEvent(i);let o=new KeyboardEvent("keyup",s);return o.synthetic=!0,t.dispatchEvent(o),i.defaultPrevented||o.defaultPrevented}function Zxe(t){for(;t;){if(t&&(t.nodeType==9||t.nodeType==11&&t.host))return t;t=t.assignedSlot||t.parentNode}return null}function sH(t){for(;t.attributes.length;)t.removeAttributeNode(t.attributes[0])}function Jxe(t,e){let r=e.focusNode,n=e.focusOffset;if(!r||e.anchorNode!=r||e.anchorOffset!=n)return!1;for(n=Math.min(n,$i(r));;)if(n){if(r.nodeType!=1)return!1;let s=r.childNodes[n-1];s.contentEditable=="false"?n--:(r=s,n=$i(r))}else{if(r==t)return!0;n=Wl(r),r=r.parentNode}}function iH(t){return t.scrollTop>Math.max(1,t.scrollHeight-t.clientHeight-4)}function oH(t,e){for(let r=t,n=e;;){if(r.nodeType==3&&n>0)return{node:r,offset:n};if(r.nodeType==1&&n>0){if(r.contentEditable=="false")return null;r=r.childNodes[n-1],n=$i(r)}else if(r.parentNode&&!C_(r))n=Wl(r),r=r.parentNode;else return null}}function aH(t,e){for(let r=t,n=e;;){if(r.nodeType==3&&n<r.nodeValue.length)return{node:r,offset:n};if(r.nodeType==1&&n<r.childNodes.length){if(r.contentEditable=="false")return null;r=r.childNodes[n],n=0}else if(r.parentNode&&!C_(r))n=Wl(r)+1,r=r.parentNode;else return null}}class Xr{constructor(e,r,n=!0){this.node=e,this.offset=r,this.precise=n}static before(e,r){return new Xr(e.parentNode,Wl(e),r)}static after(e,r){return new Xr(e.parentNode,Wl(e)+1,r)}}const Uk=[];class jt{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let r=this.posAtStart;for(let n of this.children){if(n==e)return r;r+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,r){if(this.flags&2){let n=this.dom,s=null,i;for(let o of this.children){if(o.flags&7){if(!o.dom&&(i=s?s.nextSibling:n.firstChild)){let a=jt.get(i);(!a||!a.parent&&a.canReuseDOM(o))&&o.reuseDOM(i)}o.sync(e,r),o.flags&=-8}if(i=s?s.nextSibling:n.firstChild,r&&!r.written&&r.node==n&&i!=o.dom&&(r.written=!0),o.dom.parentNode==n)for(;i&&i!=o.dom;)i=ZO(i);else n.insertBefore(o.dom,i);s=o.dom}for(i=s?s.nextSibling:n.firstChild,i&&r&&r.node==n&&(r.written=!0);i;)i=ZO(i)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,r),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,r){let n;if(e==this.dom)n=this.dom.childNodes[r];else{let s=$i(e)==0?0:r==0?-1:1;for(;;){let i=e.parentNode;if(i==this.dom)break;s==0&&i.firstChild!=i.lastChild&&(e==i.firstChild?s=-1:s=1),e=i}s<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!jt.get(n);)n=n.nextSibling;if(!n)return this.length;for(let s=0,i=0;;s++){let o=this.children[s];if(o.dom==n)return i;i+=o.length+o.breakAfter}}domBoundsAround(e,r,n=0){let s=-1,i=-1,o=-1,a=-1;for(let l=0,c=n,u=n;l<this.children.length;l++){let h=this.children[l],d=c+h.length;if(c<e&&d>r)return h.domBoundsAround(e,r,c);if(d>=e&&s==-1&&(s=l,i=c),c>r&&h.dom.parentNode==this.dom){o=l,a=u;break}u=d,c=d+h.breakAfter}return{from:i,to:a<0?n+this.length:a,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:o<this.children.length&&o>=0?this.children[o].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let r=this.parent;r;r=r.parent){if(e&&(r.flags|=2),r.flags&1)return;r.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let r=e.parent;if(!r)return e;e=r}}replaceChildren(e,r,n=Uk){this.markDirty();for(let s=e;s<r;s++){let i=this.children[s];i.parent==this&&n.indexOf(i)<0&&i.destroy()}n.length<250?this.children.splice(e,r-e,...n):this.children=[].concat(this.children.slice(0,e),n,this.children.slice(r));for(let s=0;s<n.length;s++)n[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new lH(this.children,e,this.children.length)}childPos(e,r=1){return this.childCursor().findPos(e,r)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,r,n,s,i,o){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}jt.prototype.breakAfter=0;function ZO(t){let e=t.nextSibling;return t.parentNode.removeChild(t),e}class lH{constructor(e,r,n){this.children=e,this.pos=r,this.i=n,this.off=0}findPos(e,r=1){for(;;){if(e>this.pos||e==this.pos&&(r>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function cH(t,e,r,n,s,i,o,a,l){let{children:c}=t,u=c.length?c[e]:null,h=i.length?i[i.length-1]:null,d=h?h.breakAfter:o;if(!(e==n&&u&&!o&&!d&&i.length<2&&u.merge(r,s,i.length?h:null,r==0,a,l))){if(n<c.length){let f=c[n];f&&(s<f.length||f.breakAfter&&h?.breakAfter)?(e==n&&(f=f.split(s),s=0),!d&&h&&f.merge(0,s,h,!0,0,l)?i[i.length-1]=f:((s||f.children.length&&!f.children[0].length)&&f.merge(0,s,null,!1,0,l),i.push(f))):f?.breakAfter&&(h?h.breakAfter=1:o=1),n++}for(u&&(u.breakAfter=o,r>0&&(!o&&i.length&&u.merge(r,u.length,i[0],!1,a,0)?u.breakAfter=i.shift().breakAfter:(r<u.length||u.children.length&&u.children[u.children.length-1].length==0)&&u.merge(r,u.length,null,!1,a,0),e++));e<n&&i.length;)if(c[n-1].become(i[i.length-1]))n--,i.pop(),l=i.length?0:a;else if(c[e].become(i[0]))e++,i.shift(),a=i.length?0:l;else break;!i.length&&e&&n<c.length&&!c[e-1].breakAfter&&c[n].merge(0,0,c[e-1],!1,a,l)&&e--,(e<n||i.length)&&t.replaceChildren(e,n,i)}}function uH(t,e,r,n,s,i){let o=t.childCursor(),{i:a,off:l}=o.findPos(r,1),{i:c,off:u}=o.findPos(e,-1),h=e-r;for(let d of n)h+=d.length;t.length+=h,cH(t,c,u,a,l,n,0,s,i)}let Rn=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},Kx=typeof document<"u"?document:{documentElement:{style:{}}};const Yx=/Edge\/(\d+)/.exec(Rn.userAgent),hH=/MSIE \d/.test(Rn.userAgent),Xx=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Rn.userAgent),Rb=!!(hH||Xx||Yx),JO=!Rb&&/gecko\/(\d+)/i.test(Rn.userAgent),kw=!Rb&&/Chrome\/(\d+)/.exec(Rn.userAgent),QO="webkitFontSmoothing"in Kx.documentElement.style,dH=!Rb&&/Apple Computer/.test(Rn.vendor),eD=dH&&(/Mobile\/\w+/.test(Rn.userAgent)||Rn.maxTouchPoints>2);var Ve={mac:eD||/Mac/.test(Rn.platform),windows:/Win/.test(Rn.platform),linux:/Linux|X11/.test(Rn.platform),ie:Rb,ie_version:hH?Kx.documentMode||6:Xx?+Xx[1]:Yx?+Yx[1]:0,gecko:JO,gecko_version:JO?+(/Firefox\/(\d+)/.exec(Rn.userAgent)||[0,0])[1]:0,chrome:!!kw,chrome_version:kw?+kw[1]:0,ios:eD,android:/Android\b/.test(Rn.userAgent),webkit:QO,safari:dH,webkit_version:QO?+(/\bAppleWebKit\/(\d+)/.exec(Rn.userAgent)||[0,0])[1]:0,tabSize:Kx.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const Qxe=256;class zs extends jt{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,r){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(r&&r.node==this.dom&&(r.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,r,n){return this.flags&8||n&&(!(n instanceof zs)||this.length-(r-e)+n.length>Qxe||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(r),this.markDirty(),!0)}split(e){let r=new zs(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),r.flags|=this.flags&8,r}localPosFromDOM(e,r){return e==this.dom?r:r?this.text.length:0}domAtPos(e){return new Xr(this.dom,e)}domBoundsAround(e,r,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,r){return eSe(this.dom,e,r)}}class Co extends jt{constructor(e,r=[],n=0){super(),this.mark=e,this.children=r,this.length=n;for(let s of r)s.setParent(this)}setAttrs(e){if(sH(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let r in this.mark.attrs)e.setAttribute(r,this.mark.attrs[r]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,r){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,r)}merge(e,r,n,s,i,o){return n&&(!(n instanceof Co&&n.mark.eq(this.mark))||e&&i<=0||r<this.length&&o<=0)?!1:(uH(this,e,r,n?n.children.slice():[],i-1,o-1),this.markDirty(),!0)}split(e){let r=[],n=0,s=-1,i=0;for(let a of this.children){let l=n+a.length;l>e&&r.push(n<e?a.split(e-n):a),s<0&&n>=e&&(s=i),n=l,i++}let o=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new Co(this.mark,r,o)}domAtPos(e){return fH(this,e)}coordsAt(e,r){return mH(this,e,r)}}function eSe(t,e,r){let n=t.nodeValue.length;e>n&&(e=n);let s=e,i=e,o=0;e==0&&r<0||e==n&&r>=0?Ve.chrome||Ve.gecko||(e?(s--,o=1):i<n&&(i++,o=-1)):r<0?s--:i<n&&i++;let a=ql(t,s,i).getClientRects();if(!a.length)return null;let l=a[(o?o<0:r>=0)?0:a.length-1];return Ve.safari&&!o&&l.width==0&&(l=Array.prototype.find.call(a,c=>c.width)||l),o?Ab(l,o<0):l||null}class ml extends jt{static create(e,r,n){return new ml(e,r,n)}constructor(e,r,n){super(),this.widget=e,this.length=r,this.side=n,this.prevWidget=null}split(e){let r=ml.create(this.widget,this.length-e,this.side);return this.length-=e,r}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,r,n,s,i,o){return n&&(!(n instanceof ml)||!this.widget.compare(n.widget)||e>0&&i<=0||r<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-r),!0)}become(e){return e instanceof ml&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return It.empty;let e=this;for(;e.parent;)e=e.parent;let{view:r}=e,n=r&&r.state.doc,s=this.posAtStart;return n?n.slice(s,s+this.length):It.empty}domAtPos(e){return(this.length?e==0:this.side>0)?Xr.before(this.dom):Xr.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,r){let n=this.widget.coordsAt(this.dom,e,r);if(n)return n;let s=this.dom.getClientRects(),i=null;if(!s.length)return null;let o=this.side?this.side<0:e>0;for(let a=o?s.length-1:0;i=s[a],!(e>0?a==0:a==s.length-1||i.top<i.bottom);a+=o?-1:1);return Ab(i,!o)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class Lu extends jt{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof Lu&&e.side==this.side}split(){return new Lu(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Xr.before(this.dom):Xr.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return It.empty}get isHidden(){return!0}}zs.prototype.children=ml.prototype.children=Lu.prototype.children=Uk;function fH(t,e){let r=t.dom,{children:n}=t,s=0;for(let i=0;s<n.length;s++){let o=n[s],a=i+o.length;if(!(a==i&&o.getSide()<=0)){if(e>i&&e<a&&o.dom.parentNode==r)return o.domAtPos(e-i);if(e<=i)break;i=a}}for(let i=s;i>0;i--){let o=n[i-1];if(o.dom.parentNode==r)return o.domAtPos(o.length)}for(let i=s;i<n.length;i++){let o=n[i];if(o.dom.parentNode==r)return o.domAtPos(0)}return new Xr(r,0)}function pH(t,e,r){let n,{children:s}=t;r>0&&e instanceof Co&&s.length&&(n=s[s.length-1])instanceof Co&&n.mark.eq(e.mark)?pH(n,e.children[0],r-1):(s.push(e),e.setParent(t)),t.length+=e.length}function mH(t,e,r){let n=null,s=-1,i=null,o=-1;function a(c,u){for(let h=0,d=0;h<c.children.length&&d<=u;h++){let f=c.children[h],g=d+f.length;g>=u&&(f.children.length?a(f,u-d):(!i||i.isHidden&&r>0)&&(g>u||d==g&&f.getSide()>0)?(i=f,o=u-d):(d<u||d==g&&f.getSide()<0&&!f.isHidden)&&(n=f,s=u-d)),d=g}}a(t,e);let l=(r<0?n:i)||n||i;return l?l.coordsAt(Math.max(0,l==n?s:o),r):tSe(t)}function tSe(t){let e=t.dom.lastChild;if(!e)return t.dom.getBoundingClientRect();let r=If(e);return r[r.length-1]||null}function Zx(t,e){for(let r in t)r=="class"&&e.class?e.class+=" "+t.class:r=="style"&&e.style?e.style+=";"+t.style:e[r]=t[r];return e}const tD=Object.create(null);function k_(t,e,r){if(t==e)return!0;t||(t=tD),e||(e=tD);let n=Object.keys(t),s=Object.keys(e);if(n.length-(r&&n.indexOf(r)>-1?1:0)!=s.length-(r&&s.indexOf(r)>-1?1:0))return!1;for(let i of n)if(i!=r&&(s.indexOf(i)==-1||t[i]!==e[i]))return!1;return!0}function Jx(t,e,r){let n=!1;if(e)for(let s in e)r&&s in r||(n=!0,s=="style"?t.style.cssText="":t.removeAttribute(s));if(r)for(let s in r)e&&e[s]==r[s]||(n=!0,s=="style"?t.style.cssText=r[s]:t.setAttribute(s,r[s]));return n}function rSe(t){let e=Object.create(null);for(let r=0;r<t.attributes.length;r++){let n=t.attributes[r];e[n.name]=n.value}return e}class dh{eq(e){return!1}updateDOM(e,r){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,r,n){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var pn=function(t){return t[t.Text=0]="Text",t[t.WidgetBefore=1]="WidgetBefore",t[t.WidgetAfter=2]="WidgetAfter",t[t.WidgetRange=3]="WidgetRange",t}(pn||(pn={}));class yt extends Vl{constructor(e,r,n,s){super(),this.startSide=e,this.endSide=r,this.widget=n,this.spec=s}get heightRelevant(){return!1}static mark(e){return new Np(e)}static widget(e){let r=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return r+=n&&!e.inlineOrder?r>0?3e8:-4e8:r>0?1e8:-1e8,new La(e,r,r,n,e.widget||null,!1)}static replace(e){let r=!!e.block,n,s;if(e.isBlockGap)n=-5e8,s=4e8;else{let{start:i,end:o}=gH(e,r);n=(i?r?-3e8:-1:5e8)-1,s=(o?r?2e8:1:-6e8)+1}return new La(e,n,s,r,e.widget||null,!0)}static line(e){return new Mp(e)}static set(e,r=!1){return Tt.of(e,r)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}yt.none=Tt.empty;class Np extends yt{constructor(e){let{start:r,end:n}=gH(e);super(r?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var r,n;return this==e||e instanceof Np&&this.tagName==e.tagName&&(this.class||((r=this.attrs)===null||r===void 0?void 0:r.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&k_(this.attrs,e.attrs,"class")}range(e,r=e){if(e>=r)throw new RangeError("Mark decorations may not be empty");return super.range(e,r)}}Np.prototype.point=!1;class Mp extends yt{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Mp&&this.spec.class==e.spec.class&&k_(this.spec.attributes,e.spec.attributes)}range(e,r=e){if(r!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,r)}}Mp.prototype.mapMode=Yr.TrackBefore;Mp.prototype.point=!0;class La extends yt{constructor(e,r,n,s,i,o){super(r,n,i,e),this.block=s,this.isReplace=o,this.mapMode=s?r<=0?Yr.TrackBefore:Yr.TrackAfter:Yr.TrackDel}get type(){return this.startSide!=this.endSide?pn.WidgetRange:this.startSide<=0?pn.WidgetBefore:pn.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof La&&nSe(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,r=e){if(this.isReplace&&(e>r||e==r&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&r!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,r)}}La.prototype.point=!0;function gH(t,e=!1){let{inclusiveStart:r,inclusiveEnd:n}=t;return r==null&&(r=t.inclusive),n==null&&(n=t.inclusive),{start:r??e,end:n??e}}function nSe(t,e){return t==e||!!(t&&e&&t.compare(e))}function Qx(t,e,r,n=0){let s=r.length-1;s>=0&&r[s]+n>=t?r[s]=Math.max(r[s],e):r.push(t,e)}class fr extends jt{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,r,n,s,i,o){if(n){if(!(n instanceof fr))return!1;this.dom||n.transferDOM(this)}return s&&this.setDeco(n?n.attrs:null),uH(this,e,r,n?n.children.slice():[],i,o),!0}split(e){let r=new fr;if(r.breakAfter=this.breakAfter,this.length==0)return r;let{i:n,off:s}=this.childPos(e);s&&(r.append(this.children[n].split(s),0),this.children[n].merge(s,this.children[n].length,null,!1,0,0),n++);for(let i=n;i<this.children.length;i++)r.append(this.children[i],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,r}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){k_(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,r){pH(this,e,r)}addLineDeco(e){let r=e.spec.attributes,n=e.spec.class;r&&(this.attrs=Zx(r,this.attrs||{})),n&&(this.attrs=Zx({class:n},this.attrs||{}))}domAtPos(e){return fH(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,r){var n;this.dom?this.flags&4&&(sH(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(Jx(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,r);let s=this.dom.lastChild;for(;s&&jt.get(s)instanceof Co;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((n=jt.get(s))===null||n===void 0?void 0:n.isEditable)==!1&&(!Ve.ios||!this.children.some(i=>i instanceof zs))){let i=document.createElement("BR");i.cmIgnore=!0,this.dom.appendChild(i)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,r;for(let n of this.children){if(!(n instanceof zs)||/[^ -~]/.test(n.text))return null;let s=If(n.dom);if(s.length!=1)return null;e+=s[0].width,r=s[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:r}:null}coordsAt(e,r){let n=mH(this,e,r);if(!this.children.length&&n&&this.parent){let{heightOracle:s}=this.parent.view.viewState,i=n.bottom-n.top;if(Math.abs(i-s.lineHeight)<2&&s.textHeight<i){let o=(i-s.textHeight)/2;return{top:n.top+o,bottom:n.bottom-o,left:n.left,right:n.left}}}return n}become(e){return e instanceof fr&&this.children.length==0&&e.children.length==0&&k_(this.attrs,e.attrs)&&this.breakAfter==e.breakAfter}covers(){return!0}static find(e,r){for(let n=0,s=0;n<e.children.length;n++){let i=e.children[n],o=s+i.length;if(o>=r){if(i instanceof fr)return i;if(o>r)break}s=o+i.breakAfter}return null}}class yo extends jt{constructor(e,r,n){super(),this.widget=e,this.length=r,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,r,n,s,i,o){return n&&(!(n instanceof yo)||!this.widget.compare(n.widget)||e>0&&i<=0||r<this.length&&o<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-r),!0)}domAtPos(e){return e==0?Xr.before(this.dom):Xr.after(this.dom,e==this.length)}split(e){let r=this.length-e;this.length=e;let n=new yo(this.widget,r,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return Uk}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):It.empty}domBoundsAround(){return null}become(e){return e instanceof yo&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,r){let n=this.widget.coordsAt(this.dom,e,r);return n||(this.widget instanceof eS?null:Ab(this.dom.getBoundingClientRect(),this.length?e==0:r<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:r,endSide:n}=this.deco;return r==n?!1:e<0?r<0:n>0}}class eS extends dh{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class Md{constructor(e,r,n,s){this.doc=e,this.pos=r,this.end=n,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=r}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof yo&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new fr),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(ng(new Lu(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof yo)&&this.getLine()}buildText(e,r,n){for(;e>0;){if(this.textOff==this.text.length){let{value:i,lineBreak:o,done:a}=this.cursor.next(this.skip);if(this.skip=0,a)throw new Error("Ran out of text content when drawing inline views");if(o){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=i,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(r.slice(r.length-n)),this.getLine().append(ng(new zs(this.text.slice(this.textOff,this.textOff+s)),r),n),this.atCursorPos=!0,this.textOff+=s,e-=s,n=0}}span(e,r,n,s){this.buildText(r-e,n,s),this.pos=r,this.openStart<0&&(this.openStart=s)}point(e,r,n,s,i,o){if(this.disallowBlockEffectsFor[o]&&n instanceof La){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(r>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let a=r-e;if(n instanceof La)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new yo(n.widget||Nu.block,a,n));else{let l=ml.create(n.widget||Nu.inline,a,a?0:n.startSide),c=this.atCursorPos&&!l.isEditable&&i<=s.length&&(e<r||n.startSide>0),u=!l.isEditable&&(e<r||i>s.length||n.startSide<=0),h=this.getLine();this.pendingBuffer==2&&!c&&!l.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),c&&(h.append(ng(new Lu(1),s),i),i=s.length+Math.max(0,i-s.length)),h.append(ng(l,s),i),this.atCursorPos=u,this.pendingBuffer=u?e<r||i>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);a&&(this.textOff+a<=this.text.length?this.textOff+=a:(this.skip+=a-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=r),this.openStart<0&&(this.openStart=i)}static build(e,r,n,s,i){let o=new Md(e,r,n,i);return o.openEnd=Tt.spans(s,r,n,o),o.openStart<0&&(o.openStart=o.openEnd),o.finish(o.openEnd),o}}function ng(t,e){for(let r of e)t=new Co(r,[t],t.length);return t}class Nu extends dh{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}Nu.inline=new Nu("span");Nu.block=new Nu("div");var Zt=function(t){return t[t.LTR=0]="LTR",t[t.RTL=1]="RTL",t}(Zt||(Zt={}));const Kl=Zt.LTR,$k=Zt.RTL;function _H(t){let e=[];for(let r=0;r<t.length;r++)e.push(1<<+t[r]);return e}const sSe=_H("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),iSe=_H("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),tS=Object.create(null),ri=[];for(let t of["()","[]","{}"]){let e=t.charCodeAt(0),r=t.charCodeAt(1);tS[e]=r,tS[r]=-e}function yH(t){return t<=247?sSe[t]:1424<=t&&t<=1524?2:1536<=t&&t<=1785?iSe[t-1536]:1774<=t&&t<=2220?4:8192<=t&&t<=8204?256:64336<=t&&t<=65023?4:1}const oSe=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class ha{get dir(){return this.level%2?$k:Kl}constructor(e,r,n){this.from=e,this.to=r,this.level=n}side(e,r){return this.dir==r==e?this.to:this.from}forward(e,r){return e==(this.dir==r)}static find(e,r,n,s){let i=-1;for(let o=0;o<e.length;o++){let a=e[o];if(a.from<=r&&a.to>=r){if(a.level==n)return o;(i<0||(s!=0?s<0?a.from<r:a.to>r:e[i].level>a.level))&&(i=o)}}if(i<0)throw new RangeError("Index out of range");return i}}function bH(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++){let n=t[r],s=e[r];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!bH(n.inner,s.inner))return!1}return!0}const Ft=[];function aSe(t,e,r,n,s){for(let i=0;i<=n.length;i++){let o=i?n[i-1].to:e,a=i<n.length?n[i].from:r,l=i?256:s;for(let c=o,u=l,h=l;c<a;c++){let d=yH(t.charCodeAt(c));d==512?d=u:d==8&&h==4&&(d=16),Ft[c]=d==4?2:d,d&7&&(h=d),u=d}for(let c=o,u=l,h=l;c<a;c++){let d=Ft[c];if(d==128)c<a-1&&u==Ft[c+1]&&u&24?d=Ft[c]=u:Ft[c]=256;else if(d==64){let f=c+1;for(;f<a&&Ft[f]==64;)f++;let g=c&&u==8||f<r&&Ft[f]==8?h==1?1:8:256;for(let _=c;_<f;_++)Ft[_]=g;c=f-1}else d==8&&h==1&&(Ft[c]=1);u=d,d&7&&(h=d)}}}function lSe(t,e,r,n,s){let i=s==1?2:1;for(let o=0,a=0,l=0;o<=n.length;o++){let c=o?n[o-1].to:e,u=o<n.length?n[o].from:r;for(let h=c,d,f,g;h<u;h++)if(f=tS[d=t.charCodeAt(h)])if(f<0){for(let _=a-3;_>=0;_-=3)if(ri[_+1]==-f){let m=ri[_+2],p=m&2?s:m&4?m&1?i:s:0;p&&(Ft[h]=Ft[ri[_]]=p),a=_;break}}else{if(ri.length==189)break;ri[a++]=h,ri[a++]=d,ri[a++]=l}else if((g=Ft[h])==2||g==1){let _=g==s;l=_?0:1;for(let m=a-3;m>=0;m-=3){let p=ri[m+2];if(p&2)break;if(_)ri[m+2]|=2;else{if(p&4)break;ri[m+2]|=4}}}}}function cSe(t,e,r,n){for(let s=0,i=n;s<=r.length;s++){let o=s?r[s-1].to:t,a=s<r.length?r[s].from:e;for(let l=o;l<a;){let c=Ft[l];if(c==256){let u=l+1;for(;;)if(u==a){if(s==r.length)break;u=r[s++].to,a=s<r.length?r[s].from:e}else if(Ft[u]==256)u++;else break;let h=i==1,d=(u<e?Ft[u]:n)==1,f=h==d?h?1:2:n;for(let g=u,_=s,m=_?r[_-1].to:t;g>l;)g==m&&(g=r[--_].from,m=_?r[_-1].to:t),Ft[--g]=f;l=u}else i=c,l++}}}function rS(t,e,r,n,s,i,o){let a=n%2?2:1;if(n%2==s%2)for(let l=e,c=0;l<r;){let u=!0,h=!1;if(c==i.length||l<i[c].from){let _=Ft[l];_!=a&&(u=!1,h=_==16)}let d=!u&&a==1?[]:null,f=u?n:n+1,g=l;e:for(;;)if(c<i.length&&g==i[c].from){if(h)break e;let _=i[c];if(!u)for(let m=_.to,p=c+1;;){if(m==r)break e;if(p<i.length&&i[p].from==m)m=i[p++].to;else{if(Ft[m]==a)break e;break}}if(c++,d)d.push(_);else{_.from>l&&o.push(new ha(l,_.from,f));let m=_.direction==Kl!=!(f%2);nS(t,m?n+1:n,s,_.inner,_.from,_.to,o),l=_.to}g=_.to}else{if(g==r||(u?Ft[g]!=a:Ft[g]==a))break;g++}d?rS(t,l,g,n+1,s,d,o):l<g&&o.push(new ha(l,g,f)),l=g}else for(let l=r,c=i.length;l>e;){let u=!0,h=!1;if(!c||l>i[c-1].to){let _=Ft[l-1];_!=a&&(u=!1,h=_==16)}let d=!u&&a==1?[]:null,f=u?n:n+1,g=l;e:for(;;)if(c&&g==i[c-1].to){if(h)break e;let _=i[--c];if(!u)for(let m=_.from,p=c;;){if(m==e)break e;if(p&&i[p-1].to==m)m=i[--p].from;else{if(Ft[m-1]==a)break e;break}}if(d)d.push(_);else{_.to<l&&o.push(new ha(_.to,l,f));let m=_.direction==Kl!=!(f%2);nS(t,m?n+1:n,s,_.inner,_.from,_.to,o),l=_.from}g=_.from}else{if(g==e||(u?Ft[g-1]!=a:Ft[g-1]==a))break;g--}d?rS(t,g,l,n+1,s,d,o):g<l&&o.push(new ha(g,l,f)),l=g}}function nS(t,e,r,n,s,i,o){let a=e%2?2:1;aSe(t,s,i,n,a),lSe(t,s,i,n,a),cSe(s,i,n,a),rS(t,s,i,e,r,n,o)}function uSe(t,e,r){if(!t)return[new ha(0,0,e==$k?1:0)];if(e==Kl&&!r.length&&!oSe.test(t))return vH(t.length);if(r.length)for(;t.length>Ft.length;)Ft[Ft.length]=256;let n=[],s=e==Kl?0:1;return nS(t,s,s,r,0,t.length,n),n}function vH(t){return[new ha(0,t,0)]}let wH="";function hSe(t,e,r,n,s){var i;let o=n.head-t.from,a=ha.find(e,o,(i=n.bidiLevel)!==null&&i!==void 0?i:-1,n.assoc),l=e[a],c=l.side(s,r);if(o==c){let d=a+=s?1:-1;if(d<0||d>=e.length)return null;l=e[a=d],o=l.side(!s,r),c=l.side(s,r)}let u=jr(t.text,o,l.forward(s,r));(u<l.from||u>l.to)&&(u=c),wH=t.text.slice(Math.min(o,u),Math.max(o,u));let h=a==(s?e.length-1:0)?null:e[a+(s?1:-1)];return h&&u==c&&h.level+(s?0:1)<l.level?Re.cursor(h.side(!s,r)+t.from,h.forward(s,r)?1:-1,h.level):Re.cursor(u+t.from,l.forward(s,r)?-1:1,l.level)}function dSe(t,e,r){for(let n=e;n<r;n++){let s=yH(t.charCodeAt(n));if(s==1)return Kl;if(s==2||s==4)return $k}return Kl}const EH=We.define(),xH=We.define(),SH=We.define(),TH=We.define(),sS=We.define(),CH=We.define(),kH=We.define(),Hk=We.define(),zk=We.define(),AH=We.define({combine:t=>t.some(e=>e)}),RH=We.define({combine:t=>t.some(e=>e)}),IH=We.define();class lu{constructor(e,r="nearest",n="nearest",s=5,i=5,o=!1){this.range=e,this.y=r,this.x=n,this.yMargin=s,this.xMargin=i,this.isSnapshot=o}map(e){return e.empty?this:new lu(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new lu(Re.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const sg=ht.define({map:(t,e)=>t.map(e)}),PH=ht.define();function Wn(t,e,r){let n=t.facet(TH);n.length?n[0](e):window.onerror?window.onerror(String(e),r,void 0,void 0,e):r?console.error(r+":",e):console.error(e)}const ra=We.define({combine:t=>t.length?t[0]:!0});let fSe=0;const sd=We.define();class Hr{constructor(e,r,n,s,i){this.id=e,this.create=r,this.domEventHandlers=n,this.domEventObservers=s,this.extension=i(this)}static define(e,r){const{eventHandlers:n,eventObservers:s,provide:i,decorations:o}=r||{};return new Hr(fSe++,e,n,s,a=>{let l=[sd.of(a)];return o&&l.push(Pf.of(c=>{let u=c.plugin(a);return u?o(u):yt.none})),i&&l.push(i(a)),l})}static fromClass(e,r){return Hr.define(n=>new e(n),r)}}class Aw{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let r=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(r)}catch(n){if(Wn(r.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(r){Wn(e.state,r,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var r;if(!((r=this.value)===null||r===void 0)&&r.destroy)try{this.value.destroy()}catch(n){Wn(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const OH=We.define(),Ib=We.define(),Pf=We.define(),DH=We.define(),Vk=We.define(),LH=We.define();function rD(t,e){let r=t.state.facet(LH);if(!r.length)return r;let n=r.map(i=>i instanceof Function?i(t):i),s=[];return Tt.spans(n,e.from,e.to,{point(){},span(i,o,a,l){let c=i-e.from,u=o-e.from,h=s;for(let d=a.length-1;d>=0;d--,l--){let f=a[d].spec.bidiIsolate,g;if(f==null&&(f=dSe(e.text,c,u)),l>0&&h.length&&(g=h[h.length-1]).to==c&&g.direction==f)g.to=u,h=g.inner;else{let _={from:c,to:u,direction:f,inner:[]};h.push(_),h=_.inner}}}}),s}const NH=We.define();function Gk(t){let e=0,r=0,n=0,s=0;for(let i of t.state.facet(NH)){let o=i(t);o&&(o.left!=null&&(e=Math.max(e,o.left)),o.right!=null&&(r=Math.max(r,o.right)),o.top!=null&&(n=Math.max(n,o.top)),o.bottom!=null&&(s=Math.max(s,o.bottom)))}return{left:e,right:r,top:n,bottom:s}}const id=We.define();class bs{constructor(e,r,n,s){this.fromA=e,this.toA=r,this.fromB=n,this.toB=s}join(e){return new bs(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let r=e.length,n=this;for(;r>0;r--){let s=e[r-1];if(!(s.fromA>n.toA)){if(s.toA<n.fromA)break;n=n.join(s),e.splice(r-1,1)}}return e.splice(r,0,n),e}static extendWithRanges(e,r){if(r.length==0)return e;let n=[];for(let s=0,i=0,o=0,a=0;;s++){let l=s==e.length?null:e[s],c=o-a,u=l?l.fromB:1e9;for(;i<r.length&&r[i]<u;){let h=r[i],d=r[i+1],f=Math.max(a,h),g=Math.min(u,d);if(f<=g&&new bs(f+c,g+c,f,g).addToSet(n),d>u)break;i+=2}if(!l)return n;new bs(l.fromA,l.toA,l.fromB,l.toB).addToSet(n),o=l.toA,a=l.toB}}}class A_{constructor(e,r,n){this.view=e,this.state=r,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=_r.empty(this.startState.doc.length);for(let i of n)this.changes=this.changes.compose(i.changes);let s=[];this.changes.iterChangedRanges((i,o,a,l)=>s.push(new bs(i,o,a,l))),this.changedRanges=s}static create(e,r,n){return new A_(e,r,n)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class nD extends jt{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=yt.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new fr],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new bs(0,0,0,e.state.doc.length)],0,null)}update(e){var r;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:c,toA:u})=>u<this.minWidthFrom||c>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(e);let s=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((r=this.domChanged)===null||r===void 0)&&r.newSel?s=this.domChanged.newSel.head:!vSe(e.changes,this.hasComposition)&&!e.selectionSet&&(s=e.state.selection.main.head));let i=s>-1?mSe(this.view,e.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:c,to:u}=this.hasComposition;n=new bs(c,u,e.changes.mapPos(c,-1),e.changes.mapPos(u,1)).addToSet(n.slice())}this.hasComposition=i?{from:i.range.fromB,to:i.range.toB}:null,(Ve.ie||Ve.chrome)&&!i&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let o=this.decorations,a=this.updateDeco(),l=ySe(o,a,e.changes);return n=bs.extendWithRanges(n,l),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,i),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,r,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,r,n);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let o=Ve.chrome||Ve.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,o),this.flags&=-8,o&&(o.written||s.selectionRange.focusNode!=o.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(o=>o.flags&=-9);let i=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let o of this.children)o instanceof yo&&o.widget instanceof eS&&i.push(o.dom);s.updateGaps(i)}updateChildren(e,r,n){let s=n?n.range.addToSet(e.slice()):e,i=this.childCursor(r);for(let o=s.length-1;;o--){let a=o>=0?s[o]:null;if(!a)break;let{fromA:l,toA:c,fromB:u,toB:h}=a,d,f,g,_;if(n&&n.range.fromB<h&&n.range.toB>u){let v=Md.build(this.view.state.doc,u,n.range.fromB,this.decorations,this.dynamicDecorationMap),w=Md.build(this.view.state.doc,n.range.toB,h,this.decorations,this.dynamicDecorationMap);f=v.breakAtStart,g=v.openStart,_=w.openEnd;let E=this.compositionView(n);w.breakAtStart?E.breakAfter=1:w.content.length&&E.merge(E.length,E.length,w.content[0],!1,w.openStart,0)&&(E.breakAfter=w.content[0].breakAfter,w.content.shift()),v.content.length&&E.merge(0,0,v.content[v.content.length-1],!0,0,v.openEnd)&&v.content.pop(),d=v.content.concat(E).concat(w.content)}else({content:d,breakAtStart:f,openStart:g,openEnd:_}=Md.build(this.view.state.doc,u,h,this.decorations,this.dynamicDecorationMap));let{i:m,off:p}=i.findPos(c,1),{i:y,off:b}=i.findPos(l,-1);cH(this,y,b,m,p,d,f,g,_)}n&&this.fixCompositionDOM(n)}updateEditContextFormatting(e){this.editContextFormatting=this.editContextFormatting.map(e.changes);for(let r of e.transactions)for(let n of r.effects)n.is(PH)&&(this.editContextFormatting=n.value)}compositionView(e){let r=new zs(e.text.nodeValue);r.flags|=8;for(let{deco:s}of e.marks)r=new Co(s,[r],r.length);let n=new fr;return n.append(r,0),n}fixCompositionDOM(e){let r=(i,o)=>{o.flags|=8|(o.children.some(l=>l.flags&7)?1:0),this.markedForComposition.add(o);let a=jt.get(i);a&&a!=o&&(a.dom=null),o.setDOM(i)},n=this.childPos(e.range.fromB,1),s=this.children[n.i];r(e.line,s);for(let i=e.marks.length-1;i>=-1;i--)n=s.childPos(n.off,1),s=s.children[n.i],r(i>=0?e.marks[i].node:e.text,s)}updateSelection(e=!1,r=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,s=n==this.dom,i=!s&&i0(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(s||r||i))return;let o=this.forceSelection;this.forceSelection=!1;let a=this.view.state.selection.main,l=this.moveToLine(this.domAtPos(a.anchor)),c=a.empty?l:this.moveToLine(this.domAtPos(a.head));if(Ve.gecko&&a.empty&&!this.hasComposition&&pSe(l)){let h=document.createTextNode("");this.view.observer.ignore(()=>l.node.insertBefore(h,l.node.childNodes[l.offset]||null)),l=c=new Xr(h,0),o=!0}let u=this.view.observer.selectionRange;(o||!u.focusNode||(!Nd(l.node,l.offset,u.anchorNode,u.anchorOffset)||!Nd(c.node,c.offset,u.focusNode,u.focusOffset))&&!this.suppressWidgetCursorChange(u,a))&&(this.view.observer.ignore(()=>{Ve.android&&Ve.chrome&&this.dom.contains(u.focusNode)&&bSe(u.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let h=Rf(this.view.root);if(h)if(a.empty){if(Ve.gecko){let d=gSe(l.node,l.offset);if(d&&d!=3){let f=(d==1?oH:aH)(l.node,l.offset);f&&(l=new Xr(f.node,f.offset))}}h.collapse(l.node,l.offset),a.bidiLevel!=null&&h.caretBidiLevel!==void 0&&(h.caretBidiLevel=a.bidiLevel)}else if(h.extend){h.collapse(l.node,l.offset);try{h.extend(c.node,c.offset)}catch{}}else{let d=document.createRange();a.anchor>a.head&&([l,c]=[c,l]),d.setEnd(c.node,c.offset),d.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(d)}i&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(l,c)),this.impreciseAnchor=l.precise?null:new Xr(u.anchorNode,u.anchorOffset),this.impreciseHead=c.precise?null:new Xr(u.focusNode,u.focusOffset)}suppressWidgetCursorChange(e,r){return this.hasComposition&&r.empty&&Nd(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==r.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,r=e.state.selection.main,n=Rf(e.root),{anchorNode:s,anchorOffset:i}=e.observer.selectionRange;if(!n||!r.empty||!r.assoc||!n.modify)return;let o=fr.find(this,r.head);if(!o)return;let a=o.posAtStart;if(r.head==a||r.head==a+o.length)return;let l=this.coordsAt(r.head,-1),c=this.coordsAt(r.head,1);if(!l||!c||l.bottom>c.top)return;let u=this.domAtPos(r.head+r.assoc);n.collapse(u.node,u.offset),n.modify("move",r.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let h=e.observer.selectionRange;e.docView.posFromDOM(h.anchorNode,h.anchorOffset)!=r.from&&n.collapse(s,i)}moveToLine(e){let r=this.dom,n;if(e.node!=r)return e;for(let s=e.offset;!n&&s<r.childNodes.length;s++){let i=jt.get(r.childNodes[s]);i instanceof fr&&(n=i.domAtPos(0))}for(let s=e.offset-1;!n&&s>=0;s--){let i=jt.get(r.childNodes[s]);i instanceof fr&&(n=i.domAtPos(i.length))}return n?new Xr(n.node,n.offset,!0):e}nearest(e){for(let r=e;r;){let n=jt.get(r);if(n&&n.rootView==this)return n;r=r.parentNode}return null}posFromDOM(e,r){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,r)+n.posAtStart}domAtPos(e){let{i:r,off:n}=this.childCursor().findPos(e,-1);for(;r<this.children.length-1;){let s=this.children[r];if(n<s.length||s instanceof fr)break;r++,n=0}return this.children[r].domAtPos(n)}coordsAt(e,r){let n=null,s=0;for(let i=this.length,o=this.children.length-1;o>=0;o--){let a=this.children[o],l=i-a.breakAfter,c=l-a.length;if(l<e)break;if(c<=e&&(c<e||a.covers(-1))&&(l>e||a.covers(1))&&(!n||a instanceof fr&&!(n instanceof fr&&r>=0)))n=a,s=c;else if(n&&c==e&&l==e&&a instanceof yo&&Math.abs(r)<2){if(a.deco.startSide<0)break;o&&(n=null)}i=c}return n?n.coordsAt(e-s,r):null}coordsForChar(e){let{i:r,off:n}=this.childPos(e,1),s=this.children[r];if(!(s instanceof fr))return null;for(;s.children.length;){let{i:a,off:l}=s.childPos(n,1);for(;;a++){if(a==s.children.length)return null;if((s=s.children[a]).length)break}n=l}if(!(s instanceof zs))return null;let i=jr(s.text,n);if(i==n)return null;let o=ql(s.dom,n,i).getClientRects();for(let a=0;a<o.length;a++){let l=o[a];if(a==o.length-1||l.top<l.bottom&&l.left<l.right)return l}return null}measureVisibleLineHeights(e){let r=[],{from:n,to:s}=e,i=this.view.contentDOM.clientWidth,o=i>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,a=-1,l=this.view.textDirection==Zt.LTR;for(let c=0,u=0;u<this.children.length;u++){let h=this.children[u],d=c+h.length;if(d>s)break;if(c>=n){let f=h.dom.getBoundingClientRect();if(r.push(f.height),o){let g=h.dom.lastChild,_=g?If(g):[];if(_.length){let m=_[_.length-1],p=l?m.right-f.left:f.right-m.left;p>a&&(a=p,this.minWidth=i,this.minWidthFrom=c,this.minWidthTo=d)}}}c=d+h.breakAfter}return r}textDirectionAt(e){let{i:r}=this.childPos(e,1);return getComputedStyle(this.children[r].dom).direction=="rtl"?Zt.RTL:Zt.LTR}measureTextSize(){for(let i of this.children)if(i instanceof fr){let o=i.measureTextSize();if(o)return o}let e=document.createElement("div"),r,n,s;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let i=If(e.firstChild)[0];r=e.getBoundingClientRect().height,n=i?i.width/27:7,s=i?i.height:r,e.remove()}),{lineHeight:r,charWidth:n,textHeight:s}}childCursor(e=this.length){let r=this.children.length;return r&&(e-=this.children[--r].length),new lH(this.children,e,r)}computeBlockGapDeco(){let e=[],r=this.view.viewState;for(let n=0,s=0;;s++){let i=s==r.viewports.length?null:r.viewports[s],o=i?i.from-1:this.length;if(o>n){let a=(r.lineBlockAt(o).bottom-r.lineBlockAt(n).top)/this.view.scaleY;e.push(yt.replace({widget:new eS(a),block:!0,inclusive:!0,isBlockGap:!0}).range(n,o))}if(!i)break;n=i.to+1}return yt.set(e)}updateDeco(){let e=1,r=this.view.state.facet(Pf).map(i=>(this.dynamicDecorationMap[e++]=typeof i=="function")?i(this.view):i),n=!1,s=this.view.state.facet(DH).map((i,o)=>{let a=typeof i=="function";return a&&(n=!0),a?i(this.view):i});for(s.length&&(this.dynamicDecorationMap[e++]=n,r.push(Tt.join(s))),this.decorations=[this.editContextFormatting,...r,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];e<this.decorations.length;)this.dynamicDecorationMap[e++]=!1;return this.decorations}scrollIntoView(e){if(e.isSnapshot){let c=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=c.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}for(let c of this.view.state.facet(IH))try{if(c(this.view,e.range,e))return!0}catch(u){Wn(this.view.state,u,"scroll handler")}let{range:r}=e,n=this.coordsAt(r.head,r.empty?r.assoc:r.head>r.anchor?-1:1),s;if(!n)return;!r.empty&&(s=this.coordsAt(r.anchor,r.anchor>r.head?-1:1))&&(n={left:Math.min(n.left,s.left),top:Math.min(n.top,s.top),right:Math.max(n.right,s.right),bottom:Math.max(n.bottom,s.bottom)});let i=Gk(this.view),o={left:n.left-i.left,top:n.top-i.top,right:n.right+i.right,bottom:n.bottom+i.bottom},{offsetWidth:a,offsetHeight:l}=this.view.scrollDOM;Kxe(this.view.scrollDOM,o,r.head<r.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,a),-a),Math.max(Math.min(e.yMargin,l),-l),this.view.textDirection==Zt.LTR)}}function pSe(t){return t.node.nodeType==1&&t.node.firstChild&&(t.offset==0||t.node.childNodes[t.offset-1].contentEditable=="false")&&(t.offset==t.node.childNodes.length||t.node.childNodes[t.offset].contentEditable=="false")}function MH(t,e){let r=t.observer.selectionRange;if(!r.focusNode)return null;let n=oH(r.focusNode,r.focusOffset),s=aH(r.focusNode,r.focusOffset),i=n||s;if(s&&n&&s.node!=n.node){let a=jt.get(s.node);if(!a||a instanceof zs&&a.text!=s.node.nodeValue)i=s;else if(t.docView.lastCompositionAfterCursor){let l=jt.get(n.node);!l||l instanceof zs&&l.text!=n.node.nodeValue||(i=s)}}if(t.docView.lastCompositionAfterCursor=i!=n,!i)return null;let o=e-i.offset;return{from:o,to:o+i.node.nodeValue.length,node:i.node}}function mSe(t,e,r){let n=MH(t,r);if(!n)return null;let{node:s,from:i,to:o}=n,a=s.nodeValue;if(/[\n\r]/.test(a)||t.state.doc.sliceString(n.from,n.to)!=a)return null;let l=e.invertedDesc,c=new bs(l.mapPos(i),l.mapPos(o),i,o),u=[];for(let h=s.parentNode;;h=h.parentNode){let d=jt.get(h);if(d instanceof Co)u.push({node:h,deco:d.mark});else{if(d instanceof fr||h.nodeName=="DIV"&&h.parentNode==t.contentDOM)return{range:c,text:s,marks:u,line:h};if(h!=t.contentDOM)u.push({node:h,deco:new Np({inclusive:!0,attributes:rSe(h),tagName:h.tagName.toLowerCase()})});else return null}}}function gSe(t,e){return t.nodeType!=1?0:(e&&t.childNodes[e-1].contentEditable=="false"?1:0)|(e<t.childNodes.length&&t.childNodes[e].contentEditable=="false"?2:0)}let _Se=class{constructor(){this.changes=[]}compareRange(e,r){Qx(e,r,this.changes)}comparePoint(e,r){Qx(e,r,this.changes)}};function ySe(t,e,r){let n=new _Se;return Tt.compare(t,e,r,n),n.changes}function bSe(t,e){for(let r=t;r&&r!=e;r=r.assignedSlot||r.parentNode)if(r.nodeType==1&&r.contentEditable=="false")return!0;return!1}function vSe(t,e){let r=!1;return e&&t.iterChangedRanges((n,s)=>{n<e.to&&s>e.from&&(r=!0)}),r}function wSe(t,e,r=1){let n=t.charCategorizer(e),s=t.doc.lineAt(e),i=e-s.from;if(s.length==0)return Re.cursor(e);i==0?r=1:i==s.length&&(r=-1);let o=i,a=i;r<0?o=jr(s.text,i,!1):a=jr(s.text,i);let l=n(s.text.slice(o,a));for(;o>0;){let c=jr(s.text,o,!1);if(n(s.text.slice(c,o))!=l)break;o=c}for(;a<s.length;){let c=jr(s.text,a);if(n(s.text.slice(a,c))!=l)break;a=c}return Re.range(o+s.from,a+s.from)}function ESe(t,e){return e.left>t?e.left-t:Math.max(0,t-e.right)}function xSe(t,e){return e.top>t?e.top-t:Math.max(0,t-e.bottom)}function Rw(t,e){return t.top<e.bottom-1&&t.bottom>e.top+1}function sD(t,e){return e<t.top?{top:e,left:t.left,right:t.right,bottom:t.bottom}:t}function iD(t,e){return e>t.bottom?{top:t.top,left:t.left,right:t.right,bottom:e}:t}function iS(t,e,r){let n,s,i,o,a=!1,l,c,u,h;for(let g=t.firstChild;g;g=g.nextSibling){let _=If(g);for(let m=0;m<_.length;m++){let p=_[m];s&&Rw(s,p)&&(p=sD(iD(p,s.bottom),s.top));let y=ESe(e,p),b=xSe(r,p);if(y==0&&b==0)return g.nodeType==3?oD(g,e,r):iS(g,e,r);if(!n||o>b||o==b&&i>y){n=g,s=p,i=y,o=b;let v=b?r<p.top?-1:1:y?e<p.left?-1:1:0;a=!v||(v>0?m<_.length-1:m>0)}y==0?r>p.bottom&&(!u||u.bottom<p.bottom)?(l=g,u=p):r<p.top&&(!h||h.top>p.top)&&(c=g,h=p):u&&Rw(u,p)?u=iD(u,p.bottom):h&&Rw(h,p)&&(h=sD(h,p.top))}}if(u&&u.bottom>=r?(n=l,s=u):h&&h.top<=r&&(n=c,s=h),!n)return{node:t,offset:0};let d=Math.max(s.left,Math.min(s.right,e));if(n.nodeType==3)return oD(n,d,r);if(a&&n.contentEditable!="false")return iS(n,d,r);let f=Array.prototype.indexOf.call(t.childNodes,n)+(e>=(s.left+s.right)/2?1:0);return{node:t,offset:f}}function oD(t,e,r){let n=t.nodeValue.length,s=-1,i=1e9,o=0;for(let a=0;a<n;a++){let l=ql(t,a,a+1).getClientRects();for(let c=0;c<l.length;c++){let u=l[c];if(u.top==u.bottom)continue;o||(o=e-u.left);let h=(u.top>r?u.top-r:r-u.bottom)-1;if(u.left-1<=e&&u.right+1>=e&&h<i){let d=e>=(u.left+u.right)/2,f=d;if((Ve.chrome||Ve.gecko)&&ql(t,a).getBoundingClientRect().left==u.right&&(f=!d),h<=0)return{node:t,offset:a+(f?1:0)};s=a+(f?1:0),i=h}}}return{node:t,offset:s>-1?s:o>0?t.nodeValue.length:0}}function BH(t,e,r,n=-1){var s,i;let o=t.contentDOM.getBoundingClientRect(),a=o.top+t.viewState.paddingTop,l,{docHeight:c}=t.viewState,{x:u,y:h}=e,d=h-a;if(d<0)return 0;if(d>c)return t.state.doc.length;for(let v=t.viewState.heightOracle.textHeight/2,w=!1;l=t.elementAtHeight(d),l.type!=pn.Text;)for(;d=n>0?l.bottom+v:l.top-v,!(d>=0&&d<=c);){if(w)return r?null:0;w=!0,n=-n}h=a+d;let f=l.from;if(f<t.viewport.from)return t.viewport.from==0?0:r?null:aD(t,o,l,u,h);if(f>t.viewport.to)return t.viewport.to==t.state.doc.length?t.state.doc.length:r?null:aD(t,o,l,u,h);let g=t.dom.ownerDocument,_=t.root.elementFromPoint?t.root:g,m=_.elementFromPoint(u,h);m&&!t.contentDOM.contains(m)&&(m=null),m||(u=Math.max(o.left+1,Math.min(o.right-1,u)),m=_.elementFromPoint(u,h),m&&!t.contentDOM.contains(m)&&(m=null));let p,y=-1;if(m&&((s=t.docView.nearest(m))===null||s===void 0?void 0:s.isEditable)!=!1){if(g.caretPositionFromPoint){let v=g.caretPositionFromPoint(u,h);v&&({offsetNode:p,offset:y}=v)}else if(g.caretRangeFromPoint){let v=g.caretRangeFromPoint(u,h);v&&({startContainer:p,startOffset:y}=v,(!t.contentDOM.contains(p)||Ve.safari&&SSe(p,y,u)||Ve.chrome&&TSe(p,y,u))&&(p=void 0))}p&&(y=Math.min($i(p),y))}if(!p||!t.docView.dom.contains(p)){let v=fr.find(t.docView,f);if(!v)return d>l.top+l.height/2?l.to:l.from;({node:p,offset:y}=iS(v.dom,u,h))}let b=t.docView.nearest(p);if(!b)return null;if(b.isWidget&&((i=b.dom)===null||i===void 0?void 0:i.nodeType)==1){let v=b.dom.getBoundingClientRect();return e.y<v.top||e.y<=v.bottom&&e.x<=(v.left+v.right)/2?b.posAtStart:b.posAtEnd}else return b.localPosFromDOM(p,y)+b.posAtStart}function aD(t,e,r,n,s){let i=Math.round((n-e.left)*t.defaultCharacterWidth);if(t.lineWrapping&&r.height>t.defaultLineHeight*1.5){let a=t.viewState.heightOracle.textHeight,l=Math.floor((s-r.top-(t.defaultLineHeight-a)*.5)/a);i+=l*t.viewState.heightOracle.lineLength}let o=t.state.sliceDoc(r.from,r.to);return r.from+Hxe(o,i,t.state.tabSize)}function SSe(t,e,r){let n;if(t.nodeType!=3||e!=(n=t.nodeValue.length))return!1;for(let s=t.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return ql(t,n-1,n).getBoundingClientRect().left>r}function TSe(t,e,r){if(e!=0)return!1;for(let s=t;;){let i=s.parentNode;if(!i||i.nodeType!=1||i.firstChild!=s)return!1;if(i.classList.contains("cm-line"))break;s=i}let n=t.nodeType==1?t.getBoundingClientRect():ql(t,0,Math.max(t.nodeValue.length,1)).getBoundingClientRect();return r-n.left>5}function oS(t,e){let r=t.lineBlockAt(e);if(Array.isArray(r.type)){for(let n of r.type)if(n.to>e||n.to==e&&(n.to==r.to||n.type==pn.Text))return n}return r}function CSe(t,e,r,n){let s=oS(t,e.head),i=!n||s.type!=pn.Text||!(t.lineWrapping||s.widgetLineBreaks)?null:t.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(i){let o=t.dom.getBoundingClientRect(),a=t.textDirectionAt(s.from),l=t.posAtCoords({x:r==(a==Zt.LTR)?o.right-1:o.left+1,y:(i.top+i.bottom)/2});if(l!=null)return Re.cursor(l,r?-1:1)}return Re.cursor(r?s.to:s.from,r?-1:1)}function lD(t,e,r,n){let s=t.state.doc.lineAt(e.head),i=t.bidiSpans(s),o=t.textDirectionAt(s.from);for(let a=e,l=null;;){let c=hSe(s,i,o,a,r),u=wH;if(!c){if(s.number==(r?t.state.doc.lines:1))return a;u=`
`,s=t.state.doc.line(s.number+(r?1:-1)),i=t.bidiSpans(s),c=t.visualLineSide(s,!r)}if(l){if(!l(u))return a}else{if(!n)return c;l=n(u)}a=c}}function kSe(t,e,r){let n=t.state.charCategorizer(e),s=n(r);return i=>{let o=n(i);return s==mr.Space&&(s=o),s==o}}function ASe(t,e,r,n){let s=e.head,i=r?1:-1;if(s==(r?t.state.doc.length:0))return Re.cursor(s,e.assoc);let o=e.goalColumn,a,l=t.contentDOM.getBoundingClientRect(),c=t.coordsAtPos(s,e.assoc||-1),u=t.documentTop;if(c)o==null&&(o=c.left-l.left),a=i<0?c.top:c.bottom;else{let f=t.viewState.lineBlockAt(s);o==null&&(o=Math.min(l.right-l.left,t.defaultCharacterWidth*(s-f.from))),a=(i<0?f.top:f.bottom)+u}let h=l.left+o,d=n??t.viewState.heightOracle.textHeight>>1;for(let f=0;;f+=10){let g=a+(d+f)*i,_=BH(t,{x:h,y:g},!1,i);if(g<l.top||g>l.bottom||(i<0?_<s:_>s)){let m=t.docView.coordsForChar(_),p=!m||g<m.top?-1:1;return Re.cursor(_,p,void 0,o)}}}function o0(t,e,r){for(;;){let n=0;for(let s of t)s.between(e-1,e+1,(i,o,a)=>{if(e>i&&e<o){let l=n||r||(e-i<o-e?-1:1);e=l<0?i:o,n=l}});if(!n)return e}}function Iw(t,e,r){let n=o0(t.state.facet(Vk).map(s=>s(t)),r.from,e.head>r.from?-1:1);return n==r.from?r:Re.cursor(n,n<r.from?1:-1)}const od="￿";class RSe{constructor(e,r){this.points=e,this.text="",this.lineSeparator=r.facet(vt.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=od}readRange(e,r){if(!e)return this;let n=e.parentNode;for(let s=e;;){this.findPointBefore(n,s);let i=this.text.length;this.readNode(s);let o=s.nextSibling;if(o==r)break;let a=jt.get(s),l=jt.get(o);(a&&l?a.breakAfter:(a?a.breakAfter:C_(s))||C_(o)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>i)&&this.lineBreak(),s=o}return this.findPointBefore(n,r),this}readTextNode(e){let r=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,r.length));for(let n=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let i=-1,o=1,a;if(this.lineSeparator?(i=r.indexOf(this.lineSeparator,n),o=this.lineSeparator.length):(a=s.exec(r))&&(i=a.index,o=a[0].length),this.append(r.slice(n,i<0?r.length:i)),i<0)break;if(this.lineBreak(),o>1)for(let l of this.points)l.node==e&&l.pos>this.text.length&&(l.pos-=o-1);n=i+o}}readNode(e){if(e.cmIgnore)return;let r=jt.get(e),n=r&&r.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let s=n.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,r){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==r&&(n.pos=this.text.length)}findPointInside(e,r){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(ISe(e,n.node,n.offset)?r:0))}}function ISe(t,e,r){for(;;){if(!e||r<$i(e))return!1;if(e==t)return!0;r=Wl(e)+1,e=e.parentNode}}class cD{constructor(e,r){this.node=e,this.offset=r,this.pos=-1}}class PSe{constructor(e,r,n,s){this.typeOver=s,this.bounds=null,this.text="",this.domChanged=r>-1;let{impreciseHead:i,impreciseAnchor:o}=e.docView;if(e.state.readOnly&&r>-1)this.newSel=null;else if(r>-1&&(this.bounds=e.docView.domBoundsAround(r,n,0))){let a=i||o?[]:LSe(e),l=new RSe(a,e.state);l.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=l.text,this.newSel=NSe(a,this.bounds.from)}else{let a=e.observer.selectionRange,l=i&&i.node==a.focusNode&&i.offset==a.focusOffset||!qx(e.contentDOM,a.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(a.focusNode,a.focusOffset),c=o&&o.node==a.anchorNode&&o.offset==a.anchorOffset||!qx(e.contentDOM,a.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(a.anchorNode,a.anchorOffset),u=e.viewport;if((Ve.ios||Ve.chrome)&&e.state.selection.main.empty&&l!=c&&(u.from>0||u.to<e.state.doc.length)){let h=Math.min(l,c),d=Math.max(l,c),f=u.from-h,g=u.to-d;(f==0||f==1||h==0)&&(g==0||g==-1||d==e.state.doc.length)&&(l=0,c=e.state.doc.length)}this.newSel=Re.single(c,l)}}}function FH(t,e){let r,{newSel:n}=e,s=t.state.selection.main,i=t.inputState.lastKeyTime>Date.now()-100?t.inputState.lastKeyCode:-1;if(e.bounds){let{from:o,to:a}=e.bounds,l=s.from,c=null;(i===8||Ve.android&&e.text.length<a-o)&&(l=s.to,c="end");let u=DSe(t.state.doc.sliceString(o,a,od),e.text,l-o,c);u&&(Ve.chrome&&i==13&&u.toB==u.from+2&&e.text.slice(u.from,u.toB)==od+od&&u.toB--,r={from:o+u.from,to:o+u.toA,insert:It.of(e.text.slice(u.from,u.toB).split(od))})}else n&&(!t.hasFocus&&t.state.facet(ra)||n.main.eq(s))&&(n=null);if(!r&&!n)return!1;if(!r&&e.typeOver&&!s.empty&&n&&n.main.empty?r={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,s.to)}:r&&r.from>=s.from&&r.to<=s.to&&(r.from!=s.from||r.to!=s.to)&&s.to-s.from-(r.to-r.from)<=4?r={from:s.from,to:s.to,insert:t.state.doc.slice(s.from,r.from).append(r.insert).append(t.state.doc.slice(r.to,s.to))}:(Ve.mac||Ve.android)&&r&&r.from==r.to&&r.from==s.head-1&&/^\. ?$/.test(r.insert.toString())&&t.contentDOM.getAttribute("autocorrect")=="off"?(n&&r.insert.length==2&&(n=Re.single(n.main.anchor-1,n.main.head-1)),r={from:s.from,to:s.to,insert:It.of([" "])}):Ve.chrome&&r&&r.from==r.to&&r.from==s.head&&r.insert.toString()==`
 `&&t.lineWrapping&&(n&&(n=Re.single(n.main.anchor-1,n.main.head-1)),r={from:s.from,to:s.to,insert:It.of([" "])}),r)return Wk(t,r,n,i);if(n&&!n.main.eq(s)){let o=!1,a="select";return t.inputState.lastSelectionTime>Date.now()-50&&(t.inputState.lastSelectionOrigin=="select"&&(o=!0),a=t.inputState.lastSelectionOrigin),t.dispatch({selection:n,scrollIntoView:o,userEvent:a}),!0}else return!1}function Wk(t,e,r,n=-1){if(Ve.ios&&t.inputState.flushIOSKey(e))return!0;let s=t.state.selection.main;if(Ve.android&&(e.to==s.to&&(e.from==s.from||e.from==s.from-1&&t.state.sliceDoc(e.from,s.from)==" ")&&e.insert.length==1&&e.insert.lines==2&&au(t.contentDOM,"Enter",13)||(e.from==s.from-1&&e.to==s.to&&e.insert.length==0||n==8&&e.insert.length<e.to-e.from&&e.to>s.head)&&au(t.contentDOM,"Backspace",8)||e.from==s.from&&e.to==s.to+1&&e.insert.length==0&&au(t.contentDOM,"Delete",46)))return!0;let i=e.insert.toString();t.inputState.composing>=0&&t.inputState.composing++;let o,a=()=>o||(o=OSe(t,e,r));return t.state.facet(CH).some(l=>l(t,e.from,e.to,i,a))||t.dispatch(a()),!0}function OSe(t,e,r){let n,s=t.state,i=s.selection.main;if(e.from>=i.from&&e.to<=i.to&&e.to-e.from>=(i.to-i.from)/3&&(!r||r.main.empty&&r.main.from==e.from+e.insert.length)&&t.inputState.composing<0){let a=i.from<e.from?s.sliceDoc(i.from,e.from):"",l=i.to>e.to?s.sliceDoc(e.to,i.to):"";n=s.replaceSelection(t.state.toText(a+e.insert.sliceString(0,void 0,t.state.lineBreak)+l))}else{let a=s.changes(e),l=r&&r.main.to<=a.newLength?r.main:void 0;if(s.selection.ranges.length>1&&t.inputState.composing>=0&&e.to<=i.to&&e.to>=i.to-10){let c=t.state.sliceDoc(e.from,e.to),u,h=r&&MH(t,r.main.head);if(h){let g=e.insert.length-(e.to-e.from);u={from:h.from,to:h.to-g}}else u=t.state.doc.lineAt(i.head);let d=i.to-e.to,f=i.to-i.from;n=s.changeByRange(g=>{if(g.from==i.from&&g.to==i.to)return{changes:a,range:l||g.map(a)};let _=g.to-d,m=_-c.length;if(g.to-g.from!=f||t.state.sliceDoc(m,_)!=c||g.to>=u.from&&g.from<=u.to)return{range:g};let p=s.changes({from:m,to:_,insert:e.insert}),y=g.to-i.to;return{changes:p,range:l?Re.range(Math.max(0,l.anchor+y),Math.max(0,l.head+y)):g.map(p)}})}else n={changes:a,selection:l&&s.selection.replaceRange(l)}}let o="input.type";return(t.composing||t.inputState.compositionPendingChange&&t.inputState.compositionEndedAt>Date.now()-50)&&(t.inputState.compositionPendingChange=!1,o+=".compose",t.inputState.compositionFirstChange&&(o+=".start",t.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:o,scrollIntoView:!0})}function DSe(t,e,r,n){let s=Math.min(t.length,e.length),i=0;for(;i<s&&t.charCodeAt(i)==e.charCodeAt(i);)i++;if(i==s&&t.length==e.length)return null;let o=t.length,a=e.length;for(;o>0&&a>0&&t.charCodeAt(o-1)==e.charCodeAt(a-1);)o--,a--;if(n=="end"){let l=Math.max(0,i-Math.min(o,a));r-=o+l-i}if(o<i&&t.length<e.length){let l=r<=i&&r>=o?i-r:0;i-=l,a=i+(a-o),o=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,o=i+(o-a),a=i}return{from:i,toA:o,toB:a}}function LSe(t){let e=[];if(t.root.activeElement!=t.contentDOM)return e;let{anchorNode:r,anchorOffset:n,focusNode:s,focusOffset:i}=t.observer.selectionRange;return r&&(e.push(new cD(r,n)),(s!=r||i!=n)&&e.push(new cD(s,i))),e}function NSe(t,e){if(t.length==0)return null;let r=t[0].pos,n=t.length==2?t[1].pos:r;return r>-1&&n>-1?Re.single(r+e,n+e):null}class MSe{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Ve.safari&&e.contentDOM.addEventListener("input",()=>null),Ve.gecko&&JSe(e.contentDOM.ownerDocument)}handleEvent(e){!VSe(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,r){let n=this.handlers[e];if(n){for(let s of n.observers)s(this.view,r);for(let s of n.handlers){if(r.defaultPrevented)break;if(s(this.view,r)){r.preventDefault();break}}}}ensureHandlers(e){let r=BSe(e),n=this.handlers,s=this.view.contentDOM;for(let i in r)if(i!="scroll"){let o=!r[i].handlers.length,a=n[i];a&&o!=!a.handlers.length&&(s.removeEventListener(i,this.handleEvent),a=null),a||s.addEventListener(i,this.handleEvent,{passive:o})}for(let i in n)i!="scroll"&&!r[i]&&s.removeEventListener(i,this.handleEvent);this.handlers=r}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&e.keyCode!=27&&UH.indexOf(e.keyCode)<0&&(this.tabFocusMode=-1),Ve.android&&Ve.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let r;return Ve.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((r=jH.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||FSe.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=r||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(e){let r=this.pendingIOSKey;return!r||r.key=="Enter"&&e&&e.from<e.to&&/^\S+$/.test(e.insert.toString())?!1:(this.pendingIOSKey=void 0,au(this.view.contentDOM,r.key,r.keyCode,r instanceof KeyboardEvent?r:void 0))}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Ve.safari&&!Ve.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.view.observer.update(e),this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function uD(t,e){return(r,n)=>{try{return e.call(t,n,r)}catch(s){Wn(r.state,s)}}}function BSe(t){let e=Object.create(null);function r(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of t){let s=n.spec;if(s&&s.domEventHandlers)for(let i in s.domEventHandlers){let o=s.domEventHandlers[i];o&&r(i).handlers.push(uD(n.value,o))}if(s&&s.domEventObservers)for(let i in s.domEventObservers){let o=s.domEventObservers[i];o&&r(i).observers.push(uD(n.value,o))}}for(let n in Vs)r(n).handlers.push(Vs[n]);for(let n in Cs)r(n).observers.push(Cs[n]);return e}const jH=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],FSe="dthko",UH=[16,17,18,20,91,92,224,225],ig=6;function og(t){return Math.max(0,t)*.7+8}function jSe(t,e){return Math.max(Math.abs(t.clientX-e.clientX),Math.abs(t.clientY-e.clientY))}class USe{constructor(e,r,n,s){this.view=e,this.startEvent=r,this.style=n,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=r,this.scrollParents=Yxe(e.contentDOM),this.atoms=e.state.facet(Vk).map(o=>o(e));let i=e.contentDOM.ownerDocument;i.addEventListener("mousemove",this.move=this.move.bind(this)),i.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=r.shiftKey,this.multiple=e.state.facet(vt.allowMultipleSelections)&&$Se(e,r),this.dragging=zSe(e,r)&&zH(r)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&jSe(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let r=0,n=0,s=0,i=0,o=this.view.win.innerWidth,a=this.view.win.innerHeight;this.scrollParents.x&&({left:s,right:o}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:i,bottom:a}=this.scrollParents.y.getBoundingClientRect());let l=Gk(this.view);e.clientX-l.left<=s+ig?r=-og(s-e.clientX):e.clientX+l.right>=o-ig&&(r=og(e.clientX-o)),e.clientY-l.top<=i+ig?n=-og(i-e.clientY):e.clientY+l.bottom>=a-ig&&(n=og(e.clientY-a)),this.setScrollSpeed(r,n)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,r){this.scrollSpeed={x:e,y:r},e||r?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:e,y:r}=this.scrollSpeed;e&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=e,e=0),r&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=r,r=0),(e||r)&&this.view.win.scrollBy(e,r),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let r=null;for(let n=0;n<e.ranges.length;n++){let s=e.ranges[n],i=null;if(s.empty){let o=o0(this.atoms,s.from,0);o!=s.from&&(i=Re.cursor(o,-1))}else{let o=o0(this.atoms,s.from,-1),a=o0(this.atoms,s.to,1);(o!=s.from||a!=s.to)&&(i=Re.range(s.from==s.anchor?o:a,s.from==s.head?o:a))}i&&(r||(r=e.ranges.slice()),r[n]=i)}return r?Re.create(r,e.mainIndex):e}select(e){let{view:r}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(r.state.selection,this.dragging===!1))&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){e.transactions.some(r=>r.isUserEvent("input.type"))?this.destroy():this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function $Se(t,e){let r=t.state.facet(EH);return r.length?r[0](e):Ve.mac?e.metaKey:e.ctrlKey}function HSe(t,e){let r=t.state.facet(xH);return r.length?r[0](e):Ve.mac?!e.altKey:!e.ctrlKey}function zSe(t,e){let{main:r}=t.state.selection;if(r.empty)return!1;let n=Rf(t.root);if(!n||n.rangeCount==0)return!0;let s=n.getRangeAt(0).getClientRects();for(let i=0;i<s.length;i++){let o=s[i];if(o.left<=e.clientX&&o.right>=e.clientX&&o.top<=e.clientY&&o.bottom>=e.clientY)return!0}return!1}function VSe(t,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let r=e.target,n;r!=t.contentDOM;r=r.parentNode)if(!r||r.nodeType==11||(n=jt.get(r))&&n.ignoreEvent(e))return!1;return!0}const Vs=Object.create(null),Cs=Object.create(null),$H=Ve.ie&&Ve.ie_version<15||Ve.ios&&Ve.webkit_version<604;function GSe(t){let e=t.dom.parentNode;if(!e)return;let r=e.appendChild(document.createElement("textarea"));r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout(()=>{t.focus(),r.remove(),HH(t,r.value)},50)}function Pb(t,e,r){for(let n of t.facet(e))r=n(r,t);return r}function HH(t,e){e=Pb(t.state,Hk,e);let{state:r}=t,n,s=1,i=r.toText(e),o=i.lines==r.selection.ranges.length;if(aS!=null&&r.selection.ranges.every(l=>l.empty)&&aS==i.toString()){let l=-1;n=r.changeByRange(c=>{let u=r.doc.lineAt(c.from);if(u.from==l)return{range:c};l=u.from;let h=r.toText((o?i.line(s++).text:e)+r.lineBreak);return{changes:{from:u.from,insert:h},range:Re.cursor(c.from+h.length)}})}else o?n=r.changeByRange(l=>{let c=i.line(s++);return{changes:{from:l.from,to:l.to,insert:c.text},range:Re.cursor(l.from+c.length)}}):n=r.replaceSelection(i);t.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}Cs.scroll=t=>{t.inputState.lastScrollTop=t.scrollDOM.scrollTop,t.inputState.lastScrollLeft=t.scrollDOM.scrollLeft};Vs.keydown=(t,e)=>(t.inputState.setSelectionOrigin("select"),e.keyCode==27&&t.inputState.tabFocusMode!=0&&(t.inputState.tabFocusMode=Date.now()+2e3),!1);Cs.touchstart=(t,e)=>{t.inputState.lastTouchTime=Date.now(),t.inputState.setSelectionOrigin("select.pointer")};Cs.touchmove=t=>{t.inputState.setSelectionOrigin("select.pointer")};Vs.mousedown=(t,e)=>{if(t.observer.flush(),t.inputState.lastTouchTime>Date.now()-2e3)return!1;let r=null;for(let n of t.state.facet(SH))if(r=n(t,e),r)break;if(!r&&e.button==0&&(r=KSe(t,e)),r){let n=!t.hasFocus;t.inputState.startMouseSelection(new USe(t,e,r,n)),n&&t.observer.ignore(()=>{nH(t.contentDOM);let i=t.root.activeElement;i&&!i.contains(t.contentDOM)&&i.blur()});let s=t.inputState.mouseSelection;if(s)return s.start(e),s.dragging===!1}return!1};function hD(t,e,r,n){if(n==1)return Re.cursor(e,r);if(n==2)return wSe(t.state,e,r);{let s=fr.find(t.docView,e),i=t.state.doc.lineAt(s?s.posAtEnd:e),o=s?s.posAtStart:i.from,a=s?s.posAtEnd:i.to;return a<t.state.doc.length&&a==i.to&&a++,Re.range(o,a)}}let dD=(t,e,r)=>e>=r.top&&e<=r.bottom&&t>=r.left&&t<=r.right;function WSe(t,e,r,n){let s=fr.find(t.docView,e);if(!s)return 1;let i=e-s.posAtStart;if(i==0)return 1;if(i==s.length)return-1;let o=s.coordsAt(i,-1);if(o&&dD(r,n,o))return-1;let a=s.coordsAt(i,1);return a&&dD(r,n,a)?1:o&&o.bottom>=n?-1:1}function fD(t,e){let r=t.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:r,bias:WSe(t,r,e.clientX,e.clientY)}}const qSe=Ve.ie&&Ve.ie_version<=11;let pD=null,mD=0,gD=0;function zH(t){if(!qSe)return t.detail;let e=pD,r=gD;return pD=t,gD=Date.now(),mD=!e||r>Date.now()-400&&Math.abs(e.clientX-t.clientX)<2&&Math.abs(e.clientY-t.clientY)<2?(mD+1)%3:1}function KSe(t,e){let r=fD(t,e),n=zH(e),s=t.state.selection;return{update(i){i.docChanged&&(r.pos=i.changes.mapPos(r.pos),s=s.map(i.changes))},get(i,o,a){let l=fD(t,i),c,u=hD(t,l.pos,l.bias,n);if(r.pos!=l.pos&&!o){let h=hD(t,r.pos,r.bias,n),d=Math.min(h.from,u.from),f=Math.max(h.to,u.to);u=d<u.from?Re.range(d,f):Re.range(f,d)}return o?s.replaceRange(s.main.extend(u.from,u.to)):a&&n==1&&s.ranges.length>1&&(c=YSe(s,l.pos))?c:a?s.addRange(u):Re.create([u])}}}function YSe(t,e){for(let r=0;r<t.ranges.length;r++){let{from:n,to:s}=t.ranges[r];if(n<=e&&s>=e)return Re.create(t.ranges.slice(0,r).concat(t.ranges.slice(r+1)),t.mainIndex==r?0:t.mainIndex-(t.mainIndex>r?1:0))}return null}Vs.dragstart=(t,e)=>{let{selection:{main:r}}=t.state;if(e.target.draggable){let s=t.docView.nearest(e.target);if(s&&s.isWidget){let i=s.posAtStart,o=i+s.length;(i>=r.to||o<=r.from)&&(r=Re.range(i,o))}}let{inputState:n}=t;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=r,e.dataTransfer&&(e.dataTransfer.setData("Text",Pb(t.state,zk,t.state.sliceDoc(r.from,r.to))),e.dataTransfer.effectAllowed="copyMove"),!1};Vs.dragend=t=>(t.inputState.draggedContent=null,!1);function _D(t,e,r,n){if(r=Pb(t.state,Hk,r),!r)return;let s=t.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:i}=t.inputState,o=n&&i&&HSe(t,e)?{from:i.from,to:i.to}:null,a={from:s,insert:r},l=t.state.changes(o?[o,a]:a);t.focus(),t.dispatch({changes:l,selection:{anchor:l.mapPos(s,-1),head:l.mapPos(s,1)},userEvent:o?"move.drop":"input.drop"}),t.inputState.draggedContent=null}Vs.drop=(t,e)=>{if(!e.dataTransfer)return!1;if(t.state.readOnly)return!0;let r=e.dataTransfer.files;if(r&&r.length){let n=Array(r.length),s=0,i=()=>{++s==r.length&&_D(t,e,n.filter(o=>o!=null).join(t.state.lineBreak),!1)};for(let o=0;o<r.length;o++){let a=new FileReader;a.onerror=i,a.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(a.result)||(n[o]=a.result),i()},a.readAsText(r[o])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return _D(t,e,n,!0),!0}return!1};Vs.paste=(t,e)=>{if(t.state.readOnly)return!0;t.observer.flush();let r=$H?null:e.clipboardData;return r?(HH(t,r.getData("text/plain")||r.getData("text/uri-list")),!0):(GSe(t),!1)};function XSe(t,e){let r=t.dom.parentNode;if(!r)return;let n=r.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),t.focus()},50)}function ZSe(t){let e=[],r=[],n=!1;for(let s of t.selection.ranges)s.empty||(e.push(t.sliceDoc(s.from,s.to)),r.push(s));if(!e.length){let s=-1;for(let{from:i}of t.selection.ranges){let o=t.doc.lineAt(i);o.number>s&&(e.push(o.text),r.push({from:o.from,to:Math.min(t.doc.length,o.to+1)})),s=o.number}n=!0}return{text:Pb(t,zk,e.join(t.lineBreak)),ranges:r,linewise:n}}let aS=null;Vs.copy=Vs.cut=(t,e)=>{let{text:r,ranges:n,linewise:s}=ZSe(t.state);if(!r&&!s)return!1;aS=s?r:null,e.type=="cut"&&!t.state.readOnly&&t.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let i=$H?null:e.clipboardData;return i?(i.clearData(),i.setData("text/plain",r),!0):(XSe(t,r),!1)};const VH=No.define();function GH(t,e){let r=[];for(let n of t.facet(kH)){let s=n(t,e);s&&r.push(s)}return r?t.update({effects:r,annotations:VH.of(!0)}):null}function WH(t){setTimeout(()=>{let e=t.hasFocus;if(e!=t.inputState.notifiedFocused){let r=GH(t.state,e);r?t.dispatch(r):t.update([])}},10)}Cs.focus=t=>{t.inputState.lastFocusTime=Date.now(),!t.scrollDOM.scrollTop&&(t.inputState.lastScrollTop||t.inputState.lastScrollLeft)&&(t.scrollDOM.scrollTop=t.inputState.lastScrollTop,t.scrollDOM.scrollLeft=t.inputState.lastScrollLeft),WH(t)};Cs.blur=t=>{t.observer.clearSelectionRange(),WH(t)};Cs.compositionstart=Cs.compositionupdate=t=>{t.observer.editContext||(t.inputState.compositionFirstChange==null&&(t.inputState.compositionFirstChange=!0),t.inputState.composing<0&&(t.inputState.composing=0))};Cs.compositionend=t=>{t.observer.editContext||(t.inputState.composing=-1,t.inputState.compositionEndedAt=Date.now(),t.inputState.compositionPendingKey=!0,t.inputState.compositionPendingChange=t.observer.pendingRecords().length>0,t.inputState.compositionFirstChange=null,Ve.chrome&&Ve.android?t.observer.flushSoon():t.inputState.compositionPendingChange?Promise.resolve().then(()=>t.observer.flush()):setTimeout(()=>{t.inputState.composing<0&&t.docView.hasComposition&&t.update([])},50))};Cs.contextmenu=t=>{t.inputState.lastContextMenu=Date.now()};Vs.beforeinput=(t,e)=>{var r,n;if(e.inputType=="insertReplacementText"&&t.observer.editContext){let i=(r=e.dataTransfer)===null||r===void 0?void 0:r.getData("text/plain"),o=e.getTargetRanges();if(i&&o.length){let a=o[0],l=t.posAtDOM(a.startContainer,a.startOffset),c=t.posAtDOM(a.endContainer,a.endOffset);return Wk(t,{from:l,to:c,insert:t.state.toText(i)},null),!0}}let s;if(Ve.chrome&&Ve.android&&(s=jH.find(i=>i.inputType==e.inputType))&&(t.observer.delayAndroidKey(s.key,s.keyCode),s.key=="Backspace"||s.key=="Delete")){let i=((n=window.visualViewport)===null||n===void 0?void 0:n.height)||0;setTimeout(()=>{var o;(((o=window.visualViewport)===null||o===void 0?void 0:o.height)||0)>i+10&&t.hasFocus&&(t.contentDOM.blur(),t.focus())},100)}return Ve.ios&&e.inputType=="deleteContentForward"&&t.observer.flushSoon(),Ve.safari&&e.inputType=="insertText"&&t.inputState.composing>=0&&setTimeout(()=>Cs.compositionend(t,e),20),!1};const yD=new Set;function JSe(t){yD.has(t)||(yD.add(t),t.addEventListener("copy",()=>{}),t.addEventListener("cut",()=>{}))}const bD=["pre-wrap","normal","pre-line","break-spaces"];let Mu=!1;function vD(){Mu=!1}class QSe{constructor(e){this.lineWrapping=e,this.doc=It.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(e,r){let n=this.doc.lineAt(r).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((r-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return bD.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let r=!1;for(let n=0;n<e.length;n++){let s=e[n];s<0?n++:this.heightSamples[Math.floor(s*10)]||(r=!0,this.heightSamples[Math.floor(s*10)]=!0)}return r}refresh(e,r,n,s,i,o){let a=bD.indexOf(e)>-1,l=Math.round(r)!=Math.round(this.lineHeight)||this.lineWrapping!=a;if(this.lineWrapping=a,this.lineHeight=r,this.charWidth=n,this.textHeight=s,this.lineLength=i,l){this.heightSamples={};for(let c=0;c<o.length;c++){let u=o[c];u<0?c++:this.heightSamples[Math.floor(u*10)]=!0}}return l}}class eTe{constructor(e,r){this.from=e,this.heights=r,this.index=0}get more(){return this.index<this.heights.length}}class Ei{constructor(e,r,n,s,i){this.from=e,this.length=r,this.top=n,this.height=s,this._content=i}get type(){return typeof this._content=="number"?pn.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof La?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let r=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new Ei(this.from,this.length+e.length,this.top,this.height+e.height,r)}}var zt=function(t){return t[t.ByPos=0]="ByPos",t[t.ByHeight=1]="ByHeight",t[t.ByPosNoHeight=2]="ByPosNoHeight",t}(zt||(zt={}));const a0=.001;class mn{constructor(e,r,n=2){this.length=e,this.height=r,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e){this.height!=e&&(Math.abs(this.height-e)>a0&&(Mu=!0),this.height=e)}replace(e,r,n){return mn.of(n)}decomposeLeft(e,r){r.push(this)}decomposeRight(e,r){r.push(this)}applyChanges(e,r,n,s){let i=this,o=n.doc;for(let a=s.length-1;a>=0;a--){let{fromA:l,toA:c,fromB:u,toB:h}=s[a],d=i.lineAt(l,zt.ByPosNoHeight,n.setDoc(r),0,0),f=d.to>=c?d:i.lineAt(c,zt.ByPosNoHeight,n,0,0);for(h+=f.to-c,c=f.to;a>0&&d.from<=s[a-1].toA;)l=s[a-1].fromA,u=s[a-1].fromB,a--,l<d.from&&(d=i.lineAt(l,zt.ByPosNoHeight,n,0,0));u+=d.from-l,l=d.from;let g=qk.build(n.setDoc(o),e,u,h);i=R_(i,i.replace(l,c,g))}return i.updateHeight(n,0)}static empty(){return new $n(0,0)}static of(e){if(e.length==1)return e[0];let r=0,n=e.length,s=0,i=0;for(;;)if(r==n)if(s>i*2){let a=e[r-1];a.break?e.splice(--r,1,a.left,null,a.right):e.splice(--r,1,a.left,a.right),n+=1+a.break,s-=a.size}else if(i>s*2){let a=e[n];a.break?e.splice(n,1,a.left,null,a.right):e.splice(n,1,a.left,a.right),n+=2+a.break,i-=a.size}else break;else if(s<i){let a=e[r++];a&&(s+=a.size)}else{let a=e[--n];a&&(i+=a.size)}let o=0;return e[r-1]==null?(o=1,r--):e[r]==null&&(o=1,n++),new tTe(mn.of(e.slice(0,r)),o,mn.of(e.slice(n)))}}function R_(t,e){return t==e?t:(t.constructor!=e.constructor&&(Mu=!0),e)}mn.prototype.size=1;class qH extends mn{constructor(e,r,n){super(e,r),this.deco=n}blockAt(e,r,n,s){return new Ei(s,this.length,n,this.height,this.deco||0)}lineAt(e,r,n,s,i){return this.blockAt(0,n,s,i)}forEachLine(e,r,n,s,i,o){e<=i+this.length&&r>=i&&o(this.blockAt(0,n,s,i))}updateHeight(e,r=0,n=!1,s){return s&&s.from<=r&&s.more&&this.setHeight(s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class $n extends qH{constructor(e,r){super(e,r,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,r,n,s){return new Ei(s,this.length,n,this.height,this.breaks)}replace(e,r,n){let s=n[0];return n.length==1&&(s instanceof $n||s instanceof Mr&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof Mr?s=new $n(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):mn.of(n)}updateHeight(e,r=0,n=!1,s){return s&&s.from<=r&&s.more?this.setHeight(s.heights[s.index++]):(n||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class Mr extends mn{constructor(e){super(e,0)}heightMetrics(e,r){let n=e.doc.lineAt(r).number,s=e.doc.lineAt(r+this.length).number,i=s-n+1,o,a=0;if(e.lineWrapping){let l=Math.min(this.height,e.lineHeight*i);o=l/i,this.length>i+1&&(a=(this.height-l)/(this.length-i-1))}else o=this.height/i;return{firstLine:n,lastLine:s,perLine:o,perChar:a}}blockAt(e,r,n,s){let{firstLine:i,lastLine:o,perLine:a,perChar:l}=this.heightMetrics(r,s);if(r.lineWrapping){let c=s+(e<r.lineHeight?0:Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length)),u=r.doc.lineAt(c),h=a+u.length*l,d=Math.max(n,e-h/2);return new Ei(u.from,u.length,d,h,0)}else{let c=Math.max(0,Math.min(o-i,Math.floor((e-n)/a))),{from:u,length:h}=r.doc.line(i+c);return new Ei(u,h,n+a*c,a,0)}}lineAt(e,r,n,s,i){if(r==zt.ByHeight)return this.blockAt(e,n,s,i);if(r==zt.ByPosNoHeight){let{from:f,to:g}=n.doc.lineAt(e);return new Ei(f,g-f,0,0,0)}let{firstLine:o,perLine:a,perChar:l}=this.heightMetrics(n,i),c=n.doc.lineAt(e),u=a+c.length*l,h=c.number-o,d=s+a*h+l*(c.from-i-h);return new Ei(c.from,c.length,Math.max(s,Math.min(d,s+this.height-u)),u,0)}forEachLine(e,r,n,s,i,o){e=Math.max(e,i),r=Math.min(r,i+this.length);let{firstLine:a,perLine:l,perChar:c}=this.heightMetrics(n,i);for(let u=e,h=s;u<=r;){let d=n.doc.lineAt(u);if(u==e){let g=d.number-a;h+=l*g+c*(e-i-g)}let f=l+c*d.length;o(new Ei(d.from,d.length,h,f,0)),h+=f,u=d.to+1}}replace(e,r,n){let s=this.length-r;if(s>0){let i=n[n.length-1];i instanceof Mr?n[n.length-1]=new Mr(i.length+s):n.push(null,new Mr(s-1))}if(e>0){let i=n[0];i instanceof Mr?n[0]=new Mr(e+i.length):n.unshift(new Mr(e-1),null)}return mn.of(n)}decomposeLeft(e,r){r.push(new Mr(e-1),null)}decomposeRight(e,r){r.push(null,new Mr(this.length-e-1))}updateHeight(e,r=0,n=!1,s){let i=r+this.length;if(s&&s.from<=r+this.length&&s.more){let o=[],a=Math.max(r,s.from),l=-1;for(s.from>r&&o.push(new Mr(s.from-r-1).updateHeight(e,r));a<=i&&s.more;){let u=e.doc.lineAt(a).length;o.length&&o.push(null);let h=s.heights[s.index++];l==-1?l=h:Math.abs(h-l)>=a0&&(l=-2);let d=new $n(u,h);d.outdated=!1,o.push(d),a+=u+1}a<=i&&o.push(null,new Mr(i-a).updateHeight(e,a));let c=mn.of(o);return(l<0||Math.abs(c.height-this.height)>=a0||Math.abs(l-this.heightMetrics(e,r).perLine)>=a0)&&(Mu=!0),R_(this,c)}else(n||this.outdated)&&(this.setHeight(e.heightForGap(r,r+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class tTe extends mn{constructor(e,r,n){super(e.length+r+n.length,e.height+n.height,r|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,r,n,s){let i=n+this.left.height;return e<i?this.left.blockAt(e,r,n,s):this.right.blockAt(e,r,i,s+this.left.length+this.break)}lineAt(e,r,n,s,i){let o=s+this.left.height,a=i+this.left.length+this.break,l=r==zt.ByHeight?e<o:e<a,c=l?this.left.lineAt(e,r,n,s,i):this.right.lineAt(e,r,n,o,a);if(this.break||(l?c.to<a:c.from>a))return c;let u=r==zt.ByPosNoHeight?zt.ByPosNoHeight:zt.ByPos;return l?c.join(this.right.lineAt(a,u,n,o,a)):this.left.lineAt(a,u,n,s,i).join(c)}forEachLine(e,r,n,s,i,o){let a=s+this.left.height,l=i+this.left.length+this.break;if(this.break)e<l&&this.left.forEachLine(e,r,n,s,i,o),r>=l&&this.right.forEachLine(e,r,n,a,l,o);else{let c=this.lineAt(l,zt.ByPos,n,s,i);e<c.from&&this.left.forEachLine(e,c.from-1,n,s,i,o),c.to>=e&&c.from<=r&&o(c),r>c.to&&this.right.forEachLine(c.to+1,r,n,a,l,o)}}replace(e,r,n){let s=this.left.length+this.break;if(r<s)return this.balanced(this.left.replace(e,r,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,r-s,n));let i=[];e>0&&this.decomposeLeft(e,i);let o=i.length;for(let a of n)i.push(a);if(e>0&&wD(i,o-1),r<this.length){let a=i.length;this.decomposeRight(r,i),wD(i,a)}return mn.of(i)}decomposeLeft(e,r){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,r);r.push(this.left),this.break&&(n++,e>=n&&r.push(null)),e>n&&this.right.decomposeLeft(e-n,r)}decomposeRight(e,r){let n=this.left.length,s=n+this.break;if(e>=s)return this.right.decomposeRight(e-s,r);e<n&&this.left.decomposeRight(e,r),this.break&&e<s&&r.push(null),r.push(this.right)}balanced(e,r){return e.size>2*r.size||r.size>2*e.size?mn.of(this.break?[e,null,r]:[e,r]):(this.left=R_(this.left,e),this.right=R_(this.right,r),this.setHeight(e.height+r.height),this.outdated=e.outdated||r.outdated,this.size=e.size+r.size,this.length=e.length+this.break+r.length,this)}updateHeight(e,r=0,n=!1,s){let{left:i,right:o}=this,a=r+i.length+this.break,l=null;return s&&s.from<=r+i.length&&s.more?l=i=i.updateHeight(e,r,n,s):i.updateHeight(e,r,n),s&&s.from<=a+o.length&&s.more?l=o=o.updateHeight(e,a,n,s):o.updateHeight(e,a,n),l?this.balanced(i,o):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function wD(t,e){let r,n;t[e]==null&&(r=t[e-1])instanceof Mr&&(n=t[e+1])instanceof Mr&&t.splice(e-1,3,new Mr(r.length+1+n.length))}const rTe=5;class qk{constructor(e,r){this.pos=e,this.oracle=r,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,r){if(this.lineStart>-1){let n=Math.min(r,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof $n?s.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new $n(n-this.pos,-1)),this.writtenTo=n,r>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=r}point(e,r,n){if(e<r||n.heightRelevant){let s=n.widget?n.widget.estimatedHeight:0,i=n.widget?n.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let o=r-e;n.block?this.addBlock(new qH(o,s,n)):(o||i||s>=rTe)&&this.addLineDeco(s,i,o)}else r>e&&this.span(e,r);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:r}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=r,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new $n(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,r){let n=new Mr(r-e);return this.oracle.doc.lineAt(e).to==r&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof $n)return e;let r=new $n(0,-1);return this.nodes.push(r),r}addBlock(e){this.enterLine();let r=e.deco;r&&r.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,r&&r.endSide>0&&(this.covering=e)}addLineDeco(e,r,n){let s=this.ensureLine();s.length+=n,s.collapsed+=n,s.widgetHeight=Math.max(s.widgetHeight,e),s.breaks+=r,this.writtenTo=this.pos=this.pos+n}finish(e){let r=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(r instanceof $n)&&!this.isCovered?this.nodes.push(new $n(0,-1)):(this.writtenTo<this.pos||r==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let s of this.nodes)s instanceof $n&&s.updateHeight(this.oracle,n),n+=s?s.length:1;return this.nodes}static build(e,r,n,s){let i=new qk(n,e);return Tt.spans(r,n,s,i,0),i.finish(n)}}function nTe(t,e,r){let n=new sTe;return Tt.compare(t,e,r,n,0),n.changes}class sTe{constructor(){this.changes=[]}compareRange(){}comparePoint(e,r,n,s){(e<r||n&&n.heightRelevant||s&&s.heightRelevant)&&Qx(e,r,this.changes,5)}}function iTe(t,e){let r=t.getBoundingClientRect(),n=t.ownerDocument,s=n.defaultView||window,i=Math.max(0,r.left),o=Math.min(s.innerWidth,r.right),a=Math.max(0,r.top),l=Math.min(s.innerHeight,r.bottom);for(let c=t.parentNode;c&&c!=n.body;)if(c.nodeType==1){let u=c,h=window.getComputedStyle(u);if((u.scrollHeight>u.clientHeight||u.scrollWidth>u.clientWidth)&&h.overflow!="visible"){let d=u.getBoundingClientRect();i=Math.max(i,d.left),o=Math.min(o,d.right),a=Math.max(a,d.top),l=Math.min(c==t.parentNode?s.innerHeight:l,d.bottom)}c=h.position=="absolute"||h.position=="fixed"?u.offsetParent:u.parentNode}else if(c.nodeType==11)c=c.host;else break;return{left:i-r.left,right:Math.max(i,o)-r.left,top:a-(r.top+e),bottom:Math.max(a,l)-(r.top+e)}}function oTe(t,e){let r=t.getBoundingClientRect();return{left:0,right:r.right-r.left,top:e,bottom:r.bottom-(r.top+e)}}class Pw{constructor(e,r,n,s){this.from=e,this.to=r,this.size=n,this.displaySize=s}static same(e,r){if(e.length!=r.length)return!1;for(let n=0;n<e.length;n++){let s=e[n],i=r[n];if(s.from!=i.from||s.to!=i.to||s.size!=i.size)return!1}return!0}draw(e,r){return yt.replace({widget:new aTe(this.displaySize*(r?e.scaleY:e.scaleX),r)}).range(this.from,this.to)}}class aTe extends dh{constructor(e,r){super(),this.size=e,this.vertical=r}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class ED{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=xD,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=Zt.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let r=e.facet(Ib).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new QSe(r),this.stateDeco=e.facet(Pf).filter(n=>typeof n!="function"),this.heightMap=mn.empty().applyChanges(this.stateDeco,It.empty,this.heightOracle.setDoc(e.doc),[new bs(0,0,0,e.doc.length)]);for(let n=0;n<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());n++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=yt.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:r}=this.state.selection;for(let n=0;n<=1;n++){let s=n?r.head:r.anchor;if(!e.some(({from:i,to:o})=>s>=i&&s<=o)){let{from:i,to:o}=this.lineBlockAt(s);e.push(new ag(i,o))}}return this.viewports=e.sort((n,s)=>n.from-s.from),this.updateScaler()}updateScaler(){let e=this.scaler;return this.scaler=this.heightMap.height<=7e6?xD:new Kk(this.heightOracle,this.heightMap,this.viewports),e.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(ad(e,this.scaler))})}update(e,r=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(Pf).filter(u=>typeof u!="function");let s=e.changedRanges,i=bs.extendWithRanges(s,nTe(n,this.stateDeco,e?e.changes:_r.empty(this.state.doc.length))),o=this.heightMap.height,a=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);vD(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),i),(this.heightMap.height!=o||Mu)&&(e.flags|=2),a?(this.scrollAnchorPos=e.changes.mapPos(a.from,-1),this.scrollAnchorHeight=a.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let l=i.length?this.mapViewport(this.viewport,e.changes):this.viewport;(r&&(r.range.head<l.from||r.range.head>l.to)||!this.viewportIsAppropriate(l))&&(l=this.getViewport(0,r));let c=l.from!=this.viewport.from||l.to!=this.viewport.to;this.viewport=l,e.flags|=this.updateForViewport(),(c||!e.changes.empty||e.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),r&&(this.scrollTarget=r),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(RH)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let r=e.contentDOM,n=window.getComputedStyle(r),s=this.heightOracle,i=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?Zt.RTL:Zt.LTR;let o=this.heightOracle.mustRefreshForWrapping(i),a=r.getBoundingClientRect(),l=o||this.mustMeasureContent||this.contentDOMHeight!=a.height;this.contentDOMHeight=a.height,this.mustMeasureContent=!1;let c=0,u=0;if(a.width&&a.height){let{scaleX:v,scaleY:w}=rH(r,a);(v>.005&&Math.abs(this.scaleX-v)>.005||w>.005&&Math.abs(this.scaleY-w)>.005)&&(this.scaleX=v,this.scaleY=w,c|=8,o=l=!0)}let h=(parseInt(n.paddingTop)||0)*this.scaleY,d=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=h||this.paddingBottom!=d)&&(this.paddingTop=h,this.paddingBottom=d,c|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(l=!0),this.editorWidth=e.scrollDOM.clientWidth,c|=8);let f=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=f&&(this.scrollAnchorHeight=-1,this.scrollTop=f),this.scrolledToBottom=iH(e.scrollDOM);let g=(this.printing?oTe:iTe)(r,this.paddingTop),_=g.top-this.pixelViewport.top,m=g.bottom-this.pixelViewport.bottom;this.pixelViewport=g;let p=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(p!=this.inView&&(this.inView=p,p&&(l=!0)),!this.inView&&!this.scrollTarget)return 0;let y=a.width;if((this.contentDOMWidth!=y||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=a.width,this.editorHeight=e.scrollDOM.clientHeight,c|=8),l){let v=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(v)&&(o=!0),o||s.lineWrapping&&Math.abs(y-this.contentDOMWidth)>s.charWidth){let{lineHeight:w,charWidth:E,textHeight:S}=e.docView.measureTextSize();o=w>0&&s.refresh(i,w,E,S,y/E,v),o&&(e.docView.minWidth=0,c|=8)}_>0&&m>0?u=Math.max(_,m):_<0&&m<0&&(u=Math.min(_,m)),vD();for(let w of this.viewports){let E=w.from==this.viewport.from?v:e.docView.measureVisibleLineHeights(w);this.heightMap=(o?mn.empty().applyChanges(this.stateDeco,It.empty,this.heightOracle,[new bs(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,o,new eTe(w.from,E))}Mu&&(c|=2)}let b=!this.viewportIsAppropriate(this.viewport,u)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return b&&(c&2&&(c|=this.updateScaler()),this.viewport=this.getViewport(u,this.scrollTarget),c|=this.updateForViewport()),(c&2||b)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(o?[]:this.lineGaps,e)),c|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),c}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,r){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,i=this.heightOracle,{visibleTop:o,visibleBottom:a}=this,l=new ag(s.lineAt(o-n*1e3,zt.ByHeight,i,0,0).from,s.lineAt(a+(1-n)*1e3,zt.ByHeight,i,0,0).to);if(r){let{head:c}=r.range;if(c<l.from||c>l.to){let u=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),h=s.lineAt(c,zt.ByPos,i,0,0),d;r.y=="center"?d=(h.top+h.bottom)/2-u/2:r.y=="start"||r.y=="nearest"&&c<l.from?d=h.top:d=h.bottom-u,l=new ag(s.lineAt(d-1e3/2,zt.ByHeight,i,0,0).from,s.lineAt(d+u+1e3/2,zt.ByHeight,i,0,0).to)}}return l}mapViewport(e,r){let n=r.mapPos(e.from,-1),s=r.mapPos(e.to,1);return new ag(this.heightMap.lineAt(n,zt.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,zt.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:r},n=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,zt.ByPos,this.heightOracle,0,0),{bottom:i}=this.heightMap.lineAt(r,zt.ByPos,this.heightOracle,0,0),{visibleTop:o,visibleBottom:a}=this;return(e==0||s<=o-Math.max(10,Math.min(-n,250)))&&(r==this.state.doc.length||i>=a+Math.max(10,Math.min(n,250)))&&s>o-2*1e3&&i<a+2*1e3}mapLineGaps(e,r){if(!e.length||r.empty)return e;let n=[];for(let s of e)r.touchesRange(s.from,s.to)||n.push(new Pw(r.mapPos(s.from),r.mapPos(s.to),s.size,s.displaySize));return n}ensureLineGaps(e,r){let n=this.heightOracle.lineWrapping,s=n?1e4:2e3,i=s>>1,o=s<<1;if(this.defaultTextDirection!=Zt.LTR&&!n)return[];let a=[],l=(u,h,d,f)=>{if(h-u<i)return;let g=this.state.selection.main,_=[g.from];g.empty||_.push(g.to);for(let p of _)if(p>u&&p<h){l(u,p-10,d,f),l(p+10,h,d,f);return}let m=cTe(e,p=>p.from>=d.from&&p.to<=d.to&&Math.abs(p.from-u)<i&&Math.abs(p.to-h)<i&&!_.some(y=>p.from<y&&p.to>y));if(!m){if(h<d.to&&r&&n&&r.visibleRanges.some(b=>b.from<=h&&b.to>=h)){let b=r.moveToLineBoundary(Re.cursor(h),!1,!0).head;b>u&&(h=b)}let p=this.gapSize(d,u,h,f),y=n||p<2e6?p:2e6;m=new Pw(u,h,p,y)}a.push(m)},c=u=>{if(u.length<o||u.type!=pn.Text)return;let h=lTe(u.from,u.to,this.stateDeco);if(h.total<o)return;let d=this.scrollTarget?this.scrollTarget.range.head:null,f,g;if(n){let _=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,m,p;if(d!=null){let y=cg(h,d),b=((this.visibleBottom-this.visibleTop)/2+_)/u.height;m=y-b,p=y+b}else m=(this.visibleTop-u.top-_)/u.height,p=(this.visibleBottom-u.top+_)/u.height;f=lg(h,m),g=lg(h,p)}else{let _=h.total*this.heightOracle.charWidth,m=s*this.heightOracle.charWidth,p=0;if(_>2e6)for(let E of e)E.from>=u.from&&E.from<u.to&&E.size!=E.displaySize&&E.from*this.heightOracle.charWidth+p<this.pixelViewport.left&&(p=E.size-E.displaySize);let y=this.pixelViewport.left+p,b=this.pixelViewport.right+p,v,w;if(d!=null){let E=cg(h,d),S=((b-y)/2+m)/_;v=E-S,w=E+S}else v=(y-m)/_,w=(b+m)/_;f=lg(h,v),g=lg(h,w)}f>u.from&&l(u.from,f,u,h),g<u.to&&l(g,u.to,u,h)};for(let u of this.viewportLines)Array.isArray(u.type)?u.type.forEach(c):c(u);return a}gapSize(e,r,n,s){let i=cg(s,n)-cg(s,r);return this.heightOracle.lineWrapping?e.height*i:s.total*this.heightOracle.charWidth*i}updateLineGaps(e){Pw.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=yt.set(e.map(r=>r.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let r=[];Tt.spans(e,this.viewport.from,this.viewport.to,{span(s,i){r.push({from:s,to:i})},point(){}},20);let n=r.length!=this.visibleRanges.length||this.visibleRanges.some((s,i)=>s.from!=r[i].from||s.to!=r[i].to);return this.visibleRanges=r,n?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(r=>r.from<=e&&r.to>=e)||ad(this.heightMap.lineAt(e,zt.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return e>=this.viewportLines[0].top&&e<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(r=>r.top<=e&&r.bottom>=e)||ad(this.heightMap.lineAt(this.scaler.fromDOM(e),zt.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let r=this.lineBlockAtHeight(e+8);return r.from>=this.viewport.from||this.viewportLines[0].top-e>200?r:this.viewportLines[0]}elementAtHeight(e){return ad(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class ag{constructor(e,r){this.from=e,this.to=r}}function lTe(t,e,r){let n=[],s=t,i=0;return Tt.spans(r,t,e,{span(){},point(o,a){o>s&&(n.push({from:s,to:o}),i+=o-s),s=a}},20),s<e&&(n.push({from:s,to:e}),i+=e-s),{total:i,ranges:n}}function lg({total:t,ranges:e},r){if(r<=0)return e[0].from;if(r>=1)return e[e.length-1].to;let n=Math.floor(t*r);for(let s=0;;s++){let{from:i,to:o}=e[s],a=o-i;if(n<=a)return i+n;n-=a}}function cg(t,e){let r=0;for(let{from:n,to:s}of t.ranges){if(e<=s){r+=e-n;break}r+=s-n}return r/t.total}function cTe(t,e){for(let r of t)if(e(r))return r}const xD={toDOM(t){return t},fromDOM(t){return t},scale:1,eq(t){return t==this}};class Kk{constructor(e,r,n){let s=0,i=0,o=0;this.viewports=n.map(({from:a,to:l})=>{let c=r.lineAt(a,zt.ByPos,e,0,0).top,u=r.lineAt(l,zt.ByPos,e,0,0).bottom;return s+=u-c,{from:a,to:l,top:c,bottom:u,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(r.height-s);for(let a of this.viewports)a.domTop=o+(a.top-i)*this.scale,o=a.domBottom=a.domTop+(a.bottom-a.top),i=a.bottom}toDOM(e){for(let r=0,n=0,s=0;;r++){let i=r<this.viewports.length?this.viewports[r]:null;if(!i||e<i.top)return s+(e-n)*this.scale;if(e<=i.bottom)return i.domTop+(e-i.top);n=i.bottom,s=i.domBottom}}fromDOM(e){for(let r=0,n=0,s=0;;r++){let i=r<this.viewports.length?this.viewports[r]:null;if(!i||e<i.domTop)return n+(e-s)/this.scale;if(e<=i.domBottom)return i.top+(e-i.domTop);n=i.bottom,s=i.domBottom}}eq(e){return e instanceof Kk?this.scale==e.scale&&this.viewports.length==e.viewports.length&&this.viewports.every((r,n)=>r.from==e.viewports[n].from&&r.to==e.viewports[n].to):!1}}function ad(t,e){if(e.scale==1)return t;let r=e.toDOM(t.top),n=e.toDOM(t.bottom);return new Ei(t.from,t.length,r,n-r,Array.isArray(t._content)?t._content.map(s=>ad(s,e)):t._content)}const ug=We.define({combine:t=>t.join(" ")}),lS=We.define({combine:t=>t.indexOf(!0)>-1}),cS=Oa.newName(),KH=Oa.newName(),YH=Oa.newName(),XH={"&light":"."+KH,"&dark":"."+YH};function uS(t,e,r){return new Oa(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,s=>{if(s=="&")return t;if(!r||!r[s])throw new RangeError(`Unsupported selector: ${s}`);return r[s]}):t+" "+n}})}const uTe=uS("."+cS,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},XH),hTe={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Ow=Ve.ie&&Ve.ie_version<=11;class dTe{constructor(e){this.view=e,this.active=!1,this.editContext=null,this.selectionRange=new Xxe,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(r=>{for(let n of r)this.queue.push(n);(Ve.ie&&Ve.ie_version<=11||Ve.ios&&e.composing)&&r.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&e.constructor.EDIT_CONTEXT!==!1&&!(Ve.chrome&&Ve.chrome_version<126)&&(this.editContext=new pTe(e),e.state.facet(ra)&&(e.contentDOM.editContext=this.editContext.editContext)),Ow&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var r;((r=this.view.docView)===null||r===void 0?void 0:r.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(r=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),r.length>0&&r[r.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(r=>{r.length>0&&r[r.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(e){(e.type=="change"||!e.type)&&!e.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((r,n)=>r!=e[n]))){this.gapIntersection.disconnect();for(let r of e)this.gapIntersection.observe(r);this.gaps=e}}onSelectionChange(e){let r=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,s=this.selectionRange;if(n.state.facet(ra)?n.root.activeElement!=this.dom:!i0(this.dom,s))return;let i=s.anchorNode&&n.docView.nearest(s.anchorNode);if(i&&i.ignoreEvent(e)){r||(this.selectionChanged=!1);return}(Ve.ie&&Ve.ie_version<=11||Ve.android&&Ve.chrome)&&!n.state.selection.main.empty&&s.focusNode&&Nd(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,r=Rf(e.root);if(!r)return!1;let n=Ve.safari&&e.root.nodeType==11&&e.root.activeElement==this.dom&&fTe(this.view,r)||r;if(!n||this.selectionRange.eq(n))return!1;let s=i0(this.dom,n);return s&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Jxe(this.dom,n)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(n),s&&(this.selectionChanged=!0),!0)}setSelectionRange(e,r){this.selectionRange.set(e.node,e.offset,r.node,r.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,r=null;for(let n=this.dom;n;)if(n.nodeType==1)!r&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:r||(r=this.scrollTargets.slice(0,e)),r&&r.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!r&&(r=this.scrollTargets.slice(0,e)),r){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=r)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,hTe),Ow&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Ow&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,r){var n;if(!this.delayedAndroidKey){let s=()=>{let i=this.delayedAndroidKey;i&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=i.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&i.force&&au(this.dom,i.key,i.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:r,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let r=-1,n=-1,s=!1;for(let i of e){let o=this.readMutation(i);o&&(o.typeOver&&(s=!0),r==-1?{from:r,to:n}=o:(r=Math.min(o.from,r),n=Math.max(o.to,n)))}return{from:r,to:n,typeOver:s}}readChange(){let{from:e,to:r,typeOver:n}=this.processRecords(),s=this.selectionChanged&&i0(this.dom,this.selectionRange);if(e<0&&!s)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let i=new PSe(this.view,e,r,n);return this.view.docView.domChanged={newSel:i.newSel?i.newSel.main:null},i}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let r=this.readChange();if(!r)return this.view.requestMeasure(),!1;let n=this.view.state,s=FH(this.view,r);return this.view.state==n&&(r.domChanged||r.newSel&&!r.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),s}readMutation(e){let r=this.view.docView.nearest(e.target);if(!r||r.ignoreMutation(e))return null;if(r.markDirty(e.type=="attributes"),e.type=="attributes"&&(r.flags|=4),e.type=="childList"){let n=SD(r,e.previousSibling||e.target.previousSibling,-1),s=SD(r,e.nextSibling||e.target.nextSibling,1);return{from:n?r.posAfter(n):r.posAtStart,to:s?r.posBefore(s):r.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}update(e){this.editContext&&(this.editContext.update(e),e.startState.facet(ra)!=e.state.facet(ra)&&(e.view.contentDOM.editContext=e.state.facet(ra)?this.editContext.editContext:null))}destroy(){var e,r,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(r=this.gapIntersection)===null||r===void 0||r.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function SD(t,e,r){for(;e;){let n=jt.get(e);if(n&&n.parent==t)return n;let s=e.parentNode;e=s!=t.dom?s:r>0?e.nextSibling:e.previousSibling}return null}function TD(t,e){let r=e.startContainer,n=e.startOffset,s=e.endContainer,i=e.endOffset,o=t.docView.domAtPos(t.state.selection.main.anchor);return Nd(o.node,o.offset,s,i)&&([r,n,s,i]=[s,i,r,n]),{anchorNode:r,anchorOffset:n,focusNode:s,focusOffset:i}}function fTe(t,e){if(e.getComposedRanges){let s=e.getComposedRanges(t.root)[0];if(s)return TD(t,s)}let r=null;function n(s){s.preventDefault(),s.stopImmediatePropagation(),r=s.getTargetRanges()[0]}return t.contentDOM.addEventListener("beforeinput",n,!0),t.dom.ownerDocument.execCommand("indent"),t.contentDOM.removeEventListener("beforeinput",n,!0),r?TD(t,r):null}class pTe{constructor(e){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(e.state);let r=this.editContext=new window.EditContext({text:e.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,e.state.selection.main.anchor))),selectionEnd:this.toContextPos(e.state.selection.main.head)});this.handlers.textupdate=n=>{let{anchor:s}=e.state.selection.main,i=this.toEditorPos(n.updateRangeStart),o=this.toEditorPos(n.updateRangeEnd);e.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:n.updateRangeStart,editorBase:i,drifted:!1});let a={from:i,to:o,insert:It.of(n.text.split(`
`))};a.from==this.from&&s<this.from?a.from=s:a.to==this.to&&s>this.to&&(a.to=s),!(a.from==a.to&&!a.insert.length)&&(this.pendingContextChange=a,e.state.readOnly||Wk(e,a,Re.single(this.toEditorPos(n.selectionStart),this.toEditorPos(n.selectionEnd))),this.pendingContextChange&&(this.revertPending(e.state),this.setSelection(e.state)))},this.handlers.characterboundsupdate=n=>{let s=[],i=null;for(let o=this.toEditorPos(n.rangeStart),a=this.toEditorPos(n.rangeEnd);o<a;o++){let l=e.coordsForChar(o);i=l&&new DOMRect(l.left,l.top,l.right-l.left,l.bottom-l.top)||i||new DOMRect,s.push(i)}r.updateCharacterBounds(n.rangeStart,s)},this.handlers.textformatupdate=n=>{let s=[];for(let i of n.getTextFormats()){let o=i.underlineStyle,a=i.underlineThickness;if(o!="None"&&a!="None"){let l=`text-decoration: underline ${o=="Dashed"?"dashed ":o=="Squiggle"?"wavy ":""}${a=="Thin"?1:2}px`;s.push(yt.mark({attributes:{style:l}}).range(this.toEditorPos(i.rangeStart),this.toEditorPos(i.rangeEnd)))}}e.dispatch({effects:PH.of(yt.set(s))})},this.handlers.compositionstart=()=>{e.inputState.composing<0&&(e.inputState.composing=0,e.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(e.inputState.composing=-1,e.inputState.compositionFirstChange=null,this.composing){let{drifted:n}=this.composing;this.composing=null,n&&this.reset(e.state)}};for(let n in this.handlers)r.addEventListener(n,this.handlers[n]);this.measureReq={read:n=>{this.editContext.updateControlBounds(n.contentDOM.getBoundingClientRect());let s=Rf(n.root);s&&s.rangeCount&&this.editContext.updateSelectionBounds(s.getRangeAt(0).getBoundingClientRect())}}}applyEdits(e){let r=0,n=!1,s=this.pendingContextChange;return e.changes.iterChanges((i,o,a,l,c)=>{if(n)return;let u=c.length-(o-i);if(s&&o>=s.to)if(s.from==i&&s.to==o&&s.insert.eq(c)){s=this.pendingContextChange=null,r+=u,this.to+=u;return}else s=null,this.revertPending(e.state);if(i+=r,o+=r,o<=this.from)this.from+=u,this.to+=u;else if(i<this.to){if(i<this.from||o>this.to||this.to-this.from+c.length>3e4){n=!0;return}this.editContext.updateText(this.toContextPos(i),this.toContextPos(o),c.toString()),this.to+=u}r+=u}),s&&!n&&this.revertPending(e.state),!n}update(e){let r=this.pendingContextChange;this.composing&&(this.composing.drifted||e.transactions.some(n=>!n.isUserEvent("input.type")&&n.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=e.changes.mapPos(this.composing.editorBase)):!this.applyEdits(e)||!this.rangeIsValid(e.state)?(this.pendingContextChange=null,this.reset(e.state)):(e.docChanged||e.selectionSet||r)&&this.setSelection(e.state),(e.geometryChanged||e.docChanged||e.selectionSet)&&e.view.requestMeasure(this.measureReq)}resetRange(e){let{head:r}=e.selection.main;this.from=Math.max(0,r-1e4),this.to=Math.min(e.doc.length,r+1e4)}reset(e){this.resetRange(e),this.editContext.updateText(0,this.editContext.text.length,e.doc.sliceString(this.from,this.to)),this.setSelection(e)}revertPending(e){let r=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(r.from),this.toContextPos(r.from+r.insert.length),e.doc.sliceString(r.from,r.to))}setSelection(e){let{main:r}=e.selection,n=this.toContextPos(Math.max(this.from,Math.min(this.to,r.anchor))),s=this.toContextPos(r.head);(this.editContext.selectionStart!=n||this.editContext.selectionEnd!=s)&&this.editContext.updateSelection(n,s)}rangeIsValid(e){let{head:r}=e.selection.main;return!(this.from>0&&r-this.from<500||this.to<e.doc.length&&this.to-r<500||this.to-this.from>1e4*3)}toEditorPos(e){let r=this.composing;return r&&r.drifted?r.editorBase+(e-r.contextBase):e+this.from}toContextPos(e){let r=this.composing;return r&&r.drifted?r.contextBase+(e-r.editorBase):e-this.from}destroy(){for(let e in this.handlers)this.editContext.removeEventListener(e,this.handlers[e])}}class Ge{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){var r;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:n}=e;this.dispatchTransactions=e.dispatchTransactions||n&&(s=>s.forEach(i=>n(i,this)))||(s=>this.update(s)),this.dispatch=this.dispatch.bind(this),this._root=e.root||Zxe(e.parent)||document,this.viewState=new ED(e.state||vt.create(e)),e.scrollTo&&e.scrollTo.is(sg)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(sd).map(s=>new Aw(s));for(let s of this.plugins)s.update(this);this.observer=new dTe(this),this.inputState=new MSe(this),this.inputState.ensureHandlers(this.plugins),this.docView=new nD(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((r=document.fonts)===null||r===void 0)&&r.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...e){let r=e.length==1&&e[0]instanceof pr?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(r,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let r=!1,n=!1,s,i=this.state;for(let d of e){if(d.startState!=i)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");i=d.state}if(this.destroyed){this.viewState.state=i;return}let o=this.hasFocus,a=0,l=null;e.some(d=>d.annotation(VH))?(this.inputState.notifiedFocused=o,a=1):o!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=o,l=GH(i,o),l||(a=1));let c=this.observer.delayedAndroidKey,u=null;if(c?(this.observer.clearDelayedAndroidKey(),u=this.observer.readChange(),(u&&!this.state.doc.eq(i.doc)||!this.state.selection.eq(i.selection))&&(u=null)):this.observer.clear(),i.facet(vt.phrases)!=this.state.facet(vt.phrases))return this.setState(i);s=A_.create(this,i,e),s.flags|=a;let h=this.viewState.scrollTarget;try{this.updateState=2;for(let d of e){if(h&&(h=h.map(d.changes)),d.scrollIntoView){let{main:f}=d.state.selection;h=new lu(f.empty?f:Re.cursor(f.head,f.head>f.anchor?-1:1))}for(let f of d.effects)f.is(sg)&&(h=f.value.clip(this.state))}this.viewState.update(s,h),this.bidiCache=I_.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),r=this.docView.update(s),this.state.facet(id)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(r,e.some(d=>d.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(ug)!=s.state.facet(ug)&&(this.viewState.mustMeasureContent=!0),(r||n||h||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),r&&this.docViewUpdate(),!s.empty)for(let d of this.state.facet(sS))try{d(s)}catch(f){Wn(this.state,f,"update listener")}(l||u)&&Promise.resolve().then(()=>{l&&this.state==l.startState&&this.dispatch(l),u&&!FH(this,u)&&c.force&&au(this.contentDOM,c.key,c.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let r=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new ED(e),this.plugins=e.facet(sd).map(n=>new Aw(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new nD(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}r&&this.focus(),this.requestMeasure()}updatePlugins(e){let r=e.startState.facet(sd),n=e.state.facet(sd);if(r!=n){let s=[];for(let i of n){let o=r.indexOf(i);if(o<0)s.push(new Aw(i));else{let a=this.plugins[o];a.mustUpdate=e,s.push(a)}}for(let i of this.plugins)i.mustUpdate!=e&&i.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);r!=n&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let e of this.plugins){let r=e.value;if(r&&r.docViewUpdate)try{r.docViewUpdate(this)}catch(n){Wn(this.state,n,"doc view update listener")}}}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let r=null,n=this.scrollDOM,s=n.scrollTop*this.scaleY,{scrollAnchorPos:i,scrollAnchorHeight:o}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(o=-1),this.viewState.scrollAnchorHeight=-1;try{for(let a=0;;a++){if(o<0)if(iH(n))i=-1,o=this.viewState.heightMap.height;else{let f=this.viewState.scrollAnchorAt(s);i=f.from,o=f.top}this.updateState=1;let l=this.viewState.measure(this);if(!l&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(a>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let c=[];l&4||([this.measureRequests,c]=[c,this.measureRequests]);let u=c.map(f=>{try{return f.read(this)}catch(g){return Wn(this.state,g),CD}}),h=A_.create(this,this.state,[]),d=!1;h.flags|=l,r?r.flags|=l:r=h,this.updateState=2,h.empty||(this.updatePlugins(h),this.inputState.update(h),this.updateAttrs(),d=this.docView.update(h),d&&this.docViewUpdate());for(let f=0;f<c.length;f++)if(u[f]!=CD)try{let g=c[f];g.write&&g.write(u[f],this)}catch(g){Wn(this.state,g)}if(d&&this.docView.updateSelection(!0),!h.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,o=-1;continue}else{let g=(i<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(i).top)-o;if(g>1||g<-1){s=s+g,n.scrollTop=s/this.scaleY,o=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(r&&!r.empty)for(let a of this.state.facet(sS))a(r)}get themeClasses(){return cS+" "+(this.state.facet(lS)?YH:KH)+" "+this.state.facet(ug)}updateAttrs(){let e=kD(this,OH,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),r={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(ra)?"true":"false",class:"cm-content",style:`${Ve.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(r["aria-readonly"]="true"),kD(this,Ib,r);let n=this.observer.ignore(()=>{let s=Jx(this.contentDOM,this.contentAttrs,r),i=Jx(this.dom,this.editorAttrs,e);return s||i});return this.editorAttrs=e,this.contentAttrs=r,n}showAnnouncements(e){let r=!0;for(let n of e)for(let s of n.effects)if(s.is(Ge.announce)){r&&(this.announceDOM.textContent=""),r=!1;let i=this.announceDOM.appendChild(document.createElement("div"));i.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(id);let e=this.state.facet(Ge.cspNonce);Oa.mount(this.root,this.styleModules.concat(uTe).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let r=0;r<this.measureRequests.length;r++)if(this.measureRequests[r].key===e.key){this.measureRequests[r]=e;return}}this.measureRequests.push(e)}}plugin(e){let r=this.pluginMap.get(e);return(r===void 0||r&&r.spec!=e)&&this.pluginMap.set(e,r=this.plugins.find(n=>n.spec==e)||null),r&&r.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,r,n){return Iw(this,e,lD(this,e,r,n))}moveByGroup(e,r){return Iw(this,e,lD(this,e,r,n=>kSe(this,e.head,n)))}visualLineSide(e,r){let n=this.bidiSpans(e),s=this.textDirectionAt(e.from),i=n[r?n.length-1:0];return Re.cursor(i.side(r,s)+e.from,i.forward(!r,s)?1:-1)}moveToLineBoundary(e,r,n=!0){return CSe(this,e,r,n)}moveVertically(e,r,n){return Iw(this,e,ASe(this,e,r,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,r=0){return this.docView.posFromDOM(e,r)}posAtCoords(e,r=!0){return this.readMeasured(),BH(this,e,r)}coordsAtPos(e,r=1){this.readMeasured();let n=this.docView.coordsAt(e,r);if(!n||n.left==n.right)return n;let s=this.state.doc.lineAt(e),i=this.bidiSpans(s),o=i[ha.find(i,e-s.from,-1,r)];return Ab(n,o.dir==Zt.LTR==r>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(AH)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>mTe)return vH(e.length);let r=this.textDirectionAt(e.from),n;for(let i of this.bidiCache)if(i.from==e.from&&i.dir==r&&(i.fresh||bH(i.isolates,n=rD(this,e))))return i.order;n||(n=rD(this,e));let s=uSe(e.text,r,n);return this.bidiCache.push(new I_(e.from,e.to,r,n,!0,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Ve.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{nH(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,r={}){return sg.of(new lu(typeof e=="number"?Re.cursor(e):e,r.y,r.x,r.yMargin,r.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:r}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return sg.of(new lu(Re.cursor(n.from),"start","start",n.top-e,r,!0))}setTabFocusMode(e){e==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof e=="boolean"?this.inputState.tabFocusMode=e?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+e)}static domEventHandlers(e){return Hr.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Hr.define(()=>({}),{eventObservers:e})}static theme(e,r){let n=Oa.newName(),s=[ug.of(n),id.of(uS(`.${n}`,e))];return r&&r.dark&&s.push(lS.of(!0)),s}static baseTheme(e){return Va.lowest(id.of(uS("."+cS,e,XH)))}static findFromDOM(e){var r;let n=e.querySelector(".cm-content"),s=n&&jt.get(n)||jt.get(e);return((r=s?.rootView)===null||r===void 0?void 0:r.view)||null}}Ge.styleModule=id;Ge.inputHandler=CH;Ge.clipboardInputFilter=Hk;Ge.clipboardOutputFilter=zk;Ge.scrollHandler=IH;Ge.focusChangeEffect=kH;Ge.perLineTextDirection=AH;Ge.exceptionSink=TH;Ge.updateListener=sS;Ge.editable=ra;Ge.mouseSelectionStyle=SH;Ge.dragMovesSelection=xH;Ge.clickAddsSelectionRange=EH;Ge.decorations=Pf;Ge.outerDecorations=DH;Ge.atomicRanges=Vk;Ge.bidiIsolatedRanges=LH;Ge.scrollMargins=NH;Ge.darkTheme=lS;Ge.cspNonce=We.define({combine:t=>t.length?t[0]:""});Ge.contentAttributes=Ib;Ge.editorAttributes=OH;Ge.lineWrapping=Ge.contentAttributes.of({class:"cm-lineWrapping"});Ge.announce=ht.define();const mTe=4096,CD={};class I_{constructor(e,r,n,s,i,o){this.from=e,this.to=r,this.dir=n,this.isolates=s,this.fresh=i,this.order=o}static update(e,r){if(r.empty&&!e.some(i=>i.fresh))return e;let n=[],s=e.length?e[e.length-1].dir:Zt.LTR;for(let i=Math.max(0,e.length-10);i<e.length;i++){let o=e[i];o.dir==s&&!r.touchesRange(o.from,o.to)&&n.push(new I_(r.mapPos(o.from,1),r.mapPos(o.to,-1),o.dir,o.isolates,!1,o.order))}return n}}function kD(t,e,r){for(let n=t.state.facet(e),s=n.length-1;s>=0;s--){let i=n[s],o=typeof i=="function"?i(t):i;o&&Zx(o,r)}return r}const gTe=Ve.mac?"mac":Ve.windows?"win":Ve.linux?"linux":"key";function _Te(t,e){const r=t.split(/-(?!$)/);let n=r[r.length-1];n=="Space"&&(n=" ");let s,i,o,a;for(let l=0;l<r.length-1;++l){const c=r[l];if(/^(cmd|meta|m)$/i.test(c))a=!0;else if(/^a(lt)?$/i.test(c))s=!0;else if(/^(c|ctrl|control)$/i.test(c))i=!0;else if(/^s(hift)?$/i.test(c))o=!0;else if(/^mod$/i.test(c))e=="mac"?a=!0:i=!0;else throw new Error("Unrecognized modifier name: "+c)}return s&&(n="Alt-"+n),i&&(n="Ctrl-"+n),a&&(n="Meta-"+n),o&&(n="Shift-"+n),n}function hg(t,e,r){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),r!==!1&&e.shiftKey&&(t="Shift-"+t),t}const yTe=Va.default(Ge.domEventHandlers({keydown(t,e){return JH(ZH(e.state),t,e,"editor")}})),Ob=We.define({enables:yTe}),AD=new WeakMap;function ZH(t){let e=t.facet(Ob),r=AD.get(e);return r||AD.set(e,r=wTe(e.reduce((n,s)=>n.concat(s),[]))),r}function bTe(t,e,r){return JH(ZH(t.state),e,t,r)}let na=null;const vTe=4e3;function wTe(t,e=gTe){let r=Object.create(null),n=Object.create(null),s=(o,a)=>{let l=n[o];if(l==null)n[o]=a;else if(l!=a)throw new Error("Key binding "+o+" is used both as a regular binding and as a multi-stroke prefix")},i=(o,a,l,c,u)=>{var h,d;let f=r[o]||(r[o]=Object.create(null)),g=a.split(/ (?!$)/).map(p=>_Te(p,e));for(let p=1;p<g.length;p++){let y=g.slice(0,p).join(" ");s(y,!0),f[y]||(f[y]={preventDefault:!0,stopPropagation:!1,run:[b=>{let v=na={view:b,prefix:y,scope:o};return setTimeout(()=>{na==v&&(na=null)},vTe),!0}]})}let _=g.join(" ");s(_,!1);let m=f[_]||(f[_]={preventDefault:!1,stopPropagation:!1,run:((d=(h=f._any)===null||h===void 0?void 0:h.run)===null||d===void 0?void 0:d.slice())||[]});l&&m.run.push(l),c&&(m.preventDefault=!0),u&&(m.stopPropagation=!0)};for(let o of t){let a=o.scope?o.scope.split(" "):["editor"];if(o.any)for(let c of a){let u=r[c]||(r[c]=Object.create(null));u._any||(u._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:h}=o;for(let d in u)u[d].run.push(f=>h(f,hS))}let l=o[e]||o.key;if(l)for(let c of a)i(c,l,o.run,o.preventDefault,o.stopPropagation),o.shift&&i(c,"Shift-"+l,o.shift,o.preventDefault,o.stopPropagation)}return r}let hS=null;function JH(t,e,r,n){hS=e;let s=Wxe(e),i=An(s,0),o=Ds(i)==s.length&&s!=" ",a="",l=!1,c=!1,u=!1;na&&na.view==r&&na.scope==n&&(a=na.prefix+" ",UH.indexOf(e.keyCode)<0&&(c=!0,na=null));let h=new Set,d=m=>{if(m){for(let p of m.run)if(!h.has(p)&&(h.add(p),p(r)))return m.stopPropagation&&(u=!0),!0;m.preventDefault&&(m.stopPropagation&&(u=!0),c=!0)}return!1},f=t[n],g,_;return f&&(d(f[a+hg(s,e,!o)])?l=!0:o&&(e.altKey||e.metaKey||e.ctrlKey)&&!(Ve.windows&&e.ctrlKey&&e.altKey)&&(g=Da[e.keyCode])&&g!=s?(d(f[a+hg(g,e,!0)])||e.shiftKey&&(_=Af[e.keyCode])!=s&&_!=g&&d(f[a+hg(_,e,!1)]))&&(l=!0):o&&e.shiftKey&&d(f[a+hg(s,e,!0)])&&(l=!0),!l&&d(f._any)&&(l=!0)),c&&(l=!0),l&&u&&e.stopPropagation(),hS=null,l}class Bp{constructor(e,r,n,s,i){this.className=e,this.left=r,this.top=n,this.width=s,this.height=i}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,r){return r.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,r,n){if(n.empty){let s=e.coordsAtPos(n.head,n.assoc||1);if(!s)return[];let i=QH(e);return[new Bp(r,s.left-i.left,s.top-i.top,null,s.bottom-s.top)]}else return ETe(e,r,n)}}function QH(t){let e=t.scrollDOM.getBoundingClientRect();return{left:(t.textDirection==Zt.LTR?e.left:e.right-t.scrollDOM.clientWidth*t.scaleX)-t.scrollDOM.scrollLeft*t.scaleX,top:e.top-t.scrollDOM.scrollTop*t.scaleY}}function RD(t,e,r,n){let s=t.coordsAtPos(e,r*2);if(!s)return n;let i=t.dom.getBoundingClientRect(),o=(s.top+s.bottom)/2,a=t.posAtCoords({x:i.left+1,y:o}),l=t.posAtCoords({x:i.right-1,y:o});return a==null||l==null?n:{from:Math.max(n.from,Math.min(a,l)),to:Math.min(n.to,Math.max(a,l))}}function ETe(t,e,r){if(r.to<=t.viewport.from||r.from>=t.viewport.to)return[];let n=Math.max(r.from,t.viewport.from),s=Math.min(r.to,t.viewport.to),i=t.textDirection==Zt.LTR,o=t.contentDOM,a=o.getBoundingClientRect(),l=QH(t),c=o.querySelector(".cm-line"),u=c&&window.getComputedStyle(c),h=a.left+(u?parseInt(u.paddingLeft)+Math.min(0,parseInt(u.textIndent)):0),d=a.right-(u?parseInt(u.paddingRight):0),f=oS(t,n),g=oS(t,s),_=f.type==pn.Text?f:null,m=g.type==pn.Text?g:null;if(_&&(t.lineWrapping||f.widgetLineBreaks)&&(_=RD(t,n,1,_)),m&&(t.lineWrapping||g.widgetLineBreaks)&&(m=RD(t,s,-1,m)),_&&m&&_.from==m.from&&_.to==m.to)return y(b(r.from,r.to,_));{let w=_?b(r.from,null,_):v(f,!1),E=m?b(null,r.to,m):v(g,!0),S=[];return(_||f).to<(m||g).from-(_&&m?1:0)||f.widgetLineBreaks>1&&w.bottom+t.defaultLineHeight/2<E.top?S.push(p(h,w.bottom,d,E.top)):w.bottom<E.top&&t.elementAtHeight((w.bottom+E.top)/2).type==pn.Text&&(w.bottom=E.top=(w.bottom+E.top)/2),y(w).concat(S).concat(y(E))}function p(w,E,S,x){return new Bp(e,w-l.left,E-l.top-.01,S-w,x-E+.01)}function y({top:w,bottom:E,horizontal:S}){let x=[];for(let C=0;C<S.length;C+=2)x.push(p(S[C],w,S[C+1],E));return x}function b(w,E,S){let x=1e9,C=-1e9,A=[];function M(R,G,ee,q,re){let N=t.coordsAtPos(R,R==S.to?-2:2),B=t.coordsAtPos(ee,ee==S.from?2:-2);!N||!B||(x=Math.min(N.top,B.top,x),C=Math.max(N.bottom,B.bottom,C),re==Zt.LTR?A.push(i&&G?h:N.left,i&&q?d:B.right):A.push(!i&&q?h:B.left,!i&&G?d:N.right))}let P=w??S.from,D=E??S.to;for(let R of t.visibleRanges)if(R.to>P&&R.from<D)for(let G=Math.max(R.from,P),ee=Math.min(R.to,D);;){let q=t.state.doc.lineAt(G);for(let re of t.bidiSpans(q)){let N=re.from+q.from,B=re.to+q.from;if(N>=ee)break;B>G&&M(Math.max(N,G),w==null&&N<=P,Math.min(B,ee),E==null&&B>=D,re.dir)}if(G=q.to+1,G>=ee)break}return A.length==0&&M(P,w==null,D,E==null,t.textDirection),{top:x,bottom:C,horizontal:A}}function v(w,E){let S=a.top+(E?w.top:w.bottom);return{top:S,bottom:S,horizontal:[]}}}function xTe(t,e){return t.constructor==e.constructor&&t.eq(e)}class STe{constructor(e,r){this.view=e,this.layer=r,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),r.above&&this.dom.classList.add("cm-layer-above"),r.class&&this.dom.classList.add(r.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),r.mount&&r.mount(this.dom,e)}update(e){e.startState.facet(l0)!=e.state.facet(l0)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}docViewUpdate(e){this.layer.updateOnDocViewUpdate!==!1&&e.requestMeasure(this.measureReq)}setOrder(e){let r=0,n=e.facet(l0);for(;r<n.length&&n[r]!=this.layer;)r++;this.dom.style.zIndex=String((this.layer.above?150:-1)-r)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:r}=this.view;(e!=this.scaleX||r!=this.scaleY)&&(this.scaleX=e,this.scaleY=r,this.dom.style.transform=`scale(${1/e}, ${1/r})`)}draw(e){if(e.length!=this.drawn.length||e.some((r,n)=>!xTe(r,this.drawn[n]))){let r=this.dom.firstChild,n=0;for(let s of e)s.update&&r&&s.constructor&&this.drawn[n].constructor&&s.update(r,this.drawn[n])?(r=r.nextSibling,n++):this.dom.insertBefore(s.draw(),r);for(;r;){let s=r.nextSibling;r.remove(),r=s}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const l0=We.define();function e9(t){return[Hr.define(e=>new STe(e,t)),l0.of(t)]}const t9=!Ve.ios,Of=We.define({combine(t){return ac(t,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,r)=>Math.min(e,r),drawRangeCursor:(e,r)=>e||r})}});function TTe(t={}){return[Of.of(t),CTe,kTe,ATe,RH.of(!0)]}function r9(t){return t.startState.facet(Of)!=t.state.facet(Of)}const CTe=e9({above:!0,markers(t){let{state:e}=t,r=e.facet(Of),n=[];for(let s of e.selection.ranges){let i=s==e.selection.main;if(s.empty?!i||t9:r.drawRangeCursor){let o=i?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",a=s.empty?s:Re.cursor(s.head,s.head>s.anchor?-1:1);for(let l of Bp.forRange(t,o,a))n.push(l)}}return n},update(t,e){t.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let r=r9(t);return r&&ID(t.state,e),t.docChanged||t.selectionSet||r},mount(t,e){ID(e.state,t)},class:"cm-cursorLayer"});function ID(t,e){e.style.animationDuration=t.facet(Of).cursorBlinkRate+"ms"}const kTe=e9({above:!1,markers(t){return t.state.selection.ranges.map(e=>e.empty?[]:Bp.forRange(t,"cm-selectionBackground",e)).reduce((e,r)=>e.concat(r))},update(t,e){return t.docChanged||t.selectionSet||t.viewportChanged||r9(t)},class:"cm-selectionLayer"}),dS={".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"}},".cm-content":{"& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}};t9&&(dS[".cm-line"].caretColor=dS[".cm-content"].caretColor="transparent !important");const ATe=Va.highest(Ge.theme(dS)),n9=ht.define({map(t,e){return t==null?null:e.mapPos(t)}}),ld=Pr.define({create(){return null},update(t,e){return t!=null&&(t=e.changes.mapPos(t)),e.effects.reduce((r,n)=>n.is(n9)?n.value:r,t)}}),RTe=Hr.fromClass(class{constructor(t){this.view=t,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(t){var e;let r=t.state.field(ld);r==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(t.startState.field(ld)!=r||t.docChanged||t.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:t}=this,e=t.state.field(ld),r=e!=null&&t.coordsAtPos(e);if(!r)return null;let n=t.scrollDOM.getBoundingClientRect();return{left:r.left-n.left+t.scrollDOM.scrollLeft*t.scaleX,top:r.top-n.top+t.scrollDOM.scrollTop*t.scaleY,height:r.bottom-r.top}}drawCursor(t){if(this.cursor){let{scaleX:e,scaleY:r}=this.view;t?(this.cursor.style.left=t.left/e+"px",this.cursor.style.top=t.top/r+"px",this.cursor.style.height=t.height/r+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(t){this.view.state.field(ld)!=t&&this.view.dispatch({effects:n9.of(t)})}},{eventObservers:{dragover(t){this.setDropPos(this.view.posAtCoords({x:t.clientX,y:t.clientY}))},dragleave(t){(t.target==this.view.contentDOM||!this.view.contentDOM.contains(t.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function ITe(){return[ld,RTe]}const PD=Hr.fromClass(class{constructor(){this.height=1e3,this.attrs={style:"padding-bottom: 1000px"}}update(t){let{view:e}=t,r=e.viewState.editorHeight-e.defaultLineHeight-e.documentPadding.top-.5;r>=0&&r!=this.height&&(this.height=r,this.attrs={style:`padding-bottom: ${r}px`})}});function PTe(){return[PD,Ib.of(t=>{var e;return((e=t.plugin(PD))===null||e===void 0?void 0:e.attrs)||null})]}function OTe(){return LTe}const DTe=yt.line({class:"cm-activeLine"}),LTe=Hr.fromClass(class{constructor(t){this.decorations=this.getDeco(t)}update(t){(t.docChanged||t.selectionSet)&&(this.decorations=this.getDeco(t.view))}getDeco(t){let e=-1,r=[];for(let n of t.state.selection.ranges){let s=t.lineBlockAt(n.head);s.from>e&&(r.push(DTe.range(s.from)),e=s.from)}return yt.set(r)}},{decorations:t=>t.decorations}),Hh="-10000px";class NTe{constructor(e,r,n,s){this.facet=r,this.createTooltipView=n,this.removeTooltipView=s,this.input=e.state.facet(r),this.tooltips=this.input.filter(o=>o);let i=null;this.tooltipViews=this.tooltips.map(o=>i=n(o,i))}update(e,r){var n;let s=e.state.facet(this.facet),i=s.filter(l=>l);if(s===this.input){for(let l of this.tooltipViews)l.update&&l.update(e);return!1}let o=[],a=r?[]:null;for(let l=0;l<i.length;l++){let c=i[l],u=-1;if(c){for(let h=0;h<this.tooltips.length;h++){let d=this.tooltips[h];d&&d.create==c.create&&(u=h)}if(u<0)o[l]=this.createTooltipView(c,l?o[l-1]:null),a&&(a[l]=!!c.above);else{let h=o[l]=this.tooltipViews[u];a&&(a[l]=r[u]),h.update&&h.update(e)}}}for(let l of this.tooltipViews)o.indexOf(l)<0&&(this.removeTooltipView(l),(n=l.destroy)===null||n===void 0||n.call(l));return r&&(a.forEach((l,c)=>r[c]=l),r.length=a.length),this.input=s,this.tooltips=i,this.tooltipViews=o,!0}}function MTe(t={}){return c0.of(t)}function BTe(t){let{win:e}=t;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const c0=We.define({combine:t=>{var e,r,n;return{position:Ve.ios?"absolute":((e=t.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((r=t.find(s=>s.parent))===null||r===void 0?void 0:r.parent)||null,tooltipSpace:((n=t.find(s=>s.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||BTe}}}),OD=new WeakMap,s9=Hr.fromClass(class{constructor(t){this.view=t,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=t.state.facet(c0);this.position=e.position,this.parent=e.parent,this.classes=t.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new NTe(t,Yk,(r,n)=>this.createTooltip(r,n),r=>{this.resizeObserver&&this.resizeObserver.unobserve(r.dom),r.dom.remove()}),this.above=this.manager.tooltips.map(r=>!!r.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(r=>{Date.now()>this.lastTransaction-50&&r.length>0&&r[r.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),t.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let t of this.manager.tooltipViews)this.intersectionObserver.observe(t.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(t){t.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(t,this.above);e&&this.observeIntersection();let r=e||t.geometryChanged,n=t.state.facet(c0);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;r=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);r=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);r&&this.maybeMeasure()}createTooltip(t,e){let r=t.create(this.view),n=e?e.dom:null;if(r.dom.classList.add("cm-tooltip"),t.arrow&&!r.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let s=document.createElement("div");s.className="cm-tooltip-arrow",r.dom.appendChild(s)}return r.dom.style.position=this.position,r.dom.style.top=Hh,r.dom.style.left="0px",this.container.insertBefore(r.dom,n),r.mount&&r.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(r.dom),r}destroy(){var t,e,r;this.view.win.removeEventListener("resize",this.measureSoon);for(let n of this.manager.tooltipViews)n.dom.remove(),(t=n.destroy)===null||t===void 0||t.call(n);this.parent&&this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(r=this.intersectionObserver)===null||r===void 0||r.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let t=1,e=1,r=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:i}=this.manager.tooltipViews[0];if(Ve.gecko)r=i.offsetParent!=this.container.ownerDocument.body;else if(i.style.top==Hh&&i.style.left=="0px"){let o=i.getBoundingClientRect();r=Math.abs(o.top+1e4)>1||Math.abs(o.left)>1}}if(r||this.position=="absolute")if(this.parent){let i=this.parent.getBoundingClientRect();i.width&&i.height&&(t=i.width/this.parent.offsetWidth,e=i.height/this.parent.offsetHeight)}else({scaleX:t,scaleY:e}=this.view.viewState);let n=this.view.scrollDOM.getBoundingClientRect(),s=Gk(this.view);return{visible:{left:n.left+s.left,top:n.top+s.top,right:n.right-s.right,bottom:n.bottom-s.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((i,o)=>{let a=this.manager.tooltipViews[o];return a.getCoords?a.getCoords(i.pos):this.view.coordsAtPos(i.pos)}),size:this.manager.tooltipViews.map(({dom:i})=>i.getBoundingClientRect()),space:this.view.state.facet(c0).tooltipSpace(this.view),scaleX:t,scaleY:e,makeAbsolute:r}}writeMeasure(t){var e;if(t.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let a of this.manager.tooltipViews)a.dom.style.position="absolute"}let{visible:r,space:n,scaleX:s,scaleY:i}=t,o=[];for(let a=0;a<this.manager.tooltips.length;a++){let l=this.manager.tooltips[a],c=this.manager.tooltipViews[a],{dom:u}=c,h=t.pos[a],d=t.size[a];if(!h||l.clip!==!1&&(h.bottom<=Math.max(r.top,n.top)||h.top>=Math.min(r.bottom,n.bottom)||h.right<Math.max(r.left,n.left)-.1||h.left>Math.min(r.right,n.right)+.1)){u.style.top=Hh;continue}let f=l.arrow?c.dom.querySelector(".cm-tooltip-arrow"):null,g=f?7:0,_=d.right-d.left,m=(e=OD.get(c))!==null&&e!==void 0?e:d.bottom-d.top,p=c.offset||jTe,y=this.view.textDirection==Zt.LTR,b=d.width>n.right-n.left?y?n.left:n.right-d.width:y?Math.max(n.left,Math.min(h.left-(f?14:0)+p.x,n.right-_)):Math.min(Math.max(n.left,h.left-_+(f?14:0)-p.x),n.right-_),v=this.above[a];!l.strictSide&&(v?h.top-m-g-p.y<n.top:h.bottom+m+g+p.y>n.bottom)&&v==n.bottom-h.bottom>h.top-n.top&&(v=this.above[a]=!v);let w=(v?h.top-n.top:n.bottom-h.bottom)-g;if(w<m&&c.resize!==!1){if(w<this.view.defaultLineHeight){u.style.top=Hh;continue}OD.set(c,m),u.style.height=(m=w)/i+"px"}else u.style.height&&(u.style.height="");let E=v?h.top-m-g-p.y:h.bottom+g+p.y,S=b+_;if(c.overlap!==!0)for(let x of o)x.left<S&&x.right>b&&x.top<E+m&&x.bottom>E&&(E=v?x.top-m-2-g:x.bottom+g+2);if(this.position=="absolute"?(u.style.top=(E-t.parent.top)/i+"px",u.style.left=(b-t.parent.left)/s+"px"):(u.style.top=E/i+"px",u.style.left=b/s+"px"),f){let x=h.left+(y?p.x:-p.x)-(b+14-7);f.style.left=x/s+"px"}c.overlap!==!0&&o.push({left:b,top:E,right:S,bottom:E+m}),u.classList.toggle("cm-tooltip-above",v),u.classList.toggle("cm-tooltip-below",!v),c.positioned&&c.positioned(t.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let t of this.manager.tooltipViews)t.dom.style.top=Hh}},{eventObservers:{scroll(){this.maybeMeasure()}}}),FTe=Ge.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),jTe={x:0,y:0},Yk=We.define({enables:[s9,FTe]});function i9(t,e){let r=t.plugin(s9);if(!r)return null;let n=r.manager.tooltips.indexOf(e);return n<0?null:r.manager.tooltipViews[n]}const DD=We.define({combine(t){let e,r;for(let n of t)e=e||n.topContainer,r=r||n.bottomContainer;return{topContainer:e,bottomContainer:r}}});function P_(t,e){let r=t.plugin(o9),n=r?r.specs.indexOf(e):-1;return n>-1?r.panels[n]:null}const o9=Hr.fromClass(class{constructor(t){this.input=t.state.facet(O_),this.specs=this.input.filter(r=>r),this.panels=this.specs.map(r=>r(t));let e=t.state.facet(DD);this.top=new dg(t,!0,e.topContainer),this.bottom=new dg(t,!1,e.bottomContainer),this.top.sync(this.panels.filter(r=>r.top)),this.bottom.sync(this.panels.filter(r=>!r.top));for(let r of this.panels)r.dom.classList.add("cm-panel"),r.mount&&r.mount()}update(t){let e=t.state.facet(DD);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new dg(t.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new dg(t.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let r=t.state.facet(O_);if(r!=this.input){let n=r.filter(l=>l),s=[],i=[],o=[],a=[];for(let l of n){let c=this.specs.indexOf(l),u;c<0?(u=l(t.view),a.push(u)):(u=this.panels[c],u.update&&u.update(t)),s.push(u),(u.top?i:o).push(u)}this.specs=n,this.panels=s,this.top.sync(i),this.bottom.sync(o);for(let l of a)l.dom.classList.add("cm-panel"),l.mount&&l.mount()}else for(let n of this.panels)n.update&&n.update(t)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:t=>Ge.scrollMargins.of(e=>{let r=e.plugin(t);return r&&{top:r.top.scrollMargin(),bottom:r.bottom.scrollMargin()}})});let dg=class{constructor(e,r,n){this.view=e,this.top=r,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let r of this.panels)r.destroy&&e.indexOf(r)<0&&r.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let r=this.container||this.view.dom;r.insertBefore(this.dom,this.top?r.firstChild:null)}let e=this.dom.firstChild;for(let r of this.panels)if(r.dom.parentNode==this.dom){for(;e!=r.dom;)e=LD(e);e=e.nextSibling}else this.dom.insertBefore(r.dom,e);for(;e;)e=LD(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}};function LD(t){let e=t.nextSibling;return t.remove(),e}const O_=We.define({enables:o9});class ko extends Vl{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}ko.prototype.elementClass="";ko.prototype.toDOM=void 0;ko.prototype.mapMode=Yr.TrackBefore;ko.prototype.startSide=ko.prototype.endSide=-1;ko.prototype.point=!0;const u0=We.define(),UTe=We.define(),$Te={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>Tt.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Bd=We.define();function HTe(t){return[a9(),Bd.of(Object.assign(Object.assign({},$Te),t))]}const ND=We.define({combine:t=>t.some(e=>e)});function a9(t){return[zTe]}const zTe=Hr.fromClass(class{constructor(t){this.view=t,this.prevViewport=t.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=t.state.facet(Bd).map(e=>new BD(t,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!t.state.facet(ND),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),t.scrollDOM.insertBefore(this.dom,t.contentDOM)}update(t){if(this.updateGutters(t)){let e=this.prevViewport,r=t.view.viewport,n=Math.min(e.to,r.to)-Math.max(e.from,r.from);this.syncGutters(n<(r.to-r.from)*.8)}t.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px"),this.view.state.facet(ND)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=t.view.viewport}syncGutters(t){let e=this.dom.nextSibling;t&&this.dom.remove();let r=Tt.iter(this.view.state.facet(u0),this.view.viewport.from),n=[],s=this.gutters.map(i=>new VTe(i,this.view.viewport,-this.view.documentPadding.top));for(let i of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(i.type)){let o=!0;for(let a of i.type)if(a.type==pn.Text&&o){fS(r,n,a.from);for(let l of s)l.line(this.view,a,n);o=!1}else if(a.widget)for(let l of s)l.widget(this.view,a)}else if(i.type==pn.Text){fS(r,n,i.from);for(let o of s)o.line(this.view,i,n)}else if(i.widget)for(let o of s)o.widget(this.view,i);for(let i of s)i.finish();t&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(t){let e=t.startState.facet(Bd),r=t.state.facet(Bd),n=t.docChanged||t.heightChanged||t.viewportChanged||!Tt.eq(t.startState.facet(u0),t.state.facet(u0),t.view.viewport.from,t.view.viewport.to);if(e==r)for(let s of this.gutters)s.update(t)&&(n=!0);else{n=!0;let s=[];for(let i of r){let o=e.indexOf(i);o<0?s.push(new BD(this.view,i)):(this.gutters[o].update(t),s.push(this.gutters[o]))}for(let i of this.gutters)i.dom.remove(),s.indexOf(i)<0&&i.destroy();for(let i of s)this.dom.appendChild(i.dom);this.gutters=s}return n}destroy(){for(let t of this.gutters)t.destroy();this.dom.remove()}},{provide:t=>Ge.scrollMargins.of(e=>{let r=e.plugin(t);return!r||r.gutters.length==0||!r.fixed?null:e.textDirection==Zt.LTR?{left:r.dom.offsetWidth*e.scaleX}:{right:r.dom.offsetWidth*e.scaleX}})});function MD(t){return Array.isArray(t)?t:[t]}function fS(t,e,r){for(;t.value&&t.from<=r;)t.from==r&&e.push(t.value),t.next()}class VTe{constructor(e,r,n){this.gutter=e,this.height=n,this.i=0,this.cursor=Tt.iter(e.markers,r.from)}addElement(e,r,n){let{gutter:s}=this,i=(r.top-this.height)/e.scaleY,o=r.height/e.scaleY;if(this.i==s.elements.length){let a=new l9(e,o,i,n);s.elements.push(a),s.dom.appendChild(a.dom)}else s.elements[this.i].update(e,o,i,n);this.height=r.bottom,this.i++}line(e,r,n){let s=[];fS(this.cursor,s,r.from),n.length&&(s=s.concat(n));let i=this.gutter.config.lineMarker(e,r,s);i&&s.unshift(i);let o=this.gutter;s.length==0&&!o.config.renderEmptyElements||this.addElement(e,r,s)}widget(e,r){let n=this.gutter.config.widgetMarker(e,r.widget,r),s=n?[n]:null;for(let i of e.state.facet(UTe)){let o=i(e,r.widget,r);o&&(s||(s=[])).push(o)}s&&this.addElement(e,r,s)}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let r=e.elements.pop();e.dom.removeChild(r.dom),r.destroy()}}}class BD{constructor(e,r){this.view=e,this.config=r,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in r.domEventHandlers)this.dom.addEventListener(n,s=>{let i=s.target,o;if(i!=this.dom&&this.dom.contains(i)){for(;i.parentNode!=this.dom;)i=i.parentNode;let l=i.getBoundingClientRect();o=(l.top+l.bottom)/2}else o=s.clientY;let a=e.lineBlockAtHeight(o-e.documentTop);r.domEventHandlers[n](e,a,s)&&s.preventDefault()});this.markers=MD(r.markers(e)),r.initialSpacer&&(this.spacer=new l9(e,0,0,[r.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let r=this.markers;if(this.markers=MD(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let n=e.view.viewport;return!Tt.eq(this.markers,r,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class l9{constructor(e,r,n,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,r,n,s)}update(e,r,n,s){this.height!=r&&(this.height=r,this.dom.style.height=r+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),GTe(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,r){let n="cm-gutterElement",s=this.dom.firstChild;for(let i=0,o=0;;){let a=o,l=i<r.length?r[i++]:null,c=!1;if(l){let u=l.elementClass;u&&(n+=" "+u);for(let h=o;h<this.markers.length;h++)if(this.markers[h].compare(l)){a=h,c=!0;break}}else a=this.markers.length;for(;o<a;){let u=this.markers[o++];if(u.toDOM){u.destroy(s);let h=s.nextSibling;s.remove(),s=h}}if(!l)break;l.toDOM&&(c?s=s.nextSibling:this.dom.insertBefore(l.toDOM(e),s)),c&&o++}this.dom.className=n,this.markers=r}destroy(){this.setMarkers(null,[])}}function GTe(t,e){if(t.length!=e.length)return!1;for(let r=0;r<t.length;r++)if(!t[r].compare(e[r]))return!1;return!0}const WTe=We.define(),qTe=We.define(),Vc=We.define({combine(t){return ac(t,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,r){let n=Object.assign({},e);for(let s in r){let i=n[s],o=r[s];n[s]=i?(a,l,c)=>i(a,l,c)||o(a,l,c):o}return n}})}});class Dw extends ko{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Lw(t,e){return t.state.facet(Vc).formatNumber(e,t.state)}const KTe=Bd.compute([Vc],t=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(WTe)},lineMarker(e,r,n){return n.some(s=>s.toDOM)?null:new Dw(Lw(e,e.state.doc.lineAt(r.from).number))},widgetMarker:(e,r,n)=>{for(let s of e.state.facet(qTe)){let i=s(e,r,n);if(i)return i}return null},lineMarkerChange:e=>e.startState.facet(Vc)!=e.state.facet(Vc),initialSpacer(e){return new Dw(Lw(e,FD(e.state.doc.lines)))},updateSpacer(e,r){let n=Lw(r.view,FD(r.view.state.doc.lines));return n==e.number?e:new Dw(n)},domEventHandlers:t.facet(Vc).domEventHandlers}));function YTe(t={}){return[Vc.of(t),a9(),KTe]}function FD(t){let e=9;for(;e<t;)e=e*10+9;return e}const XTe=new class extends ko{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},ZTe=u0.compute(["selection"],t=>{let e=[],r=-1;for(let n of t.selection.ranges){let s=t.doc.lineAt(n.head).from;s>r&&(r=s,e.push(XTe.range(s)))}return Tt.of(e)});function JTe(){return ZTe}const QTe=1024;let eCe=0;class ms{constructor(e,r){this.from=e,this.to=r}}class mt{constructor(e={}){this.id=eCe++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Mn.match(e)),r=>{let n=e(r);return n===void 0?null:[this,n]}}}mt.closedBy=new mt({deserialize:t=>t.split(" ")});mt.openedBy=new mt({deserialize:t=>t.split(" ")});mt.group=new mt({deserialize:t=>t.split(" ")});mt.isolate=new mt({deserialize:t=>{if(t&&t!="rtl"&&t!="ltr"&&t!="auto")throw new RangeError("Invalid value for isolate: "+t);return t||"auto"}});mt.contextHash=new mt({perNode:!0});mt.lookAhead=new mt({perNode:!0});mt.mounted=new mt({perNode:!0});class Df{constructor(e,r,n){this.tree=e,this.overlay=r,this.parser=n}static get(e){return e&&e.props&&e.props[mt.mounted.id]}}const tCe=Object.create(null);class Mn{constructor(e,r,n,s=0){this.name=e,this.props=r,this.id=n,this.flags=s}static define(e){let r=e.props&&e.props.length?Object.create(null):tCe,n=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),s=new Mn(e.name||"",r,e.id,n);if(e.props){for(let i of e.props)if(Array.isArray(i)||(i=i(s)),i){if(i[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");r[i[0].id]=i[1]}}return s}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let r=this.prop(mt.group);return r?r.indexOf(e)>-1:!1}return this.id==e}static match(e){let r=Object.create(null);for(let n in e)for(let s of n.split(" "))r[s]=e[n];return n=>{for(let s=n.prop(mt.group),i=-1;i<(s?s.length:0);i++){let o=r[i<0?n.name:s[i]];if(o)return o}}}}Mn.none=new Mn("",Object.create(null),0,8);class c9{constructor(e){this.types=e;for(let r=0;r<e.length;r++)if(e[r].id!=r)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...e){let r=[];for(let n of this.types){let s=null;for(let i of e){let o=i(n);o&&(s||(s=Object.assign({},n.props)),s[o[0].id]=o[1])}r.push(s?new Mn(n.name,s,n.id,n.flags):n)}return new c9(r)}}const fg=new WeakMap,jD=new WeakMap;var er;(function(t){t[t.ExcludeBuffers=1]="ExcludeBuffers",t[t.IncludeAnonymous=2]="IncludeAnonymous",t[t.IgnoreMounts=4]="IgnoreMounts",t[t.IgnoreOverlays=8]="IgnoreOverlays"})(er||(er={}));class wr{constructor(e,r,n,s,i){if(this.type=e,this.children=r,this.positions=n,this.length=s,this.props=null,i&&i.length){this.props=Object.create(null);for(let[o,a]of i)this.props[typeof o=="number"?o:o.id]=a}}toString(){let e=Df.get(this);if(e&&!e.overlay)return e.tree.toString();let r="";for(let n of this.children){let s=n.toString();s&&(r&&(r+=","),r+=s)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(r.length?"("+r+")":""):r}cursor(e=0){return new D_(this.topNode,e)}cursorAt(e,r=0,n=0){let s=fg.get(this)||this.topNode,i=new D_(s);return i.moveTo(e,r),fg.set(this,i._tree),i}get topNode(){return new Qr(this,0,0,null)}resolve(e,r=0){let n=Lf(fg.get(this)||this.topNode,e,r,!1);return fg.set(this,n),n}resolveInner(e,r=0){let n=Lf(jD.get(this)||this.topNode,e,r,!0);return jD.set(this,n),n}resolveStack(e,r=0){return sCe(this,e,r)}iterate(e){let{enter:r,leave:n,from:s=0,to:i=this.length}=e,o=e.mode||0,a=(o&er.IncludeAnonymous)>0;for(let l=this.cursor(o|er.IncludeAnonymous);;){let c=!1;if(l.from<=i&&l.to>=s&&(!a&&l.type.isAnonymous||r(l)!==!1)){if(l.firstChild())continue;c=!0}for(;c&&n&&(a||!l.type.isAnonymous)&&n(l),!l.nextSibling();){if(!l.parent())return;c=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let r in this.props)e.push([+r,this.props[r]]);return e}balance(e={}){return this.children.length<=8?this:Jk(Mn.none,this.children,this.positions,0,this.children.length,0,this.length,(r,n,s)=>new wr(this.type,r,n,s,this.propValues),e.makeTree||((r,n,s)=>new wr(Mn.none,r,n,s)))}static build(e){return iCe(e)}}wr.empty=new wr(Mn.none,[],[],0);class Xk{constructor(e,r){this.buffer=e,this.index=r}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Xk(this.buffer,this.index)}}class Na{constructor(e,r,n){this.buffer=e,this.length=r,this.set=n}get type(){return Mn.none}toString(){let e=[];for(let r=0;r<this.buffer.length;)e.push(this.childString(r)),r=this.buffer[r+3];return e.join(",")}childString(e){let r=this.buffer[e],n=this.buffer[e+3],s=this.set.types[r],i=s.name;if(/\W/.test(i)&&!s.isError&&(i=JSON.stringify(i)),e+=4,n==e)return i;let o=[];for(;e<n;)o.push(this.childString(e)),e=this.buffer[e+3];return i+"("+o.join(",")+")"}findChild(e,r,n,s,i){let{buffer:o}=this,a=-1;for(let l=e;l!=r&&!(u9(i,s,o[l+1],o[l+2])&&(a=l,n>0));l=o[l+3]);return a}slice(e,r,n){let s=this.buffer,i=new Uint16Array(r-e),o=0;for(let a=e,l=0;a<r;){i[l++]=s[a++],i[l++]=s[a++]-n;let c=i[l++]=s[a++]-n;i[l++]=s[a++]-e,o=Math.max(o,c)}return new Na(i,o,this.set)}}function u9(t,e,r,n){switch(t){case-2:return r<e;case-1:return n>=e&&r<e;case 0:return r<e&&n>e;case 1:return r<=e&&n>e;case 2:return n>e;case 4:return!0}}function Lf(t,e,r,n){for(var s;t.from==t.to||(r<1?t.from>=e:t.from>e)||(r>-1?t.to<=e:t.to<e);){let o=!n&&t instanceof Qr&&t.index<0?null:t.parent;if(!o)return t;t=o}let i=n?0:er.IgnoreOverlays;if(n)for(let o=t,a=o.parent;a;o=a,a=o.parent)o instanceof Qr&&o.index<0&&((s=a.enter(e,r,i))===null||s===void 0?void 0:s.from)!=o.from&&(t=a);for(;;){let o=t.enter(e,r,i);if(!o)return t;t=o}}class h9{cursor(e=0){return new D_(this,e)}getChild(e,r=null,n=null){let s=UD(this,e,r,n);return s.length?s[0]:null}getChildren(e,r=null,n=null){return UD(this,e,r,n)}resolve(e,r=0){return Lf(this,e,r,!1)}resolveInner(e,r=0){return Lf(this,e,r,!0)}matchContext(e){return pS(this.parent,e)}enterUnfinishedNodesBefore(e){let r=this.childBefore(e),n=this;for(;r;){let s=r.lastChild;if(!s||s.to!=r.to)break;s.type.isError&&s.from==s.to?(n=r,r=s.prevSibling):r=s}return n}get node(){return this}get next(){return this.parent}}class Qr extends h9{constructor(e,r,n,s){super(),this._tree=e,this.from=r,this.index=n,this._parent=s}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,r,n,s,i=0){for(let o=this;;){for(let{children:a,positions:l}=o._tree,c=r>0?a.length:-1;e!=c;e+=r){let u=a[e],h=l[e]+o.from;if(u9(s,n,h,h+u.length)){if(u instanceof Na){if(i&er.ExcludeBuffers)continue;let d=u.findChild(0,u.buffer.length,r,n-h,s);if(d>-1)return new ki(new rCe(o,u,e,h),null,d)}else if(i&er.IncludeAnonymous||!u.type.isAnonymous||Zk(u)){let d;if(!(i&er.IgnoreMounts)&&(d=Df.get(u))&&!d.overlay)return new Qr(d.tree,h,e,o);let f=new Qr(u,h,e,o);return i&er.IncludeAnonymous||!f.type.isAnonymous?f:f.nextChild(r<0?u.children.length-1:0,r,n,s)}}}if(i&er.IncludeAnonymous||!o.type.isAnonymous||(o.index>=0?e=o.index+r:e=r<0?-1:o._parent._tree.children.length,o=o._parent,!o))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,r,n=0){let s;if(!(n&er.IgnoreOverlays)&&(s=Df.get(this._tree))&&s.overlay){let i=e-this.from;for(let{from:o,to:a}of s.overlay)if((r>0?o<=i:o<i)&&(r<0?a>=i:a>i))return new Qr(s.tree,s.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,r,n)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function UD(t,e,r,n){let s=t.cursor(),i=[];if(!s.firstChild())return i;if(r!=null){for(let o=!1;!o;)if(o=s.type.is(r),!s.nextSibling())return i}for(;;){if(n!=null&&s.type.is(n))return i;if(s.type.is(e)&&i.push(s.node),!s.nextSibling())return n==null?i:[]}}function pS(t,e,r=e.length-1){for(let n=t;r>=0;n=n.parent){if(!n)return!1;if(!n.type.isAnonymous){if(e[r]&&e[r]!=n.name)return!1;r--}}return!0}class rCe{constructor(e,r,n,s){this.parent=e,this.buffer=r,this.index=n,this.start=s}}class ki extends h9{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,r,n){super(),this.context=e,this._parent=r,this.index=n,this.type=e.buffer.set.types[e.buffer.buffer[n]]}child(e,r,n){let{buffer:s}=this.context,i=s.findChild(this.index+4,s.buffer[this.index+3],e,r-this.context.start,n);return i<0?null:new ki(this.context,this,i)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,r,n=0){if(n&er.ExcludeBuffers)return null;let{buffer:s}=this.context,i=s.findChild(this.index+4,s.buffer[this.index+3],r>0?1:-1,e-this.context.start,r);return i<0?null:new ki(this.context,this,i)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,r=e.buffer[this.index+3];return r<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new ki(this.context,this._parent,r):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,r=this._parent?this._parent.index+4:0;return this.index==r?this.externalSibling(-1):new ki(this.context,this._parent,e.findChild(r,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],r=[],{buffer:n}=this.context,s=this.index+4,i=n.buffer[this.index+3];if(i>s){let o=n.buffer[this.index+1];e.push(n.slice(s,i,o)),r.push(0)}return new wr(this.type,e,r,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function d9(t){if(!t.length)return null;let e=0,r=t[0];for(let i=1;i<t.length;i++){let o=t[i];(o.from>r.from||o.to<r.to)&&(r=o,e=i)}let n=r instanceof Qr&&r.index<0?null:r.parent,s=t.slice();return n?s[e]=n:s.splice(e,1),new nCe(s,r)}class nCe{constructor(e,r){this.heads=e,this.node=r}get next(){return d9(this.heads)}}function sCe(t,e,r){let n=t.resolveInner(e,r),s=null;for(let i=n instanceof Qr?n:n.context.parent;i;i=i.parent)if(i.index<0){let o=i.parent;(s||(s=[n])).push(o.resolve(e,r)),i=o}else{let o=Df.get(i.tree);if(o&&o.overlay&&o.overlay[0].from<=e&&o.overlay[o.overlay.length-1].to>=e){let a=new Qr(o.tree,o.overlay[0].from+i.from,-1,i);(s||(s=[n])).push(Lf(a,e,r,!1))}}return s?d9(s):n}class D_{get name(){return this.type.name}constructor(e,r=0){if(this.mode=r,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Qr)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let n=e._parent;n;n=n._parent)this.stack.unshift(n.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,r){this.index=e;let{start:n,buffer:s}=this.buffer;return this.type=r||s.set.types[s.buffer[e]],this.from=n+s.buffer[e+1],this.to=n+s.buffer[e+2],!0}yield(e){return e?e instanceof Qr?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,r,n){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,r,n,this.mode));let{buffer:s}=this.buffer,i=s.findChild(this.index+4,s.buffer[this.index+3],e,r-this.buffer.start,n);return i<0?!1:(this.stack.push(this.index),this.yieldBuf(i))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,r,n=this.mode){return this.buffer?n&er.ExcludeBuffers?!1:this.enterChild(1,e,r):this.yield(this._tree.enter(e,r,n))}parent(){if(!this.buffer)return this.yieldNode(this.mode&er.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&er.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:r}=this.buffer,n=this.stack.length-1;if(e<0){let s=n<0?0:this.stack[n]+4;if(this.index!=s)return this.yieldBuf(r.findChild(s,this.index,-1,0,4))}else{let s=r.buffer[this.index+3];if(s<(n<0?r.buffer.length:r.buffer[this.stack[n]+3]))return this.yieldBuf(s)}return n<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let r,n,{buffer:s}=this;if(s){if(e>0){if(this.index<s.buffer.buffer.length)return!1}else for(let i=0;i<this.index;i++)if(s.buffer.buffer[i+3]<this.index)return!1;({index:r,parent:n}=s)}else({index:r,_parent:n}=this._tree);for(;n;{index:r,_parent:n}=n)if(r>-1)for(let i=r+e,o=e<0?-1:n._tree.children.length;i!=o;i+=e){let a=n._tree.children[i];if(this.mode&er.IncludeAnonymous||a instanceof Na||!a.type.isAnonymous||Zk(a))return!1}return!0}move(e,r){if(r&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,r=0){for(;(this.from==this.to||(r<1?this.from>=e:this.from>e)||(r>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,r););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,r=null,n=0;if(e&&e.context==this.buffer)e:for(let s=this.index,i=this.stack.length;i>=0;){for(let o=e;o;o=o._parent)if(o.index==s){if(s==this.index)return o;r=o,n=i+1;break e}s=this.stack[--i]}for(let s=n;s<this.stack.length;s++)r=new ki(this.buffer,r,this.stack[s]);return this.bufferNode=new ki(this.buffer,r,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,r){for(let n=0;;){let s=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){n++;continue}this.type.isAnonymous||(s=!0)}for(;;){if(s&&r&&r(this),s=this.type.isAnonymous,!n)return;if(this.nextSibling())break;this.parent(),n--,s=!0}}}matchContext(e){if(!this.buffer)return pS(this.node.parent,e);let{buffer:r}=this.buffer,{types:n}=r.set;for(let s=e.length-1,i=this.stack.length-1;s>=0;i--){if(i<0)return pS(this._tree,e,s);let o=n[r.buffer[this.stack[i]]];if(!o.isAnonymous){if(e[s]&&e[s]!=o.name)return!1;s--}}return!0}}function Zk(t){return t.children.some(e=>e instanceof Na||!e.type.isAnonymous||Zk(e))}function iCe(t){var e;let{buffer:r,nodeSet:n,maxBufferLength:s=QTe,reused:i=[],minRepeatType:o=n.types.length}=t,a=Array.isArray(r)?new Xk(r,r.length):r,l=n.types,c=0,u=0;function h(w,E,S,x,C,A){let{id:M,start:P,end:D,size:R}=a,G=u,ee=c;for(;R<0;)if(a.next(),R==-1){let $=i[M];S.push($),x.push(P-w);return}else if(R==-3){c=M;return}else if(R==-4){u=M;return}else throw new RangeError(`Unrecognized record size: ${R}`);let q=l[M],re,N,B=P-w;if(D-P<=s&&(N=m(a.pos-E,C))){let $=new Uint16Array(N.size-N.skip),H=a.pos-N.size,U=$.length;for(;a.pos>H;)U=p(N.start,$,U);re=new Na($,D-N.start,n),B=N.start-w}else{let $=a.pos-R;a.next();let H=[],U=[],Q=M>=o?M:-1,ne=0,ge=D;for(;a.pos>$;)Q>=0&&a.id==Q&&a.size>=0?(a.end<=ge-s&&(g(H,U,P,ne,a.end,ge,Q,G,ee),ne=H.length,ge=a.end),a.next()):A>2500?d(P,$,H,U):h(P,$,H,U,Q,A+1);if(Q>=0&&ne>0&&ne<H.length&&g(H,U,P,ne,P,ge,Q,G,ee),H.reverse(),U.reverse(),Q>-1&&ne>0){let J=f(q,ee);re=Jk(q,H,U,0,H.length,0,D-P,J,J)}else re=_(q,H,U,D-P,G-D,ee)}S.push(re),x.push(B)}function d(w,E,S,x){let C=[],A=0,M=-1;for(;a.pos>E;){let{id:P,start:D,end:R,size:G}=a;if(G>4)a.next();else{if(M>-1&&D<M)break;M<0&&(M=R-s),C.push(P,D,R),A++,a.next()}}if(A){let P=new Uint16Array(A*4),D=C[C.length-2];for(let R=C.length-3,G=0;R>=0;R-=3)P[G++]=C[R],P[G++]=C[R+1]-D,P[G++]=C[R+2]-D,P[G++]=G;S.push(new Na(P,C[2]-D,n)),x.push(D-w)}}function f(w,E){return(S,x,C)=>{let A=0,M=S.length-1,P,D;if(M>=0&&(P=S[M])instanceof wr){if(!M&&P.type==w&&P.length==C)return P;(D=P.prop(mt.lookAhead))&&(A=x[M]+P.length+D)}return _(w,S,x,C,A,E)}}function g(w,E,S,x,C,A,M,P,D){let R=[],G=[];for(;w.length>x;)R.push(w.pop()),G.push(E.pop()+S-C);w.push(_(n.types[M],R,G,A-C,P-A,D)),E.push(C-S)}function _(w,E,S,x,C,A,M){if(A){let P=[mt.contextHash,A];M=M?[P].concat(M):[P]}if(C>25){let P=[mt.lookAhead,C];M=M?[P].concat(M):[P]}return new wr(w,E,S,x,M)}function m(w,E){let S=a.fork(),x=0,C=0,A=0,M=S.end-s,P={size:0,start:0,skip:0};e:for(let D=S.pos-w;S.pos>D;){let R=S.size;if(S.id==E&&R>=0){P.size=x,P.start=C,P.skip=A,A+=4,x+=4,S.next();continue}let G=S.pos-R;if(R<0||G<D||S.start<M)break;let ee=S.id>=o?4:0,q=S.start;for(S.next();S.pos>G;){if(S.size<0)if(S.size==-3)ee+=4;else break e;else S.id>=o&&(ee+=4);S.next()}C=q,x+=R,A+=ee}return(E<0||x==w)&&(P.size=x,P.start=C,P.skip=A),P.size>4?P:void 0}function p(w,E,S){let{id:x,start:C,end:A,size:M}=a;if(a.next(),M>=0&&x<o){let P=S;if(M>4){let D=a.pos-(M-4);for(;a.pos>D;)S=p(w,E,S)}E[--S]=P,E[--S]=A-w,E[--S]=C-w,E[--S]=x}else M==-3?c=x:M==-4&&(u=x);return S}let y=[],b=[];for(;a.pos>0;)h(t.start||0,t.bufferStart||0,y,b,-1,0);let v=(e=t.length)!==null&&e!==void 0?e:y.length?b[0]+y[0].length:0;return new wr(l[t.topID],y.reverse(),b.reverse(),v)}const $D=new WeakMap;function h0(t,e){if(!t.isAnonymous||e instanceof Na||e.type!=t)return 1;let r=$D.get(e);if(r==null){r=1;for(let n of e.children){if(n.type!=t||!(n instanceof wr)){r=1;break}r+=h0(t,n)}$D.set(e,r)}return r}function Jk(t,e,r,n,s,i,o,a,l){let c=0;for(let g=n;g<s;g++)c+=h0(t,e[g]);let u=Math.ceil(c*1.5/8),h=[],d=[];function f(g,_,m,p,y){for(let b=m;b<p;){let v=b,w=_[b],E=h0(t,g[b]);for(b++;b<p;b++){let S=h0(t,g[b]);if(E+S>=u)break;E+=S}if(b==v+1){if(E>u){let S=g[v];f(S.children,S.positions,0,S.children.length,_[v]+y);continue}h.push(g[v])}else{let S=_[b-1]+g[b-1].length-w;h.push(Jk(t,g,_,v,b,w,S,null,l))}d.push(w+y-i)}}return f(e,r,n,s,0),(a||l)(h,d,o)}class o9e{constructor(){this.map=new WeakMap}setBuffer(e,r,n){let s=this.map.get(e);s||this.map.set(e,s=new Map),s.set(r,n)}getBuffer(e,r){let n=this.map.get(e);return n&&n.get(r)}set(e,r){e instanceof ki?this.setBuffer(e.context.buffer,e.index,r):e instanceof Qr&&this.map.set(e.tree,r)}get(e){return e instanceof ki?this.getBuffer(e.context.buffer,e.index):e instanceof Qr?this.map.get(e.tree):void 0}cursorSet(e,r){e.buffer?this.setBuffer(e.buffer.buffer,e.index,r):this.map.set(e.tree,r)}cursorGet(e){return e.buffer?this.getBuffer(e.buffer.buffer,e.index):this.map.get(e.tree)}}class bo{constructor(e,r,n,s,i=!1,o=!1){this.from=e,this.to=r,this.tree=n,this.offset=s,this.open=(i?1:0)|(o?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,r=[],n=!1){let s=[new bo(0,e.length,e,0,!1,n)];for(let i of r)i.to>e.length&&s.push(i);return s}static applyChanges(e,r,n=128){if(!r.length)return e;let s=[],i=1,o=e.length?e[0]:null;for(let a=0,l=0,c=0;;a++){let u=a<r.length?r[a]:null,h=u?u.fromA:1e9;if(h-l>=n)for(;o&&o.from<h;){let d=o;if(l>=d.from||h<=d.to||c){let f=Math.max(d.from,l)-c,g=Math.min(d.to,h)-c;d=f>=g?null:new bo(f,g,d.tree,d.offset+c,a>0,!!u)}if(d&&s.push(d),o.to>h)break;o=i<e.length?e[i++]:null}if(!u)break;l=u.toA,c=u.toA-u.toB}return s}}class oCe{startParse(e,r,n){return typeof e=="string"&&(e=new aCe(e)),n=n?n.length?n.map(s=>new ms(s.from,s.to)):[new ms(0,0)]:[new ms(0,e.length)],this.createParse(e,r||[],n)}parse(e,r,n){let s=this.startParse(e,r,n);for(;;){let i=s.advance();if(i)return i}}}class aCe{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,r){return this.string.slice(e,r)}}function a9e(t){return(e,r,n,s)=>new cCe(e,t,r,n,s)}class HD{constructor(e,r,n,s,i){this.parser=e,this.parse=r,this.overlay=n,this.target=s,this.from=i}}function zD(t){if(!t.length||t.some(e=>e.from>=e.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(t))}class lCe{constructor(e,r,n,s,i,o,a){this.parser=e,this.predicate=r,this.mounts=n,this.index=s,this.start=i,this.target=o,this.prev=a,this.depth=0,this.ranges=[]}}const mS=new mt({perNode:!0});class cCe{constructor(e,r,n,s,i){this.nest=r,this.input=n,this.fragments=s,this.ranges=i,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=e}advance(){if(this.baseParse){let n=this.baseParse.advance();if(!n)return null;if(this.baseParse=null,this.baseTree=n,this.startInner(),this.stoppedAt!=null)for(let s of this.inner)s.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let n=this.baseTree;return this.stoppedAt!=null&&(n=new wr(n.type,n.children,n.positions,n.length,n.propValues.concat([[mS,this.stoppedAt]]))),n}let e=this.inner[this.innerDone],r=e.parse.advance();if(r){this.innerDone++;let n=Object.assign(Object.create(null),e.target.props);n[mt.mounted.id]=new Df(r,e.overlay,e.parser),e.target.props=n}return null}get parsedPos(){if(this.baseParse)return 0;let e=this.input.length;for(let r=this.innerDone;r<this.inner.length;r++)this.inner[r].from<e&&(e=Math.min(e,this.inner[r].parse.parsedPos));return e}stopAt(e){if(this.stoppedAt=e,this.baseParse)this.baseParse.stopAt(e);else for(let r=this.innerDone;r<this.inner.length;r++)this.inner[r].parse.stopAt(e)}startInner(){let e=new dCe(this.fragments),r=null,n=null,s=new D_(new Qr(this.baseTree,this.ranges[0].from,0,null),er.IncludeAnonymous|er.IgnoreMounts);e:for(let i,o;;){let a=!0,l;if(this.stoppedAt!=null&&s.from>=this.stoppedAt)a=!1;else if(e.hasNode(s)){if(r){let c=r.mounts.find(u=>u.frag.from<=s.from&&u.frag.to>=s.to&&u.mount.overlay);if(c)for(let u of c.mount.overlay){let h=u.from+c.pos,d=u.to+c.pos;h>=s.from&&d<=s.to&&!r.ranges.some(f=>f.from<d&&f.to>h)&&r.ranges.push({from:h,to:d})}}a=!1}else if(n&&(o=uCe(n.ranges,s.from,s.to)))a=o!=2;else if(!s.type.isAnonymous&&(i=this.nest(s,this.input))&&(s.from<s.to||!i.overlay)){s.tree||hCe(s);let c=e.findMounts(s.from,i.parser);if(typeof i.overlay=="function")r=new lCe(i.parser,i.overlay,c,this.inner.length,s.from,s.tree,r);else{let u=WD(this.ranges,i.overlay||(s.from<s.to?[new ms(s.from,s.to)]:[]));u.length&&zD(u),(u.length||!i.overlay)&&this.inner.push(new HD(i.parser,u.length?i.parser.startParse(this.input,qD(c,u),u):i.parser.startParse(""),i.overlay?i.overlay.map(h=>new ms(h.from-s.from,h.to-s.from)):null,s.tree,u.length?u[0].from:s.from)),i.overlay?u.length&&(n={ranges:u,depth:0,prev:n}):a=!1}}else if(r&&(l=r.predicate(s))&&(l===!0&&(l=new ms(s.from,s.to)),l.from<l.to)){let c=r.ranges.length-1;c>=0&&r.ranges[c].to==l.from?r.ranges[c]={from:r.ranges[c].from,to:l.to}:r.ranges.push(l)}if(a&&s.firstChild())r&&r.depth++,n&&n.depth++;else for(;!s.nextSibling();){if(!s.parent())break e;if(r&&!--r.depth){let c=WD(this.ranges,r.ranges);c.length&&(zD(c),this.inner.splice(r.index,0,new HD(r.parser,r.parser.startParse(this.input,qD(r.mounts,c),c),r.ranges.map(u=>new ms(u.from-r.start,u.to-r.start)),r.target,c[0].from))),r=r.prev}n&&!--n.depth&&(n=n.prev)}}}}function uCe(t,e,r){for(let n of t){if(n.from>=r)break;if(n.to>e)return n.from<=e&&n.to>=r?2:1}return 0}function VD(t,e,r,n,s,i){if(e<r){let o=t.buffer[e+1];n.push(t.slice(e,r,o)),s.push(o-i)}}function hCe(t){let{node:e}=t,r=[],n=e.context.buffer;do r.push(t.index),t.parent();while(!t.tree);let s=t.tree,i=s.children.indexOf(n),o=s.children[i],a=o.buffer,l=[i];function c(u,h,d,f,g,_){let m=r[_],p=[],y=[];VD(o,u,m,p,y,f);let b=a[m+1],v=a[m+2];l.push(p.length);let w=_?c(m+4,a[m+3],o.set.types[a[m]],b,v-b,_-1):e.toTree();return p.push(w),y.push(b-f),VD(o,a[m+3],h,p,y,f),new wr(d,p,y,g)}s.children[i]=c(0,a.length,Mn.none,0,o.length,r.length-1);for(let u of l){let h=t.tree.children[u],d=t.tree.positions[u];t.yield(new Qr(h,d+t.from,u,t._tree))}}class GD{constructor(e,r){this.offset=r,this.done=!1,this.cursor=e.cursor(er.IncludeAnonymous|er.IgnoreMounts)}moveTo(e){let{cursor:r}=this,n=e-this.offset;for(;!this.done&&r.from<n;)r.to>=e&&r.enter(n,1,er.IgnoreOverlays|er.ExcludeBuffers)||r.next(!1)||(this.done=!0)}hasNode(e){if(this.moveTo(e.from),!this.done&&this.cursor.from+this.offset==e.from&&this.cursor.tree)for(let r=this.cursor.tree;;){if(r==e.tree)return!0;if(r.children.length&&r.positions[0]==0&&r.children[0]instanceof wr)r=r.children[0];else break}return!1}}class dCe{constructor(e){var r;if(this.fragments=e,this.curTo=0,this.fragI=0,e.length){let n=this.curFrag=e[0];this.curTo=(r=n.tree.prop(mS))!==null&&r!==void 0?r:n.to,this.inner=new GD(n.tree,-n.offset)}else this.curFrag=this.inner=null}hasNode(e){for(;this.curFrag&&e.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=e.from&&this.curTo>=e.to&&this.inner.hasNode(e)}nextFrag(){var e;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let r=this.curFrag=this.fragments[this.fragI];this.curTo=(e=r.tree.prop(mS))!==null&&e!==void 0?e:r.to,this.inner=new GD(r.tree,-r.offset)}}findMounts(e,r){var n;let s=[];if(this.inner){this.inner.cursor.moveTo(e,1);for(let i=this.inner.cursor.node;i;i=i.parent){let o=(n=i.tree)===null||n===void 0?void 0:n.prop(mt.mounted);if(o&&o.parser==r)for(let a=this.fragI;a<this.fragments.length;a++){let l=this.fragments[a];if(l.from>=i.to)break;l.tree==this.curFrag.tree&&s.push({frag:l,pos:i.from-l.offset,mount:o})}}}return s}}function WD(t,e){let r=null,n=e;for(let s=1,i=0;s<t.length;s++){let o=t[s-1].to,a=t[s].from;for(;i<n.length;i++){let l=n[i];if(l.from>=a)break;l.to<=o||(r||(n=r=e.slice()),l.from<o?(r[i]=new ms(l.from,o),l.to>a&&r.splice(i+1,0,new ms(a,l.to))):l.to>a?r[i--]=new ms(a,l.to):r.splice(i--,1))}}return n}function fCe(t,e,r,n){let s=0,i=0,o=!1,a=!1,l=-1e9,c=[];for(;;){let u=s==t.length?1e9:o?t[s].to:t[s].from,h=i==e.length?1e9:a?e[i].to:e[i].from;if(o!=a){let d=Math.max(l,r),f=Math.min(u,h,n);d<f&&c.push(new ms(d,f))}if(l=Math.min(u,h),l==1e9)break;u==l&&(o?(o=!1,s++):o=!0),h==l&&(a?(a=!1,i++):a=!0)}return c}function qD(t,e){let r=[];for(let{pos:n,mount:s,frag:i}of t){let o=n+(s.overlay?s.overlay[0].from:0),a=o+s.tree.length,l=Math.max(i.from,o),c=Math.min(i.to,a);if(s.overlay){let u=s.overlay.map(d=>new ms(d.from+n,d.to+n)),h=fCe(e,u,l,c);for(let d=0,f=l;;d++){let g=d==h.length,_=g?c:h[d].from;if(_>f&&r.push(new bo(f,_,s.tree,-o,i.from>=f||i.openStart,i.to<=_||i.openEnd)),g)break;f=h[d].to}}else r.push(new bo(l,c,s.tree,-o,i.from>=o||i.openStart,i.to<=a||i.openEnd))}return r}let pCe=0;class ps{constructor(e,r,n,s){this.name=e,this.set=r,this.base=n,this.modified=s,this.id=pCe++}toString(){let{name:e}=this;for(let r of this.modified)r.name&&(e=`${r.name}(${e})`);return e}static define(e,r){let n=typeof e=="string"?e:"?";if(e instanceof ps&&(r=e),r?.base)throw new Error("Can not derive from a modified tag");let s=new ps(n,[],null,[]);if(s.set.push(s),r)for(let i of r.set)s.set.push(i);return s}static defineModifier(e){let r=new L_(e);return n=>n.modified.indexOf(r)>-1?n:L_.get(n.base||n,n.modified.concat(r).sort((s,i)=>s.id-i.id))}}let mCe=0;class L_{constructor(e){this.name=e,this.instances=[],this.id=mCe++}static get(e,r){if(!r.length)return e;let n=r[0].instances.find(a=>a.base==e&&gCe(r,a.modified));if(n)return n;let s=[],i=new ps(e.name,s,e,r);for(let a of r)a.instances.push(i);let o=_Ce(r);for(let a of e.set)if(!a.modified.length)for(let l of o)s.push(L_.get(a,l));return i}}function gCe(t,e){return t.length==e.length&&t.every((r,n)=>r==e[n])}function _Ce(t){let e=[[]];for(let r=0;r<t.length;r++)for(let n=0,s=e.length;n<s;n++)e.push(e[n].concat(t[r]));return e.sort((r,n)=>n.length-r.length)}function yCe(t){let e=Object.create(null);for(let r in t){let n=t[r];Array.isArray(n)||(n=[n]);for(let s of r.split(" "))if(s){let i=[],o=2,a=s;for(let h=0;;){if(a=="..."&&h>0&&h+3==s.length){o=1;break}let d=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(a);if(!d)throw new RangeError("Invalid path: "+s);if(i.push(d[0]=="*"?"":d[0][0]=='"'?JSON.parse(d[0]):d[0]),h+=d[0].length,h==s.length)break;let f=s[h++];if(h==s.length&&f=="!"){o=0;break}if(f!="/")throw new RangeError("Invalid path: "+s);a=s.slice(h)}let l=i.length-1,c=i[l];if(!c)throw new RangeError("Invalid path: "+s);let u=new N_(n,o,l>0?i.slice(0,l):null);e[c]=u.sort(e[c])}}return f9.add(e)}const f9=new mt;let N_=class{constructor(e,r,n,s){this.tags=e,this.mode=r,this.context=n,this.next=s}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}};N_.empty=new N_([],2,null);function p9(t,e){let r=Object.create(null);for(let i of t)if(!Array.isArray(i.tag))r[i.tag.id]=i.class;else for(let o of i.tag)r[o.id]=i.class;let{scope:n,all:s=null}=e||{};return{style:i=>{let o=s;for(let a of i)for(let l of a.set){let c=r[l.id];if(c){o=o?o+" "+c:c;break}}return o},scope:n}}function bCe(t,e){let r=null;for(let n of t){let s=n.style(e);s&&(r=r?r+" "+s:s)}return r}function vCe(t,e,r,n=0,s=t.length){let i=new wCe(n,Array.isArray(e)?e:[e],r);i.highlightRange(t.cursor(),n,s,"",i.highlighters),i.flush(s)}class wCe{constructor(e,r,n){this.at=e,this.highlighters=r,this.span=n,this.class=""}startSpan(e,r){r!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=r)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,r,n,s,i){let{type:o,from:a,to:l}=e;if(a>=n||l<=r)return;o.isTop&&(i=this.highlighters.filter(f=>!f.scope||f.scope(o)));let c=s,u=ECe(e)||N_.empty,h=bCe(i,u.tags);if(h&&(c&&(c+=" "),c+=h,u.mode==1&&(s+=(s?" ":"")+h)),this.startSpan(Math.max(r,a),c),u.opaque)return;let d=e.tree&&e.tree.prop(mt.mounted);if(d&&d.overlay){let f=e.node.enter(d.overlay[0].from+a,1),g=this.highlighters.filter(m=>!m.scope||m.scope(d.tree.type)),_=e.firstChild();for(let m=0,p=a;;m++){let y=m<d.overlay.length?d.overlay[m]:null,b=y?y.from+a:l,v=Math.max(r,p),w=Math.min(n,b);if(v<w&&_)for(;e.from<w&&(this.highlightRange(e,v,w,s,i),this.startSpan(Math.min(w,e.to),c),!(e.to>=b||!e.nextSibling())););if(!y||b>n)break;p=y.to+a,p>r&&(this.highlightRange(f.cursor(),Math.max(r,y.from+a),Math.min(n,p),"",g),this.startSpan(Math.min(n,p),c))}_&&e.parent()}else if(e.firstChild()){d&&(s="");do if(!(e.to<=r)){if(e.from>=n)break;this.highlightRange(e,r,n,s,i),this.startSpan(Math.min(n,e.to),c)}while(e.nextSibling());e.parent()}}}function ECe(t){let e=t.type.prop(f9);for(;e&&e.context&&!t.matchContext(e.context);)e=e.next;return e||null}const $e=ps.define,pg=$e(),Zo=$e(),KD=$e(Zo),YD=$e(Zo),Jo=$e(),mg=$e(Jo),Nw=$e(Jo),ui=$e(),Xa=$e(ui),ni=$e(),si=$e(),gS=$e(),zh=$e(gS),gg=$e(),ue={comment:pg,lineComment:$e(pg),blockComment:$e(pg),docComment:$e(pg),name:Zo,variableName:$e(Zo),typeName:KD,tagName:$e(KD),propertyName:YD,attributeName:$e(YD),className:$e(Zo),labelName:$e(Zo),namespace:$e(Zo),macroName:$e(Zo),literal:Jo,string:mg,docString:$e(mg),character:$e(mg),attributeValue:$e(mg),number:Nw,integer:$e(Nw),float:$e(Nw),bool:$e(Jo),regexp:$e(Jo),escape:$e(Jo),color:$e(Jo),url:$e(Jo),keyword:ni,self:$e(ni),null:$e(ni),atom:$e(ni),unit:$e(ni),modifier:$e(ni),operatorKeyword:$e(ni),controlKeyword:$e(ni),definitionKeyword:$e(ni),moduleKeyword:$e(ni),operator:si,derefOperator:$e(si),arithmeticOperator:$e(si),logicOperator:$e(si),bitwiseOperator:$e(si),compareOperator:$e(si),updateOperator:$e(si),definitionOperator:$e(si),typeOperator:$e(si),controlOperator:$e(si),punctuation:gS,separator:$e(gS),bracket:zh,angleBracket:$e(zh),squareBracket:$e(zh),paren:$e(zh),brace:$e(zh),content:ui,heading:Xa,heading1:$e(Xa),heading2:$e(Xa),heading3:$e(Xa),heading4:$e(Xa),heading5:$e(Xa),heading6:$e(Xa),contentSeparator:$e(ui),list:$e(ui),quote:$e(ui),emphasis:$e(ui),strong:$e(ui),link:$e(ui),monospace:$e(ui),strikethrough:$e(ui),inserted:$e(),deleted:$e(),changed:$e(),invalid:$e(),meta:gg,documentMeta:$e(gg),annotation:$e(gg),processingInstruction:$e(gg),definition:ps.defineModifier("definition"),constant:ps.defineModifier("constant"),function:ps.defineModifier("function"),standard:ps.defineModifier("standard"),local:ps.defineModifier("local"),special:ps.defineModifier("special")};for(let t in ue){let e=ue[t];e instanceof ps&&(e.name=t)}p9([{tag:ue.link,class:"tok-link"},{tag:ue.heading,class:"tok-heading"},{tag:ue.emphasis,class:"tok-emphasis"},{tag:ue.strong,class:"tok-strong"},{tag:ue.keyword,class:"tok-keyword"},{tag:ue.atom,class:"tok-atom"},{tag:ue.bool,class:"tok-bool"},{tag:ue.url,class:"tok-url"},{tag:ue.labelName,class:"tok-labelName"},{tag:ue.inserted,class:"tok-inserted"},{tag:ue.deleted,class:"tok-deleted"},{tag:ue.literal,class:"tok-literal"},{tag:ue.string,class:"tok-string"},{tag:ue.number,class:"tok-number"},{tag:[ue.regexp,ue.escape,ue.special(ue.string)],class:"tok-string2"},{tag:ue.variableName,class:"tok-variableName"},{tag:ue.local(ue.variableName),class:"tok-variableName tok-local"},{tag:ue.definition(ue.variableName),class:"tok-variableName tok-definition"},{tag:ue.special(ue.variableName),class:"tok-variableName2"},{tag:ue.definition(ue.propertyName),class:"tok-propertyName tok-definition"},{tag:ue.typeName,class:"tok-typeName"},{tag:ue.namespace,class:"tok-namespace"},{tag:ue.className,class:"tok-className"},{tag:ue.macroName,class:"tok-macroName"},{tag:ue.propertyName,class:"tok-propertyName"},{tag:ue.operator,class:"tok-operator"},{tag:ue.comment,class:"tok-comment"},{tag:ue.meta,class:"tok-meta"},{tag:ue.invalid,class:"tok-invalid"},{tag:ue.punctuation,class:"tok-punctuation"}]);var Mw;const Gc=new mt;function xCe(t){return We.define({combine:t?e=>e.concat(t):void 0})}const SCe=new mt;class Ns{constructor(e,r,n=[],s=""){this.data=e,this.name=s,vt.prototype.hasOwnProperty("tree")||Object.defineProperty(vt.prototype,"tree",{get(){return zr(this)}}),this.parser=r,this.extension=[Ma.of(this),vt.languageData.of((i,o,a)=>{let l=XD(i,o,a),c=l.type.prop(Gc);if(!c)return[];let u=i.facet(c),h=l.type.prop(SCe);if(h){let d=l.resolve(o-l.from,a);for(let f of h)if(f.test(d,i)){let g=i.facet(f.facet);return f.type=="replace"?g:g.concat(u)}}return u})].concat(n)}isActiveAt(e,r,n=-1){return XD(e,r,n).type.prop(Gc)==this.data}findRegions(e){let r=e.facet(Ma);if(r?.data==this.data)return[{from:0,to:e.doc.length}];if(!r||!r.allowsNesting)return[];let n=[],s=(i,o)=>{if(i.prop(Gc)==this.data){n.push({from:o,to:o+i.length});return}let a=i.prop(mt.mounted);if(a){if(a.tree.prop(Gc)==this.data){if(a.overlay)for(let l of a.overlay)n.push({from:l.from+o,to:l.to+o});else n.push({from:o,to:o+i.length});return}else if(a.overlay){let l=n.length;if(s(a.tree,a.overlay[0].from+o),n.length>l)return}}for(let l=0;l<i.children.length;l++){let c=i.children[l];c instanceof wr&&s(c,i.positions[l]+o)}};return s(zr(e),0),n}get allowsNesting(){return!0}}Ns.setState=ht.define();function XD(t,e,r){let n=t.facet(Ma),s=zr(t).topNode;if(!n||n.allowsNesting)for(let i=s;i;i=i.enter(e,r,er.ExcludeBuffers))i.type.isTop&&(s=i);return s}class _S extends Ns{constructor(e,r,n){super(e,r,[],n),this.parser=r}static define(e){let r=xCe(e.languageData);return new _S(r,e.parser.configure({props:[Gc.add(n=>n.isTop?r:void 0)]}),e.name)}configure(e,r){return new _S(this.data,this.parser.configure(e),r||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function zr(t){let e=t.field(Ns.state,!1);return e?e.tree:wr.empty}class TCe{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,r){let n=this.cursorPos-this.string.length;return e<n||r>=this.cursorPos?this.doc.sliceString(e,r):this.string.slice(e-n,r-n)}}let Vh=null;class M_{constructor(e,r,n=[],s,i,o,a,l){this.parser=e,this.state=r,this.fragments=n,this.tree=s,this.treeLen=i,this.viewport=o,this.skipped=a,this.scheduleOn=l,this.parse=null,this.tempSkipped=[]}static create(e,r,n){return new M_(e,r,[],wr.empty,0,n,[],null)}startParse(){return this.parser.startParse(new TCe(this.state.doc),this.fragments)}work(e,r){return r!=null&&r>=this.state.doc.length&&(r=void 0),this.tree!=wr.empty&&this.isDone(r??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var n;if(typeof e=="number"){let s=Date.now()+e;e=()=>Date.now()>s}for(this.parse||(this.parse=this.startParse()),r!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>r)&&r<this.state.doc.length&&this.parse.stopAt(r);;){let s=this.parse.advance();if(s)if(this.fragments=this.withoutTempSkipped(bo.addTree(s,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(n=this.parse.stoppedAt)!==null&&n!==void 0?n:this.state.doc.length,this.tree=s,this.parse=null,this.treeLen<(r??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,r;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(r=this.parse.advance()););}),this.treeLen=e,this.tree=r,this.fragments=this.withoutTempSkipped(bo.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let r=Vh;Vh=this;try{return e()}finally{Vh=r}}withoutTempSkipped(e){for(let r;r=this.tempSkipped.pop();)e=ZD(e,r.from,r.to);return e}changes(e,r){let{fragments:n,tree:s,treeLen:i,viewport:o,skipped:a}=this;if(this.takeTree(),!e.empty){let l=[];if(e.iterChangedRanges((c,u,h,d)=>l.push({fromA:c,toA:u,fromB:h,toB:d})),n=bo.applyChanges(n,l),s=wr.empty,i=0,o={from:e.mapPos(o.from,-1),to:e.mapPos(o.to,1)},this.skipped.length){a=[];for(let c of this.skipped){let u=e.mapPos(c.from,1),h=e.mapPos(c.to,-1);u<h&&a.push({from:u,to:h})}}}return new M_(this.parser,r,n,s,i,o,a,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let r=this.skipped.length;for(let n=0;n<this.skipped.length;n++){let{from:s,to:i}=this.skipped[n];s<e.to&&i>e.from&&(this.fragments=ZD(this.fragments,s,i),this.skipped.splice(n--,1))}return this.skipped.length>=r?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,r){this.skipped.push({from:e,to:r})}static getSkippingParser(e){return new class extends oCe{createParse(r,n,s){let i=s[0].from,o=s[s.length-1].to;return{parsedPos:i,advance(){let l=Vh;if(l){for(let c of s)l.tempSkipped.push(c);e&&(l.scheduleOn=l.scheduleOn?Promise.all([l.scheduleOn,e]):e)}return this.parsedPos=o,new wr(Mn.none,[],[],o-i)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let r=this.fragments;return this.treeLen>=e&&r.length&&r[0].from==0&&r[0].to>=e}static get(){return Vh}}function ZD(t,e,r){return bo.applyChanges(t,[{fromA:e,toA:r,fromB:e,toB:r}])}class Bu{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let r=this.context.changes(e.changes,e.state),n=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),r.viewport.to);return r.work(20,n)||r.takeTree(),new Bu(r)}static init(e){let r=Math.min(3e3,e.doc.length),n=M_.create(e.facet(Ma).parser,e,{from:0,to:r});return n.work(20,r)||n.takeTree(),new Bu(n)}}Ns.state=Pr.define({create:Bu.init,update(t,e){for(let r of e.effects)if(r.is(Ns.setState))return r.value;return e.startState.facet(Ma)!=e.state.facet(Ma)?Bu.init(e.state):t.apply(e)}});let m9=t=>{let e=setTimeout(()=>t(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(m9=t=>{let e=-1,r=setTimeout(()=>{e=requestIdleCallback(t,{timeout:400})},100);return()=>e<0?clearTimeout(r):cancelIdleCallback(e)});const Bw=typeof navigator<"u"&&(!((Mw=navigator.scheduling)===null||Mw===void 0)&&Mw.isInputPending)?()=>navigator.scheduling.isInputPending():null,CCe=Hr.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let r=this.view.state.field(Ns.state).context;(r.updateViewport(e.view.viewport)||this.view.viewport.to>r.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(r)}scheduleWork(){if(this.working)return;let{state:e}=this.view,r=e.field(Ns.state);(r.tree!=r.context.tree||!r.context.isDone(e.doc.length))&&(this.working=m9(this.work))}work(e){this.working=null;let r=Date.now();if(this.chunkEnd<r&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=r+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:n,viewport:{to:s}}=this.view,i=n.field(Ns.state);if(i.tree==i.context.tree&&i.context.isDone(s+1e5))return;let o=Date.now()+Math.min(this.chunkBudget,100,e&&!Bw?Math.max(25,e.timeRemaining()-5):1e9),a=i.context.treeLen<s&&n.doc.length>s+1e3,l=i.context.work(()=>Bw&&Bw()||Date.now()>o,s+(a?0:1e5));this.chunkBudget-=Date.now()-r,(l||this.chunkBudget<=0)&&(i.context.takeTree(),this.view.dispatch({effects:Ns.setState.of(new Bu(i.context))})),this.chunkBudget>0&&!(l&&!a)&&this.scheduleWork(),this.checkAsyncSchedule(i.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(r=>Wn(this.view.state,r)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ma=We.define({combine(t){return t.length?t[0]:null},enables:t=>[Ns.state,CCe,Ge.contentAttributes.compute([t],e=>{let r=e.facet(t);return r&&r.name?{"data-language":r.name}:{}})]});class u9e{constructor(e,r=[]){this.language=e,this.support=r,this.extension=[e,r]}}class Lr{constructor(e,r,n,s,i,o=void 0){this.name=e,this.alias=r,this.extensions=n,this.filename=s,this.loadFunc=i,this.support=o,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(e=>this.support=e,e=>{throw this.loading=null,e}))}static of(e){let{load:r,support:n}=e;if(!r){if(!n)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");r=()=>Promise.resolve(n)}return new Lr(e.name,(e.alias||[]).concat(e.name).map(s=>s.toLowerCase()),e.extensions||[],e.filename,r,n)}static matchFilename(e,r){for(let s of e)if(s.filename&&s.filename.test(r))return s;let n=/\.([^.]+)$/.exec(r);if(n){for(let s of e)if(s.extensions.indexOf(n[1])>-1)return s}return null}static matchLanguageName(e,r,n=!0){r=r.toLowerCase();for(let s of e)if(s.alias.some(i=>i==r))return s;if(n)for(let s of e)for(let i of s.alias){let o=r.indexOf(i);if(o>-1&&(i.length>2||!/\w/.test(r[o-1])&&!/\w/.test(r[o+i.length])))return s}return null}}const kCe=We.define(),fh=We.define({combine:t=>{if(!t.length)return"  ";let e=t[0];if(!e||/\S/.test(e)||Array.from(e).some(r=>r!=e[0]))throw new Error("Invalid indent unit: "+JSON.stringify(t[0]));return e}});function B_(t){let e=t.facet(fh);return e.charCodeAt(0)==9?t.tabSize*e.length:e.length}function Nf(t,e){let r="",n=t.tabSize,s=t.facet(fh)[0];if(s=="	"){for(;e>=n;)r+="	",e-=n;s=" "}for(let i=0;i<e;i++)r+=s;return r}function Qk(t,e){t instanceof vt&&(t=new Db(t));for(let n of t.state.facet(kCe)){let s=n(t,e);if(s!==void 0)return s}let r=zr(t.state);return r.length>=e?RCe(t,r,e):null}class Db{constructor(e,r={}){this.state=e,this.options=r,this.unit=B_(e)}lineAt(e,r=1){let n=this.state.doc.lineAt(e),{simulateBreak:s,simulateDoubleBreak:i}=this.options;return s!=null&&s>=n.from&&s<=n.to?i&&s==e?{text:"",from:e}:(r<0?s<e:s<=e)?{text:n.text.slice(s-n.from),from:s}:{text:n.text.slice(0,s-n.from),from:n.from}:n}textAfterPos(e,r=1){if(this.options.simulateDoubleBreak&&e==this.options.simulateBreak)return"";let{text:n,from:s}=this.lineAt(e,r);return n.slice(e-s,Math.min(n.length,e+100-s))}column(e,r=1){let{text:n,from:s}=this.lineAt(e,r),i=this.countColumn(n,e-s),o=this.options.overrideIndentation?this.options.overrideIndentation(s):-1;return o>-1&&(i+=o-this.countColumn(n,n.search(/\S|$/))),i}countColumn(e,r=e.length){return kb(e,this.state.tabSize,r)}lineIndent(e,r=1){let{text:n,from:s}=this.lineAt(e,r),i=this.options.overrideIndentation;if(i){let o=i(s);if(o>-1)return o}return this.countColumn(n,n.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const ACe=new mt;function RCe(t,e,r){let n=e.resolveStack(r),s=n.node.enterUnfinishedNodesBefore(r);if(s!=n.node){let i=[];for(let o=s;o!=n.node;o=o.parent)i.push(o);for(let o=i.length-1;o>=0;o--)n={node:i[o],next:n}}return g9(n,t,r)}function g9(t,e,r){for(let n=t;n;n=n.next){let s=PCe(n.node);if(s)return s(eA.create(e,r,n))}return 0}function ICe(t){return t.pos==t.options.simulateBreak&&t.options.simulateDoubleBreak}function PCe(t){let e=t.type.prop(ACe);if(e)return e;let r=t.firstChild,n;if(r&&(n=r.type.prop(mt.closedBy))){let s=t.lastChild,i=s&&n.indexOf(s.name)>-1;return o=>_9(o,!0,1,void 0,i&&!ICe(o)?s.from:void 0)}return t.parent==null?OCe:null}function OCe(){return 0}class eA extends Db{constructor(e,r,n){super(e.state,e.options),this.base=e,this.pos=r,this.context=n}get node(){return this.context.node}static create(e,r,n){return new eA(e,r,n)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(e){let r=this.state.doc.lineAt(e.from);for(;;){let n=e.resolve(r.from);for(;n.parent&&n.parent.from==n.from;)n=n.parent;if(DCe(n,e))break;r=this.state.doc.lineAt(n.from)}return this.lineIndent(r.from)}continue(){return g9(this.context.next,this.base,this.pos)}}function DCe(t,e){for(let r=e;r;r=r.parent)if(t==r)return!0;return!1}function LCe(t){let e=t.node,r=e.childAfter(e.from),n=e.lastChild;if(!r)return null;let s=t.options.simulateBreak,i=t.state.doc.lineAt(r.from),o=s==null||s<=i.from?i.to:Math.min(i.to,s);for(let a=r.to;;){let l=e.childAfter(a);if(!l||l==n)return null;if(!l.type.isSkipped){if(l.from>=o)return null;let c=/^ */.exec(i.text.slice(r.to-i.from))[0].length;return{from:r.from,to:r.to+c}}a=l.to}}function h9e({closing:t,align:e=!0,units:r=1}){return n=>_9(n,e,r,t)}function _9(t,e,r,n,s){let i=t.textAfter,o=i.match(/^\s*/)[0].length,a=n&&i.slice(o,o+n.length)==n||s==t.pos+o,l=e?LCe(t):null;return l?a?t.column(l.from):t.column(l.to):t.baseIndent+(a?0:t.unit*r)}const d9e=t=>t.baseIndent;function f9e({except:t,units:e=1}={}){return r=>{let n=t&&t.test(r.textAfter);return r.baseIndent+(n?0:e*r.unit)}}const NCe=200;function MCe(){return vt.transactionFilter.of(t=>{if(!t.docChanged||!t.isUserEvent("input.type")&&!t.isUserEvent("input.complete"))return t;let e=t.startState.languageDataAt("indentOnInput",t.startState.selection.main.head);if(!e.length)return t;let r=t.newDoc,{head:n}=t.newSelection.main,s=r.lineAt(n);if(n>s.from+NCe)return t;let i=r.sliceString(s.from,n);if(!e.some(c=>c.test(i)))return t;let{state:o}=t,a=-1,l=[];for(let{head:c}of o.selection.ranges){let u=o.doc.lineAt(c);if(u.from==a)continue;a=u.from;let h=Qk(o,u.from);if(h==null)continue;let d=/^\s*/.exec(u.text)[0],f=Nf(o,h);d!=f&&l.push({from:u.from,to:u.from+d.length,insert:f})}return l.length?[t,{changes:l,sequential:!0}]:t})}const BCe=We.define(),FCe=new mt;function p9e(t){let e=t.firstChild,r=t.lastChild;return e&&e.to<r.from?{from:e.to,to:r.type.isError?t.to:r.from}:null}function jCe(t,e,r){let n=zr(t);if(n.length<r)return null;let s=n.resolveStack(r,1),i=null;for(let o=s;o;o=o.next){let a=o.node;if(a.to<=r||a.from>r)continue;if(i&&a.from<e)break;let l=a.type.prop(FCe);if(l&&(a.to<n.length-50||n.length==t.doc.length||!UCe(a))){let c=l(a,t);c&&c.from<=r&&c.from>=e&&c.to>r&&(i=c)}}return i}function UCe(t){let e=t.lastChild;return e&&e.to==t.to&&e.type.isError}function JD(t,e,r){for(let n of t.facet(BCe)){let s=n(t,e,r);if(s)return s}return jCe(t,e,r)}function y9(t,e){let r=e.mapPos(t.from,1),n=e.mapPos(t.to,-1);return r>=n?void 0:{from:r,to:n}}const b9=ht.define({map:y9}),tA=ht.define({map:y9}),F_=Pr.define({create(){return yt.none},update(t,e){t=t.map(e.changes);for(let r of e.effects)if(r.is(b9)&&!$Ce(t,r.value.from,r.value.to)){let{preparePlaceholder:n}=e.state.facet(v9),s=n?yt.replace({widget:new VCe(n(e.state,r.value))}):QD;t=t.update({add:[s.range(r.value.from,r.value.to)]})}else r.is(tA)&&(t=t.update({filter:(n,s)=>r.value.from!=n||r.value.to!=s,filterFrom:r.value.from,filterTo:r.value.to}));if(e.selection){let r=!1,{head:n}=e.selection.main;t.between(n,n,(s,i)=>{s<n&&i>n&&(r=!0)}),r&&(t=t.update({filterFrom:n,filterTo:n,filter:(s,i)=>i<=n||s>=n}))}return t},provide:t=>Ge.decorations.from(t),toJSON(t,e){let r=[];return t.between(0,e.doc.length,(n,s)=>{r.push(n,s)}),r},fromJSON(t){if(!Array.isArray(t)||t.length%2)throw new RangeError("Invalid JSON for fold state");let e=[];for(let r=0;r<t.length;){let n=t[r++],s=t[r++];if(typeof n!="number"||typeof s!="number")throw new RangeError("Invalid JSON for fold state");e.push(QD.range(n,s))}return yt.set(e,!0)}});function yS(t,e,r){var n;let s=null;return(n=t.field(F_,!1))===null||n===void 0||n.between(e,r,(i,o)=>{(!s||s.from>i)&&(s={from:i,to:o})}),s}function $Ce(t,e,r){let n=!1;return t.between(e,e,(s,i)=>{s==e&&i==r&&(n=!0)}),n}const HCe={placeholderDOM:null,preparePlaceholder:null,placeholderText:"…"},v9=We.define({combine(t){return ac(t,HCe)}});function zCe(t){return[F_,qCe]}function w9(t,e){let{state:r}=t,n=r.facet(v9),s=o=>{let a=t.lineBlockAt(t.posAtDOM(o.target)),l=yS(t.state,a.from,a.to);l&&t.dispatch({effects:tA.of(l)}),o.preventDefault()};if(n.placeholderDOM)return n.placeholderDOM(t,s,e);let i=document.createElement("span");return i.textContent=n.placeholderText,i.setAttribute("aria-label",r.phrase("folded code")),i.title=r.phrase("unfold"),i.className="cm-foldPlaceholder",i.onclick=s,i}const QD=yt.replace({widget:new class extends dh{toDOM(t){return w9(t,null)}}});class VCe extends dh{constructor(e){super(),this.value=e}eq(e){return this.value==e.value}toDOM(e){return w9(e,this.value)}}const GCe={openText:"⌄",closedText:"›",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class Fw extends ko{constructor(e,r){super(),this.config=e,this.open=r}eq(e){return this.config==e.config&&this.open==e.open}toDOM(e){if(this.config.markerDOM)return this.config.markerDOM(this.open);let r=document.createElement("span");return r.textContent=this.open?this.config.openText:this.config.closedText,r.title=e.state.phrase(this.open?"Fold line":"Unfold line"),r}}function WCe(t={}){let e=Object.assign(Object.assign({},GCe),t),r=new Fw(e,!0),n=new Fw(e,!1),s=Hr.fromClass(class{constructor(o){this.from=o.viewport.from,this.markers=this.buildMarkers(o)}update(o){(o.docChanged||o.viewportChanged||o.startState.facet(Ma)!=o.state.facet(Ma)||o.startState.field(F_,!1)!=o.state.field(F_,!1)||zr(o.startState)!=zr(o.state)||e.foldingChanged(o))&&(this.markers=this.buildMarkers(o.view))}buildMarkers(o){let a=new Gl;for(let l of o.viewportLineBlocks){let c=yS(o.state,l.from,l.to)?n:JD(o.state,l.from,l.to)?r:null;c&&a.add(l.from,l.from,c)}return a.finish()}}),{domEventHandlers:i}=e;return[s,HTe({class:"cm-foldGutter",markers(o){var a;return((a=o.plugin(s))===null||a===void 0?void 0:a.markers)||Tt.empty},initialSpacer(){return new Fw(e,!1)},domEventHandlers:Object.assign(Object.assign({},i),{click:(o,a,l)=>{if(i.click&&i.click(o,a,l))return!0;let c=yS(o.state,a.from,a.to);if(c)return o.dispatch({effects:tA.of(c)}),!0;let u=JD(o.state,a.from,a.to);return u?(o.dispatch({effects:b9.of(u)}),!0):!1}})}),zCe()]}const qCe=Ge.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class Fp{constructor(e,r){this.specs=e;let n;function s(a){let l=Oa.newName();return(n||(n=Object.create(null)))["."+l]=a,l}const i=typeof r.all=="string"?r.all:r.all?s(r.all):void 0,o=r.scope;this.scope=o instanceof Ns?a=>a.prop(Gc)==o.data:o?a=>a==o:void 0,this.style=p9(e.map(a=>({tag:a.tag,class:a.class||s(Object.assign({},a,{tag:null}))})),{all:i}).style,this.module=n?new Oa(n):null,this.themeType=r.themeType}static define(e,r){return new Fp(e,r||{})}}const bS=We.define(),KCe=We.define({combine(t){return t.length?[t[0]]:null}});function jw(t){let e=t.facet(bS);return e.length?e:t.facet(KCe)}function YCe(t,e){let r=[ZCe],n;return t instanceof Fp&&(t.module&&r.push(Ge.styleModule.of(t.module)),n=t.themeType),n?r.push(bS.computeN([Ge.darkTheme],s=>s.facet(Ge.darkTheme)==(n=="dark")?[t]:[])):r.push(bS.of(t)),r}class XCe{constructor(e){this.markCache=Object.create(null),this.tree=zr(e.state),this.decorations=this.buildDeco(e,jw(e.state)),this.decoratedTo=e.viewport.to}update(e){let r=zr(e.state),n=jw(e.state),s=n!=jw(e.startState),{viewport:i}=e.view,o=e.changes.mapPos(this.decoratedTo,1);r.length<i.to&&!s&&r.type==this.tree.type&&o>=i.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=o):(r!=this.tree||e.viewportChanged||s)&&(this.tree=r,this.decorations=this.buildDeco(e.view,n),this.decoratedTo=i.to)}buildDeco(e,r){if(!r||!this.tree.length)return yt.none;let n=new Gl;for(let{from:s,to:i}of e.visibleRanges)vCe(this.tree,r,(o,a,l)=>{n.add(o,a,this.markCache[l]||(this.markCache[l]=yt.mark({class:l})))},s,i);return n.finish()}}const ZCe=Va.high(Hr.fromClass(XCe,{decorations:t=>t.decorations}));ue.meta,ue.link,ue.heading,ue.emphasis,ue.strong,ue.strikethrough,ue.keyword,ue.atom,ue.bool,ue.url,ue.contentSeparator,ue.labelName,ue.literal,ue.inserted,ue.string,ue.deleted,ue.regexp,ue.escape,ue.string,ue.variableName,ue.variableName,ue.typeName,ue.namespace,ue.className,ue.variableName,ue.macroName,ue.propertyName,ue.comment,ue.invalid;const JCe=Ge.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),E9=1e4,x9="()[]{}",S9=We.define({combine(t){return ac(t,{afterCursor:!0,brackets:x9,maxScanDistance:E9,renderMatch:tke})}}),QCe=yt.mark({class:"cm-matchingBracket"}),eke=yt.mark({class:"cm-nonmatchingBracket"});function tke(t){let e=[],r=t.matched?QCe:eke;return e.push(r.range(t.start.from,t.start.to)),t.end&&e.push(r.range(t.end.from,t.end.to)),e}const rke=Pr.define({create(){return yt.none},update(t,e){if(!e.docChanged&&!e.selection)return t;let r=[],n=e.state.facet(S9);for(let s of e.state.selection.ranges){if(!s.empty)continue;let i=Ai(e.state,s.head,-1,n)||s.head>0&&Ai(e.state,s.head-1,1,n)||n.afterCursor&&(Ai(e.state,s.head,1,n)||s.head<e.state.doc.length&&Ai(e.state,s.head+1,-1,n));i&&(r=r.concat(n.renderMatch(i,e.state)))}return yt.set(r,!0)},provide:t=>Ge.decorations.from(t)}),nke=[rke,JCe];function ske(t={}){return[S9.of(t),nke]}const ike=new mt;function vS(t,e,r){let n=t.prop(e<0?mt.openedBy:mt.closedBy);if(n)return n;if(t.name.length==1){let s=r.indexOf(t.name);if(s>-1&&s%2==(e<0?1:0))return[r[s+e]]}return null}function wS(t){let e=t.type.prop(ike);return e?e(t.node):t}function Ai(t,e,r,n={}){let s=n.maxScanDistance||E9,i=n.brackets||x9,o=zr(t),a=o.resolveInner(e,r);for(let l=a;l;l=l.parent){let c=vS(l.type,r,i);if(c&&l.from<l.to){let u=wS(l);if(u&&(r>0?e>=u.from&&e<u.to:e>u.from&&e<=u.to))return oke(t,e,r,l,u,c,i)}}return ake(t,e,r,o,a.type,s,i)}function oke(t,e,r,n,s,i,o){let a=n.parent,l={from:s.from,to:s.to},c=0,u=a?.cursor();if(u&&(r<0?u.childBefore(n.from):u.childAfter(n.to)))do if(r<0?u.to<=n.from:u.from>=n.to){if(c==0&&i.indexOf(u.type.name)>-1&&u.from<u.to){let h=wS(u);return{start:l,end:h?{from:h.from,to:h.to}:void 0,matched:!0}}else if(vS(u.type,r,o))c++;else if(vS(u.type,-r,o)){if(c==0){let h=wS(u);return{start:l,end:h&&h.from<h.to?{from:h.from,to:h.to}:void 0,matched:!1}}c--}}while(r<0?u.prevSibling():u.nextSibling());return{start:l,matched:!1}}function ake(t,e,r,n,s,i,o){let a=r<0?t.sliceDoc(e-1,e):t.sliceDoc(e,e+1),l=o.indexOf(a);if(l<0||l%2==0!=r>0)return null;let c={from:r<0?e-1:e,to:r>0?e+1:e},u=t.doc.iterRange(e,r>0?t.doc.length:0),h=0;for(let d=0;!u.next().done&&d<=i;){let f=u.value;r<0&&(d+=f.length);let g=e+d*r;for(let _=r>0?0:f.length-1,m=r>0?f.length:-1;_!=m;_+=r){let p=o.indexOf(f[_]);if(!(p<0||n.resolveInner(g+_,1).type!=s))if(p%2==0==r>0)h++;else{if(h==1)return{start:c,end:{from:g+_,to:g+_+1},matched:p>>1==l>>1};h--}}r>0&&(d+=f.length)}return u.done?{start:c,matched:!1}:null}const lke=Object.create(null),eL=[Mn.none],tL=[],rL=Object.create(null),cke=Object.create(null);for(let[t,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])cke[t]=uke(lke,e);function Uw(t,e){tL.indexOf(t)>-1||(tL.push(t),console.warn(e))}function uke(t,e){let r=[];for(let a of e.split(" ")){let l=[];for(let c of a.split(".")){let u=t[c]||ue[c];u?typeof u=="function"?l.length?l=l.map(u):Uw(c,`Modifier ${c} used at start of tag`):l.length?Uw(c,`Tag ${c} used as modifier`):l=Array.isArray(u)?u:[u]:Uw(c,`Unknown highlighting tag ${c}`)}for(let c of l)r.push(c)}if(!r.length)return 0;let n=e.replace(/ /g,"_"),s=n+" "+r.map(a=>a.id),i=rL[s];if(i)return i.id;let o=rL[s]=Mn.define({id:eL.length,name:n,props:[yCe({[n]:r})]});return eL.push(o),o.id}Zt.RTL,Zt.LTR;class T9{constructor(e,r,n,s){this.state=e,this.pos=r,this.explicit=n,this.view=s,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(e){let r=zr(this.state).resolveInner(this.pos,-1);for(;r&&e.indexOf(r.name)<0;)r=r.parent;return r?{from:r.from,to:this.pos,text:this.state.sliceDoc(r.from,this.pos),type:r.type}:null}matchBefore(e){let r=this.state.doc.lineAt(this.pos),n=Math.max(r.from,this.pos-250),s=r.text.slice(n-r.from,this.pos-r.from),i=s.search(C9(e,!1));return i<0?null:{from:n+i,to:this.pos,text:s.slice(i)}}get aborted(){return this.abortListeners==null}addEventListener(e,r,n){e=="abort"&&this.abortListeners&&(this.abortListeners.push(r),n&&n.onDocChange&&(this.abortOnDocChange=!0))}}function nL(t){let e=Object.keys(t).join(""),r=/\w/.test(e);return r&&(e=e.replace(/\w/g,"")),`[${r?"\\w":""}${e.replace(/[^\w\s]/g,"\\$&")}]`}function hke(t){let e=Object.create(null),r=Object.create(null);for(let{label:s}of t){e[s[0]]=!0;for(let i=1;i<s.length;i++)r[s[i]]=!0}let n=nL(e)+nL(r)+"*$";return[new RegExp("^"+n),new RegExp(n)]}function dke(t){let e=t.map(s=>typeof s=="string"?{label:s}:s),[r,n]=e.every(s=>/^\w+$/.test(s.label))?[/\w*$/,/\w+$/]:hke(e);return s=>{let i=s.matchBefore(n);return i||s.explicit?{from:i?i.from:s.pos,options:e,validFor:r}:null}}function m9e(t,e){return r=>{for(let n=zr(r.state).resolveInner(r.pos,-1);n;n=n.parent){if(t.indexOf(n.name)>-1)return null;if(n.type.isTop)break}return e(r)}}class sL{constructor(e,r,n,s){this.completion=e,this.source=r,this.match=n,this.score=s}}function Pl(t){return t.selection.main.from}function C9(t,e){var r;let{source:n}=t,s=e&&n[0]!="^",i=n[n.length-1]!="$";return!s&&!i?t:new RegExp(`${s?"^":""}(?:${n})${i?"$":""}`,(r=t.flags)!==null&&r!==void 0?r:t.ignoreCase?"i":"")}const rA=No.define();function fke(t,e,r,n){let{main:s}=t.selection,i=r-s.from,o=n-s.from;return Object.assign(Object.assign({},t.changeByRange(a=>{if(a!=s&&r!=n&&t.sliceDoc(a.from+i,a.from+o)!=t.sliceDoc(r,n))return{range:a};let l=t.toText(e);return{changes:{from:a.from+i,to:n==s.from?a.to:a.from+o,insert:l},range:Re.cursor(a.from+i+l.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const iL=new WeakMap;function pke(t){if(!Array.isArray(t))return t;let e=iL.get(t);return e||iL.set(t,e=dke(t)),e}const j_=ht.define(),Mf=ht.define();class mke{constructor(e){this.pattern=e,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let r=0;r<e.length;){let n=An(e,r),s=Ds(n);this.chars.push(n);let i=e.slice(r,r+s),o=i.toUpperCase();this.folded.push(An(o==i?i.toLowerCase():o,0)),r+=s}this.astral=e.length!=this.chars.length}ret(e,r){return this.score=e,this.matched=r,this}match(e){if(this.pattern.length==0)return this.ret(-100,[]);if(e.length<this.pattern.length)return null;let{chars:r,folded:n,any:s,precise:i,byWord:o}=this;if(r.length==1){let y=An(e,0),b=Ds(y),v=b==e.length?0:-100;if(y!=r[0])if(y==n[0])v+=-200;else return null;return this.ret(v,[0,b])}let a=e.indexOf(this.pattern);if(a==0)return this.ret(e.length==this.pattern.length?0:-100,[0,this.pattern.length]);let l=r.length,c=0;if(a<0){for(let y=0,b=Math.min(e.length,200);y<b&&c<l;){let v=An(e,y);(v==r[c]||v==n[c])&&(s[c++]=y),y+=Ds(v)}if(c<l)return null}let u=0,h=0,d=!1,f=0,g=-1,_=-1,m=/[a-z]/.test(e),p=!0;for(let y=0,b=Math.min(e.length,200),v=0;y<b&&h<l;){let w=An(e,y);a<0&&(u<l&&w==r[u]&&(i[u++]=y),f<l&&(w==r[f]||w==n[f]?(f==0&&(g=y),_=y+1,f++):f=0));let E,S=w<255?w>=48&&w<=57||w>=97&&w<=122?2:w>=65&&w<=90?1:0:(E=Mk(w))!=E.toLowerCase()?1:E!=E.toUpperCase()?2:0;(!y||S==1&&m||v==0&&S!=0)&&(r[h]==w||n[h]==w&&(d=!0)?o[h++]=y:o.length&&(p=!1)),v=S,y+=Ds(w)}return h==l&&o[0]==0&&p?this.result(-100+(d?-200:0),o,e):f==l&&g==0?this.ret(-200-e.length+(_==e.length?0:-100),[0,_]):a>-1?this.ret(-700-e.length,[a,a+this.pattern.length]):f==l?this.ret(-900-e.length,[g,_]):h==l?this.result(-100+(d?-200:0)+-700+(p?0:-1100),o,e):r.length==2?null:this.result((s[0]?-700:0)+-200+-1100,s,e)}result(e,r,n){let s=[],i=0;for(let o of r){let a=o+(this.astral?Ds(An(n,o)):1);i&&s[i-1]==o?s[i-1]=a:(s[i++]=o,s[i++]=a)}return this.ret(e-n.length,s)}}class gke{constructor(e){this.pattern=e,this.matched=[],this.score=0,this.folded=e.toLowerCase()}match(e){if(e.length<this.pattern.length)return null;let r=e.slice(0,this.pattern.length),n=r==this.pattern?0:r.toLowerCase()==this.folded?-200:null;return n==null?null:(this.matched=[0,r.length],this.score=n+(e.length==this.pattern.length?0:-100),this)}}const kr=We.define({combine(t){return ac(t,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:_ke,filterStrict:!1,compareCompletions:(e,r)=>e.label.localeCompare(r.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(e,r)=>e&&r,closeOnBlur:(e,r)=>e&&r,icons:(e,r)=>e&&r,tooltipClass:(e,r)=>n=>oL(e(n),r(n)),optionClass:(e,r)=>n=>oL(e(n),r(n)),addToOptions:(e,r)=>e.concat(r),filterStrict:(e,r)=>e||r})}});function oL(t,e){return t?e?t+" "+e:t:e}function _ke(t,e,r,n,s,i){let o=t.textDirection==Zt.RTL,a=o,l=!1,c="top",u,h,d=e.left-s.left,f=s.right-e.right,g=n.right-n.left,_=n.bottom-n.top;if(a&&d<Math.min(g,f)?a=!1:!a&&f<Math.min(g,d)&&(a=!0),g<=(a?d:f))u=Math.max(s.top,Math.min(r.top,s.bottom-_))-e.top,h=Math.min(400,a?d:f);else{l=!0,h=Math.min(400,(o?e.right:s.right-e.left)-30);let y=s.bottom-e.bottom;y>=_||y>e.top?u=r.bottom-e.top:(c="bottom",u=e.bottom-r.top)}let m=(e.bottom-e.top)/i.offsetHeight,p=(e.right-e.left)/i.offsetWidth;return{style:`${c}: ${u/m}px; max-width: ${h/p}px`,class:"cm-completionInfo-"+(l?o?"left-narrow":"right-narrow":a?"left":"right")}}function yke(t){let e=t.addToOptions.slice();return t.icons&&e.push({render(r){let n=document.createElement("div");return n.classList.add("cm-completionIcon"),r.type&&n.classList.add(...r.type.split(/\s+/g).map(s=>"cm-completionIcon-"+s)),n.setAttribute("aria-hidden","true"),n},position:20}),e.push({render(r,n,s,i){let o=document.createElement("span");o.className="cm-completionLabel";let a=r.displayLabel||r.label,l=0;for(let c=0;c<i.length;){let u=i[c++],h=i[c++];u>l&&o.appendChild(document.createTextNode(a.slice(l,u)));let d=o.appendChild(document.createElement("span"));d.appendChild(document.createTextNode(a.slice(u,h))),d.className="cm-completionMatchedText",l=h}return l<a.length&&o.appendChild(document.createTextNode(a.slice(l))),o},position:50},{render(r){if(!r.detail)return null;let n=document.createElement("span");return n.className="cm-completionDetail",n.textContent=r.detail,n},position:80}),e.sort((r,n)=>r.position-n.position).map(r=>r.render)}function $w(t,e,r){if(t<=r)return{from:0,to:t};if(e<0&&(e=0),e<=t>>1){let s=Math.floor(e/r);return{from:s*r,to:(s+1)*r}}let n=Math.floor((t-e)/r);return{from:t-(n+1)*r,to:t-n*r}}class bke{constructor(e,r,n){this.view=e,this.stateField=r,this.applyCompletion=n,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:l=>this.placeInfo(l),key:this},this.space=null,this.currentClass="";let s=e.state.field(r),{options:i,selected:o}=s.open,a=e.state.facet(kr);this.optionContent=yke(a),this.optionClass=a.optionClass,this.tooltipClass=a.tooltipClass,this.range=$w(i.length,o,a.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(e.state),this.dom.addEventListener("mousedown",l=>{let{options:c}=e.state.field(r).open;for(let u=l.target,h;u&&u!=this.dom;u=u.parentNode)if(u.nodeName=="LI"&&(h=/-(\d+)$/.exec(u.id))&&+h[1]<c.length){this.applyCompletion(e,c[+h[1]]),l.preventDefault();return}}),this.dom.addEventListener("focusout",l=>{let c=e.state.field(this.stateField,!1);c&&c.tooltip&&e.state.facet(kr).closeOnBlur&&l.relatedTarget!=e.contentDOM&&e.dispatch({effects:Mf.of(null)})}),this.showOptions(i,s.id)}mount(){this.updateSel()}showOptions(e,r){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(e,r,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(e){var r;let n=e.state.field(this.stateField),s=e.startState.field(this.stateField);if(this.updateTooltipClass(e.state),n!=s){let{options:i,selected:o,disabled:a}=n.open;(!s.open||s.open.options!=i)&&(this.range=$w(i.length,o,e.state.facet(kr).maxRenderedOptions),this.showOptions(i,n.id)),this.updateSel(),a!=((r=s.open)===null||r===void 0?void 0:r.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!a)}}updateTooltipClass(e){let r=this.tooltipClass(e);if(r!=this.currentClass){for(let n of this.currentClass.split(" "))n&&this.dom.classList.remove(n);for(let n of r.split(" "))n&&this.dom.classList.add(n);this.currentClass=r}}positioned(e){this.space=e,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let e=this.view.state.field(this.stateField),r=e.open;if((r.selected>-1&&r.selected<this.range.from||r.selected>=this.range.to)&&(this.range=$w(r.options.length,r.selected,this.view.state.facet(kr).maxRenderedOptions),this.showOptions(r.options,e.id)),this.updateSelectedOption(r.selected)){this.destroyInfo();let{completion:n}=r.options[r.selected],{info:s}=n;if(!s)return;let i=typeof s=="string"?document.createTextNode(s):s(n);if(!i)return;"then"in i?i.then(o=>{o&&this.view.state.field(this.stateField,!1)==e&&this.addInfoPane(o,n)}).catch(o=>Wn(this.view.state,o,"completion info")):this.addInfoPane(i,n)}}addInfoPane(e,r){this.destroyInfo();let n=this.info=document.createElement("div");if(n.className="cm-tooltip cm-completionInfo",e.nodeType!=null)n.appendChild(e),this.infoDestroy=null;else{let{dom:s,destroy:i}=e;n.appendChild(s),this.infoDestroy=i||null}this.dom.appendChild(n),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(e){let r=null;for(let n=this.list.firstChild,s=this.range.from;n;n=n.nextSibling,s++)n.nodeName!="LI"||!n.id?s--:s==e?n.hasAttribute("aria-selected")||(n.setAttribute("aria-selected","true"),r=n):n.hasAttribute("aria-selected")&&n.removeAttribute("aria-selected");return r&&wke(this.list,r),r}measureInfo(){let e=this.dom.querySelector("[aria-selected]");if(!e||!this.info)return null;let r=this.dom.getBoundingClientRect(),n=this.info.getBoundingClientRect(),s=e.getBoundingClientRect(),i=this.space;if(!i){let o=this.dom.ownerDocument.defaultView||window;i={left:0,top:0,right:o.innerWidth,bottom:o.innerHeight}}return s.top>Math.min(i.bottom,r.bottom)-10||s.bottom<Math.max(i.top,r.top)+10?null:this.view.state.facet(kr).positionInfo(this.view,r,s,n,i,this.dom)}placeInfo(e){this.info&&(e?(e.style&&(this.info.style.cssText=e.style),this.info.className="cm-tooltip cm-completionInfo "+(e.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(e,r,n){const s=document.createElement("ul");s.id=r,s.setAttribute("role","listbox"),s.setAttribute("aria-expanded","true"),s.setAttribute("aria-label",this.view.state.phrase("Completions"));let i=null;for(let o=n.from;o<n.to;o++){let{completion:a,match:l}=e[o],{section:c}=a;if(c){let d=typeof c=="string"?c:c.name;if(d!=i&&(o>n.from||n.from==0))if(i=d,typeof c!="string"&&c.header)s.appendChild(c.header(c));else{let f=s.appendChild(document.createElement("completion-section"));f.textContent=d}}const u=s.appendChild(document.createElement("li"));u.id=r+"-"+o,u.setAttribute("role","option");let h=this.optionClass(a);h&&(u.className=h);for(let d of this.optionContent){let f=d(a,this.view.state,this.view,l);f&&u.appendChild(f)}}return n.from&&s.classList.add("cm-completionListIncompleteTop"),n.to<e.length&&s.classList.add("cm-completionListIncompleteBottom"),s}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function vke(t,e){return r=>new bke(r,t,e)}function wke(t,e){let r=t.getBoundingClientRect(),n=e.getBoundingClientRect(),s=r.height/t.offsetHeight;n.top<r.top?t.scrollTop-=(r.top-n.top)/s:n.bottom>r.bottom&&(t.scrollTop+=(n.bottom-r.bottom)/s)}function aL(t){return(t.boost||0)*100+(t.apply?10:0)+(t.info?5:0)+(t.type?1:0)}function Eke(t,e){let r=[],n=null,s=c=>{r.push(c);let{section:u}=c.completion;if(u){n||(n=[]);let h=typeof u=="string"?u:u.name;n.some(d=>d.name==h)||n.push(typeof u=="string"?{name:h}:u)}},i=e.facet(kr);for(let c of t)if(c.hasResult()){let u=c.result.getMatch;if(c.result.filter===!1)for(let h of c.result.options)s(new sL(h,c.source,u?u(h):[],1e9-r.length));else{let h=e.sliceDoc(c.from,c.to),d,f=i.filterStrict?new gke(h):new mke(h);for(let g of c.result.options)if(d=f.match(g.label)){let _=g.displayLabel?u?u(g,d.matched):[]:d.matched;s(new sL(g,c.source,_,d.score+(g.boost||0)))}}}if(n){let c=Object.create(null),u=0,h=(d,f)=>{var g,_;return((g=d.rank)!==null&&g!==void 0?g:1e9)-((_=f.rank)!==null&&_!==void 0?_:1e9)||(d.name<f.name?-1:1)};for(let d of n.sort(h))u-=1e5,c[d.name]=u;for(let d of r){let{section:f}=d.completion;f&&(d.score+=c[typeof f=="string"?f:f.name])}}let o=[],a=null,l=i.compareCompletions;for(let c of r.sort((u,h)=>h.score-u.score||l(u.completion,h.completion))){let u=c.completion;!a||a.label!=u.label||a.detail!=u.detail||a.type!=null&&u.type!=null&&a.type!=u.type||a.apply!=u.apply||a.boost!=u.boost?o.push(c):aL(c.completion)>aL(a)&&(o[o.length-1]=c),a=c.completion}return o}class Wc{constructor(e,r,n,s,i,o){this.options=e,this.attrs=r,this.tooltip=n,this.timestamp=s,this.selected=i,this.disabled=o}setSelected(e,r){return e==this.selected||e>=this.options.length?this:new Wc(this.options,lL(r,e),this.tooltip,this.timestamp,e,this.disabled)}static build(e,r,n,s,i,o){if(s&&!o&&e.some(c=>c.isPending))return s.setDisabled();let a=Eke(e,r);if(!a.length)return s&&e.some(c=>c.isPending)?s.setDisabled():null;let l=r.facet(kr).selectOnOpen?0:-1;if(s&&s.selected!=l&&s.selected!=-1){let c=s.options[s.selected].completion;for(let u=0;u<a.length;u++)if(a[u].completion==c){l=u;break}}return new Wc(a,lL(n,l),{pos:e.reduce((c,u)=>u.hasResult()?Math.min(c,u.from):c,1e8),create:Ake,above:i.aboveCursor},s?s.timestamp:Date.now(),l,!1)}map(e){return new Wc(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:e.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new Wc(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class U_{constructor(e,r,n){this.active=e,this.id=r,this.open=n}static start(){return new U_(Cke,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(e){let{state:r}=e,n=r.facet(kr),i=(n.override||r.languageDataAt("autocomplete",Pl(r)).map(pke)).map(l=>(this.active.find(u=>u.source==l)||new gs(l,this.active.some(u=>u.state!=0)?1:0)).update(e,n));i.length==this.active.length&&i.every((l,c)=>l==this.active[c])&&(i=this.active);let o=this.open,a=e.effects.some(l=>l.is(nA));o&&e.docChanged&&(o=o.map(e.changes)),e.selection||i.some(l=>l.hasResult()&&e.changes.touchesRange(l.from,l.to))||!xke(i,this.active)||a?o=Wc.build(i,r,this.id,o,n,a):o&&o.disabled&&!i.some(l=>l.isPending)&&(o=null),!o&&i.every(l=>!l.isPending)&&i.some(l=>l.hasResult())&&(i=i.map(l=>l.hasResult()?new gs(l.source,0):l));for(let l of e.effects)l.is(A9)&&(o=o&&o.setSelected(l.value,this.id));return i==this.active&&o==this.open?this:new U_(i,this.id,o)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?Ske:Tke}}function xke(t,e){if(t==e)return!0;for(let r=0,n=0;;){for(;r<t.length&&!t[r].hasResult();)r++;for(;n<e.length&&!e[n].hasResult();)n++;let s=r==t.length,i=n==e.length;if(s||i)return s==i;if(t[r++].result!=e[n++].result)return!1}}const Ske={"aria-autocomplete":"list"},Tke={};function lL(t,e){let r={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":t};return e>-1&&(r["aria-activedescendant"]=t+"-"+e),r}const Cke=[];function k9(t,e){if(t.isUserEvent("input.complete")){let n=t.annotation(rA);if(n&&e.activateOnCompletion(n))return 12}let r=t.isUserEvent("input.type");return r&&e.activateOnTyping?5:r?1:t.isUserEvent("delete.backward")?2:t.selection?8:t.docChanged?16:0}class gs{constructor(e,r,n=!1){this.source=e,this.state=r,this.explicit=n}hasResult(){return!1}get isPending(){return this.state==1}update(e,r){let n=k9(e,r),s=this;(n&8||n&16&&this.touches(e))&&(s=new gs(s.source,0)),n&4&&s.state==0&&(s=new gs(this.source,1)),s=s.updateFor(e,n);for(let i of e.effects)if(i.is(j_))s=new gs(s.source,1,i.value);else if(i.is(Mf))s=new gs(s.source,0);else if(i.is(nA))for(let o of i.value)o.source==s.source&&(s=o);return s}updateFor(e,r){return this.map(e.changes)}map(e){return this}touches(e){return e.changes.touchesRange(Pl(e.state))}}class cu extends gs{constructor(e,r,n,s,i,o){super(e,3,r),this.limit=n,this.result=s,this.from=i,this.to=o}hasResult(){return!0}updateFor(e,r){var n;if(!(r&3))return this.map(e.changes);let s=this.result;s.map&&!e.changes.empty&&(s=s.map(s,e.changes));let i=e.changes.mapPos(this.from),o=e.changes.mapPos(this.to,1),a=Pl(e.state);if(a>o||!s||r&2&&(Pl(e.startState)==this.from||a<this.limit))return new gs(this.source,r&4?1:0);let l=e.changes.mapPos(this.limit);return kke(s.validFor,e.state,i,o)?new cu(this.source,this.explicit,l,s,i,o):s.update&&(s=s.update(s,i,o,new T9(e.state,a,!1)))?new cu(this.source,this.explicit,l,s,s.from,(n=s.to)!==null&&n!==void 0?n:Pl(e.state)):new gs(this.source,1,this.explicit)}map(e){return e.empty?this:(this.result.map?this.result.map(this.result,e):this.result)?new cu(this.source,this.explicit,e.mapPos(this.limit),this.result,e.mapPos(this.from),e.mapPos(this.to,1)):new gs(this.source,0)}touches(e){return e.changes.touchesRange(this.from,this.to)}}function kke(t,e,r,n){if(!t)return!1;let s=e.sliceDoc(r,n);return typeof t=="function"?t(s,r,n,e):C9(t,!0).test(s)}const nA=ht.define({map(t,e){return t.map(r=>r.map(e))}}),A9=ht.define(),In=Pr.define({create(){return U_.start()},update(t,e){return t.update(e)},provide:t=>[Yk.from(t,e=>e.tooltip),Ge.contentAttributes.from(t,e=>e.attrs)]});function sA(t,e){const r=e.completion.apply||e.completion.label;let n=t.state.field(In).active.find(s=>s.source==e.source);return n instanceof cu?(typeof r=="string"?t.dispatch(Object.assign(Object.assign({},fke(t.state,r,n.from,n.to)),{annotations:rA.of(e.completion)})):r(t,e.completion,n.from,n.to),!0):!1}const Ake=vke(In,sA);function _g(t,e="option"){return r=>{let n=r.state.field(In,!1);if(!n||!n.open||n.open.disabled||Date.now()-n.open.timestamp<r.state.facet(kr).interactionDelay)return!1;let s=1,i;e=="page"&&(i=i9(r,n.open.tooltip))&&(s=Math.max(2,Math.floor(i.dom.offsetHeight/i.dom.querySelector("li").offsetHeight)-1));let{length:o}=n.open.options,a=n.open.selected>-1?n.open.selected+s*(t?1:-1):t?0:o-1;return a<0?a=e=="page"?0:o-1:a>=o&&(a=e=="page"?o-1:0),r.dispatch({effects:A9.of(a)}),!0}}const R9=t=>{let e=t.state.field(In,!1);return t.state.readOnly||!e||!e.open||e.open.selected<0||e.open.disabled||Date.now()-e.open.timestamp<t.state.facet(kr).interactionDelay?!1:sA(t,e.open.options[e.open.selected])},cL=t=>t.state.field(In,!1)?(t.dispatch({effects:j_.of(!0)}),!0):!1,Rke=t=>{let e=t.state.field(In,!1);return!e||!e.active.some(r=>r.state!=0)?!1:(t.dispatch({effects:Mf.of(null)}),!0)};class Ike{constructor(e,r){this.active=e,this.context=r,this.time=Date.now(),this.updates=[],this.done=void 0}}const Pke=50,Oke=1e3,Dke=Hr.fromClass(class{constructor(t){this.view=t,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let e of t.state.field(In).active)e.isPending&&this.startQuery(e)}update(t){let e=t.state.field(In),r=t.state.facet(kr);if(!t.selectionSet&&!t.docChanged&&t.startState.field(In)==e)return;let n=t.transactions.some(i=>{let o=k9(i,r);return o&8||(i.selection||i.docChanged)&&!(o&3)});for(let i=0;i<this.running.length;i++){let o=this.running[i];if(n||o.context.abortOnDocChange&&t.docChanged||o.updates.length+t.transactions.length>Pke&&Date.now()-o.time>Oke){for(let a of o.context.abortListeners)try{a()}catch(l){Wn(this.view.state,l)}o.context.abortListeners=null,this.running.splice(i--,1)}else o.updates.push(...t.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),t.transactions.some(i=>i.effects.some(o=>o.is(j_)))&&(this.pendingStart=!0);let s=this.pendingStart?50:r.activateOnTypingDelay;if(this.debounceUpdate=e.active.some(i=>i.isPending&&!this.running.some(o=>o.active.source==i.source))?setTimeout(()=>this.startUpdate(),s):-1,this.composing!=0)for(let i of t.transactions)i.isUserEvent("input.type")?this.composing=2:this.composing==2&&i.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:t}=this.view,e=t.field(In);for(let r of e.active)r.isPending&&!this.running.some(n=>n.active.source==r.source)&&this.startQuery(r);this.running.length&&e.open&&e.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(kr).updateSyncTime))}startQuery(t){let{state:e}=this.view,r=Pl(e),n=new T9(e,r,t.explicit,this.view),s=new Ike(t,n);this.running.push(s),Promise.resolve(t.source(n)).then(i=>{s.context.aborted||(s.done=i||null,this.scheduleAccept())},i=>{this.view.dispatch({effects:Mf.of(null)}),Wn(this.view.state,i)})}scheduleAccept(){this.running.every(t=>t.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(kr).updateSyncTime))}accept(){var t;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let e=[],r=this.view.state.facet(kr),n=this.view.state.field(In);for(let s=0;s<this.running.length;s++){let i=this.running[s];if(i.done===void 0)continue;if(this.running.splice(s--,1),i.done){let a=Pl(i.updates.length?i.updates[0].startState:this.view.state),l=Math.min(a,i.done.from+(i.active.explicit?0:1)),c=new cu(i.active.source,i.active.explicit,l,i.done,i.done.from,(t=i.done.to)!==null&&t!==void 0?t:a);for(let u of i.updates)c=c.update(u,r);if(c.hasResult()){e.push(c);continue}}let o=n.active.find(a=>a.source==i.active.source);if(o&&o.isPending)if(i.done==null){let a=new gs(i.active.source,0);for(let l of i.updates)a=a.update(l,r);a.isPending||e.push(a)}else this.startQuery(o)}(e.length||n.open&&n.open.disabled)&&this.view.dispatch({effects:nA.of(e)})}},{eventHandlers:{blur(t){let e=this.view.state.field(In,!1);if(e&&e.tooltip&&this.view.state.facet(kr).closeOnBlur){let r=e.open&&i9(this.view,e.open.tooltip);(!r||!r.dom.contains(t.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:Mf.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:j_.of(!1)}),20),this.composing=0}}}),Lke=typeof navigator=="object"&&/Win/.test(navigator.platform),Nke=Va.highest(Ge.domEventHandlers({keydown(t,e){let r=e.state.field(In,!1);if(!r||!r.open||r.open.disabled||r.open.selected<0||t.key.length>1||t.ctrlKey&&!(Lke&&t.altKey)||t.metaKey)return!1;let n=r.open.options[r.open.selected],s=r.active.find(o=>o.source==n.source),i=n.completion.commitCharacters||s.result.commitCharacters;return i&&i.indexOf(t.key)>-1&&sA(e,n),!1}})),I9=Ge.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"···"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'ƒ'"}},".cm-completionIcon-class":{"&:after":{content:"'○'"}},".cm-completionIcon-interface":{"&:after":{content:"'◌'"}},".cm-completionIcon-variable":{"&:after":{content:"'𝑥'"}},".cm-completionIcon-constant":{"&:after":{content:"'𝐶'"}},".cm-completionIcon-type":{"&:after":{content:"'𝑡'"}},".cm-completionIcon-enum":{"&:after":{content:"'∪'"}},".cm-completionIcon-property":{"&:after":{content:"'□'"}},".cm-completionIcon-keyword":{"&:after":{content:"'🔑︎'"}},".cm-completionIcon-namespace":{"&:after":{content:"'▢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class Mke{constructor(e,r,n,s){this.field=e,this.line=r,this.from=n,this.to=s}}class iA{constructor(e,r,n){this.field=e,this.from=r,this.to=n}map(e){let r=e.mapPos(this.from,-1,Yr.TrackDel),n=e.mapPos(this.to,1,Yr.TrackDel);return r==null||n==null?null:new iA(this.field,r,n)}}class oA{constructor(e,r){this.lines=e,this.fieldPositions=r}instantiate(e,r){let n=[],s=[r],i=e.doc.lineAt(r),o=/^\s*/.exec(i.text)[0];for(let l of this.lines){if(n.length){let c=o,u=/^\t*/.exec(l)[0].length;for(let h=0;h<u;h++)c+=e.facet(fh);s.push(r+c.length-u),l=c+l.slice(u)}n.push(l),r+=l.length+1}let a=this.fieldPositions.map(l=>new iA(l.field,s[l.line]+l.from,s[l.line]+l.to));return{text:n,ranges:a}}static parse(e){let r=[],n=[],s=[],i;for(let o of e.split(/\r\n?|\n/)){for(;i=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(o);){let a=i[1]?+i[1]:null,l=i[2]||i[3]||"",c=-1,u=l.replace(/\\[{}]/g,h=>h[1]);for(let h=0;h<r.length;h++)(a!=null?r[h].seq==a:u&&r[h].name==u)&&(c=h);if(c<0){let h=0;for(;h<r.length&&(a==null||r[h].seq!=null&&r[h].seq<a);)h++;r.splice(h,0,{seq:a,name:u}),c=h;for(let d of s)d.field>=c&&d.field++}s.push(new Mke(c,n.length,i.index,i.index+u.length)),o=o.slice(0,i.index)+l+o.slice(i.index+i[0].length)}o=o.replace(/\\([{}])/g,(a,l,c)=>{for(let u of s)u.line==n.length&&u.from>c&&(u.from--,u.to--);return l}),n.push(o)}return new oA(n,s)}}let Bke=yt.widget({widget:new class extends dh{toDOM(){let t=document.createElement("span");return t.className="cm-snippetFieldPosition",t}ignoreEvent(){return!1}}}),Fke=yt.mark({class:"cm-snippetField"});class ph{constructor(e,r){this.ranges=e,this.active=r,this.deco=yt.set(e.map(n=>(n.from==n.to?Bke:Fke).range(n.from,n.to)))}map(e){let r=[];for(let n of this.ranges){let s=n.map(e);if(!s)return null;r.push(s)}return new ph(r,this.active)}selectionInsideField(e){return e.ranges.every(r=>this.ranges.some(n=>n.field==this.active&&n.from<=r.from&&n.to>=r.to))}}const jp=ht.define({map(t,e){return t&&t.map(e)}}),jke=ht.define(),Bf=Pr.define({create(){return null},update(t,e){for(let r of e.effects){if(r.is(jp))return r.value;if(r.is(jke)&&t)return new ph(t.ranges,r.value)}return t&&e.docChanged&&(t=t.map(e.changes)),t&&e.selection&&!t.selectionInsideField(e.selection)&&(t=null),t},provide:t=>Ge.decorations.from(t,e=>e?e.deco:yt.none)});function aA(t,e){return Re.create(t.filter(r=>r.field==e).map(r=>Re.range(r.from,r.to)))}function Uke(t){let e=oA.parse(t);return(r,n,s,i)=>{let{text:o,ranges:a}=e.instantiate(r.state,s),l={changes:{from:s,to:i,insert:It.of(o)},scrollIntoView:!0,annotations:n?[rA.of(n),pr.userEvent.of("input.complete")]:void 0};if(a.length&&(l.selection=aA(a,0)),a.some(c=>c.field>0)){let c=new ph(a,0),u=l.effects=[jp.of(c)];r.state.field(Bf,!1)===void 0&&u.push(ht.appendConfig.of([Bf,Gke,Wke,I9]))}r.dispatch(r.state.update(l))}}function P9(t){return({state:e,dispatch:r})=>{let n=e.field(Bf,!1);if(!n||t<0&&n.active==0)return!1;let s=n.active+t,i=t>0&&!n.ranges.some(o=>o.field==s+t);return r(e.update({selection:aA(n.ranges,s),effects:jp.of(i?null:new ph(n.ranges,s)),scrollIntoView:!0})),!0}}const $ke=({state:t,dispatch:e})=>t.field(Bf,!1)?(e(t.update({effects:jp.of(null)})),!0):!1,Hke=P9(1),zke=P9(-1),Vke=[{key:"Tab",run:Hke,shift:zke},{key:"Escape",run:$ke}],uL=We.define({combine(t){return t.length?t[0]:Vke}}),Gke=Va.highest(Ob.compute([uL],t=>t.facet(uL)));function g9e(t,e){return Object.assign(Object.assign({},e),{apply:Uke(t)})}const Wke=Ge.domEventHandlers({mousedown(t,e){let r=e.state.field(Bf,!1),n;if(!r||(n=e.posAtCoords({x:t.clientX,y:t.clientY}))==null)return!1;let s=r.ranges.find(i=>i.from<=n&&i.to>=n);return!s||s.field==r.active?!1:(e.dispatch({selection:aA(r.ranges,s.field),effects:jp.of(r.ranges.some(i=>i.field>s.field)?new ph(r.ranges,s.field):null),scrollIntoView:!0}),!0)}}),$_={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},gl=ht.define({map(t,e){let r=e.mapPos(t,-1,Yr.TrackAfter);return r??void 0}}),lA=new class extends Vl{};lA.startSide=1;lA.endSide=-1;const O9=Pr.define({create(){return Tt.empty},update(t,e){if(t=t.map(e.changes),e.selection){let r=e.state.doc.lineAt(e.selection.main.head);t=t.update({filter:n=>n>=r.from&&n<=r.to})}for(let r of e.effects)r.is(gl)&&(t=t.update({add:[lA.range(r.value,r.value+1)]}));return t}});function qke(){return[Zke,O9]}const Hw="()[]{}<>";function Kke(t){for(let e=0;e<Hw.length;e+=2)if(Hw.charCodeAt(e)==t)return Hw.charAt(e+1);return Mk(t<128?t:t+1)}function Yke(t,e){return t.languageDataAt("closeBrackets",e)[0]||$_}const Xke=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),Zke=Ge.inputHandler.of((t,e,r,n)=>{if((Xke?t.composing:t.compositionStarted)||t.state.readOnly)return!1;let s=t.state.selection.main;if(n.length>2||n.length==2&&Ds(An(n,0))==1||e!=s.from||r!=s.to)return!1;let i=Jke(t.state,n);return i?(t.dispatch(i),!0):!1});function Jke(t,e){let r=Yke(t,t.selection.main.head),n=r.brackets||$_.brackets;for(let s of n){let i=Kke(An(s,0));if(e==s)return i==s?tAe(t,s,n.indexOf(s+s+s)>-1,r):Qke(t,s,i,r.before||$_.before);if(e==i&&D9(t,t.selection.main.from))return eAe(t,s,i)}return null}function D9(t,e){let r=!1;return t.field(O9).between(0,t.doc.length,n=>{n==e&&(r=!0)}),r}function cA(t,e){let r=t.sliceString(e,e+2);return r.slice(0,Ds(An(r,0)))}function Qke(t,e,r,n){let s=null,i=t.changeByRange(o=>{if(!o.empty)return{changes:[{insert:e,from:o.from},{insert:r,from:o.to}],effects:gl.of(o.to+e.length),range:Re.range(o.anchor+e.length,o.head+e.length)};let a=cA(t.doc,o.head);return!a||/\s/.test(a)||n.indexOf(a)>-1?{changes:{insert:e+r,from:o.head},effects:gl.of(o.head+e.length),range:Re.cursor(o.head+e.length)}:{range:s=o}});return s?null:t.update(i,{scrollIntoView:!0,userEvent:"input.type"})}function eAe(t,e,r){let n=null,s=t.changeByRange(i=>i.empty&&cA(t.doc,i.head)==r?{changes:{from:i.head,to:i.head+r.length,insert:r},range:Re.cursor(i.head+r.length)}:n={range:i});return n?null:t.update(s,{scrollIntoView:!0,userEvent:"input.type"})}function tAe(t,e,r,n){let s=n.stringPrefixes||$_.stringPrefixes,i=null,o=t.changeByRange(a=>{if(!a.empty)return{changes:[{insert:e,from:a.from},{insert:e,from:a.to}],effects:gl.of(a.to+e.length),range:Re.range(a.anchor+e.length,a.head+e.length)};let l=a.head,c=cA(t.doc,l),u;if(c==e){if(hL(t,l))return{changes:{insert:e+e,from:l},effects:gl.of(l+e.length),range:Re.cursor(l+e.length)};if(D9(t,l)){let d=r&&t.sliceDoc(l,l+e.length*3)==e+e+e?e+e+e:e;return{changes:{from:l,to:l+d.length,insert:d},range:Re.cursor(l+d.length)}}}else{if(r&&t.sliceDoc(l-2*e.length,l)==e+e&&(u=dL(t,l-2*e.length,s))>-1&&hL(t,u))return{changes:{insert:e+e+e+e,from:l},effects:gl.of(l+e.length),range:Re.cursor(l+e.length)};if(t.charCategorizer(l)(c)!=mr.Word&&dL(t,l,s)>-1&&!rAe(t,l,e,s))return{changes:{insert:e+e,from:l},effects:gl.of(l+e.length),range:Re.cursor(l+e.length)}}return{range:i=a}});return i?null:t.update(o,{scrollIntoView:!0,userEvent:"input.type"})}function hL(t,e){let r=zr(t).resolveInner(e+1);return r.parent&&r.from==e}function rAe(t,e,r,n){let s=zr(t).resolveInner(e,-1),i=n.reduce((o,a)=>Math.max(o,a.length),0);for(let o=0;o<5;o++){let a=t.sliceDoc(s.from,Math.min(s.to,s.from+r.length+i)),l=a.indexOf(r);if(!l||l>-1&&n.indexOf(a.slice(0,l))>-1){let u=s.firstChild;for(;u&&u.from==s.from&&u.to-u.from>r.length+l;){if(t.sliceDoc(u.to-r.length,u.to)==r)return!1;u=u.firstChild}return!0}let c=s.to==e&&s.parent;if(!c)break;s=c}return!1}function dL(t,e,r){let n=t.charCategorizer(e);if(n(t.sliceDoc(e-1,e))!=mr.Word)return e;for(let s of r){let i=e-s.length;if(t.sliceDoc(i,e)==s&&n(t.sliceDoc(i-1,i))!=mr.Word)return i}return-1}function nAe(t={}){return[Nke,In,kr.of(t),Dke,iAe,I9]}const sAe=[{key:"Ctrl-Space",run:cL},{mac:"Alt-`",run:cL},{key:"Escape",run:Rke},{key:"ArrowDown",run:_g(!0)},{key:"ArrowUp",run:_g(!1)},{key:"PageDown",run:_g(!0,"page")},{key:"PageUp",run:_g(!1,"page")},{key:"Enter",run:R9}],iAe=Va.highest(Ob.computeN([kr],t=>t.facet(kr).defaultKeymap?[sAe]:[])),oAe=t=>{let{state:e}=t,r=e.doc.lineAt(e.selection.main.from),n=hA(t.state,r.from);return n.line?aAe(t):n.block?cAe(t):!1};function uA(t,e){return({state:r,dispatch:n})=>{if(r.readOnly)return!1;let s=t(e,r);return s?(n(r.update(s)),!0):!1}}const aAe=uA(dAe,0),lAe=uA(L9,0),cAe=uA((t,e)=>L9(t,e,hAe(e)),0);function hA(t,e){let r=t.languageDataAt("commentTokens",e);return r.length?r[0]:{}}const Gh=50;function uAe(t,{open:e,close:r},n,s){let i=t.sliceDoc(n-Gh,n),o=t.sliceDoc(s,s+Gh),a=/\s*$/.exec(i)[0].length,l=/^\s*/.exec(o)[0].length,c=i.length-a;if(i.slice(c-e.length,c)==e&&o.slice(l,l+r.length)==r)return{open:{pos:n-a,margin:a&&1},close:{pos:s+l,margin:l&&1}};let u,h;s-n<=2*Gh?u=h=t.sliceDoc(n,s):(u=t.sliceDoc(n,n+Gh),h=t.sliceDoc(s-Gh,s));let d=/^\s*/.exec(u)[0].length,f=/\s*$/.exec(h)[0].length,g=h.length-f-r.length;return u.slice(d,d+e.length)==e&&h.slice(g,g+r.length)==r?{open:{pos:n+d+e.length,margin:/\s/.test(u.charAt(d+e.length))?1:0},close:{pos:s-f-r.length,margin:/\s/.test(h.charAt(g-1))?1:0}}:null}function hAe(t){let e=[];for(let r of t.selection.ranges){let n=t.doc.lineAt(r.from),s=r.to<=n.to?n:t.doc.lineAt(r.to);s.from>n.from&&s.from==r.to&&(s=r.to==n.to+1?n:t.doc.lineAt(r.to-1));let i=e.length-1;i>=0&&e[i].to>n.from?e[i].to=s.to:e.push({from:n.from+/^\s*/.exec(n.text)[0].length,to:s.to})}return e}function L9(t,e,r=e.selection.ranges){let n=r.map(i=>hA(e,i.from).block);if(!n.every(i=>i))return null;let s=r.map((i,o)=>uAe(e,n[o],i.from,i.to));if(t!=2&&!s.every(i=>i))return{changes:e.changes(r.map((i,o)=>s[o]?[]:[{from:i.from,insert:n[o].open+" "},{from:i.to,insert:" "+n[o].close}]))};if(t!=1&&s.some(i=>i)){let i=[];for(let o=0,a;o<s.length;o++)if(a=s[o]){let l=n[o],{open:c,close:u}=a;i.push({from:c.pos-l.open.length,to:c.pos+c.margin},{from:u.pos-u.margin,to:u.pos+l.close.length})}return{changes:i}}return null}function dAe(t,e,r=e.selection.ranges){let n=[],s=-1;for(let{from:i,to:o}of r){let a=n.length,l=1e9,c=hA(e,i).line;if(c){for(let u=i;u<=o;){let h=e.doc.lineAt(u);if(h.from>s&&(i==o||o>h.from)){s=h.from;let d=/^\s*/.exec(h.text)[0].length,f=d==h.length,g=h.text.slice(d,d+c.length)==c?d:-1;d<h.text.length&&d<l&&(l=d),n.push({line:h,comment:g,token:c,indent:d,empty:f,single:!1})}u=h.to+1}if(l<1e9)for(let u=a;u<n.length;u++)n[u].indent<n[u].line.text.length&&(n[u].indent=l);n.length==a+1&&(n[a].single=!0)}}if(t!=2&&n.some(i=>i.comment<0&&(!i.empty||i.single))){let i=[];for(let{line:a,token:l,indent:c,empty:u,single:h}of n)(h||!u)&&i.push({from:a.from+c,insert:l+" "});let o=e.changes(i);return{changes:o,selection:e.selection.map(o,1)}}else if(t!=1&&n.some(i=>i.comment>=0)){let i=[];for(let{line:o,comment:a,token:l}of n)if(a>=0){let c=o.from+a,u=c+l.length;o.text[u-o.from]==" "&&u++,i.push({from:c,to:u})}return{changes:i}}return null}const ES=No.define(),fAe=No.define(),pAe=We.define(),N9=We.define({combine(t){return ac(t,{minDepth:100,newGroupDelay:500,joinToEvent:(e,r)=>r},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(e,r)=>(n,s)=>e(n,s)||r(n,s)})}}),M9=Pr.define({create(){return Ri.empty},update(t,e){let r=e.state.facet(N9),n=e.annotation(ES);if(n){let l=On.fromTransaction(e,n.selection),c=n.side,u=c==0?t.undone:t.done;return l?u=H_(u,u.length,r.minDepth,l):u=j9(u,e.startState.selection),new Ri(c==0?n.rest:u,c==0?u:n.rest)}let s=e.annotation(fAe);if((s=="full"||s=="before")&&(t=t.isolate()),e.annotation(pr.addToHistory)===!1)return e.changes.empty?t:t.addMapping(e.changes.desc);let i=On.fromTransaction(e),o=e.annotation(pr.time),a=e.annotation(pr.userEvent);return i?t=t.addChanges(i,o,a,r,e):e.selection&&(t=t.addSelection(e.startState.selection,o,a,r.newGroupDelay)),(s=="full"||s=="after")&&(t=t.isolate()),t},toJSON(t){return{done:t.done.map(e=>e.toJSON()),undone:t.undone.map(e=>e.toJSON())}},fromJSON(t){return new Ri(t.done.map(On.fromJSON),t.undone.map(On.fromJSON))}});function mAe(t={}){return[M9,N9.of(t),Ge.domEventHandlers({beforeinput(e,r){let n=e.inputType=="historyUndo"?B9:e.inputType=="historyRedo"?xS:null;return n?(e.preventDefault(),n(r)):!1}})]}function Lb(t,e){return function({state:r,dispatch:n}){if(!e&&r.readOnly)return!1;let s=r.field(M9,!1);if(!s)return!1;let i=s.pop(t,r,e);return i?(n(i),!0):!1}}const B9=Lb(0,!1),xS=Lb(1,!1),gAe=Lb(0,!0),_Ae=Lb(1,!0);class On{constructor(e,r,n,s,i){this.changes=e,this.effects=r,this.mapped=n,this.startSelection=s,this.selectionsAfter=i}setSelAfter(e){return new On(this.changes,this.effects,this.mapped,this.startSelection,e)}toJSON(){var e,r,n;return{changes:(e=this.changes)===null||e===void 0?void 0:e.toJSON(),mapped:(r=this.mapped)===null||r===void 0?void 0:r.toJSON(),startSelection:(n=this.startSelection)===null||n===void 0?void 0:n.toJSON(),selectionsAfter:this.selectionsAfter.map(s=>s.toJSON())}}static fromJSON(e){return new On(e.changes&&_r.fromJSON(e.changes),[],e.mapped&&Bi.fromJSON(e.mapped),e.startSelection&&Re.fromJSON(e.startSelection),e.selectionsAfter.map(Re.fromJSON))}static fromTransaction(e,r){let n=_s;for(let s of e.startState.facet(pAe)){let i=s(e);i.length&&(n=n.concat(i))}return!n.length&&e.changes.empty?null:new On(e.changes.invert(e.startState.doc),n,void 0,r||e.startState.selection,_s)}static selection(e){return new On(void 0,_s,void 0,void 0,e)}}function H_(t,e,r,n){let s=e+1>r+20?e-r-1:0,i=t.slice(s,e);return i.push(n),i}function yAe(t,e){let r=[],n=!1;return t.iterChangedRanges((s,i)=>r.push(s,i)),e.iterChangedRanges((s,i,o,a)=>{for(let l=0;l<r.length;){let c=r[l++],u=r[l++];a>=c&&o<=u&&(n=!0)}}),n}function bAe(t,e){return t.ranges.length==e.ranges.length&&t.ranges.filter((r,n)=>r.empty!=e.ranges[n].empty).length===0}function F9(t,e){return t.length?e.length?t.concat(e):t:e}const _s=[],vAe=200;function j9(t,e){if(t.length){let r=t[t.length-1],n=r.selectionsAfter.slice(Math.max(0,r.selectionsAfter.length-vAe));return n.length&&n[n.length-1].eq(e)?t:(n.push(e),H_(t,t.length-1,1e9,r.setSelAfter(n)))}else return[On.selection([e])]}function wAe(t){let e=t[t.length-1],r=t.slice();return r[t.length-1]=e.setSelAfter(e.selectionsAfter.slice(0,e.selectionsAfter.length-1)),r}function zw(t,e){if(!t.length)return t;let r=t.length,n=_s;for(;r;){let s=EAe(t[r-1],e,n);if(s.changes&&!s.changes.empty||s.effects.length){let i=t.slice(0,r);return i[r-1]=s,i}else e=s.mapped,r--,n=s.selectionsAfter}return n.length?[On.selection(n)]:_s}function EAe(t,e,r){let n=F9(t.selectionsAfter.length?t.selectionsAfter.map(a=>a.map(e)):_s,r);if(!t.changes)return On.selection(n);let s=t.changes.map(e),i=e.mapDesc(t.changes,!0),o=t.mapped?t.mapped.composeDesc(i):i;return new On(s,ht.mapEffects(t.effects,e),o,t.startSelection.map(i),n)}const xAe=/^(input\.type|delete)($|\.)/;class Ri{constructor(e,r,n=0,s=void 0){this.done=e,this.undone=r,this.prevTime=n,this.prevUserEvent=s}isolate(){return this.prevTime?new Ri(this.done,this.undone):this}addChanges(e,r,n,s,i){let o=this.done,a=o[o.length-1];return a&&a.changes&&!a.changes.empty&&e.changes&&(!n||xAe.test(n))&&(!a.selectionsAfter.length&&r-this.prevTime<s.newGroupDelay&&s.joinToEvent(i,yAe(a.changes,e.changes))||n=="input.type.compose")?o=H_(o,o.length-1,s.minDepth,new On(e.changes.compose(a.changes),F9(ht.mapEffects(e.effects,a.changes),a.effects),a.mapped,a.startSelection,_s)):o=H_(o,o.length,s.minDepth,e),new Ri(o,_s,r,n)}addSelection(e,r,n,s){let i=this.done.length?this.done[this.done.length-1].selectionsAfter:_s;return i.length>0&&r-this.prevTime<s&&n==this.prevUserEvent&&n&&/^select($|\.)/.test(n)&&bAe(i[i.length-1],e)?this:new Ri(j9(this.done,e),this.undone,r,n)}addMapping(e){return new Ri(zw(this.done,e),zw(this.undone,e),this.prevTime,this.prevUserEvent)}pop(e,r,n){let s=e==0?this.done:this.undone;if(s.length==0)return null;let i=s[s.length-1],o=i.selectionsAfter[0]||r.selection;if(n&&i.selectionsAfter.length)return r.update({selection:i.selectionsAfter[i.selectionsAfter.length-1],annotations:ES.of({side:e,rest:wAe(s),selection:o}),userEvent:e==0?"select.undo":"select.redo",scrollIntoView:!0});if(i.changes){let a=s.length==1?_s:s.slice(0,s.length-1);return i.mapped&&(a=zw(a,i.mapped)),r.update({changes:i.changes,selection:i.startSelection,effects:i.effects,annotations:ES.of({side:e,rest:a,selection:o}),filter:!1,userEvent:e==0?"undo":"redo",scrollIntoView:!0})}else return null}}Ri.empty=new Ri(_s,_s);const SAe=[{key:"Mod-z",run:B9,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:xS,preventDefault:!0},{linux:"Ctrl-Shift-z",run:xS,preventDefault:!0},{key:"Mod-u",run:gAe,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:_Ae,preventDefault:!0}];function mh(t,e){return Re.create(t.ranges.map(e),t.mainIndex)}function Ki(t,e){return t.update({selection:e,scrollIntoView:!0,userEvent:"select"})}function Ks({state:t,dispatch:e},r){let n=mh(t.selection,r);return n.eq(t.selection,!0)?!1:(e(Ki(t,n)),!0)}function Nb(t,e){return Re.cursor(e?t.to:t.from)}function U9(t,e){return Ks(t,r=>r.empty?t.moveByChar(r,e):Nb(r,e))}function sn(t){return t.textDirectionAt(t.state.selection.main.head)==Zt.LTR}const $9=t=>U9(t,!sn(t)),H9=t=>U9(t,sn(t));function z9(t,e){return Ks(t,r=>r.empty?t.moveByGroup(r,e):Nb(r,e))}const TAe=t=>z9(t,!sn(t)),CAe=t=>z9(t,sn(t));function kAe(t,e,r){if(e.type.prop(r))return!0;let n=e.to-e.from;return n&&(n>2||/[^\s,.;:]/.test(t.sliceDoc(e.from,e.to)))||e.firstChild}function Mb(t,e,r){let n=zr(t).resolveInner(e.head),s=r?mt.closedBy:mt.openedBy;for(let l=e.head;;){let c=r?n.childAfter(l):n.childBefore(l);if(!c)break;kAe(t,c,s)?n=c:l=r?c.to:c.from}let i=n.type.prop(s),o,a;return i&&(o=r?Ai(t,n.from,1):Ai(t,n.to,-1))&&o.matched?a=r?o.end.to:o.end.from:a=r?n.to:n.from,Re.cursor(a,r?-1:1)}const AAe=t=>Ks(t,e=>Mb(t.state,e,!sn(t))),RAe=t=>Ks(t,e=>Mb(t.state,e,sn(t)));function V9(t,e){return Ks(t,r=>{if(!r.empty)return Nb(r,e);let n=t.moveVertically(r,e);return n.head!=r.head?n:t.moveToLineBoundary(r,e)})}const G9=t=>V9(t,!1),W9=t=>V9(t,!0);function q9(t){let e=t.scrollDOM.clientHeight<t.scrollDOM.scrollHeight-2,r=0,n=0,s;if(e){for(let i of t.state.facet(Ge.scrollMargins)){let o=i(t);o?.top&&(r=Math.max(o?.top,r)),o?.bottom&&(n=Math.max(o?.bottom,n))}s=t.scrollDOM.clientHeight-r-n}else s=(t.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:r,marginBottom:n,selfScroll:e,height:Math.max(t.defaultLineHeight,s-5)}}function K9(t,e){let r=q9(t),{state:n}=t,s=mh(n.selection,o=>o.empty?t.moveVertically(o,e,r.height):Nb(o,e));if(s.eq(n.selection))return!1;let i;if(r.selfScroll){let o=t.coordsAtPos(n.selection.main.head),a=t.scrollDOM.getBoundingClientRect(),l=a.top+r.marginTop,c=a.bottom-r.marginBottom;o&&o.top>l&&o.bottom<c&&(i=Ge.scrollIntoView(s.main.head,{y:"start",yMargin:o.top-l}))}return t.dispatch(Ki(n,s),{effects:i}),!0}const fL=t=>K9(t,!1),SS=t=>K9(t,!0);function Ga(t,e,r){let n=t.lineBlockAt(e.head),s=t.moveToLineBoundary(e,r);if(s.head==e.head&&s.head!=(r?n.to:n.from)&&(s=t.moveToLineBoundary(e,r,!1)),!r&&s.head==n.from&&n.length){let i=/^\s*/.exec(t.state.sliceDoc(n.from,Math.min(n.from+100,n.to)))[0].length;i&&e.head!=n.from+i&&(s=Re.cursor(n.from+i))}return s}const IAe=t=>Ks(t,e=>Ga(t,e,!0)),PAe=t=>Ks(t,e=>Ga(t,e,!1)),OAe=t=>Ks(t,e=>Ga(t,e,!sn(t))),DAe=t=>Ks(t,e=>Ga(t,e,sn(t))),LAe=t=>Ks(t,e=>Re.cursor(t.lineBlockAt(e.head).from,1)),NAe=t=>Ks(t,e=>Re.cursor(t.lineBlockAt(e.head).to,-1));function MAe(t,e,r){let n=!1,s=mh(t.selection,i=>{let o=Ai(t,i.head,-1)||Ai(t,i.head,1)||i.head>0&&Ai(t,i.head-1,1)||i.head<t.doc.length&&Ai(t,i.head+1,-1);if(!o||!o.end)return i;n=!0;let a=o.start.from==i.head?o.end.to:o.end.from;return Re.cursor(a)});return n?(e(Ki(t,s)),!0):!1}const BAe=({state:t,dispatch:e})=>MAe(t,e);function Rs(t,e){let r=mh(t.state.selection,n=>{let s=e(n);return Re.range(n.anchor,s.head,s.goalColumn,s.bidiLevel||void 0)});return r.eq(t.state.selection)?!1:(t.dispatch(Ki(t.state,r)),!0)}function Y9(t,e){return Rs(t,r=>t.moveByChar(r,e))}const X9=t=>Y9(t,!sn(t)),Z9=t=>Y9(t,sn(t));function J9(t,e){return Rs(t,r=>t.moveByGroup(r,e))}const FAe=t=>J9(t,!sn(t)),jAe=t=>J9(t,sn(t)),UAe=t=>Rs(t,e=>Mb(t.state,e,!sn(t))),$Ae=t=>Rs(t,e=>Mb(t.state,e,sn(t)));function Q9(t,e){return Rs(t,r=>t.moveVertically(r,e))}const e7=t=>Q9(t,!1),t7=t=>Q9(t,!0);function r7(t,e){return Rs(t,r=>t.moveVertically(r,e,q9(t).height))}const pL=t=>r7(t,!1),mL=t=>r7(t,!0),HAe=t=>Rs(t,e=>Ga(t,e,!0)),zAe=t=>Rs(t,e=>Ga(t,e,!1)),VAe=t=>Rs(t,e=>Ga(t,e,!sn(t))),GAe=t=>Rs(t,e=>Ga(t,e,sn(t))),WAe=t=>Rs(t,e=>Re.cursor(t.lineBlockAt(e.head).from)),qAe=t=>Rs(t,e=>Re.cursor(t.lineBlockAt(e.head).to)),gL=({state:t,dispatch:e})=>(e(Ki(t,{anchor:0})),!0),_L=({state:t,dispatch:e})=>(e(Ki(t,{anchor:t.doc.length})),!0),yL=({state:t,dispatch:e})=>(e(Ki(t,{anchor:t.selection.main.anchor,head:0})),!0),bL=({state:t,dispatch:e})=>(e(Ki(t,{anchor:t.selection.main.anchor,head:t.doc.length})),!0),KAe=({state:t,dispatch:e})=>(e(t.update({selection:{anchor:0,head:t.doc.length},userEvent:"select"})),!0),YAe=({state:t,dispatch:e})=>{let r=Bb(t).map(({from:n,to:s})=>Re.range(n,Math.min(s+1,t.doc.length)));return e(t.update({selection:Re.create(r),userEvent:"select"})),!0},XAe=({state:t,dispatch:e})=>{let r=mh(t.selection,n=>{let s=zr(t),i=s.resolveStack(n.from,1);if(n.empty){let o=s.resolveStack(n.from,-1);o.node.from>=i.node.from&&o.node.to<=i.node.to&&(i=o)}for(let o=i;o;o=o.next){let{node:a}=o;if((a.from<n.from&&a.to>=n.to||a.to>n.to&&a.from<=n.from)&&o.next)return Re.range(a.to,a.from)}return n});return r.eq(t.selection)?!1:(e(Ki(t,r)),!0)},ZAe=({state:t,dispatch:e})=>{let r=t.selection,n=null;return r.ranges.length>1?n=Re.create([r.main]):r.main.empty||(n=Re.create([Re.cursor(r.main.head)])),n?(e(Ki(t,n)),!0):!1};function Up(t,e){if(t.state.readOnly)return!1;let r="delete.selection",{state:n}=t,s=n.changeByRange(i=>{let{from:o,to:a}=i;if(o==a){let l=e(i);l<o?(r="delete.backward",l=yg(t,l,!1)):l>o&&(r="delete.forward",l=yg(t,l,!0)),o=Math.min(o,l),a=Math.max(a,l)}else o=yg(t,o,!1),a=yg(t,a,!0);return o==a?{range:i}:{changes:{from:o,to:a},range:Re.cursor(o,o<i.head?-1:1)}});return s.changes.empty?!1:(t.dispatch(n.update(s,{scrollIntoView:!0,userEvent:r,effects:r=="delete.selection"?Ge.announce.of(n.phrase("Selection deleted")):void 0})),!0)}function yg(t,e,r){if(t instanceof Ge)for(let n of t.state.facet(Ge.atomicRanges).map(s=>s(t)))n.between(e,e,(s,i)=>{s<e&&i>e&&(e=r?i:s)});return e}const n7=(t,e,r)=>Up(t,n=>{let s=n.from,{state:i}=t,o=i.doc.lineAt(s),a,l;if(r&&!e&&s>o.from&&s<o.from+200&&!/[^ \t]/.test(a=o.text.slice(0,s-o.from))){if(a[a.length-1]=="	")return s-1;let c=kb(a,i.tabSize),u=c%B_(i)||B_(i);for(let h=0;h<u&&a[a.length-1-h]==" ";h++)s--;l=s}else l=jr(o.text,s-o.from,e,e)+o.from,l==s&&o.number!=(e?i.doc.lines:1)?l+=e?1:-1:!e&&/[\ufe00-\ufe0f]/.test(o.text.slice(l-o.from,s-o.from))&&(l=jr(o.text,l-o.from,!1,!1)+o.from);return l}),TS=t=>n7(t,!1,!0),s7=t=>n7(t,!0,!1),i7=(t,e)=>Up(t,r=>{let n=r.head,{state:s}=t,i=s.doc.lineAt(n),o=s.charCategorizer(n);for(let a=null;;){if(n==(e?i.to:i.from)){n==r.head&&i.number!=(e?s.doc.lines:1)&&(n+=e?1:-1);break}let l=jr(i.text,n-i.from,e)+i.from,c=i.text.slice(Math.min(n,l)-i.from,Math.max(n,l)-i.from),u=o(c);if(a!=null&&u!=a)break;(c!=" "||n!=r.head)&&(a=u),n=l}return n}),o7=t=>i7(t,!1),JAe=t=>i7(t,!0),QAe=t=>Up(t,e=>{let r=t.lineBlockAt(e.head).to;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)}),e2e=t=>Up(t,e=>{let r=t.moveToLineBoundary(e,!1).head;return e.head>r?r:Math.max(0,e.head-1)}),t2e=t=>Up(t,e=>{let r=t.moveToLineBoundary(e,!0).head;return e.head<r?r:Math.min(t.state.doc.length,e.head+1)}),r2e=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>({changes:{from:n.from,to:n.to,insert:It.of(["",""])},range:Re.cursor(n.from)}));return e(t.update(r,{scrollIntoView:!0,userEvent:"input"})),!0},n2e=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=t.changeByRange(n=>{if(!n.empty||n.from==0||n.from==t.doc.length)return{range:n};let s=n.from,i=t.doc.lineAt(s),o=s==i.from?s-1:jr(i.text,s-i.from,!1)+i.from,a=s==i.to?s+1:jr(i.text,s-i.from,!0)+i.from;return{changes:{from:o,to:a,insert:t.doc.slice(s,a).append(t.doc.slice(o,s))},range:Re.cursor(a)}});return r.changes.empty?!1:(e(t.update(r,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Bb(t){let e=[],r=-1;for(let n of t.selection.ranges){let s=t.doc.lineAt(n.from),i=t.doc.lineAt(n.to);if(!n.empty&&n.to==i.from&&(i=t.doc.lineAt(n.to-1)),r>=s.number){let o=e[e.length-1];o.to=i.to,o.ranges.push(n)}else e.push({from:s.from,to:i.to,ranges:[n]});r=i.number+1}return e}function a7(t,e,r){if(t.readOnly)return!1;let n=[],s=[];for(let i of Bb(t)){if(r?i.to==t.doc.length:i.from==0)continue;let o=t.doc.lineAt(r?i.to+1:i.from-1),a=o.length+1;if(r){n.push({from:i.to,to:o.to},{from:i.from,insert:o.text+t.lineBreak});for(let l of i.ranges)s.push(Re.range(Math.min(t.doc.length,l.anchor+a),Math.min(t.doc.length,l.head+a)))}else{n.push({from:o.from,to:i.from},{from:i.to,insert:t.lineBreak+o.text});for(let l of i.ranges)s.push(Re.range(l.anchor-a,l.head-a))}}return n.length?(e(t.update({changes:n,scrollIntoView:!0,selection:Re.create(s,t.selection.mainIndex),userEvent:"move.line"})),!0):!1}const s2e=({state:t,dispatch:e})=>a7(t,e,!1),i2e=({state:t,dispatch:e})=>a7(t,e,!0);function l7(t,e,r){if(t.readOnly)return!1;let n=[];for(let s of Bb(t))r?n.push({from:s.from,insert:t.doc.slice(s.from,s.to)+t.lineBreak}):n.push({from:s.to,insert:t.lineBreak+t.doc.slice(s.from,s.to)});return e(t.update({changes:n,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const o2e=({state:t,dispatch:e})=>l7(t,e,!1),a2e=({state:t,dispatch:e})=>l7(t,e,!0),l2e=t=>{if(t.state.readOnly)return!1;let{state:e}=t,r=e.changes(Bb(e).map(({from:s,to:i})=>(s>0?s--:i<e.doc.length&&i++,{from:s,to:i}))),n=mh(e.selection,s=>{let i;if(t.lineWrapping){let o=t.lineBlockAt(s.head),a=t.coordsAtPos(s.head,s.assoc||1);a&&(i=o.bottom+t.documentTop-a.bottom+t.defaultLineHeight/2)}return t.moveVertically(s,!0,i)}).map(r);return t.dispatch({changes:r,selection:n,scrollIntoView:!0,userEvent:"delete.line"}),!0};function c2e(t,e){if(/\(\)|\[\]|\{\}/.test(t.sliceDoc(e-1,e+1)))return{from:e,to:e};let r=zr(t).resolveInner(e),n=r.childBefore(e),s=r.childAfter(e),i;return n&&s&&n.to<=e&&s.from>=e&&(i=n.type.prop(mt.closedBy))&&i.indexOf(s.name)>-1&&t.doc.lineAt(n.to).from==t.doc.lineAt(s.from).from&&!/\S/.test(t.sliceDoc(n.to,s.from))?{from:n.to,to:s.from}:null}const vL=c7(!1),u2e=c7(!0);function c7(t){return({state:e,dispatch:r})=>{if(e.readOnly)return!1;let n=e.changeByRange(s=>{let{from:i,to:o}=s,a=e.doc.lineAt(i),l=!t&&i==o&&c2e(e,i);t&&(i=o=(o<=a.to?a:e.doc.lineAt(o)).to);let c=new Db(e,{simulateBreak:i,simulateDoubleBreak:!!l}),u=Qk(c,i);for(u==null&&(u=kb(/^\s*/.exec(e.doc.lineAt(i).text)[0],e.tabSize));o<a.to&&/\s/.test(a.text[o-a.from]);)o++;l?{from:i,to:o}=l:i>a.from&&i<a.from+100&&!/\S/.test(a.text.slice(0,i))&&(i=a.from);let h=["",Nf(e,u)];return l&&h.push(Nf(e,c.lineIndent(a.from,-1))),{changes:{from:i,to:o,insert:It.of(h)},range:Re.cursor(i+1+h[1].length)}});return r(e.update(n,{scrollIntoView:!0,userEvent:"input"})),!0}}function dA(t,e){let r=-1;return t.changeByRange(n=>{let s=[];for(let o=n.from;o<=n.to;){let a=t.doc.lineAt(o);a.number>r&&(n.empty||n.to>a.from)&&(e(a,s,n),r=a.number),o=a.to+1}let i=t.changes(s);return{changes:s,range:Re.range(i.mapPos(n.anchor,1),i.mapPos(n.head,1))}})}const h2e=({state:t,dispatch:e})=>{if(t.readOnly)return!1;let r=Object.create(null),n=new Db(t,{overrideIndentation:i=>{let o=r[i];return o??-1}}),s=dA(t,(i,o,a)=>{let l=Qk(n,i.from);if(l==null)return;/\S/.test(i.text)||(l=0);let c=/^\s*/.exec(i.text)[0],u=Nf(t,l);(c!=u||a.from<i.from+c.length)&&(r[i.from]=l,o.push({from:i.from,to:i.from+c.length,insert:u}))});return s.changes.empty||e(t.update(s,{userEvent:"indent"})),!0},d2e=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(dA(t,(r,n)=>{n.push({from:r.from,insert:t.facet(fh)})}),{userEvent:"input.indent"})),!0),u7=({state:t,dispatch:e})=>t.readOnly?!1:(e(t.update(dA(t,(r,n)=>{let s=/^\s*/.exec(r.text)[0];if(!s)return;let i=kb(s,t.tabSize),o=0,a=Nf(t,Math.max(0,i-B_(t)));for(;o<s.length&&o<a.length&&s.charCodeAt(o)==a.charCodeAt(o);)o++;n.push({from:r.from+o,to:r.from+s.length,insert:a.slice(o)})}),{userEvent:"delete.dedent"})),!0),f2e=t=>(t.setTabFocusMode(),!0),p2e=[{key:"Ctrl-b",run:$9,shift:X9,preventDefault:!0},{key:"Ctrl-f",run:H9,shift:Z9},{key:"Ctrl-p",run:G9,shift:e7},{key:"Ctrl-n",run:W9,shift:t7},{key:"Ctrl-a",run:LAe,shift:WAe},{key:"Ctrl-e",run:NAe,shift:qAe},{key:"Ctrl-d",run:s7},{key:"Ctrl-h",run:TS},{key:"Ctrl-k",run:QAe},{key:"Ctrl-Alt-h",run:o7},{key:"Ctrl-o",run:r2e},{key:"Ctrl-t",run:n2e},{key:"Ctrl-v",run:SS}],m2e=[{key:"ArrowLeft",run:$9,shift:X9,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:TAe,shift:FAe,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:OAe,shift:VAe,preventDefault:!0},{key:"ArrowRight",run:H9,shift:Z9,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:CAe,shift:jAe,preventDefault:!0},{mac:"Cmd-ArrowRight",run:DAe,shift:GAe,preventDefault:!0},{key:"ArrowUp",run:G9,shift:e7,preventDefault:!0},{mac:"Cmd-ArrowUp",run:gL,shift:yL},{mac:"Ctrl-ArrowUp",run:fL,shift:pL},{key:"ArrowDown",run:W9,shift:t7,preventDefault:!0},{mac:"Cmd-ArrowDown",run:_L,shift:bL},{mac:"Ctrl-ArrowDown",run:SS,shift:mL},{key:"PageUp",run:fL,shift:pL},{key:"PageDown",run:SS,shift:mL},{key:"Home",run:PAe,shift:zAe,preventDefault:!0},{key:"Mod-Home",run:gL,shift:yL},{key:"End",run:IAe,shift:HAe,preventDefault:!0},{key:"Mod-End",run:_L,shift:bL},{key:"Enter",run:vL,shift:vL},{key:"Mod-a",run:KAe},{key:"Backspace",run:TS,shift:TS},{key:"Delete",run:s7},{key:"Mod-Backspace",mac:"Alt-Backspace",run:o7},{key:"Mod-Delete",mac:"Alt-Delete",run:JAe},{mac:"Mod-Backspace",run:e2e},{mac:"Mod-Delete",run:t2e}].concat(p2e.map(t=>({mac:t.key,run:t.run,shift:t.shift}))),g2e=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:AAe,shift:UAe},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:RAe,shift:$Ae},{key:"Alt-ArrowUp",run:s2e},{key:"Shift-Alt-ArrowUp",run:o2e},{key:"Alt-ArrowDown",run:i2e},{key:"Shift-Alt-ArrowDown",run:a2e},{key:"Escape",run:ZAe},{key:"Mod-Enter",run:u2e},{key:"Alt-l",mac:"Ctrl-l",run:YAe},{key:"Mod-i",run:XAe,preventDefault:!0},{key:"Mod-[",run:u7},{key:"Mod-]",run:d2e},{key:"Mod-Alt-\\",run:h2e},{key:"Shift-Mod-k",run:l2e},{key:"Shift-Mod-\\",run:BAe},{key:"Mod-/",run:oAe},{key:"Alt-A",run:lAe},{key:"Ctrl-m",mac:"Shift-Alt-m",run:f2e}].concat(m2e);function Wr(){var t=arguments[0];typeof t=="string"&&(t=document.createElement(t));var e=1,r=arguments[1];if(r&&typeof r=="object"&&r.nodeType==null&&!Array.isArray(r)){for(var n in r)if(Object.prototype.hasOwnProperty.call(r,n)){var s=r[n];typeof s=="string"?t.setAttribute(n,s):s!=null&&(t[n]=s)}e++}for(;e<arguments.length;e++)h7(t,arguments[e]);return t}function h7(t,e){if(typeof e=="string")t.appendChild(document.createTextNode(e));else if(e!=null)if(e.nodeType!=null)t.appendChild(e);else if(Array.isArray(e))for(var r=0;r<e.length;r++)h7(t,e[r]);else throw new RangeError("Unsupported child node: "+e)}const wL=typeof String.prototype.normalize=="function"?t=>t.normalize("NFKD"):t=>t;class Ff{constructor(e,r,n=0,s=e.length,i,o){this.test=o,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=e.iterRange(n,s),this.bufferStart=n,this.normalize=i?a=>i(wL(a)):wL,this.query=this.normalize(r)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return An(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let e=this.peek();if(e<0)return this.done=!0,this;let r=Mk(e),n=this.bufferStart+this.bufferPos;this.bufferPos+=Ds(e);let s=this.normalize(r);if(s.length)for(let i=0,o=n;;i++){let a=s.charCodeAt(i),l=this.match(a,o,this.bufferPos+this.bufferStart);if(i==s.length-1){if(l)return this.value=l,this;break}o==n&&i<r.length&&r.charCodeAt(i)==a&&o++}}}match(e,r,n){let s=null;for(let i=0;i<this.matches.length;i+=2){let o=this.matches[i],a=!1;this.query.charCodeAt(o)==e&&(o==this.query.length-1?s={from:this.matches[i+1],to:n}:(this.matches[i]++,a=!0)),a||(this.matches.splice(i,2),i-=2)}return this.query.charCodeAt(0)==e&&(this.query.length==1?s={from:r,to:n}:this.matches.push(1,r)),s&&this.test&&!this.test(s.from,s.to,this.buffer,this.bufferStart)&&(s=null),s}}typeof Symbol<"u"&&(Ff.prototype[Symbol.iterator]=function(){return this});const d7={from:-1,to:-1,match:/.*/.exec("")},fA="gm"+(/x/.unicode==null?"":"u");class f7{constructor(e,r,n,s=0,i=e.length){if(this.text=e,this.to=i,this.curLine="",this.done=!1,this.value=d7,/\\[sWDnr]|\n|\r|\[\^/.test(r))return new p7(e,r,n,s,i);this.re=new RegExp(r,fA+(n?.ignoreCase?"i":"")),this.test=n?.test,this.iter=e.iter();let o=e.lineAt(s);this.curLineStart=o.from,this.matchPos=z_(e,s),this.getLine(this.curLineStart)}getLine(e){this.iter.next(e),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let e=this.matchPos-this.curLineStart;;){this.re.lastIndex=e;let r=this.matchPos<=this.to&&this.re.exec(this.curLine);if(r){let n=this.curLineStart+r.index,s=n+r[0].length;if(this.matchPos=z_(this.text,s+(n==s?1:0)),n==this.curLineStart+this.curLine.length&&this.nextLine(),(n<s||n>this.value.to)&&(!this.test||this.test(n,s,r)))return this.value={from:n,to:s,match:r},this;e=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),e=0;else return this.done=!0,this}}}const Vw=new WeakMap;class uu{constructor(e,r){this.from=e,this.text=r}get to(){return this.from+this.text.length}static get(e,r,n){let s=Vw.get(e);if(!s||s.from>=n||s.to<=r){let a=new uu(r,e.sliceString(r,n));return Vw.set(e,a),a}if(s.from==r&&s.to==n)return s;let{text:i,from:o}=s;return o>r&&(i=e.sliceString(r,o)+i,o=r),s.to<n&&(i+=e.sliceString(s.to,n)),Vw.set(e,new uu(o,i)),new uu(r,i.slice(r-o,n-o))}}class p7{constructor(e,r,n,s,i){this.text=e,this.to=i,this.done=!1,this.value=d7,this.matchPos=z_(e,s),this.re=new RegExp(r,fA+(n?.ignoreCase?"i":"")),this.test=n?.test,this.flat=uu.get(e,s,this.chunkEnd(s+5e3))}chunkEnd(e){return e>=this.to?this.to:this.text.lineAt(e).to}next(){for(;;){let e=this.re.lastIndex=this.matchPos-this.flat.from,r=this.re.exec(this.flat.text);if(r&&!r[0]&&r.index==e&&(this.re.lastIndex=e+1,r=this.re.exec(this.flat.text)),r){let n=this.flat.from+r.index,s=n+r[0].length;if((this.flat.to>=this.to||r.index+r[0].length<=this.flat.text.length-10)&&(!this.test||this.test(n,s,r)))return this.value={from:n,to:s,match:r},this.matchPos=z_(this.text,s+(n==s?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=uu.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(f7.prototype[Symbol.iterator]=p7.prototype[Symbol.iterator]=function(){return this});function _2e(t){try{return new RegExp(t,fA),!0}catch{return!1}}function z_(t,e){if(e>=t.length)return e;let r=t.lineAt(e),n;for(;e<r.to&&(n=r.text.charCodeAt(e-r.from))>=56320&&n<57344;)e++;return e}function CS(t){let e=String(t.state.doc.lineAt(t.state.selection.main.head).number),r=Wr("input",{class:"cm-textfield",name:"line",value:e}),n=Wr("form",{class:"cm-gotoLine",onkeydown:i=>{i.keyCode==27?(i.preventDefault(),t.dispatch({effects:V_.of(!1)}),t.focus()):i.keyCode==13&&(i.preventDefault(),s())},onsubmit:i=>{i.preventDefault(),s()}},Wr("label",t.state.phrase("Go to line"),": ",r)," ",Wr("button",{class:"cm-button",type:"submit"},t.state.phrase("go")));function s(){let i=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(r.value);if(!i)return;let{state:o}=t,a=o.doc.lineAt(o.selection.main.head),[,l,c,u,h]=i,d=u?+u.slice(1):0,f=c?+c:a.number;if(c&&h){let m=f/100;l&&(m=m*(l=="-"?-1:1)+a.number/o.doc.lines),f=Math.round(o.doc.lines*m)}else c&&l&&(f=f*(l=="-"?-1:1)+a.number);let g=o.doc.line(Math.max(1,Math.min(o.doc.lines,f))),_=Re.cursor(g.from+Math.max(0,Math.min(d,g.length)));t.dispatch({effects:[V_.of(!1),Ge.scrollIntoView(_.from,{y:"center"})],selection:_}),t.focus()}return{dom:n}}const V_=ht.define(),EL=Pr.define({create(){return!0},update(t,e){for(let r of e.effects)r.is(V_)&&(t=r.value);return t},provide:t=>O_.from(t,e=>e?CS:null)}),y2e=t=>{let e=P_(t,CS);if(!e){let r=[V_.of(!0)];t.state.field(EL,!1)==null&&r.push(ht.appendConfig.of([EL,b2e])),t.dispatch({effects:r}),e=P_(t,CS)}return e&&e.dom.querySelector("input").select(),!0},b2e=Ge.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),v2e=({state:t,dispatch:e})=>{let{selection:r}=t,n=Re.create(r.ranges.map(s=>t.wordAt(s.head)||Re.cursor(s.head)),r.mainIndex);return n.eq(r)?!1:(e(t.update({selection:n})),!0)};function w2e(t,e){let{main:r,ranges:n}=t.selection,s=t.wordAt(r.head),i=s&&s.from==r.from&&s.to==r.to;for(let o=!1,a=new Ff(t.doc,e,n[n.length-1].to);;)if(a.next(),a.done){if(o)return null;a=new Ff(t.doc,e,0,Math.max(0,n[n.length-1].from-1)),o=!0}else{if(o&&n.some(l=>l.from==a.value.from))continue;if(i){let l=t.wordAt(a.value.from);if(!l||l.from!=a.value.from||l.to!=a.value.to)continue}return a.value}}const E2e=({state:t,dispatch:e})=>{let{ranges:r}=t.selection;if(r.some(i=>i.from===i.to))return v2e({state:t,dispatch:e});let n=t.sliceDoc(r[0].from,r[0].to);if(t.selection.ranges.some(i=>t.sliceDoc(i.from,i.to)!=n))return!1;let s=w2e(t,n);return s?(e(t.update({selection:t.selection.addRange(Re.range(s.from,s.to),!1),effects:Ge.scrollIntoView(s.to)})),!0):!1},gh=We.define({combine(t){return ac(t,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:e=>new L2e(e),scrollToMatch:e=>Ge.scrollIntoView(e)})}});class m7{constructor(e){this.search=e.search,this.caseSensitive=!!e.caseSensitive,this.literal=!!e.literal,this.regexp=!!e.regexp,this.replace=e.replace||"",this.valid=!!this.search&&(!this.regexp||_2e(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!e.wholeWord}unquote(e){return this.literal?e:e.replace(/\\([nrt\\])/g,(r,n)=>n=="n"?`
`:n=="r"?"\r":n=="t"?"	":"\\")}eq(e){return this.search==e.search&&this.replace==e.replace&&this.caseSensitive==e.caseSensitive&&this.regexp==e.regexp&&this.wholeWord==e.wholeWord}create(){return this.regexp?new C2e(this):new S2e(this)}getCursor(e,r=0,n){let s=e.doc?e:vt.create({doc:e});return n==null&&(n=s.doc.length),this.regexp?Oc(this,s,r,n):Pc(this,s,r,n)}}class g7{constructor(e){this.spec=e}}function Pc(t,e,r,n){return new Ff(e.doc,t.unquoted,r,n,t.caseSensitive?void 0:s=>s.toLowerCase(),t.wholeWord?x2e(e.doc,e.charCategorizer(e.selection.main.head)):void 0)}function x2e(t,e){return(r,n,s,i)=>((i>r||i+s.length<n)&&(i=Math.max(0,r-2),s=t.sliceString(i,Math.min(t.length,n+2))),(e(G_(s,r-i))!=mr.Word||e(W_(s,r-i))!=mr.Word)&&(e(W_(s,n-i))!=mr.Word||e(G_(s,n-i))!=mr.Word))}class S2e extends g7{constructor(e){super(e)}nextMatch(e,r,n){let s=Pc(this.spec,e,n,e.doc.length).nextOverlapping();if(s.done){let i=Math.min(e.doc.length,r+this.spec.unquoted.length);s=Pc(this.spec,e,0,i).nextOverlapping()}return s.done||s.value.from==r&&s.value.to==n?null:s.value}prevMatchInRange(e,r,n){for(let s=n;;){let i=Math.max(r,s-1e4-this.spec.unquoted.length),o=Pc(this.spec,e,i,s),a=null;for(;!o.nextOverlapping().done;)a=o.value;if(a)return a;if(i==r)return null;s-=1e4}}prevMatch(e,r,n){let s=this.prevMatchInRange(e,0,r);return s||(s=this.prevMatchInRange(e,Math.max(0,n-this.spec.unquoted.length),e.doc.length)),s&&(s.from!=r||s.to!=n)?s:null}getReplacement(e){return this.spec.unquote(this.spec.replace)}matchAll(e,r){let n=Pc(this.spec,e,0,e.doc.length),s=[];for(;!n.next().done;){if(s.length>=r)return null;s.push(n.value)}return s}highlight(e,r,n,s){let i=Pc(this.spec,e,Math.max(0,r-this.spec.unquoted.length),Math.min(n+this.spec.unquoted.length,e.doc.length));for(;!i.next().done;)s(i.value.from,i.value.to)}}function Oc(t,e,r,n){return new f7(e.doc,t.search,{ignoreCase:!t.caseSensitive,test:t.wholeWord?T2e(e.charCategorizer(e.selection.main.head)):void 0},r,n)}function G_(t,e){return t.slice(jr(t,e,!1),e)}function W_(t,e){return t.slice(e,jr(t,e))}function T2e(t){return(e,r,n)=>!n[0].length||(t(G_(n.input,n.index))!=mr.Word||t(W_(n.input,n.index))!=mr.Word)&&(t(W_(n.input,n.index+n[0].length))!=mr.Word||t(G_(n.input,n.index+n[0].length))!=mr.Word)}class C2e extends g7{nextMatch(e,r,n){let s=Oc(this.spec,e,n,e.doc.length).next();return s.done&&(s=Oc(this.spec,e,0,r).next()),s.done?null:s.value}prevMatchInRange(e,r,n){for(let s=1;;s++){let i=Math.max(r,n-s*1e4),o=Oc(this.spec,e,i,n),a=null;for(;!o.next().done;)a=o.value;if(a&&(i==r||a.from>i+10))return a;if(i==r)return null}}prevMatch(e,r,n){return this.prevMatchInRange(e,0,r)||this.prevMatchInRange(e,n,e.doc.length)}getReplacement(e){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(r,n)=>n=="$"?"$":n=="&"?e.match[0]:n!="0"&&+n<e.match.length?e.match[n]:r)}matchAll(e,r){let n=Oc(this.spec,e,0,e.doc.length),s=[];for(;!n.next().done;){if(s.length>=r)return null;s.push(n.value)}return s}highlight(e,r,n,s){let i=Oc(this.spec,e,Math.max(0,r-250),Math.min(n+250,e.doc.length));for(;!i.next().done;)s(i.value.from,i.value.to)}}const jf=ht.define(),pA=ht.define(),ba=Pr.define({create(t){return new Gw(kS(t).create(),null)},update(t,e){for(let r of e.effects)r.is(jf)?t=new Gw(r.value.create(),t.panel):r.is(pA)&&(t=new Gw(t.query,r.value?mA:null));return t},provide:t=>O_.from(t,e=>e.panel)});class Gw{constructor(e,r){this.query=e,this.panel=r}}const k2e=yt.mark({class:"cm-searchMatch"}),A2e=yt.mark({class:"cm-searchMatch cm-searchMatch-selected"}),R2e=Hr.fromClass(class{constructor(t){this.view=t,this.decorations=this.highlight(t.state.field(ba))}update(t){let e=t.state.field(ba);(e!=t.startState.field(ba)||t.docChanged||t.selectionSet||t.viewportChanged)&&(this.decorations=this.highlight(e))}highlight({query:t,panel:e}){if(!e||!t.spec.valid)return yt.none;let{view:r}=this,n=new Gl;for(let s=0,i=r.visibleRanges,o=i.length;s<o;s++){let{from:a,to:l}=i[s];for(;s<o-1&&l>i[s+1].from-2*250;)l=i[++s].to;t.highlight(r.state,a,l,(c,u)=>{let h=r.state.selection.ranges.some(d=>d.from==c&&d.to==u);n.add(c,u,h?A2e:k2e)})}return n.finish()}},{decorations:t=>t.decorations});function $p(t){return e=>{let r=e.state.field(ba,!1);return r&&r.query.spec.valid?t(e,r):b7(e)}}const q_=$p((t,{query:e})=>{let{to:r}=t.state.selection.main,n=e.nextMatch(t.state,r,r);if(!n)return!1;let s=Re.single(n.from,n.to),i=t.state.facet(gh);return t.dispatch({selection:s,effects:[gA(t,n),i.scrollToMatch(s.main,t)],userEvent:"select.search"}),y7(t),!0}),K_=$p((t,{query:e})=>{let{state:r}=t,{from:n}=r.selection.main,s=e.prevMatch(r,n,n);if(!s)return!1;let i=Re.single(s.from,s.to),o=t.state.facet(gh);return t.dispatch({selection:i,effects:[gA(t,s),o.scrollToMatch(i.main,t)],userEvent:"select.search"}),y7(t),!0}),I2e=$p((t,{query:e})=>{let r=e.matchAll(t.state,1e3);return!r||!r.length?!1:(t.dispatch({selection:Re.create(r.map(n=>Re.range(n.from,n.to))),userEvent:"select.search.matches"}),!0)}),P2e=({state:t,dispatch:e})=>{let r=t.selection;if(r.ranges.length>1||r.main.empty)return!1;let{from:n,to:s}=r.main,i=[],o=0;for(let a=new Ff(t.doc,t.sliceDoc(n,s));!a.next().done;){if(i.length>1e3)return!1;a.value.from==n&&(o=i.length),i.push(Re.range(a.value.from,a.value.to))}return e(t.update({selection:Re.create(i,o),userEvent:"select.search.matches"})),!0},xL=$p((t,{query:e})=>{let{state:r}=t,{from:n,to:s}=r.selection.main;if(r.readOnly)return!1;let i=e.nextMatch(r,n,n);if(!i)return!1;let o=i,a=[],l,c,u=[];if(o.from==n&&o.to==s&&(c=r.toText(e.getReplacement(o)),a.push({from:o.from,to:o.to,insert:c}),o=e.nextMatch(r,o.from,o.to),u.push(Ge.announce.of(r.phrase("replaced match on line $",r.doc.lineAt(n).number)+"."))),o){let h=a.length==0||a[0].from>=i.to?0:i.to-i.from-c.length;l=Re.single(o.from-h,o.to-h),u.push(gA(t,o)),u.push(r.facet(gh).scrollToMatch(l.main,t))}return t.dispatch({changes:a,selection:l,effects:u,userEvent:"input.replace"}),!0}),O2e=$p((t,{query:e})=>{if(t.state.readOnly)return!1;let r=e.matchAll(t.state,1e9).map(s=>{let{from:i,to:o}=s;return{from:i,to:o,insert:e.getReplacement(s)}});if(!r.length)return!1;let n=t.state.phrase("replaced $ matches",r.length)+".";return t.dispatch({changes:r,effects:Ge.announce.of(n),userEvent:"input.replace.all"}),!0});function mA(t){return t.state.facet(gh).createPanel(t)}function kS(t,e){var r,n,s,i,o;let a=t.selection.main,l=a.empty||a.to>a.from+100?"":t.sliceDoc(a.from,a.to);if(e&&!l)return e;let c=t.facet(gh);return new m7({search:((r=e?.literal)!==null&&r!==void 0?r:c.literal)?l:l.replace(/\n/g,"\\n"),caseSensitive:(n=e?.caseSensitive)!==null&&n!==void 0?n:c.caseSensitive,literal:(s=e?.literal)!==null&&s!==void 0?s:c.literal,regexp:(i=e?.regexp)!==null&&i!==void 0?i:c.regexp,wholeWord:(o=e?.wholeWord)!==null&&o!==void 0?o:c.wholeWord})}function _7(t){let e=P_(t,mA);return e&&e.dom.querySelector("[main-field]")}function y7(t){let e=_7(t);e&&e==t.root.activeElement&&e.select()}const b7=t=>{let e=t.state.field(ba,!1);if(e&&e.panel){let r=_7(t);if(r&&r!=t.root.activeElement){let n=kS(t.state,e.query.spec);n.valid&&t.dispatch({effects:jf.of(n)}),r.focus(),r.select()}}else t.dispatch({effects:[pA.of(!0),e?jf.of(kS(t.state,e.query.spec)):ht.appendConfig.of(M2e)]});return!0},v7=t=>{let e=t.state.field(ba,!1);if(!e||!e.panel)return!1;let r=P_(t,mA);return r&&r.dom.contains(t.root.activeElement)&&t.focus(),t.dispatch({effects:pA.of(!1)}),!0},D2e=[{key:"Mod-f",run:b7,scope:"editor search-panel"},{key:"F3",run:q_,shift:K_,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:q_,shift:K_,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:v7,scope:"editor search-panel"},{key:"Mod-Shift-l",run:P2e},{key:"Mod-Alt-g",run:y2e},{key:"Mod-d",run:E2e,preventDefault:!0}];class L2e{constructor(e){this.view=e;let r=this.query=e.state.field(ba).query.spec;this.commit=this.commit.bind(this),this.searchField=Wr("input",{value:r.search,placeholder:jn(e,"Find"),"aria-label":jn(e,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=Wr("input",{value:r.replace,placeholder:jn(e,"Replace"),"aria-label":jn(e,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=Wr("input",{type:"checkbox",name:"case",form:"",checked:r.caseSensitive,onchange:this.commit}),this.reField=Wr("input",{type:"checkbox",name:"re",form:"",checked:r.regexp,onchange:this.commit}),this.wordField=Wr("input",{type:"checkbox",name:"word",form:"",checked:r.wholeWord,onchange:this.commit});function n(s,i,o){return Wr("button",{class:"cm-button",name:s,onclick:i,type:"button"},o)}this.dom=Wr("div",{onkeydown:s=>this.keydown(s),class:"cm-search"},[this.searchField,n("next",()=>q_(e),[jn(e,"next")]),n("prev",()=>K_(e),[jn(e,"previous")]),n("select",()=>I2e(e),[jn(e,"all")]),Wr("label",null,[this.caseField,jn(e,"match case")]),Wr("label",null,[this.reField,jn(e,"regexp")]),Wr("label",null,[this.wordField,jn(e,"by word")]),...e.state.readOnly?[]:[Wr("br"),this.replaceField,n("replace",()=>xL(e),[jn(e,"replace")]),n("replaceAll",()=>O2e(e),[jn(e,"replace all")])],Wr("button",{name:"close",onclick:()=>v7(e),"aria-label":jn(e,"close"),type:"button"},["×"])])}commit(){let e=new m7({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});e.eq(this.query)||(this.query=e,this.view.dispatch({effects:jf.of(e)}))}keydown(e){bTe(this.view,e,"search-panel")?e.preventDefault():e.keyCode==13&&e.target==this.searchField?(e.preventDefault(),(e.shiftKey?K_:q_)(this.view)):e.keyCode==13&&e.target==this.replaceField&&(e.preventDefault(),xL(this.view))}update(e){for(let r of e.transactions)for(let n of r.effects)n.is(jf)&&!n.value.eq(this.query)&&this.setQuery(n.value)}setQuery(e){this.query=e,this.searchField.value=e.search,this.replaceField.value=e.replace,this.caseField.checked=e.caseSensitive,this.reField.checked=e.regexp,this.wordField.checked=e.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(gh).top}}function jn(t,e){return t.state.phrase(e)}const bg=30,vg=/[\s\.,:;?!]/;function gA(t,{from:e,to:r}){let n=t.state.doc.lineAt(e),s=t.state.doc.lineAt(r).to,i=Math.max(n.from,e-bg),o=Math.min(s,r+bg),a=t.state.sliceDoc(i,o);if(i!=n.from){for(let l=0;l<bg;l++)if(!vg.test(a[l+1])&&vg.test(a[l])){a=a.slice(l);break}}if(o!=s){for(let l=a.length-1;l>a.length-bg;l--)if(!vg.test(a[l-1])&&vg.test(a[l])){a=a.slice(0,l);break}}return Ge.announce.of(`${t.state.phrase("current match")}. ${a} ${t.state.phrase("on line")} ${n.number}.`)}const N2e=Ge.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),M2e=[ba,Va.low(R2e),N2e];function B2e(){return T.jsx("div",{className:"flex items-center justify-center absolute inset-0 z-10 text-sm bg-tk-elements-app-backgroundColor text-tk-elements-app-textColor",children:"File format cannot be displayed."})}function Y_(){return Y_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Y_.apply(null,arguments)}var w7=t=>{var{theme:e,settings:r={},styles:n=[]}=t,s={".cm-gutters":{}},i={};r.background&&(i.backgroundColor=r.background),r.backgroundImage&&(i.backgroundImage=r.backgroundImage),r.foreground&&(i.color=r.foreground),r.fontSize&&(i.fontSize=r.fontSize),(r.background||r.foreground)&&(s["&"]=i),r.fontFamily&&(s["&.cm-editor .cm-scroller"]={fontFamily:r.fontFamily}),r.gutterBackground&&(s[".cm-gutters"].backgroundColor=r.gutterBackground),r.gutterForeground&&(s[".cm-gutters"].color=r.gutterForeground),r.gutterBorder&&(s[".cm-gutters"].borderRightColor=r.gutterBorder),r.caret&&(s[".cm-content"]={caretColor:r.caret},s[".cm-cursor, .cm-dropCursor"]={borderLeftColor:r.caret});var o={};r.gutterActiveForeground&&(o.color=r.gutterActiveForeground),r.lineHighlight&&(s[".cm-activeLine"]={backgroundColor:r.lineHighlight},o.backgroundColor=r.lineHighlight),s[".cm-activeLineGutter"]=o,r.selection&&(s["&.cm-focused .cm-selectionBackground, & .cm-line::selection, & .cm-selectionLayer .cm-selectionBackground, .cm-content ::selection"]={background:r.selection+" !important"}),r.selectionMatch&&(s["& .cm-selectionMatch"]={backgroundColor:r.selectionMatch});var a=Ge.theme(s,{dark:e==="dark"}),l=Fp.define(n),c=[a,YCe(l)];return c},F2e={background:"#ffffff",foreground:"#383a42",caret:"#000",selection:"#add6ff",selectionMatch:"#a8ac94",lineHighlight:"#99999926",gutterBackground:"#fff",gutterForeground:"#237893",gutterActiveForeground:"#0b216f",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},j2e=[{tag:[ue.keyword,ue.operatorKeyword,ue.modifier,ue.color,ue.constant(ue.name),ue.standard(ue.name),ue.standard(ue.tagName),ue.special(ue.brace),ue.atom,ue.bool,ue.special(ue.variableName)],color:"#0000ff"},{tag:[ue.moduleKeyword,ue.controlKeyword],color:"#af00db"},{tag:[ue.name,ue.deleted,ue.character,ue.macroName,ue.propertyName,ue.variableName,ue.labelName,ue.definition(ue.name)],color:"#0070c1"},{tag:ue.heading,fontWeight:"bold",color:"#0070c1"},{tag:[ue.typeName,ue.className,ue.tagName,ue.number,ue.changed,ue.annotation,ue.self,ue.namespace],color:"#267f99"},{tag:[ue.function(ue.variableName),ue.function(ue.propertyName)],color:"#795e26"},{tag:[ue.number],color:"#098658"},{tag:[ue.operator,ue.punctuation,ue.separator,ue.url,ue.escape,ue.regexp],color:"#383a42"},{tag:[ue.regexp],color:"#af00db"},{tag:[ue.special(ue.string),ue.processingInstruction,ue.string,ue.inserted],color:"#a31515"},{tag:[ue.angleBracket],color:"#383a42"},{tag:ue.strong,fontWeight:"bold"},{tag:ue.emphasis,fontStyle:"italic"},{tag:ue.strikethrough,textDecoration:"line-through"},{tag:[ue.meta,ue.comment],color:"#008000"},{tag:ue.link,color:"#4078f2",textDecoration:"underline"},{tag:ue.invalid,color:"#e45649"}];function U2e(t){var{theme:e="light",settings:r={},styles:n=[]}={};return w7({theme:e,settings:Y_({},F2e,r),styles:[...j2e,...n]})}var $2e=U2e(),H2e={background:"#1e1e1e",foreground:"#9cdcfe",caret:"#c6c6c6",selection:"#6199ff2f",selectionMatch:"#72a1ff59",lineHighlight:"#ffffff0f",gutterBackground:"#1e1e1e",gutterForeground:"#838383",gutterActiveForeground:"#fff",fontFamily:'Menlo, Monaco, Consolas, "Andale Mono", "Ubuntu Mono", "Courier New", monospace'},z2e=[{tag:[ue.keyword,ue.operatorKeyword,ue.modifier,ue.color,ue.constant(ue.name),ue.standard(ue.name),ue.standard(ue.tagName),ue.special(ue.brace),ue.atom,ue.bool,ue.special(ue.variableName)],color:"#569cd6"},{tag:[ue.controlKeyword,ue.moduleKeyword],color:"#c586c0"},{tag:[ue.name,ue.deleted,ue.character,ue.macroName,ue.propertyName,ue.variableName,ue.labelName,ue.definition(ue.name)],color:"#9cdcfe"},{tag:ue.heading,fontWeight:"bold",color:"#9cdcfe"},{tag:[ue.typeName,ue.className,ue.tagName,ue.number,ue.changed,ue.annotation,ue.self,ue.namespace],color:"#4ec9b0"},{tag:[ue.function(ue.variableName),ue.function(ue.propertyName)],color:"#dcdcaa"},{tag:[ue.number],color:"#b5cea8"},{tag:[ue.operator,ue.punctuation,ue.separator,ue.url,ue.escape,ue.regexp],color:"#d4d4d4"},{tag:[ue.regexp],color:"#d16969"},{tag:[ue.special(ue.string),ue.processingInstruction,ue.string,ue.inserted],color:"#ce9178"},{tag:[ue.angleBracket],color:"#808080"},{tag:ue.strong,fontWeight:"bold"},{tag:ue.emphasis,fontStyle:"italic"},{tag:ue.strikethrough,textDecoration:"line-through"},{tag:[ue.meta,ue.comment],color:"#6a9955"},{tag:ue.link,color:"#6a9955",textDecoration:"underline"},{tag:ue.invalid,color:"#ff0000"}];function V2e(t){var{theme:e="dark",settings:r={},styles:n=[]}={};return w7({theme:e,settings:Y_({},H2e,r),styles:[...z2e,...n]})}var G2e=V2e();Ge.theme({},{dark:!0});const AS=new hh;function W2e(t,e={}){return[q2e(e),t==="dark"?AS.of([S7()]):AS.of([x7()])]}function E7(t){return AS.reconfigure(t==="dark"?S7():x7())}function q2e(t){return Ge.theme({"&":{fontSize:t.fontSize??"12px"},"&.cm-editor":{height:"100%",background:"var(--cm-backgroundColor)",color:"var(--cm-textColor)"},".cm-cursor":{borderLeft:"var(--cm-cursor-width) solid var(--cm-cursor-backgroundColor)"},".cm-scroller":{lineHeight:"1.5","&:focus-visible":{outline:"none"}},".cm-line":{padding:"0 0 0 4px"},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{backgroundColor:"var(--cm-selection-backgroundColorFocused) !important",opacity:"var(--cm-selection-backgroundOpacityFocused, 0.3)"},"&:not(.cm-focused) > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{backgroundColor:"var(--cm-selection-backgroundColorBlured)",opacity:"var(--cm-selection-backgroundOpacityBlured, 0.3)"},"&.cm-focused > .cm-scroller .cm-matchingBracket":{backgroundColor:"var(--cm-matching-bracket)"},".cm-activeLine":{background:"var(--cm-activeLineBackgroundColor)"},".cm-gutters":{background:"var(--cm-gutter-backgroundColor)",borderRight:0,color:"var(--cm-gutter-textColor)"},".cm-gutter":{"&.cm-lineNumbers":{fontFamily:"Roboto Mono, monospace",fontSize:t.gutterFontSize??t.fontSize??"12px",minWidth:"40px"},"& .cm-activeLineGutter":{background:"transparent",color:"var(--cm-gutter-activeLineTextColor)"},"&.cm-foldGutter .cm-gutterElement > .fold-icon":{cursor:"pointer",color:"var(--cm-foldGutter-textColor)",transform:"translateY(2px)","&:hover":{color:"var(--cm-foldGutter-textColorHover)"}}},".cm-foldGutter .cm-gutterElement":{padding:"0 4px"},".cm-tooltip-autocomplete > ul > li":{minHeight:"18px"},".cm-panel.cm-search label":{marginLeft:"2px",fontSize:"12px"},".cm-panel.cm-search .cm-button":{fontSize:"12px"},".cm-panel.cm-search .cm-textfield":{fontSize:"12px"},".cm-panel.cm-search input[type=checkbox]":{position:"relative",transform:"translateY(2px)",marginRight:"4px"},".cm-panels":{borderColor:"var(--cm-panels-borderColor)"},".cm-panels-bottom":{borderTop:"1px solid var(--cm-panels-borderColor)",backgroundColor:"transparent"},".cm-panel.cm-search":{background:"var(--cm-search-backgroundColor)",color:"var(--cm-search-textColor)",padding:"8px"},".cm-search .cm-button":{background:"var(--cm-search-button-backgroundColor)",borderColor:"var(--cm-search-button-borderColor)",color:"var(--cm-search-button-textColor)",borderRadius:"4px","&:hover":{color:"var(--cm-search-button-textColorHover)"},"&:focus-visible":{outline:"none",borderColor:"var(--cm-search-button-borderColorFocused)"},"&:hover:not(:focus-visible)":{background:"var(--cm-search-button-backgroundColorHover)",borderColor:"var(--cm-search-button-borderColorHover)"},"&:hover:focus-visible":{background:"var(--cm-search-button-backgroundColorHover)",borderColor:"var(--cm-search-button-borderColorFocused)"}},".cm-panel.cm-search [name=close]":{top:"6px",right:"6px",padding:"0 6px",fontSize:"1rem",backgroundColor:"var(--cm-search-closeButton-backgroundColor)",color:"var(--cm-search-closeButton-textColor)","&:hover":{"border-radius":"6px",color:"var(--cm-search-closeButton-textColorHover)",backgroundColor:"var(--cm-search-closeButton-backgroundColorHover)"}},".cm-search input":{background:"var(--cm-search-input-backgroundColor)",borderColor:"var(--cm-search-input-borderColor)",color:"var(--cm-search-input-textColor)",outline:"none",borderRadius:"4px","&:focus-visible":{borderColor:"var(--cm-search-input-borderColorFocused)"}},".cm-tooltip":{background:"var(--cm-tooltip-backgroundColor)",border:"1px solid transparent",borderColor:"var(--cm-tooltip-borderColor)",color:"var(--cm-tooltip-textColor)"},".cm-tooltip.cm-tooltip-autocomplete ul li[aria-selected]":{background:"var(--cm-tooltip-backgroundColorSelected)",color:"var(--cm-tooltip-textColorSelected)"},".cm-searchMatch":{backgroundColor:"var(--cm-searchMatch-backgroundColor)"},".cm-tooltip.cm-readonly-tooltip":{padding:"4px",whiteSpace:"nowrap",backgroundColor:"var(--Terretacode-elements-bg-depth-2)",borderColor:"var(--Terretacode-elements-borderColorActive)","& .cm-tooltip-arrow:before":{borderTopColor:"var(--Terretacode-elements-borderColorActive)"},"& .cm-tooltip-arrow:after":{borderTopColor:"transparent"}}})}function x7(){return $2e}function S7(){return G2e}const K2e={key:"Tab",run:Y2e,shift:u7};function Y2e({state:t,dispatch:e}){return t.readOnly?!1:(e(t.update(X2e(t,(r,n,s)=>{s.push({from:r,to:n,insert:t.facet(fh)})}),{userEvent:"input.indent"})),!0)}function X2e(t,e){return t.changeByRange(r=>{const n=[],s=t.doc.lineAt(r.from);if(r.from===r.to)e(r.from,void 0,n,s);else if(r.from<r.to&&r.to<=s.to)e(r.from,r.to,n,s);else{let o=-1;for(let a=r.from;a<=r.to;){const l=t.doc.lineAt(a);l.number>o&&(r.empty||r.to>l.from)&&(e(l.from,void 0,n,l),o=l.number),a=l.to+1}}const i=t.changes(n);return{changes:n,range:Re.range(i.mapPos(r.anchor,1),i.mapPos(r.head,1))}})}const Z2e=[Lr.of({name:"VUE",extensions:["vue"],async load(){return Z(()=>import("./index-C8U1dKiA.js"),__vite__mapDeps([0,1,2,3,4,5,6])).then(t=>t.vue())}}),Lr.of({name:"TS",extensions:["ts"],async load(){return Z(()=>import("./index-BRPR2os5.js"),__vite__mapDeps([6,2,4,5])).then(t=>t.javascript({typescript:!0}))}}),Lr.of({name:"JS",extensions:["js","mjs","cjs"],async load(){return Z(()=>import("./index-BRPR2os5.js"),__vite__mapDeps([6,2,4,5])).then(t=>t.javascript())}}),Lr.of({name:"TSX",extensions:["tsx"],async load(){return Z(()=>import("./index-BRPR2os5.js"),__vite__mapDeps([6,2,4,5])).then(t=>t.javascript({jsx:!0,typescript:!0}))}}),Lr.of({name:"JSX",extensions:["jsx"],async load(){return Z(()=>import("./index-BRPR2os5.js"),__vite__mapDeps([6,2,4,5])).then(t=>t.javascript({jsx:!0}))}}),Lr.of({name:"HTML",extensions:["html"],async load(){return Z(()=>import("./index-BDu9a_vH.js"),__vite__mapDeps([1,2,3,4,5,6])).then(t=>t.html())}}),Lr.of({name:"CSS",extensions:["css"],async load(){return Z(()=>import("./index-iVHMzJ5-.js"),__vite__mapDeps([3,2,4,5])).then(t=>t.css())}}),Lr.of({name:"SASS",extensions:["sass"],async load(){return Z(()=>import("./index-90D1X0VZ.js"),__vite__mapDeps([7,2,3,4,5])).then(t=>t.sass({indented:!0}))}}),Lr.of({name:"SCSS",extensions:["scss"],async load(){return Z(()=>import("./index-90D1X0VZ.js"),__vite__mapDeps([7,2,3,4,5])).then(t=>t.sass({indented:!1}))}}),Lr.of({name:"JSON",extensions:["json"],async load(){return Z(()=>import("./index-tGDBFCLz.js"),__vite__mapDeps([8,2,4,5])).then(t=>t.json())}}),Lr.of({name:"Markdown",extensions:["md"],async load(){return Z(()=>import("./index-CPtbUIOt.js"),__vite__mapDeps([9,1,2,3,4,5,6])).then(t=>t.markdown())}}),Lr.of({name:"Wasm",extensions:["wat"],async load(){return Z(()=>import("./index-DEbcG5AI.js"),__vite__mapDeps([10,2,4,5])).then(t=>t.wast())}}),Lr.of({name:"Python",extensions:["py"],async load(){return Z(()=>import("./index-BkqrjoNf.js"),__vite__mapDeps([11,2,4,5])).then(t=>t.python())}}),Lr.of({name:"C++",extensions:["cpp"],async load(){return Z(()=>import("./index-BtKtWAlO.js"),__vite__mapDeps([12,2,4,5])).then(t=>t.cpp())}})];async function J2e(t){const e=Lr.matchFilename(Z2e,t);if(e)return await e.load()}const Q2e=Fn("CodeMirrorEditor"),T7=ht.define(),eRe=Pr.define({create:()=>[],update(t,e){if(!e.state.readOnly)return[];for(const r of e.effects)if(r.is(T7)&&r.value)return nRe(e.state);return[]},provide:t=>Yk.computeN([t],e=>e.field(t))}),C7=ht.define(),SL=Pr.define({create(){return!0},update(t,e){for(const r of e.effects)if(r.is(C7))return r.value;return t}}),k7=I.memo(({id:t,doc:e,debounceScroll:r=100,debounceChange:n=150,autoFocusOnDocumentChange:s=!1,editable:i=!0,onScroll:o,onChange:a,onSave:l,theme:c,settings:u,className:h=""})=>{Xu.trace("CodeMirrorEditor");const[d]=I.useState(new hh),f=I.useRef(null),g=I.useRef(),_=I.useRef(),m=I.useRef(),p=I.useRef(),y=I.useRef(o),b=I.useRef(a),v=I.useRef(l);return I.useEffect(()=>{y.current=o,b.current=a,v.current=l,m.current=e,_.current=c}),I.useEffect(()=>{const w=Cb(S=>{b.current?.(S)},n),E=new Ge({parent:f.current,dispatchTransactions(S){const x=E.state.selection;E.update(S);const C=E.state.selection,A=C!==x&&(C===void 0||x===void 0||!C.eq(x));m.current&&(S.some(M=>M.docChanged)||A)&&(w({selection:E.state.selection,content:E.state.doc.toString()}),p.current.set(m.current.filePath,E.state))}});return g.current=E,()=>{g.current?.destroy(),g.current=void 0}},[]),I.useEffect(()=>{g.current&&g.current.dispatch({effects:[E7(c)]})},[c]),I.useEffect(()=>{p.current=new Map},[t]),I.useEffect(()=>{const w=p.current,E=g.current,S=_.current;if(!e){const C=TL("",S,u,y,r,v,[d.of([])]);E.setState(C),tRe(E);return}if(e.isBinary)return;e.filePath===""&&Q2e.warn("File path should not be empty");let x=w.get(e.filePath);x||(x=TL(e.value,S,u,y,r,v,[d.of([])]),w.set(e.filePath,x)),E.setState(x),rRe(E,S,i,d,s,e)},[e?.value,i,e?.filePath,s]),T.jsxs("div",{className:qe("relative h-full",h),children:[e?.isBinary&&T.jsx(B2e,{}),T.jsx("div",{className:"h-full overflow-hidden",ref:f})]})});k7.displayName="CodeMirrorEditor";function TL(t,e,r,n,s,i,o){return vt.create({doc:t,extensions:[Ge.domEventHandlers({scroll:Cb((a,l)=>{a.target===l.scrollDOM&&n.current?.({left:l.scrollDOM.scrollLeft,top:l.scrollDOM.scrollTop})},s),keydown:(a,l)=>l.state.readOnly?(l.dispatch({effects:[T7.of(a.key!=="Escape")]}),!0):!1}),W2e(e,r),mAe(),Ob.of([...g2e,...SAe,...D2e,{key:"Tab",run:R9},{key:"Mod-s",preventDefault:!0,run:()=>(i.current?.(),!0)},K2e]),fh.of("	"),nAe({closeOnBlur:!1}),MTe({position:"absolute",parent:document.body,tooltipSpace:a=>{const l=a.dom.getBoundingClientRect();return{top:l.top-50,left:l.left,bottom:l.bottom,right:l.right+10}}}),qke(),YTe(),PTe(),ITe(),TTe(),ske(),vt.tabSize.of(r?.tabSize??2),MCe(),eRe,SL,vt.readOnly.from(SL,a=>!a),JTe(),OTe(),WCe({markerDOM:a=>{const l=document.createElement("div");return l.className=`fold-icon ${a?"i-ph-caret-down-bold":"i-ph-caret-right-bold"}`,l}}),...o]})}function tRe(t){t.dispatch({selection:{anchor:0},changes:{from:0,to:t.state.doc.length,insert:""}}),t.scrollDOM.scrollTo(0,0)}function rRe(t,e,r,n,s,i){i.value!==t.state.doc.toString()&&t.dispatch({selection:{anchor:0},changes:{from:0,to:t.state.doc.length,insert:i.value}}),t.dispatch({effects:[C7.of(r&&!i.isBinary)]}),J2e(i.filePath).then(o=>{o&&(t.dispatch({effects:[n.reconfigure([o]),E7(e)]}),requestAnimationFrame(()=>{const a=t.scrollDOM.scrollLeft,l=t.scrollDOM.scrollTop,c=i.scroll?.left??0,u=i.scroll?.top??0;s&&r&&(a!==c||l!==u?t.scrollDOM.addEventListener("scroll",()=>{t.focus()},{once:!0}):t.focus()),t.scrollDOM.scrollTo(c,u)}))})}function nRe(t){return t.readOnly?t.selection.ranges.filter(e=>e.empty).map(e=>({pos:e.head,above:!0,strictSide:!0,arrow:!0,create:()=>{const r=document.createElement("div");return r.className="cm-readonly-tooltip",r.textContent="Cannot edit file while AI response is being generated",{dom:r}}})):[]}const qc=I.memo(({className:t,disabledClassName:e,disabled:r=!1,children:n,onClick:s})=>T.jsx("button",{className:qe("flex items-center shrink-0 gap-1.5 px-1.5 rounded-md py-0.5 text-Terretacode-elements-item-contentDefault bg-transparent enabled:hover:text-Terretacode-elements-item-contentActive enabled:hover:bg-Terretacode-elements-item-backgroundActive disabled:cursor-not-allowed",{[qe("opacity-30",e)]:r},t),disabled:r,onClick:i=>{r||s?.(i)},children:n})),sRe=I.memo,iRe=sRe(({selected:t,options:e,setSelected:r})=>{const n=t===e.left.value;return T.jsxs("div",{className:"flex items-center flex-wrap shrink-0 gap-1 bg-Terretacode-elements-background-depth-1 overflow-hidden rounded-full p-1",children:[T.jsx(CL,{selected:n,setSelected:()=>r?.(e.left.value),children:e.left.text}),T.jsx(CL,{selected:!n,setSelected:()=>r?.(e.right.value),children:e.right.text})]})}),CL=I.memo(({selected:t,children:e,setSelected:r})=>T.jsxs("button",{onClick:r,className:qe("bg-transparent text-sm px-2.5 py-0.5 rounded-full relative",t?"text-Terretacode-elements-item-contentAccent":"text-Terretacode-elements-item-contentDefault hover:text-Terretacode-elements-item-contentActive"),children:[T.jsx("span",{className:"relative z-10",children:e}),t&&T.jsx(yr.span,{layoutId:"pill-tab",transition:{duration:.2,ease:Ss},className:"absolute inset-0 z-0 bg-Terretacode-elements-item-backgroundAccent rounded-full"})]})),{createElement:Fu,createContext:oRe,createRef:_9e,forwardRef:A7,useCallback:Cn,useContext:R7,useEffect:Ol,useImperativeHandle:I7,useLayoutEffect:aRe,useMemo:lRe,useRef:kn,useState:hu}=wT,kL=wT[`useId${Math.random()}`.slice(0,5)],cRe=aRe,Fb=oRe(null);Fb.displayName="PanelGroupContext";const Dl=cRe,uRe=typeof kL=="function"?kL:()=>null;let hRe=0;function _A(t=null){const e=uRe(),r=kn(t||e||null);return r.current===null&&(r.current=""+hRe++),t??r.current}function P7({children:t,className:e="",collapsedSize:r,collapsible:n,defaultSize:s,forwardedRef:i,id:o,maxSize:a,minSize:l,onCollapse:c,onExpand:u,onResize:h,order:d,style:f,tagName:g="div",..._}){const m=R7(Fb);if(m===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:p,expandPanel:y,getPanelSize:b,getPanelStyle:v,groupId:w,isPanelCollapsed:E,reevaluatePanelConstraints:S,registerPanel:x,resizePanel:C,unregisterPanel:A}=m,M=_A(o),P=kn({callbacks:{onCollapse:c,onExpand:u,onResize:h},constraints:{collapsedSize:r,collapsible:n,defaultSize:s,maxSize:a,minSize:l},id:M,idIsFromProps:o!==void 0,order:d});kn({didLogMissingDefaultSizeWarning:!1}),Dl(()=>{const{callbacks:R,constraints:G}=P.current,ee={...G};P.current.id=M,P.current.idIsFromProps=o!==void 0,P.current.order=d,R.onCollapse=c,R.onExpand=u,R.onResize=h,G.collapsedSize=r,G.collapsible=n,G.defaultSize=s,G.maxSize=a,G.minSize=l,(ee.collapsedSize!==G.collapsedSize||ee.collapsible!==G.collapsible||ee.maxSize!==G.maxSize||ee.minSize!==G.minSize)&&S(P.current,ee)}),Dl(()=>{const R=P.current;return x(R),()=>{A(R)}},[d,M,x,A]),I7(i,()=>({collapse:()=>{p(P.current)},expand:R=>{y(P.current,R)},getId(){return M},getSize(){return b(P.current)},isCollapsed(){return E(P.current)},isExpanded(){return!E(P.current)},resize:R=>{C(P.current,R)}}),[p,y,b,E,M,C]);const D=v(P.current,s);return Fu(g,{..._,children:t,className:e,id:o,style:{...D,...f},"data-panel":"","data-panel-collapsible":n||void 0,"data-panel-group-id":w,"data-panel-id":M,"data-panel-size":parseFloat(""+D.flexGrow).toFixed(1)})}const Fd=A7((t,e)=>Fu(P7,{...t,forwardedRef:e}));P7.displayName="Panel";Fd.displayName="forwardRef(Panel)";let RS=null,_l=null;function dRe(t,e){if(e){const r=(e&M7)!==0,n=(e&B7)!==0,s=(e&F7)!==0,i=(e&j7)!==0;if(r)return s?"se-resize":i?"ne-resize":"e-resize";if(n)return s?"sw-resize":i?"nw-resize":"w-resize";if(s)return"s-resize";if(i)return"n-resize"}switch(t){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function fRe(){_l!==null&&(document.head.removeChild(_l),RS=null,_l=null)}function Ww(t,e){const r=dRe(t,e);RS!==r&&(RS=r,_l===null&&(_l=document.createElement("style"),document.head.appendChild(_l)),_l.innerHTML=`*{cursor: ${r}!important;}`)}function O7(t){return t.type==="keydown"}function D7(t){return t.type.startsWith("pointer")}function L7(t){return t.type.startsWith("mouse")}function jb(t){if(D7(t)){if(t.isPrimary)return{x:t.clientX,y:t.clientY}}else if(L7(t))return{x:t.clientX,y:t.clientY};return{x:1/0,y:1/0}}function pRe(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function mRe(t,e,r){return t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y}function gRe(t,e){if(t===e)throw new Error("Cannot compare node with itself");const r={a:IL(t),b:IL(e)};let n;for(;r.a.at(-1)===r.b.at(-1);)t=r.a.pop(),e=r.b.pop(),n=t;lt(n,"Stacking order can only be calculated for elements with a common ancestor");const s={a:RL(AL(r.a)),b:RL(AL(r.b))};if(s.a===s.b){const i=n.childNodes,o={a:r.a.at(-1),b:r.b.at(-1)};let a=i.length;for(;a--;){const l=i[a];if(l===o.a)return 1;if(l===o.b)return-1}}return Math.sign(s.a-s.b)}const _Re=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function yRe(t){var e;const r=getComputedStyle((e=N7(t))!==null&&e!==void 0?e:t).display;return r==="flex"||r==="inline-flex"}function bRe(t){const e=getComputedStyle(t);return!!(e.position==="fixed"||e.zIndex!=="auto"&&(e.position!=="static"||yRe(t))||+e.opacity<1||"transform"in e&&e.transform!=="none"||"webkitTransform"in e&&e.webkitTransform!=="none"||"mixBlendMode"in e&&e.mixBlendMode!=="normal"||"filter"in e&&e.filter!=="none"||"webkitFilter"in e&&e.webkitFilter!=="none"||"isolation"in e&&e.isolation==="isolate"||_Re.test(e.willChange)||e.webkitOverflowScrolling==="touch")}function AL(t){let e=t.length;for(;e--;){const r=t[e];if(lt(r,"Missing node"),bRe(r))return r}return null}function RL(t){return t&&Number(getComputedStyle(t).zIndex)||0}function IL(t){const e=[];for(;t;)e.push(t),t=N7(t);return e}function N7(t){const{parentNode:e}=t;return e&&e instanceof ShadowRoot?e.host:e}const M7=1,B7=2,F7=4,j7=8,vRe=pRe()==="coarse";let Fs=[],du=!1,sa=new Map,Ub=new Map;const Uf=new Set;function wRe(t,e,r,n,s){var i;const{ownerDocument:o}=e,a={direction:r,element:e,hitAreaMargins:n,setResizeHandlerState:s},l=(i=sa.get(o))!==null&&i!==void 0?i:0;return sa.set(o,l+1),Uf.add(a),X_(),function(){var u;Ub.delete(t),Uf.delete(a);const h=(u=sa.get(o))!==null&&u!==void 0?u:1;if(sa.set(o,h-1),X_(),h===1&&sa.delete(o),Fs.includes(a)){const d=Fs.indexOf(a);d>=0&&Fs.splice(d,1),bA(),s("up",!0,null)}}}function PL(t){const{target:e}=t,{x:r,y:n}=jb(t);du=!0,yA({target:e,x:r,y:n}),X_(),Fs.length>0&&(Z_("down",t),t.preventDefault(),t.stopPropagation())}function Wh(t){const{x:e,y:r}=jb(t);if(du&&t.buttons===0&&(du=!1,Z_("up",t)),!du){const{target:n}=t;yA({target:n,x:e,y:r})}Z_("move",t),bA(),Fs.length>0&&t.preventDefault()}function Sc(t){const{target:e}=t,{x:r,y:n}=jb(t);Ub.clear(),du=!1,Fs.length>0&&t.preventDefault(),Z_("up",t),yA({target:e,x:r,y:n}),bA(),X_()}function yA({target:t,x:e,y:r}){Fs.splice(0);let n=null;(t instanceof HTMLElement||t instanceof SVGElement)&&(n=t),Uf.forEach(s=>{const{element:i,hitAreaMargins:o}=s,a=i.getBoundingClientRect(),{bottom:l,left:c,right:u,top:h}=a,d=vRe?o.coarse:o.fine;if(e>=c-d&&e<=u+d&&r>=h-d&&r<=l+d){if(n!==null&&document.contains(n)&&i!==n&&!i.contains(n)&&!n.contains(i)&&gRe(n,i)>0){let g=n,_=!1;for(;g&&!g.contains(i);){if(mRe(g.getBoundingClientRect(),a)){_=!0;break}g=g.parentElement}if(_)return}Fs.push(s)}})}function qw(t,e){Ub.set(t,e)}function bA(){let t=!1,e=!1;Fs.forEach(n=>{const{direction:s}=n;s==="horizontal"?t=!0:e=!0});let r=0;Ub.forEach(n=>{r|=n}),t&&e?Ww("intersection",r):t?Ww("horizontal",r):e?Ww("vertical",r):fRe()}function X_(){sa.forEach((t,e)=>{const{body:r}=e;r.removeEventListener("contextmenu",Sc),r.removeEventListener("pointerdown",PL),r.removeEventListener("pointerleave",Wh),r.removeEventListener("pointermove",Wh)}),window.removeEventListener("pointerup",Sc),window.removeEventListener("pointercancel",Sc),Uf.size>0&&(du?(Fs.length>0&&sa.forEach((t,e)=>{const{body:r}=e;t>0&&(r.addEventListener("contextmenu",Sc),r.addEventListener("pointerleave",Wh),r.addEventListener("pointermove",Wh))}),window.addEventListener("pointerup",Sc),window.addEventListener("pointercancel",Sc)):sa.forEach((t,e)=>{const{body:r}=e;t>0&&(r.addEventListener("pointerdown",PL,{capture:!0}),r.addEventListener("pointermove",Wh))}))}function Z_(t,e){Uf.forEach(r=>{const{setResizeHandlerState:n}=r,s=Fs.includes(r);n(t,s,e)})}function ERe(){const[t,e]=hu(0);return Cn(()=>e(r=>r+1),[])}function lt(t,e){if(!t)throw console.error(e),Error(e)}const vA=10;function Yl(t,e,r=vA){return t.toFixed(r)===e.toFixed(r)?0:t>e?1:-1}function lo(t,e,r=vA){return Yl(t,e,r)===0}function Hn(t,e,r){return Yl(t,e,r)===0}function xRe(t,e,r){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++){const s=t[n],i=e[n];if(!Hn(s,i,r))return!1}return!0}function Kc({panelConstraints:t,panelIndex:e,size:r}){const n=t[e];lt(n!=null,`Panel constraints not found for index ${e}`);let{collapsedSize:s=0,collapsible:i,maxSize:o=100,minSize:a=0}=n;if(Yl(r,a)<0)if(i){const l=(s+a)/2;Yl(r,l)<0?r=s:r=a}else r=a;return r=Math.min(o,r),r=parseFloat(r.toFixed(vA)),r}function cd({delta:t,initialLayout:e,panelConstraints:r,pivotIndices:n,prevLayout:s,trigger:i}){if(Hn(t,0))return e;const o=[...e],[a,l]=n;lt(a!=null,"Invalid first pivot index"),lt(l!=null,"Invalid second pivot index");let c=0;if(i==="keyboard"){{const h=t<0?l:a,d=r[h];lt(d,`Panel constraints not found for index ${h}`);const{collapsedSize:f=0,collapsible:g,minSize:_=0}=d;if(g){const m=e[h];if(lt(m!=null,`Previous layout not found for panel index ${h}`),Hn(m,f)){const p=_-m;Yl(p,Math.abs(t))>0&&(t=t<0?0-p:p)}}}{const h=t<0?a:l,d=r[h];lt(d,`No panel constraints found for index ${h}`);const{collapsedSize:f=0,collapsible:g,minSize:_=0}=d;if(g){const m=e[h];if(lt(m!=null,`Previous layout not found for panel index ${h}`),Hn(m,_)){const p=m-f;Yl(p,Math.abs(t))>0&&(t=t<0?0-p:p)}}}}{const h=t<0?1:-1;let d=t<0?l:a,f=0;for(;;){const _=e[d];lt(_!=null,`Previous layout not found for panel index ${d}`);const p=Kc({panelConstraints:r,panelIndex:d,size:100})-_;if(f+=p,d+=h,d<0||d>=r.length)break}const g=Math.min(Math.abs(t),Math.abs(f));t=t<0?0-g:g}{let d=t<0?a:l;for(;d>=0&&d<r.length;){const f=Math.abs(t)-Math.abs(c),g=e[d];lt(g!=null,`Previous layout not found for panel index ${d}`);const _=g-f,m=Kc({panelConstraints:r,panelIndex:d,size:_});if(!Hn(g,m)&&(c+=g-m,o[d]=m,c.toPrecision(3).localeCompare(Math.abs(t).toPrecision(3),void 0,{numeric:!0})>=0))break;t<0?d--:d++}}if(xRe(s,o))return s;{const h=t<0?l:a,d=e[h];lt(d!=null,`Previous layout not found for panel index ${h}`);const f=d+c,g=Kc({panelConstraints:r,panelIndex:h,size:f});if(o[h]=g,!Hn(g,f)){let _=f-g,p=t<0?l:a;for(;p>=0&&p<r.length;){const y=o[p];lt(y!=null,`Previous layout not found for panel index ${p}`);const b=y+_,v=Kc({panelConstraints:r,panelIndex:p,size:b});if(Hn(y,v)||(_-=v-y,o[p]=v),Hn(_,0))break;t>0?p--:p++}}}const u=o.reduce((h,d)=>d+h,0);return Hn(u,100)?o:s}function SRe({layout:t,panelsArray:e,pivotIndices:r}){let n=0,s=100,i=0,o=0;const a=r[0];lt(a!=null,"No pivot index found"),e.forEach((h,d)=>{const{constraints:f}=h,{maxSize:g=100,minSize:_=0}=f;d===a?(n=_,s=g):(i+=_,o+=g)});const l=Math.min(s,100-i),c=Math.max(n,100-o),u=t[a];return{valueMax:l,valueMin:c,valueNow:u}}function $f(t,e=document){return Array.from(e.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${t}"]`))}function U7(t,e,r=document){const s=$f(t,r).findIndex(i=>i.getAttribute("data-panel-resize-handle-id")===e);return s??null}function $7(t,e,r){const n=U7(t,e,r);return n!=null?[n,n+1]:[-1,-1]}function H7(t,e=document){var r;if(e instanceof HTMLElement&&(e==null||(r=e.dataset)===null||r===void 0?void 0:r.panelGroupId)==t)return e;const n=e.querySelector(`[data-panel-group][data-panel-group-id="${t}"]`);return n||null}function $b(t,e=document){const r=e.querySelector(`[data-panel-resize-handle-id="${t}"]`);return r||null}function TRe(t,e,r,n=document){var s,i,o,a;const l=$b(e,n),c=$f(t,n),u=l?c.indexOf(l):-1,h=(s=(i=r[u])===null||i===void 0?void 0:i.id)!==null&&s!==void 0?s:null,d=(o=(a=r[u+1])===null||a===void 0?void 0:a.id)!==null&&o!==void 0?o:null;return[h,d]}function CRe({committedValuesRef:t,eagerValuesRef:e,groupId:r,layout:n,panelDataArray:s,panelGroupElement:i,setLayout:o}){kn({didWarnAboutMissingResizeHandle:!1}),Dl(()=>{if(!i)return;const a=$f(r,i);for(let l=0;l<s.length-1;l++){const{valueMax:c,valueMin:u,valueNow:h}=SRe({layout:n,panelsArray:s,pivotIndices:[l,l+1]}),d=a[l];if(d!=null){const f=s[l];lt(f,`No panel data found for index "${l}"`),d.setAttribute("aria-controls",f.id),d.setAttribute("aria-valuemax",""+Math.round(c)),d.setAttribute("aria-valuemin",""+Math.round(u)),d.setAttribute("aria-valuenow",h!=null?""+Math.round(h):"")}}return()=>{a.forEach((l,c)=>{l.removeAttribute("aria-controls"),l.removeAttribute("aria-valuemax"),l.removeAttribute("aria-valuemin"),l.removeAttribute("aria-valuenow")})}},[r,n,s,i]),Ol(()=>{if(!i)return;const a=e.current;lt(a,"Eager values not found");const{panelDataArray:l}=a,c=H7(r,i);lt(c!=null,`No group found for id "${r}"`);const u=$f(r,i);lt(u,`No resize handles found for group id "${r}"`);const h=u.map(d=>{const f=d.getAttribute("data-panel-resize-handle-id");lt(f,"Resize handle element has no handle id attribute");const[g,_]=TRe(r,f,l,i);if(g==null||_==null)return()=>{};const m=p=>{if(!p.defaultPrevented)switch(p.key){case"Enter":{p.preventDefault();const y=l.findIndex(b=>b.id===g);if(y>=0){const b=l[y];lt(b,`No panel data found for index ${y}`);const v=n[y],{collapsedSize:w=0,collapsible:E,minSize:S=0}=b.constraints;if(v!=null&&E){const x=cd({delta:Hn(v,w)?S-w:w-v,initialLayout:n,panelConstraints:l.map(C=>C.constraints),pivotIndices:$7(r,f,i),prevLayout:n,trigger:"keyboard"});n!==x&&o(x)}}break}}};return d.addEventListener("keydown",m),()=>{d.removeEventListener("keydown",m)}});return()=>{h.forEach(d=>d())}},[i,t,e,r,n,s,o])}function OL(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function z7(t,e){const r=t==="horizontal",{x:n,y:s}=jb(e);return r?n:s}function kRe(t,e,r,n,s){const i=r==="horizontal",o=$b(e,s);lt(o,`No resize handle element found for id "${e}"`);const a=o.getAttribute("data-panel-group-id");lt(a,"Resize handle element has no group id attribute");let{initialCursorPosition:l}=n;const c=z7(r,t),u=H7(a,s);lt(u,`No group element found for id "${a}"`);const h=u.getBoundingClientRect(),d=i?h.width:h.height;return(c-l)/d*100}function ARe(t,e,r,n,s,i){if(O7(t)){const o=r==="horizontal";let a=0;t.shiftKey?a=100:s!=null?a=s:a=10;let l=0;switch(t.key){case"ArrowDown":l=o?0:a;break;case"ArrowLeft":l=o?-a:0;break;case"ArrowRight":l=o?a:0;break;case"ArrowUp":l=o?0:-a;break;case"End":l=100;break;case"Home":l=-100;break}return l}else return n==null?0:kRe(t,e,r,n,i)}function RRe({panelDataArray:t}){const e=Array(t.length),r=t.map(i=>i.constraints);let n=0,s=100;for(let i=0;i<t.length;i++){const o=r[i];lt(o,`Panel constraints not found for index ${i}`);const{defaultSize:a}=o;a!=null&&(n++,e[i]=a,s-=a)}for(let i=0;i<t.length;i++){const o=r[i];lt(o,`Panel constraints not found for index ${i}`);const{defaultSize:a}=o;if(a!=null)continue;const l=t.length-n,c=s/l;n++,e[i]=c,s-=c}return e}function Tc(t,e,r){e.forEach((n,s)=>{const i=t[s];lt(i,`Panel data not found for index ${s}`);const{callbacks:o,constraints:a,id:l}=i,{collapsedSize:c=0,collapsible:u}=a,h=r[l];if(h==null||n!==h){r[l]=n;const{onCollapse:d,onExpand:f,onResize:g}=o;g&&g(n,h),u&&(d||f)&&(f&&(h==null||lo(h,c))&&!lo(n,c)&&f(),d&&(h==null||!lo(h,c))&&lo(n,c)&&d())}})}function wg(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!=e[r])return!1;return!0}function IRe({defaultSize:t,dragState:e,layout:r,panelData:n,panelIndex:s,precision:i=3}){const o=r[s];let a;return o==null?a=t!=null?t.toPrecision(i):"1":n.length===1?a="1":a=o.toPrecision(i),{flexBasis:0,flexGrow:a,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}function PRe(t,e=10){let r=null;return(...s)=>{r!==null&&clearTimeout(r),r=setTimeout(()=>{t(...s)},e)}}function DL(t){try{if(typeof localStorage<"u")t.getItem=e=>localStorage.getItem(e),t.setItem=(e,r)=>{localStorage.setItem(e,r)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),t.getItem=()=>null,t.setItem=()=>{}}}function V7(t){return`react-resizable-panels:${t}`}function G7(t){return t.map(e=>{const{constraints:r,id:n,idIsFromProps:s,order:i}=e;return s?n:i?`${i}:${JSON.stringify(r)}`:JSON.stringify(r)}).sort((e,r)=>e.localeCompare(r)).join(",")}function W7(t,e){try{const r=V7(t),n=e.getItem(r);if(n){const s=JSON.parse(n);if(typeof s=="object"&&s!=null)return s}}catch{}return null}function ORe(t,e,r){var n,s;const i=(n=W7(t,r))!==null&&n!==void 0?n:{},o=G7(e);return(s=i[o])!==null&&s!==void 0?s:null}function DRe(t,e,r,n,s){var i;const o=V7(t),a=G7(e),l=(i=W7(t,s))!==null&&i!==void 0?i:{};l[a]={expandToSizes:Object.fromEntries(r.entries()),layout:n};try{s.setItem(o,JSON.stringify(l))}catch(c){console.error(c)}}function LL({layout:t,panelConstraints:e}){const r=[...t],n=r.reduce((i,o)=>i+o,0);if(r.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${r.map(i=>`${i}%`).join(", ")}`);if(!Hn(n,100)&&r.length>0)for(let i=0;i<e.length;i++){const o=r[i];lt(o!=null,`No layout data found for index ${i}`);const a=100/n*o;r[i]=a}let s=0;for(let i=0;i<e.length;i++){const o=r[i];lt(o!=null,`No layout data found for index ${i}`);const a=Kc({panelConstraints:e,panelIndex:i,size:o});o!=a&&(s+=o-a,r[i]=a)}if(!Hn(s,0))for(let i=0;i<e.length;i++){const o=r[i];lt(o!=null,`No layout data found for index ${i}`);const a=o+s,l=Kc({panelConstraints:e,panelIndex:i,size:a});if(o!==l&&(s-=l-o,r[i]=l,Hn(s,0)))break}return r}const LRe=100,ud={getItem:t=>(DL(ud),ud.getItem(t)),setItem:(t,e)=>{DL(ud),ud.setItem(t,e)}},NL={};function q7({autoSaveId:t=null,children:e,className:r="",direction:n,forwardedRef:s,id:i=null,onLayout:o=null,keyboardResizeBy:a=null,storage:l=ud,style:c,tagName:u="div",...h}){const d=_A(i),f=kn(null),[g,_]=hu(null),[m,p]=hu([]),y=ERe(),b=kn({}),v=kn(new Map),w=kn(0),E=kn({autoSaveId:t,direction:n,dragState:g,id:d,keyboardResizeBy:a,onLayout:o,storage:l}),S=kn({layout:m,panelDataArray:[],panelDataArrayChanged:!1});kn({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),I7(s,()=>({getId:()=>E.current.id,getLayout:()=>{const{layout:U}=S.current;return U},setLayout:U=>{const{onLayout:Q}=E.current,{layout:ne,panelDataArray:ge}=S.current,J=LL({layout:U,panelConstraints:ge.map(V=>V.constraints)});OL(ne,J)||(p(J),S.current.layout=J,Q&&Q(J),Tc(ge,J,b.current))}}),[]),Dl(()=>{E.current.autoSaveId=t,E.current.direction=n,E.current.dragState=g,E.current.id=d,E.current.onLayout=o,E.current.storage=l}),CRe({committedValuesRef:E,eagerValuesRef:S,groupId:d,layout:m,panelDataArray:S.current.panelDataArray,setLayout:p,panelGroupElement:f.current}),Ol(()=>{const{panelDataArray:U}=S.current;if(t){if(m.length===0||m.length!==U.length)return;let Q=NL[t];Q==null&&(Q=PRe(DRe,LRe),NL[t]=Q);const ne=[...U],ge=new Map(v.current);Q(t,ne,ge,m,l)}},[t,m,l]),Ol(()=>{});const x=Cn(U=>{const{onLayout:Q}=E.current,{layout:ne,panelDataArray:ge}=S.current;if(U.constraints.collapsible){const J=ge.map(be=>be.constraints),{collapsedSize:V=0,panelSize:fe,pivotIndices:de}=Za(ge,U,ne);if(lt(fe!=null,`Panel size not found for panel "${U.id}"`),!lo(fe,V)){v.current.set(U.id,fe);const me=Dc(ge,U)===ge.length-1?fe-V:V-fe,ve=cd({delta:me,initialLayout:ne,panelConstraints:J,pivotIndices:de,prevLayout:ne,trigger:"imperative-api"});wg(ne,ve)||(p(ve),S.current.layout=ve,Q&&Q(ve),Tc(ge,ve,b.current))}}},[]),C=Cn((U,Q)=>{const{onLayout:ne}=E.current,{layout:ge,panelDataArray:J}=S.current;if(U.constraints.collapsible){const V=J.map(L=>L.constraints),{collapsedSize:fe=0,panelSize:de=0,minSize:be=0,pivotIndices:me}=Za(J,U,ge),ve=Q??be;if(lo(de,fe)){const L=v.current.get(U.id),oe=L!=null&&L>=ve?L:ve,W=Dc(J,U)===J.length-1?de-oe:oe-de,K=cd({delta:W,initialLayout:ge,panelConstraints:V,pivotIndices:me,prevLayout:ge,trigger:"imperative-api"});wg(ge,K)||(p(K),S.current.layout=K,ne&&ne(K),Tc(J,K,b.current))}}},[]),A=Cn(U=>{const{layout:Q,panelDataArray:ne}=S.current,{panelSize:ge}=Za(ne,U,Q);return lt(ge!=null,`Panel size not found for panel "${U.id}"`),ge},[]),M=Cn((U,Q)=>{const{panelDataArray:ne}=S.current,ge=Dc(ne,U);return IRe({defaultSize:Q,dragState:g,layout:m,panelData:ne,panelIndex:ge})},[g,m]),P=Cn(U=>{const{layout:Q,panelDataArray:ne}=S.current,{collapsedSize:ge=0,collapsible:J,panelSize:V}=Za(ne,U,Q);return lt(V!=null,`Panel size not found for panel "${U.id}"`),J===!0&&lo(V,ge)},[]),D=Cn(U=>{const{layout:Q,panelDataArray:ne}=S.current,{collapsedSize:ge=0,collapsible:J,panelSize:V}=Za(ne,U,Q);return lt(V!=null,`Panel size not found for panel "${U.id}"`),!J||Yl(V,ge)>0},[]),R=Cn(U=>{const{panelDataArray:Q}=S.current;Q.push(U),Q.sort((ne,ge)=>{const J=ne.order,V=ge.order;return J==null&&V==null?0:J==null?-1:V==null?1:J-V}),S.current.panelDataArrayChanged=!0,y()},[y]);Dl(()=>{if(S.current.panelDataArrayChanged){S.current.panelDataArrayChanged=!1;const{autoSaveId:U,onLayout:Q,storage:ne}=E.current,{layout:ge,panelDataArray:J}=S.current;let V=null;if(U){const de=ORe(U,J,ne);de&&(v.current=new Map(Object.entries(de.expandToSizes)),V=de.layout)}V==null&&(V=RRe({panelDataArray:J}));const fe=LL({layout:V,panelConstraints:J.map(de=>de.constraints)});OL(ge,fe)||(p(fe),S.current.layout=fe,Q&&Q(fe),Tc(J,fe,b.current))}}),Dl(()=>{const U=S.current;return()=>{U.layout=[]}},[]);const G=Cn(U=>{let Q=!1;const ne=f.current;return ne&&window.getComputedStyle(ne,null).getPropertyValue("direction")==="rtl"&&(Q=!0),function(J){J.preventDefault();const V=f.current;if(!V)return()=>null;const{direction:fe,dragState:de,id:be,keyboardResizeBy:me,onLayout:ve}=E.current,{layout:L,panelDataArray:oe}=S.current,{initialLayout:ie}=de??{},W=$7(be,U,V);let K=ARe(J,U,fe,de,me,V);const ae=fe==="horizontal";ae&&Q&&(K=-K);const xe=oe.map(Se=>Se.constraints),Te=cd({delta:K,initialLayout:ie??L,panelConstraints:xe,pivotIndices:W,prevLayout:L,trigger:O7(J)?"keyboard":"mouse-or-touch"}),le=!wg(L,Te);(D7(J)||L7(J))&&w.current!=K&&(w.current=K,!le&&K!==0?ae?qw(U,K<0?M7:B7):qw(U,K<0?F7:j7):qw(U,0)),le&&(p(Te),S.current.layout=Te,ve&&ve(Te),Tc(oe,Te,b.current))}},[]),ee=Cn((U,Q)=>{const{onLayout:ne}=E.current,{layout:ge,panelDataArray:J}=S.current,V=J.map(L=>L.constraints),{panelSize:fe,pivotIndices:de}=Za(J,U,ge);lt(fe!=null,`Panel size not found for panel "${U.id}"`);const me=Dc(J,U)===J.length-1?fe-Q:Q-fe,ve=cd({delta:me,initialLayout:ge,panelConstraints:V,pivotIndices:de,prevLayout:ge,trigger:"imperative-api"});wg(ge,ve)||(p(ve),S.current.layout=ve,ne&&ne(ve),Tc(J,ve,b.current))},[]),q=Cn((U,Q)=>{const{layout:ne,panelDataArray:ge}=S.current,{collapsedSize:J=0,collapsible:V}=Q,{collapsedSize:fe=0,collapsible:de,maxSize:be=100,minSize:me=0}=U.constraints,{panelSize:ve}=Za(ge,U,ne);ve!=null&&(V&&de&&lo(ve,J)?lo(J,fe)||ee(U,fe):ve<me?ee(U,me):ve>be&&ee(U,be))},[ee]),re=Cn((U,Q)=>{const{direction:ne}=E.current,{layout:ge}=S.current;if(!f.current)return;const J=$b(U,f.current);lt(J,`Drag handle element not found for id "${U}"`);const V=z7(ne,Q);_({dragHandleId:U,dragHandleRect:J.getBoundingClientRect(),initialCursorPosition:V,initialLayout:ge})},[]),N=Cn(()=>{_(null)},[]),B=Cn(U=>{const{panelDataArray:Q}=S.current,ne=Dc(Q,U);ne>=0&&(Q.splice(ne,1),delete b.current[U.id],S.current.panelDataArrayChanged=!0,y())},[y]),$=lRe(()=>({collapsePanel:x,direction:n,dragState:g,expandPanel:C,getPanelSize:A,getPanelStyle:M,groupId:d,isPanelCollapsed:P,isPanelExpanded:D,reevaluatePanelConstraints:q,registerPanel:R,registerResizeHandle:G,resizePanel:ee,startDragging:re,stopDragging:N,unregisterPanel:B,panelGroupElement:f.current}),[x,g,n,C,A,M,d,P,D,q,R,G,ee,re,N,B]),H={display:"flex",flexDirection:n==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return Fu(Fb.Provider,{value:$},Fu(u,{...h,children:e,className:r,id:i,ref:f,style:{...H,...c},"data-panel-group":"","data-panel-group-direction":n,"data-panel-group-id":d}))}const IS=A7((t,e)=>Fu(q7,{...t,forwardedRef:e}));q7.displayName="PanelGroup";IS.displayName="forwardRef(PanelGroup)";function Dc(t,e){return t.findIndex(r=>r===e||r.id===e.id)}function Za(t,e,r){const n=Dc(t,e),i=n===t.length-1?[n-1,n]:[n,n+1],o=r[n];return{...e.constraints,panelSize:o,pivotIndices:i}}function NRe({disabled:t,handleId:e,resizeHandler:r,panelGroupElement:n}){Ol(()=>{if(t||r==null||n==null)return;const s=$b(e,n);if(s==null)return;const i=o=>{if(!o.defaultPrevented)switch(o.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{o.preventDefault(),r(o);break}case"F6":{o.preventDefault();const a=s.getAttribute("data-panel-group-id");lt(a,`No group element found for id "${a}"`);const l=$f(a,n),c=U7(a,e,n);lt(c!==null,`No resize element found for id "${e}"`);const u=o.shiftKey?c>0?c-1:l.length-1:c+1<l.length?c+1:0;l[u].focus();break}}};return s.addEventListener("keydown",i),()=>{s.removeEventListener("keydown",i)}},[n,t,e,r])}function PS({children:t=null,className:e="",disabled:r=!1,hitAreaMargins:n,id:s,onBlur:i,onDragging:o,onFocus:a,style:l={},tabIndex:c=0,tagName:u="div",...h}){var d,f;const g=kn(null),_=kn({onDragging:o});Ol(()=>{_.current.onDragging=o});const m=R7(Fb);if(m===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:p,groupId:y,registerResizeHandle:b,startDragging:v,stopDragging:w,panelGroupElement:E}=m,S=_A(s),[x,C]=hu("inactive"),[A,M]=hu(!1),[P,D]=hu(null),R=kn({state:x});Dl(()=>{R.current.state=x}),Ol(()=>{if(r)D(null);else{const re=b(S);D(()=>re)}},[r,S,b]);const G=(d=n?.coarse)!==null&&d!==void 0?d:15,ee=(f=n?.fine)!==null&&f!==void 0?f:5;return Ol(()=>{if(r||P==null)return;const re=g.current;return lt(re,"Element ref not attached"),wRe(S,re,p,{coarse:G,fine:ee},(B,$,H)=>{if($)switch(B){case"down":{C("drag"),lt(H,'Expected event to be defined for "down" action'),v(S,H);const{onDragging:U}=_.current;U&&U(!0);break}case"move":{const{state:U}=R.current;U!=="drag"&&C("hover"),lt(H,'Expected event to be defined for "move" action'),P(H);break}case"up":{C("hover"),w();const{onDragging:U}=_.current;U&&U(!1);break}}else C("inactive")})},[G,p,r,ee,b,S,P,v,w]),NRe({disabled:r,handleId:S,resizeHandler:P,panelGroupElement:E}),Fu(u,{...h,children:t,className:e,id:s,onBlur:()=>{M(!1),i?.()},onFocus:()=>{M(!0),a?.()},ref:g,role:"separator",style:{...{touchAction:"none",userSelect:"none"},...l},tabIndex:c,"data-panel-group-direction":p,"data-panel-group-id":y,"data-resize-handle":"","data-resize-handle-active":x==="drag"?"pointer":A?"keyboard":void 0,"data-resize-handle-state":x,"data-panel-resize-handle-enabled":!r,"data-panel-resize-handle-id":S})}PS.displayName="PanelResizeHandle";const ML=I.memo(({className:t,children:e})=>T.jsx("div",{className:qe("flex items-center gap-2 bg-Terretacode-elements-background-depth-2 text-Terretacode-elements-textSecondary border-b border-Terretacode-elements-borderColor px-4 py-1 min-h-[34px] text-sm",t),children:e}));function MRe(){return globalThis.innerWidth<640}function K7(t){const e=t+"CollectionProvider",[r,n]=Pk(e),[s,i]=r(e,{collectionRef:{current:null},itemMap:new Map}),o=f=>{const{scope:g,children:_}=f,m=at.useRef(null),p=at.useRef(new Map).current;return T.jsx(s,{scope:g,itemMap:p,collectionRef:m,children:_})};o.displayName=e;const a=t+"CollectionSlot",l=at.forwardRef((f,g)=>{const{scope:_,children:m}=f,p=i(a,_),y=gr(g,p.collectionRef);return T.jsx(vu,{ref:y,children:m})});l.displayName=a;const c=t+"CollectionItemSlot",u="data-radix-collection-item",h=at.forwardRef((f,g)=>{const{scope:_,children:m,...p}=f,y=at.useRef(null),b=gr(g,y),v=i(c,_);return at.useEffect(()=>(v.itemMap.set(y,{ref:y,...p}),()=>void v.itemMap.delete(y))),T.jsx(vu,{[u]:"",ref:b,children:m})});h.displayName=c;function d(f){const g=i(t+"CollectionConsumer",f);return at.useCallback(()=>{const m=g.collectionRef.current;if(!m)return[];const p=Array.from(m.querySelectorAll(`[${u}]`));return Array.from(g.itemMap.values()).sort((v,w)=>p.indexOf(v.ref.current)-p.indexOf(w.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:o,Slot:l,ItemSlot:h},d,n]}var BRe=I.createContext(void 0);function Y7(t){const e=I.useContext(BRe);return t||e||"ltr"}var Kw="rovingFocusGroup.onEntryFocus",FRe={bubbles:!1,cancelable:!0},Hb="RovingFocusGroup",[OS,X7,jRe]=K7(Hb),[URe,Z7]=Pk(Hb,[jRe]),[$Re,HRe]=URe(Hb),J7=I.forwardRef((t,e)=>T.jsx(OS.Provider,{scope:t.__scopeRovingFocusGroup,children:T.jsx(OS.Slot,{scope:t.__scopeRovingFocusGroup,children:T.jsx(zRe,{...t,ref:e})})}));J7.displayName=Hb;var zRe=I.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...h}=t,d=I.useRef(null),f=gr(e,d),g=Y7(i),[_=null,m]=Ep({prop:o,defaultProp:a,onChange:l}),[p,y]=I.useState(!1),b=xs(c),v=X7(r),w=I.useRef(!1),[E,S]=I.useState(0);return I.useEffect(()=>{const x=d.current;if(x)return x.addEventListener(Kw,b),()=>x.removeEventListener(Kw,b)},[b]),T.jsx($Re,{scope:r,orientation:n,dir:g,loop:s,currentTabStopId:_,onItemFocus:I.useCallback(x=>m(x),[m]),onItemShiftTab:I.useCallback(()=>y(!0),[]),onFocusableItemAdd:I.useCallback(()=>S(x=>x+1),[]),onFocusableItemRemove:I.useCallback(()=>S(x=>x-1),[]),children:T.jsx(Gt.div,{tabIndex:p||E===0?-1:0,"data-orientation":n,...h,ref:f,style:{outline:"none",...t.style},onMouseDown:et(t.onMouseDown,()=>{w.current=!0}),onFocus:et(t.onFocus,x=>{const C=!w.current;if(x.target===x.currentTarget&&C&&!p){const A=new CustomEvent(Kw,FRe);if(x.currentTarget.dispatchEvent(A),!A.defaultPrevented){const M=v().filter(ee=>ee.focusable),P=M.find(ee=>ee.active),D=M.find(ee=>ee.id===_),G=[P,D,...M].filter(Boolean).map(ee=>ee.ref.current);tz(G,u)}}w.current=!1}),onBlur:et(t.onBlur,()=>y(!1))})})}),Q7="RovingFocusGroupItem",ez=I.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:i,...o}=t,a=Tl(),l=i||a,c=HRe(Q7,r),u=c.currentTabStopId===l,h=X7(r),{onFocusableItemAdd:d,onFocusableItemRemove:f}=c;return I.useEffect(()=>{if(n)return d(),()=>f()},[n,d,f]),T.jsx(OS.ItemSlot,{scope:r,id:l,focusable:n,active:s,children:T.jsx(Gt.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...o,ref:e,onMouseDown:et(t.onMouseDown,g=>{n?c.onItemFocus(l):g.preventDefault()}),onFocus:et(t.onFocus,()=>c.onItemFocus(l)),onKeyDown:et(t.onKeyDown,g=>{if(g.key==="Tab"&&g.shiftKey){c.onItemShiftTab();return}if(g.target!==g.currentTarget)return;const _=WRe(g,c.orientation,c.dir);if(_!==void 0){if(g.metaKey||g.ctrlKey||g.altKey||g.shiftKey)return;g.preventDefault();let p=h().filter(y=>y.focusable).map(y=>y.ref.current);if(_==="last")p.reverse();else if(_==="prev"||_==="next"){_==="prev"&&p.reverse();const y=p.indexOf(g.currentTarget);p=c.loop?qRe(p,y+1):p.slice(y+1)}setTimeout(()=>tz(p))}})})})});ez.displayName=Q7;var VRe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function GRe(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function WRe(t,e,r){const n=GRe(t.key,r);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return VRe[n]}function tz(t,e=!1){const r=document.activeElement;for(const n of t)if(n===r||(n.focus({preventScroll:e}),document.activeElement!==r))return}function qRe(t,e){return t.map((r,n)=>t[(e+n)%t.length])}var KRe=J7,YRe=ez,DS=["Enter"," "],XRe=["ArrowDown","PageUp","Home"],rz=["ArrowUp","PageDown","End"],ZRe=[...XRe,...rz],JRe={ltr:[...DS,"ArrowRight"],rtl:[...DS,"ArrowLeft"]},QRe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Hp="Menu",[Hf,eIe,tIe]=K7(Hp),[lc,zb]=Ju(Hp,[tIe,vb,Z7]),Vb=vb(),nz=Z7(),[rIe,cc]=lc(Hp),[nIe,zp]=lc(Hp),sz=t=>{const{__scopeMenu:e,open:r=!1,children:n,dir:s,onOpenChange:i,modal:o=!0}=t,a=Vb(e),[l,c]=I.useState(null),u=I.useRef(!1),h=xs(i),d=Y7(s);return I.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),T.jsx(m$,{...a,children:T.jsx(rIe,{scope:e,open:r,onOpenChange:h,content:l,onContentChange:c,children:T.jsx(nIe,{scope:e,onClose:I.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:u,dir:d,modal:o,children:n})})})};sz.displayName=Hp;var sIe="MenuAnchor",wA=I.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t,s=Vb(r);return T.jsx(g$,{...s,...n,ref:e})});wA.displayName=sIe;var EA="MenuPortal",[iIe,iz]=lc(EA,{forceMount:void 0}),oz=t=>{const{__scopeMenu:e,forceMount:r,children:n,container:s}=t,i=cc(EA,e);return T.jsx(iIe,{scope:e,forceMount:r,children:T.jsx(Hi,{present:r||i.open,children:T.jsx(Uy,{asChild:!0,container:s,children:n})})})};oz.displayName=EA;var vs="MenuContent",[oIe,xA]=lc(vs),az=I.forwardRef((t,e)=>{const r=iz(vs,t.__scopeMenu),{forceMount:n=r.forceMount,...s}=t,i=cc(vs,t.__scopeMenu),o=zp(vs,t.__scopeMenu);return T.jsx(Hf.Provider,{scope:t.__scopeMenu,children:T.jsx(Hi,{present:n||i.open,children:T.jsx(Hf.Slot,{scope:t.__scopeMenu,children:o.modal?T.jsx(aIe,{...s,ref:e}):T.jsx(lIe,{...s,ref:e})})})})}),aIe=I.forwardRef((t,e)=>{const r=cc(vs,t.__scopeMenu),n=I.useRef(null),s=gr(e,n);return I.useEffect(()=>{const i=n.current;if(i)return C6(i)},[]),T.jsx(SA,{...t,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:et(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),lIe=I.forwardRef((t,e)=>{const r=cc(vs,t.__scopeMenu);return T.jsx(SA,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),SA=I.forwardRef((t,e)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:d,onDismiss:f,disableOutsideScroll:g,..._}=t,m=cc(vs,r),p=zp(vs,r),y=Vb(r),b=nz(r),v=eIe(r),[w,E]=I.useState(null),S=I.useRef(null),x=gr(e,S,m.onContentChange),C=I.useRef(0),A=I.useRef(""),M=I.useRef(0),P=I.useRef(null),D=I.useRef("right"),R=I.useRef(0),G=g?iC:I.Fragment,ee=g?{as:vu,allowPinchZoom:!0}:void 0,q=N=>{const B=A.current+N,$=v().filter(J=>!J.disabled),H=document.activeElement,U=$.find(J=>J.ref.current===H)?.textValue,Q=$.map(J=>J.textValue),ne=vIe(Q,B,U),ge=$.find(J=>J.textValue===ne)?.ref.current;(function J(V){A.current=V,window.clearTimeout(C.current),V!==""&&(C.current=window.setTimeout(()=>J(""),1e3))})(B),ge&&setTimeout(()=>ge.focus())};I.useEffect(()=>()=>window.clearTimeout(C.current),[]),_6();const re=I.useCallback(N=>D.current===P.current?.side&&EIe(N,P.current?.area),[]);return T.jsx(oIe,{scope:r,searchRef:A,onItemEnter:I.useCallback(N=>{re(N)&&N.preventDefault()},[re]),onItemLeave:I.useCallback(N=>{re(N)||(S.current?.focus(),E(null))},[re]),onTriggerLeave:I.useCallback(N=>{re(N)&&N.preventDefault()},[re]),pointerGraceTimerRef:M,onPointerGraceIntentChange:I.useCallback(N=>{P.current=N},[]),children:T.jsx(G,{...ee,children:T.jsx(sC,{asChild:!0,trapped:s,onMountAutoFocus:et(i,N=>{N.preventDefault(),S.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:T.jsx(jy,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:d,onDismiss:f,children:T.jsx(KRe,{asChild:!0,...b,dir:p.dir,orientation:"vertical",loop:n,currentTabStopId:w,onCurrentTabStopIdChange:E,onEntryFocus:et(l,N=>{p.isUsingKeyboardRef.current||N.preventDefault()}),preventScrollOnEntryFocus:!0,children:T.jsx(_$,{role:"menu","aria-orientation":"vertical","data-state":xz(m.open),"data-radix-menu-content":"",dir:p.dir,...y,..._,ref:x,style:{outline:"none",..._.style},onKeyDown:et(_.onKeyDown,N=>{const $=N.target.closest("[data-radix-menu-content]")===N.currentTarget,H=N.ctrlKey||N.altKey||N.metaKey,U=N.key.length===1;$&&(N.key==="Tab"&&N.preventDefault(),!H&&U&&q(N.key));const Q=S.current;if(N.target!==Q||!ZRe.includes(N.key))return;N.preventDefault();const ge=v().filter(J=>!J.disabled).map(J=>J.ref.current);rz.includes(N.key)&&ge.reverse(),yIe(ge)}),onBlur:et(t.onBlur,N=>{N.currentTarget.contains(N.target)||(window.clearTimeout(C.current),A.current="")}),onPointerMove:et(t.onPointerMove,zf(N=>{const B=N.target,$=R.current!==N.clientX;if(N.currentTarget.contains(B)&&$){const H=N.clientX>R.current?"right":"left";D.current=H,R.current=N.clientX}}))})})})})})})});az.displayName=vs;var cIe="MenuGroup",TA=I.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t;return T.jsx(Gt.div,{role:"group",...n,ref:e})});TA.displayName=cIe;var uIe="MenuLabel",lz=I.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t;return T.jsx(Gt.div,{...n,ref:e})});lz.displayName=uIe;var J_="MenuItem",BL="menu.itemSelect",Gb=I.forwardRef((t,e)=>{const{disabled:r=!1,onSelect:n,...s}=t,i=I.useRef(null),o=zp(J_,t.__scopeMenu),a=xA(J_,t.__scopeMenu),l=gr(e,i),c=I.useRef(!1),u=()=>{const h=i.current;if(!r&&h){const d=new CustomEvent(BL,{bubbles:!0,cancelable:!0});h.addEventListener(BL,f=>n?.(f),{once:!0}),f6(h,d),d.defaultPrevented?c.current=!1:o.onClose()}};return T.jsx(cz,{...s,ref:l,disabled:r,onClick:et(t.onClick,u),onPointerDown:h=>{t.onPointerDown?.(h),c.current=!0},onPointerUp:et(t.onPointerUp,h=>{c.current||h.currentTarget?.click()}),onKeyDown:et(t.onKeyDown,h=>{const d=a.searchRef.current!=="";r||d&&h.key===" "||DS.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});Gb.displayName=J_;var cz=I.forwardRef((t,e)=>{const{__scopeMenu:r,disabled:n=!1,textValue:s,...i}=t,o=xA(J_,r),a=nz(r),l=I.useRef(null),c=gr(e,l),[u,h]=I.useState(!1),[d,f]=I.useState("");return I.useEffect(()=>{const g=l.current;g&&f((g.textContent??"").trim())},[i.children]),T.jsx(Hf.ItemSlot,{scope:r,disabled:n,textValue:s??d,children:T.jsx(YRe,{asChild:!0,...a,focusable:!n,children:T.jsx(Gt.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...i,ref:c,onPointerMove:et(t.onPointerMove,zf(g=>{n?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:et(t.onPointerLeave,zf(g=>o.onItemLeave(g))),onFocus:et(t.onFocus,()=>h(!0)),onBlur:et(t.onBlur,()=>h(!1))})})})}),hIe="MenuCheckboxItem",uz=I.forwardRef((t,e)=>{const{checked:r=!1,onCheckedChange:n,...s}=t;return T.jsx(mz,{scope:t.__scopeMenu,checked:r,children:T.jsx(Gb,{role:"menuitemcheckbox","aria-checked":Q_(r)?"mixed":r,...s,ref:e,"data-state":kA(r),onSelect:et(s.onSelect,()=>n?.(Q_(r)?!0:!r),{checkForDefaultPrevented:!1})})})});uz.displayName=hIe;var hz="MenuRadioGroup",[dIe,fIe]=lc(hz,{value:void 0,onValueChange:()=>{}}),dz=I.forwardRef((t,e)=>{const{value:r,onValueChange:n,...s}=t,i=xs(n);return T.jsx(dIe,{scope:t.__scopeMenu,value:r,onValueChange:i,children:T.jsx(TA,{...s,ref:e})})});dz.displayName=hz;var fz="MenuRadioItem",pz=I.forwardRef((t,e)=>{const{value:r,...n}=t,s=fIe(fz,t.__scopeMenu),i=r===s.value;return T.jsx(mz,{scope:t.__scopeMenu,checked:i,children:T.jsx(Gb,{role:"menuitemradio","aria-checked":i,...n,ref:e,"data-state":kA(i),onSelect:et(n.onSelect,()=>s.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});pz.displayName=fz;var CA="MenuItemIndicator",[mz,pIe]=lc(CA,{checked:!1}),gz=I.forwardRef((t,e)=>{const{__scopeMenu:r,forceMount:n,...s}=t,i=pIe(CA,r);return T.jsx(Hi,{present:n||Q_(i.checked)||i.checked===!0,children:T.jsx(Gt.span,{...s,ref:e,"data-state":kA(i.checked)})})});gz.displayName=CA;var mIe="MenuSeparator",_z=I.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t;return T.jsx(Gt.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});_z.displayName=mIe;var gIe="MenuArrow",yz=I.forwardRef((t,e)=>{const{__scopeMenu:r,...n}=t,s=Vb(r);return T.jsx(y$,{...s,...n,ref:e})});yz.displayName=gIe;var _Ie="MenuSub",[y9e,bz]=lc(_Ie),hd="MenuSubTrigger",vz=I.forwardRef((t,e)=>{const r=cc(hd,t.__scopeMenu),n=zp(hd,t.__scopeMenu),s=bz(hd,t.__scopeMenu),i=xA(hd,t.__scopeMenu),o=I.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=i,c={__scopeMenu:t.__scopeMenu},u=I.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return I.useEffect(()=>u,[u]),I.useEffect(()=>{const h=a.current;return()=>{window.clearTimeout(h),l(null)}},[a,l]),T.jsx(wA,{asChild:!0,...c,children:T.jsx(cz,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":xz(r.open),...t,ref:Fy(e,s.onTriggerChange),onClick:h=>{t.onClick?.(h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:et(t.onPointerMove,zf(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!r.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{r.onOpenChange(!0),u()},100))})),onPointerLeave:et(t.onPointerLeave,zf(h=>{u();const d=r.content?.getBoundingClientRect();if(d){const f=r.content?.dataset.side,g=f==="right",_=g?-5:5,m=d[g?"left":"right"],p=d[g?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+_,y:h.clientY},{x:m,y:d.top},{x:p,y:d.top},{x:p,y:d.bottom},{x:m,y:d.bottom}],side:f}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:et(t.onKeyDown,h=>{const d=i.searchRef.current!=="";t.disabled||d&&h.key===" "||JRe[n.dir].includes(h.key)&&(r.onOpenChange(!0),r.content?.focus(),h.preventDefault())})})})});vz.displayName=hd;var wz="MenuSubContent",Ez=I.forwardRef((t,e)=>{const r=iz(vs,t.__scopeMenu),{forceMount:n=r.forceMount,...s}=t,i=cc(vs,t.__scopeMenu),o=zp(vs,t.__scopeMenu),a=bz(wz,t.__scopeMenu),l=I.useRef(null),c=gr(e,l);return T.jsx(Hf.Provider,{scope:t.__scopeMenu,children:T.jsx(Hi,{present:n||i.open,children:T.jsx(Hf.Slot,{scope:t.__scopeMenu,children:T.jsx(SA,{id:a.contentId,"aria-labelledby":a.triggerId,...s,ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{o.isUsingKeyboardRef.current&&l.current?.focus(),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:et(t.onFocusOutside,u=>{u.target!==a.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:et(t.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:et(t.onKeyDown,u=>{const h=u.currentTarget.contains(u.target),d=QRe[o.dir].includes(u.key);h&&d&&(i.onOpenChange(!1),a.trigger?.focus(),u.preventDefault())})})})})})});Ez.displayName=wz;function xz(t){return t?"open":"closed"}function Q_(t){return t==="indeterminate"}function kA(t){return Q_(t)?"indeterminate":t?"checked":"unchecked"}function yIe(t){const e=document.activeElement;for(const r of t)if(r===e||(r.focus(),document.activeElement!==e))return}function bIe(t,e){return t.map((r,n)=>t[(e+n)%t.length])}function vIe(t,e,r){const s=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=r?t.indexOf(r):-1;let o=bIe(t,Math.max(i,0));s.length===1&&(o=o.filter(c=>c!==r));const l=o.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==r?l:void 0}function wIe(t,e){const{x:r,y:n}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i].x,l=e[i].y,c=e[o].x,u=e[o].y;l>n!=u>n&&r<(c-a)*(n-l)/(u-l)+a&&(s=!s)}return s}function EIe(t,e){if(!e)return!1;const r={x:t.clientX,y:t.clientY};return wIe(r,e)}function zf(t){return e=>e.pointerType==="mouse"?t(e):void 0}var Sz=sz,Tz=wA,Cz=oz,kz=az,Az=TA,Rz=lz,Iz=Gb,Pz=uz,Oz=dz,Dz=pz,Lz=gz,Nz=_z,Mz=yz,Bz=vz,Fz=Ez,AA="DropdownMenu",[xIe,b9e]=Ju(AA,[zb]),wn=zb(),[SIe,jz]=xIe(AA),Uz=t=>{const{__scopeDropdownMenu:e,children:r,dir:n,open:s,defaultOpen:i,onOpenChange:o,modal:a=!0}=t,l=wn(e),c=I.useRef(null),[u=!1,h]=Ep({prop:s,defaultProp:i,onChange:o});return T.jsx(SIe,{scope:e,triggerId:Tl(),triggerRef:c,contentId:Tl(),open:u,onOpenChange:h,onOpenToggle:I.useCallback(()=>h(d=>!d),[h]),modal:a,children:T.jsx(Sz,{...l,open:u,onOpenChange:h,dir:n,modal:a,children:r})})};Uz.displayName=AA;var $z="DropdownMenuTrigger",Hz=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...s}=t,i=jz($z,r),o=wn(r);return T.jsx(Tz,{asChild:!0,...o,children:T.jsx(Gt.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:Fy(e,i.triggerRef),onPointerDown:et(t.onPointerDown,a=>{!n&&a.button===0&&a.ctrlKey===!1&&(i.onOpenToggle(),i.open||a.preventDefault())}),onKeyDown:et(t.onKeyDown,a=>{n||(["Enter"," "].includes(a.key)&&i.onOpenToggle(),a.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});Hz.displayName=$z;var TIe="DropdownMenuPortal",zz=t=>{const{__scopeDropdownMenu:e,...r}=t,n=wn(e);return T.jsx(Cz,{...n,...r})};zz.displayName=TIe;var Vz="DropdownMenuContent",Gz=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=jz(Vz,r),i=wn(r),o=I.useRef(!1);return T.jsx(kz,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...n,ref:e,onCloseAutoFocus:et(t.onCloseAutoFocus,a=>{o.current||s.triggerRef.current?.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:et(t.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Gz.displayName=Vz;var CIe="DropdownMenuGroup",kIe=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=wn(r);return T.jsx(Az,{...s,...n,ref:e})});kIe.displayName=CIe;var AIe="DropdownMenuLabel",RIe=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=wn(r);return T.jsx(Rz,{...s,...n,ref:e})});RIe.displayName=AIe;var IIe="DropdownMenuItem",PIe=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=wn(r);return T.jsx(Iz,{...s,...n,ref:e})});PIe.displayName=IIe;var OIe="DropdownMenuCheckboxItem",DIe=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=wn(r);return T.jsx(Pz,{...s,...n,ref:e})});DIe.displayName=OIe;var LIe="DropdownMenuRadioGroup",NIe=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=wn(r);return T.jsx(Oz,{...s,...n,ref:e})});NIe.displayName=LIe;var MIe="DropdownMenuRadioItem",BIe=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=wn(r);return T.jsx(Dz,{...s,...n,ref:e})});BIe.displayName=MIe;var FIe="DropdownMenuItemIndicator",jIe=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=wn(r);return T.jsx(Lz,{...s,...n,ref:e})});jIe.displayName=FIe;var UIe="DropdownMenuSeparator",$Ie=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=wn(r);return T.jsx(Nz,{...s,...n,ref:e})});$Ie.displayName=UIe;var HIe="DropdownMenuArrow",Wz=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=wn(r);return T.jsx(Mz,{...s,...n,ref:e})});Wz.displayName=HIe;var zIe="DropdownMenuSubTrigger",VIe=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=wn(r);return T.jsx(Bz,{...s,...n,ref:e})});VIe.displayName=zIe;var GIe="DropdownMenuSubContent",WIe=I.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...n}=t,s=wn(r);return T.jsx(Fz,{...s,...n,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});WIe.displayName=GIe;var qIe=Uz,KIe=Hz,YIe=zz,XIe=Gz,ZIe=Wz,RA="ContextMenu",[JIe,v9e]=Ju(RA,[zb]),En=zb(),[QIe,qz]=JIe(RA),Kz=t=>{const{__scopeContextMenu:e,children:r,onOpenChange:n,dir:s,modal:i=!0}=t,[o,a]=I.useState(!1),l=En(e),c=xs(n),u=I.useCallback(h=>{a(h),c(h)},[c]);return T.jsx(QIe,{scope:e,open:o,onOpenChange:u,modal:i,children:T.jsx(Sz,{...l,dir:s,open:o,onOpenChange:u,modal:i,children:r})})};Kz.displayName=RA;var Yz="ContextMenuTrigger",Xz=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,disabled:n=!1,...s}=t,i=qz(Yz,r),o=En(r),a=I.useRef({x:0,y:0}),l=I.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...a.current})}),c=I.useRef(0),u=I.useCallback(()=>window.clearTimeout(c.current),[]),h=d=>{a.current={x:d.clientX,y:d.clientY},i.onOpenChange(!0)};return I.useEffect(()=>u,[u]),I.useEffect(()=>void(n&&u()),[n,u]),T.jsxs(T.Fragment,{children:[T.jsx(Tz,{...o,virtualRef:l}),T.jsx(Gt.span,{"data-state":i.open?"open":"closed","data-disabled":n?"":void 0,...s,ref:e,style:{WebkitTouchCallout:"none",...t.style},onContextMenu:n?t.onContextMenu:et(t.onContextMenu,d=>{u(),h(d),d.preventDefault()}),onPointerDown:n?t.onPointerDown:et(t.onPointerDown,Eg(d=>{u(),c.current=window.setTimeout(()=>h(d),700)})),onPointerMove:n?t.onPointerMove:et(t.onPointerMove,Eg(u)),onPointerCancel:n?t.onPointerCancel:et(t.onPointerCancel,Eg(u)),onPointerUp:n?t.onPointerUp:et(t.onPointerUp,Eg(u))})]})});Xz.displayName=Yz;var ePe="ContextMenuPortal",Zz=t=>{const{__scopeContextMenu:e,...r}=t,n=En(e);return T.jsx(Cz,{...n,...r})};Zz.displayName=ePe;var Jz="ContextMenuContent",Qz=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=qz(Jz,r),i=En(r),o=I.useRef(!1);return T.jsx(kz,{...i,...n,ref:e,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:a=>{t.onCloseAutoFocus?.(a),!a.defaultPrevented&&o.current&&a.preventDefault(),o.current=!1},onInteractOutside:a=>{t.onInteractOutside?.(a),!a.defaultPrevented&&!s.modal&&(o.current=!0)},style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Qz.displayName=Jz;var tPe="ContextMenuGroup",eV=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=En(r);return T.jsx(Az,{...s,...n,ref:e})});eV.displayName=tPe;var rPe="ContextMenuLabel",nPe=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=En(r);return T.jsx(Rz,{...s,...n,ref:e})});nPe.displayName=rPe;var sPe="ContextMenuItem",tV=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=En(r);return T.jsx(Iz,{...s,...n,ref:e})});tV.displayName=sPe;var iPe="ContextMenuCheckboxItem",oPe=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=En(r);return T.jsx(Pz,{...s,...n,ref:e})});oPe.displayName=iPe;var aPe="ContextMenuRadioGroup",lPe=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=En(r);return T.jsx(Oz,{...s,...n,ref:e})});lPe.displayName=aPe;var cPe="ContextMenuRadioItem",uPe=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=En(r);return T.jsx(Dz,{...s,...n,ref:e})});uPe.displayName=cPe;var hPe="ContextMenuItemIndicator",dPe=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=En(r);return T.jsx(Lz,{...s,...n,ref:e})});dPe.displayName=hPe;var fPe="ContextMenuSeparator",pPe=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=En(r);return T.jsx(Nz,{...s,...n,ref:e})});pPe.displayName=fPe;var mPe="ContextMenuArrow",gPe=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=En(r);return T.jsx(Mz,{...s,...n,ref:e})});gPe.displayName=mPe;var _Pe="ContextMenuSubTrigger",yPe=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=En(r);return T.jsx(Bz,{...s,...n,ref:e})});yPe.displayName=_Pe;var bPe="ContextMenuSubContent",vPe=I.forwardRef((t,e)=>{const{__scopeContextMenu:r,...n}=t,s=En(r);return T.jsx(Fz,{...s,...n,ref:e,style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});vPe.displayName=bPe;function Eg(t){return e=>e.pointerType!=="mouse"?t(e):void 0}var wPe=Kz,EPe=Xz,xPe=Zz,SPe=Qz,TPe=eV,CPe=tV;const LS=Fn("FileTree"),kPe=8,APe=[/\/node_modules\//,/\/\.next/,/\/\.astro/],rV=I.memo(({files:t={},onFileSelect:e,selectedFile:r,rootFolder:n,hideRoot:s=!1,collapsed:i=!1,allowFolderSelection:o=!1,hiddenFiles:a,className:l,unsavedFiles:c})=>{Xu.trace("FileTree");const u=I.useMemo(()=>[...APe,...a??[]],[a]),h=I.useMemo(()=>PPe(t,n,s,u),[t,n,s,u]),[d,f]=I.useState(()=>i?new Set(h.filter(y=>y.kind==="folder").map(y=>y.fullPath)):new Set);I.useEffect(()=>{if(i){f(new Set(h.filter(y=>y.kind==="folder").map(y=>y.fullPath)));return}f(y=>{const b=new Set;for(const v of h)v.kind==="folder"&&y.has(v.fullPath)&&b.add(v.fullPath);return b})},[h,i]);const g=I.useMemo(()=>{const y=[];let b=Number.MAX_SAFE_INTEGER;for(const v of h){const w=v.depth;b===w&&(b=Number.MAX_SAFE_INTEGER),d.has(v.fullPath)&&(b=Math.min(b,w)),!(b<w)&&y.push(v)}return y},[h,d]),_=y=>{f(b=>{const v=new Set(b);return v.has(y)?v.delete(y):v.add(y),v})},m=y=>{try{navigator.clipboard.writeText(y.fullPath)}catch(b){LS.error(b)}},p=y=>{try{navigator.clipboard.writeText(y.fullPath.substring((n||"").length))}catch(b){LS.error(b)}};return T.jsx("div",{className:qe("text-sm",l,"overflow-y-auto"),children:g.map(y=>{switch(y.kind){case"file":return T.jsx(IPe,{selected:r===y.fullPath,file:y,unsavedChanges:c?.has(y.fullPath),onCopyPath:()=>{m(y)},onCopyRelativePath:()=>{p(y)},onClick:()=>{e?.(y.fullPath)}},y.id);case"folder":return T.jsx(RPe,{folder:y,selected:o&&r===y.fullPath,collapsed:d.has(y.fullPath),onCopyPath:()=>{m(y)},onCopyRelativePath:()=>{p(y)},onClick:()=>{_(y.fullPath)}},y.id);default:return}})})});function FL({onSelect:t,children:e}){return T.jsxs(CPe,{onSelect:t,className:"flex items-center gap-2 px-2 py-1.5 outline-0 text-sm text-Terretacode-elements-textPrimary cursor-pointer ws-nowrap text-Terretacode-elements-item-contentDefault hover:text-Terretacode-elements-item-contentActive hover:bg-Terretacode-elements-item-backgroundActive rounded-md",children:[T.jsx("span",{className:"size-4 shrink-0"}),T.jsx("span",{children:e})]})}function nV({onCopyPath:t,onCopyRelativePath:e,children:r}){return T.jsxs(wPe,{children:[T.jsx(EPe,{children:r}),T.jsx(xPe,{children:T.jsx(SPe,{style:{zIndex:998},className:"border border-Terretacode-elements-borderColor rounded-md z-context-menu bg-Terretacode-elements-background-depth-1 dark:bg-Terretacode-elements-background-depth-2 data-[state=open]:animate-in animate-duration-100 data-[state=open]:fade-in-0 data-[state=open]:zoom-in-98 w-56",children:T.jsxs(TPe,{className:"p-1 border-b-px border-solid border-Terretacode-elements-borderColor",children:[T.jsx(FL,{onSelect:t,children:"Copy path"}),T.jsx(FL,{onSelect:e,children:"Copy relative path"})]})})})]})}function RPe({folder:t,collapsed:e,selected:r=!1,onCopyPath:n,onCopyRelativePath:s,onClick:i}){return T.jsx(nV,{onCopyPath:n,onCopyRelativePath:s,children:T.jsx(sV,{className:qe("group",{"bg-transparent text-Terretacode-elements-item-contentDefault hover:text-Terretacode-elements-item-contentActive hover:bg-Terretacode-elements-item-backgroundActive":!r,"bg-Terretacode-elements-item-backgroundAccent text-Terretacode-elements-item-contentAccent":r}),depth:t.depth,iconClasses:qe({"i-ph:caret-right scale-98":e,"i-ph:caret-down scale-98":!e}),onClick:i,children:t.name})})}function IPe({file:{depth:t,name:e},onClick:r,onCopyPath:n,onCopyRelativePath:s,selected:i,unsavedChanges:o=!1}){return T.jsx(nV,{onCopyPath:n,onCopyRelativePath:s,children:T.jsx(sV,{className:qe("group",{"bg-transparent hover:bg-Terretacode-elements-item-backgroundActive text-Terretacode-elements-item-contentDefault":!i,"bg-Terretacode-elements-item-backgroundAccent text-Terretacode-elements-item-contentAccent":i}),depth:t,iconClasses:qe("i-ph:file-duotone scale-98",{"group-hover:text-Terretacode-elements-item-contentActive":!i}),onClick:r,children:T.jsxs("div",{className:qe("flex items-center",{"group-hover:text-Terretacode-elements-item-contentActive":!i}),children:[T.jsx("div",{className:"flex-1 truncate pr-2",children:e}),o&&T.jsx("span",{className:"i-ph:circle-fill scale-68 shrink-0 text-orange-500"})]})})})}function sV({depth:t,iconClasses:e,onClick:r,className:n,children:s}){return T.jsxs("button",{className:qe("flex items-center gap-1.5 w-full pr-2 border-2 border-transparent text-faded py-0.5",n),style:{paddingLeft:`${6+t*kPe}px`},onClick:()=>r?.(),children:[T.jsx("div",{className:qe("scale-120 shrink-0",e)}),T.jsx("div",{className:"truncate w-full text-left",children:s})]})}function PPe(t,e="/",r,n){const s=new Set,i=[];let o=0;e==="/"&&!r&&(o=1,i.push({kind:"folder",name:"/",depth:0,id:0,fullPath:"/"}));for(const[a,l]of Object.entries(t)){const c=a.split("/").filter(g=>g),u=c.at(-1);if(!u||OPe(a,u,n))continue;let h="",d=0,f=0;for(;d<c.length;){const g=c[d],_=h+=`/${g}`;if(!_.startsWith(e)||r&&_===e){d++;continue}d===c.length-1&&l?.type==="file"?i.push({kind:"file",id:i.length,name:g,fullPath:_,depth:f+o}):s.has(_)||(s.add(_),i.push({kind:"folder",id:i.length,name:g,fullPath:_,depth:f+o})),d++,f++}}return DPe(e,i,r)}function OPe(t,e,r){return r.some(n=>typeof n=="string"?e===n:n.test(t))}function DPe(t,e,r){LS.trace("sortFileList");const n=new Map,s=new Map;e.sort((a,l)=>LPe(a,l));for(const a of e){n.set(a.fullPath,a);const l=a.fullPath.slice(0,a.fullPath.lastIndexOf("/"));l!==t.slice(0,t.lastIndexOf("/"))&&(s.has(l)||s.set(l,[]),s.get(l)?.push(a))}const i=[],o=a=>{const l=n.get(a);l&&i.push(l);const c=s.get(a);if(c)for(const u of c)u.kind==="folder"?o(u.fullPath):i.push(u)};if(r){const a=s.get(t)||[];for(const l of a)o(l.fullPath)}else o(t);return i}function LPe(t,e){return t.kind!==e.kind?t.kind==="folder"?-1:1:t.name.localeCompare(e.name,void 0,{numeric:!0,sensitivity:"base"})}const NPe=new RegExp(`^${ya.split("/").slice(0,-1).join("/").replaceAll("/","\\/")}/`),MPe={open:{y:0,opacity:1,transition:{duration:.15,ease:Ss}},close:{y:6,opacity:0,transition:{duration:.15,ease:Ss}}},BPe=I.memo(({files:t,pathSegments:e=[],onFileSelect:r})=>{Xu.trace("FileBreadcrumb");const[n,s]=I.useState(null),i=I.useRef(null),o=I.useRef([]),a=l=>{s(c=>c===l?null:l)};return I.useEffect(()=>{const l=c=>{n!==null&&!i.current?.contains(c.target)&&!o.current.some(u=>u?.contains(c.target))&&s(null)};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[n]),t===void 0||e.length===0?null:T.jsx("div",{className:"flex",children:e.map((l,c)=>{const u=c===e.length-1,h=e.slice(0,c).join("/");if(!NPe.test(h))return null;const d=n===c;return T.jsx("div",{className:"relative flex items-center",children:T.jsxs(qIe,{open:d,modal:!1,children:[T.jsx(KIe,{asChild:!0,children:T.jsxs("span",{ref:f=>o.current[c]=f,className:qe("flex items-center gap-1.5 cursor-pointer shrink-0",{"text-Terretacode-elements-textTertiary hover:text-Terretacode-elements-textPrimary":!d,"text-Terretacode-elements-textPrimary underline":d,"pr-4":u}),onClick:()=>a(c),children:[u&&T.jsx("div",{className:"i-ph:file-duotone"}),l]})}),c>0&&!u&&T.jsx("span",{className:"i-ph:caret-right inline-block mx-1"}),T.jsx(Zd,{children:d&&T.jsx(YIe,{children:T.jsx(XIe,{className:"z-file-tree-breadcrumb",asChild:!0,align:"start",side:"bottom",avoidCollisions:!1,children:T.jsxs(yr.div,{ref:i,initial:"close",animate:"open",exit:"close",variants:MPe,children:[T.jsx("div",{className:"rounded-lg overflow-hidden",children:T.jsx("div",{className:"max-h-[50vh] min-w-[300px] overflow-scroll bg-Terretacode-elements-background-depth-1 border border-Terretacode-elements-borderColor shadow-sm rounded-lg",children:T.jsx(rV,{files:t,hideRoot:!0,rootFolder:h,collapsed:!0,allowFolderSelection:!0,selectedFile:`${h}/${l}`,onFileSelect:f=>{s(null),r?.(f)}})})}),T.jsx(ZIe,{className:"fill-Terretacode-elements-borderColor"})]})})})})]})},c)})})});var iV={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(self,()=>(()=>{var r={};return(()=>{var n=r;Object.defineProperty(n,"__esModule",{value:!0}),n.FitAddon=void 0,n.FitAddon=class{activate(s){this._terminal=s}dispose(){}fit(){const s=this.proposeDimensions();if(!s||!this._terminal||isNaN(s.cols)||isNaN(s.rows))return;const i=this._terminal._core;this._terminal.rows===s.rows&&this._terminal.cols===s.cols||(i._renderService.clear(),this._terminal.resize(s.cols,s.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const s=this._terminal._core,i=s._renderService.dimensions;if(i.css.cell.width===0||i.css.cell.height===0)return;const o=this._terminal.options.scrollback===0?0:s.viewport.scrollBarWidth,a=window.getComputedStyle(this._terminal.element.parentElement),l=parseInt(a.getPropertyValue("height")),c=Math.max(0,parseInt(a.getPropertyValue("width"))),u=window.getComputedStyle(this._terminal.element),h=l-(parseInt(u.getPropertyValue("padding-top"))+parseInt(u.getPropertyValue("padding-bottom"))),d=c-(parseInt(u.getPropertyValue("padding-right"))+parseInt(u.getPropertyValue("padding-left")))-o;return{cols:Math.max(2,Math.floor(d/i.css.cell.width)),rows:Math.max(1,Math.floor(h/i.css.cell.height))}}}})(),r})())})(iV);var FPe=iV.exports,oV={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(self,()=>(()=>{var r={6:(o,a)=>{function l(u){try{const h=new URL(u),d=h.password&&h.username?`${h.protocol}//${h.username}:${h.password}@${h.host}`:h.username?`${h.protocol}//${h.username}@${h.host}`:`${h.protocol}//${h.host}`;return u.toLocaleLowerCase().startsWith(d.toLocaleLowerCase())}catch{return!1}}Object.defineProperty(a,"__esModule",{value:!0}),a.LinkComputer=a.WebLinkProvider=void 0,a.WebLinkProvider=class{constructor(u,h,d,f={}){this._terminal=u,this._regex=h,this._handler=d,this._options=f}provideLinks(u,h){const d=c.computeLink(u,this._regex,this._terminal,this._handler);h(this._addCallbacks(d))}_addCallbacks(u){return u.map(h=>(h.leave=this._options.leave,h.hover=(d,f)=>{if(this._options.hover){const{range:g}=h;this._options.hover(d,f,g)}},h))}};class c{static computeLink(h,d,f,g){const _=new RegExp(d.source,(d.flags||"")+"g"),[m,p]=c._getWindowedLineStrings(h-1,f),y=m.join("");let b;const v=[];for(;b=_.exec(y);){const w=b[0];if(!l(w))continue;const[E,S]=c._mapStrIdx(f,p,0,b.index),[x,C]=c._mapStrIdx(f,E,S,w.length);if(E===-1||S===-1||x===-1||C===-1)continue;const A={start:{x:S+1,y:E+1},end:{x:C,y:x+1}};v.push({range:A,text:w,activate:g})}return v}static _getWindowedLineStrings(h,d){let f,g=h,_=h,m=0,p="";const y=[];if(f=d.buffer.active.getLine(h)){const b=f.translateToString(!0);if(f.isWrapped&&b[0]!==" "){for(m=0;(f=d.buffer.active.getLine(--g))&&m<2048&&(p=f.translateToString(!0),m+=p.length,y.push(p),f.isWrapped&&p.indexOf(" ")===-1););y.reverse()}for(y.push(b),m=0;(f=d.buffer.active.getLine(++_))&&f.isWrapped&&m<2048&&(p=f.translateToString(!0),m+=p.length,y.push(p),p.indexOf(" ")===-1););}return[y,g]}static _mapStrIdx(h,d,f,g){const _=h.buffer.active,m=_.getNullCell();let p=f;for(;g;){const y=_.getLine(d);if(!y)return[-1,-1];for(let b=p;b<y.length;++b){y.getCell(b,m);const v=m.getChars();if(m.getWidth()&&(g-=v.length||1,b===y.length-1&&v==="")){const w=_.getLine(d+1);w&&w.isWrapped&&(w.getCell(0,m),m.getWidth()===2&&(g+=1))}if(g<0)return[d,b]}d++,p=0}return[d,p]}}a.LinkComputer=c}},n={};function s(o){var a=n[o];if(a!==void 0)return a.exports;var l=n[o]={exports:{}};return r[o](l,l.exports,s),l.exports}var i={};return(()=>{var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.WebLinksAddon=void 0;const a=s(6),l=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function c(u,h){const d=window.open();if(d){try{d.opener=null}catch{}d.location.href=h}else console.warn("Opening link blocked as opener could not be cleared")}o.WebLinksAddon=class{constructor(u=c,h={}){this._handler=u,this._options=h}activate(u){this._terminal=u;const h=this._options,d=h.urlRegex||l;this._linkProvider=this._terminal.registerLinkProvider(new a.WebLinkProvider(this._terminal,d,this._handler,h))}dispose(){this._linkProvider?.dispose()}}})(),i})())})(oV);var jPe=oV.exports,aV={exports:{}};(function(t,e){(function(r,n){t.exports=n()})(globalThis,()=>(()=>{var r={4567:function(o,a,l){var c=this&&this.__decorate||function(y,b,v,w){var E,S=arguments.length,x=S<3?b:w===null?w=Object.getOwnPropertyDescriptor(b,v):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(y,b,v,w);else for(var C=y.length-1;C>=0;C--)(E=y[C])&&(x=(S<3?E(x):S>3?E(b,v,x):E(b,v))||x);return S>3&&x&&Object.defineProperty(b,v,x),x},u=this&&this.__param||function(y,b){return function(v,w){b(v,w,y)}};Object.defineProperty(a,"__esModule",{value:!0}),a.AccessibilityManager=void 0;const h=l(9042),d=l(9924),f=l(844),g=l(4725),_=l(2585),m=l(3656);let p=a.AccessibilityManager=class extends f.Disposable{constructor(y,b,v,w){super(),this._terminal=y,this._coreBrowserService=v,this._renderService=w,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let E=0;E<this._terminal.rows;E++)this._rowElements[E]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[E]);if(this._topBoundaryFocusListener=E=>this._handleBoundaryFocus(E,0),this._bottomBoundaryFocusListener=E=>this._handleBoundaryFocus(E,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new d.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(E=>this._handleResize(E.rows))),this.register(this._terminal.onRender(E=>this._refreshRows(E.start,E.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(E=>this._handleChar(E))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(E=>this._handleTab(E))),this.register(this._terminal.onKey(E=>this._handleKey(E.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,m.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,f.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(y){for(let b=0;b<y;b++)this._handleChar(" ")}_handleChar(y){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==y&&(this._charsToAnnounce+=y):this._charsToAnnounce+=y,y===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=h.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(y){this._clearLiveRegion(),/\p{Control}/u.test(y)||this._charsToConsume.push(y)}_refreshRows(y,b){this._liveRegionDebouncer.refresh(y,b,this._terminal.rows)}_renderRows(y,b){const v=this._terminal.buffer,w=v.lines.length.toString();for(let E=y;E<=b;E++){const S=v.lines.get(v.ydisp+E),x=[],C=S?.translateToString(!0,void 0,void 0,x)||"",A=(v.ydisp+E+1).toString(),M=this._rowElements[E];M&&(C.length===0?(M.innerText=" ",this._rowColumns.set(M,[0,1])):(M.textContent=C,this._rowColumns.set(M,x)),M.setAttribute("aria-posinset",A),M.setAttribute("aria-setsize",w))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(y,b){const v=y.target,w=this._rowElements[b===0?1:this._rowElements.length-2];if(v.getAttribute("aria-posinset")===(b===0?"1":`${this._terminal.buffer.lines.length}`)||y.relatedTarget!==w)return;let E,S;if(b===0?(E=v,S=this._rowElements.pop(),this._rowContainer.removeChild(S)):(E=this._rowElements.shift(),S=v,this._rowContainer.removeChild(E)),E.removeEventListener("focus",this._topBoundaryFocusListener),S.removeEventListener("focus",this._bottomBoundaryFocusListener),b===0){const x=this._createAccessibilityTreeNode();this._rowElements.unshift(x),this._rowContainer.insertAdjacentElement("afterbegin",x)}else{const x=this._createAccessibilityTreeNode();this._rowElements.push(x),this._rowContainer.appendChild(x)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(b===0?-1:1),this._rowElements[b===0?1:this._rowElements.length-2].focus(),y.preventDefault(),y.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;const y=document.getSelection();if(!y)return;if(y.isCollapsed)return void(this._rowContainer.contains(y.anchorNode)&&this._terminal.clearSelection());if(!y.anchorNode||!y.focusNode)return void console.error("anchorNode and/or focusNode are null");let b={node:y.anchorNode,offset:y.anchorOffset},v={node:y.focusNode,offset:y.focusOffset};if((b.node.compareDocumentPosition(v.node)&Node.DOCUMENT_POSITION_PRECEDING||b.node===v.node&&b.offset>v.offset)&&([b,v]=[v,b]),b.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(b={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(b.node))return;const w=this._rowElements.slice(-1)[0];if(v.node.compareDocumentPosition(w)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(v={node:w,offset:w.textContent?.length??0}),!this._rowContainer.contains(v.node))return;const E=({node:C,offset:A})=>{const M=C instanceof Text?C.parentNode:C;let P=parseInt(M?.getAttribute("aria-posinset"),10)-1;if(isNaN(P))return console.warn("row is invalid. Race condition?"),null;const D=this._rowColumns.get(M);if(!D)return console.warn("columns is null. Race condition?"),null;let R=A<D.length?D[A]:D.slice(-1)[0]+1;return R>=this._terminal.cols&&(++P,R=0),{row:P,column:R}},S=E(b),x=E(v);if(S&&x){if(S.row>x.row||S.row===x.row&&S.column>=x.column)throw new Error("invalid range");this._terminal.select(S.column,S.row,(x.row-S.row)*this._terminal.cols-S.column+x.column)}}_handleResize(y){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let b=this._rowContainer.children.length;b<this._terminal.rows;b++)this._rowElements[b]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[b]);for(;this._rowElements.length>y;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const y=this._coreBrowserService.mainDocument.createElement("div");return y.setAttribute("role","listitem"),y.tabIndex=-1,this._refreshRowDimensions(y),y}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let y=0;y<this._terminal.rows;y++)this._refreshRowDimensions(this._rowElements[y])}}_refreshRowDimensions(y){y.style.height=`${this._renderService.dimensions.css.cell.height}px`}};a.AccessibilityManager=p=c([u(1,_.IInstantiationService),u(2,g.ICoreBrowserService),u(3,g.IRenderService)],p)},3614:(o,a)=>{function l(d){return d.replace(/\r?\n/g,"\r")}function c(d,f){return f?"\x1B[200~"+d+"\x1B[201~":d}function u(d,f,g,_){d=c(d=l(d),g.decPrivateModes.bracketedPasteMode&&_.rawOptions.ignoreBracketedPasteMode!==!0),g.triggerDataEvent(d,!0),f.value=""}function h(d,f,g){const _=g.getBoundingClientRect(),m=d.clientX-_.left-10,p=d.clientY-_.top-10;f.style.width="20px",f.style.height="20px",f.style.left=`${m}px`,f.style.top=`${p}px`,f.style.zIndex="1000",f.focus()}Object.defineProperty(a,"__esModule",{value:!0}),a.rightClickHandler=a.moveTextAreaUnderMouseCursor=a.paste=a.handlePasteEvent=a.copyHandler=a.bracketTextForPaste=a.prepareTextForTerminal=void 0,a.prepareTextForTerminal=l,a.bracketTextForPaste=c,a.copyHandler=function(d,f){d.clipboardData&&d.clipboardData.setData("text/plain",f.selectionText),d.preventDefault()},a.handlePasteEvent=function(d,f,g,_){d.stopPropagation(),d.clipboardData&&u(d.clipboardData.getData("text/plain"),f,g,_)},a.paste=u,a.moveTextAreaUnderMouseCursor=h,a.rightClickHandler=function(d,f,g,_,m){h(d,f,g),m&&_.rightClickSelect(d),f.value=_.selectionText,f.select()}},7239:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ColorContrastCache=void 0;const c=l(1505);a.ColorContrastCache=class{constructor(){this._color=new c.TwoKeyMap,this._css=new c.TwoKeyMap}setCss(u,h,d){this._css.set(u,h,d)}getCss(u,h){return this._css.get(u,h)}setColor(u,h,d){this._color.set(u,h,d)}getColor(u,h){return this._color.get(u,h)}clear(){this._color.clear(),this._css.clear()}}},3656:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.addDisposableDomListener=void 0,a.addDisposableDomListener=function(l,c,u,h){l.addEventListener(c,u,h);let d=!1;return{dispose:()=>{d||(d=!0,l.removeEventListener(c,u,h))}}}},3551:function(o,a,l){var c=this&&this.__decorate||function(p,y,b,v){var w,E=arguments.length,S=E<3?y:v===null?v=Object.getOwnPropertyDescriptor(y,b):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,y,b,v);else for(var x=p.length-1;x>=0;x--)(w=p[x])&&(S=(E<3?w(S):E>3?w(y,b,S):w(y,b))||S);return E>3&&S&&Object.defineProperty(y,b,S),S},u=this&&this.__param||function(p,y){return function(b,v){y(b,v,p)}};Object.defineProperty(a,"__esModule",{value:!0}),a.Linkifier=void 0;const h=l(3656),d=l(8460),f=l(844),g=l(2585),_=l(4725);let m=a.Linkifier=class extends f.Disposable{get currentLink(){return this._currentLink}constructor(p,y,b,v,w){super(),this._element=p,this._mouseService=y,this._renderService=b,this._bufferService=v,this._linkProviderService=w,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new d.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new d.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,f.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,f.toDisposable)(()=>{this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,h.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,h.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,h.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,h.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(p){this._lastMouseEvent=p;const y=this._positionFromMouseEvent(p,this._element,this._mouseService);if(!y)return;this._isMouseOut=!1;const b=p.composedPath();for(let v=0;v<b.length;v++){const w=b[v];if(w.classList.contains("xterm"))break;if(w.classList.contains("xterm-hover"))return}this._lastBufferCell&&y.x===this._lastBufferCell.x&&y.y===this._lastBufferCell.y||(this._handleHover(y),this._lastBufferCell=y)}_handleHover(p){if(this._activeLine!==p.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(p,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,p)||(this._clearCurrentLink(),this._askForLink(p,!0))}_askForLink(p,y){this._activeProviderReplies&&y||(this._activeProviderReplies?.forEach(v=>{v?.forEach(w=>{w.link.dispose&&w.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=p.y);let b=!1;for(const[v,w]of this._linkProviderService.linkProviders.entries())y?this._activeProviderReplies?.get(v)&&(b=this._checkLinkProviderResult(v,p,b)):w.provideLinks(p.y,E=>{if(this._isMouseOut)return;const S=E?.map(x=>({link:x}));this._activeProviderReplies?.set(v,S),b=this._checkLinkProviderResult(v,p,b),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(p.y,this._activeProviderReplies)})}_removeIntersectingLinks(p,y){const b=new Set;for(let v=0;v<y.size;v++){const w=y.get(v);if(w)for(let E=0;E<w.length;E++){const S=w[E],x=S.link.range.start.y<p?0:S.link.range.start.x,C=S.link.range.end.y>p?this._bufferService.cols:S.link.range.end.x;for(let A=x;A<=C;A++){if(b.has(A)){w.splice(E--,1);break}b.add(A)}}}}_checkLinkProviderResult(p,y,b){if(!this._activeProviderReplies)return b;const v=this._activeProviderReplies.get(p);let w=!1;for(let E=0;E<p;E++)this._activeProviderReplies.has(E)&&!this._activeProviderReplies.get(E)||(w=!0);if(!w&&v){const E=v.find(S=>this._linkAtPosition(S.link,y));E&&(b=!0,this._handleNewLink(E))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!b)for(let E=0;E<this._activeProviderReplies.size;E++){const S=this._activeProviderReplies.get(E)?.find(x=>this._linkAtPosition(x.link,y));if(S){b=!0,this._handleNewLink(S);break}}return b}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(p){if(!this._currentLink)return;const y=this._positionFromMouseEvent(p,this._element,this._mouseService);y&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,y)&&this._currentLink.link.activate(p,this._currentLink.link.text)}_clearCurrentLink(p,y){this._currentLink&&this._lastMouseEvent&&(!p||!y||this._currentLink.link.range.start.y>=p&&this._currentLink.link.range.end.y<=y)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,f.disposeArray)(this._linkCacheDisposables))}_handleNewLink(p){if(!this._lastMouseEvent)return;const y=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);y&&this._linkAtPosition(p.link,y)&&(this._currentLink=p,this._currentLink.state={decorations:{underline:p.link.decorations===void 0||p.link.decorations.underline,pointerCursor:p.link.decorations===void 0||p.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,p.link,this._lastMouseEvent),p.link.decorations={},Object.defineProperties(p.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:b=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==b&&(this._currentLink.state.decorations.pointerCursor=b,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",b))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:b=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==b&&(this._currentLink.state.decorations.underline=b,this._currentLink.state.isHovered&&this._fireUnderlineEvent(p.link,b))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(b=>{if(!this._currentLink)return;const v=b.start===0?0:b.start+1+this._bufferService.buffer.ydisp,w=this._bufferService.buffer.ydisp+1+b.end;if(this._currentLink.link.range.start.y>=v&&this._currentLink.link.range.end.y<=w&&(this._clearCurrentLink(v,w),this._lastMouseEvent)){const E=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);E&&this._askForLink(E,!1)}})))}_linkHover(p,y,b){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(y,!0),this._currentLink.state.decorations.pointerCursor&&p.classList.add("xterm-cursor-pointer")),y.hover&&y.hover(b,y.text)}_fireUnderlineEvent(p,y){const b=p.range,v=this._bufferService.buffer.ydisp,w=this._createLinkUnderlineEvent(b.start.x-1,b.start.y-v-1,b.end.x,b.end.y-v-1,void 0);(y?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(w)}_linkLeave(p,y,b){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(y,!1),this._currentLink.state.decorations.pointerCursor&&p.classList.remove("xterm-cursor-pointer")),y.leave&&y.leave(b,y.text)}_linkAtPosition(p,y){const b=p.range.start.y*this._bufferService.cols+p.range.start.x,v=p.range.end.y*this._bufferService.cols+p.range.end.x,w=y.y*this._bufferService.cols+y.x;return b<=w&&w<=v}_positionFromMouseEvent(p,y,b){const v=b.getCoords(p,y,this._bufferService.cols,this._bufferService.rows);if(v)return{x:v[0],y:v[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(p,y,b,v,w){return{x1:p,y1:y,x2:b,y2:v,cols:this._bufferService.cols,fg:w}}};a.Linkifier=m=c([u(1,_.IMouseService),u(2,_.IRenderService),u(3,g.IBufferService),u(4,_.ILinkProviderService)],m)},9042:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.tooMuchOutput=a.promptLabel=void 0,a.promptLabel="Terminal input",a.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(o,a,l){var c=this&&this.__decorate||function(_,m,p,y){var b,v=arguments.length,w=v<3?m:y===null?y=Object.getOwnPropertyDescriptor(m,p):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(_,m,p,y);else for(var E=_.length-1;E>=0;E--)(b=_[E])&&(w=(v<3?b(w):v>3?b(m,p,w):b(m,p))||w);return v>3&&w&&Object.defineProperty(m,p,w),w},u=this&&this.__param||function(_,m){return function(p,y){m(p,y,_)}};Object.defineProperty(a,"__esModule",{value:!0}),a.OscLinkProvider=void 0;const h=l(511),d=l(2585);let f=a.OscLinkProvider=class{constructor(_,m,p){this._bufferService=_,this._optionsService=m,this._oscLinkService=p}provideLinks(_,m){const p=this._bufferService.buffer.lines.get(_-1);if(!p)return void m(void 0);const y=[],b=this._optionsService.rawOptions.linkHandler,v=new h.CellData,w=p.getTrimmedLength();let E=-1,S=-1,x=!1;for(let C=0;C<w;C++)if(S!==-1||p.hasContent(C)){if(p.loadCell(C,v),v.hasExtendedAttrs()&&v.extended.urlId){if(S===-1){S=C,E=v.extended.urlId;continue}x=v.extended.urlId!==E}else S!==-1&&(x=!0);if(x||S!==-1&&C===w-1){const A=this._oscLinkService.getLinkData(E)?.uri;if(A){const M={start:{x:S+1,y:_},end:{x:C+(x||C!==w-1?0:1),y:_}};let P=!1;if(!b?.allowNonHttpProtocols)try{const D=new URL(A);["http:","https:"].includes(D.protocol)||(P=!0)}catch{P=!0}P||y.push({text:A,range:M,activate:(D,R)=>b?b.activate(D,R,M):g(0,R),hover:(D,R)=>b?.hover?.(D,R,M),leave:(D,R)=>b?.leave?.(D,R,M)})}x=!1,v.hasExtendedAttrs()&&v.extended.urlId?(S=C,E=v.extended.urlId):(S=-1,E=-1)}}m(y)}};function g(_,m){if(confirm(`Do you want to navigate to ${m}?

WARNING: This link could potentially be dangerous`)){const p=window.open();if(p){try{p.opener=null}catch{}p.location.href=m}else console.warn("Opening link blocked as opener could not be cleared")}}a.OscLinkProvider=f=c([u(0,d.IBufferService),u(1,d.IOptionsService),u(2,d.IOscLinkService)],f)},6193:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.RenderDebouncer=void 0,a.RenderDebouncer=class{constructor(l,c){this._renderCallback=l,this._coreBrowserService=c,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(l){return this._refreshCallbacks.push(l),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(l,c,u){this._rowCount=u,l=l!==void 0?l:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const l=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,c),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const l of this._refreshCallbacks)l(0);this._refreshCallbacks=[]}}},3236:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Terminal=void 0;const c=l(3614),u=l(3656),h=l(3551),d=l(9042),f=l(3730),g=l(1680),_=l(3107),m=l(5744),p=l(2950),y=l(1296),b=l(428),v=l(4269),w=l(5114),E=l(8934),S=l(3230),x=l(9312),C=l(4725),A=l(6731),M=l(8055),P=l(8969),D=l(8460),R=l(844),G=l(6114),ee=l(8437),q=l(2584),re=l(7399),N=l(5941),B=l(9074),$=l(2585),H=l(5435),U=l(4567),Q=l(779);class ne extends P.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(J={}){super(J),this.browser=G,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new R.MutableDisposable),this._onCursorMove=this.register(new D.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new D.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new D.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new D.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new D.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new D.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new D.EventEmitter),this._onBlur=this.register(new D.EventEmitter),this._onA11yCharEmitter=this.register(new D.EventEmitter),this._onA11yTabEmitter=this.register(new D.EventEmitter),this._onWillOpen=this.register(new D.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(B.DecorationService),this._instantiationService.setService($.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(Q.LinkProviderService),this._instantiationService.setService(C.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(f.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((V,fe)=>this.refresh(V,fe))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(V=>this._reportWindowsOptions(V))),this.register(this._inputHandler.onColor(V=>this._handleColorEvent(V))),this.register((0,D.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,D.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,D.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(V=>this._afterResize(V.cols,V.rows))),this.register((0,R.toDisposable)(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}_handleColorEvent(J){if(this._themeService)for(const V of J){let fe,de="";switch(V.index){case 256:fe="foreground",de="10";break;case 257:fe="background",de="11";break;case 258:fe="cursor",de="12";break;default:fe="ansi",de="4;"+V.index}switch(V.type){case 0:const be=M.color.toColorRGB(fe==="ansi"?this._themeService.colors.ansi[V.index]:this._themeService.colors[fe]);this.coreService.triggerDataEvent(`${q.C0.ESC}]${de};${(0,N.toRgbString)(be)}${q.C1_ESCAPED.ST}`);break;case 1:if(fe==="ansi")this._themeService.modifyColors(me=>me.ansi[V.index]=M.channels.toColor(...V.color));else{const me=fe;this._themeService.modifyColors(ve=>ve[me]=M.channels.toColor(...V.color))}break;case 2:this._themeService.restoreColor(V.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(J){J?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(U.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(J){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(q.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(q.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const J=this.buffer.ybase+this.buffer.y,V=this.buffer.lines.get(J);if(!V)return;const fe=Math.min(this.buffer.x,this.cols-1),de=this._renderService.dimensions.css.cell.height,be=V.getWidth(fe),me=this._renderService.dimensions.css.cell.width*be,ve=this.buffer.y*this._renderService.dimensions.css.cell.height,L=fe*this._renderService.dimensions.css.cell.width;this.textarea.style.left=L+"px",this.textarea.style.top=ve+"px",this.textarea.style.width=me+"px",this.textarea.style.height=de+"px",this.textarea.style.lineHeight=de+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,u.addDisposableDomListener)(this.element,"copy",V=>{this.hasSelection()&&(0,c.copyHandler)(V,this._selectionService)}));const J=V=>(0,c.handlePasteEvent)(V,this.textarea,this.coreService,this.optionsService);this.register((0,u.addDisposableDomListener)(this.textarea,"paste",J)),this.register((0,u.addDisposableDomListener)(this.element,"paste",J)),G.isFirefox?this.register((0,u.addDisposableDomListener)(this.element,"mousedown",V=>{V.button===2&&(0,c.rightClickHandler)(V,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,u.addDisposableDomListener)(this.element,"contextmenu",V=>{(0,c.rightClickHandler)(V,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),G.isLinux&&this.register((0,u.addDisposableDomListener)(this.element,"auxclick",V=>{V.button===1&&(0,c.moveTextAreaUnderMouseCursor)(V,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,u.addDisposableDomListener)(this.textarea,"keyup",J=>this._keyUp(J),!0)),this.register((0,u.addDisposableDomListener)(this.textarea,"keydown",J=>this._keyDown(J),!0)),this.register((0,u.addDisposableDomListener)(this.textarea,"keypress",J=>this._keyPress(J),!0)),this.register((0,u.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,u.addDisposableDomListener)(this.textarea,"compositionupdate",J=>this._compositionHelper.compositionupdate(J))),this.register((0,u.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,u.addDisposableDomListener)(this.textarea,"input",J=>this._inputEvent(J),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(J){if(!J)throw new Error("Terminal requires a parent element.");if(J.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=J.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),J.appendChild(this.element);const V=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),V.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,u.addDisposableDomListener)(this.screenElement,"mousemove",fe=>this.updateCursorStyle(fe))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),V.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",d.promptLabel),G.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(w.CoreBrowserService,this.textarea,J.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(C.ICoreBrowserService,this._coreBrowserService),this.register((0,u.addDisposableDomListener)(this.textarea,"focus",fe=>this._handleTextAreaFocus(fe))),this.register((0,u.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(b.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(C.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(A.ThemeService),this._instantiationService.setService(C.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(v.CharacterJoinerService),this._instantiationService.setService(C.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(S.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(C.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(fe=>this._onRender.fire(fe))),this.onResize(fe=>this._renderService.resize(fe.cols,fe.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(p.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(E.MouseService),this._instantiationService.setService(C.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(h.Linkifier,this.screenElement)),this.element.appendChild(V);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(g.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(fe=>this.scrollLines(fe.amount,fe.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(x.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(C.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(fe=>this.scrollLines(fe.amount,fe.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(fe=>this._renderService.handleSelectionChanged(fe.start,fe.end,fe.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(fe=>{this.textarea.value=fe,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(fe=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,u.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(_.BufferDecorationRenderer,this.screenElement)),this.register((0,u.addDisposableDomListener)(this.element,"mousedown",fe=>this._selectionService.handleMouseDown(fe))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(U.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",fe=>this._handleScreenReaderModeOptionChange(fe))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(m.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",fe=>{!this._overviewRulerRenderer&&fe&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(m.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(y.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const J=this,V=this.element;function fe(me){const ve=J._mouseService.getMouseReportCoords(me,J.screenElement);if(!ve)return!1;let L,oe;switch(me.overrideType||me.type){case"mousemove":oe=32,me.buttons===void 0?(L=3,me.button!==void 0&&(L=me.button<3?me.button:3)):L=1&me.buttons?0:4&me.buttons?1:2&me.buttons?2:3;break;case"mouseup":oe=0,L=me.button<3?me.button:3;break;case"mousedown":oe=1,L=me.button<3?me.button:3;break;case"wheel":if(J._customWheelEventHandler&&J._customWheelEventHandler(me)===!1||J.viewport.getLinesScrolled(me)===0)return!1;oe=me.deltaY<0?0:1,L=4;break;default:return!1}return!(oe===void 0||L===void 0||L>4)&&J.coreMouseService.triggerMouseEvent({col:ve.col,row:ve.row,x:ve.x,y:ve.y,button:L,action:oe,ctrl:me.ctrlKey,alt:me.altKey,shift:me.shiftKey})}const de={mouseup:null,wheel:null,mousedrag:null,mousemove:null},be={mouseup:me=>(fe(me),me.buttons||(this._document.removeEventListener("mouseup",de.mouseup),de.mousedrag&&this._document.removeEventListener("mousemove",de.mousedrag)),this.cancel(me)),wheel:me=>(fe(me),this.cancel(me,!0)),mousedrag:me=>{me.buttons&&fe(me)},mousemove:me=>{me.buttons||fe(me)}};this.register(this.coreMouseService.onProtocolChange(me=>{me?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(me)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&me?de.mousemove||(V.addEventListener("mousemove",be.mousemove),de.mousemove=be.mousemove):(V.removeEventListener("mousemove",de.mousemove),de.mousemove=null),16&me?de.wheel||(V.addEventListener("wheel",be.wheel,{passive:!1}),de.wheel=be.wheel):(V.removeEventListener("wheel",de.wheel),de.wheel=null),2&me?de.mouseup||(de.mouseup=be.mouseup):(this._document.removeEventListener("mouseup",de.mouseup),de.mouseup=null),4&me?de.mousedrag||(de.mousedrag=be.mousedrag):(this._document.removeEventListener("mousemove",de.mousedrag),de.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,u.addDisposableDomListener)(V,"mousedown",me=>{if(me.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(me))return fe(me),de.mouseup&&this._document.addEventListener("mouseup",de.mouseup),de.mousedrag&&this._document.addEventListener("mousemove",de.mousedrag),this.cancel(me)})),this.register((0,u.addDisposableDomListener)(V,"wheel",me=>{if(!de.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(me)===!1)return!1;if(!this.buffer.hasScrollback){const ve=this.viewport.getLinesScrolled(me);if(ve===0)return;const L=q.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(me.deltaY<0?"A":"B");let oe="";for(let ie=0;ie<Math.abs(ve);ie++)oe+=L;return this.coreService.triggerDataEvent(oe,!0),this.cancel(me,!0)}return this.viewport.handleWheel(me)?this.cancel(me):void 0}},{passive:!1})),this.register((0,u.addDisposableDomListener)(V,"touchstart",me=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(me),this.cancel(me)},{passive:!0})),this.register((0,u.addDisposableDomListener)(V,"touchmove",me=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(me)?void 0:this.cancel(me)},{passive:!1}))}refresh(J,V){this._renderService?.refreshRows(J,V)}updateCursorStyle(J){this._selectionService?.shouldColumnSelect(J)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(J,V,fe=0){fe===1?(super.scrollLines(J,V,fe),this.refresh(0,this.rows-1)):this.viewport?.scrollLines(J)}paste(J){(0,c.paste)(J,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(J){this._customKeyEventHandler=J}attachCustomWheelEventHandler(J){this._customWheelEventHandler=J}registerLinkProvider(J){return this._linkProviderService.registerLinkProvider(J)}registerCharacterJoiner(J){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const V=this._characterJoinerService.register(J);return this.refresh(0,this.rows-1),V}deregisterCharacterJoiner(J){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(J)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(J){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+J)}registerDecoration(J){return this._decorationService.registerDecoration(J)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(J,V,fe){this._selectionService.setSelection(J,V,fe)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(J,V){this._selectionService?.selectLines(J,V)}_keyDown(J){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(J)===!1)return!1;const V=this.browser.isMac&&this.options.macOptionIsMeta&&J.altKey;if(!V&&!this._compositionHelper.keydown(J))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;V||J.key!=="Dead"&&J.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const fe=(0,re.evaluateKeyboardEvent)(J,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(J),fe.type===3||fe.type===2){const de=this.rows-1;return this.scrollLines(fe.type===2?-de:de),this.cancel(J,!0)}return fe.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,J)||(fe.cancel&&this.cancel(J,!0),!fe.key||!!(J.key&&!J.ctrlKey&&!J.altKey&&!J.metaKey&&J.key.length===1&&J.key.charCodeAt(0)>=65&&J.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(fe.key!==q.C0.ETX&&fe.key!==q.C0.CR||(this.textarea.value=""),this._onKey.fire({key:fe.key,domEvent:J}),this._showCursor(),this.coreService.triggerDataEvent(fe.key,!0),!this.optionsService.rawOptions.screenReaderMode||J.altKey||J.ctrlKey?this.cancel(J,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(J,V){const fe=J.isMac&&!this.options.macOptionIsMeta&&V.altKey&&!V.ctrlKey&&!V.metaKey||J.isWindows&&V.altKey&&V.ctrlKey&&!V.metaKey||J.isWindows&&V.getModifierState("AltGraph");return V.type==="keypress"?fe:fe&&(!V.keyCode||V.keyCode>47)}_keyUp(J){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(J)===!1||(function(V){return V.keyCode===16||V.keyCode===17||V.keyCode===18}(J)||this.focus(),this.updateCursorStyle(J),this._keyPressHandled=!1)}_keyPress(J){let V;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(J)===!1)return!1;if(this.cancel(J),J.charCode)V=J.charCode;else if(J.which===null||J.which===void 0)V=J.keyCode;else{if(J.which===0||J.charCode===0)return!1;V=J.which}return!(!V||(J.altKey||J.ctrlKey||J.metaKey)&&!this._isThirdLevelShift(this.browser,J)||(V=String.fromCharCode(V),this._onKey.fire({key:V,domEvent:J}),this._showCursor(),this.coreService.triggerDataEvent(V,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(J){if(J.data&&J.inputType==="insertText"&&(!J.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const V=J.data;return this.coreService.triggerDataEvent(V,!0),this.cancel(J),!0}return!1}resize(J,V){J!==this.cols||V!==this.rows?super.resize(J,V):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(J,V){this._charSizeService?.measure(),this.viewport?.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let J=1;J<this.rows;J++)this.buffer.lines.push(this.buffer.getBlankLine(ee.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),this.viewport?.reset(),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;const J=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this.viewport?.reset(),this._customKeyEventHandler=J,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(q.C0.ESC+"[I"):this.coreService.triggerDataEvent(q.C0.ESC+"[O")}_reportWindowsOptions(J){if(this._renderService)switch(J){case H.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const V=this._renderService.dimensions.css.canvas.width.toFixed(0),fe=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${q.C0.ESC}[4;${fe};${V}t`);break;case H.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const de=this._renderService.dimensions.css.cell.width.toFixed(0),be=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${q.C0.ESC}[6;${be};${de}t`)}}cancel(J,V){if(this.options.cancelEvents||V)return J.preventDefault(),J.stopPropagation(),!1}}a.Terminal=ne},9924:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TimeBasedDebouncer=void 0,a.TimeBasedDebouncer=class{constructor(l,c=1e3){this._renderCallback=l,this._debounceThresholdMS=c,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(l,c,u){this._rowCount=u,l=l!==void 0?l:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c;const h=Date.now();if(h-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=h,this._innerRefresh();else if(!this._additionalRefreshRequested){const d=h-this._lastRefreshMs,f=this._debounceThresholdMS-d;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},f)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const l=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,c)}}},1680:function(o,a,l){var c=this&&this.__decorate||function(p,y,b,v){var w,E=arguments.length,S=E<3?y:v===null?v=Object.getOwnPropertyDescriptor(y,b):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,y,b,v);else for(var x=p.length-1;x>=0;x--)(w=p[x])&&(S=(E<3?w(S):E>3?w(y,b,S):w(y,b))||S);return E>3&&S&&Object.defineProperty(y,b,S),S},u=this&&this.__param||function(p,y){return function(b,v){y(b,v,p)}};Object.defineProperty(a,"__esModule",{value:!0}),a.Viewport=void 0;const h=l(3656),d=l(4725),f=l(8460),g=l(844),_=l(2585);let m=a.Viewport=class extends g.Disposable{constructor(p,y,b,v,w,E,S,x){super(),this._viewportElement=p,this._scrollArea=y,this._bufferService=b,this._optionsService=v,this._charSizeService=w,this._renderService=E,this._coreBrowserService=S,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new f.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,h.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(C=>this._activeBuffer=C.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(C=>this._renderDimensions=C)),this._handleThemeChange(x.colors),this.register(x.onChangeColors(C=>this._handleThemeChange(C))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(p){this._viewportElement.style.backgroundColor=p.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(p){if(p)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const y=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==y&&(this._lastRecordedBufferHeight=y,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const p=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==p&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=p),this._refreshAnimationFrame=null}syncScrollArea(p=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(p);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(p)}_handleScroll(p){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const y=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:y,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const p=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(p*(this._smoothScrollState.target-this._smoothScrollState.origin)),p<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(p,y){const b=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(y<0&&this._viewportElement.scrollTop!==0||y>0&&b<this._lastRecordedBufferHeight)||(p.cancelable&&p.preventDefault(),!1)}handleWheel(p){const y=this._getPixelsScrolled(p);return y!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+y:this._smoothScrollState.target+=y,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=y,this._bubbleScroll(p,y))}scrollLines(p){if(p!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const y=p*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+y,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:p,suppressScrollEvent:!1})}_getPixelsScrolled(p){if(p.deltaY===0||p.shiftKey)return 0;let y=this._applyScrollModifier(p.deltaY,p);return p.deltaMode===WheelEvent.DOM_DELTA_LINE?y*=this._currentRowHeight:p.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(y*=this._currentRowHeight*this._bufferService.rows),y}getBufferElements(p,y){let b,v="";const w=[],E=y??this._bufferService.buffer.lines.length,S=this._bufferService.buffer.lines;for(let x=p;x<E;x++){const C=S.get(x);if(!C)continue;const A=S.get(x+1)?.isWrapped;if(v+=C.translateToString(!A),!A||x===S.length-1){const M=document.createElement("div");M.textContent=v,w.push(M),v.length>0&&(b=M),v=""}}return{bufferElements:w,cursorElement:b}}getLinesScrolled(p){if(p.deltaY===0||p.shiftKey)return 0;let y=this._applyScrollModifier(p.deltaY,p);return p.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(y/=this._currentRowHeight+0,this._wheelPartialScroll+=y,y=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):p.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(y*=this._bufferService.rows),y}_applyScrollModifier(p,y){const b=this._optionsService.rawOptions.fastScrollModifier;return b==="alt"&&y.altKey||b==="ctrl"&&y.ctrlKey||b==="shift"&&y.shiftKey?p*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:p*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(p){this._lastTouchY=p.touches[0].pageY}handleTouchMove(p){const y=this._lastTouchY-p.touches[0].pageY;return this._lastTouchY=p.touches[0].pageY,y!==0&&(this._viewportElement.scrollTop+=y,this._bubbleScroll(p,y))}};a.Viewport=m=c([u(2,_.IBufferService),u(3,_.IOptionsService),u(4,d.ICharSizeService),u(5,d.IRenderService),u(6,d.ICoreBrowserService),u(7,d.IThemeService)],m)},3107:function(o,a,l){var c=this&&this.__decorate||function(_,m,p,y){var b,v=arguments.length,w=v<3?m:y===null?y=Object.getOwnPropertyDescriptor(m,p):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(_,m,p,y);else for(var E=_.length-1;E>=0;E--)(b=_[E])&&(w=(v<3?b(w):v>3?b(m,p,w):b(m,p))||w);return v>3&&w&&Object.defineProperty(m,p,w),w},u=this&&this.__param||function(_,m){return function(p,y){m(p,y,_)}};Object.defineProperty(a,"__esModule",{value:!0}),a.BufferDecorationRenderer=void 0;const h=l(4725),d=l(844),f=l(2585);let g=a.BufferDecorationRenderer=class extends d.Disposable{constructor(_,m,p,y,b){super(),this._screenElement=_,this._bufferService=m,this._coreBrowserService=p,this._decorationService=y,this._renderService=b,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(v=>this._removeDecoration(v))),this.register((0,d.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const _ of this._decorationService.decorations)this._renderDecoration(_);this._dimensionsChanged=!1}_renderDecoration(_){this._refreshStyle(_),this._dimensionsChanged&&this._refreshXPosition(_)}_createElement(_){const m=this._coreBrowserService.mainDocument.createElement("div");m.classList.add("xterm-decoration"),m.classList.toggle("xterm-decoration-top-layer",_?.options?.layer==="top"),m.style.width=`${Math.round((_.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,m.style.height=(_.options.height||1)*this._renderService.dimensions.css.cell.height+"px",m.style.top=(_.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",m.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const p=_.options.x??0;return p&&p>this._bufferService.cols&&(m.style.display="none"),this._refreshXPosition(_,m),m}_refreshStyle(_){const m=_.marker.line-this._bufferService.buffers.active.ydisp;if(m<0||m>=this._bufferService.rows)_.element&&(_.element.style.display="none",_.onRenderEmitter.fire(_.element));else{let p=this._decorationElements.get(_);p||(p=this._createElement(_),_.element=p,this._decorationElements.set(_,p),this._container.appendChild(p),_.onDispose(()=>{this._decorationElements.delete(_),p.remove()})),p.style.top=m*this._renderService.dimensions.css.cell.height+"px",p.style.display=this._altBufferIsActive?"none":"block",_.onRenderEmitter.fire(p)}}_refreshXPosition(_,m=_.element){if(!m)return;const p=_.options.x??0;(_.options.anchor||"left")==="right"?m.style.right=p?p*this._renderService.dimensions.css.cell.width+"px":"":m.style.left=p?p*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(_){this._decorationElements.get(_)?.remove(),this._decorationElements.delete(_),_.dispose()}};a.BufferDecorationRenderer=g=c([u(1,f.IBufferService),u(2,h.ICoreBrowserService),u(3,f.IDecorationService),u(4,h.IRenderService)],g)},5871:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ColorZoneStore=void 0,a.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(l){if(l.options.overviewRulerOptions){for(const c of this._zones)if(c.color===l.options.overviewRulerOptions.color&&c.position===l.options.overviewRulerOptions.position){if(this._lineIntersectsZone(c,l.marker.line))return;if(this._lineAdjacentToZone(c,l.marker.line,l.options.overviewRulerOptions.position))return void this._addLineToZone(c,l.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=l.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=l.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=l.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=l.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:l.options.overviewRulerOptions.color,position:l.options.overviewRulerOptions.position,startBufferLine:l.marker.line,endBufferLine:l.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(l){this._linePadding=l}_lineIntersectsZone(l,c){return c>=l.startBufferLine&&c<=l.endBufferLine}_lineAdjacentToZone(l,c,u){return c>=l.startBufferLine-this._linePadding[u||"full"]&&c<=l.endBufferLine+this._linePadding[u||"full"]}_addLineToZone(l,c){l.startBufferLine=Math.min(l.startBufferLine,c),l.endBufferLine=Math.max(l.endBufferLine,c)}}},5744:function(o,a,l){var c=this&&this.__decorate||function(b,v,w,E){var S,x=arguments.length,C=x<3?v:E===null?E=Object.getOwnPropertyDescriptor(v,w):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(b,v,w,E);else for(var A=b.length-1;A>=0;A--)(S=b[A])&&(C=(x<3?S(C):x>3?S(v,w,C):S(v,w))||C);return x>3&&C&&Object.defineProperty(v,w,C),C},u=this&&this.__param||function(b,v){return function(w,E){v(w,E,b)}};Object.defineProperty(a,"__esModule",{value:!0}),a.OverviewRulerRenderer=void 0;const h=l(5871),d=l(4725),f=l(844),g=l(2585),_={full:0,left:0,center:0,right:0},m={full:0,left:0,center:0,right:0},p={full:0,left:0,center:0,right:0};let y=a.OverviewRulerRenderer=class extends f.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(b,v,w,E,S,x,C){super(),this._viewportElement=b,this._screenElement=v,this._bufferService=w,this._decorationService=E,this._renderService=S,this._optionsService=x,this._coreBrowserService=C,this._colorZoneStore=new h.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement);const A=this._canvas.getContext("2d");if(!A)throw new Error("Ctx cannot be null");this._ctx=A,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,f.toDisposable)(()=>{this._canvas?.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const b=Math.floor(this._canvas.width/3),v=Math.ceil(this._canvas.width/3);m.full=this._canvas.width,m.left=b,m.center=v,m.right=b,this._refreshDrawHeightConstants(),p.full=0,p.left=0,p.center=m.left,p.right=m.left+m.center}_refreshDrawHeightConstants(){_.full=Math.round(2*this._coreBrowserService.dpr);const b=this._canvas.height/this._bufferService.buffer.lines.length,v=Math.round(Math.max(Math.min(b,12),6)*this._coreBrowserService.dpr);_.left=v,_.center=v,_.right=v}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const v of this._decorationService.decorations)this._colorZoneStore.addDecoration(v);this._ctx.lineWidth=1;const b=this._colorZoneStore.zones;for(const v of b)v.position!=="full"&&this._renderColorZone(v);for(const v of b)v.position==="full"&&this._renderColorZone(v);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(b){this._ctx.fillStyle=b.color,this._ctx.fillRect(p[b.position||"full"],Math.round((this._canvas.height-1)*(b.startBufferLine/this._bufferService.buffers.active.lines.length)-_[b.position||"full"]/2),m[b.position||"full"],Math.round((this._canvas.height-1)*((b.endBufferLine-b.startBufferLine)/this._bufferService.buffers.active.lines.length)+_[b.position||"full"]))}_queueRefresh(b,v){this._shouldUpdateDimensions=b||this._shouldUpdateDimensions,this._shouldUpdateAnchor=v||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};a.OverviewRulerRenderer=y=c([u(2,g.IBufferService),u(3,g.IDecorationService),u(4,d.IRenderService),u(5,g.IOptionsService),u(6,d.ICoreBrowserService)],y)},2950:function(o,a,l){var c=this&&this.__decorate||function(_,m,p,y){var b,v=arguments.length,w=v<3?m:y===null?y=Object.getOwnPropertyDescriptor(m,p):y;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(_,m,p,y);else for(var E=_.length-1;E>=0;E--)(b=_[E])&&(w=(v<3?b(w):v>3?b(m,p,w):b(m,p))||w);return v>3&&w&&Object.defineProperty(m,p,w),w},u=this&&this.__param||function(_,m){return function(p,y){m(p,y,_)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CompositionHelper=void 0;const h=l(4725),d=l(2585),f=l(2584);let g=a.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(_,m,p,y,b,v){this._textarea=_,this._compositionView=m,this._bufferService=p,this._optionsService=y,this._coreService=b,this._renderService=v,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(_){this._compositionView.textContent=_.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(_){if(this._isComposing||this._isSendingComposition){if(_.keyCode===229||_.keyCode===16||_.keyCode===17||_.keyCode===18)return!1;this._finalizeComposition(!1)}return _.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(_){if(this._compositionView.classList.remove("active"),this._isComposing=!1,_){const m={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let p;this._isSendingComposition=!1,m.start+=this._dataAlreadySent.length,p=this._isComposing?this._textarea.value.substring(m.start,m.end):this._textarea.value.substring(m.start),p.length>0&&this._coreService.triggerDataEvent(p,!0)}},0)}else{this._isSendingComposition=!1;const m=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(m,!0)}}_handleAnyTextareaChanges(){const _=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const m=this._textarea.value,p=m.replace(_,"");this._dataAlreadySent=p,m.length>_.length?this._coreService.triggerDataEvent(p,!0):m.length<_.length?this._coreService.triggerDataEvent(`${f.C0.DEL}`,!0):m.length===_.length&&m!==_&&this._coreService.triggerDataEvent(m,!0)}},0)}updateCompositionElements(_){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const m=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),p=this._renderService.dimensions.css.cell.height,y=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,b=m*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=b+"px",this._compositionView.style.top=y+"px",this._compositionView.style.height=p+"px",this._compositionView.style.lineHeight=p+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const v=this._compositionView.getBoundingClientRect();this._textarea.style.left=b+"px",this._textarea.style.top=y+"px",this._textarea.style.width=Math.max(v.width,1)+"px",this._textarea.style.height=Math.max(v.height,1)+"px",this._textarea.style.lineHeight=v.height+"px"}_||setTimeout(()=>this.updateCompositionElements(!0),0)}}};a.CompositionHelper=g=c([u(2,d.IBufferService),u(3,d.IOptionsService),u(4,d.ICoreService),u(5,h.IRenderService)],g)},9806:(o,a)=>{function l(c,u,h){const d=h.getBoundingClientRect(),f=c.getComputedStyle(h),g=parseInt(f.getPropertyValue("padding-left")),_=parseInt(f.getPropertyValue("padding-top"));return[u.clientX-d.left-g,u.clientY-d.top-_]}Object.defineProperty(a,"__esModule",{value:!0}),a.getCoords=a.getCoordsRelativeToElement=void 0,a.getCoordsRelativeToElement=l,a.getCoords=function(c,u,h,d,f,g,_,m,p){if(!g)return;const y=l(c,u,h);return y?(y[0]=Math.ceil((y[0]+(p?_/2:0))/_),y[1]=Math.ceil(y[1]/m),y[0]=Math.min(Math.max(y[0],1),d+(p?1:0)),y[1]=Math.min(Math.max(y[1],1),f),y):void 0}},9504:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.moveToCellSequence=void 0;const c=l(2584);function u(m,p,y,b){const v=m-h(m,y),w=p-h(p,y),E=Math.abs(v-w)-function(S,x,C){let A=0;const M=S-h(S,C),P=x-h(x,C);for(let D=0;D<Math.abs(M-P);D++){const R=d(S,x)==="A"?-1:1;C.buffer.lines.get(M+R*D)?.isWrapped&&A++}return A}(m,p,y);return _(E,g(d(m,p),b))}function h(m,p){let y=0,b=p.buffer.lines.get(m),v=b?.isWrapped;for(;v&&m>=0&&m<p.rows;)y++,b=p.buffer.lines.get(--m),v=b?.isWrapped;return y}function d(m,p){return m>p?"A":"B"}function f(m,p,y,b,v,w){let E=m,S=p,x="";for(;E!==y||S!==b;)E+=v?1:-1,v&&E>w.cols-1?(x+=w.buffer.translateBufferLineToString(S,!1,m,E),E=0,m=0,S++):!v&&E<0&&(x+=w.buffer.translateBufferLineToString(S,!1,0,m+1),E=w.cols-1,m=E,S--);return x+w.buffer.translateBufferLineToString(S,!1,m,E)}function g(m,p){const y=p?"O":"[";return c.C0.ESC+y+m}function _(m,p){m=Math.floor(m);let y="";for(let b=0;b<m;b++)y+=p;return y}a.moveToCellSequence=function(m,p,y,b){const v=y.buffer.x,w=y.buffer.y;if(!y.buffer.hasScrollback)return function(x,C,A,M,P,D){return u(C,M,P,D).length===0?"":_(f(x,C,x,C-h(C,P),!1,P).length,g("D",D))}(v,w,0,p,y,b)+u(w,p,y,b)+function(x,C,A,M,P,D){let R;R=u(C,M,P,D).length>0?M-h(M,P):C;const G=M,ee=function(q,re,N,B,$,H){let U;return U=u(N,B,$,H).length>0?B-h(B,$):re,q<N&&U<=B||q>=N&&U<B?"C":"D"}(x,C,A,M,P,D);return _(f(x,R,A,G,ee==="C",P).length,g(ee,D))}(v,w,m,p,y,b);let E;if(w===p)return E=v>m?"D":"C",_(Math.abs(v-m),g(E,b));E=w>p?"D":"C";const S=Math.abs(w-p);return _(function(x,C){return C.cols-x}(w>p?m:v,y)+(S-1)*y.cols+1+((w>p?v:m)-1),g(E,b))}},1296:function(o,a,l){var c=this&&this.__decorate||function(D,R,G,ee){var q,re=arguments.length,N=re<3?R:ee===null?ee=Object.getOwnPropertyDescriptor(R,G):ee;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")N=Reflect.decorate(D,R,G,ee);else for(var B=D.length-1;B>=0;B--)(q=D[B])&&(N=(re<3?q(N):re>3?q(R,G,N):q(R,G))||N);return re>3&&N&&Object.defineProperty(R,G,N),N},u=this&&this.__param||function(D,R){return function(G,ee){R(G,ee,D)}};Object.defineProperty(a,"__esModule",{value:!0}),a.DomRenderer=void 0;const h=l(3787),d=l(2550),f=l(2223),g=l(6171),_=l(6052),m=l(4725),p=l(8055),y=l(8460),b=l(844),v=l(2585),w="xterm-dom-renderer-owner-",E="xterm-rows",S="xterm-fg-",x="xterm-bg-",C="xterm-focus",A="xterm-selection";let M=1,P=a.DomRenderer=class extends b.Disposable{constructor(D,R,G,ee,q,re,N,B,$,H,U,Q,ne){super(),this._terminal=D,this._document=R,this._element=G,this._screenElement=ee,this._viewportElement=q,this._helperContainer=re,this._linkifier2=N,this._charSizeService=$,this._optionsService=H,this._bufferService=U,this._coreBrowserService=Q,this._themeService=ne,this._terminalClass=M++,this._rowElements=[],this._selectionRenderModel=(0,_.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new y.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(E),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(A),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,g.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(ge=>this._injectCss(ge))),this._injectCss(this._themeService.colors),this._rowFactory=B.createInstance(h.DomRendererRowFactory,document),this._element.classList.add(w+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(ge=>this._handleLinkHover(ge))),this.register(this._linkifier2.onHideLinkUnderline(ge=>this._handleLinkLeave(ge))),this.register((0,b.toDisposable)(()=>{this._element.classList.remove(w+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new d.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const D=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*D,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*D),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/D),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/D),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const G of this._rowElements)G.style.width=`${this.dimensions.css.canvas.width}px`,G.style.height=`${this.dimensions.css.cell.height}px`,G.style.lineHeight=`${this.dimensions.css.cell.height}px`,G.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const R=`${this._terminalSelector} .${E} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=R,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(D){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let R=`${this._terminalSelector} .${E} { color: ${D.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;R+=`${this._terminalSelector} .${E} .xterm-dim { color: ${p.color.multiplyOpacity(D.foreground,.5).css};}`,R+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const G=`blink_underline_${this._terminalClass}`,ee=`blink_bar_${this._terminalClass}`,q=`blink_block_${this._terminalClass}`;R+=`@keyframes ${G} { 50% {  border-bottom-style: hidden; }}`,R+=`@keyframes ${ee} { 50% {  box-shadow: none; }}`,R+=`@keyframes ${q} { 0% {  background-color: ${D.cursor.css};  color: ${D.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${D.cursor.css}; }}`,R+=`${this._terminalSelector} .${E}.${C} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${G} 1s step-end infinite;}${this._terminalSelector} .${E}.${C} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${ee} 1s step-end infinite;}${this._terminalSelector} .${E}.${C} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${q} 1s step-end infinite;}${this._terminalSelector} .${E} .xterm-cursor.xterm-cursor-block { background-color: ${D.cursor.css}; color: ${D.cursorAccent.css};}${this._terminalSelector} .${E} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${D.cursor.css} !important; color: ${D.cursorAccent.css} !important;}${this._terminalSelector} .${E} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${D.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${E} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${D.cursor.css} inset;}${this._terminalSelector} .${E} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${D.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,R+=`${this._terminalSelector} .${A} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${A} div { position: absolute; background-color: ${D.selectionBackgroundOpaque.css};}${this._terminalSelector} .${A} div { position: absolute; background-color: ${D.selectionInactiveBackgroundOpaque.css};}`;for(const[re,N]of D.ansi.entries())R+=`${this._terminalSelector} .${S}${re} { color: ${N.css}; }${this._terminalSelector} .${S}${re}.xterm-dim { color: ${p.color.multiplyOpacity(N,.5).css}; }${this._terminalSelector} .${x}${re} { background-color: ${N.css}; }`;R+=`${this._terminalSelector} .${S}${f.INVERTED_DEFAULT_COLOR} { color: ${p.color.opaque(D.background).css}; }${this._terminalSelector} .${S}${f.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${p.color.multiplyOpacity(p.color.opaque(D.background),.5).css}; }${this._terminalSelector} .${x}${f.INVERTED_DEFAULT_COLOR} { background-color: ${D.foreground.css}; }`,this._themeStyleElement.textContent=R}_setDefaultSpacing(){const D=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${D}px`,this._rowFactory.defaultSpacing=D}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(D,R){for(let G=this._rowElements.length;G<=R;G++){const ee=this._document.createElement("div");this._rowContainer.appendChild(ee),this._rowElements.push(ee)}for(;this._rowElements.length>R;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(D,R){this._refreshRowElements(D,R),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(C),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(C),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(D,R,G){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(D,R,G),this.renderRows(0,this._bufferService.rows-1),!D||!R)return;this._selectionRenderModel.update(this._terminal,D,R,G);const ee=this._selectionRenderModel.viewportStartRow,q=this._selectionRenderModel.viewportEndRow,re=this._selectionRenderModel.viewportCappedStartRow,N=this._selectionRenderModel.viewportCappedEndRow;if(re>=this._bufferService.rows||N<0)return;const B=this._document.createDocumentFragment();if(G){const $=D[0]>R[0];B.appendChild(this._createSelectionElement(re,$?R[0]:D[0],$?D[0]:R[0],N-re+1))}else{const $=ee===re?D[0]:0,H=re===q?R[0]:this._bufferService.cols;B.appendChild(this._createSelectionElement(re,$,H));const U=N-re-1;if(B.appendChild(this._createSelectionElement(re+1,0,this._bufferService.cols,U)),re!==N){const Q=q===N?R[0]:this._bufferService.cols;B.appendChild(this._createSelectionElement(N,0,Q))}}this._selectionContainer.appendChild(B)}_createSelectionElement(D,R,G,ee=1){const q=this._document.createElement("div"),re=R*this.dimensions.css.cell.width;let N=this.dimensions.css.cell.width*(G-R);return re+N>this.dimensions.css.canvas.width&&(N=this.dimensions.css.canvas.width-re),q.style.height=ee*this.dimensions.css.cell.height+"px",q.style.top=D*this.dimensions.css.cell.height+"px",q.style.left=`${re}px`,q.style.width=`${N}px`,q}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const D of this._rowElements)D.replaceChildren()}renderRows(D,R){const G=this._bufferService.buffer,ee=G.ybase+G.y,q=Math.min(G.x,this._bufferService.cols-1),re=this._optionsService.rawOptions.cursorBlink,N=this._optionsService.rawOptions.cursorStyle,B=this._optionsService.rawOptions.cursorInactiveStyle;for(let $=D;$<=R;$++){const H=$+G.ydisp,U=this._rowElements[$],Q=G.lines.get(H);if(!U||!Q)break;U.replaceChildren(...this._rowFactory.createRow(Q,H,H===ee,N,B,q,re,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${w}${this._terminalClass}`}_handleLinkHover(D){this._setCellUnderline(D.x1,D.x2,D.y1,D.y2,D.cols,!0)}_handleLinkLeave(D){this._setCellUnderline(D.x1,D.x2,D.y1,D.y2,D.cols,!1)}_setCellUnderline(D,R,G,ee,q,re){G<0&&(D=0),ee<0&&(R=0);const N=this._bufferService.rows-1;G=Math.max(Math.min(G,N),0),ee=Math.max(Math.min(ee,N),0),q=Math.min(q,this._bufferService.cols);const B=this._bufferService.buffer,$=B.ybase+B.y,H=Math.min(B.x,q-1),U=this._optionsService.rawOptions.cursorBlink,Q=this._optionsService.rawOptions.cursorStyle,ne=this._optionsService.rawOptions.cursorInactiveStyle;for(let ge=G;ge<=ee;++ge){const J=ge+B.ydisp,V=this._rowElements[ge],fe=B.lines.get(J);if(!V||!fe)break;V.replaceChildren(...this._rowFactory.createRow(fe,J,J===$,Q,ne,H,U,this.dimensions.css.cell.width,this._widthCache,re?ge===G?D:0:-1,re?(ge===ee?R:q)-1:-1))}}};a.DomRenderer=P=c([u(7,v.IInstantiationService),u(8,m.ICharSizeService),u(9,v.IOptionsService),u(10,v.IBufferService),u(11,m.ICoreBrowserService),u(12,m.IThemeService)],P)},3787:function(o,a,l){var c=this&&this.__decorate||function(E,S,x,C){var A,M=arguments.length,P=M<3?S:C===null?C=Object.getOwnPropertyDescriptor(S,x):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(E,S,x,C);else for(var D=E.length-1;D>=0;D--)(A=E[D])&&(P=(M<3?A(P):M>3?A(S,x,P):A(S,x))||P);return M>3&&P&&Object.defineProperty(S,x,P),P},u=this&&this.__param||function(E,S){return function(x,C){S(x,C,E)}};Object.defineProperty(a,"__esModule",{value:!0}),a.DomRendererRowFactory=void 0;const h=l(2223),d=l(643),f=l(511),g=l(2585),_=l(8055),m=l(4725),p=l(4269),y=l(6171),b=l(3734);let v=a.DomRendererRowFactory=class{constructor(E,S,x,C,A,M,P){this._document=E,this._characterJoinerService=S,this._optionsService=x,this._coreBrowserService=C,this._coreService=A,this._decorationService=M,this._themeService=P,this._workCell=new f.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(E,S,x){this._selectionStart=E,this._selectionEnd=S,this._columnSelectMode=x}createRow(E,S,x,C,A,M,P,D,R,G,ee){const q=[],re=this._characterJoinerService.getJoinedCharacters(S),N=this._themeService.colors;let B,$=E.getNoBgTrimmedLength();x&&$<M+1&&($=M+1);let H=0,U="",Q=0,ne=0,ge=0,J=!1,V=0,fe=!1,de=0;const be=[],me=G!==-1&&ee!==-1;for(let ve=0;ve<$;ve++){E.loadCell(ve,this._workCell);let L=this._workCell.getWidth();if(L===0)continue;let oe=!1,ie=ve,W=this._workCell;if(re.length>0&&ve===re[0][0]){oe=!0;const F=re.shift();W=new p.JoinedCellData(this._workCell,E.translateToString(!0,F[0],F[1]),F[1]-F[0]),ie=F[1]-1,L=W.getWidth()}const K=this._isCellInSelection(ve,S),ae=x&&ve===M,xe=me&&ve>=G&&ve<=ee;let Te=!1;this._decorationService.forEachDecorationAtCell(ve,S,void 0,F=>{Te=!0});let le=W.getChars()||d.WHITESPACE_CELL_CHAR;if(le===" "&&(W.isUnderline()||W.isOverline())&&(le=" "),de=L*D-R.get(le,W.isBold(),W.isItalic()),B){if(H&&(K&&fe||!K&&!fe&&W.bg===Q)&&(K&&fe&&N.selectionForeground||W.fg===ne)&&W.extended.ext===ge&&xe===J&&de===V&&!ae&&!oe&&!Te){W.isInvisible()?U+=d.WHITESPACE_CELL_CHAR:U+=le,H++;continue}H&&(B.textContent=U),B=this._document.createElement("span"),H=0,U=""}else B=this._document.createElement("span");if(Q=W.bg,ne=W.fg,ge=W.extended.ext,J=xe,V=de,fe=K,oe&&M>=ve&&M<=ie&&(M=ve),!this._coreService.isCursorHidden&&ae&&this._coreService.isCursorInitialized){if(be.push("xterm-cursor"),this._coreBrowserService.isFocused)P&&be.push("xterm-cursor-blink"),be.push(C==="bar"?"xterm-cursor-bar":C==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(A)switch(A){case"outline":be.push("xterm-cursor-outline");break;case"block":be.push("xterm-cursor-block");break;case"bar":be.push("xterm-cursor-bar");break;case"underline":be.push("xterm-cursor-underline")}}if(W.isBold()&&be.push("xterm-bold"),W.isItalic()&&be.push("xterm-italic"),W.isDim()&&be.push("xterm-dim"),U=W.isInvisible()?d.WHITESPACE_CELL_CHAR:W.getChars()||d.WHITESPACE_CELL_CHAR,W.isUnderline()&&(be.push(`xterm-underline-${W.extended.underlineStyle}`),U===" "&&(U=" "),!W.isUnderlineColorDefault()))if(W.isUnderlineColorRGB())B.style.textDecorationColor=`rgb(${b.AttributeData.toColorRGB(W.getUnderlineColor()).join(",")})`;else{let F=W.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&W.isBold()&&F<8&&(F+=8),B.style.textDecorationColor=N.ansi[F].css}W.isOverline()&&(be.push("xterm-overline"),U===" "&&(U=" ")),W.isStrikethrough()&&be.push("xterm-strikethrough"),xe&&(B.style.textDecoration="underline");let Se=W.getFgColor(),Oe=W.getFgColorMode(),Ce=W.getBgColor(),he=W.getBgColorMode();const ke=!!W.isInverse();if(ke){const F=Se;Se=Ce,Ce=F;const Y=Oe;Oe=he,he=Y}let Ie,Ye,z,O=!1;switch(this._decorationService.forEachDecorationAtCell(ve,S,void 0,F=>{F.options.layer!=="top"&&O||(F.backgroundColorRGB&&(he=50331648,Ce=F.backgroundColorRGB.rgba>>8&16777215,Ie=F.backgroundColorRGB),F.foregroundColorRGB&&(Oe=50331648,Se=F.foregroundColorRGB.rgba>>8&16777215,Ye=F.foregroundColorRGB),O=F.options.layer==="top")}),!O&&K&&(Ie=this._coreBrowserService.isFocused?N.selectionBackgroundOpaque:N.selectionInactiveBackgroundOpaque,Ce=Ie.rgba>>8&16777215,he=50331648,O=!0,N.selectionForeground&&(Oe=50331648,Se=N.selectionForeground.rgba>>8&16777215,Ye=N.selectionForeground)),O&&be.push("xterm-decoration-top"),he){case 16777216:case 33554432:z=N.ansi[Ce],be.push(`xterm-bg-${Ce}`);break;case 50331648:z=_.channels.toColor(Ce>>16,Ce>>8&255,255&Ce),this._addStyle(B,`background-color:#${w((Ce>>>0).toString(16),"0",6)}`);break;default:ke?(z=N.foreground,be.push(`xterm-bg-${h.INVERTED_DEFAULT_COLOR}`)):z=N.background}switch(Ie||W.isDim()&&(Ie=_.color.multiplyOpacity(z,.5)),Oe){case 16777216:case 33554432:W.isBold()&&Se<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(Se+=8),this._applyMinimumContrast(B,z,N.ansi[Se],W,Ie,void 0)||be.push(`xterm-fg-${Se}`);break;case 50331648:const F=_.channels.toColor(Se>>16&255,Se>>8&255,255&Se);this._applyMinimumContrast(B,z,F,W,Ie,Ye)||this._addStyle(B,`color:#${w(Se.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(B,z,N.foreground,W,Ie,Ye)||ke&&be.push(`xterm-fg-${h.INVERTED_DEFAULT_COLOR}`)}be.length&&(B.className=be.join(" "),be.length=0),ae||oe||Te?B.textContent=U:H++,de!==this.defaultSpacing&&(B.style.letterSpacing=`${de}px`),q.push(B),ve=ie}return B&&H&&(B.textContent=U),q}_applyMinimumContrast(E,S,x,C,A,M){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,y.treatGlyphAsBackgroundColor)(C.getCode()))return!1;const P=this._getContrastCache(C);let D;if(A||M||(D=P.getColor(S.rgba,x.rgba)),D===void 0){const R=this._optionsService.rawOptions.minimumContrastRatio/(C.isDim()?2:1);D=_.color.ensureContrastRatio(A||S,M||x,R),P.setColor((A||S).rgba,(M||x).rgba,D??null)}return!!D&&(this._addStyle(E,`color:${D.css}`),!0)}_getContrastCache(E){return E.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(E,S){E.setAttribute("style",`${E.getAttribute("style")||""}${S};`)}_isCellInSelection(E,S){const x=this._selectionStart,C=this._selectionEnd;return!(!x||!C)&&(this._columnSelectMode?x[0]<=C[0]?E>=x[0]&&S>=x[1]&&E<C[0]&&S<=C[1]:E<x[0]&&S>=x[1]&&E>=C[0]&&S<=C[1]:S>x[1]&&S<C[1]||x[1]===C[1]&&S===x[1]&&E>=x[0]&&E<C[0]||x[1]<C[1]&&S===C[1]&&E<C[0]||x[1]<C[1]&&S===x[1]&&E>=x[0])}};function w(E,S,x){for(;E.length<x;)E=S+E;return E}a.DomRendererRowFactory=v=c([u(1,m.ICharacterJoinerService),u(2,g.IOptionsService),u(3,m.ICoreBrowserService),u(4,g.ICoreService),u(5,g.IDecorationService),u(6,m.IThemeService)],v)},2550:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.WidthCache=void 0,a.WidthCache=class{constructor(l,c){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=l.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const u=l.createElement("span");u.classList.add("xterm-char-measure-element");const h=l.createElement("span");h.classList.add("xterm-char-measure-element"),h.style.fontWeight="bold";const d=l.createElement("span");d.classList.add("xterm-char-measure-element"),d.style.fontStyle="italic";const f=l.createElement("span");f.classList.add("xterm-char-measure-element"),f.style.fontWeight="bold",f.style.fontStyle="italic",this._measureElements=[u,h,d,f],this._container.appendChild(u),this._container.appendChild(h),this._container.appendChild(d),this._container.appendChild(f),c.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(l,c,u,h){l===this._font&&c===this._fontSize&&u===this._weight&&h===this._weightBold||(this._font=l,this._fontSize=c,this._weight=u,this._weightBold=h,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${u}`,this._measureElements[1].style.fontWeight=`${h}`,this._measureElements[2].style.fontWeight=`${u}`,this._measureElements[3].style.fontWeight=`${h}`,this.clear())}get(l,c,u){let h=0;if(!c&&!u&&l.length===1&&(h=l.charCodeAt(0))<256){if(this._flat[h]!==-9999)return this._flat[h];const g=this._measure(l,0);return g>0&&(this._flat[h]=g),g}let d=l;c&&(d+="B"),u&&(d+="I");let f=this._holey.get(d);if(f===void 0){let g=0;c&&(g|=1),u&&(g|=2),f=this._measure(l,g),f>0&&this._holey.set(d,f)}return f}_measure(l,c){const u=this._measureElements[c];return u.textContent=l.repeat(32),u.offsetWidth/32}}},2223:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.TEXT_BASELINE=a.DIM_OPACITY=a.INVERTED_DEFAULT_COLOR=void 0;const c=l(6114);a.INVERTED_DEFAULT_COLOR=257,a.DIM_OPACITY=.5,a.TEXT_BASELINE=c.isFirefox||c.isLegacyEdge?"bottom":"ideographic"},6171:(o,a)=>{function l(u){return 57508<=u&&u<=57558}function c(u){return u>=128512&&u<=128591||u>=127744&&u<=128511||u>=128640&&u<=128767||u>=9728&&u<=9983||u>=9984&&u<=10175||u>=65024&&u<=65039||u>=129280&&u<=129535||u>=127462&&u<=127487}Object.defineProperty(a,"__esModule",{value:!0}),a.computeNextVariantOffset=a.createRenderDimensions=a.treatGlyphAsBackgroundColor=a.allowRescaling=a.isEmoji=a.isRestrictedPowerlineGlyph=a.isPowerlineGlyph=a.throwIfFalsy=void 0,a.throwIfFalsy=function(u){if(!u)throw new Error("value must not be falsy");return u},a.isPowerlineGlyph=l,a.isRestrictedPowerlineGlyph=function(u){return 57520<=u&&u<=57527},a.isEmoji=c,a.allowRescaling=function(u,h,d,f){return h===1&&d>Math.ceil(1.5*f)&&u!==void 0&&u>255&&!c(u)&&!l(u)&&!function(g){return 57344<=g&&g<=63743}(u)},a.treatGlyphAsBackgroundColor=function(u){return l(u)||function(h){return 9472<=h&&h<=9631}(u)},a.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},a.computeNextVariantOffset=function(u,h,d=0){return(u-(2*Math.round(h)-d))%(2*Math.round(h))}},6052:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createSelectionRenderModel=void 0;class l{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(u,h,d,f=!1){if(this.selectionStart=h,this.selectionEnd=d,!h||!d||h[0]===d[0]&&h[1]===d[1])return void this.clear();const g=u.buffers.active.ydisp,_=h[1]-g,m=d[1]-g,p=Math.max(_,0),y=Math.min(m,u.rows-1);p>=u.rows||y<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=f,this.viewportStartRow=_,this.viewportEndRow=m,this.viewportCappedStartRow=p,this.viewportCappedEndRow=y,this.startCol=h[0],this.endCol=d[0])}isCellSelected(u,h,d){return!!this.hasSelection&&(d-=u.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?h>=this.startCol&&d>=this.viewportCappedStartRow&&h<this.endCol&&d<=this.viewportCappedEndRow:h<this.startCol&&d>=this.viewportCappedStartRow&&h>=this.endCol&&d<=this.viewportCappedEndRow:d>this.viewportStartRow&&d<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&d===this.viewportStartRow&&h>=this.startCol&&h<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportEndRow&&h<this.endCol||this.viewportStartRow<this.viewportEndRow&&d===this.viewportStartRow&&h>=this.startCol)}}a.createSelectionRenderModel=function(){return new l}},456:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SelectionModel=void 0,a.SelectionModel=class{constructor(l){this._bufferService=l,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?l%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)-1]:[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[l,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[Math.max(l,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const l=this.selectionStart,c=this.selectionEnd;return!(!l||!c)&&(l[1]>c[1]||l[1]===c[1]&&l[0]>c[0])}handleTrim(l){return this.selectionStart&&(this.selectionStart[1]-=l),this.selectionEnd&&(this.selectionEnd[1]-=l),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(o,a,l){var c=this&&this.__decorate||function(y,b,v,w){var E,S=arguments.length,x=S<3?b:w===null?w=Object.getOwnPropertyDescriptor(b,v):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(y,b,v,w);else for(var C=y.length-1;C>=0;C--)(E=y[C])&&(x=(S<3?E(x):S>3?E(b,v,x):E(b,v))||x);return S>3&&x&&Object.defineProperty(b,v,x),x},u=this&&this.__param||function(y,b){return function(v,w){b(v,w,y)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CharSizeService=void 0;const h=l(2585),d=l(8460),f=l(844);let g=a.CharSizeService=class extends f.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(y,b,v){super(),this._optionsService=v,this.width=0,this.height=0,this._onCharSizeChange=this.register(new d.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new p(this._optionsService))}catch{this._measureStrategy=this.register(new m(y,b,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const y=this._measureStrategy.measure();y.width===this.width&&y.height===this.height||(this.width=y.width,this.height=y.height,this._onCharSizeChange.fire())}};a.CharSizeService=g=c([u(2,h.IOptionsService)],g);class _ extends f.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(b,v){b!==void 0&&b>0&&v!==void 0&&v>0&&(this._result.width=b,this._result.height=v)}}class m extends _{constructor(b,v,w){super(),this._document=b,this._parentElement=v,this._optionsService=w,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class p extends _{constructor(b){super(),this._optionsService=b,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const v=this._ctx.measureText("W");if(!("width"in v&&"fontBoundingBoxAscent"in v&&"fontBoundingBoxDescent"in v))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const b=this._ctx.measureText("W");return this._validateAndSet(b.width,b.fontBoundingBoxAscent+b.fontBoundingBoxDescent),this._result}}},4269:function(o,a,l){var c=this&&this.__decorate||function(p,y,b,v){var w,E=arguments.length,S=E<3?y:v===null?v=Object.getOwnPropertyDescriptor(y,b):v;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(p,y,b,v);else for(var x=p.length-1;x>=0;x--)(w=p[x])&&(S=(E<3?w(S):E>3?w(y,b,S):w(y,b))||S);return E>3&&S&&Object.defineProperty(y,b,S),S},u=this&&this.__param||function(p,y){return function(b,v){y(b,v,p)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CharacterJoinerService=a.JoinedCellData=void 0;const h=l(3734),d=l(643),f=l(511),g=l(2585);class _ extends h.AttributeData{constructor(y,b,v){super(),this.content=0,this.combinedData="",this.fg=y.fg,this.bg=y.bg,this.combinedData=b,this._width=v}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(y){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}a.JoinedCellData=_;let m=a.CharacterJoinerService=class lV{constructor(y){this._bufferService=y,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new f.CellData}register(y){const b={id:this._nextCharacterJoinerId++,handler:y};return this._characterJoiners.push(b),b.id}deregister(y){for(let b=0;b<this._characterJoiners.length;b++)if(this._characterJoiners[b].id===y)return this._characterJoiners.splice(b,1),!0;return!1}getJoinedCharacters(y){if(this._characterJoiners.length===0)return[];const b=this._bufferService.buffer.lines.get(y);if(!b||b.length===0)return[];const v=[],w=b.translateToString(!0);let E=0,S=0,x=0,C=b.getFg(0),A=b.getBg(0);for(let M=0;M<b.getTrimmedLength();M++)if(b.loadCell(M,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==C||this._workCell.bg!==A){if(M-E>1){const P=this._getJoinedRanges(w,x,S,b,E);for(let D=0;D<P.length;D++)v.push(P[D])}E=M,x=S,C=this._workCell.fg,A=this._workCell.bg}S+=this._workCell.getChars().length||d.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-E>1){const M=this._getJoinedRanges(w,x,S,b,E);for(let P=0;P<M.length;P++)v.push(M[P])}return v}_getJoinedRanges(y,b,v,w,E){const S=y.substring(b,v);let x=[];try{x=this._characterJoiners[0].handler(S)}catch(C){console.error(C)}for(let C=1;C<this._characterJoiners.length;C++)try{const A=this._characterJoiners[C].handler(S);for(let M=0;M<A.length;M++)lV._mergeRanges(x,A[M])}catch(A){console.error(A)}return this._stringRangesToCellRanges(x,w,E),x}_stringRangesToCellRanges(y,b,v){let w=0,E=!1,S=0,x=y[w];if(x){for(let C=v;C<this._bufferService.cols;C++){const A=b.getWidth(C),M=b.getString(C).length||d.WHITESPACE_CELL_CHAR.length;if(A!==0){if(!E&&x[0]<=S&&(x[0]=C,E=!0),x[1]<=S){if(x[1]=C,x=y[++w],!x)break;x[0]<=S?(x[0]=C,E=!0):E=!1}S+=M}}x&&(x[1]=this._bufferService.cols)}}static _mergeRanges(y,b){let v=!1;for(let w=0;w<y.length;w++){const E=y[w];if(v){if(b[1]<=E[0])return y[w-1][1]=b[1],y;if(b[1]<=E[1])return y[w-1][1]=Math.max(b[1],E[1]),y.splice(w,1),y;y.splice(w,1),w--}else{if(b[1]<=E[0])return y.splice(w,0,b),y;if(b[1]<=E[1])return E[0]=Math.min(b[0],E[0]),y;b[0]<E[1]&&(E[0]=Math.min(b[0],E[0]),v=!0)}}return v?y[y.length-1][1]=b[1]:y.push(b),y}};a.CharacterJoinerService=m=c([u(0,g.IBufferService)],m)},5114:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CoreBrowserService=void 0;const c=l(844),u=l(8460),h=l(3656);class d extends c.Disposable{constructor(_,m,p){super(),this._textarea=_,this._window=m,this.mainDocument=p,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new f(this._window),this._onDprChange=this.register(new u.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new u.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(y=>this._screenDprMonitor.setWindow(y))),this.register((0,u.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(_){this._window!==_&&(this._window=_,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}a.CoreBrowserService=d;class f extends c.Disposable{constructor(_){super(),this._parentWindow=_,this._windowResizeListener=this.register(new c.MutableDisposable),this._onDprChange=this.register(new u.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,c.toDisposable)(()=>this.clearListener()))}setWindow(_){this._parentWindow=_,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,h.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.LinkProviderService=void 0;const c=l(844);class u extends c.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,c.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(d){return this.linkProviders.push(d),{dispose:()=>{const f=this.linkProviders.indexOf(d);f!==-1&&this.linkProviders.splice(f,1)}}}}a.LinkProviderService=u},8934:function(o,a,l){var c=this&&this.__decorate||function(g,_,m,p){var y,b=arguments.length,v=b<3?_:p===null?p=Object.getOwnPropertyDescriptor(_,m):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")v=Reflect.decorate(g,_,m,p);else for(var w=g.length-1;w>=0;w--)(y=g[w])&&(v=(b<3?y(v):b>3?y(_,m,v):y(_,m))||v);return b>3&&v&&Object.defineProperty(_,m,v),v},u=this&&this.__param||function(g,_){return function(m,p){_(m,p,g)}};Object.defineProperty(a,"__esModule",{value:!0}),a.MouseService=void 0;const h=l(4725),d=l(9806);let f=a.MouseService=class{constructor(g,_){this._renderService=g,this._charSizeService=_}getCoords(g,_,m,p,y){return(0,d.getCoords)(window,g,_,m,p,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,y)}getMouseReportCoords(g,_){const m=(0,d.getCoordsRelativeToElement)(window,g,_);if(this._charSizeService.hasValidSize)return m[0]=Math.min(Math.max(m[0],0),this._renderService.dimensions.css.canvas.width-1),m[1]=Math.min(Math.max(m[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(m[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(m[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(m[0]),y:Math.floor(m[1])}}};a.MouseService=f=c([u(0,h.IRenderService),u(1,h.ICharSizeService)],f)},3230:function(o,a,l){var c=this&&this.__decorate||function(y,b,v,w){var E,S=arguments.length,x=S<3?b:w===null?w=Object.getOwnPropertyDescriptor(b,v):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(y,b,v,w);else for(var C=y.length-1;C>=0;C--)(E=y[C])&&(x=(S<3?E(x):S>3?E(b,v,x):E(b,v))||x);return S>3&&x&&Object.defineProperty(b,v,x),x},u=this&&this.__param||function(y,b){return function(v,w){b(v,w,y)}};Object.defineProperty(a,"__esModule",{value:!0}),a.RenderService=void 0;const h=l(6193),d=l(4725),f=l(8460),g=l(844),_=l(7226),m=l(2585);let p=a.RenderService=class extends g.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(y,b,v,w,E,S,x,C){super(),this._rowCount=y,this._charSizeService=w,this._renderer=this.register(new g.MutableDisposable),this._pausedResizeTask=new _.DebouncedIdleTask,this._observerDisposable=this.register(new g.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new f.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new f.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new f.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new f.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new h.RenderDebouncer((A,M)=>this._renderRows(A,M),x),this.register(this._renderDebouncer),this.register(x.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(S.onResize(()=>this._fullRefresh())),this.register(S.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this.register(v.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(E.onDecorationRegistered(()=>this._fullRefresh())),this.register(E.onDecorationRemoved(()=>this._fullRefresh())),this.register(v.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(S.cols,S.rows),this._fullRefresh()})),this.register(v.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(S.buffer.y,S.buffer.y,!0))),this.register(C.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(x.window,b),this.register(x.onWindowChange(A=>this._registerIntersectionObserver(A,b)))}_registerIntersectionObserver(y,b){if("IntersectionObserver"in y){const v=new y.IntersectionObserver(w=>this._handleIntersectionChange(w[w.length-1]),{threshold:0});v.observe(b),this._observerDisposable.value=(0,g.toDisposable)(()=>v.disconnect())}}_handleIntersectionChange(y){this._isPaused=y.isIntersecting===void 0?y.intersectionRatio===0:!y.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(y,b,v=!1){this._isPaused?this._needsFullRefresh=!0:(v||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(y,b,this._rowCount))}_renderRows(y,b){this._renderer.value&&(y=Math.min(y,this._rowCount-1),b=Math.min(b,this._rowCount-1),this._renderer.value.renderRows(y,b),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:y,end:b}),this._onRender.fire({start:y,end:b}),this._isNextRenderRedrawOnly=!0)}resize(y,b){this._rowCount=b,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(y){this._renderer.value=y,this._renderer.value&&(this._renderer.value.onRequestRedraw(b=>this.refreshRows(b.start,b.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(y){return this._renderDebouncer.addRefreshCallback(y)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(y,b){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(y,b)):this._renderer.value.handleResize(y,b),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(y,b,v){this._selectionState.start=y,this._selectionState.end=b,this._selectionState.columnSelectMode=v,this._renderer.value?.handleSelectionChanged(y,b,v)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};a.RenderService=p=c([u(2,m.IOptionsService),u(3,d.ICharSizeService),u(4,m.IDecorationService),u(5,m.IBufferService),u(6,d.ICoreBrowserService),u(7,d.IThemeService)],p)},9312:function(o,a,l){var c=this&&this.__decorate||function(x,C,A,M){var P,D=arguments.length,R=D<3?C:M===null?M=Object.getOwnPropertyDescriptor(C,A):M;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(x,C,A,M);else for(var G=x.length-1;G>=0;G--)(P=x[G])&&(R=(D<3?P(R):D>3?P(C,A,R):P(C,A))||R);return D>3&&R&&Object.defineProperty(C,A,R),R},u=this&&this.__param||function(x,C){return function(A,M){C(A,M,x)}};Object.defineProperty(a,"__esModule",{value:!0}),a.SelectionService=void 0;const h=l(9806),d=l(9504),f=l(456),g=l(4725),_=l(8460),m=l(844),p=l(6114),y=l(4841),b=l(511),v=l(2585),w=" ",E=new RegExp(w,"g");let S=a.SelectionService=class extends m.Disposable{constructor(x,C,A,M,P,D,R,G,ee){super(),this._element=x,this._screenElement=C,this._linkifier=A,this._bufferService=M,this._coreService=P,this._mouseService=D,this._optionsService=R,this._renderService=G,this._coreBrowserService=ee,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new b.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new _.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new _.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new _.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new _.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=q=>this._handleMouseMove(q),this._mouseUpListener=q=>this._handleMouseUp(q),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(q=>this._handleTrim(q)),this.register(this._bufferService.buffers.onBufferActivate(q=>this._handleBufferActivate(q))),this.enable(),this._model=new f.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,m.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const x=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;return!(!x||!C||x[0]===C[0]&&x[1]===C[1])}get selectionText(){const x=this._model.finalSelectionStart,C=this._model.finalSelectionEnd;if(!x||!C)return"";const A=this._bufferService.buffer,M=[];if(this._activeSelectionMode===3){if(x[0]===C[0])return"";const P=x[0]<C[0]?x[0]:C[0],D=x[0]<C[0]?C[0]:x[0];for(let R=x[1];R<=C[1];R++){const G=A.translateBufferLineToString(R,!0,P,D);M.push(G)}}else{const P=x[1]===C[1]?C[0]:void 0;M.push(A.translateBufferLineToString(x[1],!0,x[0],P));for(let D=x[1]+1;D<=C[1]-1;D++){const R=A.lines.get(D),G=A.translateBufferLineToString(D,!0);R?.isWrapped?M[M.length-1]+=G:M.push(G)}if(x[1]!==C[1]){const D=A.lines.get(C[1]),R=A.translateBufferLineToString(C[1],!0,0,C[0]);D&&D.isWrapped?M[M.length-1]+=R:M.push(R)}}return M.map(P=>P.replace(E," ")).join(p.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(x){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),p.isLinux&&x&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(x){const C=this._getMouseBufferCoords(x),A=this._model.finalSelectionStart,M=this._model.finalSelectionEnd;return!!(A&&M&&C)&&this._areCoordsInSelection(C,A,M)}isCellInSelection(x,C){const A=this._model.finalSelectionStart,M=this._model.finalSelectionEnd;return!(!A||!M)&&this._areCoordsInSelection([x,C],A,M)}_areCoordsInSelection(x,C,A){return x[1]>C[1]&&x[1]<A[1]||C[1]===A[1]&&x[1]===C[1]&&x[0]>=C[0]&&x[0]<A[0]||C[1]<A[1]&&x[1]===A[1]&&x[0]<A[0]||C[1]<A[1]&&x[1]===C[1]&&x[0]>=C[0]}_selectWordAtCursor(x,C){const A=this._linkifier.currentLink?.link?.range;if(A)return this._model.selectionStart=[A.start.x-1,A.start.y-1],this._model.selectionStartLength=(0,y.getRangeLength)(A,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const M=this._getMouseBufferCoords(x);return!!M&&(this._selectWordAt(M,C),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(x,C){this._model.clearSelection(),x=Math.max(x,0),C=Math.min(C,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,x],this._model.selectionEnd=[this._bufferService.cols,C],this.refresh(),this._onSelectionChange.fire()}_handleTrim(x){this._model.handleTrim(x)&&this.refresh()}_getMouseBufferCoords(x){const C=this._mouseService.getCoords(x,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(C)return C[0]--,C[1]--,C[1]+=this._bufferService.buffer.ydisp,C}_getMouseEventScrollAmount(x){let C=(0,h.getCoordsRelativeToElement)(this._coreBrowserService.window,x,this._screenElement)[1];const A=this._renderService.dimensions.css.canvas.height;return C>=0&&C<=A?0:(C>A&&(C-=A),C=Math.min(Math.max(C,-50),50),C/=50,C/Math.abs(C)+Math.round(14*C))}shouldForceSelection(x){return p.isMac?x.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:x.shiftKey}handleMouseDown(x){if(this._mouseDownTimeStamp=x.timeStamp,(x.button!==2||!this.hasSelection)&&x.button===0){if(!this._enabled){if(!this.shouldForceSelection(x))return;x.stopPropagation()}x.preventDefault(),this._dragScrollAmount=0,this._enabled&&x.shiftKey?this._handleIncrementalClick(x):x.detail===1?this._handleSingleClick(x):x.detail===2?this._handleDoubleClick(x):x.detail===3&&this._handleTripleClick(x),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(x){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(x))}_handleSingleClick(x){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(x)?3:0,this._model.selectionStart=this._getMouseBufferCoords(x),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const C=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);C&&C.length!==this._model.selectionStart[0]&&C.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(x){this._selectWordAtCursor(x,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(x){const C=this._getMouseBufferCoords(x);C&&(this._activeSelectionMode=2,this._selectLineAt(C[1]))}shouldColumnSelect(x){return x.altKey&&!(p.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(x){if(x.stopImmediatePropagation(),!this._model.selectionStart)return;const C=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(x),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(x),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const A=this._bufferService.buffer;if(this._model.selectionEnd[1]<A.lines.length){const M=A.lines.get(this._model.selectionEnd[1]);M&&M.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}C&&C[0]===this._model.selectionEnd[0]&&C[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const x=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(x.ydisp+this._bufferService.rows,x.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=x.ydisp),this.refresh()}}_handleMouseUp(x){const C=x.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&C<500&&x.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const A=this._mouseService.getCoords(x,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(A&&A[0]!==void 0&&A[1]!==void 0){const M=(0,d.moveToCellSequence)(A[0]-1,A[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(M,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const x=this._model.finalSelectionStart,C=this._model.finalSelectionEnd,A=!(!x||!C||x[0]===C[0]&&x[1]===C[1]);A?x&&C&&(this._oldSelectionStart&&this._oldSelectionEnd&&x[0]===this._oldSelectionStart[0]&&x[1]===this._oldSelectionStart[1]&&C[0]===this._oldSelectionEnd[0]&&C[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(x,C,A)):this._oldHasSelection&&this._fireOnSelectionChange(x,C,A)}_fireOnSelectionChange(x,C,A){this._oldSelectionStart=x,this._oldSelectionEnd=C,this._oldHasSelection=A,this._onSelectionChange.fire()}_handleBufferActivate(x){this.clearSelection(),this._trimListener.dispose(),this._trimListener=x.activeBuffer.lines.onTrim(C=>this._handleTrim(C))}_convertViewportColToCharacterIndex(x,C){let A=C;for(let M=0;C>=M;M++){const P=x.loadCell(M,this._workCell).getChars().length;this._workCell.getWidth()===0?A--:P>1&&C!==M&&(A+=P-1)}return A}setSelection(x,C,A){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[x,C],this._model.selectionStartLength=A,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(x){this._isClickInSelection(x)||(this._selectWordAtCursor(x,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(x,C,A=!0,M=!0){if(x[0]>=this._bufferService.cols)return;const P=this._bufferService.buffer,D=P.lines.get(x[1]);if(!D)return;const R=P.translateBufferLineToString(x[1],!1);let G=this._convertViewportColToCharacterIndex(D,x[0]),ee=G;const q=x[0]-G;let re=0,N=0,B=0,$=0;if(R.charAt(G)===" "){for(;G>0&&R.charAt(G-1)===" ";)G--;for(;ee<R.length&&R.charAt(ee+1)===" ";)ee++}else{let Q=x[0],ne=x[0];D.getWidth(Q)===0&&(re++,Q--),D.getWidth(ne)===2&&(N++,ne++);const ge=D.getString(ne).length;for(ge>1&&($+=ge-1,ee+=ge-1);Q>0&&G>0&&!this._isCharWordSeparator(D.loadCell(Q-1,this._workCell));){D.loadCell(Q-1,this._workCell);const J=this._workCell.getChars().length;this._workCell.getWidth()===0?(re++,Q--):J>1&&(B+=J-1,G-=J-1),G--,Q--}for(;ne<D.length&&ee+1<R.length&&!this._isCharWordSeparator(D.loadCell(ne+1,this._workCell));){D.loadCell(ne+1,this._workCell);const J=this._workCell.getChars().length;this._workCell.getWidth()===2?(N++,ne++):J>1&&($+=J-1,ee+=J-1),ee++,ne++}}ee++;let H=G+q-re+B,U=Math.min(this._bufferService.cols,ee-G+re+N-B-$);if(C||R.slice(G,ee).trim()!==""){if(A&&H===0&&D.getCodePoint(0)!==32){const Q=P.lines.get(x[1]-1);if(Q&&D.isWrapped&&Q.getCodePoint(this._bufferService.cols-1)!==32){const ne=this._getWordAt([this._bufferService.cols-1,x[1]-1],!1,!0,!1);if(ne){const ge=this._bufferService.cols-ne.start;H-=ge,U+=ge}}}if(M&&H+U===this._bufferService.cols&&D.getCodePoint(this._bufferService.cols-1)!==32){const Q=P.lines.get(x[1]+1);if(Q?.isWrapped&&Q.getCodePoint(0)!==32){const ne=this._getWordAt([0,x[1]+1],!1,!1,!0);ne&&(U+=ne.length)}}return{start:H,length:U}}}_selectWordAt(x,C){const A=this._getWordAt(x,C);if(A){for(;A.start<0;)A.start+=this._bufferService.cols,x[1]--;this._model.selectionStart=[A.start,x[1]],this._model.selectionStartLength=A.length}}_selectToWordAt(x){const C=this._getWordAt(x,!0);if(C){let A=x[1];for(;C.start<0;)C.start+=this._bufferService.cols,A--;if(!this._model.areSelectionValuesReversed())for(;C.start+C.length>this._bufferService.cols;)C.length-=this._bufferService.cols,A++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?C.start:C.start+C.length,A]}}_isCharWordSeparator(x){return x.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(x.getChars())>=0}_selectLineAt(x){const C=this._bufferService.buffer.getWrappedRangeForLine(x),A={start:{x:0,y:C.first},end:{x:this._bufferService.cols-1,y:C.last}};this._model.selectionStart=[0,C.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,y.getRangeLength)(A,this._bufferService.cols)}};a.SelectionService=S=c([u(3,v.IBufferService),u(4,v.ICoreService),u(5,g.IMouseService),u(6,v.IOptionsService),u(7,g.IRenderService),u(8,g.ICoreBrowserService)],S)},4725:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ILinkProviderService=a.IThemeService=a.ICharacterJoinerService=a.ISelectionService=a.IRenderService=a.IMouseService=a.ICoreBrowserService=a.ICharSizeService=void 0;const c=l(8343);a.ICharSizeService=(0,c.createDecorator)("CharSizeService"),a.ICoreBrowserService=(0,c.createDecorator)("CoreBrowserService"),a.IMouseService=(0,c.createDecorator)("MouseService"),a.IRenderService=(0,c.createDecorator)("RenderService"),a.ISelectionService=(0,c.createDecorator)("SelectionService"),a.ICharacterJoinerService=(0,c.createDecorator)("CharacterJoinerService"),a.IThemeService=(0,c.createDecorator)("ThemeService"),a.ILinkProviderService=(0,c.createDecorator)("LinkProviderService")},6731:function(o,a,l){var c=this&&this.__decorate||function(S,x,C,A){var M,P=arguments.length,D=P<3?x:A===null?A=Object.getOwnPropertyDescriptor(x,C):A;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")D=Reflect.decorate(S,x,C,A);else for(var R=S.length-1;R>=0;R--)(M=S[R])&&(D=(P<3?M(D):P>3?M(x,C,D):M(x,C))||D);return P>3&&D&&Object.defineProperty(x,C,D),D},u=this&&this.__param||function(S,x){return function(C,A){x(C,A,S)}};Object.defineProperty(a,"__esModule",{value:!0}),a.ThemeService=a.DEFAULT_ANSI_COLORS=void 0;const h=l(7239),d=l(8055),f=l(8460),g=l(844),_=l(2585),m=d.css.toColor("#ffffff"),p=d.css.toColor("#000000"),y=d.css.toColor("#ffffff"),b=d.css.toColor("#000000"),v={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};a.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const S=[d.css.toColor("#2e3436"),d.css.toColor("#cc0000"),d.css.toColor("#4e9a06"),d.css.toColor("#c4a000"),d.css.toColor("#3465a4"),d.css.toColor("#75507b"),d.css.toColor("#06989a"),d.css.toColor("#d3d7cf"),d.css.toColor("#555753"),d.css.toColor("#ef2929"),d.css.toColor("#8ae234"),d.css.toColor("#fce94f"),d.css.toColor("#729fcf"),d.css.toColor("#ad7fa8"),d.css.toColor("#34e2e2"),d.css.toColor("#eeeeec")],x=[0,95,135,175,215,255];for(let C=0;C<216;C++){const A=x[C/36%6|0],M=x[C/6%6|0],P=x[C%6];S.push({css:d.channels.toCss(A,M,P),rgba:d.channels.toRgba(A,M,P)})}for(let C=0;C<24;C++){const A=8+10*C;S.push({css:d.channels.toCss(A,A,A),rgba:d.channels.toRgba(A,A,A)})}return S})());let w=a.ThemeService=class extends g.Disposable{get colors(){return this._colors}constructor(S){super(),this._optionsService=S,this._contrastCache=new h.ColorContrastCache,this._halfContrastCache=new h.ColorContrastCache,this._onChangeColors=this.register(new f.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:m,background:p,cursor:y,cursorAccent:b,selectionForeground:void 0,selectionBackgroundTransparent:v,selectionBackgroundOpaque:d.color.blend(p,v),selectionInactiveBackgroundTransparent:v,selectionInactiveBackgroundOpaque:d.color.blend(p,v),ansi:a.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(S={}){const x=this._colors;if(x.foreground=E(S.foreground,m),x.background=E(S.background,p),x.cursor=E(S.cursor,y),x.cursorAccent=E(S.cursorAccent,b),x.selectionBackgroundTransparent=E(S.selectionBackground,v),x.selectionBackgroundOpaque=d.color.blend(x.background,x.selectionBackgroundTransparent),x.selectionInactiveBackgroundTransparent=E(S.selectionInactiveBackground,x.selectionBackgroundTransparent),x.selectionInactiveBackgroundOpaque=d.color.blend(x.background,x.selectionInactiveBackgroundTransparent),x.selectionForeground=S.selectionForeground?E(S.selectionForeground,d.NULL_COLOR):void 0,x.selectionForeground===d.NULL_COLOR&&(x.selectionForeground=void 0),d.color.isOpaque(x.selectionBackgroundTransparent)&&(x.selectionBackgroundTransparent=d.color.opacity(x.selectionBackgroundTransparent,.3)),d.color.isOpaque(x.selectionInactiveBackgroundTransparent)&&(x.selectionInactiveBackgroundTransparent=d.color.opacity(x.selectionInactiveBackgroundTransparent,.3)),x.ansi=a.DEFAULT_ANSI_COLORS.slice(),x.ansi[0]=E(S.black,a.DEFAULT_ANSI_COLORS[0]),x.ansi[1]=E(S.red,a.DEFAULT_ANSI_COLORS[1]),x.ansi[2]=E(S.green,a.DEFAULT_ANSI_COLORS[2]),x.ansi[3]=E(S.yellow,a.DEFAULT_ANSI_COLORS[3]),x.ansi[4]=E(S.blue,a.DEFAULT_ANSI_COLORS[4]),x.ansi[5]=E(S.magenta,a.DEFAULT_ANSI_COLORS[5]),x.ansi[6]=E(S.cyan,a.DEFAULT_ANSI_COLORS[6]),x.ansi[7]=E(S.white,a.DEFAULT_ANSI_COLORS[7]),x.ansi[8]=E(S.brightBlack,a.DEFAULT_ANSI_COLORS[8]),x.ansi[9]=E(S.brightRed,a.DEFAULT_ANSI_COLORS[9]),x.ansi[10]=E(S.brightGreen,a.DEFAULT_ANSI_COLORS[10]),x.ansi[11]=E(S.brightYellow,a.DEFAULT_ANSI_COLORS[11]),x.ansi[12]=E(S.brightBlue,a.DEFAULT_ANSI_COLORS[12]),x.ansi[13]=E(S.brightMagenta,a.DEFAULT_ANSI_COLORS[13]),x.ansi[14]=E(S.brightCyan,a.DEFAULT_ANSI_COLORS[14]),x.ansi[15]=E(S.brightWhite,a.DEFAULT_ANSI_COLORS[15]),S.extendedAnsi){const C=Math.min(x.ansi.length-16,S.extendedAnsi.length);for(let A=0;A<C;A++)x.ansi[A+16]=E(S.extendedAnsi[A],a.DEFAULT_ANSI_COLORS[A+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(S){this._restoreColor(S),this._onChangeColors.fire(this.colors)}_restoreColor(S){if(S!==void 0)switch(S){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[S]=this._restoreColors.ansi[S]}else for(let x=0;x<this._restoreColors.ansi.length;++x)this._colors.ansi[x]=this._restoreColors.ansi[x]}modifyColors(S){S(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function E(S,x){if(S!==void 0)try{return d.css.toColor(S)}catch{}return x}a.ThemeService=w=c([u(0,_.IOptionsService)],w)},6349:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CircularList=void 0;const c=l(8460),u=l(844);class h extends u.Disposable{constructor(f){super(),this._maxLength=f,this.onDeleteEmitter=this.register(new c.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new c.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new c.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(f){if(this._maxLength===f)return;const g=new Array(f);for(let _=0;_<Math.min(f,this.length);_++)g[_]=this._array[this._getCyclicIndex(_)];this._array=g,this._maxLength=f,this._startIndex=0}get length(){return this._length}set length(f){if(f>this._length)for(let g=this._length;g<f;g++)this._array[g]=void 0;this._length=f}get(f){return this._array[this._getCyclicIndex(f)]}set(f,g){this._array[this._getCyclicIndex(f)]=g}push(f){this._array[this._getCyclicIndex(this._length)]=f,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(f,g,..._){if(g){for(let m=f;m<this._length-g;m++)this._array[this._getCyclicIndex(m)]=this._array[this._getCyclicIndex(m+g)];this._length-=g,this.onDeleteEmitter.fire({index:f,amount:g})}for(let m=this._length-1;m>=f;m--)this._array[this._getCyclicIndex(m+_.length)]=this._array[this._getCyclicIndex(m)];for(let m=0;m<_.length;m++)this._array[this._getCyclicIndex(f+m)]=_[m];if(_.length&&this.onInsertEmitter.fire({index:f,amount:_.length}),this._length+_.length>this._maxLength){const m=this._length+_.length-this._maxLength;this._startIndex+=m,this._length=this._maxLength,this.onTrimEmitter.fire(m)}else this._length+=_.length}trimStart(f){f>this._length&&(f=this._length),this._startIndex+=f,this._length-=f,this.onTrimEmitter.fire(f)}shiftElements(f,g,_){if(!(g<=0)){if(f<0||f>=this._length)throw new Error("start argument out of range");if(f+_<0)throw new Error("Cannot shift elements in list beyond index 0");if(_>0){for(let p=g-1;p>=0;p--)this.set(f+p+_,this.get(f+p));const m=f+g+_-this._length;if(m>0)for(this._length+=m;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let m=0;m<g;m++)this.set(f+m+_,this.get(f+m))}}_getCyclicIndex(f){return(this._startIndex+f)%this._maxLength}}a.CircularList=h},1439:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.clone=void 0,a.clone=function l(c,u=5){if(typeof c!="object")return c;const h=Array.isArray(c)?[]:{};for(const d in c)h[d]=u<=1?c[d]:c[d]&&l(c[d],u-1);return h}},8055:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.contrastRatio=a.toPaddedHex=a.rgba=a.rgb=a.css=a.color=a.channels=a.NULL_COLOR=void 0;let l=0,c=0,u=0,h=0;var d,f,g,_,m;function p(b){const v=b.toString(16);return v.length<2?"0"+v:v}function y(b,v){return b<v?(v+.05)/(b+.05):(b+.05)/(v+.05)}a.NULL_COLOR={css:"#00000000",rgba:0},function(b){b.toCss=function(v,w,E,S){return S!==void 0?`#${p(v)}${p(w)}${p(E)}${p(S)}`:`#${p(v)}${p(w)}${p(E)}`},b.toRgba=function(v,w,E,S=255){return(v<<24|w<<16|E<<8|S)>>>0},b.toColor=function(v,w,E,S){return{css:b.toCss(v,w,E,S),rgba:b.toRgba(v,w,E,S)}}}(d||(a.channels=d={})),function(b){function v(w,E){return h=Math.round(255*E),[l,c,u]=m.toChannels(w.rgba),{css:d.toCss(l,c,u,h),rgba:d.toRgba(l,c,u,h)}}b.blend=function(w,E){if(h=(255&E.rgba)/255,h===1)return{css:E.css,rgba:E.rgba};const S=E.rgba>>24&255,x=E.rgba>>16&255,C=E.rgba>>8&255,A=w.rgba>>24&255,M=w.rgba>>16&255,P=w.rgba>>8&255;return l=A+Math.round((S-A)*h),c=M+Math.round((x-M)*h),u=P+Math.round((C-P)*h),{css:d.toCss(l,c,u),rgba:d.toRgba(l,c,u)}},b.isOpaque=function(w){return(255&w.rgba)==255},b.ensureContrastRatio=function(w,E,S){const x=m.ensureContrastRatio(w.rgba,E.rgba,S);if(x)return d.toColor(x>>24&255,x>>16&255,x>>8&255)},b.opaque=function(w){const E=(255|w.rgba)>>>0;return[l,c,u]=m.toChannels(E),{css:d.toCss(l,c,u),rgba:E}},b.opacity=v,b.multiplyOpacity=function(w,E){return h=255&w.rgba,v(w,h*E/255)},b.toColorRGB=function(w){return[w.rgba>>24&255,w.rgba>>16&255,w.rgba>>8&255]}}(f||(a.color=f={})),function(b){let v,w;try{const E=document.createElement("canvas");E.width=1,E.height=1;const S=E.getContext("2d",{willReadFrequently:!0});S&&(v=S,v.globalCompositeOperation="copy",w=v.createLinearGradient(0,0,1,1))}catch{}b.toColor=function(E){if(E.match(/#[\da-f]{3,8}/i))switch(E.length){case 4:return l=parseInt(E.slice(1,2).repeat(2),16),c=parseInt(E.slice(2,3).repeat(2),16),u=parseInt(E.slice(3,4).repeat(2),16),d.toColor(l,c,u);case 5:return l=parseInt(E.slice(1,2).repeat(2),16),c=parseInt(E.slice(2,3).repeat(2),16),u=parseInt(E.slice(3,4).repeat(2),16),h=parseInt(E.slice(4,5).repeat(2),16),d.toColor(l,c,u,h);case 7:return{css:E,rgba:(parseInt(E.slice(1),16)<<8|255)>>>0};case 9:return{css:E,rgba:parseInt(E.slice(1),16)>>>0}}const S=E.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(S)return l=parseInt(S[1]),c=parseInt(S[2]),u=parseInt(S[3]),h=Math.round(255*(S[5]===void 0?1:parseFloat(S[5]))),d.toColor(l,c,u,h);if(!v||!w)throw new Error("css.toColor: Unsupported css format");if(v.fillStyle=w,v.fillStyle=E,typeof v.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(v.fillRect(0,0,1,1),[l,c,u,h]=v.getImageData(0,0,1,1).data,h!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:d.toRgba(l,c,u,h),css:E}}}(g||(a.css=g={})),function(b){function v(w,E,S){const x=w/255,C=E/255,A=S/255;return .2126*(x<=.03928?x/12.92:Math.pow((x+.055)/1.055,2.4))+.7152*(C<=.03928?C/12.92:Math.pow((C+.055)/1.055,2.4))+.0722*(A<=.03928?A/12.92:Math.pow((A+.055)/1.055,2.4))}b.relativeLuminance=function(w){return v(w>>16&255,w>>8&255,255&w)},b.relativeLuminance2=v}(_||(a.rgb=_={})),function(b){function v(E,S,x){const C=E>>24&255,A=E>>16&255,M=E>>8&255;let P=S>>24&255,D=S>>16&255,R=S>>8&255,G=y(_.relativeLuminance2(P,D,R),_.relativeLuminance2(C,A,M));for(;G<x&&(P>0||D>0||R>0);)P-=Math.max(0,Math.ceil(.1*P)),D-=Math.max(0,Math.ceil(.1*D)),R-=Math.max(0,Math.ceil(.1*R)),G=y(_.relativeLuminance2(P,D,R),_.relativeLuminance2(C,A,M));return(P<<24|D<<16|R<<8|255)>>>0}function w(E,S,x){const C=E>>24&255,A=E>>16&255,M=E>>8&255;let P=S>>24&255,D=S>>16&255,R=S>>8&255,G=y(_.relativeLuminance2(P,D,R),_.relativeLuminance2(C,A,M));for(;G<x&&(P<255||D<255||R<255);)P=Math.min(255,P+Math.ceil(.1*(255-P))),D=Math.min(255,D+Math.ceil(.1*(255-D))),R=Math.min(255,R+Math.ceil(.1*(255-R))),G=y(_.relativeLuminance2(P,D,R),_.relativeLuminance2(C,A,M));return(P<<24|D<<16|R<<8|255)>>>0}b.blend=function(E,S){if(h=(255&S)/255,h===1)return S;const x=S>>24&255,C=S>>16&255,A=S>>8&255,M=E>>24&255,P=E>>16&255,D=E>>8&255;return l=M+Math.round((x-M)*h),c=P+Math.round((C-P)*h),u=D+Math.round((A-D)*h),d.toRgba(l,c,u)},b.ensureContrastRatio=function(E,S,x){const C=_.relativeLuminance(E>>8),A=_.relativeLuminance(S>>8);if(y(C,A)<x){if(A<C){const D=v(E,S,x),R=y(C,_.relativeLuminance(D>>8));if(R<x){const G=w(E,S,x);return R>y(C,_.relativeLuminance(G>>8))?D:G}return D}const M=w(E,S,x),P=y(C,_.relativeLuminance(M>>8));if(P<x){const D=v(E,S,x);return P>y(C,_.relativeLuminance(D>>8))?M:D}return M}},b.reduceLuminance=v,b.increaseLuminance=w,b.toChannels=function(E){return[E>>24&255,E>>16&255,E>>8&255,255&E]}}(m||(a.rgba=m={})),a.toPaddedHex=p,a.contrastRatio=y},8969:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CoreTerminal=void 0;const c=l(844),u=l(2585),h=l(4348),d=l(7866),f=l(744),g=l(7302),_=l(6975),m=l(8460),p=l(1753),y=l(1480),b=l(7994),v=l(9282),w=l(5435),E=l(5981),S=l(2660);let x=!1;class C extends c.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new m.EventEmitter),this._onScroll.event(M=>{this._onScrollApi?.fire(M.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(M){for(const P in M)this.optionsService.options[P]=M[P]}constructor(M){super(),this._windowsWrappingHeuristics=this.register(new c.MutableDisposable),this._onBinary=this.register(new m.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new m.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new m.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new m.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new m.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new m.EventEmitter),this._instantiationService=new h.InstantiationService,this.optionsService=this.register(new g.OptionsService(M)),this._instantiationService.setService(u.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(f.BufferService)),this._instantiationService.setService(u.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(d.LogService)),this._instantiationService.setService(u.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(_.CoreService)),this._instantiationService.setService(u.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(p.CoreMouseService)),this._instantiationService.setService(u.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(y.UnicodeService)),this._instantiationService.setService(u.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(b.CharsetService),this._instantiationService.setService(u.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(S.OscLinkService),this._instantiationService.setService(u.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new w.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,m.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,m.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,m.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,m.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(P=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(P=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new E.WriteBuffer((P,D)=>this._inputHandler.parse(P,D))),this.register((0,m.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(M,P){this._writeBuffer.write(M,P)}writeSync(M,P){this._logService.logLevel<=u.LogLevelEnum.WARN&&!x&&(this._logService.warn("writeSync is unreliable and will be removed soon."),x=!0),this._writeBuffer.writeSync(M,P)}input(M,P=!0){this.coreService.triggerDataEvent(M,P)}resize(M,P){isNaN(M)||isNaN(P)||(M=Math.max(M,f.MINIMUM_COLS),P=Math.max(P,f.MINIMUM_ROWS),this._bufferService.resize(M,P))}scroll(M,P=!1){this._bufferService.scroll(M,P)}scrollLines(M,P,D){this._bufferService.scrollLines(M,P,D)}scrollPages(M){this.scrollLines(M*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(M){const P=M-this._bufferService.buffer.ydisp;P!==0&&this.scrollLines(P)}registerEscHandler(M,P){return this._inputHandler.registerEscHandler(M,P)}registerDcsHandler(M,P){return this._inputHandler.registerDcsHandler(M,P)}registerCsiHandler(M,P){return this._inputHandler.registerCsiHandler(M,P)}registerOscHandler(M,P){return this._inputHandler.registerOscHandler(M,P)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let M=!1;const P=this.optionsService.rawOptions.windowsPty;P&&P.buildNumber!==void 0&&P.buildNumber!==void 0?M=P.backend==="conpty"&&P.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(M=!0),M?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const M=[];M.push(this.onLineFeed(v.updateWindowsModeWrappedState.bind(null,this._bufferService))),M.push(this.registerCsiHandler({final:"H"},()=>((0,v.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,c.toDisposable)(()=>{for(const P of M)P.dispose()})}}}a.CoreTerminal=C},8460:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.runAndSubscribe=a.forwardEvent=a.EventEmitter=void 0,a.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=l=>(this._listeners.push(l),{dispose:()=>{if(!this._disposed){for(let c=0;c<this._listeners.length;c++)if(this._listeners[c]===l)return void this._listeners.splice(c,1)}}})),this._event}fire(l,c){const u=[];for(let h=0;h<this._listeners.length;h++)u.push(this._listeners[h]);for(let h=0;h<u.length;h++)u[h].call(void 0,l,c)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},a.forwardEvent=function(l,c){return l(u=>c.fire(u))},a.runAndSubscribe=function(l,c){return c(void 0),l(u=>c(u))}},5435:function(o,a,l){var c=this&&this.__decorate||function(re,N,B,$){var H,U=arguments.length,Q=U<3?N:$===null?$=Object.getOwnPropertyDescriptor(N,B):$;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Q=Reflect.decorate(re,N,B,$);else for(var ne=re.length-1;ne>=0;ne--)(H=re[ne])&&(Q=(U<3?H(Q):U>3?H(N,B,Q):H(N,B))||Q);return U>3&&Q&&Object.defineProperty(N,B,Q),Q},u=this&&this.__param||function(re,N){return function(B,$){N(B,$,re)}};Object.defineProperty(a,"__esModule",{value:!0}),a.InputHandler=a.WindowsOptionsReportType=void 0;const h=l(2584),d=l(7116),f=l(2015),g=l(844),_=l(482),m=l(8437),p=l(8460),y=l(643),b=l(511),v=l(3734),w=l(2585),E=l(1480),S=l(6242),x=l(6351),C=l(5941),A={"(":0,")":1,"*":2,"+":3,"-":1,".":2},M=131072;function P(re,N){if(re>24)return N.setWinLines||!1;switch(re){case 1:return!!N.restoreWin;case 2:return!!N.minimizeWin;case 3:return!!N.setWinPosition;case 4:return!!N.setWinSizePixels;case 5:return!!N.raiseWin;case 6:return!!N.lowerWin;case 7:return!!N.refreshWin;case 8:return!!N.setWinSizeChars;case 9:return!!N.maximizeWin;case 10:return!!N.fullscreenWin;case 11:return!!N.getWinState;case 13:return!!N.getWinPosition;case 14:return!!N.getWinSizePixels;case 15:return!!N.getScreenSizePixels;case 16:return!!N.getCellSizePixels;case 18:return!!N.getWinSizeChars;case 19:return!!N.getScreenSizeChars;case 20:return!!N.getIconTitle;case 21:return!!N.getWinTitle;case 22:return!!N.pushTitle;case 23:return!!N.popTitle;case 24:return!!N.setWinLines}return!1}var D;(function(re){re[re.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",re[re.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(D||(a.WindowsOptionsReportType=D={}));let R=0;class G extends g.Disposable{getAttrData(){return this._curAttrData}constructor(N,B,$,H,U,Q,ne,ge,J=new f.EscapeSequenceParser){super(),this._bufferService=N,this._charsetService=B,this._coreService=$,this._logService=H,this._optionsService=U,this._oscLinkService=Q,this._coreMouseService=ne,this._unicodeService=ge,this._parser=J,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new _.StringToUtf32,this._utf8Decoder=new _.Utf8ToUtf32,this._workCell=new b.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=m.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=m.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new p.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new p.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new p.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new p.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new p.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new p.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new p.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new p.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new p.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new p.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new p.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new p.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new p.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new ee(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(V=>this._activeBuffer=V.activeBuffer)),this._parser.setCsiHandlerFallback((V,fe)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(V),params:fe.toArray()})}),this._parser.setEscHandlerFallback(V=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(V)})}),this._parser.setExecuteHandlerFallback(V=>{this._logService.debug("Unknown EXECUTE code: ",{code:V})}),this._parser.setOscHandlerFallback((V,fe,de)=>{this._logService.debug("Unknown OSC code: ",{identifier:V,action:fe,data:de})}),this._parser.setDcsHandlerFallback((V,fe,de)=>{fe==="HOOK"&&(de=de.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(V),action:fe,payload:de})}),this._parser.setPrintHandler((V,fe,de)=>this.print(V,fe,de)),this._parser.registerCsiHandler({final:"@"},V=>this.insertChars(V)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},V=>this.scrollLeft(V)),this._parser.registerCsiHandler({final:"A"},V=>this.cursorUp(V)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},V=>this.scrollRight(V)),this._parser.registerCsiHandler({final:"B"},V=>this.cursorDown(V)),this._parser.registerCsiHandler({final:"C"},V=>this.cursorForward(V)),this._parser.registerCsiHandler({final:"D"},V=>this.cursorBackward(V)),this._parser.registerCsiHandler({final:"E"},V=>this.cursorNextLine(V)),this._parser.registerCsiHandler({final:"F"},V=>this.cursorPrecedingLine(V)),this._parser.registerCsiHandler({final:"G"},V=>this.cursorCharAbsolute(V)),this._parser.registerCsiHandler({final:"H"},V=>this.cursorPosition(V)),this._parser.registerCsiHandler({final:"I"},V=>this.cursorForwardTab(V)),this._parser.registerCsiHandler({final:"J"},V=>this.eraseInDisplay(V,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},V=>this.eraseInDisplay(V,!0)),this._parser.registerCsiHandler({final:"K"},V=>this.eraseInLine(V,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},V=>this.eraseInLine(V,!0)),this._parser.registerCsiHandler({final:"L"},V=>this.insertLines(V)),this._parser.registerCsiHandler({final:"M"},V=>this.deleteLines(V)),this._parser.registerCsiHandler({final:"P"},V=>this.deleteChars(V)),this._parser.registerCsiHandler({final:"S"},V=>this.scrollUp(V)),this._parser.registerCsiHandler({final:"T"},V=>this.scrollDown(V)),this._parser.registerCsiHandler({final:"X"},V=>this.eraseChars(V)),this._parser.registerCsiHandler({final:"Z"},V=>this.cursorBackwardTab(V)),this._parser.registerCsiHandler({final:"`"},V=>this.charPosAbsolute(V)),this._parser.registerCsiHandler({final:"a"},V=>this.hPositionRelative(V)),this._parser.registerCsiHandler({final:"b"},V=>this.repeatPrecedingCharacter(V)),this._parser.registerCsiHandler({final:"c"},V=>this.sendDeviceAttributesPrimary(V)),this._parser.registerCsiHandler({prefix:">",final:"c"},V=>this.sendDeviceAttributesSecondary(V)),this._parser.registerCsiHandler({final:"d"},V=>this.linePosAbsolute(V)),this._parser.registerCsiHandler({final:"e"},V=>this.vPositionRelative(V)),this._parser.registerCsiHandler({final:"f"},V=>this.hVPosition(V)),this._parser.registerCsiHandler({final:"g"},V=>this.tabClear(V)),this._parser.registerCsiHandler({final:"h"},V=>this.setMode(V)),this._parser.registerCsiHandler({prefix:"?",final:"h"},V=>this.setModePrivate(V)),this._parser.registerCsiHandler({final:"l"},V=>this.resetMode(V)),this._parser.registerCsiHandler({prefix:"?",final:"l"},V=>this.resetModePrivate(V)),this._parser.registerCsiHandler({final:"m"},V=>this.charAttributes(V)),this._parser.registerCsiHandler({final:"n"},V=>this.deviceStatus(V)),this._parser.registerCsiHandler({prefix:"?",final:"n"},V=>this.deviceStatusPrivate(V)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},V=>this.softReset(V)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},V=>this.setCursorStyle(V)),this._parser.registerCsiHandler({final:"r"},V=>this.setScrollRegion(V)),this._parser.registerCsiHandler({final:"s"},V=>this.saveCursor(V)),this._parser.registerCsiHandler({final:"t"},V=>this.windowOptions(V)),this._parser.registerCsiHandler({final:"u"},V=>this.restoreCursor(V)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},V=>this.insertColumns(V)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},V=>this.deleteColumns(V)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},V=>this.selectProtected(V)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},V=>this.requestMode(V,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},V=>this.requestMode(V,!1)),this._parser.setExecuteHandler(h.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(h.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(h.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(h.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(h.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(h.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(h.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(h.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(h.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(h.C1.IND,()=>this.index()),this._parser.setExecuteHandler(h.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(h.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new S.OscHandler(V=>(this.setTitle(V),this.setIconName(V),!0))),this._parser.registerOscHandler(1,new S.OscHandler(V=>this.setIconName(V))),this._parser.registerOscHandler(2,new S.OscHandler(V=>this.setTitle(V))),this._parser.registerOscHandler(4,new S.OscHandler(V=>this.setOrReportIndexedColor(V))),this._parser.registerOscHandler(8,new S.OscHandler(V=>this.setHyperlink(V))),this._parser.registerOscHandler(10,new S.OscHandler(V=>this.setOrReportFgColor(V))),this._parser.registerOscHandler(11,new S.OscHandler(V=>this.setOrReportBgColor(V))),this._parser.registerOscHandler(12,new S.OscHandler(V=>this.setOrReportCursorColor(V))),this._parser.registerOscHandler(104,new S.OscHandler(V=>this.restoreIndexedColor(V))),this._parser.registerOscHandler(110,new S.OscHandler(V=>this.restoreFgColor(V))),this._parser.registerOscHandler(111,new S.OscHandler(V=>this.restoreBgColor(V))),this._parser.registerOscHandler(112,new S.OscHandler(V=>this.restoreCursorColor(V))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const V in d.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:V},()=>this.selectCharset("("+V)),this._parser.registerEscHandler({intermediates:")",final:V},()=>this.selectCharset(")"+V)),this._parser.registerEscHandler({intermediates:"*",final:V},()=>this.selectCharset("*"+V)),this._parser.registerEscHandler({intermediates:"+",final:V},()=>this.selectCharset("+"+V)),this._parser.registerEscHandler({intermediates:"-",final:V},()=>this.selectCharset("-"+V)),this._parser.registerEscHandler({intermediates:".",final:V},()=>this.selectCharset("."+V)),this._parser.registerEscHandler({intermediates:"/",final:V},()=>this.selectCharset("/"+V));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(V=>(this._logService.error("Parsing error: ",V),V)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new x.DcsHandler((V,fe)=>this.requestStatusString(V,fe)))}_preserveStack(N,B,$,H){this._parseStack.paused=!0,this._parseStack.cursorStartX=N,this._parseStack.cursorStartY=B,this._parseStack.decodedLength=$,this._parseStack.position=H}_logSlowResolvingAsync(N){this._logService.logLevel<=w.LogLevelEnum.WARN&&Promise.race([N,new Promise((B,$)=>setTimeout(()=>$("#SLOW_TIMEOUT"),5e3))]).catch(B=>{if(B!=="#SLOW_TIMEOUT")throw B;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(N,B){let $,H=this._activeBuffer.x,U=this._activeBuffer.y,Q=0;const ne=this._parseStack.paused;if(ne){if($=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,B))return this._logSlowResolvingAsync($),$;H=this._parseStack.cursorStartX,U=this._parseStack.cursorStartY,this._parseStack.paused=!1,N.length>M&&(Q=this._parseStack.position+M)}if(this._logService.logLevel<=w.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof N=="string"?` "${N}"`:` "${Array.prototype.map.call(N,V=>String.fromCharCode(V)).join("")}"`),typeof N=="string"?N.split("").map(V=>V.charCodeAt(0)):N),this._parseBuffer.length<N.length&&this._parseBuffer.length<M&&(this._parseBuffer=new Uint32Array(Math.min(N.length,M))),ne||this._dirtyRowTracker.clearRange(),N.length>M)for(let V=Q;V<N.length;V+=M){const fe=V+M<N.length?V+M:N.length,de=typeof N=="string"?this._stringDecoder.decode(N.substring(V,fe),this._parseBuffer):this._utf8Decoder.decode(N.subarray(V,fe),this._parseBuffer);if($=this._parser.parse(this._parseBuffer,de))return this._preserveStack(H,U,de,V),this._logSlowResolvingAsync($),$}else if(!ne){const V=typeof N=="string"?this._stringDecoder.decode(N,this._parseBuffer):this._utf8Decoder.decode(N,this._parseBuffer);if($=this._parser.parse(this._parseBuffer,V))return this._preserveStack(H,U,V,0),this._logSlowResolvingAsync($),$}this._activeBuffer.x===H&&this._activeBuffer.y===U||this._onCursorMove.fire();const ge=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),J=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);J<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(J,this._bufferService.rows-1),Math.min(ge,this._bufferService.rows-1))}print(N,B,$){let H,U;const Q=this._charsetService.charset,ne=this._optionsService.rawOptions.screenReaderMode,ge=this._bufferService.cols,J=this._coreService.decPrivateModes.wraparound,V=this._coreService.modes.insertMode,fe=this._curAttrData;let de=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&$-B>0&&de.getWidth(this._activeBuffer.x-1)===2&&de.setCellFromCodepoint(this._activeBuffer.x-1,0,1,fe);let be=this._parser.precedingJoinState;for(let me=B;me<$;++me){if(H=N[me],H<127&&Q){const ie=Q[String.fromCharCode(H)];ie&&(H=ie.charCodeAt(0))}const ve=this._unicodeService.charProperties(H,be);U=E.UnicodeService.extractWidth(ve);const L=E.UnicodeService.extractShouldJoin(ve),oe=L?E.UnicodeService.extractWidth(be):0;if(be=ve,ne&&this._onA11yChar.fire((0,_.stringFromCodePoint)(H)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+U-oe>ge){if(J){const ie=de;let W=this._activeBuffer.x-oe;for(this._activeBuffer.x=oe,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),de=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),oe>0&&de instanceof m.BufferLine&&de.copyCellsFrom(ie,W,0,oe,!1);W<ge;)ie.setCellFromCodepoint(W++,0,1,fe)}else if(this._activeBuffer.x=ge-1,U===2)continue}if(L&&this._activeBuffer.x){const ie=de.getWidth(this._activeBuffer.x-1)?1:2;de.addCodepointToCell(this._activeBuffer.x-ie,H,U);for(let W=U-oe;--W>=0;)de.setCellFromCodepoint(this._activeBuffer.x++,0,0,fe)}else if(V&&(de.insertCells(this._activeBuffer.x,U-oe,this._activeBuffer.getNullCell(fe)),de.getWidth(ge-1)===2&&de.setCellFromCodepoint(ge-1,y.NULL_CELL_CODE,y.NULL_CELL_WIDTH,fe)),de.setCellFromCodepoint(this._activeBuffer.x++,H,U,fe),U>0)for(;--U;)de.setCellFromCodepoint(this._activeBuffer.x++,0,0,fe)}this._parser.precedingJoinState=be,this._activeBuffer.x<ge&&$-B>0&&de.getWidth(this._activeBuffer.x)===0&&!de.hasContent(this._activeBuffer.x)&&de.setCellFromCodepoint(this._activeBuffer.x,0,1,fe),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(N,B){return N.final!=="t"||N.prefix||N.intermediates?this._parser.registerCsiHandler(N,B):this._parser.registerCsiHandler(N,$=>!P($.params[0],this._optionsService.rawOptions.windowOptions)||B($))}registerDcsHandler(N,B){return this._parser.registerDcsHandler(N,new x.DcsHandler(B))}registerEscHandler(N,B){return this._parser.registerEscHandler(N,B)}registerOscHandler(N,B){return this._parser.registerOscHandler(N,new S.OscHandler(B))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);N.hasWidth(this._activeBuffer.x)&&!N.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const N=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-N),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(N=this._bufferService.cols-1){this._activeBuffer.x=Math.min(N,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(N,B){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=N,this._activeBuffer.y=this._activeBuffer.scrollTop+B):(this._activeBuffer.x=N,this._activeBuffer.y=B),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(N,B){this._restrictCursor(),this._setCursor(this._activeBuffer.x+N,this._activeBuffer.y+B)}cursorUp(N){const B=this._activeBuffer.y-this._activeBuffer.scrollTop;return B>=0?this._moveCursor(0,-Math.min(B,N.params[0]||1)):this._moveCursor(0,-(N.params[0]||1)),!0}cursorDown(N){const B=this._activeBuffer.scrollBottom-this._activeBuffer.y;return B>=0?this._moveCursor(0,Math.min(B,N.params[0]||1)):this._moveCursor(0,N.params[0]||1),!0}cursorForward(N){return this._moveCursor(N.params[0]||1,0),!0}cursorBackward(N){return this._moveCursor(-(N.params[0]||1),0),!0}cursorNextLine(N){return this.cursorDown(N),this._activeBuffer.x=0,!0}cursorPrecedingLine(N){return this.cursorUp(N),this._activeBuffer.x=0,!0}cursorCharAbsolute(N){return this._setCursor((N.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(N){return this._setCursor(N.length>=2?(N.params[1]||1)-1:0,(N.params[0]||1)-1),!0}charPosAbsolute(N){return this._setCursor((N.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(N){return this._moveCursor(N.params[0]||1,0),!0}linePosAbsolute(N){return this._setCursor(this._activeBuffer.x,(N.params[0]||1)-1),!0}vPositionRelative(N){return this._moveCursor(0,N.params[0]||1),!0}hVPosition(N){return this.cursorPosition(N),!0}tabClear(N){const B=N.params[0];return B===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:B===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(N){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let B=N.params[0]||1;for(;B--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(N){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let B=N.params[0]||1;for(;B--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(N){const B=N.params[0];return B===1&&(this._curAttrData.bg|=536870912),B!==2&&B!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(N,B,$,H=!1,U=!1){const Q=this._activeBuffer.lines.get(this._activeBuffer.ybase+N);Q.replaceCells(B,$,this._activeBuffer.getNullCell(this._eraseAttrData()),U),H&&(Q.isWrapped=!1)}_resetBufferLine(N,B=!1){const $=this._activeBuffer.lines.get(this._activeBuffer.ybase+N);$&&($.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),B),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+N),$.isWrapped=!1)}eraseInDisplay(N,B=!1){let $;switch(this._restrictCursor(this._bufferService.cols),N.params[0]){case 0:for($=this._activeBuffer.y,this._dirtyRowTracker.markDirty($),this._eraseInBufferLine($++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,B);$<this._bufferService.rows;$++)this._resetBufferLine($,B);this._dirtyRowTracker.markDirty($);break;case 1:for($=this._activeBuffer.y,this._dirtyRowTracker.markDirty($),this._eraseInBufferLine($,0,this._activeBuffer.x+1,!0,B),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get($+1).isWrapped=!1);$--;)this._resetBufferLine($,B);this._dirtyRowTracker.markDirty(0);break;case 2:for($=this._bufferService.rows,this._dirtyRowTracker.markDirty($-1);$--;)this._resetBufferLine($,B);this._dirtyRowTracker.markDirty(0);break;case 3:const H=this._activeBuffer.lines.length-this._bufferService.rows;H>0&&(this._activeBuffer.lines.trimStart(H),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-H,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-H,0),this._onScroll.fire(0))}return!0}eraseInLine(N,B=!1){switch(this._restrictCursor(this._bufferService.cols),N.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,B);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,B);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,B)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(N){this._restrictCursor();let B=N.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const $=this._activeBuffer.ybase+this._activeBuffer.y,H=this._bufferService.rows-1-this._activeBuffer.scrollBottom,U=this._bufferService.rows-1+this._activeBuffer.ybase-H+1;for(;B--;)this._activeBuffer.lines.splice(U-1,1),this._activeBuffer.lines.splice($,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(N){this._restrictCursor();let B=N.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const $=this._activeBuffer.ybase+this._activeBuffer.y;let H;for(H=this._bufferService.rows-1-this._activeBuffer.scrollBottom,H=this._bufferService.rows-1+this._activeBuffer.ybase-H;B--;)this._activeBuffer.lines.splice($,1),this._activeBuffer.lines.splice(H,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(N){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.insertCells(this._activeBuffer.x,N.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(N){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.deleteCells(this._activeBuffer.x,N.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(N){let B=N.params[0]||1;for(;B--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(N){let B=N.params[0]||1;for(;B--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(m.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(N){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=N.params[0]||1;for(let $=this._activeBuffer.scrollTop;$<=this._activeBuffer.scrollBottom;++$){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+$);H.deleteCells(0,B,this._activeBuffer.getNullCell(this._eraseAttrData())),H.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(N){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=N.params[0]||1;for(let $=this._activeBuffer.scrollTop;$<=this._activeBuffer.scrollBottom;++$){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+$);H.insertCells(0,B,this._activeBuffer.getNullCell(this._eraseAttrData())),H.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(N){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=N.params[0]||1;for(let $=this._activeBuffer.scrollTop;$<=this._activeBuffer.scrollBottom;++$){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+$);H.insertCells(this._activeBuffer.x,B,this._activeBuffer.getNullCell(this._eraseAttrData())),H.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(N){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const B=N.params[0]||1;for(let $=this._activeBuffer.scrollTop;$<=this._activeBuffer.scrollBottom;++$){const H=this._activeBuffer.lines.get(this._activeBuffer.ybase+$);H.deleteCells(this._activeBuffer.x,B,this._activeBuffer.getNullCell(this._eraseAttrData())),H.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(N){this._restrictCursor();const B=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return B&&(B.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(N.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(N){const B=this._parser.precedingJoinState;if(!B)return!0;const $=N.params[0]||1,H=E.UnicodeService.extractWidth(B),U=this._activeBuffer.x-H,Q=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(U),ne=new Uint32Array(Q.length*$);let ge=0;for(let V=0;V<Q.length;){const fe=Q.codePointAt(V)||0;ne[ge++]=fe,V+=fe>65535?2:1}let J=ge;for(let V=1;V<$;++V)ne.copyWithin(J,0,ge),J+=ge;return this.print(ne,0,J),!0}sendDeviceAttributesPrimary(N){return N.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(h.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(h.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(N){return N.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(h.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(h.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(N.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(h.C0.ESC+"[>83;40003;0c")),!0}_is(N){return(this._optionsService.rawOptions.termName+"").indexOf(N)===0}setMode(N){for(let B=0;B<N.length;B++)switch(N.params[B]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(N){for(let B=0;B<N.length;B++)switch(N.params[B]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),this._charsetService.setgCharset(1,d.DEFAULT_CHARSET),this._charsetService.setgCharset(2,d.DEFAULT_CHARSET),this._charsetService.setgCharset(3,d.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(N){for(let B=0;B<N.length;B++)switch(N.params[B]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(N){for(let B=0;B<N.length;B++)switch(N.params[B]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),N.params[B]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(N,B){const $=this._coreService.decPrivateModes,{activeProtocol:H,activeEncoding:U}=this._coreMouseService,Q=this._coreService,{buffers:ne,cols:ge}=this._bufferService,{active:J,alt:V}=ne,fe=this._optionsService.rawOptions,de=L=>L?1:2,be=N.params[0];return me=be,ve=B?be===2?4:be===4?de(Q.modes.insertMode):be===12?3:be===20?de(fe.convertEol):0:be===1?de($.applicationCursorKeys):be===3?fe.windowOptions.setWinLines?ge===80?2:ge===132?1:0:0:be===6?de($.origin):be===7?de($.wraparound):be===8?3:be===9?de(H==="X10"):be===12?de(fe.cursorBlink):be===25?de(!Q.isCursorHidden):be===45?de($.reverseWraparound):be===66?de($.applicationKeypad):be===67?4:be===1e3?de(H==="VT200"):be===1002?de(H==="DRAG"):be===1003?de(H==="ANY"):be===1004?de($.sendFocus):be===1005?4:be===1006?de(U==="SGR"):be===1015?4:be===1016?de(U==="SGR_PIXELS"):be===1048?1:be===47||be===1047||be===1049?de(J===V):be===2004?de($.bracketedPasteMode):0,Q.triggerDataEvent(`${h.C0.ESC}[${B?"":"?"}${me};${ve}$y`),!0;var me,ve}_updateAttrColor(N,B,$,H,U){return B===2?(N|=50331648,N&=-16777216,N|=v.AttributeData.fromColorRGB([$,H,U])):B===5&&(N&=-50331904,N|=33554432|255&$),N}_extractColor(N,B,$){const H=[0,0,-1,0,0,0];let U=0,Q=0;do{if(H[Q+U]=N.params[B+Q],N.hasSubParams(B+Q)){const ne=N.getSubParams(B+Q);let ge=0;do H[1]===5&&(U=1),H[Q+ge+1+U]=ne[ge];while(++ge<ne.length&&ge+Q+1+U<H.length);break}if(H[1]===5&&Q+U>=2||H[1]===2&&Q+U>=5)break;H[1]&&(U=1)}while(++Q+B<N.length&&Q+U<H.length);for(let ne=2;ne<H.length;++ne)H[ne]===-1&&(H[ne]=0);switch(H[0]){case 38:$.fg=this._updateAttrColor($.fg,H[1],H[3],H[4],H[5]);break;case 48:$.bg=this._updateAttrColor($.bg,H[1],H[3],H[4],H[5]);break;case 58:$.extended=$.extended.clone(),$.extended.underlineColor=this._updateAttrColor($.extended.underlineColor,H[1],H[3],H[4],H[5])}return Q}_processUnderline(N,B){B.extended=B.extended.clone(),(!~N||N>5)&&(N=1),B.extended.underlineStyle=N,B.fg|=268435456,N===0&&(B.fg&=-268435457),B.updateExtended()}_processSGR0(N){N.fg=m.DEFAULT_ATTR_DATA.fg,N.bg=m.DEFAULT_ATTR_DATA.bg,N.extended=N.extended.clone(),N.extended.underlineStyle=0,N.extended.underlineColor&=-67108864,N.updateExtended()}charAttributes(N){if(N.length===1&&N.params[0]===0)return this._processSGR0(this._curAttrData),!0;const B=N.length;let $;const H=this._curAttrData;for(let U=0;U<B;U++)$=N.params[U],$>=30&&$<=37?(H.fg&=-50331904,H.fg|=16777216|$-30):$>=40&&$<=47?(H.bg&=-50331904,H.bg|=16777216|$-40):$>=90&&$<=97?(H.fg&=-50331904,H.fg|=16777224|$-90):$>=100&&$<=107?(H.bg&=-50331904,H.bg|=16777224|$-100):$===0?this._processSGR0(H):$===1?H.fg|=134217728:$===3?H.bg|=67108864:$===4?(H.fg|=268435456,this._processUnderline(N.hasSubParams(U)?N.getSubParams(U)[0]:1,H)):$===5?H.fg|=536870912:$===7?H.fg|=67108864:$===8?H.fg|=1073741824:$===9?H.fg|=2147483648:$===2?H.bg|=134217728:$===21?this._processUnderline(2,H):$===22?(H.fg&=-134217729,H.bg&=-134217729):$===23?H.bg&=-67108865:$===24?(H.fg&=-268435457,this._processUnderline(0,H)):$===25?H.fg&=-536870913:$===27?H.fg&=-67108865:$===28?H.fg&=-1073741825:$===29?H.fg&=2147483647:$===39?(H.fg&=-67108864,H.fg|=16777215&m.DEFAULT_ATTR_DATA.fg):$===49?(H.bg&=-67108864,H.bg|=16777215&m.DEFAULT_ATTR_DATA.bg):$===38||$===48||$===58?U+=this._extractColor(N,U,H):$===53?H.bg|=1073741824:$===55?H.bg&=-1073741825:$===59?(H.extended=H.extended.clone(),H.extended.underlineColor=-1,H.updateExtended()):$===100?(H.fg&=-67108864,H.fg|=16777215&m.DEFAULT_ATTR_DATA.fg,H.bg&=-67108864,H.bg|=16777215&m.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",$);return!0}deviceStatus(N){switch(N.params[0]){case 5:this._coreService.triggerDataEvent(`${h.C0.ESC}[0n`);break;case 6:const B=this._activeBuffer.y+1,$=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${h.C0.ESC}[${B};${$}R`)}return!0}deviceStatusPrivate(N){if(N.params[0]===6){const B=this._activeBuffer.y+1,$=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${h.C0.ESC}[?${B};${$}R`)}return!0}softReset(N){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=m.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(N){const B=N.params[0]||1;switch(B){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const $=B%2==1;return this._optionsService.options.cursorBlink=$,!0}setScrollRegion(N){const B=N.params[0]||1;let $;return(N.length<2||($=N.params[1])>this._bufferService.rows||$===0)&&($=this._bufferService.rows),$>B&&(this._activeBuffer.scrollTop=B-1,this._activeBuffer.scrollBottom=$-1,this._setCursor(0,0)),!0}windowOptions(N){if(!P(N.params[0],this._optionsService.rawOptions.windowOptions))return!0;const B=N.length>1?N.params[1]:0;switch(N.params[0]){case 14:B!==2&&this._onRequestWindowsOptionsReport.fire(D.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(D.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${h.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:B!==0&&B!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),B!==0&&B!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:B!==0&&B!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),B!==0&&B!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(N){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(N){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(N){return this._windowTitle=N,this._onTitleChange.fire(N),!0}setIconName(N){return this._iconName=N,!0}setOrReportIndexedColor(N){const B=[],$=N.split(";");for(;$.length>1;){const H=$.shift(),U=$.shift();if(/^\d+$/.exec(H)){const Q=parseInt(H);if(q(Q))if(U==="?")B.push({type:0,index:Q});else{const ne=(0,C.parseColor)(U);ne&&B.push({type:1,index:Q,color:ne})}}}return B.length&&this._onColor.fire(B),!0}setHyperlink(N){const B=N.split(";");return!(B.length<2)&&(B[1]?this._createHyperlink(B[0],B[1]):!B[0]&&this._finishHyperlink())}_createHyperlink(N,B){this._getCurrentLinkId()&&this._finishHyperlink();const $=N.split(":");let H;const U=$.findIndex(Q=>Q.startsWith("id="));return U!==-1&&(H=$[U].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:H,uri:B}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(N,B){const $=N.split(";");for(let H=0;H<$.length&&!(B>=this._specialColors.length);++H,++B)if($[H]==="?")this._onColor.fire([{type:0,index:this._specialColors[B]}]);else{const U=(0,C.parseColor)($[H]);U&&this._onColor.fire([{type:1,index:this._specialColors[B],color:U}])}return!0}setOrReportFgColor(N){return this._setOrReportSpecialColor(N,0)}setOrReportBgColor(N){return this._setOrReportSpecialColor(N,1)}setOrReportCursorColor(N){return this._setOrReportSpecialColor(N,2)}restoreIndexedColor(N){if(!N)return this._onColor.fire([{type:2}]),!0;const B=[],$=N.split(";");for(let H=0;H<$.length;++H)if(/^\d+$/.exec($[H])){const U=parseInt($[H]);q(U)&&B.push({type:2,index:U})}return B.length&&this._onColor.fire(B),!0}restoreFgColor(N){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(N){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(N){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,d.DEFAULT_CHARSET),!0}selectCharset(N){return N.length!==2?(this.selectDefaultCharset(),!0):(N[0]==="/"||this._charsetService.setgCharset(A[N[0]],d.CHARSETS[N[1]]||d.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const N=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,N,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=m.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=m.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(N){return this._charsetService.setgLevel(N),!0}screenAlignmentPattern(){const N=new b.CellData;N.content=4194373,N.fg=this._curAttrData.fg,N.bg=this._curAttrData.bg,this._setCursor(0,0);for(let B=0;B<this._bufferService.rows;++B){const $=this._activeBuffer.ybase+this._activeBuffer.y+B,H=this._activeBuffer.lines.get($);H&&(H.fill(N),H.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(N,B){const $=this._bufferService.buffer,H=this._optionsService.rawOptions;return(U=>(this._coreService.triggerDataEvent(`${h.C0.ESC}${U}${h.C0.ESC}\\`),!0))(N==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:N==='"p'?'P1$r61;1"p':N==="r"?`P1$r${$.scrollTop+1};${$.scrollBottom+1}r`:N==="m"?"P1$r0m":N===" q"?`P1$r${{block:2,underline:4,bar:6}[H.cursorStyle]-(H.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(N,B){this._dirtyRowTracker.markRangeDirty(N,B)}}a.InputHandler=G;let ee=class{constructor(re){this._bufferService=re,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(re){re<this.start?this.start=re:re>this.end&&(this.end=re)}markRangeDirty(re,N){re>N&&(R=re,re=N,N=R),re<this.start&&(this.start=re),N>this.end&&(this.end=N)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function q(re){return 0<=re&&re<256}ee=c([u(0,w.IBufferService)],ee)},844:(o,a)=>{function l(c){for(const u of c)u.dispose();c.length=0}Object.defineProperty(a,"__esModule",{value:!0}),a.getDisposeArrayDisposable=a.disposeArray=a.toDisposable=a.MutableDisposable=a.Disposable=void 0,a.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const c of this._disposables)c.dispose();this._disposables.length=0}register(c){return this._disposables.push(c),c}unregister(c){const u=this._disposables.indexOf(c);u!==-1&&this._disposables.splice(u,1)}},a.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(c){this._isDisposed||c===this._value||(this._value?.dispose(),this._value=c)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}},a.toDisposable=function(c){return{dispose:c}},a.disposeArray=l,a.getDisposeArrayDisposable=function(c){return{dispose:()=>l(c)}}},1505:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.FourKeyMap=a.TwoKeyMap=void 0;class l{constructor(){this._data={}}set(u,h,d){this._data[u]||(this._data[u]={}),this._data[u][h]=d}get(u,h){return this._data[u]?this._data[u][h]:void 0}clear(){this._data={}}}a.TwoKeyMap=l,a.FourKeyMap=class{constructor(){this._data=new l}set(c,u,h,d,f){this._data.get(c,u)||this._data.set(c,u,new l),this._data.get(c,u).set(h,d,f)}get(c,u,h,d){return this._data.get(c,u)?.get(h,d)}clear(){this._data.clear()}}},6114:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.isChromeOS=a.isLinux=a.isWindows=a.isIphone=a.isIpad=a.isMac=a.getSafariVersion=a.isSafari=a.isLegacyEdge=a.isFirefox=a.isNode=void 0,a.isNode=typeof Dt<"u"&&"title"in Dt;const l=a.isNode?"node":navigator.userAgent,c=a.isNode?"node":navigator.platform;a.isFirefox=l.includes("Firefox"),a.isLegacyEdge=l.includes("Edge"),a.isSafari=/^((?!chrome|android).)*safari/i.test(l),a.getSafariVersion=function(){if(!a.isSafari)return 0;const u=l.match(/Version\/(\d+)/);return u===null||u.length<2?0:parseInt(u[1])},a.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(c),a.isIpad=c==="iPad",a.isIphone=c==="iPhone",a.isWindows=["Windows","Win16","Win32","WinCE"].includes(c),a.isLinux=c.indexOf("Linux")>=0,a.isChromeOS=/\bCrOS\b/.test(l)},6106:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.SortedList=void 0;let l=0;a.SortedList=class{constructor(c){this._getKey=c,this._array=[]}clear(){this._array.length=0}insert(c){this._array.length!==0?(l=this._search(this._getKey(c)),this._array.splice(l,0,c)):this._array.push(c)}delete(c){if(this._array.length===0)return!1;const u=this._getKey(c);if(u===void 0||(l=this._search(u),l===-1)||this._getKey(this._array[l])!==u)return!1;do if(this._array[l]===c)return this._array.splice(l,1),!0;while(++l<this._array.length&&this._getKey(this._array[l])===u);return!1}*getKeyIterator(c){if(this._array.length!==0&&(l=this._search(c),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===c))do yield this._array[l];while(++l<this._array.length&&this._getKey(this._array[l])===c)}forEachByKey(c,u){if(this._array.length!==0&&(l=this._search(c),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===c))do u(this._array[l]);while(++l<this._array.length&&this._getKey(this._array[l])===c)}values(){return[...this._array].values()}_search(c){let u=0,h=this._array.length-1;for(;h>=u;){let d=u+h>>1;const f=this._getKey(this._array[d]);if(f>c)h=d-1;else{if(!(f<c)){for(;d>0&&this._getKey(this._array[d-1])===c;)d--;return d}u=d+1}}return u}}},7226:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.DebouncedIdleTask=a.IdleTaskQueue=a.PriorityTaskQueue=void 0;const c=l(6114);class u{constructor(){this._tasks=[],this._i=0}enqueue(f){this._tasks.push(f),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(f){this._idleCallback=void 0;let g=0,_=0,m=f.timeRemaining(),p=0;for(;this._i<this._tasks.length;){if(g=Date.now(),this._tasks[this._i]()||this._i++,g=Math.max(1,Date.now()-g),_=Math.max(g,_),p=f.timeRemaining(),1.5*_>p)return m-g<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(m-g))}ms`),void this._start();m=p}this.clear()}}class h extends u{_requestCallback(f){return setTimeout(()=>f(this._createDeadline(16)))}_cancelCallback(f){clearTimeout(f)}_createDeadline(f){const g=Date.now()+f;return{timeRemaining:()=>Math.max(0,g-Date.now())}}}a.PriorityTaskQueue=h,a.IdleTaskQueue=!c.isNode&&"requestIdleCallback"in window?class extends u{_requestCallback(d){return requestIdleCallback(d)}_cancelCallback(d){cancelIdleCallback(d)}}:h,a.DebouncedIdleTask=class{constructor(){this._queue=new a.IdleTaskQueue}set(d){this._queue.clear(),this._queue.enqueue(d)}flush(){this._queue.flush()}}},9282:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.updateWindowsModeWrappedState=void 0;const c=l(643);a.updateWindowsModeWrappedState=function(u){const h=u.buffer.lines.get(u.buffer.ybase+u.buffer.y-1),d=h?.get(u.cols-1),f=u.buffer.lines.get(u.buffer.ybase+u.buffer.y);f&&d&&(f.isWrapped=d[c.CHAR_DATA_CODE_INDEX]!==c.NULL_CELL_CODE&&d[c.CHAR_DATA_CODE_INDEX]!==c.WHITESPACE_CELL_CODE)}},3734:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ExtendedAttrs=a.AttributeData=void 0;class l{constructor(){this.fg=0,this.bg=0,this.extended=new c}static toColorRGB(h){return[h>>>16&255,h>>>8&255,255&h]}static fromColorRGB(h){return(255&h[0])<<16|(255&h[1])<<8|255&h[2]}clone(){const h=new l;return h.fg=this.fg,h.bg=this.bg,h.extended=this.extended.clone(),h}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}a.AttributeData=l;class c{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(h){this._ext=h}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(h){this._ext&=-469762049,this._ext|=h<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(h){this._ext&=-67108864,this._ext|=67108863&h}get urlId(){return this._urlId}set urlId(h){this._urlId=h}get underlineVariantOffset(){const h=(3758096384&this._ext)>>29;return h<0?4294967288^h:h}set underlineVariantOffset(h){this._ext&=536870911,this._ext|=h<<29&3758096384}constructor(h=0,d=0){this._ext=0,this._urlId=0,this._ext=h,this._urlId=d}clone(){return new c(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}a.ExtendedAttrs=c},9092:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Buffer=a.MAX_BUFFER_SIZE=void 0;const c=l(6349),u=l(7226),h=l(3734),d=l(8437),f=l(4634),g=l(511),_=l(643),m=l(4863),p=l(7116);a.MAX_BUFFER_SIZE=4294967295,a.Buffer=class{constructor(y,b,v){this._hasScrollback=y,this._optionsService=b,this._bufferService=v,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=d.DEFAULT_ATTR_DATA.clone(),this.savedCharset=p.DEFAULT_CHARSET,this.markers=[],this._nullCell=g.CellData.fromCharData([0,_.NULL_CELL_CHAR,_.NULL_CELL_WIDTH,_.NULL_CELL_CODE]),this._whitespaceCell=g.CellData.fromCharData([0,_.WHITESPACE_CELL_CHAR,_.WHITESPACE_CELL_WIDTH,_.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new u.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(y){return y?(this._nullCell.fg=y.fg,this._nullCell.bg=y.bg,this._nullCell.extended=y.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new h.ExtendedAttrs),this._nullCell}getWhitespaceCell(y){return y?(this._whitespaceCell.fg=y.fg,this._whitespaceCell.bg=y.bg,this._whitespaceCell.extended=y.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new h.ExtendedAttrs),this._whitespaceCell}getBlankLine(y,b){return new d.BufferLine(this._bufferService.cols,this.getNullCell(y),b)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const y=this.ybase+this.y-this.ydisp;return y>=0&&y<this._rows}_getCorrectBufferLength(y){if(!this._hasScrollback)return y;const b=y+this._optionsService.rawOptions.scrollback;return b>a.MAX_BUFFER_SIZE?a.MAX_BUFFER_SIZE:b}fillViewportRows(y){if(this.lines.length===0){y===void 0&&(y=d.DEFAULT_ATTR_DATA);let b=this._rows;for(;b--;)this.lines.push(this.getBlankLine(y))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(y,b){const v=this.getNullCell(d.DEFAULT_ATTR_DATA);let w=0;const E=this._getCorrectBufferLength(b);if(E>this.lines.maxLength&&(this.lines.maxLength=E),this.lines.length>0){if(this._cols<y)for(let x=0;x<this.lines.length;x++)w+=+this.lines.get(x).resize(y,v);let S=0;if(this._rows<b)for(let x=this._rows;x<b;x++)this.lines.length<b+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new d.BufferLine(y,v)):this.ybase>0&&this.lines.length<=this.ybase+this.y+S+1?(this.ybase--,S++,this.ydisp>0&&this.ydisp--):this.lines.push(new d.BufferLine(y,v)));else for(let x=this._rows;x>b;x--)this.lines.length>b+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(E<this.lines.maxLength){const x=this.lines.length-E;x>0&&(this.lines.trimStart(x),this.ybase=Math.max(this.ybase-x,0),this.ydisp=Math.max(this.ydisp-x,0),this.savedY=Math.max(this.savedY-x,0)),this.lines.maxLength=E}this.x=Math.min(this.x,y-1),this.y=Math.min(this.y,b-1),S&&(this.y+=S),this.savedX=Math.min(this.savedX,y-1),this.scrollTop=0}if(this.scrollBottom=b-1,this._isReflowEnabled&&(this._reflow(y,b),this._cols>y))for(let S=0;S<this.lines.length;S++)w+=+this.lines.get(S).resize(y,v);this._cols=y,this._rows=b,this._memoryCleanupQueue.clear(),w>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let y=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,y=!1);let b=0;for(;this._memoryCleanupPosition<this.lines.length;)if(b+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),b>100)return!0;return y}get _isReflowEnabled(){const y=this._optionsService.rawOptions.windowsPty;return y&&y.buildNumber?this._hasScrollback&&y.backend==="conpty"&&y.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(y,b){this._cols!==y&&(y>this._cols?this._reflowLarger(y,b):this._reflowSmaller(y,b))}_reflowLarger(y,b){const v=(0,f.reflowLargerGetLinesToRemove)(this.lines,this._cols,y,this.ybase+this.y,this.getNullCell(d.DEFAULT_ATTR_DATA));if(v.length>0){const w=(0,f.reflowLargerCreateNewLayout)(this.lines,v);(0,f.reflowLargerApplyNewLayout)(this.lines,w.layout),this._reflowLargerAdjustViewport(y,b,w.countRemoved)}}_reflowLargerAdjustViewport(y,b,v){const w=this.getNullCell(d.DEFAULT_ATTR_DATA);let E=v;for(;E-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<b&&this.lines.push(new d.BufferLine(y,w))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-v,0)}_reflowSmaller(y,b){const v=this.getNullCell(d.DEFAULT_ATTR_DATA),w=[];let E=0;for(let S=this.lines.length-1;S>=0;S--){let x=this.lines.get(S);if(!x||!x.isWrapped&&x.getTrimmedLength()<=y)continue;const C=[x];for(;x.isWrapped&&S>0;)x=this.lines.get(--S),C.unshift(x);const A=this.ybase+this.y;if(A>=S&&A<S+C.length)continue;const M=C[C.length-1].getTrimmedLength(),P=(0,f.reflowSmallerGetNewLineLengths)(C,this._cols,y),D=P.length-C.length;let R;R=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+D):Math.max(0,this.lines.length-this.lines.maxLength+D);const G=[];for(let $=0;$<D;$++){const H=this.getBlankLine(d.DEFAULT_ATTR_DATA,!0);G.push(H)}G.length>0&&(w.push({start:S+C.length+E,newLines:G}),E+=G.length),C.push(...G);let ee=P.length-1,q=P[ee];q===0&&(ee--,q=P[ee]);let re=C.length-D-1,N=M;for(;re>=0;){const $=Math.min(N,q);if(C[ee]===void 0)break;if(C[ee].copyCellsFrom(C[re],N-$,q-$,$,!0),q-=$,q===0&&(ee--,q=P[ee]),N-=$,N===0){re--;const H=Math.max(re,0);N=(0,f.getWrappedLineTrimmedLength)(C,H,this._cols)}}for(let $=0;$<C.length;$++)P[$]<y&&C[$].setCell(P[$],v);let B=D-R;for(;B-- >0;)this.ybase===0?this.y<b-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+E)-b&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+D,this.ybase+b-1)}if(w.length>0){const S=[],x=[];for(let ee=0;ee<this.lines.length;ee++)x.push(this.lines.get(ee));const C=this.lines.length;let A=C-1,M=0,P=w[M];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+E);let D=0;for(let ee=Math.min(this.lines.maxLength-1,C+E-1);ee>=0;ee--)if(P&&P.start>A+D){for(let q=P.newLines.length-1;q>=0;q--)this.lines.set(ee--,P.newLines[q]);ee++,S.push({index:A+1,amount:P.newLines.length}),D+=P.newLines.length,P=w[++M]}else this.lines.set(ee,x[A--]);let R=0;for(let ee=S.length-1;ee>=0;ee--)S[ee].index+=R,this.lines.onInsertEmitter.fire(S[ee]),R+=S[ee].amount;const G=Math.max(0,C+E-this.lines.maxLength);G>0&&this.lines.onTrimEmitter.fire(G)}}translateBufferLineToString(y,b,v=0,w){const E=this.lines.get(y);return E?E.translateToString(b,v,w):""}getWrappedRangeForLine(y){let b=y,v=y;for(;b>0&&this.lines.get(b).isWrapped;)b--;for(;v+1<this.lines.length&&this.lines.get(v+1).isWrapped;)v++;return{first:b,last:v}}setupTabStops(y){for(y!=null?this.tabs[y]||(y=this.prevStop(y)):(this.tabs={},y=0);y<this._cols;y+=this._optionsService.rawOptions.tabStopWidth)this.tabs[y]=!0}prevStop(y){for(y==null&&(y=this.x);!this.tabs[--y]&&y>0;);return y>=this._cols?this._cols-1:y<0?0:y}nextStop(y){for(y==null&&(y=this.x);!this.tabs[++y]&&y<this._cols;);return y>=this._cols?this._cols-1:y<0?0:y}clearMarkers(y){this._isClearing=!0;for(let b=0;b<this.markers.length;b++)this.markers[b].line===y&&(this.markers[b].dispose(),this.markers.splice(b--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let y=0;y<this.markers.length;y++)this.markers[y].dispose(),this.markers.splice(y--,1);this._isClearing=!1}addMarker(y){const b=new m.Marker(y);return this.markers.push(b),b.register(this.lines.onTrim(v=>{b.line-=v,b.line<0&&b.dispose()})),b.register(this.lines.onInsert(v=>{b.line>=v.index&&(b.line+=v.amount)})),b.register(this.lines.onDelete(v=>{b.line>=v.index&&b.line<v.index+v.amount&&b.dispose(),b.line>v.index&&(b.line-=v.amount)})),b.register(b.onDispose(()=>this._removeMarker(b))),b}_removeMarker(y){this._isClearing||this.markers.splice(this.markers.indexOf(y),1)}}},8437:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferLine=a.DEFAULT_ATTR_DATA=void 0;const c=l(3734),u=l(511),h=l(643),d=l(482);a.DEFAULT_ATTR_DATA=Object.freeze(new c.AttributeData);let f=0;class g{constructor(m,p,y=!1){this.isWrapped=y,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*m);const b=p||u.CellData.fromCharData([0,h.NULL_CELL_CHAR,h.NULL_CELL_WIDTH,h.NULL_CELL_CODE]);for(let v=0;v<m;++v)this.setCell(v,b);this.length=m}get(m){const p=this._data[3*m+0],y=2097151&p;return[this._data[3*m+1],2097152&p?this._combined[m]:y?(0,d.stringFromCodePoint)(y):"",p>>22,2097152&p?this._combined[m].charCodeAt(this._combined[m].length-1):y]}set(m,p){this._data[3*m+1]=p[h.CHAR_DATA_ATTR_INDEX],p[h.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[m]=p[1],this._data[3*m+0]=2097152|m|p[h.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*m+0]=p[h.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|p[h.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(m){return this._data[3*m+0]>>22}hasWidth(m){return 12582912&this._data[3*m+0]}getFg(m){return this._data[3*m+1]}getBg(m){return this._data[3*m+2]}hasContent(m){return 4194303&this._data[3*m+0]}getCodePoint(m){const p=this._data[3*m+0];return 2097152&p?this._combined[m].charCodeAt(this._combined[m].length-1):2097151&p}isCombined(m){return 2097152&this._data[3*m+0]}getString(m){const p=this._data[3*m+0];return 2097152&p?this._combined[m]:2097151&p?(0,d.stringFromCodePoint)(2097151&p):""}isProtected(m){return 536870912&this._data[3*m+2]}loadCell(m,p){return f=3*m,p.content=this._data[f+0],p.fg=this._data[f+1],p.bg=this._data[f+2],2097152&p.content&&(p.combinedData=this._combined[m]),268435456&p.bg&&(p.extended=this._extendedAttrs[m]),p}setCell(m,p){2097152&p.content&&(this._combined[m]=p.combinedData),268435456&p.bg&&(this._extendedAttrs[m]=p.extended),this._data[3*m+0]=p.content,this._data[3*m+1]=p.fg,this._data[3*m+2]=p.bg}setCellFromCodepoint(m,p,y,b){268435456&b.bg&&(this._extendedAttrs[m]=b.extended),this._data[3*m+0]=p|y<<22,this._data[3*m+1]=b.fg,this._data[3*m+2]=b.bg}addCodepointToCell(m,p,y){let b=this._data[3*m+0];2097152&b?this._combined[m]+=(0,d.stringFromCodePoint)(p):2097151&b?(this._combined[m]=(0,d.stringFromCodePoint)(2097151&b)+(0,d.stringFromCodePoint)(p),b&=-2097152,b|=2097152):b=p|4194304,y&&(b&=-12582913,b|=y<<22),this._data[3*m+0]=b}insertCells(m,p,y){if((m%=this.length)&&this.getWidth(m-1)===2&&this.setCellFromCodepoint(m-1,0,1,y),p<this.length-m){const b=new u.CellData;for(let v=this.length-m-p-1;v>=0;--v)this.setCell(m+p+v,this.loadCell(m+v,b));for(let v=0;v<p;++v)this.setCell(m+v,y)}else for(let b=m;b<this.length;++b)this.setCell(b,y);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,y)}deleteCells(m,p,y){if(m%=this.length,p<this.length-m){const b=new u.CellData;for(let v=0;v<this.length-m-p;++v)this.setCell(m+v,this.loadCell(m+p+v,b));for(let v=this.length-p;v<this.length;++v)this.setCell(v,y)}else for(let b=m;b<this.length;++b)this.setCell(b,y);m&&this.getWidth(m-1)===2&&this.setCellFromCodepoint(m-1,0,1,y),this.getWidth(m)!==0||this.hasContent(m)||this.setCellFromCodepoint(m,0,1,y)}replaceCells(m,p,y,b=!1){if(b)for(m&&this.getWidth(m-1)===2&&!this.isProtected(m-1)&&this.setCellFromCodepoint(m-1,0,1,y),p<this.length&&this.getWidth(p-1)===2&&!this.isProtected(p)&&this.setCellFromCodepoint(p,0,1,y);m<p&&m<this.length;)this.isProtected(m)||this.setCell(m,y),m++;else for(m&&this.getWidth(m-1)===2&&this.setCellFromCodepoint(m-1,0,1,y),p<this.length&&this.getWidth(p-1)===2&&this.setCellFromCodepoint(p,0,1,y);m<p&&m<this.length;)this.setCell(m++,y)}resize(m,p){if(m===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const y=3*m;if(m>this.length){if(this._data.buffer.byteLength>=4*y)this._data=new Uint32Array(this._data.buffer,0,y);else{const b=new Uint32Array(y);b.set(this._data),this._data=b}for(let b=this.length;b<m;++b)this.setCell(b,p)}else{this._data=this._data.subarray(0,y);const b=Object.keys(this._combined);for(let w=0;w<b.length;w++){const E=parseInt(b[w],10);E>=m&&delete this._combined[E]}const v=Object.keys(this._extendedAttrs);for(let w=0;w<v.length;w++){const E=parseInt(v[w],10);E>=m&&delete this._extendedAttrs[E]}}return this.length=m,4*y*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const m=new Uint32Array(this._data.length);return m.set(this._data),this._data=m,1}return 0}fill(m,p=!1){if(p)for(let y=0;y<this.length;++y)this.isProtected(y)||this.setCell(y,m);else{this._combined={},this._extendedAttrs={};for(let y=0;y<this.length;++y)this.setCell(y,m)}}copyFrom(m){this.length!==m.length?this._data=new Uint32Array(m._data):this._data.set(m._data),this.length=m.length,this._combined={};for(const p in m._combined)this._combined[p]=m._combined[p];this._extendedAttrs={};for(const p in m._extendedAttrs)this._extendedAttrs[p]=m._extendedAttrs[p];this.isWrapped=m.isWrapped}clone(){const m=new g(0);m._data=new Uint32Array(this._data),m.length=this.length;for(const p in this._combined)m._combined[p]=this._combined[p];for(const p in this._extendedAttrs)m._extendedAttrs[p]=this._extendedAttrs[p];return m.isWrapped=this.isWrapped,m}getTrimmedLength(){for(let m=this.length-1;m>=0;--m)if(4194303&this._data[3*m+0])return m+(this._data[3*m+0]>>22);return 0}getNoBgTrimmedLength(){for(let m=this.length-1;m>=0;--m)if(4194303&this._data[3*m+0]||50331648&this._data[3*m+2])return m+(this._data[3*m+0]>>22);return 0}copyCellsFrom(m,p,y,b,v){const w=m._data;if(v)for(let S=b-1;S>=0;S--){for(let x=0;x<3;x++)this._data[3*(y+S)+x]=w[3*(p+S)+x];268435456&w[3*(p+S)+2]&&(this._extendedAttrs[y+S]=m._extendedAttrs[p+S])}else for(let S=0;S<b;S++){for(let x=0;x<3;x++)this._data[3*(y+S)+x]=w[3*(p+S)+x];268435456&w[3*(p+S)+2]&&(this._extendedAttrs[y+S]=m._extendedAttrs[p+S])}const E=Object.keys(m._combined);for(let S=0;S<E.length;S++){const x=parseInt(E[S],10);x>=p&&(this._combined[x-p+y]=m._combined[x])}}translateToString(m,p,y,b){p=p??0,y=y??this.length,m&&(y=Math.min(y,this.getTrimmedLength())),b&&(b.length=0);let v="";for(;p<y;){const w=this._data[3*p+0],E=2097151&w,S=2097152&w?this._combined[p]:E?(0,d.stringFromCodePoint)(E):h.WHITESPACE_CELL_CHAR;if(v+=S,b)for(let x=0;x<S.length;++x)b.push(p);p+=w>>22||1}return b&&b.push(p),v}}a.BufferLine=g},4841:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.getRangeLength=void 0,a.getRangeLength=function(l,c){if(l.start.y>l.end.y)throw new Error(`Buffer range end (${l.end.x}, ${l.end.y}) cannot be before start (${l.start.x}, ${l.start.y})`);return c*(l.end.y-l.start.y)+(l.end.x-l.start.x+1)}},4634:(o,a)=>{function l(c,u,h){if(u===c.length-1)return c[u].getTrimmedLength();const d=!c[u].hasContent(h-1)&&c[u].getWidth(h-1)===1,f=c[u+1].getWidth(0)===2;return d&&f?h-1:h}Object.defineProperty(a,"__esModule",{value:!0}),a.getWrappedLineTrimmedLength=a.reflowSmallerGetNewLineLengths=a.reflowLargerApplyNewLayout=a.reflowLargerCreateNewLayout=a.reflowLargerGetLinesToRemove=void 0,a.reflowLargerGetLinesToRemove=function(c,u,h,d,f){const g=[];for(let _=0;_<c.length-1;_++){let m=_,p=c.get(++m);if(!p.isWrapped)continue;const y=[c.get(_)];for(;m<c.length&&p.isWrapped;)y.push(p),p=c.get(++m);if(d>=_&&d<m){_+=y.length-1;continue}let b=0,v=l(y,b,u),w=1,E=0;for(;w<y.length;){const x=l(y,w,u),C=x-E,A=h-v,M=Math.min(C,A);y[b].copyCellsFrom(y[w],E,v,M,!1),v+=M,v===h&&(b++,v=0),E+=M,E===x&&(w++,E=0),v===0&&b!==0&&y[b-1].getWidth(h-1)===2&&(y[b].copyCellsFrom(y[b-1],h-1,v++,1,!1),y[b-1].setCell(h-1,f))}y[b].replaceCells(v,h,f);let S=0;for(let x=y.length-1;x>0&&(x>b||y[x].getTrimmedLength()===0);x--)S++;S>0&&(g.push(_+y.length-S),g.push(S)),_+=y.length-1}return g},a.reflowLargerCreateNewLayout=function(c,u){const h=[];let d=0,f=u[d],g=0;for(let _=0;_<c.length;_++)if(f===_){const m=u[++d];c.onDeleteEmitter.fire({index:_-g,amount:m}),_+=m-1,g+=m,f=u[++d]}else h.push(_);return{layout:h,countRemoved:g}},a.reflowLargerApplyNewLayout=function(c,u){const h=[];for(let d=0;d<u.length;d++)h.push(c.get(u[d]));for(let d=0;d<h.length;d++)c.set(d,h[d]);c.length=u.length},a.reflowSmallerGetNewLineLengths=function(c,u,h){const d=[],f=c.map((p,y)=>l(c,y,u)).reduce((p,y)=>p+y);let g=0,_=0,m=0;for(;m<f;){if(f-m<h){d.push(f-m);break}g+=h;const p=l(c,_,u);g>p&&(g-=p,_++);const y=c[_].getWidth(g-1)===2;y&&g--;const b=y?h-1:h;d.push(b),m+=b}return d},a.getWrappedLineTrimmedLength=l},5295:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferSet=void 0;const c=l(8460),u=l(844),h=l(9092);class d extends u.Disposable{constructor(g,_){super(),this._optionsService=g,this._bufferService=_,this._onBufferActivate=this.register(new c.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new h.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new h.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(g){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(g),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(g,_){this._normal.resize(g,_),this._alt.resize(g,_),this.setupTabStops(g)}setupTabStops(g){this._normal.setupTabStops(g),this._alt.setupTabStops(g)}}a.BufferSet=d},511:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CellData=void 0;const c=l(482),u=l(643),h=l(3734);class d extends h.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new h.ExtendedAttrs,this.combinedData=""}static fromCharData(g){const _=new d;return _.setFromCharData(g),_}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,c.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(g){this.fg=g[u.CHAR_DATA_ATTR_INDEX],this.bg=0;let _=!1;if(g[u.CHAR_DATA_CHAR_INDEX].length>2)_=!0;else if(g[u.CHAR_DATA_CHAR_INDEX].length===2){const m=g[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=m&&m<=56319){const p=g[u.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=p&&p<=57343?this.content=1024*(m-55296)+p-56320+65536|g[u.CHAR_DATA_WIDTH_INDEX]<<22:_=!0}else _=!0}else this.content=g[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|g[u.CHAR_DATA_WIDTH_INDEX]<<22;_&&(this.combinedData=g[u.CHAR_DATA_CHAR_INDEX],this.content=2097152|g[u.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}a.CellData=d},643:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.WHITESPACE_CELL_CODE=a.WHITESPACE_CELL_WIDTH=a.WHITESPACE_CELL_CHAR=a.NULL_CELL_CODE=a.NULL_CELL_WIDTH=a.NULL_CELL_CHAR=a.CHAR_DATA_CODE_INDEX=a.CHAR_DATA_WIDTH_INDEX=a.CHAR_DATA_CHAR_INDEX=a.CHAR_DATA_ATTR_INDEX=a.DEFAULT_EXT=a.DEFAULT_ATTR=a.DEFAULT_COLOR=void 0,a.DEFAULT_COLOR=0,a.DEFAULT_ATTR=256|a.DEFAULT_COLOR<<9,a.DEFAULT_EXT=0,a.CHAR_DATA_ATTR_INDEX=0,a.CHAR_DATA_CHAR_INDEX=1,a.CHAR_DATA_WIDTH_INDEX=2,a.CHAR_DATA_CODE_INDEX=3,a.NULL_CELL_CHAR="",a.NULL_CELL_WIDTH=1,a.NULL_CELL_CODE=0,a.WHITESPACE_CELL_CHAR=" ",a.WHITESPACE_CELL_WIDTH=1,a.WHITESPACE_CELL_CODE=32},4863:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Marker=void 0;const c=l(8460),u=l(844);class h{get id(){return this._id}constructor(f){this.line=f,this.isDisposed=!1,this._disposables=[],this._id=h._nextId++,this._onDispose=this.register(new c.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,u.disposeArray)(this._disposables),this._disposables.length=0)}register(f){return this._disposables.push(f),f}}a.Marker=h,h._nextId=1},7116:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.DEFAULT_CHARSET=a.CHARSETS=void 0,a.CHARSETS={},a.DEFAULT_CHARSET=a.CHARSETS.B,a.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},a.CHARSETS.A={"#":"£"},a.CHARSETS.B=void 0,a.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},a.CHARSETS.C=a.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},a.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},a.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},a.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},a.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},a.CHARSETS.E=a.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},a.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},a.CHARSETS.H=a.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},a.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(o,a)=>{var l,c,u;Object.defineProperty(a,"__esModule",{value:!0}),a.C1_ESCAPED=a.C1=a.C0=void 0,function(h){h.NUL="\0",h.SOH="",h.STX="",h.ETX="",h.EOT="",h.ENQ="",h.ACK="",h.BEL="\x07",h.BS="\b",h.HT="	",h.LF=`
`,h.VT="\v",h.FF="\f",h.CR="\r",h.SO="",h.SI="",h.DLE="",h.DC1="",h.DC2="",h.DC3="",h.DC4="",h.NAK="",h.SYN="",h.ETB="",h.CAN="",h.EM="",h.SUB="",h.ESC="\x1B",h.FS="",h.GS="",h.RS="",h.US="",h.SP=" ",h.DEL=""}(l||(a.C0=l={})),function(h){h.PAD="",h.HOP="",h.BPH="",h.NBH="",h.IND="",h.NEL="",h.SSA="",h.ESA="",h.HTS="",h.HTJ="",h.VTS="",h.PLD="",h.PLU="",h.RI="",h.SS2="",h.SS3="",h.DCS="",h.PU1="",h.PU2="",h.STS="",h.CCH="",h.MW="",h.SPA="",h.EPA="",h.SOS="",h.SGCI="",h.SCI="",h.CSI="",h.ST="",h.OSC="",h.PM="",h.APC=""}(c||(a.C1=c={})),function(h){h.ST=`${l.ESC}\\`}(u||(a.C1_ESCAPED=u={}))},7399:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.evaluateKeyboardEvent=void 0;const c=l(2584),u={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};a.evaluateKeyboardEvent=function(h,d,f,g){const _={type:0,cancel:!1,key:void 0},m=(h.shiftKey?1:0)|(h.altKey?2:0)|(h.ctrlKey?4:0)|(h.metaKey?8:0);switch(h.keyCode){case 0:h.key==="UIKeyInputUpArrow"?_.key=d?c.C0.ESC+"OA":c.C0.ESC+"[A":h.key==="UIKeyInputLeftArrow"?_.key=d?c.C0.ESC+"OD":c.C0.ESC+"[D":h.key==="UIKeyInputRightArrow"?_.key=d?c.C0.ESC+"OC":c.C0.ESC+"[C":h.key==="UIKeyInputDownArrow"&&(_.key=d?c.C0.ESC+"OB":c.C0.ESC+"[B");break;case 8:_.key=h.ctrlKey?"\b":c.C0.DEL,h.altKey&&(_.key=c.C0.ESC+_.key);break;case 9:if(h.shiftKey){_.key=c.C0.ESC+"[Z";break}_.key=c.C0.HT,_.cancel=!0;break;case 13:_.key=h.altKey?c.C0.ESC+c.C0.CR:c.C0.CR,_.cancel=!0;break;case 27:_.key=c.C0.ESC,h.altKey&&(_.key=c.C0.ESC+c.C0.ESC),_.cancel=!0;break;case 37:if(h.metaKey)break;m?(_.key=c.C0.ESC+"[1;"+(m+1)+"D",_.key===c.C0.ESC+"[1;3D"&&(_.key=c.C0.ESC+(f?"b":"[1;5D"))):_.key=d?c.C0.ESC+"OD":c.C0.ESC+"[D";break;case 39:if(h.metaKey)break;m?(_.key=c.C0.ESC+"[1;"+(m+1)+"C",_.key===c.C0.ESC+"[1;3C"&&(_.key=c.C0.ESC+(f?"f":"[1;5C"))):_.key=d?c.C0.ESC+"OC":c.C0.ESC+"[C";break;case 38:if(h.metaKey)break;m?(_.key=c.C0.ESC+"[1;"+(m+1)+"A",f||_.key!==c.C0.ESC+"[1;3A"||(_.key=c.C0.ESC+"[1;5A")):_.key=d?c.C0.ESC+"OA":c.C0.ESC+"[A";break;case 40:if(h.metaKey)break;m?(_.key=c.C0.ESC+"[1;"+(m+1)+"B",f||_.key!==c.C0.ESC+"[1;3B"||(_.key=c.C0.ESC+"[1;5B")):_.key=d?c.C0.ESC+"OB":c.C0.ESC+"[B";break;case 45:h.shiftKey||h.ctrlKey||(_.key=c.C0.ESC+"[2~");break;case 46:_.key=m?c.C0.ESC+"[3;"+(m+1)+"~":c.C0.ESC+"[3~";break;case 36:_.key=m?c.C0.ESC+"[1;"+(m+1)+"H":d?c.C0.ESC+"OH":c.C0.ESC+"[H";break;case 35:_.key=m?c.C0.ESC+"[1;"+(m+1)+"F":d?c.C0.ESC+"OF":c.C0.ESC+"[F";break;case 33:h.shiftKey?_.type=2:h.ctrlKey?_.key=c.C0.ESC+"[5;"+(m+1)+"~":_.key=c.C0.ESC+"[5~";break;case 34:h.shiftKey?_.type=3:h.ctrlKey?_.key=c.C0.ESC+"[6;"+(m+1)+"~":_.key=c.C0.ESC+"[6~";break;case 112:_.key=m?c.C0.ESC+"[1;"+(m+1)+"P":c.C0.ESC+"OP";break;case 113:_.key=m?c.C0.ESC+"[1;"+(m+1)+"Q":c.C0.ESC+"OQ";break;case 114:_.key=m?c.C0.ESC+"[1;"+(m+1)+"R":c.C0.ESC+"OR";break;case 115:_.key=m?c.C0.ESC+"[1;"+(m+1)+"S":c.C0.ESC+"OS";break;case 116:_.key=m?c.C0.ESC+"[15;"+(m+1)+"~":c.C0.ESC+"[15~";break;case 117:_.key=m?c.C0.ESC+"[17;"+(m+1)+"~":c.C0.ESC+"[17~";break;case 118:_.key=m?c.C0.ESC+"[18;"+(m+1)+"~":c.C0.ESC+"[18~";break;case 119:_.key=m?c.C0.ESC+"[19;"+(m+1)+"~":c.C0.ESC+"[19~";break;case 120:_.key=m?c.C0.ESC+"[20;"+(m+1)+"~":c.C0.ESC+"[20~";break;case 121:_.key=m?c.C0.ESC+"[21;"+(m+1)+"~":c.C0.ESC+"[21~";break;case 122:_.key=m?c.C0.ESC+"[23;"+(m+1)+"~":c.C0.ESC+"[23~";break;case 123:_.key=m?c.C0.ESC+"[24;"+(m+1)+"~":c.C0.ESC+"[24~";break;default:if(!h.ctrlKey||h.shiftKey||h.altKey||h.metaKey)if(f&&!g||!h.altKey||h.metaKey)!f||h.altKey||h.ctrlKey||h.shiftKey||!h.metaKey?h.key&&!h.ctrlKey&&!h.altKey&&!h.metaKey&&h.keyCode>=48&&h.key.length===1?_.key=h.key:h.key&&h.ctrlKey&&(h.key==="_"&&(_.key=c.C0.US),h.key==="@"&&(_.key=c.C0.NUL)):h.keyCode===65&&(_.type=1);else{const p=u[h.keyCode],y=p?.[h.shiftKey?1:0];if(y)_.key=c.C0.ESC+y;else if(h.keyCode>=65&&h.keyCode<=90){const b=h.ctrlKey?h.keyCode-64:h.keyCode+32;let v=String.fromCharCode(b);h.shiftKey&&(v=v.toUpperCase()),_.key=c.C0.ESC+v}else if(h.keyCode===32)_.key=c.C0.ESC+(h.ctrlKey?c.C0.NUL:" ");else if(h.key==="Dead"&&h.code.startsWith("Key")){let b=h.code.slice(3,4);h.shiftKey||(b=b.toLowerCase()),_.key=c.C0.ESC+b,_.cancel=!0}}else h.keyCode>=65&&h.keyCode<=90?_.key=String.fromCharCode(h.keyCode-64):h.keyCode===32?_.key=c.C0.NUL:h.keyCode>=51&&h.keyCode<=55?_.key=String.fromCharCode(h.keyCode-51+27):h.keyCode===56?_.key=c.C0.DEL:h.keyCode===219?_.key=c.C0.ESC:h.keyCode===220?_.key=c.C0.FS:h.keyCode===221&&(_.key=c.C0.GS)}return _}},482:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Utf8ToUtf32=a.StringToUtf32=a.utf32ToString=a.stringFromCodePoint=void 0,a.stringFromCodePoint=function(l){return l>65535?(l-=65536,String.fromCharCode(55296+(l>>10))+String.fromCharCode(l%1024+56320)):String.fromCharCode(l)},a.utf32ToString=function(l,c=0,u=l.length){let h="";for(let d=c;d<u;++d){let f=l[d];f>65535?(f-=65536,h+=String.fromCharCode(55296+(f>>10))+String.fromCharCode(f%1024+56320)):h+=String.fromCharCode(f)}return h},a.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(l,c){const u=l.length;if(!u)return 0;let h=0,d=0;if(this._interim){const f=l.charCodeAt(d++);56320<=f&&f<=57343?c[h++]=1024*(this._interim-55296)+f-56320+65536:(c[h++]=this._interim,c[h++]=f),this._interim=0}for(let f=d;f<u;++f){const g=l.charCodeAt(f);if(55296<=g&&g<=56319){if(++f>=u)return this._interim=g,h;const _=l.charCodeAt(f);56320<=_&&_<=57343?c[h++]=1024*(g-55296)+_-56320+65536:(c[h++]=g,c[h++]=_)}else g!==65279&&(c[h++]=g)}return h}},a.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(l,c){const u=l.length;if(!u)return 0;let h,d,f,g,_=0,m=0,p=0;if(this.interim[0]){let v=!1,w=this.interim[0];w&=(224&w)==192?31:(240&w)==224?15:7;let E,S=0;for(;(E=63&this.interim[++S])&&S<4;)w<<=6,w|=E;const x=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,C=x-S;for(;p<C;){if(p>=u)return 0;if(E=l[p++],(192&E)!=128){p--,v=!0;break}this.interim[S++]=E,w<<=6,w|=63&E}v||(x===2?w<128?p--:c[_++]=w:x===3?w<2048||w>=55296&&w<=57343||w===65279||(c[_++]=w):w<65536||w>1114111||(c[_++]=w)),this.interim.fill(0)}const y=u-4;let b=p;for(;b<u;){for(;!(!(b<y)||128&(h=l[b])||128&(d=l[b+1])||128&(f=l[b+2])||128&(g=l[b+3]));)c[_++]=h,c[_++]=d,c[_++]=f,c[_++]=g,b+=4;if(h=l[b++],h<128)c[_++]=h;else if((224&h)==192){if(b>=u)return this.interim[0]=h,_;if(d=l[b++],(192&d)!=128){b--;continue}if(m=(31&h)<<6|63&d,m<128){b--;continue}c[_++]=m}else if((240&h)==224){if(b>=u)return this.interim[0]=h,_;if(d=l[b++],(192&d)!=128){b--;continue}if(b>=u)return this.interim[0]=h,this.interim[1]=d,_;if(f=l[b++],(192&f)!=128){b--;continue}if(m=(15&h)<<12|(63&d)<<6|63&f,m<2048||m>=55296&&m<=57343||m===65279)continue;c[_++]=m}else if((248&h)==240){if(b>=u)return this.interim[0]=h,_;if(d=l[b++],(192&d)!=128){b--;continue}if(b>=u)return this.interim[0]=h,this.interim[1]=d,_;if(f=l[b++],(192&f)!=128){b--;continue}if(b>=u)return this.interim[0]=h,this.interim[1]=d,this.interim[2]=f,_;if(g=l[b++],(192&g)!=128){b--;continue}if(m=(7&h)<<18|(63&d)<<12|(63&f)<<6|63&g,m<65536||m>1114111)continue;c[_++]=m}}return _}}},225:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.UnicodeV6=void 0;const c=l(1480),u=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],h=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let d;a.UnicodeV6=class{constructor(){if(this.version="6",!d){d=new Uint8Array(65536),d.fill(1),d[0]=0,d.fill(0,1,32),d.fill(0,127,160),d.fill(2,4352,4448),d[9001]=2,d[9002]=2,d.fill(2,11904,42192),d[12351]=1,d.fill(2,44032,55204),d.fill(2,63744,64256),d.fill(2,65040,65050),d.fill(2,65072,65136),d.fill(2,65280,65377),d.fill(2,65504,65511);for(let f=0;f<u.length;++f)d.fill(0,u[f][0],u[f][1]+1)}}wcwidth(f){return f<32?0:f<127?1:f<65536?d[f]:function(g,_){let m,p=0,y=_.length-1;if(g<_[0][0]||g>_[y][1])return!1;for(;y>=p;)if(m=p+y>>1,g>_[m][1])p=m+1;else{if(!(g<_[m][0]))return!0;y=m-1}return!1}(f,h)?0:f>=131072&&f<=196605||f>=196608&&f<=262141?2:1}charProperties(f,g){let _=this.wcwidth(f),m=_===0&&g!==0;if(m){const p=c.UnicodeService.extractWidth(g);p===0?m=!1:p>_&&(_=p)}return c.UnicodeService.createPropertyValue(0,_,m)}}},5981:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.WriteBuffer=void 0;const c=l(8460),u=l(844);class h extends u.Disposable{constructor(f){super(),this._action=f,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(f,g){if(g!==void 0&&this._syncCalls>g)return void(this._syncCalls=0);if(this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let _;for(this._isSyncWriting=!0;_=this._writeBuffer.shift();){this._action(_);const m=this._callbacks.shift();m&&m()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(f,g){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(g),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=f.length,this._writeBuffer.push(f),this._callbacks.push(g)}_innerWrite(f=0,g=!0){const _=f||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const m=this._writeBuffer[this._bufferOffset],p=this._action(m,g);if(p){const b=v=>Date.now()-_>=12?setTimeout(()=>this._innerWrite(0,v)):this._innerWrite(_,v);return void p.catch(v=>(queueMicrotask(()=>{throw v}),Promise.resolve(!1))).then(b)}const y=this._callbacks[this._bufferOffset];if(y&&y(),this._bufferOffset++,this._pendingData-=m.length,Date.now()-_>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}a.WriteBuffer=h},5941:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.toRgbString=a.parseColor=void 0;const l=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,c=/^[\da-f]+$/;function u(h,d){const f=h.toString(16),g=f.length<2?"0"+f:f;switch(d){case 4:return f[0];case 8:return g;case 12:return(g+g).slice(0,3);default:return g+g}}a.parseColor=function(h){if(!h)return;let d=h.toLowerCase();if(d.indexOf("rgb:")===0){d=d.slice(4);const f=l.exec(d);if(f){const g=f[1]?15:f[4]?255:f[7]?4095:65535;return[Math.round(parseInt(f[1]||f[4]||f[7]||f[10],16)/g*255),Math.round(parseInt(f[2]||f[5]||f[8]||f[11],16)/g*255),Math.round(parseInt(f[3]||f[6]||f[9]||f[12],16)/g*255)]}}else if(d.indexOf("#")===0&&(d=d.slice(1),c.exec(d)&&[3,6,9,12].includes(d.length))){const f=d.length/3,g=[0,0,0];for(let _=0;_<3;++_){const m=parseInt(d.slice(f*_,f*_+f),16);g[_]=f===1?m<<4:f===2?m:f===3?m>>4:m>>8}return g}},a.toRgbString=function(h,d=16){const[f,g,_]=h;return`rgb:${u(f,d)}/${u(g,d)}/${u(_,d)}`}},5770:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.PAYLOAD_LIMIT=void 0,a.PAYLOAD_LIMIT=1e7},6351:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.DcsHandler=a.DcsParser=void 0;const c=l(482),u=l(8742),h=l(5770),d=[];a.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=d,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=d}registerHandler(g,_){this._handlers[g]===void 0&&(this._handlers[g]=[]);const m=this._handlers[g];return m.push(_),{dispose:()=>{const p=m.indexOf(_);p!==-1&&m.splice(p,1)}}}clearHandler(g){this._handlers[g]&&delete this._handlers[g]}setHandlerFallback(g){this._handlerFb=g}reset(){if(this._active.length)for(let g=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;g>=0;--g)this._active[g].unhook(!1);this._stack.paused=!1,this._active=d,this._ident=0}hook(g,_){if(this.reset(),this._ident=g,this._active=this._handlers[g]||d,this._active.length)for(let m=this._active.length-1;m>=0;m--)this._active[m].hook(_);else this._handlerFb(this._ident,"HOOK",_)}put(g,_,m){if(this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].put(g,_,m);else this._handlerFb(this._ident,"PUT",(0,c.utf32ToString)(g,_,m))}unhook(g,_=!0){if(this._active.length){let m=!1,p=this._active.length-1,y=!1;if(this._stack.paused&&(p=this._stack.loopPosition-1,m=_,y=this._stack.fallThrough,this._stack.paused=!1),!y&&m===!1){for(;p>=0&&(m=this._active[p].unhook(g),m!==!0);p--)if(m instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!1,m;p--}for(;p>=0;p--)if(m=this._active[p].unhook(!1),m instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=p,this._stack.fallThrough=!0,m}else this._handlerFb(this._ident,"UNHOOK",g);this._active=d,this._ident=0}};const f=new u.Params;f.addParam(0),a.DcsHandler=class{constructor(g){this._handler=g,this._data="",this._params=f,this._hitLimit=!1}hook(g){this._params=g.length>1||g.params[0]?g.clone():f,this._data="",this._hitLimit=!1}put(g,_,m){this._hitLimit||(this._data+=(0,c.utf32ToString)(g,_,m),this._data.length>h.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(g){let _=!1;if(this._hitLimit)_=!1;else if(g&&(_=this._handler(this._data,this._params),_ instanceof Promise))return _.then(m=>(this._params=f,this._data="",this._hitLimit=!1,m));return this._params=f,this._data="",this._hitLimit=!1,_}}},2015:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.EscapeSequenceParser=a.VT500_TRANSITION_TABLE=a.TransitionTable=void 0;const c=l(844),u=l(8742),h=l(6242),d=l(6351);class f{constructor(p){this.table=new Uint8Array(p)}setDefault(p,y){this.table.fill(p<<4|y)}add(p,y,b,v){this.table[y<<8|p]=b<<4|v}addMany(p,y,b,v){for(let w=0;w<p.length;w++)this.table[y<<8|p[w]]=b<<4|v}}a.TransitionTable=f;const g=160;a.VT500_TRANSITION_TABLE=function(){const m=new f(4095),p=Array.apply(null,Array(256)).map((S,x)=>x),y=(S,x)=>p.slice(S,x),b=y(32,127),v=y(0,24);v.push(25),v.push.apply(v,y(28,32));const w=y(0,14);let E;for(E in m.setDefault(1,0),m.addMany(b,0,2,0),w)m.addMany([24,26,153,154],E,3,0),m.addMany(y(128,144),E,3,0),m.addMany(y(144,152),E,3,0),m.add(156,E,0,0),m.add(27,E,11,1),m.add(157,E,4,8),m.addMany([152,158,159],E,0,7),m.add(155,E,11,3),m.add(144,E,11,9);return m.addMany(v,0,3,0),m.addMany(v,1,3,1),m.add(127,1,0,1),m.addMany(v,8,0,8),m.addMany(v,3,3,3),m.add(127,3,0,3),m.addMany(v,4,3,4),m.add(127,4,0,4),m.addMany(v,6,3,6),m.addMany(v,5,3,5),m.add(127,5,0,5),m.addMany(v,2,3,2),m.add(127,2,0,2),m.add(93,1,4,8),m.addMany(b,8,5,8),m.add(127,8,5,8),m.addMany([156,27,24,26,7],8,6,0),m.addMany(y(28,32),8,0,8),m.addMany([88,94,95],1,0,7),m.addMany(b,7,0,7),m.addMany(v,7,0,7),m.add(156,7,0,0),m.add(127,7,0,7),m.add(91,1,11,3),m.addMany(y(64,127),3,7,0),m.addMany(y(48,60),3,8,4),m.addMany([60,61,62,63],3,9,4),m.addMany(y(48,60),4,8,4),m.addMany(y(64,127),4,7,0),m.addMany([60,61,62,63],4,0,6),m.addMany(y(32,64),6,0,6),m.add(127,6,0,6),m.addMany(y(64,127),6,0,0),m.addMany(y(32,48),3,9,5),m.addMany(y(32,48),5,9,5),m.addMany(y(48,64),5,0,6),m.addMany(y(64,127),5,7,0),m.addMany(y(32,48),4,9,5),m.addMany(y(32,48),1,9,2),m.addMany(y(32,48),2,9,2),m.addMany(y(48,127),2,10,0),m.addMany(y(48,80),1,10,0),m.addMany(y(81,88),1,10,0),m.addMany([89,90,92],1,10,0),m.addMany(y(96,127),1,10,0),m.add(80,1,11,9),m.addMany(v,9,0,9),m.add(127,9,0,9),m.addMany(y(28,32),9,0,9),m.addMany(y(32,48),9,9,12),m.addMany(y(48,60),9,8,10),m.addMany([60,61,62,63],9,9,10),m.addMany(v,11,0,11),m.addMany(y(32,128),11,0,11),m.addMany(y(28,32),11,0,11),m.addMany(v,10,0,10),m.add(127,10,0,10),m.addMany(y(28,32),10,0,10),m.addMany(y(48,60),10,8,10),m.addMany([60,61,62,63],10,0,11),m.addMany(y(32,48),10,9,12),m.addMany(v,12,0,12),m.add(127,12,0,12),m.addMany(y(28,32),12,0,12),m.addMany(y(32,48),12,9,12),m.addMany(y(48,64),12,0,11),m.addMany(y(64,127),12,12,13),m.addMany(y(64,127),10,12,13),m.addMany(y(64,127),9,12,13),m.addMany(v,13,13,13),m.addMany(b,13,13,13),m.add(127,13,0,13),m.addMany([27,156,24,26],13,14,0),m.add(g,0,2,0),m.add(g,8,5,8),m.add(g,6,0,6),m.add(g,11,0,11),m.add(g,13,13,13),m}();class _ extends c.Disposable{constructor(p=a.VT500_TRANSITION_TABLE){super(),this._transitions=p,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new u.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(y,b,v)=>{},this._executeHandlerFb=y=>{},this._csiHandlerFb=(y,b)=>{},this._escHandlerFb=y=>{},this._errorHandlerFb=y=>y,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,c.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new h.OscParser),this._dcsParser=this.register(new d.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(p,y=[64,126]){let b=0;if(p.prefix){if(p.prefix.length>1)throw new Error("only one byte as prefix supported");if(b=p.prefix.charCodeAt(0),b&&60>b||b>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(p.intermediates){if(p.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let w=0;w<p.intermediates.length;++w){const E=p.intermediates.charCodeAt(w);if(32>E||E>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");b<<=8,b|=E}}if(p.final.length!==1)throw new Error("final must be a single byte");const v=p.final.charCodeAt(0);if(y[0]>v||v>y[1])throw new Error(`final must be in range ${y[0]} .. ${y[1]}`);return b<<=8,b|=v,b}identToString(p){const y=[];for(;p;)y.push(String.fromCharCode(255&p)),p>>=8;return y.reverse().join("")}setPrintHandler(p){this._printHandler=p}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(p,y){const b=this._identifier(p,[48,126]);this._escHandlers[b]===void 0&&(this._escHandlers[b]=[]);const v=this._escHandlers[b];return v.push(y),{dispose:()=>{const w=v.indexOf(y);w!==-1&&v.splice(w,1)}}}clearEscHandler(p){this._escHandlers[this._identifier(p,[48,126])]&&delete this._escHandlers[this._identifier(p,[48,126])]}setEscHandlerFallback(p){this._escHandlerFb=p}setExecuteHandler(p,y){this._executeHandlers[p.charCodeAt(0)]=y}clearExecuteHandler(p){this._executeHandlers[p.charCodeAt(0)]&&delete this._executeHandlers[p.charCodeAt(0)]}setExecuteHandlerFallback(p){this._executeHandlerFb=p}registerCsiHandler(p,y){const b=this._identifier(p);this._csiHandlers[b]===void 0&&(this._csiHandlers[b]=[]);const v=this._csiHandlers[b];return v.push(y),{dispose:()=>{const w=v.indexOf(y);w!==-1&&v.splice(w,1)}}}clearCsiHandler(p){this._csiHandlers[this._identifier(p)]&&delete this._csiHandlers[this._identifier(p)]}setCsiHandlerFallback(p){this._csiHandlerFb=p}registerDcsHandler(p,y){return this._dcsParser.registerHandler(this._identifier(p),y)}clearDcsHandler(p){this._dcsParser.clearHandler(this._identifier(p))}setDcsHandlerFallback(p){this._dcsParser.setHandlerFallback(p)}registerOscHandler(p,y){return this._oscParser.registerHandler(p,y)}clearOscHandler(p){this._oscParser.clearHandler(p)}setOscHandlerFallback(p){this._oscParser.setHandlerFallback(p)}setErrorHandler(p){this._errorHandler=p}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(p,y,b,v,w){this._parseStack.state=p,this._parseStack.handlers=y,this._parseStack.handlerPos=b,this._parseStack.transition=v,this._parseStack.chunkPos=w}parse(p,y,b){let v,w=0,E=0,S=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,S=this._parseStack.chunkPos+1;else{if(b===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const x=this._parseStack.handlers;let C=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(b===!1&&C>-1){for(;C>=0&&(v=x[C](this._params),v!==!0);C--)if(v instanceof Promise)return this._parseStack.handlerPos=C,v}this._parseStack.handlers=[];break;case 4:if(b===!1&&C>-1){for(;C>=0&&(v=x[C](),v!==!0);C--)if(v instanceof Promise)return this._parseStack.handlerPos=C,v}this._parseStack.handlers=[];break;case 6:if(w=p[this._parseStack.chunkPos],v=this._dcsParser.unhook(w!==24&&w!==26,b),v)return v;w===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(w=p[this._parseStack.chunkPos],v=this._oscParser.end(w!==24&&w!==26,b),v)return v;w===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,S=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let x=S;x<y;++x){switch(w=p[x],E=this._transitions.table[this.currentState<<8|(w<160?w:g)],E>>4){case 2:for(let D=x+1;;++D){if(D>=y||(w=p[D])<32||w>126&&w<g){this._printHandler(p,x,D),x=D-1;break}if(++D>=y||(w=p[D])<32||w>126&&w<g){this._printHandler(p,x,D),x=D-1;break}if(++D>=y||(w=p[D])<32||w>126&&w<g){this._printHandler(p,x,D),x=D-1;break}if(++D>=y||(w=p[D])<32||w>126&&w<g){this._printHandler(p,x,D),x=D-1;break}}break;case 3:this._executeHandlers[w]?this._executeHandlers[w]():this._executeHandlerFb(w),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:x,code:w,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const C=this._csiHandlers[this._collect<<8|w];let A=C?C.length-1:-1;for(;A>=0&&(v=C[A](this._params),v!==!0);A--)if(v instanceof Promise)return this._preserveStack(3,C,A,E,x),v;A<0&&this._csiHandlerFb(this._collect<<8|w,this._params),this.precedingJoinState=0;break;case 8:do switch(w){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(w-48)}while(++x<y&&(w=p[x])>47&&w<60);x--;break;case 9:this._collect<<=8,this._collect|=w;break;case 10:const M=this._escHandlers[this._collect<<8|w];let P=M?M.length-1:-1;for(;P>=0&&(v=M[P](),v!==!0);P--)if(v instanceof Promise)return this._preserveStack(4,M,P,E,x),v;P<0&&this._escHandlerFb(this._collect<<8|w),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|w,this._params);break;case 13:for(let D=x+1;;++D)if(D>=y||(w=p[D])===24||w===26||w===27||w>127&&w<g){this._dcsParser.put(p,x,D),x=D-1;break}break;case 14:if(v=this._dcsParser.unhook(w!==24&&w!==26),v)return this._preserveStack(6,[],0,E,x),v;w===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let D=x+1;;D++)if(D>=y||(w=p[D])<32||w>127&&w<g){this._oscParser.put(p,x,D),x=D-1;break}break;case 6:if(v=this._oscParser.end(w!==24&&w!==26),v)return this._preserveStack(5,[],0,E,x),v;w===27&&(E|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&E}}}a.EscapeSequenceParser=_},6242:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.OscHandler=a.OscParser=void 0;const c=l(5770),u=l(482),h=[];a.OscParser=class{constructor(){this._state=0,this._active=h,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(d,f){this._handlers[d]===void 0&&(this._handlers[d]=[]);const g=this._handlers[d];return g.push(f),{dispose:()=>{const _=g.indexOf(f);_!==-1&&g.splice(_,1)}}}clearHandler(d){this._handlers[d]&&delete this._handlers[d]}setHandlerFallback(d){this._handlerFb=d}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=h}reset(){if(this._state===2)for(let d=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;d>=0;--d)this._active[d].end(!1);this._stack.paused=!1,this._active=h,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||h,this._active.length)for(let d=this._active.length-1;d>=0;d--)this._active[d].start();else this._handlerFb(this._id,"START")}_put(d,f,g){if(this._active.length)for(let _=this._active.length-1;_>=0;_--)this._active[_].put(d,f,g);else this._handlerFb(this._id,"PUT",(0,u.utf32ToString)(d,f,g))}start(){this.reset(),this._state=1}put(d,f,g){if(this._state!==3){if(this._state===1)for(;f<g;){const _=d[f++];if(_===59){this._state=2,this._start();break}if(_<48||57<_)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+_-48}this._state===2&&g-f>0&&this._put(d,f,g)}}end(d,f=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let g=!1,_=this._active.length-1,m=!1;if(this._stack.paused&&(_=this._stack.loopPosition-1,g=f,m=this._stack.fallThrough,this._stack.paused=!1),!m&&g===!1){for(;_>=0&&(g=this._active[_].end(d),g!==!0);_--)if(g instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!1,g;_--}for(;_>=0;_--)if(g=this._active[_].end(!1),g instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!0,g}else this._handlerFb(this._id,"END",d);this._active=h,this._id=-1,this._state=0}}},a.OscHandler=class{constructor(d){this._handler=d,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(d,f,g){this._hitLimit||(this._data+=(0,u.utf32ToString)(d,f,g),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(d){let f=!1;if(this._hitLimit)f=!1;else if(d&&(f=this._handler(this._data),f instanceof Promise))return f.then(g=>(this._data="",this._hitLimit=!1,g));return this._data="",this._hitLimit=!1,f}}},8742:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.Params=void 0;const l=2147483647;class c{static fromArray(h){const d=new c;if(!h.length)return d;for(let f=Array.isArray(h[0])?1:0;f<h.length;++f){const g=h[f];if(Array.isArray(g))for(let _=0;_<g.length;++_)d.addSubParam(g[_]);else d.addParam(g)}return d}constructor(h=32,d=32){if(this.maxLength=h,this.maxSubParamsLength=d,d>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(h),this.length=0,this._subParams=new Int32Array(d),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(h),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const h=new c(this.maxLength,this.maxSubParamsLength);return h.params.set(this.params),h.length=this.length,h._subParams.set(this._subParams),h._subParamsLength=this._subParamsLength,h._subParamsIdx.set(this._subParamsIdx),h._rejectDigits=this._rejectDigits,h._rejectSubDigits=this._rejectSubDigits,h._digitIsSub=this._digitIsSub,h}toArray(){const h=[];for(let d=0;d<this.length;++d){h.push(this.params[d]);const f=this._subParamsIdx[d]>>8,g=255&this._subParamsIdx[d];g-f>0&&h.push(Array.prototype.slice.call(this._subParams,f,g))}return h}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(h){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(h<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=h>l?l:h}}addSubParam(h){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(h<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=h>l?l:h,this._subParamsIdx[this.length-1]++}}hasSubParams(h){return(255&this._subParamsIdx[h])-(this._subParamsIdx[h]>>8)>0}getSubParams(h){const d=this._subParamsIdx[h]>>8,f=255&this._subParamsIdx[h];return f-d>0?this._subParams.subarray(d,f):null}getSubParamsAll(){const h={};for(let d=0;d<this.length;++d){const f=this._subParamsIdx[d]>>8,g=255&this._subParamsIdx[d];g-f>0&&(h[d]=this._subParams.slice(f,g))}return h}addDigit(h){let d;if(this._rejectDigits||!(d=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const f=this._digitIsSub?this._subParams:this.params,g=f[d-1];f[d-1]=~g?Math.min(10*g+h,l):h}}a.Params=c},5741:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.AddonManager=void 0,a.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let l=this._addons.length-1;l>=0;l--)this._addons[l].instance.dispose()}loadAddon(l,c){const u={instance:c,dispose:c.dispose,isDisposed:!1};this._addons.push(u),c.dispose=()=>this._wrappedAddonDispose(u),c.activate(l)}_wrappedAddonDispose(l){if(l.isDisposed)return;let c=-1;for(let u=0;u<this._addons.length;u++)if(this._addons[u]===l){c=u;break}if(c===-1)throw new Error("Could not dispose an addon that has not been loaded");l.isDisposed=!0,l.dispose.apply(l.instance),this._addons.splice(c,1)}}},8771:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferApiView=void 0;const c=l(3785),u=l(511);a.BufferApiView=class{constructor(h,d){this._buffer=h,this.type=d}init(h){return this._buffer=h,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(h){const d=this._buffer.lines.get(h);if(d)return new c.BufferLineApiView(d)}getNullCell(){return new u.CellData}}},3785:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferLineApiView=void 0;const c=l(511);a.BufferLineApiView=class{constructor(u){this._line=u}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(u,h){if(!(u<0||u>=this._line.length))return h?(this._line.loadCell(u,h),h):this._line.loadCell(u,new c.CellData)}translateToString(u,h,d){return this._line.translateToString(u,h,d)}}},8285:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.BufferNamespaceApi=void 0;const c=l(8771),u=l(8460),h=l(844);class d extends h.Disposable{constructor(g){super(),this._core=g,this._onBufferChange=this.register(new u.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new c.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new c.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}a.BufferNamespaceApi=d},7975:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.ParserApi=void 0,a.ParserApi=class{constructor(l){this._core=l}registerCsiHandler(l,c){return this._core.registerCsiHandler(l,u=>c(u.toArray()))}addCsiHandler(l,c){return this.registerCsiHandler(l,c)}registerDcsHandler(l,c){return this._core.registerDcsHandler(l,(u,h)=>c(u,h.toArray()))}addDcsHandler(l,c){return this.registerDcsHandler(l,c)}registerEscHandler(l,c){return this._core.registerEscHandler(l,c)}addEscHandler(l,c){return this.registerEscHandler(l,c)}registerOscHandler(l,c){return this._core.registerOscHandler(l,c)}addOscHandler(l,c){return this.registerOscHandler(l,c)}}},7090:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.UnicodeApi=void 0,a.UnicodeApi=class{constructor(l){this._core=l}register(l){this._core.unicodeService.register(l)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(l){this._core.unicodeService.activeVersion=l}}},744:function(o,a,l){var c=this&&this.__decorate||function(m,p,y,b){var v,w=arguments.length,E=w<3?p:b===null?b=Object.getOwnPropertyDescriptor(p,y):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(m,p,y,b);else for(var S=m.length-1;S>=0;S--)(v=m[S])&&(E=(w<3?v(E):w>3?v(p,y,E):v(p,y))||E);return w>3&&E&&Object.defineProperty(p,y,E),E},u=this&&this.__param||function(m,p){return function(y,b){p(y,b,m)}};Object.defineProperty(a,"__esModule",{value:!0}),a.BufferService=a.MINIMUM_ROWS=a.MINIMUM_COLS=void 0;const h=l(8460),d=l(844),f=l(5295),g=l(2585);a.MINIMUM_COLS=2,a.MINIMUM_ROWS=1;let _=a.BufferService=class extends d.Disposable{get buffer(){return this.buffers.active}constructor(m){super(),this.isUserScrolling=!1,this._onResize=this.register(new h.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new h.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(m.rawOptions.cols||0,a.MINIMUM_COLS),this.rows=Math.max(m.rawOptions.rows||0,a.MINIMUM_ROWS),this.buffers=this.register(new f.BufferSet(m,this))}resize(m,p){this.cols=m,this.rows=p,this.buffers.resize(m,p),this._onResize.fire({cols:m,rows:p})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(m,p=!1){const y=this.buffer;let b;b=this._cachedBlankLine,b&&b.length===this.cols&&b.getFg(0)===m.fg&&b.getBg(0)===m.bg||(b=y.getBlankLine(m,p),this._cachedBlankLine=b),b.isWrapped=p;const v=y.ybase+y.scrollTop,w=y.ybase+y.scrollBottom;if(y.scrollTop===0){const E=y.lines.isFull;w===y.lines.length-1?E?y.lines.recycle().copyFrom(b):y.lines.push(b.clone()):y.lines.splice(w+1,0,b.clone()),E?this.isUserScrolling&&(y.ydisp=Math.max(y.ydisp-1,0)):(y.ybase++,this.isUserScrolling||y.ydisp++)}else{const E=w-v+1;y.lines.shiftElements(v+1,E-1,-1),y.lines.set(w,b.clone())}this.isUserScrolling||(y.ydisp=y.ybase),this._onScroll.fire(y.ydisp)}scrollLines(m,p,y){const b=this.buffer;if(m<0){if(b.ydisp===0)return;this.isUserScrolling=!0}else m+b.ydisp>=b.ybase&&(this.isUserScrolling=!1);const v=b.ydisp;b.ydisp=Math.max(Math.min(b.ydisp+m,b.ybase),0),v!==b.ydisp&&(p||this._onScroll.fire(b.ydisp))}};a.BufferService=_=c([u(0,g.IOptionsService)],_)},7994:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.CharsetService=void 0,a.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(l){this.glevel=l,this.charset=this._charsets[l]}setgCharset(l,c){this._charsets[l]=c,this.glevel===l&&(this.charset=c)}}},1753:function(o,a,l){var c=this&&this.__decorate||function(b,v,w,E){var S,x=arguments.length,C=x<3?v:E===null?E=Object.getOwnPropertyDescriptor(v,w):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(b,v,w,E);else for(var A=b.length-1;A>=0;A--)(S=b[A])&&(C=(x<3?S(C):x>3?S(v,w,C):S(v,w))||C);return x>3&&C&&Object.defineProperty(v,w,C),C},u=this&&this.__param||function(b,v){return function(w,E){v(w,E,b)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CoreMouseService=void 0;const h=l(2585),d=l(8460),f=l(844),g={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:b=>b.button!==4&&b.action===1&&(b.ctrl=!1,b.alt=!1,b.shift=!1,!0)},VT200:{events:19,restrict:b=>b.action!==32},DRAG:{events:23,restrict:b=>b.action!==32||b.button!==3},ANY:{events:31,restrict:b=>!0}};function _(b,v){let w=(b.ctrl?16:0)|(b.shift?4:0)|(b.alt?8:0);return b.button===4?(w|=64,w|=b.action):(w|=3&b.button,4&b.button&&(w|=64),8&b.button&&(w|=128),b.action===32?w|=32:b.action!==0||v||(w|=3)),w}const m=String.fromCharCode,p={DEFAULT:b=>{const v=[_(b,!1)+32,b.col+32,b.row+32];return v[0]>255||v[1]>255||v[2]>255?"":`\x1B[M${m(v[0])}${m(v[1])}${m(v[2])}`},SGR:b=>{const v=b.action===0&&b.button!==4?"m":"M";return`\x1B[<${_(b,!0)};${b.col};${b.row}${v}`},SGR_PIXELS:b=>{const v=b.action===0&&b.button!==4?"m":"M";return`\x1B[<${_(b,!0)};${b.x};${b.y}${v}`}};let y=a.CoreMouseService=class extends f.Disposable{constructor(b,v){super(),this._bufferService=b,this._coreService=v,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new d.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const w of Object.keys(g))this.addProtocol(w,g[w]);for(const w of Object.keys(p))this.addEncoding(w,p[w]);this.reset()}addProtocol(b,v){this._protocols[b]=v}addEncoding(b,v){this._encodings[b]=v}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(b){if(!this._protocols[b])throw new Error(`unknown protocol "${b}"`);this._activeProtocol=b,this._onProtocolChange.fire(this._protocols[b].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(b){if(!this._encodings[b])throw new Error(`unknown encoding "${b}"`);this._activeEncoding=b}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(b){if(b.col<0||b.col>=this._bufferService.cols||b.row<0||b.row>=this._bufferService.rows||b.button===4&&b.action===32||b.button===3&&b.action!==32||b.button!==4&&(b.action===2||b.action===3)||(b.col++,b.row++,b.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,b,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(b))return!1;const v=this._encodings[this._activeEncoding](b);return v&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(v):this._coreService.triggerDataEvent(v,!0)),this._lastEvent=b,!0}explainEvents(b){return{down:!!(1&b),up:!!(2&b),drag:!!(4&b),move:!!(8&b),wheel:!!(16&b)}}_equalEvents(b,v,w){if(w){if(b.x!==v.x||b.y!==v.y)return!1}else if(b.col!==v.col||b.row!==v.row)return!1;return b.button===v.button&&b.action===v.action&&b.ctrl===v.ctrl&&b.alt===v.alt&&b.shift===v.shift}};a.CoreMouseService=y=c([u(0,h.IBufferService),u(1,h.ICoreService)],y)},6975:function(o,a,l){var c=this&&this.__decorate||function(y,b,v,w){var E,S=arguments.length,x=S<3?b:w===null?w=Object.getOwnPropertyDescriptor(b,v):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")x=Reflect.decorate(y,b,v,w);else for(var C=y.length-1;C>=0;C--)(E=y[C])&&(x=(S<3?E(x):S>3?E(b,v,x):E(b,v))||x);return S>3&&x&&Object.defineProperty(b,v,x),x},u=this&&this.__param||function(y,b){return function(v,w){b(v,w,y)}};Object.defineProperty(a,"__esModule",{value:!0}),a.CoreService=void 0;const h=l(1439),d=l(8460),f=l(844),g=l(2585),_=Object.freeze({insertMode:!1}),m=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let p=a.CoreService=class extends f.Disposable{constructor(y,b,v){super(),this._bufferService=y,this._logService=b,this._optionsService=v,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new d.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new d.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new d.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new d.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,h.clone)(_),this.decPrivateModes=(0,h.clone)(m)}reset(){this.modes=(0,h.clone)(_),this.decPrivateModes=(0,h.clone)(m)}triggerDataEvent(y,b=!1){if(this._optionsService.rawOptions.disableStdin)return;const v=this._bufferService.buffer;b&&this._optionsService.rawOptions.scrollOnUserInput&&v.ybase!==v.ydisp&&this._onRequestScrollToBottom.fire(),b&&this._onUserInput.fire(),this._logService.debug(`sending data "${y}"`,()=>y.split("").map(w=>w.charCodeAt(0))),this._onData.fire(y)}triggerBinaryEvent(y){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${y}"`,()=>y.split("").map(b=>b.charCodeAt(0))),this._onBinary.fire(y))}};a.CoreService=p=c([u(0,g.IBufferService),u(1,g.ILogService),u(2,g.IOptionsService)],p)},9074:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.DecorationService=void 0;const c=l(8055),u=l(8460),h=l(844),d=l(6106);let f=0,g=0;class _ extends h.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new d.SortedList(y=>y?.marker.line),this._onDecorationRegistered=this.register(new u.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new u.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,h.toDisposable)(()=>this.reset()))}registerDecoration(y){if(y.marker.isDisposed)return;const b=new m(y);if(b){const v=b.marker.onDispose(()=>b.dispose());b.onDispose(()=>{b&&(this._decorations.delete(b)&&this._onDecorationRemoved.fire(b),v.dispose())}),this._decorations.insert(b),this._onDecorationRegistered.fire(b)}return b}reset(){for(const y of this._decorations.values())y.dispose();this._decorations.clear()}*getDecorationsAtCell(y,b,v){let w=0,E=0;for(const S of this._decorations.getKeyIterator(b))w=S.options.x??0,E=w+(S.options.width??1),y>=w&&y<E&&(!v||(S.options.layer??"bottom")===v)&&(yield S)}forEachDecorationAtCell(y,b,v,w){this._decorations.forEachByKey(b,E=>{f=E.options.x??0,g=f+(E.options.width??1),y>=f&&y<g&&(!v||(E.options.layer??"bottom")===v)&&w(E)})}}a.DecorationService=_;class m extends h.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=c.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=c.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(y){super(),this.options=y,this.onRenderEmitter=this.register(new u.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new u.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=y.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.InstantiationService=a.ServiceCollection=void 0;const c=l(2585),u=l(8343);class h{constructor(...f){this._entries=new Map;for(const[g,_]of f)this.set(g,_)}set(f,g){const _=this._entries.get(f);return this._entries.set(f,g),_}forEach(f){for(const[g,_]of this._entries.entries())f(g,_)}has(f){return this._entries.has(f)}get(f){return this._entries.get(f)}}a.ServiceCollection=h,a.InstantiationService=class{constructor(){this._services=new h,this._services.set(c.IInstantiationService,this)}setService(d,f){this._services.set(d,f)}getService(d){return this._services.get(d)}createInstance(d,...f){const g=(0,u.getServiceDependencies)(d).sort((p,y)=>p.index-y.index),_=[];for(const p of g){const y=this._services.get(p.id);if(!y)throw new Error(`[createInstance] ${d.name} depends on UNKNOWN service ${p.id}.`);_.push(y)}const m=g.length>0?g[0].index:f.length;if(f.length!==m)throw new Error(`[createInstance] First service dependency of ${d.name} at position ${m+1} conflicts with ${f.length} static arguments`);return new d(...f,..._)}}},7866:function(o,a,l){var c=this&&this.__decorate||function(m,p,y,b){var v,w=arguments.length,E=w<3?p:b===null?b=Object.getOwnPropertyDescriptor(p,y):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(m,p,y,b);else for(var S=m.length-1;S>=0;S--)(v=m[S])&&(E=(w<3?v(E):w>3?v(p,y,E):v(p,y))||E);return w>3&&E&&Object.defineProperty(p,y,E),E},u=this&&this.__param||function(m,p){return function(y,b){p(y,b,m)}};Object.defineProperty(a,"__esModule",{value:!0}),a.traceCall=a.setTraceLogger=a.LogService=void 0;const h=l(844),d=l(2585),f={trace:d.LogLevelEnum.TRACE,debug:d.LogLevelEnum.DEBUG,info:d.LogLevelEnum.INFO,warn:d.LogLevelEnum.WARN,error:d.LogLevelEnum.ERROR,off:d.LogLevelEnum.OFF};let g,_=a.LogService=class extends h.Disposable{get logLevel(){return this._logLevel}constructor(m){super(),this._optionsService=m,this._logLevel=d.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),g=this}_updateLogLevel(){this._logLevel=f[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(m){for(let p=0;p<m.length;p++)typeof m[p]=="function"&&(m[p]=m[p]())}_log(m,p,y){this._evalLazyOptionalParams(y),m.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+p,...y)}trace(m,...p){this._logLevel<=d.LogLevelEnum.TRACE&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,m,p)}debug(m,...p){this._logLevel<=d.LogLevelEnum.DEBUG&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,m,p)}info(m,...p){this._logLevel<=d.LogLevelEnum.INFO&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,m,p)}warn(m,...p){this._logLevel<=d.LogLevelEnum.WARN&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,m,p)}error(m,...p){this._logLevel<=d.LogLevelEnum.ERROR&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,m,p)}};a.LogService=_=c([u(0,d.IOptionsService)],_),a.setTraceLogger=function(m){g=m},a.traceCall=function(m,p,y){if(typeof y.value!="function")throw new Error("not supported");const b=y.value;y.value=function(...v){if(g.logLevel!==d.LogLevelEnum.TRACE)return b.apply(this,v);g.trace(`GlyphRenderer#${b.name}(${v.map(E=>JSON.stringify(E)).join(", ")})`);const w=b.apply(this,v);return g.trace(`GlyphRenderer#${b.name} return`,w),w}}},7302:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.OptionsService=a.DEFAULT_OPTIONS=void 0;const c=l(8460),u=l(844),h=l(6114);a.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:h.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const d=["normal","bold","100","200","300","400","500","600","700","800","900"];class f extends u.Disposable{constructor(_){super(),this._onOptionChange=this.register(new c.EventEmitter),this.onOptionChange=this._onOptionChange.event;const m={...a.DEFAULT_OPTIONS};for(const p in _)if(p in m)try{const y=_[p];m[p]=this._sanitizeAndValidateOption(p,y)}catch(y){console.error(y)}this.rawOptions=m,this.options={...m},this._setupOptions(),this.register((0,u.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(_,m){return this.onOptionChange(p=>{p===_&&m(this.rawOptions[_])})}onMultipleOptionChange(_,m){return this.onOptionChange(p=>{_.indexOf(p)!==-1&&m()})}_setupOptions(){const _=p=>{if(!(p in a.DEFAULT_OPTIONS))throw new Error(`No option with key "${p}"`);return this.rawOptions[p]},m=(p,y)=>{if(!(p in a.DEFAULT_OPTIONS))throw new Error(`No option with key "${p}"`);y=this._sanitizeAndValidateOption(p,y),this.rawOptions[p]!==y&&(this.rawOptions[p]=y,this._onOptionChange.fire(p))};for(const p in this.rawOptions){const y={get:_.bind(this,p),set:m.bind(this,p)};Object.defineProperty(this.options,p,y)}}_sanitizeAndValidateOption(_,m){switch(_){case"cursorStyle":if(m||(m=a.DEFAULT_OPTIONS[_]),!function(p){return p==="block"||p==="underline"||p==="bar"}(m))throw new Error(`"${m}" is not a valid value for ${_}`);break;case"wordSeparator":m||(m=a.DEFAULT_OPTIONS[_]);break;case"fontWeight":case"fontWeightBold":if(typeof m=="number"&&1<=m&&m<=1e3)break;m=d.includes(m)?m:a.DEFAULT_OPTIONS[_];break;case"cursorWidth":m=Math.floor(m);case"lineHeight":case"tabStopWidth":if(m<1)throw new Error(`${_} cannot be less than 1, value: ${m}`);break;case"minimumContrastRatio":m=Math.max(1,Math.min(21,Math.round(10*m)/10));break;case"scrollback":if((m=Math.min(m,4294967295))<0)throw new Error(`${_} cannot be less than 0, value: ${m}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(m<=0)throw new Error(`${_} cannot be less than or equal to 0, value: ${m}`);break;case"rows":case"cols":if(!m&&m!==0)throw new Error(`${_} must be numeric, value: ${m}`);break;case"windowsPty":m=m??{}}return m}}a.OptionsService=f},2660:function(o,a,l){var c=this&&this.__decorate||function(f,g,_,m){var p,y=arguments.length,b=y<3?g:m===null?m=Object.getOwnPropertyDescriptor(g,_):m;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(f,g,_,m);else for(var v=f.length-1;v>=0;v--)(p=f[v])&&(b=(y<3?p(b):y>3?p(g,_,b):p(g,_))||b);return y>3&&b&&Object.defineProperty(g,_,b),b},u=this&&this.__param||function(f,g){return function(_,m){g(_,m,f)}};Object.defineProperty(a,"__esModule",{value:!0}),a.OscLinkService=void 0;const h=l(2585);let d=a.OscLinkService=class{constructor(f){this._bufferService=f,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(f){const g=this._bufferService.buffer;if(f.id===void 0){const v=g.addMarker(g.ybase+g.y),w={data:f,id:this._nextId++,lines:[v]};return v.onDispose(()=>this._removeMarkerFromLink(w,v)),this._dataByLinkId.set(w.id,w),w.id}const _=f,m=this._getEntryIdKey(_),p=this._entriesWithId.get(m);if(p)return this.addLineToLink(p.id,g.ybase+g.y),p.id;const y=g.addMarker(g.ybase+g.y),b={id:this._nextId++,key:this._getEntryIdKey(_),data:_,lines:[y]};return y.onDispose(()=>this._removeMarkerFromLink(b,y)),this._entriesWithId.set(b.key,b),this._dataByLinkId.set(b.id,b),b.id}addLineToLink(f,g){const _=this._dataByLinkId.get(f);if(_&&_.lines.every(m=>m.line!==g)){const m=this._bufferService.buffer.addMarker(g);_.lines.push(m),m.onDispose(()=>this._removeMarkerFromLink(_,m))}}getLinkData(f){return this._dataByLinkId.get(f)?.data}_getEntryIdKey(f){return`${f.id};;${f.uri}`}_removeMarkerFromLink(f,g){const _=f.lines.indexOf(g);_!==-1&&(f.lines.splice(_,1),f.lines.length===0&&(f.data.id!==void 0&&this._entriesWithId.delete(f.key),this._dataByLinkId.delete(f.id)))}};a.OscLinkService=d=c([u(0,h.IBufferService)],d)},8343:(o,a)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.createDecorator=a.getServiceDependencies=a.serviceRegistry=void 0;const l="di$target",c="di$dependencies";a.serviceRegistry=new Map,a.getServiceDependencies=function(u){return u[c]||[]},a.createDecorator=function(u){if(a.serviceRegistry.has(u))return a.serviceRegistry.get(u);const h=function(d,f,g){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(_,m,p){m[l]===m?m[c].push({id:_,index:p}):(m[c]=[{id:_,index:p}],m[l]=m)})(h,d,g)};return h.toString=()=>u,a.serviceRegistry.set(u,h),h}},2585:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.IDecorationService=a.IUnicodeService=a.IOscLinkService=a.IOptionsService=a.ILogService=a.LogLevelEnum=a.IInstantiationService=a.ICharsetService=a.ICoreService=a.ICoreMouseService=a.IBufferService=void 0;const c=l(8343);var u;a.IBufferService=(0,c.createDecorator)("BufferService"),a.ICoreMouseService=(0,c.createDecorator)("CoreMouseService"),a.ICoreService=(0,c.createDecorator)("CoreService"),a.ICharsetService=(0,c.createDecorator)("CharsetService"),a.IInstantiationService=(0,c.createDecorator)("InstantiationService"),function(h){h[h.TRACE=0]="TRACE",h[h.DEBUG=1]="DEBUG",h[h.INFO=2]="INFO",h[h.WARN=3]="WARN",h[h.ERROR=4]="ERROR",h[h.OFF=5]="OFF"}(u||(a.LogLevelEnum=u={})),a.ILogService=(0,c.createDecorator)("LogService"),a.IOptionsService=(0,c.createDecorator)("OptionsService"),a.IOscLinkService=(0,c.createDecorator)("OscLinkService"),a.IUnicodeService=(0,c.createDecorator)("UnicodeService"),a.IDecorationService=(0,c.createDecorator)("DecorationService")},1480:(o,a,l)=>{Object.defineProperty(a,"__esModule",{value:!0}),a.UnicodeService=void 0;const c=l(8460),u=l(225);class h{static extractShouldJoin(f){return(1&f)!=0}static extractWidth(f){return f>>1&3}static extractCharKind(f){return f>>3}static createPropertyValue(f,g,_=!1){return(16777215&f)<<3|(3&g)<<1|(_?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new c.EventEmitter,this.onChange=this._onChange.event;const f=new u.UnicodeV6;this.register(f),this._active=f.version,this._activeProvider=f}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(f){if(!this._providers[f])throw new Error(`unknown Unicode version "${f}"`);this._active=f,this._activeProvider=this._providers[f],this._onChange.fire(f)}register(f){this._providers[f.version]=f}wcwidth(f){return this._activeProvider.wcwidth(f)}getStringCellWidth(f){let g=0,_=0;const m=f.length;for(let p=0;p<m;++p){let y=f.charCodeAt(p);if(55296<=y&&y<=56319){if(++p>=m)return g+this.wcwidth(y);const w=f.charCodeAt(p);56320<=w&&w<=57343?y=1024*(y-55296)+w-56320+65536:g+=this.wcwidth(w)}const b=this.charProperties(y,_);let v=h.extractWidth(b);h.extractShouldJoin(b)&&(v-=h.extractWidth(_)),g+=v,_=b}return g}charProperties(f,g){return this._activeProvider.charProperties(f,g)}}a.UnicodeService=h}},n={};function s(o){var a=n[o];if(a!==void 0)return a.exports;var l=n[o]={exports:{}};return r[o].call(l.exports,l,l.exports,s),l.exports}var i={};return(()=>{var o=i;Object.defineProperty(o,"__esModule",{value:!0}),o.Terminal=void 0;const a=s(9042),l=s(3236),c=s(844),u=s(5741),h=s(8285),d=s(7975),f=s(7090),g=["cols","rows"];class _ extends c.Disposable{constructor(p){super(),this._core=this.register(new l.Terminal(p)),this._addonManager=this.register(new u.AddonManager),this._publicOptions={...this._core.options};const y=v=>this._core.options[v],b=(v,w)=>{this._checkReadonlyOptions(v),this._core.options[v]=w};for(const v in this._core.options){const w={get:y.bind(this,v),set:b.bind(this,v)};Object.defineProperty(this._publicOptions,v,w)}}_checkReadonlyOptions(p){if(g.includes(p))throw new Error(`Option "${p}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new d.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new f.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new h.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const p=this._core.coreService.decPrivateModes;let y="none";switch(this._core.coreMouseService.activeProtocol){case"X10":y="x10";break;case"VT200":y="vt200";break;case"DRAG":y="drag";break;case"ANY":y="any"}return{applicationCursorKeysMode:p.applicationCursorKeys,applicationKeypadMode:p.applicationKeypad,bracketedPasteMode:p.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:y,originMode:p.origin,reverseWraparoundMode:p.reverseWraparound,sendFocusMode:p.sendFocus,wraparoundMode:p.wraparound}}get options(){return this._publicOptions}set options(p){for(const y in p)this._publicOptions[y]=p[y]}blur(){this._core.blur()}focus(){this._core.focus()}input(p,y=!0){this._core.input(p,y)}resize(p,y){this._verifyIntegers(p,y),this._core.resize(p,y)}open(p){this._core.open(p)}attachCustomKeyEventHandler(p){this._core.attachCustomKeyEventHandler(p)}attachCustomWheelEventHandler(p){this._core.attachCustomWheelEventHandler(p)}registerLinkProvider(p){return this._core.registerLinkProvider(p)}registerCharacterJoiner(p){return this._checkProposedApi(),this._core.registerCharacterJoiner(p)}deregisterCharacterJoiner(p){this._checkProposedApi(),this._core.deregisterCharacterJoiner(p)}registerMarker(p=0){return this._verifyIntegers(p),this._core.registerMarker(p)}registerDecoration(p){return this._checkProposedApi(),this._verifyPositiveIntegers(p.x??0,p.width??0,p.height??0),this._core.registerDecoration(p)}hasSelection(){return this._core.hasSelection()}select(p,y,b){this._verifyIntegers(p,y,b),this._core.select(p,y,b)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(p,y){this._verifyIntegers(p,y),this._core.selectLines(p,y)}dispose(){super.dispose()}scrollLines(p){this._verifyIntegers(p),this._core.scrollLines(p)}scrollPages(p){this._verifyIntegers(p),this._core.scrollPages(p)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(p){this._verifyIntegers(p),this._core.scrollToLine(p)}clear(){this._core.clear()}write(p,y){this._core.write(p,y)}writeln(p,y){this._core.write(p),this._core.write(`\r
`,y)}paste(p){this._core.paste(p)}refresh(p,y){this._verifyIntegers(p,y),this._core.refresh(p,y)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(p){this._addonManager.loadAddon(this,p)}static get strings(){return a}_verifyIntegers(...p){for(const y of p)if(y===1/0||isNaN(y)||y%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...p){for(const y of p)if(y&&(y===1/0||isNaN(y)||y%1!=0||y<0))throw new Error("This API only accepts positive integers")}}o.Terminal=_})(),i})())})(aV);var UPe=aV.exports;const $Pe=getComputedStyle(document.documentElement),Jt=t=>$Pe.getPropertyValue(t)||void 0;function Yw(t){return{cursor:Jt("--Terretacode-elements-terminal-cursorColor"),cursorAccent:Jt("--Terretacode-elements-terminal-cursorColorAccent"),foreground:Jt("--Terretacode-elements-terminal-textColor"),background:Jt("--Terretacode-elements-terminal-backgroundColor"),selectionBackground:Jt("--Terretacode-elements-terminal-selection-backgroundColor"),selectionForeground:Jt("--Terretacode-elements-terminal-selection-textColor"),selectionInactiveBackground:Jt("--Terretacode-elements-terminal-selection-backgroundColorInactive"),black:Jt("--Terretacode-elements-terminal-color-black"),red:Jt("--Terretacode-elements-terminal-color-red"),green:Jt("--Terretacode-elements-terminal-color-green"),yellow:Jt("--Terretacode-elements-terminal-color-yellow"),blue:Jt("--Terretacode-elements-terminal-color-blue"),magenta:Jt("--Terretacode-elements-terminal-color-magenta"),cyan:Jt("--Terretacode-elements-terminal-color-cyan"),white:Jt("--Terretacode-elements-terminal-color-white"),brightBlack:Jt("--Terretacode-elements-terminal-color-brightBlack"),brightRed:Jt("--Terretacode-elements-terminal-color-brightRed"),brightGreen:Jt("--Terretacode-elements-terminal-color-brightGreen"),brightYellow:Jt("--Terretacode-elements-terminal-color-brightYellow"),brightBlue:Jt("--Terretacode-elements-terminal-color-brightBlue"),brightMagenta:Jt("--Terretacode-elements-terminal-color-brightMagenta"),brightCyan:Jt("--Terretacode-elements-terminal-color-brightCyan"),brightWhite:Jt("--Terretacode-elements-terminal-color-brightWhite"),...t}}const HPe=Fn("Terminal"),jL=I.memo(I.forwardRef(({className:t,theme:e,readonly:r,id:n,onTerminalReady:s,onTerminalResize:i},o)=>{const a=I.useRef(null),l=I.useRef();return I.useEffect(()=>{const c=a.current,u=new FPe.FitAddon,h=new jPe.WebLinksAddon,d=new UPe.Terminal({cursorBlink:!0,convertEol:!0,disableStdin:r,theme:Yw(r?{cursor:"#00000000"}:{}),fontSize:12,fontFamily:"Menlo, courier-new, courier, monospace"});l.current=d,d.loadAddon(u),d.loadAddon(h),d.open(c);const f=new ResizeObserver(()=>{u.fit(),i?.(d.cols,d.rows)});return f.observe(c),HPe.debug(`Attach [${n}]`),s?.(d),()=>{f.disconnect(),d.dispose()}},[]),I.useEffect(()=>{const c=l.current;c.options.theme=Yw(r?{cursor:"#00000000"}:{}),c.options.disableStdin=r},[e,r]),I.useImperativeHandle(o,()=>({reloadStyles:()=>{const c=l.current;c.options.theme=Yw(r?{cursor:"#00000000"}:{})}}),[]),T.jsx("div",{className:t,ref:a})})),zPe=Fn("Terminal"),UL=3,NS=25,VPe=I.memo(()=>{const t=wt(Ze.showTerminal),e=wt(w0),r=I.useRef([]),n=I.useRef(null),s=I.useRef(!1),[i,o]=I.useState(0),[a,l]=I.useState(1),c=()=>{a<UL&&(l(a+1),o(a))};return I.useEffect(()=>{const{current:u}=n;if(!u)return;const h=u.isCollapsed();!t&&!h?u.collapse():t&&h&&u.resize(NS),s.current=!1},[t]),I.useEffect(()=>{const u=A$.on("toggleTerminal",()=>{s.current=!0}),h=w0.subscribe(()=>{for(const d of Object.values(r.current))d?.reloadStyles()});return()=>{u(),h()}},[]),T.jsx(Fd,{ref:n,defaultSize:t?NS:0,minSize:10,collapsible:!0,onExpand:()=>{s.current||Ze.toggleTerminal(!0)},onCollapse:()=>{s.current||Ze.toggleTerminal(!1)},children:T.jsx("div",{className:"h-full",children:T.jsxs("div",{className:"bg-Terretacode-elements-terminals-background h-full flex flex-col",children:[T.jsxs("div",{className:"flex items-center bg-Terretacode-elements-background-depth-2 border-y border-Terretacode-elements-borderColor gap-1.5 min-h-[34px] p-2",children:[Array.from({length:a+1},(u,h)=>{const d=i===h;return T.jsx(at.Fragment,{children:h==0?T.jsxs("button",{className:qe("flex items-center text-sm cursor-pointer gap-1.5 px-3 py-2 h-full whitespace-nowrap rounded-full",{"bg-Terretacode-elements-terminals-buttonBackground text-Terretacode-elements-textSecondary hover:text-Terretacode-elements-textPrimary":d,"bg-Terretacode-elements-background-depth-2 text-Terretacode-elements-textSecondary hover:bg-Terretacode-elements-terminals-buttonBackground":!d}),onClick:()=>o(h),children:[T.jsx("div",{className:"i-ph:terminal-window-duotone text-lg"}),"Terretacode Terminal"]},h):T.jsx(at.Fragment,{children:T.jsxs("button",{className:qe("flex items-center text-sm cursor-pointer gap-1.5 px-3 py-2 h-full whitespace-nowrap rounded-full",{"bg-Terretacode-elements-terminals-buttonBackground text-Terretacode-elements-textPrimary":d,"bg-Terretacode-elements-background-depth-2 text-Terretacode-elements-textSecondary hover:bg-Terretacode-elements-terminals-buttonBackground":!d}),onClick:()=>o(h),children:[T.jsx("div",{className:"i-ph:terminal-window-duotone text-lg"}),"Terminal ",a>1&&h]},h)})},h)}),a<UL&&T.jsx(cr,{icon:"i-ph:plus",size:"md",onClick:c}),T.jsx(cr,{className:"ml-auto",icon:"i-ph:caret-down",title:"Close",size:"md",onClick:()=>Ze.toggleTerminal(!1)})]}),Array.from({length:a+1},(u,h)=>{const d=i===h;return zPe.debug(`Starting Terretacode terminal [${h}]`),h==0?T.jsx(jL,{id:`terminal_${h}`,className:qe("h-full overflow-hidden",{hidden:!d}),ref:f=>{r.current.push(f)},onTerminalReady:f=>Ze.attachTerretacodeTerminal(f),onTerminalResize:(f,g)=>Ze.onTerminalResize(f,g),theme:e},h):T.jsx(jL,{id:`terminal_${h}`,className:qe("h-full overflow-hidden",{hidden:!d}),ref:f=>{r.current.push(f)},onTerminalReady:f=>Ze.attachTerminal(f),onTerminalResize:(f,g)=>Ze.onTerminalResize(f,g),theme:e},h)})]})})})}),GPe=100-NS,WPe={tabSize:2},qPe=I.memo(({files:t,unsavedFiles:e,editorDocument:r,selectedFile:n,isStreaming:s,onFileSelect:i,onEditorChange:o,onEditorScroll:a,onFileSave:l,onFileReset:c})=>{Xu.trace("EditorPanel");const u=wt(w0),h=wt(Ze.showTerminal),d=I.useMemo(()=>{if(r)return r.filePath.split("/")},[r]),f=I.useMemo(()=>r!==void 0&&e?.has(r.filePath),[r,e]);return T.jsxs(IS,{direction:"vertical",children:[T.jsx(Fd,{defaultSize:h?GPe:100,minSize:20,children:T.jsxs(IS,{direction:"horizontal",children:[T.jsx(Fd,{defaultSize:20,minSize:10,collapsible:!0,children:T.jsxs("div",{className:"flex flex-col border-r border-Terretacode-elements-borderColor h-full",children:[T.jsxs(ML,{children:[T.jsx("div",{className:"i-ph:tree-structure-duotone shrink-0"}),"Files"]}),T.jsx(rV,{className:"h-full",files:t,hideRoot:!0,unsavedFiles:e,rootFolder:ya,selectedFile:n,onFileSelect:i})]})}),T.jsx(PS,{}),T.jsxs(Fd,{className:"flex flex-col",defaultSize:80,minSize:20,children:[T.jsx(ML,{className:"overflow-x-auto",children:d?.length&&T.jsxs("div",{className:"flex items-center flex-1 text-sm",children:[T.jsx(BPe,{pathSegments:d,files:t,onFileSelect:i}),f&&T.jsxs("div",{className:"flex gap-1 ml-auto -mr-1.5",children:[T.jsxs(qc,{onClick:l,children:[T.jsx("div",{className:"i-ph:floppy-disk-duotone"}),"Save"]}),T.jsxs(qc,{onClick:c,children:[T.jsx("div",{className:"i-ph:clock-counter-clockwise-duotone"}),"Reset"]})]})]})}),T.jsx("div",{className:"h-full flex-1 overflow-hidden",children:T.jsx(k7,{theme:u,editable:!s&&r!==void 0,settings:WPe,doc:r,autoFocusOnDocumentChange:!MRe(),onScroll:a,onChange:o,onSave:l})})]})]})}),T.jsx(PS,{}),T.jsx(VPe,{})]})}),KPe=I.memo(({activePreviewIndex:t,setActivePreviewIndex:e,isDropdownOpen:r,setIsDropdownOpen:n,setHasSelectedPreview:s,previews:i})=>{const o=I.useRef(null),a=i.map((l,c)=>({...l,index:c})).sort((l,c)=>l.port-c.port);return I.useEffect(()=>{const l=c=>{o.current&&!o.current.contains(c.target)&&n(!1)};return r?window.addEventListener("mousedown",l):window.removeEventListener("mousedown",l),()=>{window.removeEventListener("mousedown",l)}},[r]),T.jsxs("div",{className:"relative z-port-dropdown",ref:o,children:[T.jsx(cr,{icon:"i-ph:plug",onClick:()=>n(!r)}),r&&T.jsxs("div",{className:"absolute right-0 mt-2 bg-Terretacode-elements-background-depth-2 border border-Terretacode-elements-borderColor rounded shadow-sm min-w-[140px] dropdown-animation",children:[T.jsx("div",{className:"px-4 py-2 border-b border-Terretacode-elements-borderColor text-sm font-semibold text-Terretacode-elements-textPrimary",children:"Ports"}),a.map(l=>T.jsx("div",{className:"flex items-center px-4 py-2 cursor-pointer hover:bg-Terretacode-elements-item-backgroundActive",onClick:()=>{e(l.index),n(!1),s(!0)},children:T.jsx("span",{className:t===l.index?"text-Terretacode-elements-item-contentAccent":"text-Terretacode-elements-item-contentDefault group-hover:text-Terretacode-elements-item-contentActive",children:l.port})},l.port))]})]})}),YPe=I.memo(({isSelectionMode:t,setIsSelectionMode:e,containerRef:r})=>{const[n,s]=I.useState(!1),[i,o]=I.useState(null),[a,l]=I.useState(null),c=I.useRef(null),u=I.useRef(null);I.useEffect(()=>()=>{u.current&&(u.current.pause(),u.current.srcObject=null,u.current.remove(),u.current=null),c.current&&(c.current.getTracks().forEach(_=>_.stop()),c.current=null)},[]);const h=async()=>{if(!c.current)try{const _=await navigator.mediaDevices.getDisplayMedia({audio:!1,video:{displaySurface:"window",preferCurrentTab:!0,surfaceSwitching:"include",systemAudio:"exclude"}});if(_.addEventListener("inactive",()=>{u.current&&(u.current.pause(),u.current.srcObject=null,u.current.remove(),u.current=null),c.current&&(c.current.getTracks().forEach(m=>m.stop()),c.current=null),e(!1),o(null),l(null),s(!1)}),c.current=_,!u.current){const m=document.createElement("video");m.style.opacity="0",m.style.position="fixed",m.style.pointerEvents="none",m.style.zIndex="-1",document.body.appendChild(m),u.current=m}u.current.srcObject=_,await u.current.play()}catch(_){console.error("Failed to initialize stream:",_),e(!1),Ne.error("Failed to initialize screen capture")}return c.current},d=I.useCallback(async()=>{if(!(!t||!i||!a||!r.current)){s(!0);try{if(!await h()||!u.current)return;await new Promise(q=>setTimeout(q,300));const m=document.createElement("canvas");m.width=u.current.videoWidth,m.height=u.current.videoHeight;const p=m.getContext("2d");if(!p)throw new Error("Failed to get temporary canvas context");p.drawImage(u.current,0,0);const y=u.current.videoWidth/window.innerWidth,b=u.current.videoHeight/window.innerHeight,v=window.scrollX,w=window.scrollY+40,E=r.current.getBoundingClientRect(),S=-9,x=-14,C=Math.round((E.left+Math.min(i.x,a.x)+v+S)*y),A=Math.round((E.top+Math.min(i.y,a.y)+w+x)*b),M=Math.round(Math.abs(a.x-i.x)*y),P=Math.round(Math.abs(a.y-i.y)*b),D=document.createElement("canvas");D.width=Math.round(Math.abs(a.x-i.x)),D.height=Math.round(Math.abs(a.y-i.y));const R=D.getContext("2d");if(!R)throw new Error("Failed to get canvas context");R.drawImage(m,C,A,M,P,0,0,D.width,D.height);const G=await new Promise((q,re)=>{D.toBlob(N=>{N?q(N):re(new Error("Failed to create blob"))},"image/png")}),ee=new FileReader;ee.onload=q=>{const re=q.target?.result;if(document.querySelector("textarea")){const B=window.__Terretacode_SET_UPLOADED_FILES__,$=window.__Terretacode_SET_IMAGE_DATA_LIST__,H=window.__Terretacode_UPLOADED_FILES__||[],U=window.__Terretacode_IMAGE_DATA_LIST__||[];if(B&&$){const Q=new File([G],"screenshot.png",{type:"image/png"});B([...H,Q]),$([...U,re]),Ne.success("Screenshot captured and added to chat")}else Ne.error("Could not add screenshot to chat")}},ee.readAsDataURL(G)}catch(_){console.error("Failed to capture screenshot:",_),Ne.error("Failed to capture screenshot"),c.current&&(c.current.getTracks().forEach(m=>m.stop()),c.current=null)}finally{s(!1),o(null),l(null),e(!1)}}},[t,i,a,r,e]),f=I.useCallback(_=>{if(_.preventDefault(),_.stopPropagation(),!t)return;const m=_.currentTarget.getBoundingClientRect(),p=_.clientX-m.left,y=_.clientY-m.top;o({x:p,y}),l({x:p,y})},[t]),g=I.useCallback(_=>{if(_.preventDefault(),_.stopPropagation(),!t||!i)return;const m=_.currentTarget.getBoundingClientRect(),p=_.clientX-m.left,y=_.clientY-m.top;l({x:p,y})},[t,i]);return t?T.jsx("div",{className:"absolute inset-0 cursor-crosshair",onMouseDown:f,onMouseMove:g,onMouseUp:d,onMouseLeave:()=>{i&&o(null)},style:{backgroundColor:n?"transparent":"rgba(0, 0, 0, 0.1)",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"all",opacity:n?0:1,zIndex:50,transition:"opacity 0.1s ease-in-out"},children:i&&a&&!n&&T.jsx("div",{className:"absolute border-2 border-blue-500 bg-blue-200 bg-opacity-20",style:{left:Math.min(i.x,a.x),top:Math.min(i.y,a.y),width:Math.abs(a.x-i.x),height:Math.abs(a.y-i.y)}})}):null}),XPe=I.memo(()=>{const t=I.useRef(null),e=I.useRef(null),r=I.useRef(null),[n,s]=I.useState(0),[i,o]=I.useState(!1),[a,l]=I.useState(!1),c=I.useRef(!1),u=wt(Ze.previews),h=u[n],[d,f]=I.useState(""),[g,_]=I.useState(),[m,p]=I.useState(!1),[y,b]=I.useState(!1),[v,w]=I.useState(37.5),E=I.useRef({isResizing:!1,side:null,startX:0,startWidthPercent:37.5,windowWidth:window.innerWidth}),S=2;I.useEffect(()=>{if(!h){f(""),_(void 0);return}const{baseUrl:q}=h;f(q),_(q)},[h]);const x=I.useCallback(q=>{if(!h)return!1;const{baseUrl:re}=h;return q===re?!0:q.startsWith(re)?["/","?","#"].includes(q.charAt(re.length)):!1},[h]),C=I.useCallback((q,re,N,B)=>re.port<B[q].port?N:q,[]);I.useEffect(()=>{if(u.length>1&&!c.current){const q=u.reduce(C,0);s(q)}},[u,C]);const A=()=>{t.current&&(t.current.src=t.current.src)},M=async()=>{!a&&e.current?await e.current.requestFullscreen():document.fullscreenElement&&await document.exitFullscreen()};I.useEffect(()=>{const q=()=>{l(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",q),()=>{document.removeEventListener("fullscreenchange",q)}},[]);const P=()=>{b(q=>!q)},D=(q,re)=>{y&&(document.body.style.userSelect="none",E.current.isResizing=!0,E.current.side=re,E.current.startX=q.clientX,E.current.startWidthPercent=v,E.current.windowWidth=window.innerWidth,document.addEventListener("mousemove",R),document.addEventListener("mouseup",G),q.preventDefault())},R=q=>{if(!E.current.isResizing)return;const re=q.clientX-E.current.startX,N=E.current.windowWidth,B=re/N*100*S;let $=E.current.startWidthPercent;E.current.side==="right"?$=E.current.startWidthPercent+B:E.current.side==="left"&&($=E.current.startWidthPercent-B),$=Math.max(10,Math.min($,90)),w($)},G=()=>{E.current.isResizing=!1,E.current.side=null,document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",G),document.body.style.userSelect=""};I.useEffect(()=>{const q=()=>{};return window.addEventListener("resize",q),()=>{window.removeEventListener("resize",q)}},[]);const ee=()=>T.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%",pointerEvents:"none"},children:T.jsx("div",{style:{color:"rgba(0,0,0,0.5)",fontSize:"10px",lineHeight:"5px",userSelect:"none",marginLeft:"1px"},children:"••• •••"})});return T.jsxs("div",{ref:e,className:"w-full h-full flex flex-col relative",children:[i&&T.jsx("div",{className:"z-iframe-overlay w-full h-full absolute",onClick:()=>o(!1)}),T.jsxs("div",{className:"bg-Terretacode-elements-background-depth-2 p-2 flex items-center gap-1.5",children:[T.jsx(cr,{icon:"i-ph:arrow-clockwise",onClick:A}),T.jsx(cr,{icon:"i-ph:selection",onClick:()=>p(!m),className:m?"bg-Terretacode-elements-background-depth-3":""}),T.jsx("div",{className:`flex items-center gap-1 flex-grow bg-Terretacode-elements-preview-addressBar-background border border-Terretacode-elements-borderColor text-Terretacode-elements-preview-addressBar-text rounded-full px-3 py-1 text-sm hover:bg-Terretacode-elements-preview-addressBar-backgroundHover hover:focus-within:bg-Terretacode-elements-preview-addressBar-backgroundActive focus-within:bg-Terretacode-elements-preview-addressBar-backgroundActive
        focus-within-border-Terretacode-elements-borderColorActive focus-within:text-Terretacode-elements-preview-addressBar-textActive`,children:T.jsx("input",{title:"URL",ref:r,className:"w-full bg-transparent outline-none",type:"text",value:d,onChange:q=>{f(q.target.value)},onKeyDown:q=>{q.key==="Enter"&&x(d)&&(_(d),r.current&&r.current.blur())}})}),u.length>1&&T.jsx(KPe,{activePreviewIndex:n,setActivePreviewIndex:s,isDropdownOpen:i,setHasSelectedPreview:q=>c.current=q,setIsDropdownOpen:o,previews:u}),T.jsx(cr,{icon:"i-ph:devices",onClick:P,title:y?"Switch to Responsive Mode":"Switch to Device Mode"}),T.jsx(cr,{icon:a?"i-ph:arrows-in":"i-ph:arrows-out",onClick:M,title:a?"Exit Full Screen":"Full Screen"})]}),T.jsx("div",{className:"flex-1 border-t border-Terretacode-elements-borderColor flex justify-center items-center overflow-auto",children:T.jsxs("div",{style:{width:y?`${v}%`:"100%",height:"100%",overflow:"visible",background:"#fff",position:"relative",display:"flex"},children:[h?T.jsxs(T.Fragment,{children:[T.jsx("iframe",{ref:t,title:"preview",className:"border-none w-full h-full bg-white",src:g,allowFullScreen:!0}),T.jsx(YPe,{isSelectionMode:m,setIsSelectionMode:p,containerRef:t})]}):T.jsx("div",{className:"flex w-full h-full justify-center items-center bg-white",children:"No preview available"}),y&&T.jsxs(T.Fragment,{children:[T.jsx("div",{onMouseDown:q=>D(q,"left"),style:{position:"absolute",top:0,left:0,width:"15px",marginLeft:"-15px",height:"100%",cursor:"ew-resize",background:"rgba(255,255,255,.2)",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s",userSelect:"none"},onMouseOver:q=>q.currentTarget.style.background="rgba(255,255,255,.5)",onMouseOut:q=>q.currentTarget.style.background="rgba(255,255,255,.2)",title:"Drag to resize width",children:T.jsx(ee,{})}),T.jsx("div",{onMouseDown:q=>D(q,"right"),style:{position:"absolute",top:0,right:0,width:"15px",marginRight:"-15px",height:"100%",cursor:"ew-resize",background:"rgba(255,255,255,.2)",display:"flex",alignItems:"center",justifyContent:"center",transition:"background 0.2s",userSelect:"none"},onMouseOver:q=>q.currentTarget.style.background="rgba(255,255,255,.5)",onMouseOut:q=>q.currentTarget.style.background="rgba(255,255,255,.2)",title:"Drag to resize width",children:T.jsx(ee,{})})]})]})})]})}),ZPe={ease:Ss},JPe={left:{value:"code",text:"Code"},right:{value:"preview",text:"Preview"}},QPe={closed:{width:0,transition:{duration:.2,ease:Ss}},open:{width:"var(--workbench-width)",transition:{duration:.2,ease:Ss}}},eOe=I.memo(({chatStarted:t,isStreaming:e})=>{Xu.trace("Workbench");const[r,n]=I.useState(!1),s=wt(xT(Ze.previews,b=>b.length>0)),i=wt(Ze.showWorkbench),o=wt(Ze.selectedFile),a=wt(Ze.currentDocument),l=wt(Ze.unsavedFiles),c=wt(Ze.files),u=wt(Ze.currentView),h=I$(1024),d=b=>{Ze.currentView.set(b)};I.useEffect(()=>{s&&d("preview")},[s]),I.useEffect(()=>{Ze.setDocuments(c)},[c]);const f=I.useCallback(b=>{Ze.setCurrentDocumentContent(b.content)},[]),g=I.useCallback(b=>{Ze.setCurrentDocumentScrollPosition(b)},[]),_=I.useCallback(b=>{Ze.setSelectedFile(b)},[]),m=I.useCallback(()=>{Ze.saveCurrentDocument().catch(()=>{Ne.error("Failed to update file content")})},[]),p=I.useCallback(()=>{Ze.resetCurrentDocument()},[]),y=I.useCallback(async()=>{n(!0);try{const b=await window.showDirectoryPicker();await Ze.syncFiles(b),Ne.success("Files synced successfully")}catch(b){console.error("Error syncing files:",b),Ne.error("Failed to sync files")}finally{n(!1)}},[]);return t&&T.jsx(yr.div,{initial:"closed",animate:i?"open":"closed",variants:QPe,className:"z-workbench",children:T.jsx("div",{className:qe("fixed top-[calc(var(--header-height)+1.5rem)] bottom-6 w-[var(--workbench-inner-width)] mr-4 z-0 transition-[left,width] duration-200 Terretacode-ease-cubic-bezier",{"w-full":h,"left-0":i&&h,"left-[var(--workbench-left)]":i,"left-[100%]":!i}),children:T.jsx("div",{className:"absolute inset-0 px-2 lg:px-6",children:T.jsxs("div",{className:"h-full flex flex-col bg-Terretacode-elements-background-depth-2 border border-Terretacode-elements-borderColor shadow-sm rounded-lg overflow-hidden",children:[T.jsxs("div",{className:"flex items-center px-3 py-2 border-b border-Terretacode-elements-borderColor",children:[T.jsx(iRe,{selected:u,options:JPe,setSelected:d}),T.jsx("div",{className:"ml-auto"}),u==="code"&&T.jsxs("div",{className:"flex overflow-y-auto",children:[T.jsxs(qc,{className:"mr-1 text-sm",onClick:()=>{Ze.downloadZip()},children:[T.jsx("div",{className:"i-ph:code"}),"Download Code"]}),T.jsxs(qc,{className:"mr-1 text-sm",onClick:y,disabled:r,children:[r?T.jsx("div",{className:"i-ph:spinner"}):T.jsx("div",{className:"i-ph:cloud-arrow-down"}),r?"Syncing...":"Sync Files"]}),T.jsxs(qc,{className:"mr-1 text-sm",onClick:()=>{Ze.toggleTerminal(!Ze.showTerminal.get())},children:[T.jsx("div",{className:"i-ph:terminal"}),"Toggle Terminal"]}),T.jsxs(qc,{className:"mr-1 text-sm",onClick:()=>{const b=prompt("Please enter a name for your new GitHub repository:","Terretacode-generated-project");if(!b){alert("Repository name is required. Push to GitHub cancelled.");return}const v=Ke.get("githubUsername"),w=Ke.get("githubToken");if(!v||!w){const E=prompt("Please enter your GitHub username:"),S=prompt("Please enter your GitHub personal access token:");if(!E||!S){alert("GitHub username and token are required. Push to GitHub cancelled.");return}Ze.pushToGitHub(b,E,S)}else Ze.pushToGitHub(b,v,w)},children:[T.jsx("div",{className:"i-ph:github-logo"}),"Push to GitHub"]})]}),T.jsx(cr,{icon:"i-ph:x-circle",className:"-mr-1",size:"xl",onClick:()=>{Ze.showWorkbench.set(!1)}})]}),T.jsxs("div",{className:"relative flex-1 overflow-hidden",children:[T.jsx($L,{initial:{x:u==="code"?0:"-100%"},animate:{x:u==="code"?0:"-100%"},children:T.jsx(qPe,{editorDocument:a,isStreaming:e,selectedFile:o,files:c,unsavedFiles:l,onFileSelect:_,onEditorScroll:g,onEditorChange:f,onFileSave:m,onFileReset:p})}),T.jsx($L,{initial:{x:u==="preview"?0:"100%"},animate:{x:u==="preview"?0:"100%"},children:T.jsx(XPe,{})})]})]})})})})}),$L=I.memo(({children:t,...e})=>T.jsx(yr.div,{className:"absolute inset-0",transition:ZPe,...e,children:t})),tOe=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,rOe=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,nOe={};function HL(t,e){return(nOe.jsx?rOe:tOe).test(t)}const sOe=/[ \t\n\f\r]/g;function Wb(t){return typeof t=="object"?t.type==="text"?zL(t.value):!1:zL(t)}function zL(t){return t.replace(sOe,"")===""}var cV={},VL=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,iOe=/\n/g,oOe=/^\s*/,aOe=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,lOe=/^:\s*/,cOe=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,uOe=/^[;\s]*/,hOe=/^\s+|\s+$/g,dOe=`
`,GL="/",WL="*",ll="",fOe="comment",pOe="declaration",mOe=function(t,e){if(typeof t!="string")throw new TypeError("First argument must be a string");if(!t)return[];e=e||{};var r=1,n=1;function s(g){var _=g.match(iOe);_&&(r+=_.length);var m=g.lastIndexOf(dOe);n=~m?g.length-m:n+g.length}function i(){var g={line:r,column:n};return function(_){return _.position=new o(g),c(),_}}function o(g){this.start=g,this.end={line:r,column:n},this.source=e.source}o.prototype.content=t;function a(g){var _=new Error(e.source+":"+r+":"+n+": "+g);if(_.reason=g,_.filename=e.source,_.line=r,_.column=n,_.source=t,!e.silent)throw _}function l(g){var _=g.exec(t);if(_){var m=_[0];return s(m),t=t.slice(m.length),_}}function c(){l(oOe)}function u(g){var _;for(g=g||[];_=h();)_!==!1&&g.push(_);return g}function h(){var g=i();if(!(GL!=t.charAt(0)||WL!=t.charAt(1))){for(var _=2;ll!=t.charAt(_)&&(WL!=t.charAt(_)||GL!=t.charAt(_+1));)++_;if(_+=2,ll===t.charAt(_-1))return a("End of comment missing");var m=t.slice(2,_-2);return n+=2,s(m),t=t.slice(_),n+=2,g({type:fOe,comment:m})}}function d(){var g=i(),_=l(aOe);if(_){if(h(),!l(lOe))return a("property missing ':'");var m=l(cOe),p=g({type:pOe,property:qL(_[0].replace(VL,ll)),value:m?qL(m[0].replace(VL,ll)):ll});return l(uOe),p}}function f(){var g=[];u(g);for(var _;_=d();)_!==!1&&(g.push(_),u(g));return g}return c(),f()};function qL(t){return t?t.replace(hOe,ll):ll}var gOe=hn&&hn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(cV,"__esModule",{value:!0});var KL=cV.default=yOe,_Oe=gOe(mOe);function yOe(t,e){var r=null;if(!t||typeof t!="string")return r;var n=(0,_Oe.default)(t),s=typeof e=="function";return n.forEach(function(i){if(i.type==="declaration"){var o=i.property,a=i.value;s?e(o,a,i):a&&(r=r||{},r[o]=a)}}),r}const bOe=KL.default||KL;function jd(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?YL(t.position):"start"in t||"end"in t?YL(t):"line"in t||"column"in t?MS(t):""}function MS(t){return XL(t&&t.line)+":"+XL(t&&t.column)}function YL(t){return MS(t&&t.start)+"-"+MS(t&&t.end)}function XL(t){return t&&typeof t=="number"?t:1}class on extends Error{constructor(e,r,n){super(),typeof r=="string"&&(n=r,r=void 0);let s="",i={},o=!1;if(r&&("line"in r&&"column"in r?i={place:r}:"start"in r&&"end"in r?i={place:r}:"type"in r?i={ancestors:[r],place:r.position}:i={...r}),typeof e=="string"?s=e:!i.cause&&e&&(o=!0,s=e.message,i.cause=e),!i.ruleId&&!i.source&&typeof n=="string"){const l=n.indexOf(":");l===-1?i.ruleId=n:(i.source=n.slice(0,l),i.ruleId=n.slice(l+1))}if(!i.place&&i.ancestors&&i.ancestors){const l=i.ancestors[i.ancestors.length-1];l&&(i.place=l.position)}const a=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=a?a.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=a?a.line:void 0,this.name=jd(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=o&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}on.prototype.file="";on.prototype.name="";on.prototype.reason="";on.prototype.message="";on.prototype.stack="";on.prototype.column=void 0;on.prototype.line=void 0;on.prototype.ancestors=void 0;on.prototype.cause=void 0;on.prototype.fatal=void 0;on.prototype.place=void 0;on.prototype.ruleId=void 0;on.prototype.source=void 0;const IA={}.hasOwnProperty,vOe=new Map,wOe=/[A-Z]/g,EOe=/-([a-z])/g,xOe=new Set(["table","tbody","thead","tfoot","tr"]),SOe=new Set(["td","th"]),uV="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function TOe(t,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const r=e.filePath||void 0;let n;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");n=DOe(r,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");n=OOe(r,e.jsx,e.jsxs)}const s={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:n,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:r,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?Vi:sh,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},i=hV(s,t,void 0);return i&&typeof i!="string"?i:s.create(t,s.Fragment,{children:i||void 0},void 0)}function hV(t,e,r){if(e.type==="element")return COe(t,e,r);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return kOe(t,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return ROe(t,e,r);if(e.type==="mdxjsEsm")return AOe(t,e);if(e.type==="root")return IOe(t,e,r);if(e.type==="text")return POe(t,e)}function COe(t,e,r){const n=t.schema;let s=n;e.tagName.toLowerCase()==="svg"&&n.space==="html"&&(s=Vi,t.schema=s),t.ancestors.push(e);const i=fV(t,e.tagName,!1),o=LOe(t,e);let a=OA(t,e);return xOe.has(e.tagName)&&(a=a.filter(function(l){return typeof l=="string"?!Wb(l):!0})),dV(t,o,i,e),PA(o,a),t.ancestors.pop(),t.schema=n,t.create(e,i,o,r)}function kOe(t,e){if(e.data&&e.data.estree&&t.evaluater){const n=e.data.estree.body[0];return n.type,t.evaluater.evaluateExpression(n.expression)}Vf(t,e.position)}function AOe(t,e){if(e.data&&e.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(e.data.estree);Vf(t,e.position)}function ROe(t,e,r){const n=t.schema;let s=n;e.name==="svg"&&n.space==="html"&&(s=Vi,t.schema=s),t.ancestors.push(e);const i=e.name===null?t.Fragment:fV(t,e.name,!0),o=NOe(t,e),a=OA(t,e);return dV(t,o,i,e),PA(o,a),t.ancestors.pop(),t.schema=n,t.create(e,i,o,r)}function IOe(t,e,r){const n={};return PA(n,OA(t,e)),t.create(e,t.Fragment,n,r)}function POe(t,e){return e.value}function dV(t,e,r,n){typeof r!="string"&&r!==t.Fragment&&t.passNode&&(e.node=n)}function PA(t,e){if(e.length>0){const r=e.length>1?e:e[0];r&&(t.children=r)}}function OOe(t,e,r){return n;function n(s,i,o,a){const c=Array.isArray(o.children)?r:e;return a?c(i,o,a):c(i,o)}}function DOe(t,e){return r;function r(n,s,i,o){const a=Array.isArray(i.children),l=Gi(n);return e(s,i,o,a,{columnNumber:l?l.column-1:void 0,fileName:t,lineNumber:l?l.line:void 0},void 0)}}function LOe(t,e){const r={};let n,s;for(s in e.properties)if(s!=="children"&&IA.call(e.properties,s)){const i=MOe(t,s,e.properties[s]);if(i){const[o,a]=i;t.tableCellAlignToStyle&&o==="align"&&typeof a=="string"&&SOe.has(e.tagName)?n=a:r[o]=a}}if(n){const i=r.style||(r.style={});i[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=n}return r}function NOe(t,e){const r={};for(const n of e.attributes)if(n.type==="mdxJsxExpressionAttribute")if(n.data&&n.data.estree&&t.evaluater){const i=n.data.estree.body[0];i.type;const o=i.expression;o.type;const a=o.properties[0];a.type,Object.assign(r,t.evaluater.evaluateExpression(a.argument))}else Vf(t,e.position);else{const s=n.name;let i;if(n.value&&typeof n.value=="object")if(n.value.data&&n.value.data.estree&&t.evaluater){const a=n.value.data.estree.body[0];a.type,i=t.evaluater.evaluateExpression(a.expression)}else Vf(t,e.position);else i=n.value===null?!0:n.value;r[s]=i}return r}function OA(t,e){const r=[];let n=-1;const s=t.passKeys?new Map:vOe;for(;++n<e.children.length;){const i=e.children[n];let o;if(t.passKeys){const l=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(l){const c=s.get(l)||0;o=l+"-"+c,s.set(l,c+1)}}const a=hV(t,i,o);a!==void 0&&r.push(a)}return r}function MOe(t,e,r){const n=kp(t.schema,e);if(!(r==null||typeof r=="number"&&Number.isNaN(r))){if(Array.isArray(r)&&(r=n.commaSeparated?ak(r):lk(r)),n.property==="style"){let s=typeof r=="object"?r:BOe(t,String(r));return t.stylePropertyNameCase==="css"&&(s=FOe(s)),["style",s]}return[t.elementAttributeNameCase==="react"&&n.space?Gpe[n.property]||n.property:n.attribute,r]}}function BOe(t,e){const r={};try{bOe(e,n)}catch(s){if(!t.ignoreInvalidStyle){const i=s,o=new on("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw o.file=t.filePath||void 0,o.url=uV+"#cannot-parse-style-attribute",o}}return r;function n(s,i){let o=s;o.slice(0,2)!=="--"&&(o.slice(0,4)==="-ms-"&&(o="ms-"+o.slice(4)),o=o.replace(EOe,UOe)),r[o]=i}}function fV(t,e,r){let n;if(!r)n={type:"Literal",value:e};else if(e.includes(".")){const s=e.split(".");let i=-1,o;for(;++i<s.length;){const a=HL(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};o=o?{type:"MemberExpression",object:o,property:a,computed:!!(i&&a.type==="Literal"),optional:!1}:a}n=o}else n=HL(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(n.type==="Literal"){const s=n.value;return IA.call(t.components,s)?t.components[s]:s}if(t.evaluater)return t.evaluater.evaluateExpression(n);Vf(t)}function Vf(t,e){const r=new on("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw r.file=t.filePath||void 0,r.url=uV+"#cannot-handle-mdx-estrees-without-createevaluater",r}function FOe(t){const e={};let r;for(r in t)IA.call(t,r)&&(e[jOe(r)]=t[r]);return e}function jOe(t){let e=t.replace(wOe,$Oe);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function UOe(t,e){return e.toUpperCase()}function $Oe(t){return"-"+t.toLowerCase()}const Xw={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},HOe={tokenize:zOe};function zOe(t){const e=t.attempt(this.parser.constructs.contentInitial,n,s);let r;return e;function n(a){if(a===null){t.consume(a);return}return t.enter("lineEnding"),t.consume(a),t.exit("lineEnding"),xt(t,e,"linePrefix")}function s(a){return t.enter("paragraph"),i(a)}function i(a){const l=t.enter("chunkText",{contentType:"text",previous:r});return r&&(r.next=l),r=l,o(a)}function o(a){if(a===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(a);return}return Qe(a)?(t.consume(a),t.exit("chunkText"),i):(t.consume(a),o)}}const VOe={tokenize:GOe},ZL={tokenize:WOe};function GOe(t){const e=this,r=[];let n=0,s,i,o;return a;function a(b){if(n<r.length){const v=r[n];return e.containerState=v[1],t.attempt(v[0].continuation,l,c)(b)}return c(b)}function l(b){if(n++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,s&&y();const v=e.events.length;let w=v,E;for(;w--;)if(e.events[w][0]==="exit"&&e.events[w][1].type==="chunkFlow"){E=e.events[w][1].end;break}p(n);let S=v;for(;S<e.events.length;)e.events[S][1].end={...E},S++;return Xn(e.events,w+1,0,e.events.slice(v)),e.events.length=S,c(b)}return a(b)}function c(b){if(n===r.length){if(!s)return d(b);if(s.currentConstruct&&s.currentConstruct.concrete)return g(b);e.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(ZL,u,h)(b)}function u(b){return s&&y(),p(n),d(b)}function h(b){return e.parser.lazy[e.now().line]=n!==r.length,o=e.now().offset,g(b)}function d(b){return e.containerState={},t.attempt(ZL,f,g)(b)}function f(b){return n++,r.push([e.currentConstruct,e.containerState]),d(b)}function g(b){if(b===null){s&&y(),p(0),t.consume(b);return}return s=s||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),_(b)}function _(b){if(b===null){m(t.exit("chunkFlow"),!0),p(0),t.consume(b);return}return Qe(b)?(t.consume(b),m(t.exit("chunkFlow")),n=0,e.interrupt=void 0,a):(t.consume(b),_)}function m(b,v){const w=e.sliceStream(b);if(v&&w.push(null),b.previous=i,i&&(i.next=b),i=b,s.defineSkip(b.start),s.write(w),e.parser.lazy[b.start.line]){let E=s.events.length;for(;E--;)if(s.events[E][1].start.offset<o&&(!s.events[E][1].end||s.events[E][1].end.offset>o))return;const S=e.events.length;let x=S,C,A;for(;x--;)if(e.events[x][0]==="exit"&&e.events[x][1].type==="chunkFlow"){if(C){A=e.events[x][1].end;break}C=!0}for(p(n),E=S;E<e.events.length;)e.events[E][1].end={...A},E++;Xn(e.events,x+1,0,e.events.slice(S)),e.events.length=E}}function p(b){let v=r.length;for(;v-- >b;){const w=r[v];e.containerState=w[1],w[0].exit.call(e,t)}r.length=b}function y(){s.write([null]),i=void 0,s=void 0,e.containerState._closeFlow=void 0}}function WOe(t,e,r){return xt(t,t.attempt(this.parser.constructs.document,e,r),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}const qOe={tokenize:KOe};function KOe(t){const e=this,r=t.attempt(Pp,n,t.attempt(this.parser.constructs.flowInitial,s,xt(t,t.attempt(this.parser.constructs.flow,s,t.attempt(Abe,s)),"linePrefix")));return r;function n(i){if(i===null){t.consume(i);return}return t.enter("lineEndingBlank"),t.consume(i),t.exit("lineEndingBlank"),e.currentConstruct=void 0,r}function s(i){if(i===null){t.consume(i);return}return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),e.currentConstruct=void 0,r}}const YOe={resolveAll:mV()},XOe=pV("string"),ZOe=pV("text");function pV(t){return{resolveAll:mV(t==="text"?JOe:void 0),tokenize:e};function e(r){const n=this,s=this.parser.constructs[t],i=r.attempt(s,o,a);return o;function o(u){return c(u)?i(u):a(u)}function a(u){if(u===null){r.consume(u);return}return r.enter("data"),r.consume(u),l}function l(u){return c(u)?(r.exit("data"),i(u)):(r.consume(u),l)}function c(u){if(u===null)return!0;const h=s[u];let d=-1;if(h)for(;++d<h.length;){const f=h[d];if(!f.previous||f.previous.call(n,n.previous))return!0}return!1}}}function mV(t){return e;function e(r,n){let s=-1,i;for(;++s<=r.length;)i===void 0?r[s]&&r[s][1].type==="data"&&(i=s,s++):(!r[s]||r[s][1].type!=="data")&&(s!==i+2&&(r[i][1].end=r[s-1][1].end,r.splice(i+2,s-i-2),s=i+2),i=void 0);return t?t(r,n):r}}function JOe(t,e){let r=0;for(;++r<=t.length;)if((r===t.length||t[r][1].type==="lineEnding")&&t[r-1][1].type==="data"){const n=t[r-1][1],s=e.sliceStream(n);let i=s.length,o=-1,a=0,l;for(;i--;){const c=s[i];if(typeof c=="string"){for(o=c.length;c.charCodeAt(o-1)===32;)a++,o--;if(o)break;o=-1}else if(c===-2)l=!0,a++;else if(c!==-1){i++;break}}if(a){const c={type:r===t.length||l||a<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?o:n.start._bufferIndex+o,_index:n.start._index+i,line:n.end.line,column:n.end.column-a,offset:n.end.offset-a},end:{...n.end}};n.end={...c.start},n.start.offset===n.end.offset?Object.assign(n,c):(t.splice(r,0,["enter",c,e],["exit",c,e]),r+=2)}r++}return t}const QOe={42:Tn,43:Tn,45:Tn,48:Tn,49:Tn,50:Tn,51:Tn,52:Tn,53:Tn,54:Tn,55:Tn,56:Tn,57:Tn,62:UU},eDe={91:Dbe},tDe={[-2]:bw,[-1]:bw,32:bw},rDe={35:jbe,42:t0,45:[mO,t0],60:zbe,61:mO,95:t0,96:fO,126:fO},nDe={38:HU,92:$U},sDe={[-5]:vw,[-4]:vw,[-3]:vw,33:ave,38:HU,42:Ax,60:[cbe,Xbe],91:cve,92:[Bbe,$U],93:wk,95:Ax,96:Ebe},iDe={null:[Ax,YOe]},oDe={null:[42,95]},aDe={null:[]},lDe=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:oDe,contentInitial:eDe,disable:aDe,document:QOe,flow:rDe,flowInitial:tDe,insideSpan:iDe,string:nDe,text:sDe},Symbol.toStringTag,{value:"Module"}));function cDe(t,e,r){let n={_bufferIndex:-1,_index:0,line:r&&r.line||1,column:r&&r.column||1,offset:r&&r.offset||0};const s={},i=[];let o=[],a=[];const l={attempt:S(w),check:S(E),consume:y,enter:b,exit:v,interrupt:S(E,{interrupt:!0})},c={code:null,containerState:{},defineSkip:_,events:[],now:g,parser:t,previous:null,sliceSerialize:d,sliceStream:f,write:h};let u=e.tokenize.call(c,l);return e.resolveAll&&i.push(e),c;function h(M){return o=fs(o,M),m(),o[o.length-1]!==null?[]:(x(e,0),c.events=gb(i,c.events,c),c.events)}function d(M,P){return hDe(f(M),P)}function f(M){return uDe(o,M)}function g(){const{_bufferIndex:M,_index:P,line:D,column:R,offset:G}=n;return{_bufferIndex:M,_index:P,line:D,column:R,offset:G}}function _(M){s[M.line]=M.column,A()}function m(){let M;for(;n._index<o.length;){const P=o[n._index];if(typeof P=="string")for(M=n._index,n._bufferIndex<0&&(n._bufferIndex=0);n._index===M&&n._bufferIndex<P.length;)p(P.charCodeAt(n._bufferIndex));else p(P)}}function p(M){u=u(M)}function y(M){Qe(M)?(n.line++,n.column=1,n.offset+=M===-3?2:1,A()):M!==-1&&(n.column++,n.offset++),n._bufferIndex<0?n._index++:(n._bufferIndex++,n._bufferIndex===o[n._index].length&&(n._bufferIndex=-1,n._index++)),c.previous=M}function b(M,P){const D=P||{};return D.type=M,D.start=g(),c.events.push(["enter",D,c]),a.push(D),D}function v(M){const P=a.pop();return P.end=g(),c.events.push(["exit",P,c]),P}function w(M,P){x(M,P.from)}function E(M,P){P.restore()}function S(M,P){return D;function D(R,G,ee){let q,re,N,B;return Array.isArray(R)?H(R):"tokenize"in R?H([R]):$(R);function $(ge){return J;function J(V){const fe=V!==null&&ge[V],de=V!==null&&ge.null,be=[...Array.isArray(fe)?fe:fe?[fe]:[],...Array.isArray(de)?de:de?[de]:[]];return H(be)(V)}}function H(ge){return q=ge,re=0,ge.length===0?ee:U(ge[re])}function U(ge){return J;function J(V){return B=C(),N=ge,ge.partial||(c.currentConstruct=ge),ge.name&&c.parser.constructs.disable.null.includes(ge.name)?ne():ge.tokenize.call(P?Object.assign(Object.create(c),P):c,l,Q,ne)(V)}}function Q(ge){return M(N,B),G}function ne(ge){return B.restore(),++re<q.length?U(q[re]):ee}}}function x(M,P){M.resolveAll&&!i.includes(M)&&i.push(M),M.resolve&&Xn(c.events,P,c.events.length-P,M.resolve(c.events.slice(P),c)),M.resolveTo&&(c.events=M.resolveTo(c.events,c))}function C(){const M=g(),P=c.previous,D=c.currentConstruct,R=c.events.length,G=Array.from(a);return{from:R,restore:ee};function ee(){n=M,c.previous=P,c.currentConstruct=D,c.events.length=R,a=G,A()}}function A(){n.line in s&&n.column<2&&(n.column=s[n.line],n.offset+=s[n.line]-1)}}function uDe(t,e){const r=e.start._index,n=e.start._bufferIndex,s=e.end._index,i=e.end._bufferIndex;let o;if(r===s)o=[t[r].slice(n,i)];else{if(o=t.slice(r,s),n>-1){const a=o[0];typeof a=="string"?o[0]=a.slice(n):o.shift()}i>0&&o.push(t[s].slice(0,i))}return o}function hDe(t,e){let r=-1;const n=[];let s;for(;++r<t.length;){const i=t[r];let o;if(typeof i=="string")o=i;else switch(i){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=e?" ":"	";break}case-1:{if(!e&&s)continue;o=" ";break}default:o=String.fromCharCode(i)}s=i===-2,n.push(o)}return n.join("")}function dDe(t){const n={constructs:PU([lDe,...(t||{}).extensions||[]]),content:s(HOe),defined:[],document:s(VOe),flow:s(qOe),lazy:{},string:s(XOe),text:s(ZOe)};return n;function s(i){return o;function o(a){return cDe(n,i,a)}}}function fDe(t){for(;!zU(t););return t}const JL=/[\0\t\n\r]/g;function pDe(){let t=1,e="",r=!0,n;return s;function s(i,o,a){const l=[];let c,u,h,d,f;for(i=e+(typeof i=="string"?i.toString():new TextDecoder(o||void 0).decode(i)),h=0,e="",r&&(i.charCodeAt(0)===65279&&h++,r=void 0);h<i.length;){if(JL.lastIndex=h,c=JL.exec(i),d=c&&c.index!==void 0?c.index:i.length,f=i.charCodeAt(d),!c){e=i.slice(h);break}if(f===10&&h===d&&n)l.push(-3),n=void 0;else switch(n&&(l.push(-5),n=void 0),h<d&&(l.push(i.slice(h,d)),t+=d-h),f){case 0:{l.push(65533),t++;break}case 9:{for(u=Math.ceil(t/4)*4,l.push(-2);t++<u;)l.push(-1);break}case 10:{l.push(-4),t=1;break}default:n=!0,t=1}h=d+1}return a&&(n&&l.push(-5),e&&l.push(e),l.push(null)),l}}const gV={}.hasOwnProperty;function mDe(t,e,r){return typeof e!="string"&&(r=e,e=void 0),gDe(r)(fDe(dDe(r).document().write(pDe()(t,e,!0))))}function gDe(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(ae),autolinkProtocol:C,autolinkEmail:C,atxHeading:i(oe),blockQuote:i(de),characterEscape:C,characterReference:C,codeFenced:i(be),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:i(be,o),codeText:i(me,o),codeTextData:C,data:C,codeFlowValue:C,definition:i(ve),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:i(L),hardBreakEscape:i(ie),hardBreakTrailing:i(ie),htmlFlow:i(W,o),htmlFlowData:C,htmlText:i(W,o),htmlTextData:C,image:i(K),label:o,link:i(ae),listItem:i(Te),listItemValue:d,listOrdered:i(xe,h),listUnordered:i(xe),paragraph:i(le),reference:U,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:i(oe),strong:i(Se),thematicBreak:i(Ce)},exit:{atxHeading:l(),atxHeadingSequence:w,autolink:l(),autolinkEmail:fe,autolinkProtocol:V,blockQuote:l(),characterEscapeValue:A,characterReferenceMarkerHexadecimal:ne,characterReferenceMarkerNumeric:ne,characterReferenceValue:ge,characterReference:J,codeFenced:l(m),codeFencedFence:_,codeFencedFenceInfo:f,codeFencedFenceMeta:g,codeFlowValue:A,codeIndented:l(p),codeText:l(G),codeTextData:A,data:A,definition:l(),definitionDestinationString:v,definitionLabelString:y,definitionTitleString:b,emphasis:l(),hardBreakEscape:l(P),hardBreakTrailing:l(P),htmlFlow:l(D),htmlFlowData:A,htmlText:l(R),htmlTextData:A,image:l(q),label:N,labelText:re,lineEnding:M,link:l(ee),listItem:l(),listOrdered:l(),listUnordered:l(),paragraph:l(),referenceString:Q,resourceDestinationString:B,resourceTitleString:$,resource:H,setextHeading:l(x),setextHeadingLineSequence:S,setextHeadingText:E,strong:l(),thematicBreak:l()}};_V(e,(t||{}).mdastExtensions||[]);const r={};return n;function n(he){let ke={type:"root",children:[]};const Ie={stack:[ke],tokenStack:[],config:e,enter:a,exit:c,buffer:o,resume:u,data:r},Ye=[];let z=-1;for(;++z<he.length;)if(he[z][1].type==="listOrdered"||he[z][1].type==="listUnordered")if(he[z][0]==="enter")Ye.push(z);else{const O=Ye.pop();z=s(he,O,z)}for(z=-1;++z<he.length;){const O=e[he[z][0]];gV.call(O,he[z][1].type)&&O[he[z][1].type].call(Object.assign({sliceSerialize:he[z][2].sliceSerialize},Ie),he[z][1])}if(Ie.tokenStack.length>0){const O=Ie.tokenStack[Ie.tokenStack.length-1];(O[1]||QL).call(Ie,void 0,O[0])}for(ke.position={start:jo(he.length>0?he[0][1].start:{line:1,column:1,offset:0}),end:jo(he.length>0?he[he.length-2][1].end:{line:1,column:1,offset:0})},z=-1;++z<e.transforms.length;)ke=e.transforms[z](ke)||ke;return ke}function s(he,ke,Ie){let Ye=ke-1,z=-1,O=!1,F,Y,ce,ye;for(;++Ye<=Ie;){const we=he[Ye];switch(we[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{we[0]==="enter"?z++:z--,ye=void 0;break}case"lineEndingBlank":{we[0]==="enter"&&(F&&!ye&&!z&&!ce&&(ce=Ye),ye=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:ye=void 0}if(!z&&we[0]==="enter"&&we[1].type==="listItemPrefix"||z===-1&&we[0]==="exit"&&(we[1].type==="listUnordered"||we[1].type==="listOrdered")){if(F){let nt=Ye;for(Y=void 0;nt--;){const bt=he[nt];if(bt[1].type==="lineEnding"||bt[1].type==="lineEndingBlank"){if(bt[0]==="exit")continue;Y&&(he[Y][1].type="lineEndingBlank",O=!0),bt[1].type="lineEnding",Y=nt}else if(!(bt[1].type==="linePrefix"||bt[1].type==="blockQuotePrefix"||bt[1].type==="blockQuotePrefixWhitespace"||bt[1].type==="blockQuoteMarker"||bt[1].type==="listItemIndent"))break}ce&&(!Y||ce<Y)&&(F._spread=!0),F.end=Object.assign({},Y?he[Y][1].start:we[1].end),he.splice(Y||Ye,0,["exit",F,we[2]]),Ye++,Ie++}if(we[1].type==="listItemPrefix"){const nt={type:"listItem",_spread:!1,start:Object.assign({},we[1].start),end:void 0};F=nt,he.splice(Ye,0,["enter",nt,we[2]]),Ye++,Ie++,ce=void 0,ye=!0}}}return he[ke][1]._spread=O,Ie}function i(he,ke){return Ie;function Ie(Ye){a.call(this,he(Ye),Ye),ke&&ke.call(this,Ye)}}function o(){this.stack.push({type:"fragment",children:[]})}function a(he,ke,Ie){this.stack[this.stack.length-1].children.push(he),this.stack.push(he),this.tokenStack.push([ke,Ie||void 0]),he.position={start:jo(ke.start),end:void 0}}function l(he){return ke;function ke(Ie){he&&he.call(this,Ie),c.call(this,Ie)}}function c(he,ke){const Ie=this.stack.pop(),Ye=this.tokenStack.pop();if(Ye)Ye[0].type!==he.type&&(ke?ke.call(this,he,Ye[0]):(Ye[1]||QL).call(this,he,Ye[0]));else throw new Error("Cannot close `"+he.type+"` ("+jd({start:he.start,end:he.end})+"): it’s not open");Ie.position.end=jo(he.end)}function u(){return _k(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function d(he){if(this.data.expectingFirstListItemValue){const ke=this.stack[this.stack.length-2];ke.start=Number.parseInt(this.sliceSerialize(he),10),this.data.expectingFirstListItemValue=void 0}}function f(){const he=this.resume(),ke=this.stack[this.stack.length-1];ke.lang=he}function g(){const he=this.resume(),ke=this.stack[this.stack.length-1];ke.meta=he}function _(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function m(){const he=this.resume(),ke=this.stack[this.stack.length-1];ke.value=he.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function p(){const he=this.resume(),ke=this.stack[this.stack.length-1];ke.value=he.replace(/(\r?\n|\r)$/g,"")}function y(he){const ke=this.resume(),Ie=this.stack[this.stack.length-1];Ie.label=ke,Ie.identifier=Bs(this.sliceSerialize(he)).toLowerCase()}function b(){const he=this.resume(),ke=this.stack[this.stack.length-1];ke.title=he}function v(){const he=this.resume(),ke=this.stack[this.stack.length-1];ke.url=he}function w(he){const ke=this.stack[this.stack.length-1];if(!ke.depth){const Ie=this.sliceSerialize(he).length;ke.depth=Ie}}function E(){this.data.setextHeadingSlurpLineEnding=!0}function S(he){const ke=this.stack[this.stack.length-1];ke.depth=this.sliceSerialize(he).codePointAt(0)===61?1:2}function x(){this.data.setextHeadingSlurpLineEnding=void 0}function C(he){const Ie=this.stack[this.stack.length-1].children;let Ye=Ie[Ie.length-1];(!Ye||Ye.type!=="text")&&(Ye=Oe(),Ye.position={start:jo(he.start),end:void 0},Ie.push(Ye)),this.stack.push(Ye)}function A(he){const ke=this.stack.pop();ke.value+=this.sliceSerialize(he),ke.position.end=jo(he.end)}function M(he){const ke=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Ie=ke.children[ke.children.length-1];Ie.position.end=jo(he.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(ke.type)&&(C.call(this,he),A.call(this,he))}function P(){this.data.atHardBreak=!0}function D(){const he=this.resume(),ke=this.stack[this.stack.length-1];ke.value=he}function R(){const he=this.resume(),ke=this.stack[this.stack.length-1];ke.value=he}function G(){const he=this.resume(),ke=this.stack[this.stack.length-1];ke.value=he}function ee(){const he=this.stack[this.stack.length-1];if(this.data.inReference){const ke=this.data.referenceType||"shortcut";he.type+="Reference",he.referenceType=ke,delete he.url,delete he.title}else delete he.identifier,delete he.label;this.data.referenceType=void 0}function q(){const he=this.stack[this.stack.length-1];if(this.data.inReference){const ke=this.data.referenceType||"shortcut";he.type+="Reference",he.referenceType=ke,delete he.url,delete he.title}else delete he.identifier,delete he.label;this.data.referenceType=void 0}function re(he){const ke=this.sliceSerialize(he),Ie=this.stack[this.stack.length-2];Ie.label=Dye(ke),Ie.identifier=Bs(ke).toLowerCase()}function N(){const he=this.stack[this.stack.length-1],ke=this.resume(),Ie=this.stack[this.stack.length-1];if(this.data.inReference=!0,Ie.type==="link"){const Ye=he.children;Ie.children=Ye}else Ie.alt=ke}function B(){const he=this.resume(),ke=this.stack[this.stack.length-1];ke.url=he}function $(){const he=this.resume(),ke=this.stack[this.stack.length-1];ke.title=he}function H(){this.data.inReference=void 0}function U(){this.data.referenceType="collapsed"}function Q(he){const ke=this.resume(),Ie=this.stack[this.stack.length-1];Ie.label=ke,Ie.identifier=Bs(this.sliceSerialize(he)).toLowerCase(),this.data.referenceType="full"}function ne(he){this.data.characterReferenceType=he.type}function ge(he){const ke=this.sliceSerialize(he),Ie=this.data.characterReferenceType;let Ye;Ie?(Ye=IU(ke,Ie==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Ye=bk(ke);const z=this.stack[this.stack.length-1];z.value+=Ye}function J(he){const ke=this.stack.pop();ke.position.end=jo(he.end)}function V(he){A.call(this,he);const ke=this.stack[this.stack.length-1];ke.url=this.sliceSerialize(he)}function fe(he){A.call(this,he);const ke=this.stack[this.stack.length-1];ke.url="mailto:"+this.sliceSerialize(he)}function de(){return{type:"blockquote",children:[]}}function be(){return{type:"code",lang:null,meta:null,value:""}}function me(){return{type:"inlineCode",value:""}}function ve(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function L(){return{type:"emphasis",children:[]}}function oe(){return{type:"heading",depth:0,children:[]}}function ie(){return{type:"break"}}function W(){return{type:"html",value:""}}function K(){return{type:"image",title:null,url:"",alt:null}}function ae(){return{type:"link",title:null,url:"",children:[]}}function xe(he){return{type:"list",ordered:he.type==="listOrdered",start:null,spread:he._spread,children:[]}}function Te(he){return{type:"listItem",spread:he._spread,checked:null,children:[]}}function le(){return{type:"paragraph",children:[]}}function Se(){return{type:"strong",children:[]}}function Oe(){return{type:"text",value:""}}function Ce(){return{type:"thematicBreak"}}}function jo(t){return{line:t.line,column:t.column,offset:t.offset}}function _V(t,e){let r=-1;for(;++r<e.length;){const n=e[r];Array.isArray(n)?_V(t,n):_De(t,n)}}function _De(t,e){let r;for(r in e)if(gV.call(e,r))switch(r){case"canContainEols":{const n=e[r];n&&t[r].push(...n);break}case"transforms":{const n=e[r];n&&t[r].push(...n);break}case"enter":case"exit":{const n=e[r];n&&Object.assign(t[r],n);break}}}function QL(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+jd({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+jd({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+jd({start:e.start,end:e.end})+") is still open")}function yDe(t){const e=this;e.parser=r;function r(n){return mDe(n,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function bDe(t,e){const r={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,r),t.applyData(e,r)}function vDe(t,e){const r={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,r),[t.applyData(e,r),{type:"text",value:`
`}]}function wDe(t,e){const r=e.value?e.value+`
`:"",n={};e.lang&&(n.className=["language-"+e.lang]);let s={type:"element",tagName:"code",properties:n,children:[{type:"text",value:r}]};return e.meta&&(s.data={meta:e.meta}),t.patch(e,s),s=t.applyData(e,s),s={type:"element",tagName:"pre",properties:{},children:[s]},t.patch(e,s),s}function EDe(t,e){const r={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function xDe(t,e){const r={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function SDe(t,e){const r=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=String(e.identifier).toUpperCase(),s=lh(n.toLowerCase()),i=t.footnoteOrder.indexOf(n);let o,a=t.footnoteCounts.get(n);a===void 0?(a=0,t.footnoteOrder.push(n),o=t.footnoteOrder.length):o=i+1,a+=1,t.footnoteCounts.set(n,a);const l={type:"element",tagName:"a",properties:{href:"#"+r+"fn-"+s,id:r+"fnref-"+s+(a>1?"-"+a:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};t.patch(e,l);const c={type:"element",tagName:"sup",properties:{},children:[l]};return t.patch(e,c),t.applyData(e,c)}function TDe(t,e){const r={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function CDe(t,e){if(t.options.allowDangerousHtml){const r={type:"raw",value:e.value};return t.patch(e,r),t.applyData(e,r)}}function yV(t,e){const r=e.referenceType;let n="]";if(r==="collapsed"?n+="[]":r==="full"&&(n+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+n}];const s=t.all(e),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const o=s[s.length-1];return o&&o.type==="text"?o.value+=n:s.push({type:"text",value:n}),s}function kDe(t,e){const r=String(e.identifier).toUpperCase(),n=t.definitionById.get(r);if(!n)return yV(t,e);const s={src:lh(n.url||""),alt:e.alt};n.title!==null&&n.title!==void 0&&(s.title=n.title);const i={type:"element",tagName:"img",properties:s,children:[]};return t.patch(e,i),t.applyData(e,i)}function ADe(t,e){const r={src:lh(e.url)};e.alt!==null&&e.alt!==void 0&&(r.alt=e.alt),e.title!==null&&e.title!==void 0&&(r.title=e.title);const n={type:"element",tagName:"img",properties:r,children:[]};return t.patch(e,n),t.applyData(e,n)}function RDe(t,e){const r={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,r);const n={type:"element",tagName:"code",properties:{},children:[r]};return t.patch(e,n),t.applyData(e,n)}function IDe(t,e){const r=String(e.identifier).toUpperCase(),n=t.definitionById.get(r);if(!n)return yV(t,e);const s={href:lh(n.url||"")};n.title!==null&&n.title!==void 0&&(s.title=n.title);const i={type:"element",tagName:"a",properties:s,children:t.all(e)};return t.patch(e,i),t.applyData(e,i)}function PDe(t,e){const r={href:lh(e.url)};e.title!==null&&e.title!==void 0&&(r.title=e.title);const n={type:"element",tagName:"a",properties:r,children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function ODe(t,e,r){const n=t.all(e),s=r?DDe(r):bV(e),i={},o=[];if(typeof e.checked=="boolean"){const u=n[0];let h;u&&u.type==="element"&&u.tagName==="p"?h=u:(h={type:"element",tagName:"p",properties:{},children:[]},n.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let a=-1;for(;++a<n.length;){const u=n[a];(s||a!==0||u.type!=="element"||u.tagName!=="p")&&o.push({type:"text",value:`
`}),u.type==="element"&&u.tagName==="p"&&!s?o.push(...u.children):o.push(u)}const l=n[n.length-1];l&&(s||l.type!=="element"||l.tagName!=="p")&&o.push({type:"text",value:`
`});const c={type:"element",tagName:"li",properties:i,children:o};return t.patch(e,c),t.applyData(e,c)}function DDe(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const r=t.children;let n=-1;for(;!e&&++n<r.length;)e=bV(r[n])}return e}function bV(t){const e=t.spread;return e??t.children.length>1}function LDe(t,e){const r={},n=t.all(e);let s=-1;for(typeof e.start=="number"&&e.start!==1&&(r.start=e.start);++s<n.length;){const o=n[s];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){r.className=["contains-task-list"];break}}const i={type:"element",tagName:e.ordered?"ol":"ul",properties:r,children:t.wrap(n,!0)};return t.patch(e,i),t.applyData(e,i)}function NDe(t,e){const r={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function MDe(t,e){const r={type:"root",children:t.wrap(t.all(e))};return t.patch(e,r),t.applyData(e,r)}function BDe(t,e){const r={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function FDe(t,e){const r=t.all(e),n=r.shift(),s=[];if(n){const o={type:"element",tagName:"thead",properties:{},children:t.wrap([n],!0)};t.patch(e.children[0],o),s.push(o)}if(r.length>0){const o={type:"element",tagName:"tbody",properties:{},children:t.wrap(r,!0)},a=Gi(e.children[1]),l=db(e.children[e.children.length-1]);a&&l&&(o.position={start:a,end:l}),s.push(o)}const i={type:"element",tagName:"table",properties:{},children:t.wrap(s,!0)};return t.patch(e,i),t.applyData(e,i)}function jDe(t,e,r){const n=r?r.children:void 0,i=(n?n.indexOf(e):1)===0?"th":"td",o=r&&r.type==="table"?r.align:void 0,a=o?o.length:e.children.length;let l=-1;const c=[];for(;++l<a;){const h=e.children[l],d={},f=o?o[l]:void 0;f&&(d.align=f);let g={type:"element",tagName:i,properties:d,children:[]};h&&(g.children=t.all(h),t.patch(h,g),g=t.applyData(h,g)),c.push(g)}const u={type:"element",tagName:"tr",properties:{},children:t.wrap(c,!0)};return t.patch(e,u),t.applyData(e,u)}function UDe(t,e){const r={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}const eN=9,tN=32;function $De(t){const e=String(t),r=/\r?\n|\r/g;let n=r.exec(e),s=0;const i=[];for(;n;)i.push(rN(e.slice(s,n.index),s>0,!0),n[0]),s=n.index+n[0].length,n=r.exec(e);return i.push(rN(e.slice(s),s>0,!1)),i.join("")}function rN(t,e,r){let n=0,s=t.length;if(e){let i=t.codePointAt(n);for(;i===eN||i===tN;)n++,i=t.codePointAt(n)}if(r){let i=t.codePointAt(s-1);for(;i===eN||i===tN;)s--,i=t.codePointAt(s-1)}return s>n?t.slice(n,s):""}function HDe(t,e){const r={type:"text",value:$De(String(e.value))};return t.patch(e,r),t.applyData(e,r)}function zDe(t,e){const r={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,r),t.applyData(e,r)}const VDe={blockquote:bDe,break:vDe,code:wDe,delete:EDe,emphasis:xDe,footnoteReference:SDe,heading:TDe,html:CDe,imageReference:kDe,image:ADe,inlineCode:RDe,linkReference:IDe,link:PDe,listItem:ODe,list:LDe,paragraph:NDe,root:MDe,strong:BDe,table:FDe,tableCell:UDe,tableRow:jDe,text:HDe,thematicBreak:zDe,toml:xg,yaml:xg,definition:xg,footnoteDefinition:xg};function xg(){}function GDe(t,e){const r=[{type:"text",value:"↩"}];return e>1&&r.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),r}function WDe(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function qDe(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=t.options.footnoteBackContent||GDe,n=t.options.footnoteBackLabel||WDe,s=t.options.footnoteLabel||"Footnotes",i=t.options.footnoteLabelTagName||"h2",o=t.options.footnoteLabelProperties||{className:["sr-only"]},a=[];let l=-1;for(;++l<t.footnoteOrder.length;){const c=t.footnoteById.get(t.footnoteOrder[l]);if(!c)continue;const u=t.all(c),h=String(c.identifier).toUpperCase(),d=lh(h.toLowerCase());let f=0;const g=[],_=t.footnoteCounts.get(h);for(;_!==void 0&&++f<=_;){g.length>0&&g.push({type:"text",value:" "});let y=typeof r=="string"?r:r(l,f);typeof y=="string"&&(y={type:"text",value:y}),g.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+d+(f>1?"-"+f:""),dataFootnoteBackref:"",ariaLabel:typeof n=="string"?n:n(l,f),className:["data-footnote-backref"]},children:Array.isArray(y)?y:[y]})}const m=u[u.length-1];if(m&&m.type==="element"&&m.tagName==="p"){const y=m.children[m.children.length-1];y&&y.type==="text"?y.value+=" ":m.children.push({type:"text",value:" "}),m.children.push(...g)}else u.push(...g);const p={type:"element",tagName:"li",properties:{id:e+"fn-"+d},children:t.wrap(u,!0)};t.patch(c,p),a.push(p)}if(a.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...Ul(o),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(a,!0)},{type:"text",value:`
`}]}}const BS={}.hasOwnProperty,KDe={};function YDe(t,e){const r=e||KDe,n=new Map,s=new Map,i=new Map,o={...VDe,...r.handlers},a={all:c,applyData:ZDe,definitionById:n,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:o,one:l,options:r,patch:XDe,wrap:QDe};return Rp(t,function(u){if(u.type==="definition"||u.type==="footnoteDefinition"){const h=u.type==="definition"?n:s,d=String(u.identifier).toUpperCase();h.has(d)||h.set(d,u)}}),a;function l(u,h){const d=u.type,f=a.handlers[d];if(BS.call(a.handlers,d)&&f)return f(a,u,h);if(a.options.passThrough&&a.options.passThrough.includes(d)){if("children"in u){const{children:_,...m}=u,p=Ul(m);return p.children=a.all(u),p}return Ul(u)}return(a.options.unknownHandler||JDe)(a,u,h)}function c(u){const h=[];if("children"in u){const d=u.children;let f=-1;for(;++f<d.length;){const g=a.one(d[f],u);if(g){if(f&&d[f-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=nN(g.value)),!Array.isArray(g)&&g.type==="element")){const _=g.children[0];_&&_.type==="text"&&(_.value=nN(_.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function XDe(t,e){t.position&&(e.position=aU(t))}function ZDe(t,e){let r=e;if(t&&t.data){const n=t.data.hName,s=t.data.hChildren,i=t.data.hProperties;if(typeof n=="string")if(r.type==="element")r.tagName=n;else{const o="children"in r?r.children:[r];r={type:"element",tagName:n,properties:{},children:o}}r.type==="element"&&i&&Object.assign(r.properties,Ul(i)),"children"in r&&r.children&&s!==null&&s!==void 0&&(r.children=s)}return r}function JDe(t,e){const r=e.data||{},n="value"in e&&!(BS.call(r,"hProperties")||BS.call(r,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function QDe(t,e){const r=[];let n=-1;for(e&&r.push({type:"text",value:`
`});++n<t.length;)n&&r.push({type:"text",value:`
`}),r.push(t[n]);return e&&t.length>0&&r.push({type:"text",value:`
`}),r}function nN(t){let e=0,r=t.charCodeAt(e);for(;r===9||r===32;)e++,r=t.charCodeAt(e);return t.slice(e)}function sN(t,e){const r=YDe(t,e),n=r.one(t,void 0),s=qDe(r),i=Array.isArray(n)?{type:"root",children:n}:n||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function eLe(t,e){return t&&"run"in t?async function(r,n){const s=sN(r,{file:n,...e});await t.run(s,n)}:function(r,n){return sN(r,{file:n,...t||e})}}function iN(t){if(t)throw t}var d0=Object.prototype.hasOwnProperty,vV=Object.prototype.toString,oN=Object.defineProperty,aN=Object.getOwnPropertyDescriptor,lN=function(e){return typeof Array.isArray=="function"?Array.isArray(e):vV.call(e)==="[object Array]"},cN=function(e){if(!e||vV.call(e)!=="[object Object]")return!1;var r=d0.call(e,"constructor"),n=e.constructor&&e.constructor.prototype&&d0.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!r&&!n)return!1;var s;for(s in e);return typeof s>"u"||d0.call(e,s)},uN=function(e,r){oN&&r.name==="__proto__"?oN(e,r.name,{enumerable:!0,configurable:!0,value:r.newValue,writable:!0}):e[r.name]=r.newValue},hN=function(e,r){if(r==="__proto__")if(d0.call(e,r)){if(aN)return aN(e,r).value}else return;return e[r]},tLe=function t(){var e,r,n,s,i,o,a=arguments[0],l=1,c=arguments.length,u=!1;for(typeof a=="boolean"&&(u=a,a=arguments[1]||{},l=2),(a==null||typeof a!="object"&&typeof a!="function")&&(a={});l<c;++l)if(e=arguments[l],e!=null)for(r in e)n=hN(a,r),s=hN(e,r),a!==s&&(u&&s&&(cN(s)||(i=lN(s)))?(i?(i=!1,o=n&&lN(n)?n:[]):o=n&&cN(n)?n:{},uN(a,{name:r,newValue:t(u,o,s)})):typeof s<"u"&&uN(a,{name:r,newValue:s}));return a};const Zw=rs(tLe);function FS(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function rLe(){const t=[],e={run:r,use:n};return e;function r(...s){let i=-1;const o=s.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);a(null,...s);function a(l,...c){const u=t[++i];let h=-1;if(l){o(l);return}for(;++h<s.length;)(c[h]===null||c[h]===void 0)&&(c[h]=s[h]);s=c,u?nLe(u,a)(...c):o(null,...c)}}function n(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return t.push(s),e}}function nLe(t,e){let r;return n;function n(...o){const a=t.length>o.length;let l;a&&o.push(s);try{l=t.apply(this,o)}catch(c){const u=c;if(a&&r)throw u;return s(u)}a||(l&&l.then&&typeof l.then=="function"?l.then(i,s):l instanceof Error?s(l):i(l))}function s(o,...a){r||(r=!0,e(o,...a))}function i(o){s(null,o)}}const di={basename:sLe,dirname:iLe,extname:oLe,join:aLe,sep:"/"};function sLe(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');Vp(t);let r=0,n=-1,s=t.length,i;if(e===void 0||e.length===0||e.length>t.length){for(;s--;)if(t.codePointAt(s)===47){if(i){r=s+1;break}}else n<0&&(i=!0,n=s+1);return n<0?"":t.slice(r,n)}if(e===t)return"";let o=-1,a=e.length-1;for(;s--;)if(t.codePointAt(s)===47){if(i){r=s+1;break}}else o<0&&(i=!0,o=s+1),a>-1&&(t.codePointAt(s)===e.codePointAt(a--)?a<0&&(n=s):(a=-1,n=o));return r===n?n=o:n<0&&(n=t.length),t.slice(r,n)}function iLe(t){if(Vp(t),t.length===0)return".";let e=-1,r=t.length,n;for(;--r;)if(t.codePointAt(r)===47){if(n){e=r;break}}else n||(n=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function oLe(t){Vp(t);let e=t.length,r=-1,n=0,s=-1,i=0,o;for(;e--;){const a=t.codePointAt(e);if(a===47){if(o){n=e+1;break}continue}r<0&&(o=!0,r=e+1),a===46?s<0?s=e:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||r<0||i===0||i===1&&s===r-1&&s===n+1?"":t.slice(s,r)}function aLe(...t){let e=-1,r;for(;++e<t.length;)Vp(t[e]),t[e]&&(r=r===void 0?t[e]:r+"/"+t[e]);return r===void 0?".":lLe(r)}function lLe(t){Vp(t);const e=t.codePointAt(0)===47;let r=cLe(t,!e);return r.length===0&&!e&&(r="."),r.length>0&&t.codePointAt(t.length-1)===47&&(r+="/"),e?"/"+r:r}function cLe(t,e){let r="",n=0,s=-1,i=0,o=-1,a,l;for(;++o<=t.length;){if(o<t.length)a=t.codePointAt(o);else{if(a===47)break;a=47}if(a===47){if(!(s===o-1||i===1))if(s!==o-1&&i===2){if(r.length<2||n!==2||r.codePointAt(r.length-1)!==46||r.codePointAt(r.length-2)!==46){if(r.length>2){if(l=r.lastIndexOf("/"),l!==r.length-1){l<0?(r="",n=0):(r=r.slice(0,l),n=r.length-1-r.lastIndexOf("/")),s=o,i=0;continue}}else if(r.length>0){r="",n=0,s=o,i=0;continue}}e&&(r=r.length>0?r+"/..":"..",n=2)}else r.length>0?r+="/"+t.slice(s+1,o):r=t.slice(s+1,o),n=o-s-1;s=o,i=0}else a===46&&i>-1?i++:i=-1}return r}function Vp(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const uLe={cwd:hLe};function hLe(){return"/"}function jS(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function dLe(t){if(typeof t=="string")t=new URL(t);else if(!jS(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return fLe(t)}function fLe(t){if(t.hostname!==""){const n=new TypeError('File URL host must be "localhost" or empty on darwin');throw n.code="ERR_INVALID_FILE_URL_HOST",n}const e=t.pathname;let r=-1;for(;++r<e.length;)if(e.codePointAt(r)===37&&e.codePointAt(r+1)===50){const n=e.codePointAt(r+2);if(n===70||n===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(e)}const Jw=["history","path","basename","stem","extname","dirname"];class wV{constructor(e){let r;e?jS(e)?r={path:e}:typeof e=="string"||pLe(e)?r={value:e}:r=e:r={},this.cwd="cwd"in r?"":uLe.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let n=-1;for(;++n<Jw.length;){const i=Jw[n];i in r&&r[i]!==void 0&&r[i]!==null&&(this[i]=i==="history"?[...r[i]]:r[i])}let s;for(s in r)Jw.includes(s)||(this[s]=r[s])}get basename(){return typeof this.path=="string"?di.basename(this.path):void 0}set basename(e){e1(e,"basename"),Qw(e,"basename"),this.path=di.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?di.dirname(this.path):void 0}set dirname(e){dN(this.basename,"dirname"),this.path=di.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?di.extname(this.path):void 0}set extname(e){if(Qw(e,"extname"),dN(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=di.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){jS(e)&&(e=dLe(e)),e1(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?di.basename(this.path,this.extname):void 0}set stem(e){e1(e,"stem"),Qw(e,"stem"),this.path=di.join(this.dirname||"",e+(this.extname||""))}fail(e,r,n){const s=this.message(e,r,n);throw s.fatal=!0,s}info(e,r,n){const s=this.message(e,r,n);return s.fatal=void 0,s}message(e,r,n){const s=new on(e,r,n);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function Qw(t,e){if(t&&t.includes(di.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+di.sep+"`")}function e1(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function dN(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function pLe(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const mLe=function(t){const n=this.constructor.prototype,s=n[t],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,n),i},gLe={}.hasOwnProperty;class DA extends mLe{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=rLe()}copy(){const e=new DA;let r=-1;for(;++r<this.attachers.length;){const n=this.attachers[r];e.use(...n)}return e.data(Zw(!0,{},this.namespace)),e}data(e,r){return typeof e=="string"?arguments.length===2?(n1("data",this.frozen),this.namespace[e]=r,this):gLe.call(this.namespace,e)&&this.namespace[e]||void 0:e?(n1("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[r,...n]=this.attachers[this.freezeIndex];if(n[0]===!1)continue;n[0]===!0&&(n[0]=void 0);const s=r.call(e,...n);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const r=Sg(e),n=this.parser||this.Parser;return t1("parse",n),n(String(r),r)}process(e,r){const n=this;return this.freeze(),t1("process",this.parser||this.Parser),r1("process",this.compiler||this.Compiler),r?s(void 0,r):new Promise(s);function s(i,o){const a=Sg(e),l=n.parse(a);n.run(l,a,function(u,h,d){if(u||!h||!d)return c(u);const f=h,g=n.stringify(f,d);bLe(g)?d.value=g:d.result=g,c(u,d)});function c(u,h){u||!h?o(u):i?i(h):r(void 0,h)}}}processSync(e){let r=!1,n;return this.freeze(),t1("processSync",this.parser||this.Parser),r1("processSync",this.compiler||this.Compiler),this.process(e,s),pN("processSync","process",r),n;function s(i,o){r=!0,iN(i),n=o}}run(e,r,n){fN(e),this.freeze();const s=this.transformers;return!n&&typeof r=="function"&&(n=r,r=void 0),n?i(void 0,n):new Promise(i);function i(o,a){const l=Sg(r);s.run(e,l,c);function c(u,h,d){const f=h||e;u?a(u):o?o(f):n(void 0,f,d)}}}runSync(e,r){let n=!1,s;return this.run(e,r,i),pN("runSync","run",n),s;function i(o,a){iN(o),s=a,n=!0}}stringify(e,r){this.freeze();const n=Sg(r),s=this.compiler||this.Compiler;return r1("stringify",s),fN(e),s(e,n)}use(e,...r){const n=this.attachers,s=this.namespace;if(n1("use",this.frozen),e!=null)if(typeof e=="function")l(e,r);else if(typeof e=="object")Array.isArray(e)?a(e):o(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function i(c){if(typeof c=="function")l(c,[]);else if(typeof c=="object")if(Array.isArray(c)){const[u,...h]=c;l(u,h)}else o(c);else throw new TypeError("Expected usable value, not `"+c+"`")}function o(c){if(!("plugins"in c)&&!("settings"in c))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");a(c.plugins),c.settings&&(s.settings=Zw(!0,s.settings,c.settings))}function a(c){let u=-1;if(c!=null)if(Array.isArray(c))for(;++u<c.length;){const h=c[u];i(h)}else throw new TypeError("Expected a list of plugins, not `"+c+"`")}function l(c,u){let h=-1,d=-1;for(;++h<n.length;)if(n[h][0]===c){d=h;break}if(d===-1)n.push([c,...u]);else if(u.length>0){let[f,...g]=u;const _=n[d][1];FS(_)&&FS(f)&&(f=Zw(!0,_,f)),n[d]=[c,f,...g]}}}}const _Le=new DA().freeze();function t1(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function r1(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function n1(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function fN(t){if(!FS(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function pN(t,e,r){if(!r)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function Sg(t){return yLe(t)?t:new wV(t)}function yLe(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function bLe(t){return typeof t=="string"||vLe(t)}function vLe(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const wLe="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",mN=[],gN={allowDangerousHtml:!0},ELe=/^(https?|ircs?|mailto|xmpp)$/i,xLe=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function SLe(t){const e=t.allowedElements,r=t.allowElement,n=t.children||"",s=t.className,i=t.components,o=t.disallowedElements,a=t.rehypePlugins||mN,l=t.remarkPlugins||mN,c=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...gN}:gN,u=t.skipHtml,h=t.unwrapDisallowed,d=t.urlTransform||TLe,f=_Le().use(yDe).use(l).use(eLe,c).use(a),g=new wV;typeof n=="string"&&(g.value=n);for(const y of xLe)Object.hasOwn(t,y.from)&&(""+y.from+(y.to?"use `"+y.to+"` instead":"remove it")+wLe+y.id,void 0);const _=f.parse(g);let m=f.runSync(_,g);return s&&(m={type:"element",tagName:"div",properties:{className:s},children:m.type==="root"?m.children:[m]}),Rp(m,p),TOe(m,{Fragment:T.Fragment,components:i,ignoreInvalidStyle:!0,jsx:T.jsx,jsxs:T.jsxs,passKeys:!0,passNode:!0});function p(y,b,v){if(y.type==="raw"&&v&&typeof b=="number")return u?v.children.splice(b,1):v.children[b]={type:"text",value:y.value},b;if(y.type==="element"){let w;for(w in Xw)if(Object.hasOwn(Xw,w)&&Object.hasOwn(y.properties,w)){const E=y.properties[w],S=Xw[w];(S===null||S.includes(y.tagName))&&(y.properties[w]=d(String(E||""),w,y))}}if(y.type==="element"){let w=e?!e.includes(y.tagName):o?o.includes(y.tagName):!1;if(!w&&r&&typeof b=="number"&&(w=!r(y,b,v)),w&&v&&typeof b=="number")return h&&y.children?v.children.splice(b,1,...y.children):v.children.splice(b,1),b}}}function TLe(t){const e=t.indexOf(":"),r=t.indexOf("?"),n=t.indexOf("#"),s=t.indexOf("/");return e<0||s>-1&&e>s||r>-1&&e>r||n>-1&&e>n||ELe.test(t.slice(0,e))?t:""}const EV=[{id:"abap",name:"ABAP",import:()=>Z(()=>import("./abap-BwpQXVS2.js"),[])},{id:"actionscript-3",name:"ActionScript",import:()=>Z(()=>import("./actionscript-3-Ci-La1BS.js"),[])},{id:"ada",name:"Ada",import:()=>Z(()=>import("./ada-DOAn35dn.js"),[])},{id:"angular-html",name:"Angular HTML",import:()=>Z(()=>import("./angular-html-GqBVQ6Dm.js").then(t=>t.f),__vite__mapDeps([13,14,15,16]))},{id:"angular-ts",name:"Angular TypeScript",import:()=>Z(()=>import("./angular-ts-MKs4dlu_.js"),__vite__mapDeps([17,13,14,15,16,18]))},{id:"apache",name:"Apache Conf",import:()=>Z(()=>import("./apache-Dn00JSTd.js"),[])},{id:"apex",name:"Apex",import:()=>Z(()=>import("./apex-BzwtH5UL.js"),[])},{id:"apl",name:"APL",import:()=>Z(()=>import("./apl-C6GBNg32.js"),__vite__mapDeps([19,14,15,16,20,21,22]))},{id:"applescript",name:"AppleScript",import:()=>Z(()=>import("./applescript-DIt9OTko.js"),[])},{id:"ara",name:"Ara",import:()=>Z(()=>import("./ara-CJxt7p29.js"),[])},{id:"asciidoc",name:"AsciiDoc",aliases:["adoc"],import:()=>Z(()=>import("./asciidoc-CcSEeikT.js"),[])},{id:"asm",name:"Assembly",import:()=>Z(()=>import("./asm-DPTZissz.js"),[])},{id:"astro",name:"Astro",import:()=>Z(()=>import("./astro-DTSlZd1t.js"),__vite__mapDeps([23,22,15,24,16,25]))},{id:"awk",name:"AWK",import:()=>Z(()=>import("./awk-BINKOAKH.js"),[])},{id:"ballerina",name:"Ballerina",import:()=>Z(()=>import("./ballerina-DCcCncrU.js"),[])},{id:"bat",name:"Batch File",aliases:["batch"],import:()=>Z(()=>import("./bat-B9Vj0mJK.js"),[])},{id:"beancount",name:"Beancount",import:()=>Z(()=>import("./beancount-DDUKAZWS.js"),[])},{id:"berry",name:"Berry",aliases:["be"],import:()=>Z(()=>import("./berry-DnyWjya5.js"),[])},{id:"bibtex",name:"BibTeX",import:()=>Z(()=>import("./bibtex-CpWBKVjh.js"),[])},{id:"bicep",name:"Bicep",import:()=>Z(()=>import("./bicep-BWkuYGGO.js"),[])},{id:"blade",name:"Blade",import:()=>Z(()=>import("./blade-CPEzV-UE.js"),__vite__mapDeps([26,14,15,16,20,21,27,22]))},{id:"bsl",name:"1C (Enterprise)",aliases:["1c"],import:()=>Z(()=>import("./bsl-Dgyn0ogV.js"),__vite__mapDeps([28,29]))},{id:"c",name:"C",import:()=>Z(()=>import("./c-BhsLqr-4.js"),[])},{id:"cadence",name:"Cadence",aliases:["cdc"],import:()=>Z(()=>import("./cadence-CEjiMJLT.js"),[])},{id:"cairo",name:"Cairo",import:()=>Z(()=>import("./cairo-DMFdBl0X.js"),[])},{id:"clarity",name:"Clarity",import:()=>Z(()=>import("./clarity-CXmV_HiI.js"),[])},{id:"clojure",name:"Clojure",aliases:["clj"],import:()=>Z(()=>import("./clojure-mLcCfA0-.js"),[])},{id:"cmake",name:"CMake",import:()=>Z(()=>import("./cmake-DbXoA79R.js"),[])},{id:"cobol",name:"COBOL",import:()=>Z(()=>import("./cobol-NX_YbRMJ.js"),__vite__mapDeps([30,14,15,16,21]))},{id:"codeowners",name:"CODEOWNERS",import:()=>Z(()=>import("./codeowners-Bp6g37R7.js"),[])},{id:"codeql",name:"CodeQL",aliases:["ql"],import:()=>Z(()=>import("./codeql-Bdprqoiu.js"),[])},{id:"coffee",name:"CoffeeScript",aliases:["coffeescript"],import:()=>Z(()=>import("./coffee-CXcjgkhu.js"),__vite__mapDeps([31,15]))},{id:"common-lisp",name:"Common Lisp",aliases:["lisp"],import:()=>Z(()=>import("./common-lisp-CQO4gZEw.js"),[])},{id:"coq",name:"Coq",import:()=>Z(()=>import("./coq-BCzYJAay.js"),[])},{id:"cpp",name:"C++",aliases:["c++"],import:()=>Z(()=>import("./cpp-IRqjNdQP.js"),__vite__mapDeps([32,33,34,35,27]))},{id:"crystal",name:"Crystal",import:()=>Z(()=>import("./crystal-DFEzbmK1.js"),__vite__mapDeps([36,14,15,16,27,35,37]))},{id:"csharp",name:"C#",aliases:["c#","cs"],import:()=>Z(()=>import("./csharp-D7v6OrNy.js"),[])},{id:"css",name:"CSS",import:()=>Z(()=>import("./css-u4bm_LMz.js"),[])},{id:"csv",name:"CSV",import:()=>Z(()=>import("./csv-B0qRVHPH.js"),[])},{id:"cue",name:"CUE",import:()=>Z(()=>import("./cue-DmZ-uG0V.js"),[])},{id:"cypher",name:"Cypher",aliases:["cql"],import:()=>Z(()=>import("./cypher-DfpIq38s.js"),[])},{id:"d",name:"D",import:()=>Z(()=>import("./d-B5L7zzq-.js"),[])},{id:"dart",name:"Dart",import:()=>Z(()=>import("./dart-D9W_gRNE.js"),[])},{id:"dax",name:"DAX",import:()=>Z(()=>import("./dax-yA8e6OR-.js"),[])},{id:"desktop",name:"Desktop",import:()=>Z(()=>import("./desktop-DEIpsLCJ.js"),[])},{id:"diff",name:"Diff",import:()=>Z(()=>import("./diff-Dnfm4U7b.js"),[])},{id:"docker",name:"Dockerfile",aliases:["dockerfile"],import:()=>Z(()=>import("./docker-BHpzmqOf.js"),[])},{id:"dotenv",name:"dotEnv",import:()=>Z(()=>import("./dotenv-DQxx3LPD.js"),[])},{id:"dream-maker",name:"Dream Maker",import:()=>Z(()=>import("./dream-maker-BMwgFBEQ.js"),[])},{id:"edge",name:"Edge",import:()=>Z(()=>import("./edge-Cq_6DOij.js"),__vite__mapDeps([38,24,14,15,16,39]))},{id:"elixir",name:"Elixir",import:()=>Z(()=>import("./elixir-BoNJ9vXU.js"),__vite__mapDeps([40,14,15,16]))},{id:"elm",name:"Elm",import:()=>Z(()=>import("./elm-CTr_twwF.js"),__vite__mapDeps([41,34,35]))},{id:"emacs-lisp",name:"Emacs Lisp",aliases:["elisp"],import:()=>Z(()=>import("./emacs-lisp-CMz7PuSU.js"),[])},{id:"erb",name:"ERB",import:()=>Z(()=>import("./erb-DuefeV9w.js"),__vite__mapDeps([42,14,15,16,43,20,21,27,35,37,44]))},{id:"erlang",name:"Erlang",aliases:["erl"],import:()=>Z(()=>import("./erlang-CMOi41r9.js"),[])},{id:"fennel",name:"Fennel",import:()=>Z(()=>import("./fennel-dZn0vQkf.js"),[])},{id:"fish",name:"Fish",import:()=>Z(()=>import("./fish-CQzXS8_C.js"),[])},{id:"fluent",name:"Fluent",aliases:["ftl"],import:()=>Z(()=>import("./fluent-CNRQ974Q.js"),[])},{id:"fortran-fixed-form",name:"Fortran (Fixed Form)",aliases:["f","for","f77"],import:()=>Z(()=>import("./fortran-fixed-form-C9lV_GL-.js"),__vite__mapDeps([45,46]))},{id:"fortran-free-form",name:"Fortran (Free Form)",aliases:["f90","f95","f03","f08","f18"],import:()=>Z(()=>import("./fortran-free-form-B3Z_eaxm.js"),[])},{id:"fsharp",name:"F#",aliases:["f#","fs"],import:()=>Z(()=>import("./fsharp-Vw5t3P44.js"),__vite__mapDeps([47,48]))},{id:"gdresource",name:"GDResource",import:()=>Z(()=>import("./gdresource-D_y5yz_M.js"),__vite__mapDeps([49,50,51]))},{id:"gdscript",name:"GDScript",import:()=>Z(()=>import("./gdscript-BIguuW30.js"),[])},{id:"gdshader",name:"GDShader",import:()=>Z(()=>import("./gdshader-BSHf-0eb.js"),[])},{id:"genie",name:"Genie",import:()=>Z(()=>import("./genie-DJEtsjbi.js"),[])},{id:"gherkin",name:"Gherkin",import:()=>Z(()=>import("./gherkin--30QC5Em.js"),[])},{id:"git-commit",name:"Git Commit Message",import:()=>Z(()=>import("./git-commit-C0WNX4K0.js"),__vite__mapDeps([52,53]))},{id:"git-rebase",name:"Git Rebase Message",import:()=>Z(()=>import("./git-rebase-3YLVFLpI.js"),__vite__mapDeps([54,37]))},{id:"gleam",name:"Gleam",import:()=>Z(()=>import("./gleam-C30t_gpS.js"),[])},{id:"glimmer-js",name:"Glimmer JS",aliases:["gjs"],import:()=>Z(()=>import("./glimmer-js-D4fdoRWd.js"),__vite__mapDeps([55,15,24,16,14]))},{id:"glimmer-ts",name:"Glimmer TS",aliases:["gts"],import:()=>Z(()=>import("./glimmer-ts-DFoQQgBS.js"),__vite__mapDeps([56,24,16,15,14]))},{id:"glsl",name:"GLSL",import:()=>Z(()=>import("./glsl-bwZ1_LLM.js"),__vite__mapDeps([34,35]))},{id:"gnuplot",name:"Gnuplot",import:()=>Z(()=>import("./gnuplot-CmWLV2bY.js"),[])},{id:"go",name:"Go",import:()=>Z(()=>import("./go-Cv7ZOjGq.js"),[])},{id:"graphql",name:"GraphQL",aliases:["gql"],import:()=>Z(()=>import("./graphql-DqgCZ2sd.js"),__vite__mapDeps([57,15,24,58,59]))},{id:"groovy",name:"Groovy",import:()=>Z(()=>import("./groovy-BWslPs4p.js"),[])},{id:"hack",name:"Hack",import:()=>Z(()=>import("./hack-BV5LM4CS.js"),__vite__mapDeps([60,14,15,16,27]))},{id:"haml",name:"Ruby Haml",import:()=>Z(()=>import("./haml-B1jT_oKV.js"),__vite__mapDeps([61,15,16]))},{id:"handlebars",name:"Handlebars",aliases:["hbs"],import:()=>Z(()=>import("./handlebars-HtVeTy3a.js"),__vite__mapDeps([62,14,15,16,63]))},{id:"haskell",name:"Haskell",aliases:["hs"],import:()=>Z(()=>import("./haskell-ChDww4um.js"),[])},{id:"haxe",name:"Haxe",import:()=>Z(()=>import("./haxe-BgqZeg96.js"),[])},{id:"hcl",name:"HashiCorp HCL",import:()=>Z(()=>import("./hcl-Cztwc-HH.js"),[])},{id:"hjson",name:"Hjson",import:()=>Z(()=>import("./hjson-D9Bn7OQI.js"),[])},{id:"hlsl",name:"HLSL",import:()=>Z(()=>import("./hlsl-DkpUthgY.js"),[])},{id:"html",name:"HTML",import:()=>Z(()=>import("./html-DG1TtFnM.js"),__vite__mapDeps([14,15,16]))},{id:"html-derivative",name:"HTML (Derivative)",import:()=>Z(()=>import("./html-derivative-CDVwFiY1.js"),__vite__mapDeps([39,14,15,16]))},{id:"http",name:"HTTP",import:()=>Z(()=>import("./http-CYnz8shJ.js"),__vite__mapDeps([64,37,22,20,21,57,15,24,58,59]))},{id:"hxml",name:"HXML",import:()=>Z(()=>import("./hxml-BfFmssGd.js"),__vite__mapDeps([65,66]))},{id:"hy",name:"Hy",import:()=>Z(()=>import("./hy-YurBl9Qv.js"),[])},{id:"imba",name:"Imba",import:()=>Z(()=>import("./imba-C6vdFTm2.js"),__vite__mapDeps([67,24]))},{id:"ini",name:"INI",aliases:["properties"],import:()=>Z(()=>import("./ini-BjABl1g7.js"),[])},{id:"java",name:"Java",import:()=>Z(()=>import("./java-BN40hmum.js"),[])},{id:"javascript",name:"JavaScript",aliases:["js"],import:()=>Z(()=>import("./javascript-DNgb01dh.js"),[])},{id:"jinja",name:"Jinja",import:()=>Z(()=>import("./jinja-BORjBBXU.js"),__vite__mapDeps([68,14,15,16]))},{id:"jison",name:"Jison",import:()=>Z(()=>import("./jison-Ct8rtT8R.js"),__vite__mapDeps([69,15]))},{id:"json",name:"JSON",import:()=>Z(()=>import("./json-DWmkr0yC.js"),[])},{id:"json5",name:"JSON5",import:()=>Z(()=>import("./json5-BDjtpMT8.js"),[])},{id:"jsonc",name:"JSON with Comments",import:()=>Z(()=>import("./jsonc-B8E-_56i.js"),[])},{id:"jsonl",name:"JSON Lines",import:()=>Z(()=>import("./jsonl-NKd-Y1zG.js"),[])},{id:"jsonnet",name:"Jsonnet",import:()=>Z(()=>import("./jsonnet-CpRrwcwt.js"),[])},{id:"jssm",name:"JSSM",aliases:["fsl"],import:()=>Z(()=>import("./jssm-DlYXzDlu.js"),[])},{id:"jsx",name:"JSX",import:()=>Z(()=>import("./jsx-CM4fc1WH.js"),[])},{id:"julia",name:"Julia",aliases:["jl"],import:()=>Z(()=>import("./julia-Czdw582_.js"),__vite__mapDeps([70,32,33,34,35,27,71,15,72]))},{id:"kotlin",name:"Kotlin",aliases:["kt","kts"],import:()=>Z(()=>import("./kotlin-BZRbnyjI.js"),[])},{id:"kusto",name:"Kusto",aliases:["kql"],import:()=>Z(()=>import("./kusto-plSVBvJQ.js"),[])},{id:"latex",name:"LaTeX",import:()=>Z(()=>import("./latex-BpoAco4y.js"),__vite__mapDeps([73,74,72]))},{id:"lean",name:"Lean 4",aliases:["lean4"],import:()=>Z(()=>import("./lean-yLioyJ2E.js"),[])},{id:"less",name:"Less",import:()=>Z(()=>import("./less-Dk1rBueR.js"),[])},{id:"liquid",name:"Liquid",import:()=>Z(()=>import("./liquid-0snwLfvK.js"),__vite__mapDeps([75,14,15,16,22]))},{id:"log",name:"Log file",import:()=>Z(()=>import("./log-B4_rEpOs.js"),[])},{id:"logo",name:"Logo",import:()=>Z(()=>import("./logo-Dtn98rcr.js"),[])},{id:"lua",name:"Lua",import:()=>Z(()=>import("./lua-B2--UKVN.js"),__vite__mapDeps([44,35]))},{id:"luau",name:"Luau",import:()=>Z(()=>import("./luau-DepYB8Ml.js"),[])},{id:"make",name:"Makefile",aliases:["makefile"],import:()=>Z(()=>import("./make-DNDvMORL.js"),[])},{id:"markdown",name:"Markdown",aliases:["md"],import:()=>Z(()=>import("./markdown-CNXuF1yM.js"),[])},{id:"marko",name:"Marko",import:()=>Z(()=>import("./marko-BxSrAFJn.js"),__vite__mapDeps([76,16,77,18,15]))},{id:"matlab",name:"MATLAB",import:()=>Z(()=>import("./matlab-Kxp7UmFj.js"),[])},{id:"mdc",name:"MDC",import:()=>Z(()=>import("./mdc-DfEMzj3F.js"),__vite__mapDeps([78,48,63,39,14,15,16]))},{id:"mdx",name:"MDX",import:()=>Z(()=>import("./mdx-Bcw97oti.js"),[])},{id:"mermaid",name:"Mermaid",aliases:["mmd"],import:()=>Z(()=>import("./mermaid-D0xWnrgR.js"),[])},{id:"mipsasm",name:"MIPS Assembly",aliases:["mips"],import:()=>Z(()=>import("./mipsasm-BzaEo2Du.js"),[])},{id:"mojo",name:"Mojo",import:()=>Z(()=>import("./mojo-B2bjgU-v.js"),[])},{id:"move",name:"Move",import:()=>Z(()=>import("./move-EZUUsui8.js"),[])},{id:"narrat",name:"Narrat Language",aliases:["nar"],import:()=>Z(()=>import("./narrat-DLbgOhZU.js"),[])},{id:"nextflow",name:"Nextflow",aliases:["nf"],import:()=>Z(()=>import("./nextflow-B2uSYIFn.js"),[])},{id:"nginx",name:"Nginx",import:()=>Z(()=>import("./nginx-Dw0nYz9L.js"),__vite__mapDeps([79,44,35]))},{id:"nim",name:"Nim",import:()=>Z(()=>import("./nim-NHYZZDnF.js"),__vite__mapDeps([80,35,14,15,16,20,21,34,48]))},{id:"nix",name:"Nix",import:()=>Z(()=>import("./nix-DVWcdiGS.js"),[])},{id:"nushell",name:"nushell",aliases:["nu"],import:()=>Z(()=>import("./nushell-ZJvK9Z2N.js"),[])},{id:"objective-c",name:"Objective-C",aliases:["objc"],import:()=>Z(()=>import("./objective-c-B6NdQBKR.js"),[])},{id:"objective-cpp",name:"Objective-C++",import:()=>Z(()=>import("./objective-cpp-BkG9CdHo.js"),[])},{id:"ocaml",name:"OCaml",import:()=>Z(()=>import("./ocaml-CLmbwNS9.js"),[])},{id:"pascal",name:"Pascal",import:()=>Z(()=>import("./pascal-JqZropPD.js"),[])},{id:"perl",name:"Perl",import:()=>Z(()=>import("./perl-DLffUHFU.js"),__vite__mapDeps([81,14,15,16,20,21,27]))},{id:"php",name:"PHP",import:()=>Z(()=>import("./php-D3VTUn6x.js"),__vite__mapDeps([82,14,15,16,20,21,27,22]))},{id:"plsql",name:"PL/SQL",import:()=>Z(()=>import("./plsql-LKU2TuZ1.js"),[])},{id:"po",name:"Gettext PO",aliases:["pot","potx"],import:()=>Z(()=>import("./po-BFLt1xDp.js"),[])},{id:"postcss",name:"PostCSS",import:()=>Z(()=>import("./postcss-DmF4-xLG.js"),[])},{id:"powerquery",name:"PowerQuery",import:()=>Z(()=>import("./powerquery-ByY1Guvr.js"),[])},{id:"powershell",name:"PowerShell",aliases:["ps","ps1"],import:()=>Z(()=>import("./powershell-DES0gjzB.js"),[])},{id:"prisma",name:"Prisma",import:()=>Z(()=>import("./prisma-DFIOpqzz.js"),[])},{id:"prolog",name:"Prolog",import:()=>Z(()=>import("./prolog-BNxDCkIA.js"),[])},{id:"proto",name:"Protocol Buffer 3",aliases:["protobuf"],import:()=>Z(()=>import("./proto-hdsyEllQ.js"),[])},{id:"pug",name:"Pug",aliases:["jade"],import:()=>Z(()=>import("./pug-BbGfWiEl.js"),__vite__mapDeps([83,15,16,14]))},{id:"puppet",name:"Puppet",import:()=>Z(()=>import("./puppet-DWMP3yrW.js"),[])},{id:"purescript",name:"PureScript",import:()=>Z(()=>import("./purescript-DvQyZZSe.js"),[])},{id:"python",name:"Python",aliases:["py"],import:()=>Z(()=>import("./python-CK56Z9cH.js"),[])},{id:"qml",name:"QML",import:()=>Z(()=>import("./qml-Dhho_E4W.js"),__vite__mapDeps([84,15]))},{id:"qmldir",name:"QML Directory",import:()=>Z(()=>import("./qmldir-C8lEn-DE.js"),[])},{id:"qss",name:"Qt Style Sheets",import:()=>Z(()=>import("./qss-DhMKtDLN.js"),[])},{id:"r",name:"R",import:()=>Z(()=>import("./r-Cqv5JV-q.js"),[])},{id:"racket",name:"Racket",import:()=>Z(()=>import("./racket-CwIbMU3B.js"),[])},{id:"raku",name:"Raku",aliases:["perl6"],import:()=>Z(()=>import("./raku-DZ4hUExO.js"),[])},{id:"razor",name:"ASP.NET Razor",import:()=>Z(()=>import("./razor-CDyaIOPG.js"),__vite__mapDeps([85,14,15,16,86]))},{id:"reg",name:"Windows Registry Script",import:()=>Z(()=>import("./reg-CrOfvjVs.js"),[])},{id:"regexp",name:"RegExp",aliases:["regex"],import:()=>Z(()=>import("./regexp-DoiKbUTj.js"),[])},{id:"rel",name:"Rel",import:()=>Z(()=>import("./rel-Dzwn3p-3.js"),[])},{id:"riscv",name:"RISC-V",import:()=>Z(()=>import("./riscv-BGct0Hx7.js"),[])},{id:"rst",name:"reStructuredText",import:()=>Z(()=>import("./rst-BtGMdPX_.js"),__vite__mapDeps([87,39,14,15,16,32,33,34,35,27,71,37,63,88,43,20,21,44]))},{id:"ruby",name:"Ruby",aliases:["rb"],import:()=>Z(()=>import("./ruby-C8Yez0Ov.js"),__vite__mapDeps([43,14,15,16,20,21,27,35,37,44]))},{id:"rust",name:"Rust",aliases:["rs"],import:()=>Z(()=>import("./rust-Bjs2cL5p.js"),[])},{id:"sas",name:"SAS",import:()=>Z(()=>import("./sas-K_Wwm3IX.js"),__vite__mapDeps([89,27]))},{id:"sass",name:"Sass",import:()=>Z(()=>import("./sass-BrbOHqWv.js"),[])},{id:"scala",name:"Scala",import:()=>Z(()=>import("./scala-Lp17StYA.js"),[])},{id:"scheme",name:"Scheme",import:()=>Z(()=>import("./scheme-BbccZ3y2.js"),[])},{id:"scss",name:"SCSS",import:()=>Z(()=>import("./scss-BfMQ58X7.js"),__vite__mapDeps([18,16]))},{id:"sdbl",name:"1C (Query)",aliases:["1c-query"],import:()=>Z(()=>import("./sdbl-BLhTXw86.js"),[])},{id:"shaderlab",name:"ShaderLab",aliases:["shader"],import:()=>Z(()=>import("./shaderlab-CsYUIUcf.js"),__vite__mapDeps([90,91]))},{id:"shellscript",name:"Shell",aliases:["bash","sh","shell","zsh"],import:()=>Z(()=>import("./shellscript-HNM5thJl.js"),[])},{id:"shellsession",name:"Shell Session",aliases:["console"],import:()=>Z(()=>import("./shellsession-DU_2P5ZA.js"),__vite__mapDeps([92,37]))},{id:"smalltalk",name:"Smalltalk",import:()=>Z(()=>import("./smalltalk-DsCg8CPl.js"),[])},{id:"solidity",name:"Solidity",import:()=>Z(()=>import("./solidity-DymQr0nX.js"),[])},{id:"soy",name:"Closure Templates",aliases:["closure-templates"],import:()=>Z(()=>import("./soy-aWhPD8Nq.js"),__vite__mapDeps([93,14,15,16]))},{id:"sparql",name:"SPARQL",import:()=>Z(()=>import("./sparql-B5YtT9lV.js"),__vite__mapDeps([94,95]))},{id:"splunk",name:"Splunk Query Language",aliases:["spl"],import:()=>Z(()=>import("./splunk-j_FrBdja.js"),[])},{id:"sql",name:"SQL",import:()=>Z(()=>import("./sql-D8nBeWSR.js"),[])},{id:"ssh-config",name:"SSH Config",import:()=>Z(()=>import("./ssh-config-D-RymO5g.js"),[])},{id:"stata",name:"Stata",import:()=>Z(()=>import("./stata-bRt97scT.js"),__vite__mapDeps([96,27]))},{id:"stylus",name:"Stylus",aliases:["styl"],import:()=>Z(()=>import("./stylus-DwU8c_yx.js"),[])},{id:"svelte",name:"Svelte",import:()=>Z(()=>import("./svelte-DK3KTNg_.js"),__vite__mapDeps([97,15,24,16,25]))},{id:"swift",name:"Swift",import:()=>Z(()=>import("./swift-D2TqM893.js"),[])},{id:"system-verilog",name:"SystemVerilog",import:()=>Z(()=>import("./system-verilog-DFQ4Xr-4.js"),[])},{id:"systemd",name:"Systemd Units",import:()=>Z(()=>import("./systemd-DA0ESIWO.js"),[])},{id:"talonscript",name:"TalonScript",aliases:["talon"],import:()=>Z(()=>import("./talonscript-CGXjegLJ.js"),[])},{id:"tasl",name:"Tasl",import:()=>Z(()=>import("./tasl-CQjiPCtT.js"),[])},{id:"tcl",name:"Tcl",import:()=>Z(()=>import("./tcl-NUI3YrRW.js"),[])},{id:"templ",name:"Templ",import:()=>Z(()=>import("./templ-CP2hJ0oK.js"),__vite__mapDeps([98,99,15,16]))},{id:"terraform",name:"Terraform",aliases:["tf","tfvars"],import:()=>Z(()=>import("./terraform-rf8nNrOk.js"),[])},{id:"tex",name:"TeX",import:()=>Z(()=>import("./tex-Dej6pUpk.js"),__vite__mapDeps([74,72]))},{id:"toml",name:"TOML",import:()=>Z(()=>import("./toml-Dwo6uFCY.js"),[])},{id:"ts-tags",name:"TypeScript with Tags",aliases:["lit"],import:()=>Z(()=>import("./ts-tags-CiO5kd_m.js"),__vite__mapDeps([100,24,16,15,34,35,14,27,20,21]))},{id:"tsv",name:"TSV",import:()=>Z(()=>import("./tsv-B_m7g4N7.js"),[])},{id:"tsx",name:"TSX",import:()=>Z(()=>import("./tsx-DqpEK-75.js"),[])},{id:"turtle",name:"Turtle",import:()=>Z(()=>import("./turtle-C0hdQUNN.js"),[])},{id:"twig",name:"Twig",import:()=>Z(()=>import("./twig-DN6YEzOP.js"),__vite__mapDeps([101,16,15,18,82,14,20,21,27,22,71,43,35,37,44]))},{id:"typescript",name:"TypeScript",aliases:["ts"],import:()=>Z(()=>import("./typescript-CVESyXxo.js"),[])},{id:"typespec",name:"TypeSpec",aliases:["tsp"],import:()=>Z(()=>import("./typespec-B_R80ZlN.js"),[])},{id:"typst",name:"Typst",aliases:["typ"],import:()=>Z(()=>import("./typst-F89DG-fP.js"),[])},{id:"v",name:"V",import:()=>Z(()=>import("./v-DH4N8IuU.js"),[])},{id:"vala",name:"Vala",import:()=>Z(()=>import("./vala-C8pgRvQH.js"),[])},{id:"vb",name:"Visual Basic",aliases:["cmd"],import:()=>Z(()=>import("./vb-Bv-mwDEg.js"),[])},{id:"verilog",name:"Verilog",import:()=>Z(()=>import("./verilog-6RUVFG9U.js"),[])},{id:"vhdl",name:"VHDL",import:()=>Z(()=>import("./vhdl-IBB5Tl9j.js"),[])},{id:"viml",name:"Vim Script",aliases:["vim","vimscript"],import:()=>Z(()=>import("./viml-CIxipgmy.js"),[])},{id:"vue",name:"Vue",import:()=>Z(()=>import("./vue-xldAUJov.js"),__vite__mapDeps([102,14,15,16,24,22,39]))},{id:"vue-html",name:"Vue HTML",import:()=>Z(()=>import("./vue-html-x3hEOujm.js"),__vite__mapDeps([103,102,14,15,16,24,22,39]))},{id:"vyper",name:"Vyper",aliases:["vy"],import:()=>Z(()=>import("./vyper-DzaHHFTY.js"),[])},{id:"wasm",name:"WebAssembly",import:()=>Z(()=>import("./wasm-sH2JAGjN.js"),[])},{id:"wenyan",name:"Wenyan",aliases:["文言"],import:()=>Z(()=>import("./wenyan-7A4Fjokl.js"),[])},{id:"wgsl",name:"WGSL",import:()=>Z(()=>import("./wgsl-CSoQzgif.js"),[])},{id:"wikitext",name:"Wikitext",aliases:["mediawiki","wiki"],import:()=>Z(()=>import("./wikitext-BqtQrzRp.js"),[])},{id:"wolfram",name:"Wolfram",aliases:["wl"],import:()=>Z(()=>import("./wolfram-aeT0-ak7.js"),[])},{id:"xml",name:"XML",import:()=>Z(()=>import("./xml-BOQ9RtXF.js"),__vite__mapDeps([20,21]))},{id:"xsl",name:"XSL",import:()=>Z(()=>import("./xsl-BqG2VzO2.js"),__vite__mapDeps([104,20,21]))},{id:"yaml",name:"YAML",aliases:["yml"],import:()=>Z(()=>import("./yaml-CIiI48o2.js"),[])},{id:"zenscript",name:"ZenScript",import:()=>Z(()=>import("./zenscript-NgWrSVUg.js"),[])},{id:"zig",name:"Zig",import:()=>Z(()=>import("./zig-D44NvAEk.js"),[])}],CLe=Object.fromEntries(EV.map(t=>[t.id,t.import])),kLe=Object.fromEntries(EV.flatMap(t=>t.aliases?.map(e=>[e,t.import])||[])),xV={...CLe,...kLe},ALe=[{id:"andromeeda",displayName:"Andromeeda",type:"dark",import:()=>Z(()=>import("./andromeeda-C3khCPGq.js"),[])},{id:"aurora-x",displayName:"Aurora X",type:"dark",import:()=>Z(()=>import("./aurora-x-D-2ljcwZ.js"),[])},{id:"ayu-dark",displayName:"Ayu Dark",type:"dark",import:()=>Z(()=>import("./ayu-dark-Cv9koXgw.js"),[])},{id:"catppuccin-frappe",displayName:"Catppuccin Frappé",type:"dark",import:()=>Z(()=>import("./catppuccin-frappe-CD_QflpE.js"),[])},{id:"catppuccin-latte",displayName:"Catppuccin Latte",type:"light",import:()=>Z(()=>import("./catppuccin-latte-DRW-0cLl.js"),[])},{id:"catppuccin-macchiato",displayName:"Catppuccin Macchiato",type:"dark",import:()=>Z(()=>import("./catppuccin-macchiato-C-_shW-Y.js"),[])},{id:"catppuccin-mocha",displayName:"Catppuccin Mocha",type:"dark",import:()=>Z(()=>import("./catppuccin-mocha-LGGdnPYs.js"),[])},{id:"dark-plus",displayName:"Dark Plus",type:"dark",import:()=>Z(()=>import("./dark-plus-B74Y8nHz.js"),[])},{id:"dracula",displayName:"Dracula Theme",type:"dark",import:()=>Z(()=>import("./dracula-BzJJZx-M.js"),[])},{id:"dracula-soft",displayName:"Dracula Theme Soft",type:"dark",import:()=>Z(()=>import("./dracula-soft-BXkSAIEj.js"),[])},{id:"everforest-dark",displayName:"Everforest Dark",type:"dark",import:()=>Z(()=>import("./everforest-dark-BgDCqdQA.js"),[])},{id:"everforest-light",displayName:"Everforest Light",type:"light",import:()=>Z(()=>import("./everforest-light-C8M2exoo.js"),[])},{id:"github-dark",displayName:"GitHub Dark",type:"dark",import:()=>Z(()=>import("./github-dark-DHJKELXO.js"),[])},{id:"github-dark-default",displayName:"GitHub Dark Default",type:"dark",import:()=>Z(()=>import("./github-dark-default-Cuk6v7N8.js"),[])},{id:"github-dark-dimmed",displayName:"GitHub Dark Dimmed",type:"dark",import:()=>Z(()=>import("./github-dark-dimmed-DH5Ifo-i.js"),[])},{id:"github-dark-high-contrast",displayName:"GitHub Dark High Contrast",type:"dark",import:()=>Z(()=>import("./github-dark-high-contrast-E3gJ1_iC.js"),[])},{id:"github-light",displayName:"GitHub Light",type:"light",import:()=>Z(()=>import("./github-light-DAi9KRSo.js"),[])},{id:"github-light-default",displayName:"GitHub Light Default",type:"light",import:()=>Z(()=>import("./github-light-default-D7oLnXFd.js"),[])},{id:"github-light-high-contrast",displayName:"GitHub Light High Contrast",type:"light",import:()=>Z(()=>import("./github-light-high-contrast-BfjtVDDH.js"),[])},{id:"houston",displayName:"Houston",type:"dark",import:()=>Z(()=>import("./houston-DnULxvSX.js"),[])},{id:"kanagawa-dragon",displayName:"Kanagawa Dragon",type:"dark",import:()=>Z(()=>import("./kanagawa-dragon-RXHOmnpW.js"),[])},{id:"kanagawa-lotus",displayName:"Kanagawa Lotus",type:"light",import:()=>Z(()=>import("./kanagawa-lotus-zchoCBdH.js"),[])},{id:"kanagawa-wave",displayName:"Kanagawa Wave",type:"dark",import:()=>Z(()=>import("./kanagawa-wave-2aygx1xg.js"),[])},{id:"laserwave",displayName:"LaserWave",type:"dark",import:()=>Z(()=>import("./laserwave-DUszq2jm.js"),[])},{id:"light-plus",displayName:"Light Plus",type:"light",import:()=>Z(()=>import("./light-plus-w1el_4yc.js"),[])},{id:"material-theme",displayName:"Material Theme",type:"dark",import:()=>Z(()=>import("./material-theme-D5KoaKCx.js"),[])},{id:"material-theme-darker",displayName:"Material Theme Darker",type:"dark",import:()=>Z(()=>import("./material-theme-darker-BfHTSMKl.js"),[])},{id:"material-theme-lighter",displayName:"Material Theme Lighter",type:"light",import:()=>Z(()=>import("./material-theme-lighter-B0m2ddpp.js"),[])},{id:"material-theme-ocean",displayName:"Material Theme Ocean",type:"dark",import:()=>Z(()=>import("./material-theme-ocean-CyktbL80.js"),[])},{id:"material-theme-palenight",displayName:"Material Theme Palenight",type:"dark",import:()=>Z(()=>import("./material-theme-palenight-Csfq5Kiy.js"),[])},{id:"min-dark",displayName:"Min Dark",type:"dark",import:()=>Z(()=>import("./min-dark-CafNBF8u.js"),[])},{id:"min-light",displayName:"Min Light",type:"light",import:()=>Z(()=>import("./min-light-CTRr51gU.js"),[])},{id:"monokai",displayName:"Monokai",type:"dark",import:()=>Z(()=>import("./monokai-CQWsIgnU.js"),[])},{id:"night-owl",displayName:"Night Owl",type:"dark",import:()=>Z(()=>import("./night-owl-C6J8XiCD.js"),[])},{id:"nord",displayName:"Nord",type:"dark",import:()=>Z(()=>import("./nord-Ddv68eIx.js"),[])},{id:"one-dark-pro",displayName:"One Dark Pro",type:"dark",import:()=>Z(()=>import("./one-dark-pro-GBQ2dnAY.js"),[])},{id:"one-light",displayName:"One Light",type:"light",import:()=>Z(()=>import("./one-light-PoHY5YXO.js"),[])},{id:"plastic",displayName:"Plastic",type:"dark",import:()=>Z(()=>import("./plastic-3e1v2bzS.js"),[])},{id:"poimandres",displayName:"Poimandres",type:"dark",import:()=>Z(()=>import("./poimandres-CS3Unz2-.js"),[])},{id:"red",displayName:"Red",type:"dark",import:()=>Z(()=>import("./red-2pWuV6-S.js"),[])},{id:"rose-pine",displayName:"Rosé Pine",type:"dark",import:()=>Z(()=>import("./rose-pine-CmCqftbK.js"),[])},{id:"rose-pine-dawn",displayName:"Rosé Pine Dawn",type:"light",import:()=>Z(()=>import("./rose-pine-dawn-Ds-gbosJ.js"),[])},{id:"rose-pine-moon",displayName:"Rosé Pine Moon",type:"dark",import:()=>Z(()=>import("./rose-pine-moon-CjDtw9vr.js"),[])},{id:"slack-dark",displayName:"Slack Dark",type:"dark",import:()=>Z(()=>import("./slack-dark-BthQWCQV.js"),[])},{id:"slack-ochin",displayName:"Slack Ochin",type:"light",import:()=>Z(()=>import("./slack-ochin-DqwNpetd.js"),[])},{id:"snazzy-light",displayName:"Snazzy Light",type:"light",import:()=>Z(()=>import("./snazzy-light-Bw305WKR.js"),[])},{id:"solarized-dark",displayName:"Solarized Dark",type:"dark",import:()=>Z(()=>import("./solarized-dark-CmY0Y6Yh.js"),[])},{id:"solarized-light",displayName:"Solarized Light",type:"light",import:()=>Z(()=>import("./solarized-light-DZQMDcrx.js"),[])},{id:"synthwave-84",displayName:"Synthwave '84",type:"dark",import:()=>Z(()=>import("./synthwave-84-CbfX1IO0.js"),[])},{id:"tokyo-night",displayName:"Tokyo Night",type:"dark",import:()=>Z(()=>import("./tokyo-night-DBQeEorK.js"),[])},{id:"vesper",displayName:"Vesper",type:"dark",import:()=>Z(()=>import("./vesper-BEBZ7ncR.js"),[])},{id:"vitesse-black",displayName:"Vitesse Black",type:"dark",import:()=>Z(()=>import("./vitesse-black-Bkuqu6BP.js"),[])},{id:"vitesse-dark",displayName:"Vitesse Dark",type:"dark",import:()=>Z(()=>import("./vitesse-dark-D0r3Knsf.js"),[])},{id:"vitesse-light",displayName:"Vitesse Light",type:"light",import:()=>Z(()=>import("./vitesse-light-CVO1_9PV.js"),[])}],RLe=Object.fromEntries(ALe.map(t=>[t.id,t.import]));let vo=class extends Error{constructor(e){super(e),this.name="ShikiError"}},LA=class extends Error{constructor(e){super(e),this.name="ShikiError"}};function ILe(){return 2147483648}function PLe(){return typeof performance<"u"?performance.now():Date.now()}const OLe=(t,e)=>t+(e-t%e)%e;async function DLe(t){let e,r;const n={};function s(f){r=f,n.HEAPU8=new Uint8Array(f),n.HEAPU32=new Uint32Array(f)}function i(f,g,_){n.HEAPU8.copyWithin(f,g,g+_)}function o(f){try{return e.grow(f-r.byteLength+65535>>>16),s(e.buffer),1}catch{}}function a(f){const g=n.HEAPU8.length;f=f>>>0;const _=ILe();if(f>_)return!1;for(let m=1;m<=4;m*=2){let p=g*(1+.2/m);p=Math.min(p,f+100663296);const y=Math.min(_,OLe(Math.max(f,p),65536));if(o(y))return!0}return!1}const l=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function c(f,g,_=1024){const m=g+_;let p=g;for(;f[p]&&!(p>=m);)++p;if(p-g>16&&f.buffer&&l)return l.decode(f.subarray(g,p));let y="";for(;g<p;){let b=f[g++];if(!(b&128)){y+=String.fromCharCode(b);continue}const v=f[g++]&63;if((b&224)===192){y+=String.fromCharCode((b&31)<<6|v);continue}const w=f[g++]&63;if((b&240)===224?b=(b&15)<<12|v<<6|w:b=(b&7)<<18|v<<12|w<<6|f[g++]&63,b<65536)y+=String.fromCharCode(b);else{const E=b-65536;y+=String.fromCharCode(55296|E>>10,56320|E&1023)}}return y}function u(f,g){return f?c(n.HEAPU8,f,g):""}const h={emscripten_get_now:PLe,emscripten_memcpy_big:i,emscripten_resize_heap:a,fd_write:()=>0};async function d(){const g=await t({env:h,wasi_snapshot_preview1:h});e=g.memory,s(e.buffer),Object.assign(n,g),n.UTF8ToString=u}return await d(),n}let Tr=null;function LLe(t){throw new LA(t.UTF8ToString(t.getLastOnigError()))}class qb{static _utf8ByteLength(e){let r=0;for(let n=0,s=e.length;n<s;n++){const i=e.charCodeAt(n);let o=i,a=!1;if(i>=55296&&i<=56319&&n+1<s){const l=e.charCodeAt(n+1);l>=56320&&l<=57343&&(o=(i-55296<<10)+65536|l-56320,a=!0)}o<=127?r+=1:o<=2047?r+=2:o<=65535?r+=3:r+=4,a&&n++}return r}utf16Length;utf8Length;utf16Value;utf8Value;utf16OffsetToUtf8;utf8OffsetToUtf16;constructor(e){const r=e.length,n=qb._utf8ByteLength(e),s=n!==r,i=s?new Uint32Array(r+1):null;s&&(i[r]=n);const o=s?new Uint32Array(n+1):null;s&&(o[n]=r);const a=new Uint8Array(n);let l=0;for(let c=0;c<r;c++){const u=e.charCodeAt(c);let h=u,d=!1;if(u>=55296&&u<=56319&&c+1<r){const f=e.charCodeAt(c+1);f>=56320&&f<=57343&&(h=(u-55296<<10)+65536|f-56320,d=!0)}s&&(i[c]=l,d&&(i[c+1]=l),h<=127?o[l+0]=c:h<=2047?(o[l+0]=c,o[l+1]=c):h<=65535?(o[l+0]=c,o[l+1]=c,o[l+2]=c):(o[l+0]=c,o[l+1]=c,o[l+2]=c,o[l+3]=c)),h<=127?a[l++]=h:h<=2047?(a[l++]=192|(h&1984)>>>6,a[l++]=128|(h&63)>>>0):h<=65535?(a[l++]=224|(h&61440)>>>12,a[l++]=128|(h&4032)>>>6,a[l++]=128|(h&63)>>>0):(a[l++]=240|(h&1835008)>>>18,a[l++]=128|(h&258048)>>>12,a[l++]=128|(h&4032)>>>6,a[l++]=128|(h&63)>>>0),d&&c++}this.utf16Length=r,this.utf8Length=n,this.utf16Value=e,this.utf8Value=a,this.utf16OffsetToUtf8=i,this.utf8OffsetToUtf16=o}createString(e){const r=e.omalloc(this.utf8Length);return e.HEAPU8.set(this.utf8Value,r),r}}class us{static LAST_ID=0;static _sharedPtr=0;static _sharedPtrInUse=!1;id=++us.LAST_ID;_onigBinding;content;utf16Length;utf8Length;utf16OffsetToUtf8;utf8OffsetToUtf16;ptr;constructor(e){if(!Tr)throw new LA("Must invoke loadWasm first.");this._onigBinding=Tr,this.content=e;const r=new qb(e);this.utf16Length=r.utf16Length,this.utf8Length=r.utf8Length,this.utf16OffsetToUtf8=r.utf16OffsetToUtf8,this.utf8OffsetToUtf16=r.utf8OffsetToUtf16,this.utf8Length<1e4&&!us._sharedPtrInUse?(us._sharedPtr||(us._sharedPtr=Tr.omalloc(1e4)),us._sharedPtrInUse=!0,Tr.HEAPU8.set(r.utf8Value,us._sharedPtr),this.ptr=us._sharedPtr):this.ptr=r.createString(Tr)}convertUtf8OffsetToUtf16(e){return this.utf8OffsetToUtf16?e<0?0:e>this.utf8Length?this.utf16Length:this.utf8OffsetToUtf16[e]:e}convertUtf16OffsetToUtf8(e){return this.utf16OffsetToUtf8?e<0?0:e>this.utf16Length?this.utf8Length:this.utf16OffsetToUtf8[e]:e}dispose(){this.ptr===us._sharedPtr?us._sharedPtrInUse=!1:this._onigBinding.ofree(this.ptr)}}class NLe{_onigBinding;_ptr;constructor(e){if(!Tr)throw new LA("Must invoke loadWasm first.");const r=[],n=[];for(let a=0,l=e.length;a<l;a++){const c=new qb(e[a]);r[a]=c.createString(Tr),n[a]=c.utf8Length}const s=Tr.omalloc(4*e.length);Tr.HEAPU32.set(r,s/4);const i=Tr.omalloc(4*e.length);Tr.HEAPU32.set(n,i/4);const o=Tr.createOnigScanner(s,i,e.length);for(let a=0,l=e.length;a<l;a++)Tr.ofree(r[a]);Tr.ofree(i),Tr.ofree(s),o===0&&LLe(Tr),this._onigBinding=Tr,this._ptr=o}dispose(){this._onigBinding.freeOnigScanner(this._ptr)}findNextMatchSync(e,r,n){let s=0;if(typeof n=="number"&&(s=n),typeof e=="string"){e=new us(e);const i=this._findNextMatchSync(e,r,!1,s);return e.dispose(),i}return this._findNextMatchSync(e,r,!1,s)}_findNextMatchSync(e,r,n,s){const i=this._onigBinding,o=i.findNextOnigScannerMatch(this._ptr,e.id,e.ptr,e.utf8Length,e.convertUtf16OffsetToUtf8(r),s);if(o===0)return null;const a=i.HEAPU32;let l=o/4;const c=a[l++],u=a[l++],h=[];for(let d=0;d<u;d++){const f=e.convertUtf8OffsetToUtf16(a[l++]),g=e.convertUtf8OffsetToUtf16(a[l++]);h[d]={start:f,end:g,length:g-f}}return{index:c,captureIndices:h}}}function MLe(t){return typeof t.instantiator=="function"}function BLe(t){return typeof t.default=="function"}function FLe(t){return typeof t.data<"u"}function jLe(t){return typeof Response<"u"&&t instanceof Response}function ULe(t){return typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||ArrayBuffer.isView(t))||typeof Ue<"u"&&Ue.isBuffer?.(t)||typeof SharedArrayBuffer<"u"&&t instanceof SharedArrayBuffer||typeof Uint32Array<"u"&&t instanceof Uint32Array}let Tg;function $Le(t){if(Tg)return Tg;async function e(){Tr=await DLe(async r=>{let n=t;return n=await n,typeof n=="function"&&(n=await n(r)),typeof n=="function"&&(n=await n(r)),MLe(n)?n=await n.instantiator(r):BLe(n)?n=await n.default(r):(FLe(n)&&(n=n.data),jLe(n)?typeof WebAssembly.instantiateStreaming=="function"?n=await HLe(n)(r):n=await zLe(n)(r):ULe(n)?n=await s1(n)(r):n instanceof WebAssembly.Module?n=await s1(n)(r):"default"in n&&n.default instanceof WebAssembly.Module&&(n=await s1(n.default)(r))),"instance"in n&&(n=n.instance),"exports"in n&&(n=n.exports),n})}return Tg=e(),Tg}function s1(t){return e=>WebAssembly.instantiate(t,e)}function HLe(t){return e=>WebAssembly.instantiateStreaming(t,e)}function zLe(t){return async e=>{const r=await t.arrayBuffer();return WebAssembly.instantiate(r,e)}}let VLe;function GLe(){return VLe}async function SV(t){return t&&await $Le(t),{createScanner(e){return new NLe(e)},createString(e){return new us(e)}}}function WLe(t){return NA(t)}function NA(t){return Array.isArray(t)?qLe(t):typeof t=="object"?KLe(t):t}function qLe(t){let e=[];for(let r=0,n=t.length;r<n;r++)e[r]=NA(t[r]);return e}function KLe(t){let e={};for(let r in t)e[r]=NA(t[r]);return e}function TV(t,...e){return e.forEach(r=>{for(let n in r)t[n]=r[n]}),t}function CV(t){const e=~t.lastIndexOf("/")||~t.lastIndexOf("\\");return e===0?t:~e===t.length-1?CV(t.substring(0,t.length-1)):t.substr(~e+1)}var i1=/\$(\d+)|\${(\d+):\/(downcase|upcase)}/g,Cg=class{static hasCaptures(t){return t===null?!1:(i1.lastIndex=0,i1.test(t))}static replaceCaptures(t,e,r){return t.replace(i1,(n,s,i,o)=>{let a=r[parseInt(s||i,10)];if(a){let l=e.substring(a.start,a.end);for(;l[0]===".";)l=l.substring(1);switch(o){case"downcase":return l.toLowerCase();case"upcase":return l.toUpperCase();default:return l}}else return n})}};function kV(t,e){return t<e?-1:t>e?1:0}function AV(t,e){if(t===null&&e===null)return 0;if(!t)return-1;if(!e)return 1;let r=t.length,n=e.length;if(r===n){for(let s=0;s<r;s++){let i=kV(t[s],e[s]);if(i!==0)return i}return 0}return r-n}function _N(t){return!!(/^#[0-9a-f]{6}$/i.test(t)||/^#[0-9a-f]{8}$/i.test(t)||/^#[0-9a-f]{3}$/i.test(t)||/^#[0-9a-f]{4}$/i.test(t))}function RV(t){return t.replace(/[\-\\\{\}\*\+\?\|\^\$\.\,\[\]\(\)\#\s]/g,"\\$&")}var IV=class{constructor(t){this.fn=t,this.cache=new Map}get(t){if(this.cache.has(t))return this.cache.get(t);const e=this.fn(t);return this.cache.set(t,e),e}},ey=class{constructor(t,e,r){this._colorMap=t,this._defaults=e,this._root=r,this._cachedMatchRoot=new IV(n=>this._root.match(n))}static createFromRawTheme(t,e){return this.createFromParsedTheme(ZLe(t),e)}static createFromParsedTheme(t,e){return QLe(t,e)}getColorMap(){return this._colorMap.getColorMap()}getDefaults(){return this._defaults}match(t){if(t===null)return this._defaults;const e=t.scopeName,n=this._cachedMatchRoot.get(e).find(s=>YLe(t.parent,s.parentScopes));return n?new PV(n.fontStyle,n.foreground,n.background):null}},o1=class f0{constructor(e,r){this.parent=e,this.scopeName=r}static push(e,r){for(const n of r)e=new f0(e,n);return e}static from(...e){let r=null;for(let n=0;n<e.length;n++)r=new f0(r,e[n]);return r}push(e){return new f0(this,e)}getSegments(){let e=this;const r=[];for(;e;)r.push(e.scopeName),e=e.parent;return r.reverse(),r}toString(){return this.getSegments().join(" ")}extends(e){return this===e?!0:this.parent===null?!1:this.parent.extends(e)}getExtensionIfDefined(e){const r=[];let n=this;for(;n&&n!==e;)r.push(n.scopeName),n=n.parent;return n===e?r.reverse():void 0}};function YLe(t,e){if(e.length===0)return!0;for(let r=0;r<e.length;r++){let n=e[r],s=!1;if(n===">"){if(r===e.length-1)return!1;n=e[++r],s=!0}for(;t&&!XLe(t.scopeName,n);){if(s)return!1;t=t.parent}if(!t)return!1;t=t.parent}return!0}function XLe(t,e){return e===t||t.startsWith(e)&&t[e.length]==="."}var PV=class{constructor(t,e,r){this.fontStyle=t,this.foregroundId=e,this.backgroundId=r}};function ZLe(t){if(!t)return[];if(!t.settings||!Array.isArray(t.settings))return[];let e=t.settings,r=[],n=0;for(let s=0,i=e.length;s<i;s++){let o=e[s];if(!o.settings)continue;let a;if(typeof o.scope=="string"){let h=o.scope;h=h.replace(/^[,]+/,""),h=h.replace(/[,]+$/,""),a=h.split(",")}else Array.isArray(o.scope)?a=o.scope:a=[""];let l=-1;if(typeof o.settings.fontStyle=="string"){l=0;let h=o.settings.fontStyle.split(" ");for(let d=0,f=h.length;d<f;d++)switch(h[d]){case"italic":l=l|1;break;case"bold":l=l|2;break;case"underline":l=l|4;break;case"strikethrough":l=l|8;break}}let c=null;typeof o.settings.foreground=="string"&&_N(o.settings.foreground)&&(c=o.settings.foreground);let u=null;typeof o.settings.background=="string"&&_N(o.settings.background)&&(u=o.settings.background);for(let h=0,d=a.length;h<d;h++){let g=a[h].trim().split(" "),_=g[g.length-1],m=null;g.length>1&&(m=g.slice(0,g.length-1),m.reverse()),r[n++]=new JLe(_,m,s,l,c,u)}}return r}var JLe=class{constructor(t,e,r,n,s,i){this.scope=t,this.parentScopes=e,this.index=r,this.fontStyle=n,this.foreground=s,this.background=i}},mo=(t=>(t[t.NotSet=-1]="NotSet",t[t.None=0]="None",t[t.Italic=1]="Italic",t[t.Bold=2]="Bold",t[t.Underline=4]="Underline",t[t.Strikethrough=8]="Strikethrough",t))(mo||{});function QLe(t,e){t.sort((l,c)=>{let u=kV(l.scope,c.scope);return u!==0||(u=AV(l.parentScopes,c.parentScopes),u!==0)?u:l.index-c.index});let r=0,n="#000000",s="#ffffff";for(;t.length>=1&&t[0].scope==="";){let l=t.shift();l.fontStyle!==-1&&(r=l.fontStyle),l.foreground!==null&&(n=l.foreground),l.background!==null&&(s=l.background)}let i=new eNe(e),o=new PV(r,i.getId(n),i.getId(s)),a=new rNe(new US(0,null,-1,0,0),[]);for(let l=0,c=t.length;l<c;l++){let u=t[l];a.insert(0,u.scope,u.parentScopes,u.fontStyle,i.getId(u.foreground),i.getId(u.background))}return new ey(i,o,a)}var eNe=class{constructor(t){if(this._lastColorId=0,this._id2color=[],this._color2id=Object.create(null),Array.isArray(t)){this._isFrozen=!0;for(let e=0,r=t.length;e<r;e++)this._color2id[t[e]]=e,this._id2color[e]=t[e]}else this._isFrozen=!1}getId(t){if(t===null)return 0;t=t.toUpperCase();let e=this._color2id[t];if(e)return e;if(this._isFrozen)throw new Error(`Missing color in color map - ${t}`);return e=++this._lastColorId,this._color2id[t]=e,this._id2color[e]=t,e}getColorMap(){return this._id2color.slice(0)}},tNe=Object.freeze([]),US=class OV{constructor(e,r,n,s,i){this.scopeDepth=e,this.parentScopes=r||tNe,this.fontStyle=n,this.foreground=s,this.background=i}clone(){return new OV(this.scopeDepth,this.parentScopes,this.fontStyle,this.foreground,this.background)}static cloneArr(e){let r=[];for(let n=0,s=e.length;n<s;n++)r[n]=e[n].clone();return r}acceptOverwrite(e,r,n,s){this.scopeDepth>e?console.log("how did this happen?"):this.scopeDepth=e,r!==-1&&(this.fontStyle=r),n!==0&&(this.foreground=n),s!==0&&(this.background=s)}},rNe=class $S{constructor(e,r=[],n={}){this._mainRule=e,this._children=n,this._rulesWithParentScopes=r}static _cmpBySpecificity(e,r){if(e.scopeDepth!==r.scopeDepth)return r.scopeDepth-e.scopeDepth;let n=0,s=0;for(;e.parentScopes[n]===">"&&n++,r.parentScopes[s]===">"&&s++,!(n>=e.parentScopes.length||s>=r.parentScopes.length);){const i=r.parentScopes[s].length-e.parentScopes[n].length;if(i!==0)return i;n++,s++}return r.parentScopes.length-e.parentScopes.length}match(e){if(e!==""){let n=e.indexOf("."),s,i;if(n===-1?(s=e,i=""):(s=e.substring(0,n),i=e.substring(n+1)),this._children.hasOwnProperty(s))return this._children[s].match(i)}const r=this._rulesWithParentScopes.concat(this._mainRule);return r.sort($S._cmpBySpecificity),r}insert(e,r,n,s,i,o){if(r===""){this._doInsertHere(e,n,s,i,o);return}let a=r.indexOf("."),l,c;a===-1?(l=r,c=""):(l=r.substring(0,a),c=r.substring(a+1));let u;this._children.hasOwnProperty(l)?u=this._children[l]:(u=new $S(this._mainRule.clone(),US.cloneArr(this._rulesWithParentScopes)),this._children[l]=u),u.insert(e+1,c,n,s,i,o)}_doInsertHere(e,r,n,s,i){if(r===null){this._mainRule.acceptOverwrite(e,n,s,i);return}for(let o=0,a=this._rulesWithParentScopes.length;o<a;o++){let l=this._rulesWithParentScopes[o];if(AV(l.parentScopes,r)===0){l.acceptOverwrite(e,n,s,i);return}}n===-1&&(n=this._mainRule.fontStyle),s===0&&(s=this._mainRule.foreground),i===0&&(i=this._mainRule.background),this._rulesWithParentScopes.push(new US(e,r,n,s,i))}},ju=class as{static toBinaryStr(e){return e.toString(2).padStart(32,"0")}static print(e){const r=as.getLanguageId(e),n=as.getTokenType(e),s=as.getFontStyle(e),i=as.getForeground(e),o=as.getBackground(e);console.log({languageId:r,tokenType:n,fontStyle:s,foreground:i,background:o})}static getLanguageId(e){return(e&255)>>>0}static getTokenType(e){return(e&768)>>>8}static containsBalancedBrackets(e){return(e&1024)!==0}static getFontStyle(e){return(e&30720)>>>11}static getForeground(e){return(e&16744448)>>>15}static getBackground(e){return(e&4278190080)>>>24}static set(e,r,n,s,i,o,a){let l=as.getLanguageId(e),c=as.getTokenType(e),u=as.containsBalancedBrackets(e)?1:0,h=as.getFontStyle(e),d=as.getForeground(e),f=as.getBackground(e);return r!==0&&(l=r),n!==8&&(c=n),s!==null&&(u=s?1:0),i!==-1&&(h=i),o!==0&&(d=o),a!==0&&(f=a),(l<<0|c<<8|u<<10|h<<11|d<<15|f<<24)>>>0}};function ty(t,e){const r=[],n=nNe(t);let s=n.next();for(;s!==null;){let l=0;if(s.length===2&&s.charAt(1)===":"){switch(s.charAt(0)){case"R":l=1;break;case"L":l=-1;break;default:console.log(`Unknown priority ${s} in scope selector`)}s=n.next()}let c=o();if(r.push({matcher:c,priority:l}),s!==",")break;s=n.next()}return r;function i(){if(s==="-"){s=n.next();const l=i();return c=>!!l&&!l(c)}if(s==="("){s=n.next();const l=a();return s===")"&&(s=n.next()),l}if(yN(s)){const l=[];do l.push(s),s=n.next();while(yN(s));return c=>e(l,c)}return null}function o(){const l=[];let c=i();for(;c;)l.push(c),c=i();return u=>l.every(h=>h(u))}function a(){const l=[];let c=o();for(;c&&(l.push(c),s==="|"||s===",");){do s=n.next();while(s==="|"||s===",");c=o()}return u=>l.some(h=>h(u))}}function yN(t){return!!t&&!!t.match(/[\w\.:]+/)}function nNe(t){let e=/([LR]:|[\w\.:][\w\.:\-]*|[\,\|\-\(\)])/g,r=e.exec(t);return{next:()=>{if(!r)return null;const n=r[0];return r=e.exec(t),n}}}function DV(t){typeof t.dispose=="function"&&t.dispose()}var Gf=class{constructor(t){this.scopeName=t}toKey(){return this.scopeName}},sNe=class{constructor(t,e){this.scopeName=t,this.ruleName=e}toKey(){return`${this.scopeName}#${this.ruleName}`}},iNe=class{constructor(){this._references=[],this._seenReferenceKeys=new Set,this.visitedRule=new Set}get references(){return this._references}add(t){const e=t.toKey();this._seenReferenceKeys.has(e)||(this._seenReferenceKeys.add(e),this._references.push(t))}},oNe=class{constructor(t,e){this.repo=t,this.initialScopeName=e,this.seenFullScopeRequests=new Set,this.seenPartialScopeRequests=new Set,this.seenFullScopeRequests.add(this.initialScopeName),this.Q=[new Gf(this.initialScopeName)]}processQueue(){const t=this.Q;this.Q=[];const e=new iNe;for(const r of t)aNe(r,this.initialScopeName,this.repo,e);for(const r of e.references)if(r instanceof Gf){if(this.seenFullScopeRequests.has(r.scopeName))continue;this.seenFullScopeRequests.add(r.scopeName),this.Q.push(r)}else{if(this.seenFullScopeRequests.has(r.scopeName)||this.seenPartialScopeRequests.has(r.toKey()))continue;this.seenPartialScopeRequests.add(r.toKey()),this.Q.push(r)}}};function aNe(t,e,r,n){const s=r.lookup(t.scopeName);if(!s){if(t.scopeName===e)throw new Error(`No grammar provided for <${e}>`);return}const i=r.lookup(e);t instanceof Gf?p0({baseGrammar:i,selfGrammar:s},n):HS(t.ruleName,{baseGrammar:i,selfGrammar:s,repository:s.repository},n);const o=r.injections(t.scopeName);if(o)for(const a of o)n.add(new Gf(a))}function HS(t,e,r){if(e.repository&&e.repository[t]){const n=e.repository[t];ry([n],e,r)}}function p0(t,e){t.selfGrammar.patterns&&Array.isArray(t.selfGrammar.patterns)&&ry(t.selfGrammar.patterns,{...t,repository:t.selfGrammar.repository},e),t.selfGrammar.injections&&ry(Object.values(t.selfGrammar.injections),{...t,repository:t.selfGrammar.repository},e)}function ry(t,e,r){for(const n of t){if(r.visitedRule.has(n))continue;r.visitedRule.add(n);const s=n.repository?TV({},e.repository,n.repository):e.repository;Array.isArray(n.patterns)&&ry(n.patterns,{...e,repository:s},r);const i=n.include;if(!i)continue;const o=LV(i);switch(o.kind){case 0:p0({...e,selfGrammar:e.baseGrammar},r);break;case 1:p0(e,r);break;case 2:HS(o.ruleName,{...e,repository:s},r);break;case 3:case 4:const a=o.scopeName===e.selfGrammar.scopeName?e.selfGrammar:o.scopeName===e.baseGrammar.scopeName?e.baseGrammar:void 0;if(a){const l={baseGrammar:e.baseGrammar,selfGrammar:a,repository:s};o.kind===4?HS(o.ruleName,l,r):p0(l,r)}else o.kind===4?r.add(new sNe(o.scopeName,o.ruleName)):r.add(new Gf(o.scopeName));break}}}var lNe=class{constructor(){this.kind=0}},cNe=class{constructor(){this.kind=1}},uNe=class{constructor(t){this.ruleName=t,this.kind=2}},hNe=class{constructor(t){this.scopeName=t,this.kind=3}},dNe=class{constructor(t,e){this.scopeName=t,this.ruleName=e,this.kind=4}};function LV(t){if(t==="$base")return new lNe;if(t==="$self")return new cNe;const e=t.indexOf("#");if(e===-1)return new hNe(t);if(e===0)return new uNe(t.substring(1));{const r=t.substring(0,e),n=t.substring(e+1);return new dNe(r,n)}}var fNe=/\\(\d+)/,bN=/\\(\d+)/g,pNe=-1,NV=-2;var Gp=class{constructor(t,e,r,n){this.$location=t,this.id=e,this._name=r||null,this._nameIsCapturing=Cg.hasCaptures(this._name),this._contentName=n||null,this._contentNameIsCapturing=Cg.hasCaptures(this._contentName)}get debugName(){const t=this.$location?`${CV(this.$location.filename)}:${this.$location.line}`:"unknown";return`${this.constructor.name}#${this.id} @ ${t}`}getName(t,e){return!this._nameIsCapturing||this._name===null||t===null||e===null?this._name:Cg.replaceCaptures(this._name,t,e)}getContentName(t,e){return!this._contentNameIsCapturing||this._contentName===null?this._contentName:Cg.replaceCaptures(this._contentName,t,e)}},mNe=class extends Gp{constructor(t,e,r,n,s){super(t,e,r,n),this.retokenizeCapturedWithRuleId=s}dispose(){}collectPatterns(t,e){throw new Error("Not supported!")}compile(t,e){throw new Error("Not supported!")}compileAG(t,e,r,n){throw new Error("Not supported!")}},gNe=class extends Gp{constructor(t,e,r,n,s){super(t,e,r,null),this._match=new Wf(n,this.id),this.captures=s,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugMatchRegExp(){return`${this._match.source}`}collectPatterns(t,e){e.push(this._match)}compile(t,e){return this._getCachedCompiledPatterns(t).compile(t)}compileAG(t,e,r,n){return this._getCachedCompiledPatterns(t).compileAG(t,r,n)}_getCachedCompiledPatterns(t){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new qf,this.collectPatterns(t,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}},vN=class extends Gp{constructor(t,e,r,n,s){super(t,e,r,n),this.patterns=s.patterns,this.hasMissingPatterns=s.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}collectPatterns(t,e){for(const r of this.patterns)t.getRule(r).collectPatterns(t,e)}compile(t,e){return this._getCachedCompiledPatterns(t).compile(t)}compileAG(t,e,r,n){return this._getCachedCompiledPatterns(t).compileAG(t,r,n)}_getCachedCompiledPatterns(t){return this._cachedCompiledPatterns||(this._cachedCompiledPatterns=new qf,this.collectPatterns(t,this._cachedCompiledPatterns)),this._cachedCompiledPatterns}},zS=class extends Gp{constructor(t,e,r,n,s,i,o,a,l,c){super(t,e,r,n),this._begin=new Wf(s,this.id),this.beginCaptures=i,this._end=new Wf(o||"￿",-1),this.endHasBackReferences=this._end.hasBackReferences,this.endCaptures=a,this.applyEndPatternLast=l||!1,this.patterns=c.patterns,this.hasMissingPatterns=c.hasMissingPatterns,this._cachedCompiledPatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugEndRegExp(){return`${this._end.source}`}getEndWithResolvedBackReferences(t,e){return this._end.resolveBackReferences(t,e)}collectPatterns(t,e){e.push(this._begin)}compile(t,e){return this._getCachedCompiledPatterns(t,e).compile(t)}compileAG(t,e,r,n){return this._getCachedCompiledPatterns(t,e).compileAG(t,r,n)}_getCachedCompiledPatterns(t,e){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new qf;for(const r of this.patterns)t.getRule(r).collectPatterns(t,this._cachedCompiledPatterns);this.applyEndPatternLast?this._cachedCompiledPatterns.push(this._end.hasBackReferences?this._end.clone():this._end):this._cachedCompiledPatterns.unshift(this._end.hasBackReferences?this._end.clone():this._end)}return this._end.hasBackReferences&&(this.applyEndPatternLast?this._cachedCompiledPatterns.setSource(this._cachedCompiledPatterns.length()-1,e):this._cachedCompiledPatterns.setSource(0,e)),this._cachedCompiledPatterns}},ny=class extends Gp{constructor(t,e,r,n,s,i,o,a,l){super(t,e,r,n),this._begin=new Wf(s,this.id),this.beginCaptures=i,this.whileCaptures=a,this._while=new Wf(o,NV),this.whileHasBackReferences=this._while.hasBackReferences,this.patterns=l.patterns,this.hasMissingPatterns=l.hasMissingPatterns,this._cachedCompiledPatterns=null,this._cachedCompiledWhilePatterns=null}dispose(){this._cachedCompiledPatterns&&(this._cachedCompiledPatterns.dispose(),this._cachedCompiledPatterns=null),this._cachedCompiledWhilePatterns&&(this._cachedCompiledWhilePatterns.dispose(),this._cachedCompiledWhilePatterns=null)}get debugBeginRegExp(){return`${this._begin.source}`}get debugWhileRegExp(){return`${this._while.source}`}getWhileWithResolvedBackReferences(t,e){return this._while.resolveBackReferences(t,e)}collectPatterns(t,e){e.push(this._begin)}compile(t,e){return this._getCachedCompiledPatterns(t).compile(t)}compileAG(t,e,r,n){return this._getCachedCompiledPatterns(t).compileAG(t,r,n)}_getCachedCompiledPatterns(t){if(!this._cachedCompiledPatterns){this._cachedCompiledPatterns=new qf;for(const e of this.patterns)t.getRule(e).collectPatterns(t,this._cachedCompiledPatterns)}return this._cachedCompiledPatterns}compileWhile(t,e){return this._getCachedCompiledWhilePatterns(t,e).compile(t)}compileWhileAG(t,e,r,n){return this._getCachedCompiledWhilePatterns(t,e).compileAG(t,r,n)}_getCachedCompiledWhilePatterns(t,e){return this._cachedCompiledWhilePatterns||(this._cachedCompiledWhilePatterns=new qf,this._cachedCompiledWhilePatterns.push(this._while.hasBackReferences?this._while.clone():this._while)),this._while.hasBackReferences&&this._cachedCompiledWhilePatterns.setSource(0,e||"￿"),this._cachedCompiledWhilePatterns}},MV=class Gr{static createCaptureRule(e,r,n,s,i){return e.registerRule(o=>new mNe(r,o,n,s,i))}static getCompiledRuleId(e,r,n){return e.id||r.registerRule(s=>{if(e.id=s,e.match)return new gNe(e.$vscodeTextmateLocation,e.id,e.name,e.match,Gr._compileCaptures(e.captures,r,n));if(typeof e.begin>"u"){e.repository&&(n=TV({},n,e.repository));let i=e.patterns;return typeof i>"u"&&e.include&&(i=[{include:e.include}]),new vN(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,Gr._compilePatterns(i,r,n))}return e.while?new ny(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,Gr._compileCaptures(e.beginCaptures||e.captures,r,n),e.while,Gr._compileCaptures(e.whileCaptures||e.captures,r,n),Gr._compilePatterns(e.patterns,r,n)):new zS(e.$vscodeTextmateLocation,e.id,e.name,e.contentName,e.begin,Gr._compileCaptures(e.beginCaptures||e.captures,r,n),e.end,Gr._compileCaptures(e.endCaptures||e.captures,r,n),e.applyEndPatternLast,Gr._compilePatterns(e.patterns,r,n))}),e.id}static _compileCaptures(e,r,n){let s=[];if(e){let i=0;for(const o in e){if(o==="$vscodeTextmateLocation")continue;const a=parseInt(o,10);a>i&&(i=a)}for(let o=0;o<=i;o++)s[o]=null;for(const o in e){if(o==="$vscodeTextmateLocation")continue;const a=parseInt(o,10);let l=0;e[o].patterns&&(l=Gr.getCompiledRuleId(e[o],r,n)),s[a]=Gr.createCaptureRule(r,e[o].$vscodeTextmateLocation,e[o].name,e[o].contentName,l)}}return s}static _compilePatterns(e,r,n){let s=[];if(e)for(let i=0,o=e.length;i<o;i++){const a=e[i];let l=-1;if(a.include){const c=LV(a.include);switch(c.kind){case 0:case 1:l=Gr.getCompiledRuleId(n[a.include],r,n);break;case 2:let u=n[c.ruleName];u&&(l=Gr.getCompiledRuleId(u,r,n));break;case 3:case 4:const h=c.scopeName,d=c.kind===4?c.ruleName:null,f=r.getExternalGrammar(h,n);if(f)if(d){let g=f.repository[d];g&&(l=Gr.getCompiledRuleId(g,r,f.repository))}else l=Gr.getCompiledRuleId(f.repository.$self,r,f.repository);break}}else l=Gr.getCompiledRuleId(a,r,n);if(l!==-1){const c=r.getRule(l);let u=!1;if((c instanceof vN||c instanceof zS||c instanceof ny)&&c.hasMissingPatterns&&c.patterns.length===0&&(u=!0),u)continue;s.push(l)}}return{patterns:s,hasMissingPatterns:(e?e.length:0)!==s.length}}},Wf=class BV{constructor(e,r){if(e){const n=e.length;let s=0,i=[],o=!1;for(let a=0;a<n;a++)if(e.charAt(a)==="\\"&&a+1<n){const c=e.charAt(a+1);c==="z"?(i.push(e.substring(s,a)),i.push("$(?!\\n)(?<!\\n)"),s=a+2):(c==="A"||c==="G")&&(o=!0),a++}this.hasAnchor=o,s===0?this.source=e:(i.push(e.substring(s,n)),this.source=i.join(""))}else this.hasAnchor=!1,this.source=e;this.hasAnchor?this._anchorCache=this._buildAnchorCache():this._anchorCache=null,this.ruleId=r,this.hasBackReferences=fNe.test(this.source)}clone(){return new BV(this.source,this.ruleId)}setSource(e){this.source!==e&&(this.source=e,this.hasAnchor&&(this._anchorCache=this._buildAnchorCache()))}resolveBackReferences(e,r){let n=r.map(s=>e.substring(s.start,s.end));return bN.lastIndex=0,this.source.replace(bN,(s,i)=>RV(n[parseInt(i,10)]||""))}_buildAnchorCache(){let e=[],r=[],n=[],s=[],i,o,a,l;for(i=0,o=this.source.length;i<o;i++)a=this.source.charAt(i),e[i]=a,r[i]=a,n[i]=a,s[i]=a,a==="\\"&&i+1<o&&(l=this.source.charAt(i+1),l==="A"?(e[i+1]="￿",r[i+1]="￿",n[i+1]="A",s[i+1]="A"):l==="G"?(e[i+1]="￿",r[i+1]="G",n[i+1]="￿",s[i+1]="G"):(e[i+1]=l,r[i+1]=l,n[i+1]=l,s[i+1]=l),i++);return{A0_G0:e.join(""),A0_G1:r.join(""),A1_G0:n.join(""),A1_G1:s.join("")}}resolveAnchors(e,r){return!this.hasAnchor||!this._anchorCache?this.source:e?r?this._anchorCache.A1_G1:this._anchorCache.A1_G0:r?this._anchorCache.A0_G1:this._anchorCache.A0_G0}},qf=class{constructor(){this._items=[],this._hasAnchors=!1,this._cached=null,this._anchorCache={A0_G0:null,A0_G1:null,A1_G0:null,A1_G1:null}}dispose(){this._disposeCaches()}_disposeCaches(){this._cached&&(this._cached.dispose(),this._cached=null),this._anchorCache.A0_G0&&(this._anchorCache.A0_G0.dispose(),this._anchorCache.A0_G0=null),this._anchorCache.A0_G1&&(this._anchorCache.A0_G1.dispose(),this._anchorCache.A0_G1=null),this._anchorCache.A1_G0&&(this._anchorCache.A1_G0.dispose(),this._anchorCache.A1_G0=null),this._anchorCache.A1_G1&&(this._anchorCache.A1_G1.dispose(),this._anchorCache.A1_G1=null)}push(t){this._items.push(t),this._hasAnchors=this._hasAnchors||t.hasAnchor}unshift(t){this._items.unshift(t),this._hasAnchors=this._hasAnchors||t.hasAnchor}length(){return this._items.length}setSource(t,e){this._items[t].source!==e&&(this._disposeCaches(),this._items[t].setSource(e))}compile(t){if(!this._cached){let e=this._items.map(r=>r.source);this._cached=new wN(t,e,this._items.map(r=>r.ruleId))}return this._cached}compileAG(t,e,r){return this._hasAnchors?e?r?(this._anchorCache.A1_G1||(this._anchorCache.A1_G1=this._resolveAnchors(t,e,r)),this._anchorCache.A1_G1):(this._anchorCache.A1_G0||(this._anchorCache.A1_G0=this._resolveAnchors(t,e,r)),this._anchorCache.A1_G0):r?(this._anchorCache.A0_G1||(this._anchorCache.A0_G1=this._resolveAnchors(t,e,r)),this._anchorCache.A0_G1):(this._anchorCache.A0_G0||(this._anchorCache.A0_G0=this._resolveAnchors(t,e,r)),this._anchorCache.A0_G0):this.compile(t)}_resolveAnchors(t,e,r){let n=this._items.map(s=>s.resolveAnchors(e,r));return new wN(t,n,this._items.map(s=>s.ruleId))}},wN=class{constructor(t,e,r){this.regExps=e,this.rules=r,this.scanner=t.createOnigScanner(e)}dispose(){typeof this.scanner.dispose=="function"&&this.scanner.dispose()}toString(){const t=[];for(let e=0,r=this.rules.length;e<r;e++)t.push("   - "+this.rules[e]+": "+this.regExps[e]);return t.join(`
`)}findNextMatchSync(t,e,r){const n=this.scanner.findNextMatchSync(t,e,r);return n?{ruleId:this.rules[n.index],captureIndices:n.captureIndices}:null}},VS=class{constructor(t,e){this.languageId=t,this.tokenType=e}},MA=class GS{constructor(e,r){this._getBasicScopeAttributes=new IV(n=>{const s=this._scopeToLanguage(n),i=this._toStandardTokenType(n);return new VS(s,i)}),this._defaultAttributes=new VS(e,8),this._embeddedLanguagesMatcher=new yNe(Object.entries(r||{}))}getDefaultAttributes(){return this._defaultAttributes}getBasicScopeAttributes(e){return e===null?GS._NULL_SCOPE_METADATA:this._getBasicScopeAttributes.get(e)}_scopeToLanguage(e){return this._embeddedLanguagesMatcher.match(e)||0}_toStandardTokenType(e){const r=e.match(GS.STANDARD_TOKEN_TYPE_REGEXP);if(!r)return 8;switch(r[1]){case"comment":return 1;case"string":return 2;case"regex":return 3;case"meta.embedded":return 0}throw new Error("Unexpected match for standard token type!")}};MA._NULL_SCOPE_METADATA=new VS(0,0);MA.STANDARD_TOKEN_TYPE_REGEXP=/\b(comment|string|regex|meta\.embedded)\b/;var _Ne=MA,yNe=class{constructor(t){if(t.length===0)this.values=null,this.scopesRegExp=null;else{this.values=new Map(t);const e=t.map(([r,n])=>RV(r));e.sort(),e.reverse(),this.scopesRegExp=new RegExp(`^((${e.join(")|(")}))($|\\.)`,"")}}match(t){if(!this.scopesRegExp)return;const e=t.match(this.scopesRegExp);if(e)return this.values.get(e[1])}},EN=class{constructor(t,e){this.stack=t,this.stoppedEarly=e}};function FV(t,e,r,n,s,i,o,a){const l=e.content.length;let c=!1,u=-1;if(o){const f=bNe(t,e,r,n,s,i);s=f.stack,n=f.linePos,r=f.isFirstLine,u=f.anchorPosition}const h=Date.now();for(;!c;){if(a!==0&&Date.now()-h>a)return new EN(s,!0);d()}return new EN(s,!1);function d(){const f=vNe(t,e,r,n,s,u);if(!f){i.produce(s,l),c=!0;return}const g=f.captureIndices,_=f.matchedRuleId,m=g&&g.length>0?g[0].end>n:!1;if(_===pNe){const p=s.getRule(t);i.produce(s,g[0].start),s=s.withContentNameScopesList(s.nameScopesList),dd(t,e,r,s,i,p.endCaptures,g),i.produce(s,g[0].end);const y=s;if(s=s.parent,u=y.getAnchorPos(),!m&&y.getEnterPos()===n){s=y,i.produce(s,l),c=!0;return}}else{const p=t.getRule(_);i.produce(s,g[0].start);const y=s,b=p.getName(e.content,g),v=s.contentNameScopesList.pushAttributed(b,t);if(s=s.push(_,n,u,g[0].end===l,null,v,v),p instanceof zS){const w=p;dd(t,e,r,s,i,w.beginCaptures,g),i.produce(s,g[0].end),u=g[0].end;const E=w.getContentName(e.content,g),S=v.pushAttributed(E,t);if(s=s.withContentNameScopesList(S),w.endHasBackReferences&&(s=s.withEndRule(w.getEndWithResolvedBackReferences(e.content,g))),!m&&y.hasSameRuleAs(s)){s=s.pop(),i.produce(s,l),c=!0;return}}else if(p instanceof ny){const w=p;dd(t,e,r,s,i,w.beginCaptures,g),i.produce(s,g[0].end),u=g[0].end;const E=w.getContentName(e.content,g),S=v.pushAttributed(E,t);if(s=s.withContentNameScopesList(S),w.whileHasBackReferences&&(s=s.withEndRule(w.getWhileWithResolvedBackReferences(e.content,g))),!m&&y.hasSameRuleAs(s)){s=s.pop(),i.produce(s,l),c=!0;return}}else if(dd(t,e,r,s,i,p.captures,g),i.produce(s,g[0].end),s=s.pop(),!m){s=s.safePop(),i.produce(s,l),c=!0;return}}g[0].end>n&&(n=g[0].end,r=!1)}}function bNe(t,e,r,n,s,i){let o=s.beginRuleCapturedEOL?0:-1;const a=[];for(let l=s;l;l=l.pop()){const c=l.getRule(t);c instanceof ny&&a.push({rule:c,stack:l})}for(let l=a.pop();l;l=a.pop()){const{ruleScanner:c,findOptions:u}=xNe(l.rule,t,l.stack.endRule,r,n===o),h=c.findNextMatchSync(e,n,u);if(h){if(h.ruleId!==NV){s=l.stack.pop();break}h.captureIndices&&h.captureIndices.length&&(i.produce(l.stack,h.captureIndices[0].start),dd(t,e,r,l.stack,i,l.rule.whileCaptures,h.captureIndices),i.produce(l.stack,h.captureIndices[0].end),o=h.captureIndices[0].end,h.captureIndices[0].end>n&&(n=h.captureIndices[0].end,r=!1))}else{s=l.stack.pop();break}}return{stack:s,linePos:n,anchorPosition:o,isFirstLine:r}}function vNe(t,e,r,n,s,i){const o=wNe(t,e,r,n,s,i),a=t.getInjections();if(a.length===0)return o;const l=ENe(a,t,e,r,n,s,i);if(!l)return o;if(!o)return l;const c=o.captureIndices[0].start,u=l.captureIndices[0].start;return u<c||l.priorityMatch&&u===c?l:o}function wNe(t,e,r,n,s,i){const o=s.getRule(t),{ruleScanner:a,findOptions:l}=jV(o,t,s.endRule,r,n===i),c=a.findNextMatchSync(e,n,l);return c?{captureIndices:c.captureIndices,matchedRuleId:c.ruleId}:null}function ENe(t,e,r,n,s,i,o){let a=Number.MAX_VALUE,l=null,c,u=0;const h=i.contentNameScopesList.getScopeNames();for(let d=0,f=t.length;d<f;d++){const g=t[d];if(!g.matcher(h))continue;const _=e.getRule(g.ruleId),{ruleScanner:m,findOptions:p}=jV(_,e,null,n,s===o),y=m.findNextMatchSync(r,s,p);if(!y)continue;const b=y.captureIndices[0].start;if(!(b>=a)&&(a=b,l=y.captureIndices,c=y.ruleId,u=g.priority,a===s))break}return l?{priorityMatch:u===-1,captureIndices:l,matchedRuleId:c}:null}function jV(t,e,r,n,s){return{ruleScanner:t.compileAG(e,r,n,s),findOptions:0}}function xNe(t,e,r,n,s){return{ruleScanner:t.compileWhileAG(e,r,n,s),findOptions:0}}function dd(t,e,r,n,s,i,o){if(i.length===0)return;const a=e.content,l=Math.min(i.length,o.length),c=[],u=o[0].end;for(let h=0;h<l;h++){const d=i[h];if(d===null)continue;const f=o[h];if(f.length===0)continue;if(f.start>u)break;for(;c.length>0&&c[c.length-1].endPos<=f.start;)s.produceFromScopes(c[c.length-1].scopes,c[c.length-1].endPos),c.pop();if(c.length>0?s.produceFromScopes(c[c.length-1].scopes,f.start):s.produce(n,f.start),d.retokenizeCapturedWithRuleId){const _=d.getName(a,o),m=n.contentNameScopesList.pushAttributed(_,t),p=d.getContentName(a,o),y=m.pushAttributed(p,t),b=n.push(d.retokenizeCapturedWithRuleId,f.start,-1,!1,null,m,y),v=t.createOnigString(a.substring(0,f.end));FV(t,v,r&&f.start===0,f.start,b,s,!1,0),DV(v);continue}const g=d.getName(a,o);if(g!==null){const m=(c.length>0?c[c.length-1].scopes:n.contentNameScopesList).pushAttributed(g,t);c.push(new SNe(m,f.end))}}for(;c.length>0;)s.produceFromScopes(c[c.length-1].scopes,c[c.length-1].endPos),c.pop()}var SNe=class{constructor(t,e){this.scopes=t,this.endPos=e}};function TNe(t,e,r,n,s,i,o,a){return new kNe(t,e,r,n,s,i,o,a)}function xN(t,e,r,n,s){const i=ty(e,sy),o=MV.getCompiledRuleId(r,n,s.repository);for(const a of i)t.push({debugSelector:e,matcher:a.matcher,ruleId:o,grammar:s,priority:a.priority})}function sy(t,e){if(e.length<t.length)return!1;let r=0;return t.every(n=>{for(let s=r;s<e.length;s++)if(CNe(e[s],n))return r=s+1,!0;return!1})}function CNe(t,e){if(!t)return!1;if(t===e)return!0;const r=e.length;return t.length>r&&t.substr(0,r)===e&&t[r]==="."}var kNe=class{constructor(t,e,r,n,s,i,o,a){if(this._rootScopeName=t,this.balancedBracketSelectors=i,this._onigLib=a,this._basicScopeAttributesProvider=new _Ne(r,n),this._rootId=-1,this._lastRuleId=0,this._ruleId2desc=[null],this._includedGrammars={},this._grammarRepository=o,this._grammar=SN(e,null),this._injections=null,this._tokenTypeMatchers=[],s)for(const l of Object.keys(s)){const c=ty(l,sy);for(const u of c)this._tokenTypeMatchers.push({matcher:u.matcher,type:s[l]})}}get themeProvider(){return this._grammarRepository}dispose(){for(const t of this._ruleId2desc)t&&t.dispose()}createOnigScanner(t){return this._onigLib.createOnigScanner(t)}createOnigString(t){return this._onigLib.createOnigString(t)}getMetadataForScope(t){return this._basicScopeAttributesProvider.getBasicScopeAttributes(t)}_collectInjections(){const t={lookup:s=>s===this._rootScopeName?this._grammar:this.getExternalGrammar(s),injections:s=>this._grammarRepository.injections(s)},e=[],r=this._rootScopeName,n=t.lookup(r);if(n){const s=n.injections;if(s)for(let o in s)xN(e,o,s[o],this,n);const i=this._grammarRepository.injections(r);i&&i.forEach(o=>{const a=this.getExternalGrammar(o);if(a){const l=a.injectionSelector;l&&xN(e,l,a,this,a)}})}return e.sort((s,i)=>s.priority-i.priority),e}getInjections(){return this._injections===null&&(this._injections=this._collectInjections()),this._injections}registerRule(t){const e=++this._lastRuleId,r=t(e);return this._ruleId2desc[e]=r,r}getRule(t){return this._ruleId2desc[t]}getExternalGrammar(t,e){if(this._includedGrammars[t])return this._includedGrammars[t];if(this._grammarRepository){const r=this._grammarRepository.lookup(t);if(r)return this._includedGrammars[t]=SN(r,e&&e.$base),this._includedGrammars[t]}}tokenizeLine(t,e,r=0){const n=this._tokenize(t,e,!1,r);return{tokens:n.lineTokens.getResult(n.ruleStack,n.lineLength),ruleStack:n.ruleStack,stoppedEarly:n.stoppedEarly}}tokenizeLine2(t,e,r=0){const n=this._tokenize(t,e,!0,r);return{tokens:n.lineTokens.getBinaryResult(n.ruleStack,n.lineLength),ruleStack:n.ruleStack,stoppedEarly:n.stoppedEarly}}_tokenize(t,e,r,n){this._rootId===-1&&(this._rootId=MV.getCompiledRuleId(this._grammar.repository.$self,this,this._grammar.repository),this.getInjections());let s;if(!e||e===qS.NULL){s=!0;const c=this._basicScopeAttributesProvider.getDefaultAttributes(),u=this.themeProvider.getDefaults(),h=ju.set(0,c.languageId,c.tokenType,null,u.fontStyle,u.foregroundId,u.backgroundId),d=this.getRule(this._rootId).getName(null,null);let f;d?f=Ud.createRootAndLookUpScopeName(d,h,this):f=Ud.createRoot("unknown",h),e=new qS(null,this._rootId,-1,-1,!1,null,f,f)}else s=!1,e.reset();t=t+`
`;const i=this.createOnigString(t),o=i.content.length,a=new RNe(r,t,this._tokenTypeMatchers,this.balancedBracketSelectors),l=FV(this,i,s,0,e,a,!0,n);return DV(i),{lineLength:o,lineTokens:a,ruleStack:l.stack,stoppedEarly:l.stoppedEarly}}};function SN(t,e){return t=WLe(t),t.repository=t.repository||{},t.repository.$self={$vscodeTextmateLocation:t.$vscodeTextmateLocation,patterns:t.patterns,name:t.scopeName},t.repository.$base=e||t.repository.$self,t}var Ud=class hi{constructor(e,r,n){this.parent=e,this.scopePath=r,this.tokenAttributes=n}static fromExtension(e,r){let n=e,s=e?.scopePath??null;for(const i of r)s=o1.push(s,i.scopeNames),n=new hi(n,s,i.encodedTokenAttributes);return n}static createRoot(e,r){return new hi(null,new o1(null,e),r)}static createRootAndLookUpScopeName(e,r,n){const s=n.getMetadataForScope(e),i=new o1(null,e),o=n.themeProvider.themeMatch(i),a=hi.mergeAttributes(r,s,o);return new hi(null,i,a)}get scopeName(){return this.scopePath.scopeName}toString(){return this.getScopeNames().join(" ")}equals(e){return hi.equals(this,e)}static equals(e,r){do{if(e===r||!e&&!r)return!0;if(!e||!r||e.scopeName!==r.scopeName||e.tokenAttributes!==r.tokenAttributes)return!1;e=e.parent,r=r.parent}while(!0)}static mergeAttributes(e,r,n){let s=-1,i=0,o=0;return n!==null&&(s=n.fontStyle,i=n.foregroundId,o=n.backgroundId),ju.set(e,r.languageId,r.tokenType,null,s,i,o)}pushAttributed(e,r){if(e===null)return this;if(e.indexOf(" ")===-1)return hi._pushAttributed(this,e,r);const n=e.split(/ /g);let s=this;for(const i of n)s=hi._pushAttributed(s,i,r);return s}static _pushAttributed(e,r,n){const s=n.getMetadataForScope(r),i=e.scopePath.push(r),o=n.themeProvider.themeMatch(i),a=hi.mergeAttributes(e.tokenAttributes,s,o);return new hi(e,i,a)}getScopeNames(){return this.scopePath.getSegments()}getExtensionIfDefined(e){const r=[];let n=this;for(;n&&n!==e;)r.push({encodedTokenAttributes:n.tokenAttributes,scopeNames:n.scopePath.getExtensionIfDefined(n.parent?.scopePath??null)}),n=n.parent;return n===e?r.reverse():void 0}},WS=class Lc{constructor(e,r,n,s,i,o,a,l){this.parent=e,this.ruleId=r,this.beginRuleCapturedEOL=i,this.endRule=o,this.nameScopesList=a,this.contentNameScopesList=l,this._stackElementBrand=void 0,this.depth=this.parent?this.parent.depth+1:1,this._enterPos=n,this._anchorPos=s}equals(e){return e===null?!1:Lc._equals(this,e)}static _equals(e,r){return e===r?!0:this._structuralEquals(e,r)?Ud.equals(e.contentNameScopesList,r.contentNameScopesList):!1}static _structuralEquals(e,r){do{if(e===r||!e&&!r)return!0;if(!e||!r||e.depth!==r.depth||e.ruleId!==r.ruleId||e.endRule!==r.endRule)return!1;e=e.parent,r=r.parent}while(!0)}clone(){return this}static _reset(e){for(;e;)e._enterPos=-1,e._anchorPos=-1,e=e.parent}reset(){Lc._reset(this)}pop(){return this.parent}safePop(){return this.parent?this.parent:this}push(e,r,n,s,i,o,a){return new Lc(this,e,r,n,s,i,o,a)}getEnterPos(){return this._enterPos}getAnchorPos(){return this._anchorPos}getRule(e){return e.getRule(this.ruleId)}toString(){const e=[];return this._writeString(e,0),"["+e.join(",")+"]"}_writeString(e,r){return this.parent&&(r=this.parent._writeString(e,r)),e[r++]=`(${this.ruleId}, ${this.nameScopesList?.toString()}, ${this.contentNameScopesList?.toString()})`,r}withContentNameScopesList(e){return this.contentNameScopesList===e?this:this.parent.push(this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,this.endRule,this.nameScopesList,e)}withEndRule(e){return this.endRule===e?this:new Lc(this.parent,this.ruleId,this._enterPos,this._anchorPos,this.beginRuleCapturedEOL,e,this.nameScopesList,this.contentNameScopesList)}hasSameRuleAs(e){let r=this;for(;r&&r._enterPos===e._enterPos;){if(r.ruleId===e.ruleId)return!0;r=r.parent}return!1}toStateStackFrame(){return{ruleId:this.ruleId,beginRuleCapturedEOL:this.beginRuleCapturedEOL,endRule:this.endRule,nameScopesList:this.nameScopesList?.getExtensionIfDefined(this.parent?.nameScopesList??null)??[],contentNameScopesList:this.contentNameScopesList?.getExtensionIfDefined(this.nameScopesList)??[]}}static pushFrame(e,r){const n=Ud.fromExtension(e?.nameScopesList??null,r.nameScopesList);return new Lc(e,r.ruleId,r.enterPos??-1,r.anchorPos??-1,r.beginRuleCapturedEOL,r.endRule,n,Ud.fromExtension(n,r.contentNameScopesList))}};WS.NULL=new WS(null,0,0,0,!1,null,null,null);var qS=WS,ANe=class{constructor(t,e){this.allowAny=!1,this.balancedBracketScopes=t.flatMap(r=>r==="*"?(this.allowAny=!0,[]):ty(r,sy).map(n=>n.matcher)),this.unbalancedBracketScopes=e.flatMap(r=>ty(r,sy).map(n=>n.matcher))}get matchesAlways(){return this.allowAny&&this.unbalancedBracketScopes.length===0}get matchesNever(){return this.balancedBracketScopes.length===0&&!this.allowAny}match(t){for(const e of this.unbalancedBracketScopes)if(e(t))return!1;for(const e of this.balancedBracketScopes)if(e(t))return!0;return this.allowAny}},RNe=class{constructor(t,e,r,n){this.balancedBracketSelectors=n,this._emitBinaryTokens=t,this._tokenTypeOverrides=r,this._lineText=null,this._tokens=[],this._binaryTokens=[],this._lastTokenEndIndex=0}produce(t,e){this.produceFromScopes(t.contentNameScopesList,e)}produceFromScopes(t,e){if(this._lastTokenEndIndex>=e)return;if(this._emitBinaryTokens){let n=t?.tokenAttributes??0,s=!1;if(this.balancedBracketSelectors?.matchesAlways&&(s=!0),this._tokenTypeOverrides.length>0||this.balancedBracketSelectors&&!this.balancedBracketSelectors.matchesAlways&&!this.balancedBracketSelectors.matchesNever){const i=t?.getScopeNames()??[];for(const o of this._tokenTypeOverrides)o.matcher(i)&&(n=ju.set(n,0,o.type,null,-1,0,0));this.balancedBracketSelectors&&(s=this.balancedBracketSelectors.match(i))}if(s&&(n=ju.set(n,0,8,s,-1,0,0)),this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-1]===n){this._lastTokenEndIndex=e;return}this._binaryTokens.push(this._lastTokenEndIndex),this._binaryTokens.push(n),this._lastTokenEndIndex=e;return}const r=t?.getScopeNames()??[];this._tokens.push({startIndex:this._lastTokenEndIndex,endIndex:e,scopes:r}),this._lastTokenEndIndex=e}getResult(t,e){return this._tokens.length>0&&this._tokens[this._tokens.length-1].startIndex===e-1&&this._tokens.pop(),this._tokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(t,e),this._tokens[this._tokens.length-1].startIndex=0),this._tokens}getBinaryResult(t,e){this._binaryTokens.length>0&&this._binaryTokens[this._binaryTokens.length-2]===e-1&&(this._binaryTokens.pop(),this._binaryTokens.pop()),this._binaryTokens.length===0&&(this._lastTokenEndIndex=-1,this.produce(t,e),this._binaryTokens[this._binaryTokens.length-2]=0);const r=new Uint32Array(this._binaryTokens.length);for(let n=0,s=this._binaryTokens.length;n<s;n++)r[n]=this._binaryTokens[n];return r}},INe=class{constructor(t,e){this._onigLib=e,this._grammars=new Map,this._rawGrammars=new Map,this._injectionGrammars=new Map,this._theme=t}dispose(){for(const t of this._grammars.values())t.dispose()}setTheme(t){this._theme=t}getColorMap(){return this._theme.getColorMap()}addGrammar(t,e){this._rawGrammars.set(t.scopeName,t),e&&this._injectionGrammars.set(t.scopeName,e)}lookup(t){return this._rawGrammars.get(t)}injections(t){return this._injectionGrammars.get(t)}getDefaults(){return this._theme.getDefaults()}themeMatch(t){return this._theme.match(t)}grammarForScopeName(t,e,r,n,s){if(!this._grammars.has(t)){let i=this._rawGrammars.get(t);if(!i)return null;this._grammars.set(t,TNe(t,i,e,r,n,s,this,this._onigLib))}return this._grammars.get(t)}},PNe=class{constructor(e){this._options=e,this._syncRegistry=new INe(ey.createFromRawTheme(e.theme,e.colorMap),e.onigLib),this._ensureGrammarCache=new Map}dispose(){this._syncRegistry.dispose()}setTheme(e,r){this._syncRegistry.setTheme(ey.createFromRawTheme(e,r))}getColorMap(){return this._syncRegistry.getColorMap()}loadGrammarWithEmbeddedLanguages(e,r,n){return this.loadGrammarWithConfiguration(e,r,{embeddedLanguages:n})}loadGrammarWithConfiguration(e,r,n){return this._loadGrammar(e,r,n.embeddedLanguages,n.tokenTypes,new ANe(n.balancedBracketSelectors||[],n.unbalancedBracketSelectors||[]))}loadGrammar(e){return this._loadGrammar(e,0,null,null,null)}_loadGrammar(e,r,n,s,i){const o=new oNe(this._syncRegistry,e);for(;o.Q.length>0;)o.Q.map(a=>this._loadSingleGrammar(a.scopeName)),o.processQueue();return this._grammarForScopeName(e,r,n,s,i)}_loadSingleGrammar(e){this._ensureGrammarCache.has(e)||(this._doLoadSingleGrammar(e),this._ensureGrammarCache.set(e,!0))}_doLoadSingleGrammar(e){const r=this._options.loadGrammar(e);if(r){const n=typeof this._options.getInjections=="function"?this._options.getInjections(e):void 0;this._syncRegistry.addGrammar(r,n)}}addGrammar(e,r=[],n=0,s=null){return this._syncRegistry.addGrammar(e,r),this._grammarForScopeName(e.scopeName,n,s)}_grammarForScopeName(e,r=0,n=null,s=null,i=null){return this._syncRegistry.grammarForScopeName(e,r,n,s,i)}},KS=qS.NULL;const ONe=/["&'<>`]/g,DNe=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,LNe=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,NNe=/[|\\{}()[\]^$+*?.]/g,TN=new WeakMap;function MNe(t,e){if(t=t.replace(e.subset?BNe(e.subset):ONe,n),e.subset||e.escapeOnly)return t;return t.replace(DNe,r).replace(LNe,n);function r(s,i,o){return e.format((s.charCodeAt(0)-55296)*1024+s.charCodeAt(1)-56320+65536,o.charCodeAt(i+2),e)}function n(s,i,o){return e.format(s.charCodeAt(0),o.charCodeAt(i+1),e)}}function BNe(t){let e=TN.get(t);return e||(e=FNe(t),TN.set(t,e)),e}function FNe(t){const e=[];let r=-1;for(;++r<t.length;)e.push(t[r].replace(NNe,"\\$&"));return new RegExp("(?:"+e.join("|")+")","g")}const jNe=/[\dA-Fa-f]/;function UNe(t,e,r){const n="&#x"+t.toString(16).toUpperCase();return r&&e&&!jNe.test(String.fromCharCode(e))?n:n+";"}const $Ne=/\d/;function HNe(t,e,r){const n="&#"+String(t);return r&&e&&!$Ne.test(String.fromCharCode(e))?n:n+";"}const zNe=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"],a1={nbsp:" ",iexcl:"¡",cent:"¢",pound:"£",curren:"¤",yen:"¥",brvbar:"¦",sect:"§",uml:"¨",copy:"©",ordf:"ª",laquo:"«",not:"¬",shy:"­",reg:"®",macr:"¯",deg:"°",plusmn:"±",sup2:"²",sup3:"³",acute:"´",micro:"µ",para:"¶",middot:"·",cedil:"¸",sup1:"¹",ordm:"º",raquo:"»",frac14:"¼",frac12:"½",frac34:"¾",iquest:"¿",Agrave:"À",Aacute:"Á",Acirc:"Â",Atilde:"Ã",Auml:"Ä",Aring:"Å",AElig:"Æ",Ccedil:"Ç",Egrave:"È",Eacute:"É",Ecirc:"Ê",Euml:"Ë",Igrave:"Ì",Iacute:"Í",Icirc:"Î",Iuml:"Ï",ETH:"Ð",Ntilde:"Ñ",Ograve:"Ò",Oacute:"Ó",Ocirc:"Ô",Otilde:"Õ",Ouml:"Ö",times:"×",Oslash:"Ø",Ugrave:"Ù",Uacute:"Ú",Ucirc:"Û",Uuml:"Ü",Yacute:"Ý",THORN:"Þ",szlig:"ß",agrave:"à",aacute:"á",acirc:"â",atilde:"ã",auml:"ä",aring:"å",aelig:"æ",ccedil:"ç",egrave:"è",eacute:"é",ecirc:"ê",euml:"ë",igrave:"ì",iacute:"í",icirc:"î",iuml:"ï",eth:"ð",ntilde:"ñ",ograve:"ò",oacute:"ó",ocirc:"ô",otilde:"õ",ouml:"ö",divide:"÷",oslash:"ø",ugrave:"ù",uacute:"ú",ucirc:"û",uuml:"ü",yacute:"ý",thorn:"þ",yuml:"ÿ",fnof:"ƒ",Alpha:"Α",Beta:"Β",Gamma:"Γ",Delta:"Δ",Epsilon:"Ε",Zeta:"Ζ",Eta:"Η",Theta:"Θ",Iota:"Ι",Kappa:"Κ",Lambda:"Λ",Mu:"Μ",Nu:"Ν",Xi:"Ξ",Omicron:"Ο",Pi:"Π",Rho:"Ρ",Sigma:"Σ",Tau:"Τ",Upsilon:"Υ",Phi:"Φ",Chi:"Χ",Psi:"Ψ",Omega:"Ω",alpha:"α",beta:"β",gamma:"γ",delta:"δ",epsilon:"ε",zeta:"ζ",eta:"η",theta:"θ",iota:"ι",kappa:"κ",lambda:"λ",mu:"μ",nu:"ν",xi:"ξ",omicron:"ο",pi:"π",rho:"ρ",sigmaf:"ς",sigma:"σ",tau:"τ",upsilon:"υ",phi:"φ",chi:"χ",psi:"ψ",omega:"ω",thetasym:"ϑ",upsih:"ϒ",piv:"ϖ",bull:"•",hellip:"…",prime:"′",Prime:"″",oline:"‾",frasl:"⁄",weierp:"℘",image:"ℑ",real:"ℜ",trade:"™",alefsym:"ℵ",larr:"←",uarr:"↑",rarr:"→",darr:"↓",harr:"↔",crarr:"↵",lArr:"⇐",uArr:"⇑",rArr:"⇒",dArr:"⇓",hArr:"⇔",forall:"∀",part:"∂",exist:"∃",empty:"∅",nabla:"∇",isin:"∈",notin:"∉",ni:"∋",prod:"∏",sum:"∑",minus:"−",lowast:"∗",radic:"√",prop:"∝",infin:"∞",ang:"∠",and:"∧",or:"∨",cap:"∩",cup:"∪",int:"∫",there4:"∴",sim:"∼",cong:"≅",asymp:"≈",ne:"≠",equiv:"≡",le:"≤",ge:"≥",sub:"⊂",sup:"⊃",nsub:"⊄",sube:"⊆",supe:"⊇",oplus:"⊕",otimes:"⊗",perp:"⊥",sdot:"⋅",lceil:"⌈",rceil:"⌉",lfloor:"⌊",rfloor:"⌋",lang:"〈",rang:"〉",loz:"◊",spades:"♠",clubs:"♣",hearts:"♥",diams:"♦",quot:'"',amp:"&",lt:"<",gt:">",OElig:"Œ",oelig:"œ",Scaron:"Š",scaron:"š",Yuml:"Ÿ",circ:"ˆ",tilde:"˜",ensp:" ",emsp:" ",thinsp:" ",zwnj:"‌",zwj:"‍",lrm:"‎",rlm:"‏",ndash:"–",mdash:"—",lsquo:"‘",rsquo:"’",sbquo:"‚",ldquo:"“",rdquo:"”",bdquo:"„",dagger:"†",Dagger:"‡",permil:"‰",lsaquo:"‹",rsaquo:"›",euro:"€"},VNe=["cent","copy","divide","gt","lt","not","para","times"],UV={}.hasOwnProperty,YS={};let kg;for(kg in a1)UV.call(a1,kg)&&(YS[a1[kg]]=kg);const GNe=/[^\dA-Za-z]/;function WNe(t,e,r,n){const s=String.fromCharCode(t);if(UV.call(YS,s)){const i=YS[s],o="&"+i;return r&&zNe.includes(i)&&!VNe.includes(i)&&(!n||e&&e!==61&&GNe.test(String.fromCharCode(e)))?o:o+";"}return""}function qNe(t,e,r){let n=UNe(t,e,r.omitOptionalSemicolons),s;if((r.useNamedReferences||r.useShortestReferences)&&(s=WNe(t,e,r.omitOptionalSemicolons,r.attribute)),(r.useShortestReferences||!s)&&r.useShortestReferences){const i=HNe(t,e,r.omitOptionalSemicolons);i.length<n.length&&(n=i)}return s&&(!r.useShortestReferences||s.length<n.length)?s:n}function fu(t,e){return MNe(t,Object.assign({format:qNe},e))}const KNe=/^>|^->|<!--|-->|--!>|<!-$/g,YNe=[">"],XNe=["<",">"];function ZNe(t,e,r,n){return n.settings.bogusComments?"<?"+fu(t.value,Object.assign({},n.settings.characterReferences,{subset:YNe}))+">":"<!--"+t.value.replace(KNe,s)+"-->";function s(i){return fu(i,Object.assign({},n.settings.characterReferences,{subset:XNe}))}}function JNe(t,e,r,n){return"<!"+(n.settings.upperDoctype?"DOCTYPE":"doctype")+(n.settings.tightDoctype?"":" ")+"html>"}const xr=HV(1),$V=HV(-1),QNe=[];function HV(t){return e;function e(r,n,s){const i=r?r.children:QNe;let o=(n||0)+t,a=i[o];if(!s)for(;a&&Wb(a);)o+=t,a=i[o];return a}}const eMe={}.hasOwnProperty;function zV(t){return e;function e(r,n,s){return eMe.call(t,r.tagName)&&t[r.tagName](r,n,s)}}const BA=zV({body:rMe,caption:l1,colgroup:l1,dd:oMe,dt:iMe,head:l1,html:tMe,li:sMe,optgroup:aMe,option:lMe,p:nMe,rp:CN,rt:CN,tbody:uMe,td:kN,tfoot:hMe,th:kN,thead:cMe,tr:dMe});function l1(t,e,r){const n=xr(r,e,!0);return!n||n.type!=="comment"&&!(n.type==="text"&&Wb(n.value.charAt(0)))}function tMe(t,e,r){const n=xr(r,e);return!n||n.type!=="comment"}function rMe(t,e,r){const n=xr(r,e);return!n||n.type!=="comment"}function nMe(t,e,r){const n=xr(r,e);return n?n.type==="element"&&(n.tagName==="address"||n.tagName==="article"||n.tagName==="aside"||n.tagName==="blockquote"||n.tagName==="details"||n.tagName==="div"||n.tagName==="dl"||n.tagName==="fieldset"||n.tagName==="figcaption"||n.tagName==="figure"||n.tagName==="footer"||n.tagName==="form"||n.tagName==="h1"||n.tagName==="h2"||n.tagName==="h3"||n.tagName==="h4"||n.tagName==="h5"||n.tagName==="h6"||n.tagName==="header"||n.tagName==="hgroup"||n.tagName==="hr"||n.tagName==="main"||n.tagName==="menu"||n.tagName==="nav"||n.tagName==="ol"||n.tagName==="p"||n.tagName==="pre"||n.tagName==="section"||n.tagName==="table"||n.tagName==="ul"):!r||!(r.type==="element"&&(r.tagName==="a"||r.tagName==="audio"||r.tagName==="del"||r.tagName==="ins"||r.tagName==="map"||r.tagName==="noscript"||r.tagName==="video"))}function sMe(t,e,r){const n=xr(r,e);return!n||n.type==="element"&&n.tagName==="li"}function iMe(t,e,r){const n=xr(r,e);return!!(n&&n.type==="element"&&(n.tagName==="dt"||n.tagName==="dd"))}function oMe(t,e,r){const n=xr(r,e);return!n||n.type==="element"&&(n.tagName==="dt"||n.tagName==="dd")}function CN(t,e,r){const n=xr(r,e);return!n||n.type==="element"&&(n.tagName==="rp"||n.tagName==="rt")}function aMe(t,e,r){const n=xr(r,e);return!n||n.type==="element"&&n.tagName==="optgroup"}function lMe(t,e,r){const n=xr(r,e);return!n||n.type==="element"&&(n.tagName==="option"||n.tagName==="optgroup")}function cMe(t,e,r){const n=xr(r,e);return!!(n&&n.type==="element"&&(n.tagName==="tbody"||n.tagName==="tfoot"))}function uMe(t,e,r){const n=xr(r,e);return!n||n.type==="element"&&(n.tagName==="tbody"||n.tagName==="tfoot")}function hMe(t,e,r){return!xr(r,e)}function dMe(t,e,r){const n=xr(r,e);return!n||n.type==="element"&&n.tagName==="tr"}function kN(t,e,r){const n=xr(r,e);return!n||n.type==="element"&&(n.tagName==="td"||n.tagName==="th")}const fMe=zV({body:gMe,colgroup:_Me,head:mMe,html:pMe,tbody:yMe});function pMe(t){const e=xr(t,-1);return!e||e.type!=="comment"}function mMe(t){const e=new Set;for(const n of t.children)if(n.type==="element"&&(n.tagName==="base"||n.tagName==="title")){if(e.has(n.tagName))return!1;e.add(n.tagName)}const r=t.children[0];return!r||r.type==="element"}function gMe(t){const e=xr(t,-1,!0);return!e||e.type!=="comment"&&!(e.type==="text"&&Wb(e.value.charAt(0)))&&!(e.type==="element"&&(e.tagName==="meta"||e.tagName==="link"||e.tagName==="script"||e.tagName==="style"||e.tagName==="template"))}function _Me(t,e,r){const n=$V(r,e),s=xr(t,-1,!0);return r&&n&&n.type==="element"&&n.tagName==="colgroup"&&BA(n,r.children.indexOf(n),r)?!1:!!(s&&s.type==="element"&&s.tagName==="col")}function yMe(t,e,r){const n=$V(r,e),s=xr(t,-1);return r&&n&&n.type==="element"&&(n.tagName==="thead"||n.tagName==="tbody")&&BA(n,r.children.indexOf(n),r)?!1:!!(s&&s.type==="element"&&s.tagName==="tr")}const Ag={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function bMe(t,e,r,n){const s=n.schema,i=s.space==="svg"?!1:n.settings.omitOptionalTags;let o=s.space==="svg"?n.settings.closeEmptyElements:n.settings.voids.includes(t.tagName.toLowerCase());const a=[];let l;s.space==="html"&&t.tagName==="svg"&&(n.schema=Vi);const c=vMe(n,t.properties),u=n.all(s.space==="html"&&t.tagName==="template"?t.content:t);return n.schema=s,u&&(o=!1),(c||!i||!fMe(t,e,r))&&(a.push("<",t.tagName,c?" "+c:""),o&&(s.space==="svg"||n.settings.closeSelfClosing)&&(l=c.charAt(c.length-1),(!n.settings.tightSelfClosing||l==="/"||l&&l!=='"'&&l!=="'")&&a.push(" "),a.push("/")),a.push(">")),a.push(u),!o&&(!i||!BA(t,e,r))&&a.push("</"+t.tagName+">"),a.join("")}function vMe(t,e){const r=[];let n=-1,s;if(e){for(s in e)if(e[s]!==null&&e[s]!==void 0){const i=wMe(t,s,e[s]);i&&r.push(i)}}for(;++n<r.length;){const i=t.settings.tightAttributes?r[n].charAt(r[n].length-1):void 0;n!==r.length-1&&i!=='"'&&i!=="'"&&(r[n]+=" ")}return r.join("")}function wMe(t,e,r){const n=kp(t.schema,e),s=t.settings.allowParseErrors&&t.schema.space==="html"?0:1,i=t.settings.allowDangerousCharacters?0:1;let o=t.quote,a;if(n.overloadedBoolean&&(r===n.attribute||r==="")?r=!0:(n.boolean||n.overloadedBoolean&&typeof r!="string")&&(r=!!r),r==null||r===!1||typeof r=="number"&&Number.isNaN(r))return"";const l=fu(n.attribute,Object.assign({},t.settings.characterReferences,{subset:Ag.name[s][i]}));return r===!0||(r=Array.isArray(r)?(n.commaSeparated?ak:lk)(r,{padLeft:!t.settings.tightCommaSeparatedLists}):String(r),t.settings.collapseEmptyAttributes&&!r)?l:(t.settings.preferUnquoted&&(a=fu(r,Object.assign({},t.settings.characterReferences,{attribute:!0,subset:Ag.unquoted[s][i]}))),a!==r&&(t.settings.quoteSmart&&p_(r,o)>p_(r,t.alternative)&&(o=t.alternative),a=o+fu(r,Object.assign({},t.settings.characterReferences,{subset:(o==="'"?Ag.single:Ag.double)[s][i],attribute:!0}))+o),l+(a&&"="+a))}const EMe=["<","&"];function VV(t,e,r,n){return r&&r.type==="element"&&(r.tagName==="script"||r.tagName==="style")?t.value:fu(t.value,Object.assign({},n.settings.characterReferences,{subset:EMe}))}function xMe(t,e,r,n){return n.settings.allowDangerousHtml?t.value:VV(t,e,r,n)}function SMe(t,e,r,n){return n.all(t)}const TMe=uk("type",{invalid:CMe,unknown:kMe,handlers:{comment:ZNe,doctype:JNe,element:bMe,raw:xMe,root:SMe,text:VV}});function CMe(t){throw new Error("Expected node, not `"+t+"`")}function kMe(t){const e=t;throw new Error("Cannot compile unknown node `"+e.type+"`")}const AMe={},RMe={},IMe=[];function PMe(t,e){const r=AMe,n=r.quote||'"',s=n==='"'?"'":'"';if(n!=='"'&&n!=="'")throw new Error("Invalid quote `"+n+"`, expected `'` or `\"`");return{one:OMe,all:DMe,settings:{omitOptionalTags:r.omitOptionalTags||!1,allowParseErrors:r.allowParseErrors||!1,allowDangerousCharacters:r.allowDangerousCharacters||!1,quoteSmart:r.quoteSmart||!1,preferUnquoted:r.preferUnquoted||!1,tightAttributes:r.tightAttributes||!1,upperDoctype:r.upperDoctype||!1,tightDoctype:r.tightDoctype||!1,bogusComments:r.bogusComments||!1,tightCommaSeparatedLists:r.tightCommaSeparatedLists||!1,tightSelfClosing:r.tightSelfClosing||!1,collapseEmptyAttributes:r.collapseEmptyAttributes||!1,allowDangerousHtml:r.allowDangerousHtml||!1,voids:r.voids||Rj,characterReferences:r.characterReferences||RMe,closeSelfClosing:r.closeSelfClosing||!1,closeEmptyElements:r.closeEmptyElements||!1},schema:r.space==="svg"?Vi:sh,quote:n,alternative:s}.one(Array.isArray(t)?{type:"root",children:t}:t,void 0,void 0)}function OMe(t,e,r){return TMe(t,e,r,this)}function DMe(t){const e=[],r=t&&t.children||IMe;let n=-1;for(;++n<r.length;)e[n]=this.one(r[n],n,t);return e.join("")}function LMe(t){return Array.isArray(t)?t:[t]}function Kb(t,e=!1){const r=t.split(/(\r?\n)/g);let n=0;const s=[];for(let i=0;i<r.length;i+=2){const o=e?r[i]+(r[i+1]||""):r[i];s.push([o,n]),n+=r[i].length,n+=r[i+1]?.length||0}return s}function FA(t){return!t||["plaintext","txt","text","plain"].includes(t)}function jA(t){return t==="ansi"||FA(t)}function UA(t){return t==="none"}function GV(t){return UA(t)}function WV(t,e){var r;if(!e)return t;t.properties||(t.properties={}),(r=t.properties).class||(r.class=[]),typeof t.properties.class=="string"&&(t.properties.class=t.properties.class.split(/\s+/g)),Array.isArray(t.properties.class)||(t.properties.class=[]);const n=Array.isArray(e)?e:e.split(/\s+/g);for(const s of n)s&&!t.properties.class.includes(s)&&t.properties.class.push(s);return t}function NMe(t,e){let r=0;const n=[];for(const s of e)s>r&&n.push({...t,content:t.content.slice(r,s),offset:t.offset+r}),r=s;return r<t.content.length&&n.push({...t,content:t.content.slice(r),offset:t.offset+r}),n}function MMe(t,e){const r=Array.from(e instanceof Set?e:new Set(e)).sort((n,s)=>n-s);return r.length?t.map(n=>n.flatMap(s=>{const i=r.filter(o=>s.offset<o&&o<s.offset+s.content.length).map(o=>o-s.offset).sort((o,a)=>o-a);return i.length?NMe(s,i):s})):t}async function qV(t){return Promise.resolve(typeof t=="function"?t():t).then(e=>e.default||e)}function iy(t,e){const r=typeof t=="string"?{}:{...t.colorReplacements},n=typeof t=="string"?t:t.name;for(const[s,i]of Object.entries(e?.colorReplacements||{}))typeof i=="string"?r[s]=i:s===n&&Object.assign(r,i);return r}function yl(t,e){return t&&(e?.[t?.toLowerCase()]||t)}function KV(t){const e={};return t.color&&(e.color=t.color),t.bgColor&&(e["background-color"]=t.bgColor),t.fontStyle&&(t.fontStyle&mo.Italic&&(e["font-style"]="italic"),t.fontStyle&mo.Bold&&(e["font-weight"]="bold"),t.fontStyle&mo.Underline&&(e["text-decoration"]="underline")),e}function BMe(t){return typeof t=="string"?t:Object.entries(t).map(([e,r])=>`${e}:${r}`).join(";")}function FMe(t){const e=Kb(t,!0).map(([s])=>s);function r(s){if(s===t.length)return{line:e.length-1,character:e[e.length-1].length};let i=s,o=0;for(const a of e){if(i<a.length)break;i-=a.length,o++}return{line:o,character:i}}function n(s,i){let o=0;for(let a=0;a<s;a++)o+=e[a].length;return o+=i,o}return{lines:e,indexToPos:r,posToIndex:n}}class cn extends Error{constructor(e){super(e),this.name="ShikiError"}}var jMe=Object.defineProperty,UMe=(t,e,r)=>e in t?jMe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,AN=(t,e,r)=>(UMe(t,typeof e!="symbol"?e+"":e,r),r);const YV=new WeakMap;function Yb(t,e){YV.set(t,e)}function Kf(t){return YV.get(t)}class _h{constructor(...e){if(AN(this,"_stacks",{}),AN(this,"lang"),e.length===2){const[r,n]=e;this.lang=n,this._stacks=r}else{const[r,n,s]=e;this.lang=n,this._stacks={[s]:r}}}get themes(){return Object.keys(this._stacks)}get theme(){return this.themes[0]}get _stack(){return this._stacks[this.theme]}static initial(e,r){return new _h(Object.fromEntries(LMe(r).map(n=>[n,KS])),e)}getInternalStack(e=this.theme){return this._stacks[e]}get scopes(){return RN(this._stacks[this.theme])}getScopes(e=this.theme){return RN(this._stacks[e])}toJSON(){return{lang:this.lang,theme:this.theme,themes:this.themes,scopes:this.scopes}}}function RN(t){const e=[],r=new Set;function n(s){if(r.has(s))return;r.add(s);const i=s?.nameScopesList?.scopeName;i&&e.push(i),s.parent&&n(s.parent)}return n(t),e}function $Me(t,e){if(!(t instanceof _h))throw new cn("Invalid grammar state");return t.getInternalStack(e)}function HMe(){const t=new WeakMap;function e(r){if(!t.has(r.meta)){let n=function(o){if(typeof o=="number"){if(o<0||o>r.source.length)throw new cn(`Invalid decoration offset: ${o}. Code length: ${r.source.length}`);return{...s.indexToPos(o),offset:o}}else{const a=s.lines[o.line];if(a===void 0)throw new cn(`Invalid decoration position ${JSON.stringify(o)}. Lines length: ${s.lines.length}`);if(o.character<0||o.character>a.length)throw new cn(`Invalid decoration position ${JSON.stringify(o)}. Line ${o.line} length: ${a.length}`);return{...o,offset:s.posToIndex(o.line,o.character)}}};const s=FMe(r.source),i=(r.options.decorations||[]).map(o=>({...o,start:n(o.start),end:n(o.end)}));zMe(i),t.set(r.meta,{decorations:i,converter:s,source:r.source})}return t.get(r.meta)}return{name:"shiki:decorations",tokens(r){if(!this.options.decorations?.length)return;const s=e(this).decorations.flatMap(o=>[o.start.offset,o.end.offset]);return MMe(r,s)},code(r){if(!this.options.decorations?.length)return;const n=e(this),s=Array.from(r.children).filter(u=>u.type==="element"&&u.tagName==="span");if(s.length!==n.converter.lines.length)throw new cn(`Number of lines in code element (${s.length}) does not match the number of lines in the source (${n.converter.lines.length}). Failed to apply decorations.`);function i(u,h,d,f){const g=s[u];let _="",m=-1,p=-1;if(h===0&&(m=0),d===0&&(p=0),d===Number.POSITIVE_INFINITY&&(p=g.children.length),m===-1||p===-1)for(let b=0;b<g.children.length;b++)_+=XV(g.children[b]),m===-1&&_.length===h&&(m=b+1),p===-1&&_.length===d&&(p=b+1);if(m===-1)throw new cn(`Failed to find start index for decoration ${JSON.stringify(f.start)}`);if(p===-1)throw new cn(`Failed to find end index for decoration ${JSON.stringify(f.end)}`);const y=g.children.slice(m,p);if(!f.alwaysWrap&&y.length===g.children.length)a(g,f,"line");else if(!f.alwaysWrap&&y.length===1&&y[0].type==="element")a(y[0],f,"token");else{const b={type:"element",tagName:"span",properties:{},children:y};a(b,f,"wrapper"),g.children.splice(m,y.length,b)}}function o(u,h){s[u]=a(s[u],h,"line")}function a(u,h,d){const f=h.properties||{},g=h.transform||(_=>_);return u.tagName=h.tagName||"span",u.properties={...u.properties,...f,class:u.properties.class},h.properties?.class&&WV(u,h.properties.class),u=g(u,d)||u,u}const l=[],c=n.decorations.sort((u,h)=>h.start.offset-u.start.offset);for(const u of c){const{start:h,end:d}=u;if(h.line===d.line)i(h.line,h.character,d.character,u);else if(h.line<d.line){i(h.line,h.character,Number.POSITIVE_INFINITY,u);for(let f=h.line+1;f<d.line;f++)l.unshift(()=>o(f,u));i(d.line,0,d.character,u)}}l.forEach(u=>u())}}}function zMe(t){for(let e=0;e<t.length;e++){const r=t[e];if(r.start.offset>r.end.offset)throw new cn(`Invalid decoration range: ${JSON.stringify(r.start)} - ${JSON.stringify(r.end)}`);for(let n=e+1;n<t.length;n++){const s=t[n],i=r.start.offset<s.start.offset&&s.start.offset<r.end.offset,o=r.start.offset<s.end.offset&&s.end.offset<r.end.offset,a=s.start.offset<r.start.offset&&r.start.offset<s.end.offset,l=s.start.offset<r.end.offset&&r.end.offset<s.end.offset;if(i||o||a||l){if(o&&o||a&&l)continue;throw new cn(`Decorations ${JSON.stringify(r.start)} and ${JSON.stringify(s.start)} intersect.`)}}}}function XV(t){return t.type==="text"?t.value:t.type==="element"?t.children.map(XV).join(""):""}const VMe=[HMe()];function oy(t){return[...t.transformers||[],...VMe]}var bl=["black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite"],c1={1:"bold",2:"dim",3:"italic",4:"underline",7:"reverse",9:"strikethrough"};function GMe(t,e){const r=t.indexOf("\x1B[",e);if(r!==-1){const n=t.indexOf("m",r);return{sequence:t.substring(r+2,n).split(";"),startPosition:r,position:n+1}}return{position:t.length}}function IN(t,e){let r=1;const n=t[e+r++];let s;if(n==="2"){const i=[t[e+r++],t[e+r++],t[e+r]].map(o=>Number.parseInt(o));i.length===3&&!i.some(o=>Number.isNaN(o))&&(s={type:"rgb",rgb:i})}else if(n==="5"){const i=Number.parseInt(t[e+r]);Number.isNaN(i)||(s={type:"table",index:Number(i)})}return[r,s]}function WMe(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r],s=Number.parseInt(n);if(!Number.isNaN(s))if(s===0)e.push({type:"resetAll"});else if(s<=9)c1[s]&&e.push({type:"setDecoration",value:c1[s]});else if(s<=29){const i=c1[s-20];i&&e.push({type:"resetDecoration",value:i})}else if(s<=37)e.push({type:"setForegroundColor",value:{type:"named",name:bl[s-30]}});else if(s===38){const[i,o]=IN(t,r);o&&e.push({type:"setForegroundColor",value:o}),r+=i}else if(s===39)e.push({type:"resetForegroundColor"});else if(s<=47)e.push({type:"setBackgroundColor",value:{type:"named",name:bl[s-40]}});else if(s===48){const[i,o]=IN(t,r);o&&e.push({type:"setBackgroundColor",value:o}),r+=i}else s===49?e.push({type:"resetBackgroundColor"}):s>=90&&s<=97?e.push({type:"setForegroundColor",value:{type:"named",name:bl[s-90+8]}}):s>=100&&s<=107&&e.push({type:"setBackgroundColor",value:{type:"named",name:bl[s-100+8]}})}return e}function qMe(){let t=null,e=null,r=new Set;return{parse(n){const s=[];let i=0;do{const o=GMe(n,i),a=o.sequence?n.substring(i,o.startPosition):n.substring(i);if(a.length>0&&s.push({value:a,foreground:t,background:e,decorations:new Set(r)}),o.sequence){const l=WMe(o.sequence);for(const c of l)c.type==="resetAll"?(t=null,e=null,r.clear()):c.type==="resetForegroundColor"?t=null:c.type==="resetBackgroundColor"?e=null:c.type==="resetDecoration"&&r.delete(c.value);for(const c of l)c.type==="setForegroundColor"?t=c.value:c.type==="setBackgroundColor"?e=c.value:c.type==="setDecoration"&&r.add(c.value)}i=o.position}while(i<n.length);return s}}}var KMe={black:"#000000",red:"#bb0000",green:"#00bb00",yellow:"#bbbb00",blue:"#0000bb",magenta:"#ff00ff",cyan:"#00bbbb",white:"#eeeeee",brightBlack:"#555555",brightRed:"#ff5555",brightGreen:"#00ff00",brightYellow:"#ffff55",brightBlue:"#5555ff",brightMagenta:"#ff55ff",brightCyan:"#55ffff",brightWhite:"#ffffff"};function YMe(t=KMe){function e(a){return t[a]}function r(a){return`#${a.map(l=>Math.max(0,Math.min(l,255)).toString(16).padStart(2,"0")).join("")}`}let n;function s(){if(n)return n;n=[];for(let c=0;c<bl.length;c++)n.push(e(bl[c]));let a=[0,95,135,175,215,255];for(let c=0;c<6;c++)for(let u=0;u<6;u++)for(let h=0;h<6;h++)n.push(r([a[c],a[u],a[h]]));let l=8;for(let c=0;c<24;c++,l+=10)n.push(r([l,l,l]));return n}function i(a){return s()[a]}function o(a){switch(a.type){case"named":return e(a.name);case"rgb":return r(a.rgb);case"table":return i(a.index)}}return{value:o}}function XMe(t,e,r){const n=iy(t,r),s=Kb(e),i=YMe(Object.fromEntries(bl.map(a=>[a,t.colors?.[`terminal.ansi${a[0].toUpperCase()}${a.substring(1)}`]]))),o=qMe();return s.map(a=>o.parse(a[0]).map(l=>{let c,u;l.decorations.has("reverse")?(c=l.background?i.value(l.background):t.bg,u=l.foreground?i.value(l.foreground):t.fg):(c=l.foreground?i.value(l.foreground):t.fg,u=l.background?i.value(l.background):void 0),c=yl(c,n),u=yl(u,n),l.decorations.has("dim")&&(c=ZMe(c));let h=mo.None;return l.decorations.has("bold")&&(h|=mo.Bold),l.decorations.has("italic")&&(h|=mo.Italic),l.decorations.has("underline")&&(h|=mo.Underline),{content:l.value,offset:a[1],color:c,bgColor:u,fontStyle:h}}))}function ZMe(t){const e=t.match(/#([0-9a-f]{3})([0-9a-f]{3})?([0-9a-f]{2})?/);if(e)if(e[3]){const n=Math.round(Number.parseInt(e[3],16)/2).toString(16).padStart(2,"0");return`#${e[1]}${e[2]}${n}`}else return e[2]?`#${e[1]}${e[2]}80`:`#${Array.from(e[1]).map(n=>`${n}${n}`).join("")}80`;const r=t.match(/var\((--[\w-]+-ansi-[\w-]+)\)/);return r?`var(${r[1]}-dim)`:t}function $A(t,e,r={}){const{lang:n="text",theme:s=t.getLoadedThemes()[0]}=r;if(FA(n)||UA(s))return Kb(e).map(l=>[{content:l[0],offset:l[1]}]);const{theme:i,colorMap:o}=t.setTheme(s);if(n==="ansi")return XMe(i,e,r);const a=t.getLanguage(n);if(r.grammarState){if(r.grammarState.lang!==a.name)throw new vo(`Grammar state language "${r.grammarState.lang}" does not match highlight language "${a.name}"`);if(!r.grammarState.themes.includes(i.name))throw new vo(`Grammar state themes "${r.grammarState.themes}" do not contain highlight theme "${i.name}"`)}return QMe(e,a,i,o,r)}function JMe(...t){if(t.length===2)return Kf(t[1]);const[e,r,n={}]=t,{lang:s="text",theme:i=e.getLoadedThemes()[0]}=n;if(FA(s)||UA(i))throw new vo("Plain language does not have grammar state");if(s==="ansi")throw new vo("ANSI language does not have grammar state");const{theme:o,colorMap:a}=e.setTheme(i),l=e.getLanguage(s);return new _h(ay(r,l,o,a,n).stateStack,l.name,o.name)}function QMe(t,e,r,n,s){const i=ay(t,e,r,n,s),o=new _h(ay(t,e,r,n,s).stateStack,e.name,r.name);return Yb(i.tokens,o),i.tokens}function ay(t,e,r,n,s){const i=iy(r,s),{tokenizeMaxLineLength:o=0,tokenizeTimeLimit:a=500}=s,l=Kb(t);let c=s.grammarState?$Me(s.grammarState,r.name)??KS:s.grammarContextCode!=null?ay(s.grammarContextCode,e,r,n,{...s,grammarState:void 0,grammarContextCode:void 0}).stateStack:KS,u=[];const h=[];for(let d=0,f=l.length;d<f;d++){const[g,_]=l[d];if(g===""){u=[],h.push([]);continue}if(o>0&&g.length>=o){u=[],h.push([{content:g,offset:_,color:"",fontStyle:0}]);continue}let m,p,y;s.includeExplanation&&(m=e.tokenizeLine(g,c),p=m.tokens,y=0);const b=e.tokenizeLine2(g,c,a),v=b.tokens.length/2;for(let w=0;w<v;w++){const E=b.tokens[2*w],S=w+1<v?b.tokens[2*w+2]:g.length;if(E===S)continue;const x=b.tokens[2*w+1],C=yl(n[ju.getForeground(x)],i),A=ju.getFontStyle(x),M={content:g.substring(E,S),offset:_+E,color:C,fontStyle:A};if(s.includeExplanation){const P=[];if(s.includeExplanation!=="scopeName")for(const R of r.settings){let G;switch(typeof R.scope){case"string":G=R.scope.split(/,/).map(ee=>ee.trim());break;case"object":G=R.scope;break;default:continue}P.push({settings:R,selectors:G.map(ee=>ee.split(/ /))})}M.explanation=[];let D=0;for(;E+D<S;){const R=p[y],G=g.substring(R.startIndex,R.endIndex);D+=G.length,M.explanation.push({content:G,scopes:s.includeExplanation==="scopeName"?e3e(R.scopes):t3e(P,R.scopes)}),y+=1}}u.push(M)}h.push(u),u=[],c=b.ruleStack}return{tokens:h,stateStack:c}}function e3e(t){return t.map(e=>({scopeName:e}))}function t3e(t,e){const r=[];for(let n=0,s=e.length;n<s;n++){const i=e[n];r[n]={scopeName:i,themeMatches:n3e(t,i,e.slice(0,n))}}return r}function PN(t,e){return t===e||e.substring(0,t.length)===t&&e[t.length]==="."}function r3e(t,e,r){if(!PN(t[t.length-1],e))return!1;let n=t.length-2,s=r.length-1;for(;n>=0&&s>=0;)PN(t[n],r[s])&&(n-=1),s-=1;return n===-1}function n3e(t,e,r){const n=[];for(const{selectors:s,settings:i}of t)for(const o of s)if(r3e(o,e,r)){n.push(i);break}return n}function ZV(t,e,r){const n=Object.entries(r.themes).filter(l=>l[1]).map(l=>({color:l[0],theme:l[1]})),s=n.map(l=>{const c=$A(t,e,{...r,theme:l.theme}),u=Kf(c),h=typeof l.theme=="string"?l.theme:l.theme.name;return{tokens:c,state:u,theme:h}}),i=s3e(...s.map(l=>l.tokens)),o=i[0].map((l,c)=>l.map((u,h)=>{const d={content:u.content,variants:{},offset:u.offset};return"includeExplanation"in r&&r.includeExplanation&&(d.explanation=u.explanation),i.forEach((f,g)=>{const{content:_,explanation:m,offset:p,...y}=f[c][h];d.variants[n[g].color]=y}),d})),a=s[0].state?new _h(Object.fromEntries(s.map(l=>[l.theme,l.state?.getInternalStack(l.theme)])),s[0].state.lang):void 0;return a&&Yb(o,a),o}function s3e(...t){const e=t.map(()=>[]),r=t.length;for(let n=0;n<t[0].length;n++){const s=t.map(l=>l[n]),i=e.map(()=>[]);e.forEach((l,c)=>l.push(i[c]));const o=s.map(()=>0),a=s.map(l=>l[0]);for(;a.every(l=>l);){const l=Math.min(...a.map(c=>c.content.length));for(let c=0;c<r;c++){const u=a[c];u.content.length===l?(i[c].push(u),o[c]+=1,a[c]=s[c][o[c]]):(i[c].push({...u,content:u.content.slice(0,l)}),a[c]={...u,content:u.content.slice(l),offset:u.offset+l})}}}return e}function ly(t,e,r){let n,s,i,o,a,l;if("themes"in r){const{defaultColor:c="light",cssVariablePrefix:u="--shiki-"}=r,h=Object.entries(r.themes).filter(m=>m[1]).map(m=>({color:m[0],theme:m[1]})).sort((m,p)=>m.color===c?-1:p.color===c?1:0);if(h.length===0)throw new vo("`themes` option must not be empty");const d=ZV(t,e,r);if(l=Kf(d),c&&!h.find(m=>m.color===c))throw new vo(`\`themes\` option must contain the defaultColor key \`${c}\``);const f=h.map(m=>t.getTheme(m.theme)),g=h.map(m=>m.color);i=d.map(m=>m.map(p=>i3e(p,g,u,c))),l&&Yb(i,l);const _=h.map(m=>iy(m.theme,r));s=h.map((m,p)=>(p===0&&c?"":`${u+m.color}:`)+(yl(f[p].fg,_[p])||"inherit")).join(";"),n=h.map((m,p)=>(p===0&&c?"":`${u+m.color}-bg:`)+(yl(f[p].bg,_[p])||"inherit")).join(";"),o=`shiki-themes ${f.map(m=>m.name).join(" ")}`,a=c?void 0:[s,n].join(";")}else if("theme"in r){const c=iy(r.theme,r);i=$A(t,e,r);const u=t.getTheme(r.theme);n=yl(u.bg,c),s=yl(u.fg,c),o=u.name,l=Kf(i)}else throw new vo("Invalid options, either `theme` or `themes` must be provided");return{tokens:i,fg:s,bg:n,themeName:o,rootStyle:a,grammarState:l}}function i3e(t,e,r,n){const s={content:t.content,explanation:t.explanation,offset:t.offset},i=e.map(l=>KV(t.variants[l])),o=new Set(i.flatMap(l=>Object.keys(l))),a={};return i.forEach((l,c)=>{for(const u of o){const h=l[u]||"inherit";if(c===0&&n)a[u]=h;else{const d=u==="color"?"":u==="background-color"?"-bg":`-${u}`,f=r+e[c]+(u==="color"?"":d);a[f]=h}}}),s.htmlStyle=a,s}function cy(t,e,r,n={meta:{},options:r,codeToHast:(s,i)=>cy(t,s,i),codeToTokens:(s,i)=>ly(t,s,i)}){let s=e;for(const f of oy(r))s=f.preprocess?.call(n,s,r)||s;let{tokens:i,fg:o,bg:a,themeName:l,rootStyle:c,grammarState:u}=ly(t,s,r);const{mergeWhitespaces:h=!0}=r;h===!0?i=a3e(i):h==="never"&&(i=l3e(i));const d={...n,get source(){return s}};for(const f of oy(r))i=f.tokens?.call(d,i)||i;return o3e(i,{...r,fg:o,bg:a,themeName:l,rootStyle:c},d,u)}function o3e(t,e,r,n=Kf(t)){const s=oy(e),i=[],o={type:"root",children:[]},{structure:a="classic",tabindex:l="0"}=e;let c={type:"element",tagName:"pre",properties:{class:`shiki ${e.themeName||""}`,style:e.rootStyle||`background-color:${e.bg};color:${e.fg}`,...l!==!1&&l!=null?{tabindex:l.toString()}:{},...Object.fromEntries(Array.from(Object.entries(e.meta||{})).filter(([g])=>!g.startsWith("_")))},children:[]},u={type:"element",tagName:"code",properties:{},children:i};const h=[],d={...r,structure:a,addClassToHast:WV,get source(){return r.source},get tokens(){return t},get options(){return e},get root(){return o},get pre(){return c},get code(){return u},get lines(){return h}};if(t.forEach((g,_)=>{_&&(a==="inline"?o.children.push({type:"element",tagName:"br",properties:{},children:[]}):a==="classic"&&i.push({type:"text",value:`
`}));let m={type:"element",tagName:"span",properties:{class:"line"},children:[]},p=0;for(const y of g){let b={type:"element",tagName:"span",properties:{...y.htmlAttrs},children:[{type:"text",value:y.content}]};y.htmlStyle;const v=BMe(y.htmlStyle||KV(y));v&&(b.properties.style=v);for(const w of s)b=w?.span?.call(d,b,_+1,p,m,y)||b;a==="inline"?o.children.push(b):a==="classic"&&m.children.push(b),p+=y.content.length}if(a==="classic"){for(const y of s)m=y?.line?.call(d,m,_+1)||m;h.push(m),i.push(m)}}),a==="classic"){for(const g of s)u=g?.code?.call(d,u)||u;c.children.push(u);for(const g of s)c=g?.pre?.call(d,c)||c;o.children.push(c)}let f=o;for(const g of s)f=g?.root?.call(d,f)||f;return n&&Yb(f,n),f}function a3e(t){return t.map(e=>{const r=[];let n="",s=0;return e.forEach((i,o)=>{const l=!(i.fontStyle&&i.fontStyle&mo.Underline);l&&i.content.match(/^\s+$/)&&e[o+1]?(s||(s=i.offset),n+=i.content):n?(l?r.push({...i,offset:s,content:n+i.content}):r.push({content:n,offset:s},i),s=0,n=""):r.push(i)}),r})}function l3e(t){return t.map(e=>e.flatMap(r=>{if(r.content.match(/^\s+$/))return r;const n=r.content.match(/^(\s*)(.*?)(\s*)$/);if(!n)return r;const[,s,i,o]=n;if(!s&&!o)return r;const a=[{...r,offset:r.offset+s.length,content:i}];return s&&a.unshift({content:s,offset:r.offset}),o&&a.push({content:o,offset:r.offset+s.length+i.length}),a}))}function c3e(t,e,r){const n={meta:{},options:r,codeToHast:(i,o)=>cy(t,i,o),codeToTokens:(i,o)=>ly(t,i,o)};let s=PMe(cy(t,e,r,n));for(const i of oy(r))s=i.postprocess?.call(n,s,r)||s;return s}const ON={light:"#333333",dark:"#bbbbbb"},DN={light:"#fffffe",dark:"#1e1e1e"},LN="__shiki_resolved";function HA(t){if(t?.[LN])return t;const e={...t};e.tokenColors&&!e.settings&&(e.settings=e.tokenColors,delete e.tokenColors),e.type||(e.type="dark"),e.colorReplacements={...e.colorReplacements},e.settings||(e.settings=[]);let{bg:r,fg:n}=e;if(!r||!n){const a=e.settings?e.settings.find(l=>!l.name&&!l.scope):void 0;a?.settings?.foreground&&(n=a.settings.foreground),a?.settings?.background&&(r=a.settings.background),!n&&e?.colors?.["editor.foreground"]&&(n=e.colors["editor.foreground"]),!r&&e?.colors?.["editor.background"]&&(r=e.colors["editor.background"]),n||(n=e.type==="light"?ON.light:ON.dark),r||(r=e.type==="light"?DN.light:DN.dark),e.fg=n,e.bg=r}e.settings[0]&&e.settings[0].settings&&!e.settings[0].scope||e.settings.unshift({settings:{foreground:e.fg,background:e.bg}});let s=0;const i=new Map;function o(a){if(i.has(a))return i.get(a);s+=1;const l=`#${s.toString(16).padStart(8,"0").toLowerCase()}`;return e.colorReplacements?.[`#${l}`]?o(a):(i.set(a,l),l)}e.settings=e.settings.map(a=>{const l=a.settings?.foreground&&!a.settings.foreground.startsWith("#"),c=a.settings?.background&&!a.settings.background.startsWith("#");if(!l&&!c)return a;const u={...a,settings:{...a.settings}};if(l){const h=o(a.settings.foreground);e.colorReplacements[h]=a.settings.foreground,u.settings.foreground=h}if(c){const h=o(a.settings.background);e.colorReplacements[h]=a.settings.background,u.settings.background=h}return u});for(const a of Object.keys(e.colors||{}))if((a==="editor.foreground"||a==="editor.background"||a.startsWith("terminal.ansi"))&&!e.colors[a]?.startsWith("#")){const l=o(e.colors[a]);e.colorReplacements[l]=e.colors[a],e.colors[a]=l}return Object.defineProperty(e,LN,{enumerable:!1,writable:!1,value:!0}),e}async function JV(t){return Array.from(new Set((await Promise.all(t.filter(e=>!jA(e)).map(async e=>await qV(e).then(r=>Array.isArray(r)?r:[r])))).flat()))}async function QV(t){return(await Promise.all(t.map(async r=>GV(r)?null:HA(await qV(r))))).filter(r=>!!r)}var u3e=Object.defineProperty,h3e=(t,e,r)=>e in t?u3e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ja=(t,e,r)=>(h3e(t,typeof e!="symbol"?e+"":e,r),r);class d3e extends PNe{constructor(e,r,n,s={}){super(e),this._resolver=e,this._themes=r,this._langs=n,this._alias=s,Ja(this,"_resolvedThemes",new Map),Ja(this,"_resolvedGrammars",new Map),Ja(this,"_langMap",new Map),Ja(this,"_langGraph",new Map),Ja(this,"_textmateThemeCache",new WeakMap),Ja(this,"_loadedThemesCache",null),Ja(this,"_loadedLanguagesCache",null),this._themes.map(i=>this.loadTheme(i)),this.loadLanguages(this._langs)}getTheme(e){return typeof e=="string"?this._resolvedThemes.get(e):this.loadTheme(e)}loadTheme(e){const r=HA(e);return r.name&&(this._resolvedThemes.set(r.name,r),this._loadedThemesCache=null),r}getLoadedThemes(){return this._loadedThemesCache||(this._loadedThemesCache=[...this._resolvedThemes.keys()]),this._loadedThemesCache}setTheme(e){let r=this._textmateThemeCache.get(e);r||(r=ey.createFromRawTheme(e),this._textmateThemeCache.set(e,r)),this._syncRegistry.setTheme(r)}getGrammar(e){if(this._alias[e]){const r=new Set([e]);for(;this._alias[e];){if(e=this._alias[e],r.has(e))throw new cn(`Circular alias \`${Array.from(r).join(" -> ")} -> ${e}\``);r.add(e)}}return this._resolvedGrammars.get(e)}loadLanguage(e){if(this.getGrammar(e.name))return;const r=new Set([...this._langMap.values()].filter(i=>i.embeddedLangsLazy?.includes(e.name)));this._resolver.addLanguage(e);const n={balancedBracketSelectors:e.balancedBracketSelectors||["*"],unbalancedBracketSelectors:e.unbalancedBracketSelectors||[]};this._syncRegistry._rawGrammars.set(e.scopeName,e);const s=this.loadGrammarWithConfiguration(e.scopeName,1,n);if(s.name=e.name,this._resolvedGrammars.set(e.name,s),e.aliases&&e.aliases.forEach(i=>{this._alias[i]=e.name}),this._loadedLanguagesCache=null,r.size)for(const i of r)this._resolvedGrammars.delete(i.name),this._loadedLanguagesCache=null,this._syncRegistry?._injectionGrammars?.delete(i.scopeName),this._syncRegistry?._grammars?.delete(i.scopeName),this.loadLanguage(this._langMap.get(i.name))}dispose(){super.dispose(),this._resolvedThemes.clear(),this._resolvedGrammars.clear(),this._langMap.clear(),this._langGraph.clear(),this._loadedThemesCache=null}loadLanguages(e){for(const s of e)this.resolveEmbeddedLanguages(s);const r=Array.from(this._langGraph.entries()),n=r.filter(([s,i])=>!i);if(n.length){const s=r.filter(([i,o])=>o&&o.embeddedLangs?.some(a=>n.map(([l])=>l).includes(a))).filter(i=>!n.includes(i));throw new cn(`Missing languages ${n.map(([i])=>`\`${i}\``).join(", ")}, required by ${s.map(([i])=>`\`${i}\``).join(", ")}`)}for(const[s,i]of r)this._resolver.addLanguage(i);for(const[s,i]of r)this.loadLanguage(i)}getLoadedLanguages(){return this._loadedLanguagesCache||(this._loadedLanguagesCache=[...new Set([...this._resolvedGrammars.keys(),...Object.keys(this._alias)])]),this._loadedLanguagesCache}resolveEmbeddedLanguages(e){if(this._langMap.set(e.name,e),this._langGraph.set(e.name,e),e.embeddedLangs)for(const r of e.embeddedLangs)this._langGraph.set(r,this._langMap.get(r))}}var f3e=Object.defineProperty,p3e=(t,e,r)=>e in t?f3e(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Rg=(t,e,r)=>(p3e(t,typeof e!="symbol"?e+"":e,r),r);class m3e{constructor(e,r){Rg(this,"_langs",new Map),Rg(this,"_scopeToLang",new Map),Rg(this,"_injections",new Map),Rg(this,"_onigLib"),this._onigLib={createOnigScanner:n=>e.createScanner(n),createOnigString:n=>e.createString(n)},r.forEach(n=>this.addLanguage(n))}get onigLib(){return this._onigLib}getLangRegistration(e){return this._langs.get(e)}loadGrammar(e){return this._scopeToLang.get(e)}addLanguage(e){this._langs.set(e.name,e),e.aliases&&e.aliases.forEach(r=>{this._langs.set(r,e)}),this._scopeToLang.set(e.scopeName,e),e.injectTo&&e.injectTo.forEach(r=>{this._injections.get(r)||this._injections.set(r,[]),this._injections.get(r).push(e.scopeName)})}getInjections(e){const r=e.split(".");let n=[];for(let s=1;s<=r.length;s++){const i=r.slice(0,s).join(".");n=[...n,...this._injections.get(i)||[]]}return n}}let qh=0;function g3e(t){qh+=1,t.warnings!==!1&&qh>=10&&qh%10===0&&console.warn(`[Shiki] ${qh} instances have been created. Shiki is supposed to be used as a singleton, consider refactoring your code to cache your highlighter instance; Or call \`highlighter.dispose()\` to release unused instances.`);let e=!1;if(!t.engine)throw new cn("`engine` option is required for synchronous mode");const r=(t.langs||[]).flat(1),n=(t.themes||[]).flat(1).map(HA),s=new m3e(t.engine,r),i=new d3e(s,n,r,t.langAlias);let o;function a(y){m();const b=i.getGrammar(typeof y=="string"?y:y.name);if(!b)throw new cn(`Language \`${y}\` not found, you may need to load it first`);return b}function l(y){if(y==="none")return{bg:"",fg:"",name:"none",settings:[],type:"dark"};m();const b=i.getTheme(y);if(!b)throw new cn(`Theme \`${y}\` not found, you may need to load it first`);return b}function c(y){m();const b=l(y);o!==y&&(i.setTheme(b),o=y);const v=i.getColorMap();return{theme:b,colorMap:v}}function u(){return m(),i.getLoadedThemes()}function h(){return m(),i.getLoadedLanguages()}function d(...y){m(),i.loadLanguages(y.flat(1))}async function f(...y){return d(await JV(y))}function g(...y){m();for(const b of y.flat(1))i.loadTheme(b)}async function _(...y){return m(),g(await QV(y))}function m(){if(e)throw new cn("Shiki instance has been disposed")}function p(){e||(e=!0,i.dispose(),qh-=1)}return{setTheme:c,getTheme:l,getLanguage:a,getLoadedThemes:u,getLoadedLanguages:h,loadLanguage:f,loadLanguageSync:d,loadTheme:_,loadThemeSync:g,dispose:p,[Symbol.dispose]:p}}async function _3e(t={}){t.loadWasm;const[e,r,n]=await Promise.all([QV(t.themes||[]),JV(t.langs||[]),t.engine||SV(t.loadWasm||GLe())]);return g3e({...t,loadWasm:void 0,themes:e,langs:r,engine:n})}async function y3e(t={}){const e=await _3e(t);return{getLastGrammarState:(...r)=>JMe(e,...r),codeToTokensBase:(r,n)=>$A(e,r,n),codeToTokensWithThemes:(r,n)=>ZV(e,r,n),codeToTokens:(r,n)=>ly(e,r,n),codeToHast:(r,n)=>cy(e,r,n),codeToHtml:(r,n)=>c3e(e,r,n),...e,getInternalContext:()=>e}}function b3e(t,e,r){let n,s,i;{const a=t;n=a.langs,s=a.themes,i=a.engine}async function o(a){function l(f){if(typeof f=="string"){if(jA(f))return[];const g=n[f];if(!g)throw new vo(`Language \`${f}\` is not included in this bundle. You may want to load it from external source.`);return g}return f}function c(f){if(GV(f))return"none";if(typeof f=="string"){const g=s[f];if(!g)throw new vo(`Theme \`${f}\` is not included in this bundle. You may want to load it from external source.`);return g}return f}const u=(a.themes??[]).map(f=>c(f)),h=(a.langs??[]).map(f=>l(f)),d=await y3e({engine:a.engine??i(),...a,themes:u,langs:h});return{...d,loadLanguage(...f){return d.loadLanguage(...f.map(l))},loadTheme(...f){return d.loadTheme(...f.map(c))}}}return o}function v3e(t){let e;async function r(n={}){if(e){const s=await e;return await Promise.all([s.loadTheme(...n.themes||[]),s.loadLanguage(...n.langs||[])]),s}else return e=t({...n,themes:n.themes||[],langs:n.langs||[]}),e}return r}function w3e(t){const e=v3e(t);return{getSingletonHighlighter(r){return e(r)},async codeToHtml(r,n){return(await e({langs:[n.lang],themes:"theme"in n?[n.theme]:Object.values(n.themes)})).codeToHtml(r,n)},async codeToHast(r,n){return(await e({langs:[n.lang],themes:"theme"in n?[n.theme]:Object.values(n.themes)})).codeToHast(r,n)},async codeToTokens(r,n){return(await e({langs:[n.lang],themes:"theme"in n?[n.theme]:Object.values(n.themes)})).codeToTokens(r,n)},async codeToTokensBase(r,n){return(await e({langs:[n.lang],themes:[n.theme]})).codeToTokensBase(r,n)},async codeToTokensWithThemes(r,n){return(await e({langs:[n.lang],themes:Object.values(n.themes).filter(Boolean)})).codeToTokensWithThemes(r,n)},async getLastGrammarState(r,n){return(await e({langs:[n.lang],themes:[n.theme]})).getLastGrammarState(r,n)}}}const eG=b3e({langs:xV,themes:RLe,engine:()=>SV(Z(()=>import("./wasm-CG6Dc4jp.js"),[]))}),{codeToHtml:E3e,codeToHast:S9e,codeToTokens:T9e,codeToTokensBase:C9e,codeToTokensWithThemes:k9e,getSingletonHighlighter:A9e,getLastGrammarState:R9e}=w3e(eG),x3e={langs:["shell"],themes:["light-plus","dark-plus"]},S3e=await eG(x3e),T3e=I.memo(({messageId:t})=>{const e=I.useRef(!1),[r,n]=I.useState(!1),[s,i]=I.useState(!1),a=wt(Ze.artifacts)[t],l=wt(xT(a.runner.actions,u=>Object.values(u))),c=()=>{e.current=!0,n(!r)};return I.useEffect(()=>{if(l.length&&!r&&!e.current&&n(!0),l.length!==0&&a.type==="bundled"){const u=!l.find(h=>h.status!=="complete");s!==u&&i(u)}},[l]),T.jsxs("div",{className:"artifact border border-Terretacode-elements-borderColor flex flex-col overflow-hidden rounded-lg w-full transition-border duration-150",children:[T.jsxs("div",{className:"flex",children:[T.jsxs("button",{className:"flex items-stretch bg-Terretacode-elements-artifacts-background hover:bg-Terretacode-elements-artifacts-backgroundHover w-full overflow-hidden",onClick:()=>{const u=Ze.showWorkbench.get();Ze.showWorkbench.set(!u)},children:[a.type=="bundled"&&T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"p-4",children:s?T.jsx("div",{className:"i-ph:files-light",style:{fontSize:"2rem"}}):T.jsx("div",{className:"i-svg-spinners:90-ring-with-bg",style:{fontSize:"2rem"}})}),T.jsx("div",{className:"bg-Terretacode-elements-artifacts-borderColor w-[1px]"})]}),T.jsxs("div",{className:"px-5 p-3.5 w-full text-left",children:[T.jsx("div",{className:"w-full text-Terretacode-elements-textPrimary font-medium leading-5 text-sm",children:a?.title}),T.jsx("div",{className:"w-full w-full text-Terretacode-elements-textSecondary text-xs mt-0.5",children:"Click to open Workbench"})]})]}),T.jsx("div",{className:"bg-Terretacode-elements-artifacts-borderColor w-[1px]"}),T.jsx(Zd,{children:l.length&&a.type!=="bundled"&&T.jsx(yr.button,{initial:{width:0},animate:{width:"auto"},exit:{width:0},transition:{duration:.15,ease:Ss},className:"bg-Terretacode-elements-artifacts-background hover:bg-Terretacode-elements-artifacts-backgroundHover",onClick:c,children:T.jsx("div",{className:"p-4",children:T.jsx("div",{className:r?"i-ph:caret-up-bold":"i-ph:caret-down-bold"})})})})]}),T.jsx(Zd,{children:a.type!=="bundled"&&r&&l.length>0&&T.jsxs(yr.div,{className:"actions",initial:{height:0},animate:{height:"auto"},exit:{height:"0px"},transition:{duration:.15},children:[T.jsx("div",{className:"bg-Terretacode-elements-artifacts-borderColor h-[1px]"}),T.jsx("div",{className:"p-5 text-left bg-Terretacode-elements-actions-background",children:T.jsx(R3e,{actions:l})})]})})]})});function C3e({classsName:t,code:e}){return T.jsx("div",{className:qe("text-xs",t),dangerouslySetInnerHTML:{__html:S3e.codeToHtml(e,{lang:"shell",theme:"dark-plus"})}})}const k3e={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};function A3e(t){Ze.currentView.get()!=="code"&&Ze.currentView.set("code"),Ze.setSelectedFile(`${ya}/${t}`)}const R3e=I.memo(({actions:t})=>T.jsx(yr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15},children:T.jsx("ul",{className:"list-none space-y-2.5",children:t.map((e,r)=>{const{status:n,type:s,content:i}=e,o=r===t.length-1;return T.jsxs(yr.li,{variants:k3e,initial:"hidden",animate:"visible",transition:{duration:.2,ease:Ss},children:[T.jsxs("div",{className:"flex items-center gap-1.5 text-sm",children:[T.jsx("div",{className:qe("text-lg",I3e(e.status)),children:n==="running"?T.jsx(T.Fragment,{children:s!=="start"?T.jsx("div",{className:"i-svg-spinners:90-ring-with-bg"}):T.jsx("div",{className:"i-ph:terminal-window-duotone"})}):n==="pending"?T.jsx("div",{className:"i-ph:circle-duotone"}):n==="complete"?T.jsx("div",{className:"i-ph:check"}):n==="failed"||n==="aborted"?T.jsx("div",{className:"i-ph:x"}):null}),s==="file"?T.jsxs("div",{children:["Create"," ",T.jsx("code",{className:"bg-Terretacode-elements-artifacts-inlineCode-background text-Terretacode-elements-artifacts-inlineCode-text px-1.5 py-1 rounded-md text-Terretacode-elements-item-contentAccent hover:underline cursor-pointer",onClick:()=>A3e(e.filePath),children:e.filePath})]}):s==="shell"?T.jsx("div",{className:"flex items-center w-full min-h-[28px]",children:T.jsx("span",{className:"flex-1",children:"Run command"})}):s==="start"?T.jsx("a",{onClick:a=>{a.preventDefault(),Ze.currentView.set("preview")},className:"flex items-center w-full min-h-[28px]",children:T.jsx("span",{className:"flex-1",children:"Start Application"})}):null]}),(s==="shell"||s==="start")&&T.jsx(C3e,{classsName:qe("mt-1",{"mb-3.5":!o}),code:i})]},r)})})}));function I3e(t){switch(t){case"pending":return"text-Terretacode-elements-textTertiary";case"running":return"text-Terretacode-elements-loader-progress";case"complete":return"text-Terretacode-elements-icon-success";case"aborted":return"text-Terretacode-elements-textSecondary";case"failed":return"text-Terretacode-elements-icon-error";default:return}}const P3e="C",O3e={CopyButtonContainer:P3e},NN=Fn("CodeBlock"),D3e=I.memo(({className:t,code:e,language:r="plaintext",theme:n="dark-plus",disableCopy:s=!1})=>{const[i,o]=I.useState(void 0),[a,l]=I.useState(!1),c=()=>{a||(navigator.clipboard.writeText(e),l(!0),setTimeout(()=>{l(!1)},2e3))};return I.useEffect(()=>{r&&!jA(r)&&!(r in xV)&&NN.warn(`Unsupported language '${r}'`),NN.trace(`Language = ${r}`),(async()=>{o(await E3e(e,{lang:r,theme:n}))})()},[e]),T.jsxs("div",{className:qe("relative group text-left",t),children:[T.jsx("div",{className:qe(O3e.CopyButtonContainer,"bg-transparant absolute top-[10px] right-[10px] rounded-md z-10 text-lg flex items-center justify-center opacity-0 group-hover:opacity-100",{"rounded-l-0 opacity-100":a}),children:!s&&T.jsx("button",{className:qe("flex items-center bg-accent-500 p-[6px] justify-center before:bg-white before:rounded-l-md before:text-gray-500 before:border-r before:border-gray-300 rounded-md transition-theme",{"before:opacity-0":!a,"before:opacity-100":a}),title:"Copy Code",onClick:()=>c(),children:T.jsx("div",{className:"i-ph:clipboard-text-duotone"})})}),T.jsx("div",{dangerouslySetInnerHTML:{__html:i??""}})]})}),L3e="B",N3e={MarkdownContent:L3e},MN=Fn("MarkdownComponent"),XS=I.memo(({children:t,html:e=!1,limitedMarkdown:r=!1})=>{MN.trace("Render");const n=I.useMemo(()=>({div:({className:s,children:i,node:o,...a})=>{if(s?.includes("__TerretacodeArtifact__")){const l=o?.properties.dataMessageId;return l||MN.error(`Invalid message id ${l}`),T.jsx(T3e,{messageId:l})}return T.jsx("div",{className:s,...a,children:i})},pre:s=>{const{children:i,node:o,...a}=s,[l]=o?.children??[];if(l&&l.type==="element"&&l.tagName==="code"&&l.children[0].type==="text"){const{className:c,...u}=l.properties,[,h="plaintext"]=/language-(\w+)/.exec(String(c)||"")??[];return T.jsx(D3e,{code:l.children[0].value,language:h,...u})}return T.jsx("pre",{...a,children:i})}}),[]);return T.jsx(SLe,{allowedElements:Ek,className:N3e.MarkdownContent,components:n,remarkPlugins:rwe(r),rehypePlugins:nwe(e),children:M3e(t)})}),M3e=t=>{if(!t||!t.includes("__TerretacodeArtifact__"))return t;const e=t.split(`
`),r=e.findIndex(n=>n.includes("__TerretacodeArtifact__"));return r===-1?t:(r>0&&e[r-1]?.trim().match(/^```\w*$/)&&(e[r-1]=""),r<e.length-1&&e[r+1]?.trim().match(/^```$/)&&(e[r+1]=""),e.join(`
`))},B3e=I.memo(({content:t,annotations:e})=>{const n=(e?.filter(s=>s&&typeof s=="object"&&Object.keys(s).includes("type"))||[]).find(s=>s.type==="usage")?.value;return T.jsxs("div",{className:"overflow-hidden w-full",children:[n&&T.jsxs("div",{className:"text-sm text-Terretacode-elements-textSecondary mb-2",children:["Tokens: ",n.totalTokens," (prompt: ",n.promptTokens,", completion: ",n.completionTokens,")"]}),T.jsx(XS,{html:!0,children:t})]})});function F3e({content:t}){if(Array.isArray(t)){const r=t.find(i=>i.type==="text"),n=BN(r?.text||""),s=t.filter(i=>i.type==="image"&&i.image);return T.jsx("div",{className:"overflow-hidden pt-[4px]",children:T.jsxs("div",{className:"flex flex-col gap-4",children:[n&&T.jsx(XS,{html:!0,children:n}),s.map((i,o)=>T.jsx("img",{src:i.image,alt:`Image ${o+1}`,className:"max-w-full h-auto rounded-lg",style:{maxHeight:"512px",objectFit:"contain"}},o))]})})}const e=BN(t);return T.jsx("div",{className:"overflow-hidden pt-[4px]",children:T.jsx(XS,{html:!0,children:e})})}function BN(t){return t.replace(Bde,"").replace(Fde,"")}const j3e=at.forwardRef((t,e)=>{const{id:r,isStreaming:n=!1,messages:s=[]}=t,i=pq(),o=l=>{const c=new URLSearchParams(i.search);c.set("rewindTo",l),window.location.search=c.toString()},a=async l=>{try{if(!Rt||!la.get()){Ne.error("Chat persistence is not available");return}const c=await Tpe(Rt,la.get(),l);window.location.href=`/chat/${c}`}catch(c){Ne.error("Failed to fork chat: "+c.message)}};return T.jsxs("div",{id:r,ref:e,className:t.className,children:[s.length>0?s.map((l,c)=>{const{role:u,content:h,id:d,annotations:f}=l,g=u==="user",_=c===0,m=c===s.length-1;return f?.includes("hidden")?T.jsx(I.Fragment,{},c):T.jsxs("div",{className:qe("flex gap-4 p-6 w-full rounded-[calc(0.75rem-1px)]",{"bg-Terretacode-elements-messages-background":g||!n||n&&!m,"bg-gradient-to-b from-Terretacode-elements-messages-background from-30% to-transparent":n&&m,"mt-4":!_}),children:[g&&T.jsx("div",{className:"flex items-center justify-center w-[34px] h-[34px] overflow-hidden bg-white text-gray-600 rounded-full shrink-0 self-start",children:T.jsx("div",{className:"i-ph:user-fill text-xl"})}),T.jsx("div",{className:"grid grid-col-1 w-full",children:g?T.jsx(F3e,{content:h}):T.jsx(B3e,{content:h,annotations:l.annotations})}),!g&&T.jsxs("div",{className:"flex gap-2 flex-col lg:flex-row",children:[d&&T.jsx(Ou,{tooltip:"Revert to this message",children:T.jsx("button",{onClick:()=>o(d),className:qe("i-ph:arrow-u-up-left","text-xl text-Terretacode-elements-textSecondary hover:text-Terretacode-elements-textPrimary transition-colors")},"i-ph:arrow-u-up-left")}),T.jsx(Ou,{tooltip:"Fork chat from this message",children:T.jsx("button",{onClick:()=>a(d),className:qe("i-ph:git-fork","text-xl text-Terretacode-elements-textSecondary hover:text-Terretacode-elements-textPrimary transition-colors")},"i-ph:git-fork")})]})]},c)}):null,n&&T.jsx("div",{className:"text-center w-full text-Terretacode-elements-textSecondary i-svg-spinners:3-dots-fade text-4xl mt-4"})]})}),U3e=sc(.4,0,.2,1),$3e=({show:t,isStreaming:e,disabled:r,onClick:n})=>T.jsx(Zd,{children:t?T.jsx(yr.button,{className:"absolute flex justify-center items-center top-[18px] right-[22px] p-1 bg-accent-500 hover:brightness-94 color-white rounded-md w-[34px] h-[34px] transition-theme disabled:opacity-50 disabled:cursor-not-allowed",transition:{ease:U3e,duration:.17},initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},disabled:r,onClick:s=>{s.preventDefault(),r||n?.(s)},children:T.jsx("div",{className:"text-lg",children:e?T.jsx("div",{className:"i-ph:stop-circle-bold"}):T.jsx("div",{className:"i-ph:arrow-right"})})}):null}),u1={},FN={};function uy(){const t=Ke.get("apiKeys");let e={};return t&&(e=FN[t],e||(e=FN[t]=JSON.parse(t))),e}const H3e=({provider:t,apiKey:e,setApiKey:r})=>{const[n,s]=I.useState(!1),[i,o]=I.useState(e),[a,l]=I.useState(!1);I.useEffect(()=>{const d=uy()[t.name]||"";o(d),r(d),s(!1)},[t.name]);const c=I.useCallback(async()=>{if(u1[t.name]!==void 0){l(u1[t.name]);return}try{const f=(await(await fetch(`/api/check-env-key?provider=${encodeURIComponent(t.name)}`)).json()).isSet;u1[t.name]=f,l(f)}catch(h){console.error("Failed to check environment API key:",h),l(!1)}},[t.name]);I.useEffect(()=>{c()},[c]);const u=()=>{r(i);const d={...uy(),[t.name]:i};Ke.set("apiKeys",JSON.stringify(d)),s(!1)};return T.jsxs("div",{className:"flex items-center justify-between py-3 px-1",children:[T.jsx("div",{className:"flex items-center gap-2 flex-1",children:T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsxs("span",{className:"text-sm font-medium text-Terretacode-elements-textSecondary",children:[t?.name," API Key:"]}),!n&&T.jsx("div",{className:"flex items-center gap-2",children:e?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"i-ph:check-circle-fill text-green-500 w-4 h-4"}),T.jsx("span",{className:"text-xs text-green-500",children:"Set via UI"})]}):a?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"i-ph:check-circle-fill text-green-500 w-4 h-4"}),T.jsx("span",{className:"text-xs text-green-500",children:"Set via environment variable"})]}):T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"i-ph:x-circle-fill text-red-500 w-4 h-4"}),T.jsx("span",{className:"text-xs text-red-500",children:"Not Set (Please set via UI or ENV_VAR)"})]})})]})}),T.jsx("div",{className:"flex items-center gap-2 shrink-0",children:n?T.jsxs("div",{className:"flex items-center gap-2",children:[T.jsx("input",{type:"password",value:i,placeholder:"Enter API Key",onChange:h=>o(h.target.value),className:`w-[300px] px-3 py-1.5 text-sm rounded border border-Terretacode-elements-borderColor 
                        bg-Terretacode-elements-prompt-background text-Terretacode-elements-textPrimary 
                        focus:outline-none focus:ring-2 focus:ring-Terretacode-elements-focus`}),T.jsx(cr,{onClick:u,title:"Save API Key",className:"bg-green-500/10 hover:bg-green-500/20 text-green-500",children:T.jsx("div",{className:"i-ph:check w-4 h-4"})}),T.jsx(cr,{onClick:()=>s(!1),title:"Cancel",className:"bg-red-500/10 hover:bg-red-500/20 text-red-500",children:T.jsx("div",{className:"i-ph:x w-4 h-4"})})]}):T.jsxs(T.Fragment,{children:[T.jsx(cr,{onClick:()=>s(!0),title:"Edit API Key",className:"bg-blue-500/10 hover:bg-blue-500/20 text-blue-500",children:T.jsx("div",{className:"i-ph:pencil-simple w-4 h-4"})}),t?.getApiKeyLink&&!e&&T.jsxs(cr,{onClick:()=>window.open(t?.getApiKeyLink),title:"Get API Key",className:"bg-purple-500/10 hover:bg-purple-500/20 text-purple-500 flex items-center gap-2",children:[T.jsx("span",{className:"text-xs whitespace-nowrap",children:t?.labelForGetApiKey||"Get API Key"}),T.jsx("div",{className:`${t?.icon||"i-ph:key"} w-4 h-4`})]})]})})]})},z3e="s",V3e="t",G3e="u",W3e="v",q3e="w",Kh={BaseChat:z3e,Chat:V3e,PromptEffectContainer:G3e,PromptEffectLine:W3e,PromptShine:q3e},K3e=({exportChat:t})=>T.jsx(Ou,{tooltip:"Export Chat",children:T.jsx(cr,{title:"Export Chat",onClick:()=>t?.(),children:T.jsx("div",{className:"i-ph:download-simple text-xl"})})});var jN={};function UN(t){return Array.isArray(t)?t:[t]}const ZS="",$N=" ",h1="\\",Y3e=/^\s+$/,X3e=/(?:[^\\]|^)\\$/,Z3e=/^\\!/,J3e=/^\\#/,Q3e=/\r?\n/g,eBe=/^\.*\/|^\.+$/,d1="/";let tG="node-ignore";typeof Symbol<"u"&&(tG=Symbol.for("node-ignore"));const HN=tG,tBe=(t,e,r)=>Object.defineProperty(t,e,{value:r}),rBe=/([0-z])-([0-z])/g,rG=()=>!1,nBe=t=>t.replace(rBe,(e,r,n)=>r.charCodeAt(0)<=n.charCodeAt(0)?e:ZS),sBe=t=>{const{length:e}=t;return t.slice(0,e-e%2)},iBe=[[/^\uFEFF/,()=>ZS],[/((?:\\\\)*?)(\\?\s+)$/,(t,e,r)=>e+(r.indexOf("\\")===0?$N:ZS)],[/(\\+?)\s/g,(t,e)=>{const{length:r}=e;return e.slice(0,r-r%2)+$N}],[/[\\$.|*+(){^]/g,t=>`\\${t}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(t,e,r)=>e+6<r.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(t,e,r)=>{const n=r.replace(/\\\*/g,"[^\\/]*");return e+n}],[/\\\\\\(?=[$.|*+(){^])/g,()=>h1],[/\\\\/g,()=>h1],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(t,e,r,n,s)=>e===h1?`\\[${r}${sBe(n)}${s}`:s==="]"&&n.length%2===0?`[${nBe(r)}${n}]`:"[]"],[/(?:[^*])$/,t=>/\/$/.test(t)?`${t}$`:`${t}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(t,e)=>`${e?`${e}[^/]+`:"[^/]*"}(?=$|\\/$)`]],zN=Object.create(null),oBe=(t,e)=>{let r=zN[t];return r||(r=iBe.reduce((n,[s,i])=>n.replace(s,i.bind(t)),t),zN[t]=r),e?new RegExp(r,"i"):new RegExp(r)},zA=t=>typeof t=="string",aBe=t=>t&&zA(t)&&!Y3e.test(t)&&!X3e.test(t)&&t.indexOf("#")!==0,lBe=t=>t.split(Q3e);let cBe=class{constructor(e,r,n,s){this.origin=e,this.pattern=r,this.negative=n,this.regex=s}};const uBe=(t,e)=>{const r=t;let n=!1;t.indexOf("!")===0&&(n=!0,t=t.substr(1)),t=t.replace(Z3e,"!").replace(J3e,"#");const s=oBe(t,e);return new cBe(r,t,n,s)},hBe=(t,e)=>{throw new e(t)},Ao=(t,e,r)=>zA(t)?t?Ao.isNotRelative(t)?r(`path should be a \`path.relative()\`d string, but got "${e}"`,RangeError):!0:r("path must not be empty",TypeError):r(`path must be a string, but got \`${e}\``,TypeError),nG=t=>eBe.test(t);Ao.isNotRelative=nG;Ao.convert=t=>t;let dBe=class{constructor({ignorecase:e=!0,ignoreCase:r=e,allowRelativePaths:n=!1}={}){tBe(this,HN,!0),this._rules=[],this._ignoreCase=r,this._allowRelativePaths=n,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(e){if(e&&e[HN]){this._rules=this._rules.concat(e._rules),this._added=!0;return}if(aBe(e)){const r=uBe(e,this._ignoreCase);this._added=!0,this._rules.push(r)}}add(e){return this._added=!1,UN(zA(e)?lBe(e):e).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(e){return this.add(e)}_testOne(e,r){let n=!1,s=!1;return this._rules.forEach(i=>{const{negative:o}=i;if(s===o&&n!==s||o&&!n&&!s&&!r)return;i.regex.test(e)&&(n=!o,s=o)}),{ignored:n,unignored:s}}_test(e,r,n,s){const i=e&&Ao.convert(e);return Ao(i,e,this._allowRelativePaths?rG:hBe),this._t(i,r,n,s)}_t(e,r,n,s){if(e in r)return r[e];if(s||(s=e.split(d1)),s.pop(),!s.length)return r[e]=this._testOne(e,n);const i=this._t(s.join(d1)+d1,r,n,s);return r[e]=i.ignored?i:this._testOne(e,n)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return UN(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}};const hy=t=>new dBe(t),fBe=t=>Ao(t&&Ao.convert(t),t,rG);hy.isPathValid=fBe;hy.default=hy;var pBe=hy;if(typeof Dt<"u"&&(jN&&jN.IGNORE_TEST_WIN32||Dt.platform==="win32")){const t=r=>/^\\\\\?\\/.test(r)||/["<>|\u0000-\u001F]+/u.test(r)?r:r.replace(/\\/g,"/");Ao.convert=t;const e=/^[a-z]:\//i;Ao.isNotRelative=r=>e.test(r)||nG(r)}const VA=rs(pBe),mBe=["node_modules/**",".git/**","dist/**","build/**",".next/**","coverage/**",".cache/**",".vscode/**",".idea/**","**/*.log","**/.DS_Store","**/npm-debug.log*","**/yarn-debug.log*","**/yarn-error.log*"],f1=1e3,gBe=VA().add(mBe),dy=()=>Math.random().toString(36).substring(2,15),_Be=async t=>{const r=new Uint8Array(await t.slice(0,1024).arrayBuffer());for(let n=0;n<r.length;n++){const s=r[n];if(s===0||s<32&&s!==9&&s!==10&&s!==13)return!0}return!1},yBe=t=>!gBe.ignores(t);async function sG(t){const e=r=>t.some(n=>n.path.endsWith(r));if(e("package.json")){const r=t.find(n=>n.path.endsWith("package.json"));if(!r)return{type:"",setupCommand:"",followupMessage:""};try{const s=JSON.parse(r.content)?.scripts||{},o=["dev","start","preview"].find(a=>s[a]);return o?{type:"Node.js",setupCommand:`npm install && npm run ${o}`,followupMessage:`Found "${o}" script in package.json. Running "npm run ${o}" after installation.`}:{type:"Node.js",setupCommand:"npm install",followupMessage:"Would you like me to inspect package.json to determine the available scripts for running this project?"}}catch(n){return console.error("Error parsing package.json:",n),{type:"",setupCommand:"",followupMessage:""}}}return e("index.html")?{type:"Static",setupCommand:"npx --yes serve",followupMessage:""}:{type:"",setupCommand:"",followupMessage:""}}function iG(t){return t.setupCommand?{role:"assistant",content:`
<TerretacodeArtifact id="project-setup" title="Project Setup">
<TerretacodeAction type="shell">
${t.setupCommand}
</TerretacodeAction>
</TerretacodeArtifact>${t.followupMessage?`

${t.followupMessage}`:""}`,id:dy(),createdAt:new Date}:null}const bBe=async(t,e,r)=>{const n=await Promise.all(t.map(async u=>new Promise((h,d)=>{const f=new FileReader;f.onload=()=>{const g=f.result,_=u.webkitRelativePath.split("/").slice(1).join("/");h({content:g,path:_})},f.onerror=d,f.readAsText(u)}))),s=await sG(n),i=iG(s),o=e.length>0?`

Skipped ${e.length} binary files:
${e.map(u=>`- ${u}`).join(`
`)}`:"",a={role:"assistant",content:`I've imported the contents of the "${r}" folder.${o}

<TerretacodeArtifact id="imported-files" title="Imported Files">
${n.map(u=>`<TerretacodeAction type="file" filePath="${u.path}">
${u.content}
</TerretacodeAction>`).join(`

`)}
</TerretacodeArtifact>`,id:dy(),createdAt:new Date},c=[{role:"user",id:dy(),content:`Import the "${r}" folder`,createdAt:new Date},a];return i&&c.push(i),c},vBe=({className:t,importChat:e})=>{const[r,n]=I.useState(!1),s=async i=>{const a=Array.from(i.target.files||[]).filter(u=>{const h=u.webkitRelativePath.split("/").slice(1).join("/");return yBe(h)});if(a.length===0){const u=new Error("No valid files found");ft.logError("File import failed - no valid files",u,{folderName:"Unknown Folder"}),Ne.error("No files found in the selected folder");return}if(a.length>f1){const u=new Error(`Too many files: ${a.length}`);ft.logError("File import failed - too many files",u,{fileCount:a.length,maxFiles:f1}),Ne.error(`This folder contains ${a.length.toLocaleString()} files. This product is not yet optimized for very large projects. Please select a folder with fewer than ${f1.toLocaleString()} files.`);return}const l=a[0]?.webkitRelativePath.split("/")[0]||"Unknown Folder";n(!0);const c=Ne.loading(`Importing ${l}...`);try{const u=await Promise.all(a.map(async g=>({file:g,isBinary:await _Be(g)}))),h=u.filter(g=>!g.isBinary).map(g=>g.file),d=u.filter(g=>g.isBinary).map(g=>g.file.webkitRelativePath.split("/").slice(1).join("/"));if(h.length===0){const g=new Error("No text files found");ft.logError("File import failed - no text files",g,{folderName:l}),Ne.error("No text files found in the selected folder");return}d.length>0&&(ft.logWarning("Skipping binary files during import",{folderName:l,binaryCount:d.length}),Ne.info(`Skipping ${d.length} binary files`));const f=await bBe(h,d,l);e&&await e(l,[...f]),ft.logSystem("Folder imported successfully",{folderName:l,textFileCount:h.length,binaryFileCount:d.length}),Ne.success("Folder imported successfully")}catch(u){ft.logError("Failed to Importar Carpeta",u,{folderName:l}),console.error("Failed to Importar Carpeta:",u),Ne.error("Failed to Importar Carpeta")}finally{n(!1),Ne.dismiss(c),i.target.value=""}};return T.jsxs(T.Fragment,{children:[T.jsx("input",{type:"file",id:"folder-import",className:"hidden",webkitdirectory:"",directory:"",onChange:s}),T.jsxs("button",{onClick:()=>{document.getElementById("folder-import")?.click()},className:t,disabled:r,children:[T.jsx("div",{className:"i-ph:upload-simple"}),r?"Importing...":"Importar Carpeta"]})]})};function wBe(t){return T.jsxs("div",{className:"flex flex-col items-center justify-center w-auto",children:[T.jsx("input",{type:"file",id:"chat-import",className:"hidden",accept:".json",onChange:async e=>{const r=e.target.files?.[0];if(r&&t){try{const n=new FileReader;n.onload=async s=>{try{const i=s.target?.result,o=JSON.parse(i);if(Array.isArray(o.messages)){await t(o.description||"Imported Chat",o.messages),Ne.success("Chat imported successfully");return}Ne.error("Invalid chat file format")}catch(i){i instanceof Error?Ne.error("Failed to parse chat file: "+i.message):Ne.error("Failed to parse chat file")}},n.onerror=()=>Ne.error("Failed to read chat file"),n.readAsText(r)}catch(n){Ne.error(n instanceof Error?n.message:"Failed to import chat")}e.target.value=""}else Ne.error("Something went wrong")}}),T.jsx("div",{className:"flex flex-col items-center gap-4 max-w-2xl text-center",children:T.jsxs("div",{className:"flex gap-2",children:[T.jsxs("button",{onClick:()=>{document.getElementById("chat-import")?.click()},className:"px-4 py-2 rounded-lg border border-Terretacode-elements-borderColor bg-Terretacode-elements-prompt-background text-Terretacode-elements-textPrimary hover:bg-Terretacode-elements-background-depth-3 transition-all flex items-center gap-2",children:[T.jsx("div",{className:"i-ph:upload-simple"}),"Importar Chat"]}),T.jsx(vBe,{importChat:t,className:"px-4 py-2 rounded-lg border border-Terretacode-elements-borderColor bg-Terretacode-elements-prompt-background text-Terretacode-elements-textPrimary hover:bg-Terretacode-elements-background-depth-3 transition-all flex items-center gap-2"})]})})]})}const EBe=[{text:"Crea una aplicación de tareas pendientes en React usando Tailwind"},{text:"Crea un Blog simple usando Astro"},{text:"Cree un formulario de consentimiento de cookies utilizando Material UI"},{text:"Crea un juego de invasores del espacio"},{text:"Crea un juego de tres en raya solo en HTML, CSS y JS"}];function xBe(t){return T.jsx("div",{id:"examples",className:"relative flex flex-col gap-9 w-full max-w-3xl mx-auto flex justify-center mt-6",children:T.jsx("div",{className:"flex flex-wrap justify-center gap-2",style:{animation:".25s ease-out 0s 1 _fade-and-move-in_g2ptj_1 forwards"},children:EBe.map((e,r)=>T.jsx("button",{onClick:n=>{t?.(n,e.text)},className:"border border-Terretacode-elements-borderColor rounded-full bg-gray-50 hover:bg-gray-100 dark:bg-gray-950 dark:hover:bg-gray-900 text-Terretacode-elements-textSecondary hover:text-Terretacode-elements-textPrimary px-3 py-1 text-xs transition-theme",children:e.text},r))})})}var qn=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof Dt>"u"||typeof Dt.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||qn.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||qn.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||qn.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=qn.DEFAULT_MAX_PENDING};qn.DEFAULT_TIMEOUT=0;qn.DEFAULT_MAX_OCCUPATION_TIME=0;qn.DEFAULT_MAX_EXECUTION_TIME=0;qn.DEFAULT_MAX_PENDING=1e3;qn.prototype.acquire=function(t,e,r,n){if(Array.isArray(t))return this._acquireBatch(t,e,r,n);if(typeof e!="function")throw new Error("You must pass a function to execute");var s=null,i=null,o=null;typeof r!="function"&&(n=r,r=null,o=new this.Promise(function(y,b){s=y,i=b})),n=n||{};var a=!1,l=null,c=null,u=null,h=this,d=function(y,b,v){c&&(clearTimeout(c),c=null),u&&(clearTimeout(u),u=null),y&&(h.queues[t]&&h.queues[t].length===0&&delete h.queues[t],h.domainReentrant&&delete h.domains[t]),a||(o?b?i(b):s(v):typeof r=="function"&&r(b,v),a=!0),y&&h.queues[t]&&h.queues[t].length>0&&h.queues[t].shift()()},f=function(y){if(a)return d(y);l&&(clearTimeout(l),l=null),h.domainReentrant&&y&&(h.domains[t]=Dt.domain);var b=n.maxExecutionTime||h.maxExecutionTime;if(b&&(u=setTimeout(function(){h.queues[t]&&d(y,new Error("Maximum execution time is exceeded "+t))},b)),e.length===1){var v=!1;try{e(function(w,E){v||(v=!0,d(y,w,E))})}catch(w){v||(v=!0,d(y,w))}}else h._promiseTry(function(){return e()}).then(function(w){d(y,void 0,w)},function(w){d(y,w)})};h.domainReentrant&&Dt.domain&&(f=Dt.domain.bind(f));var g=n.maxPending||h.maxPending;if(!h.queues[t])h.queues[t]=[],f(!0);else if(h.domainReentrant&&Dt.domain&&Dt.domain===h.domains[t])f(!1);else if(h.queues[t].length>=g)d(!1,new Error("Too many pending tasks in queue "+t));else{var _=function(){f(!0)};n.skipQueue?h.queues[t].unshift(_):h.queues[t].push(_);var m=n.timeout||h.timeout;m&&(l=setTimeout(function(){l=null,d(!1,new Error("async-lock timed out in queue "+t))},m))}var p=n.maxOccupationTime||h.maxOccupationTime;if(p&&(c=setTimeout(function(){h.queues[t]&&d(!1,new Error("Maximum occupation time is exceeded in queue "+t))},p)),o)return o};qn.prototype._acquireBatch=function(t,e,r,n){typeof r!="function"&&(n=r,r=null);var s=this,i=function(a,l){return function(c){s.acquire(a,l,c,n)}},o=t.reduceRight(function(a,l){return i(l,a)},e);if(typeof r=="function")o(r);else return new this.Promise(function(a,l){o.length===1?o(function(c,u){c?l(c):a(u)}):a(o())})};qn.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0};qn.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(e){return this.Promise.reject(e)}};var SBe=qn,TBe=SBe;const fy=rs(TBe);var JS={exports:{}};typeof Object.create=="function"?JS.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:JS.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}};var CBe=JS.exports,QS={exports:{}};const kBe=mq(Cee);/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(t,e){var r=kBe,n=r.Buffer;function s(o,a){for(var l in o)a[l]=o[l]}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=r:(s(r,e),e.Buffer=i);function i(o,a,l){return n(o,a,l)}i.prototype=Object.create(n.prototype),s(n,i),i.from=function(o,a,l){if(typeof o=="number")throw new TypeError("Argument must not be a number");return n(o,a,l)},i.alloc=function(o,a,l){if(typeof o!="number")throw new TypeError("Argument must be a number");var c=n(o);return a!==void 0?typeof l=="string"?c.fill(a,l):c.fill(a):c.fill(0),c},i.allocUnsafe=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return n(o)},i.allocUnsafeSlow=function(o){if(typeof o!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(o)}})(QS,QS.exports);var oG=QS.exports,aG=oG.Buffer;function Xb(t,e){this._block=aG.alloc(t),this._finalSize=e,this._blockSize=t,this._len=0}Xb.prototype.update=function(t,e){typeof t=="string"&&(e=e||"utf8",t=aG.from(t,e));for(var r=this._block,n=this._blockSize,s=t.length,i=this._len,o=0;o<s;){for(var a=i%n,l=Math.min(s-o,n-a),c=0;c<l;c++)r[a+c]=t[o+c];i+=l,o+=l,i%n===0&&this._update(r)}return this._len+=s,this};Xb.prototype.digest=function(t){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var r=this._len*8;if(r<=4294967295)this._block.writeUInt32BE(r,this._blockSize-4);else{var n=(r&4294967295)>>>0,s=(r-n)/4294967296;this._block.writeUInt32BE(s,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)}this._update(this._block);var i=this._hash();return t?i.toString(t):i};Xb.prototype._update=function(){throw new Error("_update must be implemented by subclass")};var ABe=Xb,RBe=CBe,lG=ABe,IBe=oG.Buffer,PBe=[1518500249,1859775393,-1894007588,-899497514],OBe=new Array(80);function Wp(){this.init(),this._w=OBe,lG.call(this,64,56)}RBe(Wp,lG);Wp.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function DBe(t){return t<<1|t>>>31}function LBe(t){return t<<5|t>>>27}function NBe(t){return t<<30|t>>>2}function MBe(t,e,r,n){return t===0?e&r|~e&n:t===2?e&r|e&n|r&n:e^r^n}Wp.prototype._update=function(t){for(var e=this._w,r=this._a|0,n=this._b|0,s=this._c|0,i=this._d|0,o=this._e|0,a=0;a<16;++a)e[a]=t.readInt32BE(a*4);for(;a<80;++a)e[a]=DBe(e[a-3]^e[a-8]^e[a-14]^e[a-16]);for(var l=0;l<80;++l){var c=~~(l/20),u=LBe(r)+MBe(c,n,s,i)+o+e[l]+PBe[c]|0;o=i,i=s,s=NBe(n),n=r,r=u}this._a=r+this._a|0,this._b=n+this._b|0,this._c=s+this._c|0,this._d=i+this._d|0,this._e=o+this._e|0};Wp.prototype._hash=function(){var t=IBe.allocUnsafe(20);return t.writeInt32BE(this._a|0,0),t.writeInt32BE(this._b|0,4),t.writeInt32BE(this._c|0,8),t.writeInt32BE(this._d|0,12),t.writeInt32BE(this._e|0,16),t};var BBe=Wp;const cG=rs(BBe);var uG={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */(function(t){(function(e){e(typeof DO_NOT_EXPORT_CRC>"u"?t:{})})(function(e){e.version="1.2.2";function r(){for(var x=0,C=new Array(256),A=0;A!=256;++A)x=A,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,C[A]=x;return typeof Int32Array<"u"?new Int32Array(C):C}var n=r();function s(x){var C=0,A=0,M=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)P[M]=x[M];for(M=0;M!=256;++M)for(A=x[M],C=256+M;C<4096;C+=256)A=P[C]=A>>>8^x[A&255];var D=[];for(M=1;M!=16;++M)D[M-1]=typeof Int32Array<"u"?P.subarray(M*256,M*256+256):P.slice(M*256,M*256+256);return D}var i=s(n),o=i[0],a=i[1],l=i[2],c=i[3],u=i[4],h=i[5],d=i[6],f=i[7],g=i[8],_=i[9],m=i[10],p=i[11],y=i[12],b=i[13],v=i[14];function w(x,C){for(var A=C^-1,M=0,P=x.length;M<P;)A=A>>>8^n[(A^x.charCodeAt(M++))&255];return~A}function E(x,C){for(var A=C^-1,M=x.length-15,P=0;P<M;)A=v[x[P++]^A&255]^b[x[P++]^A>>8&255]^y[x[P++]^A>>16&255]^p[x[P++]^A>>>24]^m[x[P++]]^_[x[P++]]^g[x[P++]]^f[x[P++]]^d[x[P++]]^h[x[P++]]^u[x[P++]]^c[x[P++]]^l[x[P++]]^a[x[P++]]^o[x[P++]]^n[x[P++]];for(M+=15;P<M;)A=A>>>8^n[(A^x[P++])&255];return~A}function S(x,C){for(var A=C^-1,M=0,P=x.length,D=0,R=0;M<P;)D=x.charCodeAt(M++),D<128?A=A>>>8^n[(A^D)&255]:D<2048?(A=A>>>8^n[(A^(192|D>>6&31))&255],A=A>>>8^n[(A^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,R=x.charCodeAt(M++)&1023,A=A>>>8^n[(A^(240|D>>8&7))&255],A=A>>>8^n[(A^(128|D>>2&63))&255],A=A>>>8^n[(A^(128|R>>6&15|(D&3)<<4))&255],A=A>>>8^n[(A^(128|R&63))&255]):(A=A>>>8^n[(A^(224|D>>12&15))&255],A=A>>>8^n[(A^(128|D>>6&63))&255],A=A>>>8^n[(A^(128|D&63))&255]);return~A}e.table=n,e.bstr=w,e.buf=E,e.str=S})})(uG);const FBe=rs(uG);var Mo={};(function(t){var e=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function r(i,o){return Object.prototype.hasOwnProperty.call(i,o)}t.assign=function(i){for(var o=Array.prototype.slice.call(arguments,1);o.length;){var a=o.shift();if(a){if(typeof a!="object")throw new TypeError(a+"must be non-object");for(var l in a)r(a,l)&&(i[l]=a[l])}}return i},t.shrinkBuf=function(i,o){return i.length===o?i:i.subarray?i.subarray(0,o):(i.length=o,i)};var n={arraySet:function(i,o,a,l,c){if(o.subarray&&i.subarray){i.set(o.subarray(a,a+l),c);return}for(var u=0;u<l;u++)i[c+u]=o[a+u]},flattenChunks:function(i){var o,a,l,c,u,h;for(l=0,o=0,a=i.length;o<a;o++)l+=i[o].length;for(h=new Uint8Array(l),c=0,o=0,a=i.length;o<a;o++)u=i[o],h.set(u,c),c+=u.length;return h}},s={arraySet:function(i,o,a,l,c){for(var u=0;u<l;u++)i[c+u]=o[a+u]},flattenChunks:function(i){return[].concat.apply([],i)}};t.setTyped=function(i){i?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,n)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,s))},t.setTyped(e)})(Mo);var qp={},Yi={},yh={},jBe=Mo,UBe=4,VN=0,GN=1,$Be=2;function bh(t){for(var e=t.length;--e>=0;)t[e]=0}var HBe=0,hG=1,zBe=2,VBe=3,GBe=258,GA=29,Kp=256,Yf=Kp+1+GA,pu=30,WA=19,dG=2*Yf+1,vl=15,p1=16,WBe=7,qA=256,fG=16,pG=17,mG=18,eT=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],m0=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],qBe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],gG=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],KBe=512,eo=new Array((Yf+2)*2);bh(eo);var $d=new Array(pu*2);bh($d);var Xf=new Array(KBe);bh(Xf);var Zf=new Array(GBe-VBe+1);bh(Zf);var KA=new Array(GA);bh(KA);var py=new Array(pu);bh(py);function m1(t,e,r,n,s){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=s,this.has_stree=t&&t.length}var _G,yG,bG;function g1(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function vG(t){return t<256?Xf[t]:Xf[256+(t>>>7)]}function Jf(t,e){t.pending_buf[t.pending++]=e&255,t.pending_buf[t.pending++]=e>>>8&255}function Dn(t,e,r){t.bi_valid>p1-r?(t.bi_buf|=e<<t.bi_valid&65535,Jf(t,t.bi_buf),t.bi_buf=e>>p1-t.bi_valid,t.bi_valid+=r-p1):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function xi(t,e,r){Dn(t,r[e*2],r[e*2+1])}function wG(t,e){var r=0;do r|=t&1,t>>>=1,r<<=1;while(--e>0);return r>>>1}function YBe(t){t.bi_valid===16?(Jf(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)}function XBe(t,e){var r=e.dyn_tree,n=e.max_code,s=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length,c,u,h,d,f,g,_=0;for(d=0;d<=vl;d++)t.bl_count[d]=0;for(r[t.heap[t.heap_max]*2+1]=0,c=t.heap_max+1;c<dG;c++)u=t.heap[c],d=r[r[u*2+1]*2+1]+1,d>l&&(d=l,_++),r[u*2+1]=d,!(u>n)&&(t.bl_count[d]++,f=0,u>=a&&(f=o[u-a]),g=r[u*2],t.opt_len+=g*(d+f),i&&(t.static_len+=g*(s[u*2+1]+f)));if(_!==0){do{for(d=l-1;t.bl_count[d]===0;)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[l]--,_-=2}while(_>0);for(d=l;d!==0;d--)for(u=t.bl_count[d];u!==0;)h=t.heap[--c],!(h>n)&&(r[h*2+1]!==d&&(t.opt_len+=(d-r[h*2+1])*r[h*2],r[h*2+1]=d),u--)}}function EG(t,e,r){var n=new Array(vl+1),s=0,i,o;for(i=1;i<=vl;i++)n[i]=s=s+r[i-1]<<1;for(o=0;o<=e;o++){var a=t[o*2+1];a!==0&&(t[o*2]=wG(n[a]++,a))}}function ZBe(){var t,e,r,n,s,i=new Array(vl+1);for(r=0,n=0;n<GA-1;n++)for(KA[n]=r,t=0;t<1<<eT[n];t++)Zf[r++]=n;for(Zf[r-1]=n,s=0,n=0;n<16;n++)for(py[n]=s,t=0;t<1<<m0[n];t++)Xf[s++]=n;for(s>>=7;n<pu;n++)for(py[n]=s<<7,t=0;t<1<<m0[n]-7;t++)Xf[256+s++]=n;for(e=0;e<=vl;e++)i[e]=0;for(t=0;t<=143;)eo[t*2+1]=8,t++,i[8]++;for(;t<=255;)eo[t*2+1]=9,t++,i[9]++;for(;t<=279;)eo[t*2+1]=7,t++,i[7]++;for(;t<=287;)eo[t*2+1]=8,t++,i[8]++;for(EG(eo,Yf+1,i),t=0;t<pu;t++)$d[t*2+1]=5,$d[t*2]=wG(t,5);_G=new m1(eo,eT,Kp+1,Yf,vl),yG=new m1($d,m0,0,pu,vl),bG=new m1(new Array(0),qBe,0,WA,WBe)}function xG(t){var e;for(e=0;e<Yf;e++)t.dyn_ltree[e*2]=0;for(e=0;e<pu;e++)t.dyn_dtree[e*2]=0;for(e=0;e<WA;e++)t.bl_tree[e*2]=0;t.dyn_ltree[qA*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function SG(t){t.bi_valid>8?Jf(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function JBe(t,e,r,n){SG(t),Jf(t,r),Jf(t,~r),jBe.arraySet(t.pending_buf,t.window,e,r,t.pending),t.pending+=r}function WN(t,e,r,n){var s=e*2,i=r*2;return t[s]<t[i]||t[s]===t[i]&&n[e]<=n[r]}function _1(t,e,r){for(var n=t.heap[r],s=r<<1;s<=t.heap_len&&(s<t.heap_len&&WN(e,t.heap[s+1],t.heap[s],t.depth)&&s++,!WN(e,n,t.heap[s],t.depth));)t.heap[r]=t.heap[s],r=s,s<<=1;t.heap[r]=n}function qN(t,e,r){var n,s,i=0,o,a;if(t.last_lit!==0)do n=t.pending_buf[t.d_buf+i*2]<<8|t.pending_buf[t.d_buf+i*2+1],s=t.pending_buf[t.l_buf+i],i++,n===0?xi(t,s,e):(o=Zf[s],xi(t,o+Kp+1,e),a=eT[o],a!==0&&(s-=KA[o],Dn(t,s,a)),n--,o=vG(n),xi(t,o,r),a=m0[o],a!==0&&(n-=py[o],Dn(t,n,a)));while(i<t.last_lit);xi(t,qA,e)}function tT(t,e){var r=e.dyn_tree,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,i=e.stat_desc.elems,o,a,l=-1,c;for(t.heap_len=0,t.heap_max=dG,o=0;o<i;o++)r[o*2]!==0?(t.heap[++t.heap_len]=l=o,t.depth[o]=0):r[o*2+1]=0;for(;t.heap_len<2;)c=t.heap[++t.heap_len]=l<2?++l:0,r[c*2]=1,t.depth[c]=0,t.opt_len--,s&&(t.static_len-=n[c*2+1]);for(e.max_code=l,o=t.heap_len>>1;o>=1;o--)_1(t,r,o);c=i;do o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],_1(t,r,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,r[c*2]=r[o*2]+r[a*2],t.depth[c]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,r[o*2+1]=r[a*2+1]=c,t.heap[1]=c++,_1(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],XBe(t,e),EG(r,l,t.bl_count)}function KN(t,e,r){var n,s=-1,i,o=e[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),e[(r+1)*2+1]=65535,n=0;n<=r;n++)i=o,o=e[(n+1)*2+1],!(++a<l&&i===o)&&(a<c?t.bl_tree[i*2]+=a:i!==0?(i!==s&&t.bl_tree[i*2]++,t.bl_tree[fG*2]++):a<=10?t.bl_tree[pG*2]++:t.bl_tree[mG*2]++,a=0,s=i,o===0?(l=138,c=3):i===o?(l=6,c=3):(l=7,c=4))}function YN(t,e,r){var n,s=-1,i,o=e[0*2+1],a=0,l=7,c=4;for(o===0&&(l=138,c=3),n=0;n<=r;n++)if(i=o,o=e[(n+1)*2+1],!(++a<l&&i===o)){if(a<c)do xi(t,i,t.bl_tree);while(--a!==0);else i!==0?(i!==s&&(xi(t,i,t.bl_tree),a--),xi(t,fG,t.bl_tree),Dn(t,a-3,2)):a<=10?(xi(t,pG,t.bl_tree),Dn(t,a-3,3)):(xi(t,mG,t.bl_tree),Dn(t,a-11,7));a=0,s=i,o===0?(l=138,c=3):i===o?(l=6,c=3):(l=7,c=4)}}function QBe(t){var e;for(KN(t,t.dyn_ltree,t.l_desc.max_code),KN(t,t.dyn_dtree,t.d_desc.max_code),tT(t,t.bl_desc),e=WA-1;e>=3&&t.bl_tree[gG[e]*2+1]===0;e--);return t.opt_len+=3*(e+1)+5+5+4,e}function e6e(t,e,r,n){var s;for(Dn(t,e-257,5),Dn(t,r-1,5),Dn(t,n-4,4),s=0;s<n;s++)Dn(t,t.bl_tree[gG[s]*2+1],3);YN(t,t.dyn_ltree,e-1),YN(t,t.dyn_dtree,r-1)}function t6e(t){var e=4093624447,r;for(r=0;r<=31;r++,e>>>=1)if(e&1&&t.dyn_ltree[r*2]!==0)return VN;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return GN;for(r=32;r<Kp;r++)if(t.dyn_ltree[r*2]!==0)return GN;return VN}var XN=!1;function r6e(t){XN||(ZBe(),XN=!0),t.l_desc=new g1(t.dyn_ltree,_G),t.d_desc=new g1(t.dyn_dtree,yG),t.bl_desc=new g1(t.bl_tree,bG),t.bi_buf=0,t.bi_valid=0,xG(t)}function TG(t,e,r,n){Dn(t,(HBe<<1)+(n?1:0),3),JBe(t,e,r)}function n6e(t){Dn(t,hG<<1,3),xi(t,qA,eo),YBe(t)}function s6e(t,e,r,n){var s,i,o=0;t.level>0?(t.strm.data_type===$Be&&(t.strm.data_type=t6e(t)),tT(t,t.l_desc),tT(t,t.d_desc),o=QBe(t),s=t.opt_len+3+7>>>3,i=t.static_len+3+7>>>3,i<=s&&(s=i)):s=i=r+5,r+4<=s&&e!==-1?TG(t,e,r,n):t.strategy===UBe||i===s?(Dn(t,(hG<<1)+(n?1:0),3),qN(t,eo,$d)):(Dn(t,(zBe<<1)+(n?1:0),3),e6e(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),qN(t,t.dyn_ltree,t.dyn_dtree)),xG(t),n&&SG(t)}function i6e(t,e,r){return t.pending_buf[t.d_buf+t.last_lit*2]=e>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=e&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,e===0?t.dyn_ltree[r*2]++:(t.matches++,e--,t.dyn_ltree[(Zf[r]+Kp+1)*2]++,t.dyn_dtree[vG(e)*2]++),t.last_lit===t.lit_bufsize-1}yh._tr_init=r6e;yh._tr_stored_block=TG;yh._tr_flush_block=s6e;yh._tr_tally=i6e;yh._tr_align=n6e;function o6e(t,e,r,n){for(var s=t&65535|0,i=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+e[n++]|0,i=i+s|0;while(--o);s%=65521,i%=65521}return s|i<<16|0}var CG=o6e;function a6e(){for(var t,e=[],r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=t&1?3988292384^t>>>1:t>>>1;e[r]=t}return e}var l6e=a6e();function c6e(t,e,r,n){var s=l6e,i=n+r;t^=-1;for(var o=n;o<i;o++)t=t>>>8^s[(t^e[o])&255];return t^-1}var kG=c6e,YA={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},un=Mo,ws=yh,AG=CG,Ko=kG,u6e=YA,uc=0,h6e=1,d6e=3,va=4,ZN=5,Si=0,JN=1,Es=-2,f6e=-3,y1=-5,p6e=-1,m6e=1,Ig=2,g6e=3,_6e=4,y6e=0,b6e=2,Zb=8,v6e=9,w6e=15,E6e=8,x6e=29,S6e=256,rT=S6e+1+x6e,T6e=30,C6e=19,k6e=2*rT+1,A6e=15,_t=3,da=258,js=da+_t+1,R6e=32,Jb=42,nT=69,g0=73,_0=91,y0=103,wl=113,fd=666,br=1,Yp=2,Xl=3,vh=4,I6e=3;function fa(t,e){return t.msg=u6e[e],e}function QN(t){return(t<<1)-(t>4?9:0)}function ia(t){for(var e=t.length;--e>=0;)t[e]=0}function Yo(t){var e=t.state,r=e.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(un.arraySet(t.output,e.pending_buf,e.pending_out,r,t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,e.pending===0&&(e.pending_out=0))}function Ur(t,e){ws._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,Yo(t.strm)}function Ct(t,e){t.pending_buf[t.pending++]=e}function Yh(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=e&255}function P6e(t,e,r,n){var s=t.avail_in;return s>n&&(s=n),s===0?0:(t.avail_in-=s,un.arraySet(e,t.input,t.next_in,s,r),t.state.wrap===1?t.adler=AG(t.adler,e,s,r):t.state.wrap===2&&(t.adler=Ko(t.adler,e,s,r)),t.next_in+=s,t.total_in+=s,s)}function RG(t,e){var r=t.max_chain_length,n=t.strstart,s,i,o=t.prev_length,a=t.nice_match,l=t.strstart>t.w_size-js?t.strstart-(t.w_size-js):0,c=t.window,u=t.w_mask,h=t.prev,d=t.strstart+da,f=c[n+o-1],g=c[n+o];t.prev_length>=t.good_match&&(r>>=2),a>t.lookahead&&(a=t.lookahead);do if(s=e,!(c[s+o]!==g||c[s+o-1]!==f||c[s]!==c[n]||c[++s]!==c[n+1])){n+=2,s++;do;while(c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&c[++n]===c[++s]&&n<d);if(i=da-(d-n),n=d-da,i>o){if(t.match_start=e,o=i,i>=a)break;f=c[n+o-1],g=c[n+o]}}while((e=h[e&u])>l&&--r!==0);return o<=t.lookahead?o:t.lookahead}function Zl(t){var e=t.w_size,r,n,s,i,o;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-js)){un.arraySet(t.window,t.window,e,e,0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,r=n;do s=t.head[--r],t.head[r]=s>=e?s-e:0;while(--n);n=e,r=n;do s=t.prev[--r],t.prev[r]=s>=e?s-e:0;while(--n);i+=e}if(t.strm.avail_in===0)break;if(n=P6e(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=n,t.lookahead+t.insert>=_t)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[o+_t-1])&t.hash_mask,t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<_t)););}while(t.lookahead<js&&t.strm.avail_in!==0)}function O6e(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Zl(t),t.lookahead===0&&e===uc)return br;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+r;if((t.strstart===0||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,Ur(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-js&&(Ur(t,!1),t.strm.avail_out===0))return br}return t.insert=0,e===va?(Ur(t,!0),t.strm.avail_out===0?Xl:vh):(t.strstart>t.block_start&&(Ur(t,!1),t.strm.avail_out===0),br)}function b1(t,e){for(var r,n;;){if(t.lookahead<js){if(Zl(t),t.lookahead<js&&e===uc)return br;if(t.lookahead===0)break}if(r=0,t.lookahead>=_t&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+_t-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-js&&(t.match_length=RG(t,r)),t.match_length>=_t)if(n=ws._tr_tally(t,t.strstart-t.match_start,t.match_length-_t),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=_t){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+_t-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=ws._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(Ur(t,!1),t.strm.avail_out===0))return br}return t.insert=t.strstart<_t-1?t.strstart:_t-1,e===va?(Ur(t,!0),t.strm.avail_out===0?Xl:vh):t.last_lit&&(Ur(t,!1),t.strm.avail_out===0)?br:Yp}function Cc(t,e){for(var r,n,s;;){if(t.lookahead<js){if(Zl(t),t.lookahead<js&&e===uc)return br;if(t.lookahead===0)break}if(r=0,t.lookahead>=_t&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+_t-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=_t-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-js&&(t.match_length=RG(t,r),t.match_length<=5&&(t.strategy===m6e||t.match_length===_t&&t.strstart-t.match_start>4096)&&(t.match_length=_t-1)),t.prev_length>=_t&&t.match_length<=t.prev_length){s=t.strstart+t.lookahead-_t,n=ws._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-_t),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=s&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+_t-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=_t-1,t.strstart++,n&&(Ur(t,!1),t.strm.avail_out===0))return br}else if(t.match_available){if(n=ws._tr_tally(t,0,t.window[t.strstart-1]),n&&Ur(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return br}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=ws._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<_t-1?t.strstart:_t-1,e===va?(Ur(t,!0),t.strm.avail_out===0?Xl:vh):t.last_lit&&(Ur(t,!1),t.strm.avail_out===0)?br:Yp}function D6e(t,e){for(var r,n,s,i,o=t.window;;){if(t.lookahead<=da){if(Zl(t),t.lookahead<=da&&e===uc)return br;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=_t&&t.strstart>0&&(s=t.strstart-1,n=o[s],n===o[++s]&&n===o[++s]&&n===o[++s])){i=t.strstart+da;do;while(n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&n===o[++s]&&s<i);t.match_length=da-(i-s),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=_t?(r=ws._tr_tally(t,1,t.match_length-_t),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=ws._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(Ur(t,!1),t.strm.avail_out===0))return br}return t.insert=0,e===va?(Ur(t,!0),t.strm.avail_out===0?Xl:vh):t.last_lit&&(Ur(t,!1),t.strm.avail_out===0)?br:Yp}function L6e(t,e){for(var r;;){if(t.lookahead===0&&(Zl(t),t.lookahead===0)){if(e===uc)return br;break}if(t.match_length=0,r=ws._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(Ur(t,!1),t.strm.avail_out===0))return br}return t.insert=0,e===va?(Ur(t,!0),t.strm.avail_out===0?Xl:vh):t.last_lit&&(Ur(t,!1),t.strm.avail_out===0)?br:Yp}function ii(t,e,r,n,s){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=s}var Yc;Yc=[new ii(0,0,0,0,O6e),new ii(4,4,8,4,b1),new ii(4,5,16,8,b1),new ii(4,6,32,32,b1),new ii(4,4,16,16,Cc),new ii(8,16,32,32,Cc),new ii(8,16,128,128,Cc),new ii(8,32,128,256,Cc),new ii(32,128,258,1024,Cc),new ii(32,258,258,4096,Cc)];function N6e(t){t.window_size=2*t.w_size,ia(t.head),t.max_lazy_match=Yc[t.level].max_lazy,t.good_match=Yc[t.level].good_length,t.nice_match=Yc[t.level].nice_length,t.max_chain_length=Yc[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=_t-1,t.match_available=0,t.ins_h=0}function M6e(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Zb,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new un.Buf16(k6e*2),this.dyn_dtree=new un.Buf16((2*T6e+1)*2),this.bl_tree=new un.Buf16((2*C6e+1)*2),ia(this.dyn_ltree),ia(this.dyn_dtree),ia(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new un.Buf16(A6e+1),this.heap=new un.Buf16(2*rT+1),ia(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new un.Buf16(2*rT+1),ia(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function IG(t){var e;return!t||!t.state?fa(t,Es):(t.total_in=t.total_out=0,t.data_type=b6e,e=t.state,e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?Jb:wl,t.adler=e.wrap===2?0:1,e.last_flush=uc,ws._tr_init(e),Si)}function PG(t){var e=IG(t);return e===Si&&N6e(t.state),e}function B6e(t,e){return!t||!t.state||t.state.wrap!==2?Es:(t.state.gzhead=e,Si)}function OG(t,e,r,n,s,i){if(!t)return Es;var o=1;if(e===p6e&&(e=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),s<1||s>v6e||r!==Zb||n<8||n>15||e<0||e>9||i<0||i>_6e)return fa(t,Es);n===8&&(n=9);var a=new M6e;return t.state=a,a.strm=t,a.wrap=o,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=s+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+_t-1)/_t),a.window=new un.Buf8(a.w_size*2),a.head=new un.Buf16(a.hash_size),a.prev=new un.Buf16(a.w_size),a.lit_bufsize=1<<s+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new un.Buf8(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=i,a.method=r,PG(t)}function F6e(t,e){return OG(t,e,Zb,w6e,E6e,y6e)}function j6e(t,e){var r,n,s,i;if(!t||!t.state||e>ZN||e<0)return t?fa(t,Es):Es;if(n=t.state,!t.output||!t.input&&t.avail_in!==0||n.status===fd&&e!==va)return fa(t,t.avail_out===0?y1:Es);if(n.strm=t,r=n.last_flush,n.last_flush=e,n.status===Jb)if(n.wrap===2)t.adler=0,Ct(n,31),Ct(n,139),Ct(n,8),n.gzhead?(Ct(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Ct(n,n.gzhead.time&255),Ct(n,n.gzhead.time>>8&255),Ct(n,n.gzhead.time>>16&255),Ct(n,n.gzhead.time>>24&255),Ct(n,n.level===9?2:n.strategy>=Ig||n.level<2?4:0),Ct(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(Ct(n,n.gzhead.extra.length&255),Ct(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=Ko(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=nT):(Ct(n,0),Ct(n,0),Ct(n,0),Ct(n,0),Ct(n,0),Ct(n,n.level===9?2:n.strategy>=Ig||n.level<2?4:0),Ct(n,I6e),n.status=wl);else{var o=Zb+(n.w_bits-8<<4)<<8,a=-1;n.strategy>=Ig||n.level<2?a=0:n.level<6?a=1:n.level===6?a=2:a=3,o|=a<<6,n.strstart!==0&&(o|=R6e),o+=31-o%31,n.status=wl,Yh(n,o),n.strstart!==0&&(Yh(n,t.adler>>>16),Yh(n,t.adler&65535)),t.adler=1}if(n.status===nT)if(n.gzhead.extra){for(s=n.pending;n.gzindex<(n.gzhead.extra.length&65535)&&!(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(t.adler=Ko(t.adler,n.pending_buf,n.pending-s,s)),Yo(t),s=n.pending,n.pending===n.pending_buf_size));)Ct(n,n.gzhead.extra[n.gzindex]&255),n.gzindex++;n.gzhead.hcrc&&n.pending>s&&(t.adler=Ko(t.adler,n.pending_buf,n.pending-s,s)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=g0)}else n.status=g0;if(n.status===g0)if(n.gzhead.name){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(t.adler=Ko(t.adler,n.pending_buf,n.pending-s,s)),Yo(t),s=n.pending,n.pending===n.pending_buf_size)){i=1;break}n.gzindex<n.gzhead.name.length?i=n.gzhead.name.charCodeAt(n.gzindex++)&255:i=0,Ct(n,i)}while(i!==0);n.gzhead.hcrc&&n.pending>s&&(t.adler=Ko(t.adler,n.pending_buf,n.pending-s,s)),i===0&&(n.gzindex=0,n.status=_0)}else n.status=_0;if(n.status===_0)if(n.gzhead.comment){s=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>s&&(t.adler=Ko(t.adler,n.pending_buf,n.pending-s,s)),Yo(t),s=n.pending,n.pending===n.pending_buf_size)){i=1;break}n.gzindex<n.gzhead.comment.length?i=n.gzhead.comment.charCodeAt(n.gzindex++)&255:i=0,Ct(n,i)}while(i!==0);n.gzhead.hcrc&&n.pending>s&&(t.adler=Ko(t.adler,n.pending_buf,n.pending-s,s)),i===0&&(n.status=y0)}else n.status=y0;if(n.status===y0&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&Yo(t),n.pending+2<=n.pending_buf_size&&(Ct(n,t.adler&255),Ct(n,t.adler>>8&255),t.adler=0,n.status=wl)):n.status=wl),n.pending!==0){if(Yo(t),t.avail_out===0)return n.last_flush=-1,Si}else if(t.avail_in===0&&QN(e)<=QN(r)&&e!==va)return fa(t,y1);if(n.status===fd&&t.avail_in!==0)return fa(t,y1);if(t.avail_in!==0||n.lookahead!==0||e!==uc&&n.status!==fd){var l=n.strategy===Ig?L6e(n,e):n.strategy===g6e?D6e(n,e):Yc[n.level].func(n,e);if((l===Xl||l===vh)&&(n.status=fd),l===br||l===Xl)return t.avail_out===0&&(n.last_flush=-1),Si;if(l===Yp&&(e===h6e?ws._tr_align(n):e!==ZN&&(ws._tr_stored_block(n,0,0,!1),e===d6e&&(ia(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),Yo(t),t.avail_out===0))return n.last_flush=-1,Si}return e!==va?Si:n.wrap<=0?JN:(n.wrap===2?(Ct(n,t.adler&255),Ct(n,t.adler>>8&255),Ct(n,t.adler>>16&255),Ct(n,t.adler>>24&255),Ct(n,t.total_in&255),Ct(n,t.total_in>>8&255),Ct(n,t.total_in>>16&255),Ct(n,t.total_in>>24&255)):(Yh(n,t.adler>>>16),Yh(n,t.adler&65535)),Yo(t),n.wrap>0&&(n.wrap=-n.wrap),n.pending!==0?Si:JN)}function U6e(t){var e;return!t||!t.state?Es:(e=t.state.status,e!==Jb&&e!==nT&&e!==g0&&e!==_0&&e!==y0&&e!==wl&&e!==fd?fa(t,Es):(t.state=null,e===wl?fa(t,f6e):Si))}function $6e(t,e){var r=e.length,n,s,i,o,a,l,c,u;if(!t||!t.state||(n=t.state,o=n.wrap,o===2||o===1&&n.status!==Jb||n.lookahead))return Es;for(o===1&&(t.adler=AG(t.adler,e,r,0)),n.wrap=0,r>=n.w_size&&(o===0&&(ia(n.head),n.strstart=0,n.block_start=0,n.insert=0),u=new un.Buf8(n.w_size),un.arraySet(u,e,r-n.w_size,n.w_size,0),e=u,r=n.w_size),a=t.avail_in,l=t.next_in,c=t.input,t.avail_in=r,t.next_in=0,t.input=e,Zl(n);n.lookahead>=_t;){s=n.strstart,i=n.lookahead-(_t-1);do n.ins_h=(n.ins_h<<n.hash_shift^n.window[s+_t-1])&n.hash_mask,n.prev[s&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=s,s++;while(--i);n.strstart=s,n.lookahead=_t-1,Zl(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=_t-1,n.match_available=0,t.next_in=l,t.input=c,t.avail_in=a,n.wrap=o,Si}Yi.deflateInit=F6e;Yi.deflateInit2=OG;Yi.deflateReset=PG;Yi.deflateResetKeep=IG;Yi.deflateSetHeader=B6e;Yi.deflate=j6e;Yi.deflateEnd=U6e;Yi.deflateSetDictionary=$6e;Yi.deflateInfo="pako deflate (from Nodeca project)";var hc={},Qb=Mo,DG=!0,LG=!0;try{String.fromCharCode.apply(null,[0])}catch{DG=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{LG=!1}var Qf=new Qb.Buf8(256);for(var Uo=0;Uo<256;Uo++)Qf[Uo]=Uo>=252?6:Uo>=248?5:Uo>=240?4:Uo>=224?3:Uo>=192?2:1;Qf[254]=Qf[254]=1;hc.string2buf=function(t){var e,r,n,s,i,o=t.length,a=0;for(s=0;s<o;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Qb.Buf8(a),i=0,s=0;i<a;s++)r=t.charCodeAt(s),(r&64512)===55296&&s+1<o&&(n=t.charCodeAt(s+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),s++)),r<128?e[i++]=r:r<2048?(e[i++]=192|r>>>6,e[i++]=128|r&63):r<65536?(e[i++]=224|r>>>12,e[i++]=128|r>>>6&63,e[i++]=128|r&63):(e[i++]=240|r>>>18,e[i++]=128|r>>>12&63,e[i++]=128|r>>>6&63,e[i++]=128|r&63);return e};function NG(t,e){if(e<65534&&(t.subarray&&LG||!t.subarray&&DG))return String.fromCharCode.apply(null,Qb.shrinkBuf(t,e));for(var r="",n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r}hc.buf2binstring=function(t){return NG(t,t.length)};hc.binstring2buf=function(t){for(var e=new Qb.Buf8(t.length),r=0,n=e.length;r<n;r++)e[r]=t.charCodeAt(r);return e};hc.buf2string=function(t,e){var r,n,s,i,o=e||t.length,a=new Array(o*2);for(n=0,r=0;r<o;){if(s=t[r++],s<128){a[n++]=s;continue}if(i=Qf[s],i>4){a[n++]=65533,r+=i-1;continue}for(s&=i===2?31:i===3?15:7;i>1&&r<o;)s=s<<6|t[r++]&63,i--;if(i>1){a[n++]=65533;continue}s<65536?a[n++]=s:(s-=65536,a[n++]=55296|s>>10&1023,a[n++]=56320|s&1023)}return NG(a,n)};hc.utf8border=function(t,e){var r;for(e=e||t.length,e>t.length&&(e=t.length),r=e-1;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?e:r+Qf[t[r]]>e?r:e};function H6e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var MG=H6e,Hd=Yi,zd=Mo,sT=hc,iT=YA,z6e=MG,BG=Object.prototype.toString,V6e=0,v1=4,mu=0,eM=1,tM=2,G6e=-1,W6e=0,q6e=8;function Jl(t){if(!(this instanceof Jl))return new Jl(t);this.options=zd.assign({level:G6e,method:q6e,chunkSize:16384,windowBits:15,memLevel:8,strategy:W6e,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new z6e,this.strm.avail_out=0;var r=Hd.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==mu)throw new Error(iT[r]);if(e.header&&Hd.deflateSetHeader(this.strm,e.header),e.dictionary){var n;if(typeof e.dictionary=="string"?n=sT.string2buf(e.dictionary):BG.call(e.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(e.dictionary):n=e.dictionary,r=Hd.deflateSetDictionary(this.strm,n),r!==mu)throw new Error(iT[r]);this._dict_set=!0}}Jl.prototype.push=function(t,e){var r=this.strm,n=this.options.chunkSize,s,i;if(this.ended)return!1;i=e===~~e?e:e===!0?v1:V6e,typeof t=="string"?r.input=sT.string2buf(t):BG.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new zd.Buf8(n),r.next_out=0,r.avail_out=n),s=Hd.deflate(r,i),s!==eM&&s!==mu)return this.onEnd(s),this.ended=!0,!1;(r.avail_out===0||r.avail_in===0&&(i===v1||i===tM))&&(this.options.to==="string"?this.onData(sT.buf2binstring(zd.shrinkBuf(r.output,r.next_out))):this.onData(zd.shrinkBuf(r.output,r.next_out)))}while((r.avail_in>0||r.avail_out===0)&&s!==eM);return i===v1?(s=Hd.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===mu):(i===tM&&(this.onEnd(mu),r.avail_out=0),!0)};Jl.prototype.onData=function(t){this.chunks.push(t)};Jl.prototype.onEnd=function(t){t===mu&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=zd.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function XA(t,e){var r=new Jl(e);if(r.push(t,!0),r.err)throw r.msg||iT[r.err];return r.result}function K6e(t,e){return e=e||{},e.raw=!0,XA(t,e)}function Y6e(t,e){return e=e||{},e.gzip=!0,XA(t,e)}qp.Deflate=Jl;qp.deflate=XA;qp.deflateRaw=K6e;qp.gzip=Y6e;var Xp={},Ys={},Pg=30,X6e=12,Z6e=function(e,r){var n,s,i,o,a,l,c,u,h,d,f,g,_,m,p,y,b,v,w,E,S,x,C,A,M;n=e.state,s=e.next_in,A=e.input,i=s+(e.avail_in-5),o=e.next_out,M=e.output,a=o-(r-e.avail_out),l=o+(e.avail_out-257),c=n.dmax,u=n.wsize,h=n.whave,d=n.wnext,f=n.window,g=n.hold,_=n.bits,m=n.lencode,p=n.distcode,y=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;e:do{_<15&&(g+=A[s++]<<_,_+=8,g+=A[s++]<<_,_+=8),v=m[g&y];t:for(;;){if(w=v>>>24,g>>>=w,_-=w,w=v>>>16&255,w===0)M[o++]=v&65535;else if(w&16){E=v&65535,w&=15,w&&(_<w&&(g+=A[s++]<<_,_+=8),E+=g&(1<<w)-1,g>>>=w,_-=w),_<15&&(g+=A[s++]<<_,_+=8,g+=A[s++]<<_,_+=8),v=p[g&b];r:for(;;){if(w=v>>>24,g>>>=w,_-=w,w=v>>>16&255,w&16){if(S=v&65535,w&=15,_<w&&(g+=A[s++]<<_,_+=8,_<w&&(g+=A[s++]<<_,_+=8)),S+=g&(1<<w)-1,S>c){e.msg="invalid distance too far back",n.mode=Pg;break e}if(g>>>=w,_-=w,w=o-a,S>w){if(w=S-w,w>h&&n.sane){e.msg="invalid distance too far back",n.mode=Pg;break e}if(x=0,C=f,d===0){if(x+=u-w,w<E){E-=w;do M[o++]=f[x++];while(--w);x=o-S,C=M}}else if(d<w){if(x+=u+d-w,w-=d,w<E){E-=w;do M[o++]=f[x++];while(--w);if(x=0,d<E){w=d,E-=w;do M[o++]=f[x++];while(--w);x=o-S,C=M}}}else if(x+=d-w,w<E){E-=w;do M[o++]=f[x++];while(--w);x=o-S,C=M}for(;E>2;)M[o++]=C[x++],M[o++]=C[x++],M[o++]=C[x++],E-=3;E&&(M[o++]=C[x++],E>1&&(M[o++]=C[x++]))}else{x=o-S;do M[o++]=M[x++],M[o++]=M[x++],M[o++]=M[x++],E-=3;while(E>2);E&&(M[o++]=M[x++],E>1&&(M[o++]=M[x++]))}}else if(w&64){e.msg="invalid distance code",n.mode=Pg;break e}else{v=p[(v&65535)+(g&(1<<w)-1)];continue r}break}}else if(w&64)if(w&32){n.mode=X6e;break e}else{e.msg="invalid literal/length code",n.mode=Pg;break e}else{v=m[(v&65535)+(g&(1<<w)-1)];continue t}break}}while(s<i&&o<l);E=_>>3,s-=E,_-=E<<3,g&=(1<<_)-1,e.next_in=s,e.next_out=o,e.avail_in=s<i?5+(i-s):5-(s-i),e.avail_out=o<l?257+(l-o):257-(o-l),n.hold=g,n.bits=_},rM=Mo,kc=15,nM=852,sM=592,iM=0,w1=1,oM=2,J6e=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Q6e=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],e4e=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],t4e=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],r4e=function(e,r,n,s,i,o,a,l){var c=l.bits,u=0,h=0,d=0,f=0,g=0,_=0,m=0,p=0,y=0,b=0,v,w,E,S,x,C=null,A=0,M,P=new rM.Buf16(kc+1),D=new rM.Buf16(kc+1),R=null,G=0,ee,q,re;for(u=0;u<=kc;u++)P[u]=0;for(h=0;h<s;h++)P[r[n+h]]++;for(g=c,f=kc;f>=1&&P[f]===0;f--);if(g>f&&(g=f),f===0)return i[o++]=1<<24|64<<16|0,i[o++]=1<<24|64<<16|0,l.bits=1,0;for(d=1;d<f&&P[d]===0;d++);for(g<d&&(g=d),p=1,u=1;u<=kc;u++)if(p<<=1,p-=P[u],p<0)return-1;if(p>0&&(e===iM||f!==1))return-1;for(D[1]=0,u=1;u<kc;u++)D[u+1]=D[u]+P[u];for(h=0;h<s;h++)r[n+h]!==0&&(a[D[r[n+h]]++]=h);if(e===iM?(C=R=a,M=19):e===w1?(C=J6e,A-=257,R=Q6e,G-=257,M=256):(C=e4e,R=t4e,M=-1),b=0,h=0,u=d,x=o,_=g,m=0,E=-1,y=1<<g,S=y-1,e===w1&&y>nM||e===oM&&y>sM)return 1;for(;;){ee=u-m,a[h]<M?(q=0,re=a[h]):a[h]>M?(q=R[G+a[h]],re=C[A+a[h]]):(q=96,re=0),v=1<<u-m,w=1<<_,d=w;do w-=v,i[x+(b>>m)+w]=ee<<24|q<<16|re|0;while(w!==0);for(v=1<<u-1;b&v;)v>>=1;if(v!==0?(b&=v-1,b+=v):b=0,h++,--P[u]===0){if(u===f)break;u=r[n+a[h]]}if(u>g&&(b&S)!==E){for(m===0&&(m=g),x+=d,_=u-m,p=1<<_;_+m<f&&(p-=P[_+m],!(p<=0));)_++,p<<=1;if(y+=1<<_,e===w1&&y>nM||e===oM&&y>sM)return 1;E=b&S,i[E]=g<<24|_<<16|x-o|0}}return b!==0&&(i[x+b]=u-m<<24|64<<16|0),l.bits=g,0},Kn=Mo,oT=CG,oi=kG,n4e=Z6e,Vd=r4e,s4e=0,FG=1,jG=2,aM=4,i4e=5,Og=6,Ql=0,o4e=1,a4e=2,ks=-2,UG=-3,$G=-4,l4e=-5,lM=8,HG=1,cM=2,uM=3,hM=4,dM=5,fM=6,pM=7,mM=8,gM=9,_M=10,my=11,Xi=12,E1=13,yM=14,x1=15,bM=16,vM=17,wM=18,EM=19,Dg=20,Lg=21,xM=22,SM=23,TM=24,CM=25,kM=26,S1=27,AM=28,RM=29,qt=30,zG=31,c4e=32,u4e=852,h4e=592,d4e=15,f4e=d4e;function IM(t){return(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24)}function p4e(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Kn.Buf16(320),this.work=new Kn.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function VG(t){var e;return!t||!t.state?ks:(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=e.wrap&1),e.mode=HG,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Kn.Buf32(u4e),e.distcode=e.distdyn=new Kn.Buf32(h4e),e.sane=1,e.back=-1,Ql)}function GG(t){var e;return!t||!t.state?ks:(e=t.state,e.wsize=0,e.whave=0,e.wnext=0,VG(t))}function WG(t,e){var r,n;return!t||!t.state||(n=t.state,e<0?(r=0,e=-e):(r=(e>>4)+1,e<48&&(e&=15)),e&&(e<8||e>15))?ks:(n.window!==null&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,GG(t))}function qG(t,e){var r,n;return t?(n=new p4e,t.state=n,n.window=null,r=WG(t,e),r!==Ql&&(t.state=null),r):ks}function m4e(t){return qG(t,f4e)}var PM=!0,T1,C1;function g4e(t){if(PM){var e;for(T1=new Kn.Buf32(512),C1=new Kn.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(Vd(FG,t.lens,0,288,T1,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;Vd(jG,t.lens,0,32,C1,0,t.work,{bits:5}),PM=!1}t.lencode=T1,t.lenbits=9,t.distcode=C1,t.distbits=5}function KG(t,e,r,n){var s,i=t.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Kn.Buf8(i.wsize)),n>=i.wsize?(Kn.arraySet(i.window,e,r-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>n&&(s=n),Kn.arraySet(i.window,e,r-n,s,i.wnext),n-=s,n?(Kn.arraySet(i.window,e,r-n,n,0),i.wnext=n,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0}function _4e(t,e){var r,n,s,i,o,a,l,c,u,h,d,f,g,_,m=0,p,y,b,v,w,E,S,x,C=new Kn.Buf8(4),A,M,P=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return ks;r=t.state,r.mode===Xi&&(r.mode=E1),o=t.next_out,s=t.output,l=t.avail_out,i=t.next_in,n=t.input,a=t.avail_in,c=r.hold,u=r.bits,h=a,d=l,x=Ql;e:for(;;)switch(r.mode){case HG:if(r.wrap===0){r.mode=E1;break}for(;u<16;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}if(r.wrap&2&&c===35615){r.check=0,C[0]=c&255,C[1]=c>>>8&255,r.check=oi(r.check,C,2,0),c=0,u=0,r.mode=cM;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((c&255)<<8)+(c>>8))%31){t.msg="incorrect header check",r.mode=qt;break}if((c&15)!==lM){t.msg="unknown compression method",r.mode=qt;break}if(c>>>=4,u-=4,S=(c&15)+8,r.wbits===0)r.wbits=S;else if(S>r.wbits){t.msg="invalid window size",r.mode=qt;break}r.dmax=1<<S,t.adler=r.check=1,r.mode=c&512?_M:Xi,c=0,u=0;break;case cM:for(;u<16;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}if(r.flags=c,(r.flags&255)!==lM){t.msg="unknown compression method",r.mode=qt;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=qt;break}r.head&&(r.head.text=c>>8&1),r.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,r.check=oi(r.check,C,2,0)),c=0,u=0,r.mode=uM;case uM:for(;u<32;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}r.head&&(r.head.time=c),r.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,C[2]=c>>>16&255,C[3]=c>>>24&255,r.check=oi(r.check,C,4,0)),c=0,u=0,r.mode=hM;case hM:for(;u<16;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}r.head&&(r.head.xflags=c&255,r.head.os=c>>8),r.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,r.check=oi(r.check,C,2,0)),c=0,u=0,r.mode=dM;case dM:if(r.flags&1024){for(;u<16;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),r.flags&512&&(C[0]=c&255,C[1]=c>>>8&255,r.check=oi(r.check,C,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=fM;case fM:if(r.flags&1024&&(f=r.length,f>a&&(f=a),f&&(r.head&&(S=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),Kn.arraySet(r.head.extra,n,i,f,S)),r.flags&512&&(r.check=oi(r.check,n,f,i)),a-=f,i+=f,r.length-=f),r.length))break e;r.length=0,r.mode=pM;case pM:if(r.flags&2048){if(a===0)break e;f=0;do S=n[i+f++],r.head&&S&&r.length<65536&&(r.head.name+=String.fromCharCode(S));while(S&&f<a);if(r.flags&512&&(r.check=oi(r.check,n,f,i)),a-=f,i+=f,S)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=mM;case mM:if(r.flags&4096){if(a===0)break e;f=0;do S=n[i+f++],r.head&&S&&r.length<65536&&(r.head.comment+=String.fromCharCode(S));while(S&&f<a);if(r.flags&512&&(r.check=oi(r.check,n,f,i)),a-=f,i+=f,S)break e}else r.head&&(r.head.comment=null);r.mode=gM;case gM:if(r.flags&512){for(;u<16;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}if(c!==(r.check&65535)){t.msg="header crc mismatch",r.mode=qt;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=Xi;break;case _M:for(;u<32;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}t.adler=r.check=IM(c),c=0,u=0,r.mode=my;case my:if(r.havedict===0)return t.next_out=o,t.avail_out=l,t.next_in=i,t.avail_in=a,r.hold=c,r.bits=u,a4e;t.adler=r.check=1,r.mode=Xi;case Xi:if(e===i4e||e===Og)break e;case E1:if(r.last){c>>>=u&7,u-=u&7,r.mode=S1;break}for(;u<3;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}switch(r.last=c&1,c>>>=1,u-=1,c&3){case 0:r.mode=yM;break;case 1:if(g4e(r),r.mode=Dg,e===Og){c>>>=2,u-=2;break e}break;case 2:r.mode=vM;break;case 3:t.msg="invalid block type",r.mode=qt}c>>>=2,u-=2;break;case yM:for(c>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){t.msg="invalid stored block lengths",r.mode=qt;break}if(r.length=c&65535,c=0,u=0,r.mode=x1,e===Og)break e;case x1:r.mode=bM;case bM:if(f=r.length,f){if(f>a&&(f=a),f>l&&(f=l),f===0)break e;Kn.arraySet(s,n,i,f,o),a-=f,i+=f,l-=f,o+=f,r.length-=f;break}r.mode=Xi;break;case vM:for(;u<14;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}if(r.nlen=(c&31)+257,c>>>=5,u-=5,r.ndist=(c&31)+1,c>>>=5,u-=5,r.ncode=(c&15)+4,c>>>=4,u-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=qt;break}r.have=0,r.mode=wM;case wM:for(;r.have<r.ncode;){for(;u<3;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}r.lens[P[r.have++]]=c&7,c>>>=3,u-=3}for(;r.have<19;)r.lens[P[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,A={bits:r.lenbits},x=Vd(s4e,r.lens,0,19,r.lencode,0,r.work,A),r.lenbits=A.bits,x){t.msg="invalid code lengths set",r.mode=qt;break}r.have=0,r.mode=EM;case EM:for(;r.have<r.nlen+r.ndist;){for(;m=r.lencode[c&(1<<r.lenbits)-1],p=m>>>24,y=m>>>16&255,b=m&65535,!(p<=u);){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}if(b<16)c>>>=p,u-=p,r.lens[r.have++]=b;else{if(b===16){for(M=p+2;u<M;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}if(c>>>=p,u-=p,r.have===0){t.msg="invalid bit length repeat",r.mode=qt;break}S=r.lens[r.have-1],f=3+(c&3),c>>>=2,u-=2}else if(b===17){for(M=p+3;u<M;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}c>>>=p,u-=p,S=0,f=3+(c&7),c>>>=3,u-=3}else{for(M=p+7;u<M;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}c>>>=p,u-=p,S=0,f=11+(c&127),c>>>=7,u-=7}if(r.have+f>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=qt;break}for(;f--;)r.lens[r.have++]=S}}if(r.mode===qt)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=qt;break}if(r.lenbits=9,A={bits:r.lenbits},x=Vd(FG,r.lens,0,r.nlen,r.lencode,0,r.work,A),r.lenbits=A.bits,x){t.msg="invalid literal/lengths set",r.mode=qt;break}if(r.distbits=6,r.distcode=r.distdyn,A={bits:r.distbits},x=Vd(jG,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,A),r.distbits=A.bits,x){t.msg="invalid distances set",r.mode=qt;break}if(r.mode=Dg,e===Og)break e;case Dg:r.mode=Lg;case Lg:if(a>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=i,t.avail_in=a,r.hold=c,r.bits=u,n4e(t,d),o=t.next_out,s=t.output,l=t.avail_out,i=t.next_in,n=t.input,a=t.avail_in,c=r.hold,u=r.bits,r.mode===Xi&&(r.back=-1);break}for(r.back=0;m=r.lencode[c&(1<<r.lenbits)-1],p=m>>>24,y=m>>>16&255,b=m&65535,!(p<=u);){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}if(y&&!(y&240)){for(v=p,w=y,E=b;m=r.lencode[E+((c&(1<<v+w)-1)>>v)],p=m>>>24,y=m>>>16&255,b=m&65535,!(v+p<=u);){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}c>>>=v,u-=v,r.back+=v}if(c>>>=p,u-=p,r.back+=p,r.length=b,y===0){r.mode=kM;break}if(y&32){r.back=-1,r.mode=Xi;break}if(y&64){t.msg="invalid literal/length code",r.mode=qt;break}r.extra=y&15,r.mode=xM;case xM:if(r.extra){for(M=r.extra;u<M;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=SM;case SM:for(;m=r.distcode[c&(1<<r.distbits)-1],p=m>>>24,y=m>>>16&255,b=m&65535,!(p<=u);){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}if(!(y&240)){for(v=p,w=y,E=b;m=r.distcode[E+((c&(1<<v+w)-1)>>v)],p=m>>>24,y=m>>>16&255,b=m&65535,!(v+p<=u);){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}c>>>=v,u-=v,r.back+=v}if(c>>>=p,u-=p,r.back+=p,y&64){t.msg="invalid distance code",r.mode=qt;break}r.offset=b,r.extra=y&15,r.mode=TM;case TM:if(r.extra){for(M=r.extra;u<M;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=qt;break}r.mode=CM;case CM:if(l===0)break e;if(f=d-l,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=qt;break}f>r.wnext?(f-=r.wnext,g=r.wsize-f):g=r.wnext-f,f>r.length&&(f=r.length),_=r.window}else _=s,g=o-r.offset,f=r.length;f>l&&(f=l),l-=f,r.length-=f;do s[o++]=_[g++];while(--f);r.length===0&&(r.mode=Lg);break;case kM:if(l===0)break e;s[o++]=r.length,l--,r.mode=Lg;break;case S1:if(r.wrap){for(;u<32;){if(a===0)break e;a--,c|=n[i++]<<u,u+=8}if(d-=l,t.total_out+=d,r.total+=d,d&&(t.adler=r.check=r.flags?oi(r.check,s,d,o-d):oT(r.check,s,d,o-d)),d=l,(r.flags?c:IM(c))!==r.check){t.msg="incorrect data check",r.mode=qt;break}c=0,u=0}r.mode=AM;case AM:if(r.wrap&&r.flags){for(;u<32;){if(a===0)break e;a--,c+=n[i++]<<u,u+=8}if(c!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=qt;break}c=0,u=0}r.mode=RM;case RM:x=o4e;break e;case qt:x=UG;break e;case zG:return $G;case c4e:default:return ks}return t.next_out=o,t.avail_out=l,t.next_in=i,t.avail_in=a,r.hold=c,r.bits=u,(r.wsize||d!==t.avail_out&&r.mode<qt&&(r.mode<S1||e!==aM))&&KG(t,t.output,t.next_out,d-t.avail_out),h-=t.avail_in,d-=t.avail_out,t.total_in+=h,t.total_out+=d,r.total+=d,r.wrap&&d&&(t.adler=r.check=r.flags?oi(r.check,s,d,t.next_out-d):oT(r.check,s,d,t.next_out-d)),t.data_type=r.bits+(r.last?64:0)+(r.mode===Xi?128:0)+(r.mode===Dg||r.mode===x1?256:0),(h===0&&d===0||e===aM)&&x===Ql&&(x=l4e),x}function y4e(t){if(!t||!t.state)return ks;var e=t.state;return e.window&&(e.window=null),t.state=null,Ql}function b4e(t,e){var r;return!t||!t.state||(r=t.state,!(r.wrap&2))?ks:(r.head=e,e.done=!1,Ql)}function v4e(t,e){var r=e.length,n,s,i;return!t||!t.state||(n=t.state,n.wrap!==0&&n.mode!==my)?ks:n.mode===my&&(s=1,s=oT(s,e,r,0),s!==n.check)?UG:(i=KG(t,e,r,r),i?(n.mode=zG,$G):(n.havedict=1,Ql))}Ys.inflateReset=GG;Ys.inflateReset2=WG;Ys.inflateResetKeep=VG;Ys.inflateInit=m4e;Ys.inflateInit2=qG;Ys.inflate=_4e;Ys.inflateEnd=y4e;Ys.inflateGetHeader=b4e;Ys.inflateSetDictionary=v4e;Ys.inflateInfo="pako inflate (from Nodeca project)";var YG={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function w4e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var E4e=w4e,gu=Ys,Gd=Mo,b0=hc,ir=YG,aT=YA,x4e=MG,S4e=E4e,XG=Object.prototype.toString;function ec(t){if(!(this instanceof ec))return new ec(t);this.options=Gd.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,e.windowBits===0&&(e.windowBits=-15)),e.windowBits>=0&&e.windowBits<16&&!(t&&t.windowBits)&&(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&(e.windowBits&15||(e.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new x4e,this.strm.avail_out=0;var r=gu.inflateInit2(this.strm,e.windowBits);if(r!==ir.Z_OK)throw new Error(aT[r]);if(this.header=new S4e,gu.inflateGetHeader(this.strm,this.header),e.dictionary&&(typeof e.dictionary=="string"?e.dictionary=b0.string2buf(e.dictionary):XG.call(e.dictionary)==="[object ArrayBuffer]"&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=gu.inflateSetDictionary(this.strm,e.dictionary),r!==ir.Z_OK)))throw new Error(aT[r])}ec.prototype.push=function(t,e){var r=this.strm,n=this.options.chunkSize,s=this.options.dictionary,i,o,a,l,c,u=!1;if(this.ended)return!1;o=e===~~e?e:e===!0?ir.Z_FINISH:ir.Z_NO_FLUSH,typeof t=="string"?r.input=b0.binstring2buf(t):XG.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new Gd.Buf8(n),r.next_out=0,r.avail_out=n),i=gu.inflate(r,ir.Z_NO_FLUSH),i===ir.Z_NEED_DICT&&s&&(i=gu.inflateSetDictionary(this.strm,s)),i===ir.Z_BUF_ERROR&&u===!0&&(i=ir.Z_OK,u=!1),i!==ir.Z_STREAM_END&&i!==ir.Z_OK)return this.onEnd(i),this.ended=!0,!1;r.next_out&&(r.avail_out===0||i===ir.Z_STREAM_END||r.avail_in===0&&(o===ir.Z_FINISH||o===ir.Z_SYNC_FLUSH))&&(this.options.to==="string"?(a=b0.utf8border(r.output,r.next_out),l=r.next_out-a,c=b0.buf2string(r.output,a),r.next_out=l,r.avail_out=n-l,l&&Gd.arraySet(r.output,r.output,a,l,0),this.onData(c)):this.onData(Gd.shrinkBuf(r.output,r.next_out))),r.avail_in===0&&r.avail_out===0&&(u=!0)}while((r.avail_in>0||r.avail_out===0)&&i!==ir.Z_STREAM_END);return i===ir.Z_STREAM_END&&(o=ir.Z_FINISH),o===ir.Z_FINISH?(i=gu.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===ir.Z_OK):(o===ir.Z_SYNC_FLUSH&&(this.onEnd(ir.Z_OK),r.avail_out=0),!0)};ec.prototype.onData=function(t){this.chunks.push(t)};ec.prototype.onEnd=function(t){t===ir.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Gd.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function ZA(t,e){var r=new ec(e);if(r.push(t,!0),r.err)throw r.msg||aT[r.err];return r.result}function T4e(t,e){return e=e||{},e.raw=!0,ZA(t,e)}Xp.Inflate=ec;Xp.inflate=ZA;Xp.inflateRaw=T4e;Xp.ungzip=ZA;var C4e=Mo.assign,k4e=qp,A4e=Xp,R4e=YG,ZG={};C4e(ZG,k4e,A4e,R4e);var I4e=ZG;const JA=rs(I4e),OM=(t,e)=>function(...r){const n=e.promiseModule;return new n((s,i)=>{e.multiArgs?r.push((...o)=>{e.errorFirst?o[0]?i(o):(o.shift(),s(o)):s(o)}):e.errorFirst?r.push((o,a)=>{o?i(o):s(a)}):r.push(s),t.apply(this,r)})};var P4e=(t,e)=>{e=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},e);const r=typeof t;if(!(t!==null&&(r==="object"||r==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${t===null?"null":r}\``);const n=i=>{const o=a=>typeof a=="string"?i===a:a.test(i);return e.include?e.include.some(o):!e.exclude.some(o)};let s;r==="function"?s=function(...i){return e.excludeMain?t(...i):OM(t,e).apply(this,i)}:s=Object.create(Object.getPrototypeOf(t));for(const i in t){const o=t[i];s[i]=typeof o=="function"&&n(i)?OM(o,e):o}return s};const k1=rs(P4e);var DM={};function LM(t){return Array.isArray(t)?t:[t]}const lT="",NM=" ",A1="\\",O4e=/^\s+$/,D4e=/(?:[^\\]|^)\\$/,L4e=/^\\!/,N4e=/^\\#/,M4e=/\r?\n/g,B4e=/^\.*\/|^\.+$/,R1="/";let JG="node-ignore";typeof Symbol<"u"&&(JG=Symbol.for("node-ignore"));const MM=JG,F4e=(t,e,r)=>Object.defineProperty(t,e,{value:r}),j4e=/([0-z])-([0-z])/g,QG=()=>!1,U4e=t=>t.replace(j4e,(e,r,n)=>r.charCodeAt(0)<=n.charCodeAt(0)?e:lT),$4e=t=>{const{length:e}=t;return t.slice(0,e-e%2)},H4e=[[/^\uFEFF/,()=>lT],[/((?:\\\\)*?)(\\?\s+)$/,(t,e,r)=>e+(r.indexOf("\\")===0?NM:lT)],[/(\\+?)\s/g,(t,e)=>{const{length:r}=e;return e.slice(0,r-r%2)+NM}],[/[\\$.|*+(){^]/g,t=>`\\${t}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(t,e,r)=>e+6<r.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(t,e,r)=>{const n=r.replace(/\\\*/g,"[^\\/]*");return e+n}],[/\\\\\\(?=[$.|*+(){^])/g,()=>A1],[/\\\\/g,()=>A1],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(t,e,r,n,s)=>e===A1?`\\[${r}${$4e(n)}${s}`:s==="]"&&n.length%2===0?`[${U4e(r)}${n}]`:"[]"],[/(?:[^*])$/,t=>/\/$/.test(t)?`${t}$`:`${t}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(t,e)=>`${e?`${e}[^/]+`:"[^/]*"}(?=$|\\/$)`]],BM=Object.create(null),z4e=(t,e)=>{let r=BM[t];return r||(r=H4e.reduce((n,[s,i])=>n.replace(s,i.bind(t)),t),BM[t]=r),e?new RegExp(r,"i"):new RegExp(r)},QA=t=>typeof t=="string",V4e=t=>t&&QA(t)&&!O4e.test(t)&&!D4e.test(t)&&t.indexOf("#")!==0,G4e=t=>t.split(M4e);class W4e{constructor(e,r,n,s){this.origin=e,this.pattern=r,this.negative=n,this.regex=s}}const q4e=(t,e)=>{const r=t;let n=!1;t.indexOf("!")===0&&(n=!0,t=t.substr(1)),t=t.replace(L4e,"!").replace(N4e,"#");const s=z4e(t,e);return new W4e(r,t,n,s)},K4e=(t,e)=>{throw new e(t)},Ro=(t,e,r)=>QA(t)?t?Ro.isNotRelative(t)?r(`path should be a \`path.relative()\`d string, but got "${e}"`,RangeError):!0:r("path must not be empty",TypeError):r(`path must be a string, but got \`${e}\``,TypeError),eW=t=>B4e.test(t);Ro.isNotRelative=eW;Ro.convert=t=>t;class Y4e{constructor({ignorecase:e=!0,ignoreCase:r=e,allowRelativePaths:n=!1}={}){F4e(this,MM,!0),this._rules=[],this._ignoreCase=r,this._allowRelativePaths=n,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(e){if(e&&e[MM]){this._rules=this._rules.concat(e._rules),this._added=!0;return}if(V4e(e)){const r=q4e(e,this._ignoreCase);this._added=!0,this._rules.push(r)}}add(e){return this._added=!1,LM(QA(e)?G4e(e):e).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(e){return this.add(e)}_testOne(e,r){let n=!1,s=!1;return this._rules.forEach(i=>{const{negative:o}=i;if(s===o&&n!==s||o&&!n&&!s&&!r)return;i.regex.test(e)&&(n=!o,s=o)}),{ignored:n,unignored:s}}_test(e,r,n,s){const i=e&&Ro.convert(e);return Ro(i,e,this._allowRelativePaths?QG:K4e),this._t(i,r,n,s)}_t(e,r,n,s){if(e in r)return r[e];if(s||(s=e.split(R1)),s.pop(),!s.length)return r[e]=this._testOne(e,n);const i=this._t(s.join(R1)+R1,r,n,s);return r[e]=i.ignored?i:this._testOne(e,n)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return LM(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}}const gy=t=>new Y4e(t),X4e=t=>Ro(t&&Ro.convert(t),t,QG);gy.isPathValid=X4e;gy.default=gy;var Z4e=gy;if(typeof Dt<"u"&&(DM&&DM.IGNORE_TEST_WIN32||Dt.platform==="win32")){const t=r=>/^\\\\\?\\/.test(r)||/["<>|\u0000-\u001F]+/u.test(r)?r:r.replace(/\\/g,"/");Ro.convert=t;const e=/^[a-z]:\//i;Ro.isNotRelative=r=>e.test(r)||eW(r)}const J4e=rs(Z4e);function Q4e(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function ai(t,e,r){return e=e instanceof RegExp?e:new RegExp(Q4e(e),"g"),t.replace(e,r)}var eFe={clean:function(e){if(typeof e!="string")throw new Error("Expected a string, received: "+e);return e=ai(e,"./","/"),e=ai(e,"..","."),e=ai(e," ","-"),e=ai(e,/^[~^:?*\\\-]/g,""),e=ai(e,/[~^:?*\\]/g,"-"),e=ai(e,/[~^:?*\\\-]$/g,""),e=ai(e,"@{","-"),e=ai(e,/\.$/g,""),e=ai(e,/\/$/g,""),e=ai(e,/\.lock$/g,""),e}},tFe=eFe;const Ii=rs(tFe);var rFe=function(t,e){var r=t,n=e,s=r.length,i=n.length,o=!1,a=null,l=s+1,c=[],u=[],h=[],d="",f=-1,g=0,_=1,m,p,y=function(){s>=i&&(m=r,p=s,r=n,n=m,s=i,i=p,o=!0,l=s+1)},b=function(S,x,C){return{x:S,y:x,k:C}},v=function(S,x){return{elem:S,t:x}},w=function(S,x,C){var A,M,P;for(x>C?A=c[S-1+l]:A=c[S+1+l],P=Math.max(x,C),M=P-S;M<s&&P<i&&r[M]===n[P];)++M,++P;return c[S+l]=u.length,u[u.length]=new b(M,P,A),P},E=function(S){var x,C,A;for(x=C=0,A=S.length-1;A>=0;--A)for(;x<S[A].x||C<S[A].y;)S[A].y-S[A].x>C-x?(o?h[h.length]=new v(n[C],f):h[h.length]=new v(n[C],_),++C):S[A].y-S[A].x<C-x?(o?h[h.length]=new v(r[x],_):h[h.length]=new v(r[x],f),++x):(h[h.length]=new v(r[x],g),d+=r[x],++x,++C)};return y(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return a},getlcs:function(){return d},getses:function(){return h},compose:function(){var S,x,C,A,M,P,D,R;for(S=i-s,x=s+i+3,C={},D=0;D<x;++D)C[D]=-1,c[D]=-1;A=-1;do{for(++A,R=-A;R<=S-1;++R)C[R+l]=w(R,C[R-1+l]+1,C[R+1+l]);for(R=S+A;R>=S+1;--R)C[R+l]=w(R,C[R-1+l]+1,C[R+1+l]);C[S+l]=w(S,C[S-1+l]+1,C[S+1+l])}while(C[S+l]!==i);for(a=S+2*A,M=c[S+l],P=[];M!==-1;)P[P.length]=new b(u[M].x,u[M].y,null),M=u[M].k;E(P)}}},nFe=rFe;function sFe(t,e){var r=new nFe(t,e);r.compose();for(var n=r.getses(),s,i,o=t.length-1,a=e.length-1,l=n.length-1;l>=0;--l)n[l].t===r.SES_COMMON?(i?(i.chain={file1index:o,file2index:a,chain:null},i=i.chain):(s={file1index:o,file2index:a,chain:null},i=s),o--,a--):n[l].t===r.SES_DELETE?o--:n[l].t===r.SES_ADD&&a--;var c={file1index:-1,file2index:-1,chain:null};return i?(i.chain=c,s):c}function FM(t,e){for(var r=[],n=t.length,s=e.length,i=sFe(t,e);i!==null;i=i.chain){var o=n-i.file1index-1,a=s-i.file2index-1;n=i.file1index,s=i.file2index,(o||a)&&r.push({file1:[n+1,o],file2:[s+1,a]})}return r.reverse(),r}function iFe(t,e,r){var n,s=FM(e,t),i=FM(e,r),o=[];function a(D,R){o.push([D.file1[0],R,D.file1[1],D.file2[0],D.file2[1]])}for(n=0;n<s.length;n++)a(s[n],0);for(n=0;n<i.length;n++)a(i[n],2);o.sort(function(D,R){return D[0]-R[0]});var l=[],c=0;function u(D){D>c&&(l.push([1,c,D-c]),c=D)}for(var h=0;h<o.length;h++){for(var d=h,f=o[h],g=f[0],_=g+f[2];h<o.length-1;){var m=o[h+1],p=m[0];if(p>_)break;_=Math.max(_,p+m[2]),h++}if(u(g),d==h)f[4]>0&&l.push([f[1],f[3],f[4]]);else{var y={0:[t.length,-1,e.length,-1],2:[r.length,-1,e.length,-1]};for(n=d;n<=h;n++){f=o[n];var b=f[1],v=y[b],w=f[0],E=w+f[2],S=f[3],x=S+f[4];v[0]=Math.min(S,v[0]),v[1]=Math.max(x,v[1]),v[2]=Math.min(w,v[2]),v[3]=Math.max(E,v[3])}var C=y[0][0]+(g-y[0][2]),A=y[0][1]+(_-y[0][3]),M=y[2][0]+(g-y[2][2]),P=y[2][1]+(_-y[2][3]);l.push([-1,C,A-C,g,_-g,M,P-M])}c=_}return u(e.length),l}function oFe(t,e,r){var n=[],s=[t,e,r],i=iFe(t,e,r),o=[];function a(){o.length&&n.push({ok:o}),o=[]}function l(f){for(var g=0;g<f.length;g++)o.push(f[g])}function c(f){if(f[2]!=f[6])return!0;for(var g=f[1],_=f[5],m=0;m<f[2];m++)if(t[m+g]!=r[m+_])return!0;return!1}for(var u=0;u<i.length;u++){var h=i[u],d=h[0];d==-1?c(h)?(a(),n.push({conflict:{a:t.slice(h[1],h[1]+h[2]),aIndex:h[1],o:e.slice(h[3],h[3]+h[4]),oIndex:h[3],b:r.slice(h[5],h[5]+h[6]),bIndex:h[5]}})):l(s[0].slice(h[1],h[1]+h[2])):l(s[d].slice(h[1],h[1]+h[2]))}return a(),n}var aFe=oFe;const lFe=rs(aFe);class St extends Error{constructor(e){super(e),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(e){const r=new St(e.message);return r.code=e.code,r.data=e.data,r.caller=e.caller,r.stack=e.stack,r}get isIsomorphicGitError(){return!0}}class Zp extends St{constructor(e){super(`Modifying the index is not possible because you have unmerged files: ${e.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=Zp.code,this.data={filepaths:e}}}Zp.code="UnmergedPathsError";class st extends St{constructor(e){super(`An internal error caused this command to fail. Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${e}`),this.code=this.name=st.code,this.data={message:e}}}st.code="InternalError";class wh extends St{constructor(e){super(`The filepath "${e}" contains unsafe character sequences`),this.code=this.name=wh.code,this.data={filepath:e}}}wh.code="UnsafeFilepathError";class Ti{constructor(e){this.buffer=e,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(e){this._start=e}slice(e){const r=this.buffer.slice(this._start,this._start+e);return this._start+=e,r}toString(e,r){const n=this.buffer.toString(e,this._start,this._start+r);return this._start+=r,n}write(e,r,n){const s=this.buffer.write(e,this._start,r,n);return this._start+=r,s}copy(e,r,n){const s=e.copy(this.buffer,this._start,r,n);return this._start+=s,s}readUInt8(){const e=this.buffer.readUInt8(this._start);return this._start+=1,e}writeUInt8(e){const r=this.buffer.writeUInt8(e,this._start);return this._start+=1,r}readUInt16BE(){const e=this.buffer.readUInt16BE(this._start);return this._start+=2,e}writeUInt16BE(e){const r=this.buffer.writeUInt16BE(e,this._start);return this._start+=2,r}readUInt32BE(){const e=this.buffer.readUInt32BE(this._start);return this._start+=4,e}writeUInt32BE(e){const r=this.buffer.writeUInt32BE(e,this._start);return this._start+=4,r}}function ev(t,e){return-(t<e)||+(t>e)}function tW(t,e){return ev(t.path,e.path)}function rW(t){let e=t>0?t>>12:0;e!==4&&e!==8&&e!==10&&e!==14&&(e=8);let r=t&511;return r&73?r=493:r=420,e!==8&&(r=0),(e<<12)+r}const li=2**32;function jM(t,e,r,n){if(t!==void 0&&e!==void 0)return[t,e];r===void 0&&(r=n.valueOf());const s=Math.floor(r/1e3),i=(r-s*1e3)*1e6;return[s,i]}function Uu(t){const[e,r]=jM(t.ctimeSeconds,t.ctimeNanoseconds,t.ctimeMs,t.ctime),[n,s]=jM(t.mtimeSeconds,t.mtimeNanoseconds,t.mtimeMs,t.mtime);return{ctimeSeconds:e%li,ctimeNanoseconds:r%li,mtimeSeconds:n%li,mtimeNanoseconds:s%li,dev:t.dev%li,ino:t.ino%li,mode:rW(t.mode%li),uid:t.uid%li,gid:t.gid%li,size:t.size>-1?t.size%li:0}}function cFe(t){let e="";for(const r of new Uint8Array(t))r<16&&(e+="0"),e+=r.toString(16);return e}let I1=null;async function Io(t){return I1===null&&(I1=await hFe()),I1?nW(t):uFe(t)}function uFe(t){return new cG().update(t).digest("hex")}async function nW(t){const e=await crypto.subtle.digest("SHA-1",t);return cFe(e)}async function hFe(){try{if(await nW(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709")return!0}catch{}return!1}function dFe(t){return{assumeValid:!!(t&32768),extended:!!(t&16384),stage:(t&12288)>>12,nameLength:t&4095}}function fFe(t){const e=t.flags;return e.extended=!1,e.nameLength=Math.min(Ue.from(t.path).length,4095),(e.assumeValid?32768:0)+(e.extended?16384:0)+((e.stage&3)<<12)+(e.nameLength&4095)}class cl{constructor(e,r){this._dirty=!1,this._unmergedPaths=r||new Set,this._entries=e||new Map}_addEntry(e){if(e.flags.stage===0)e.stages=[e],this._entries.set(e.path,e),this._unmergedPaths.delete(e.path);else{let r=this._entries.get(e.path);r||(this._entries.set(e.path,e),r=e),r.stages[e.flags.stage]=e,this._unmergedPaths.add(e.path)}}static async from(e){if(Ue.isBuffer(e))return cl.fromBuffer(e);if(e===null)return new cl(null);throw new st("invalid type passed to GitIndex.from")}static async fromBuffer(e){if(e.length===0)throw new st("Index file is empty (.git/index)");const r=new cl,n=new Ti(e),s=n.toString("utf8",4);if(s!=="DIRC")throw new st(`Invalid dircache magic file number: ${s}`);const i=await Io(e.slice(0,-20)),o=e.slice(-20).toString("hex");if(o!==i)throw new st(`Invalid checksum in GitIndex buffer: expected ${o} but saw ${i}`);const a=n.readUInt32BE();if(a!==2)throw new st(`Unsupported dircache version: ${a}`);const l=n.readUInt32BE();let c=0;for(;!n.eof()&&c<l;){const u={};u.ctimeSeconds=n.readUInt32BE(),u.ctimeNanoseconds=n.readUInt32BE(),u.mtimeSeconds=n.readUInt32BE(),u.mtimeNanoseconds=n.readUInt32BE(),u.dev=n.readUInt32BE(),u.ino=n.readUInt32BE(),u.mode=n.readUInt32BE(),u.uid=n.readUInt32BE(),u.gid=n.readUInt32BE(),u.size=n.readUInt32BE(),u.oid=n.slice(20).toString("hex");const h=n.readUInt16BE();u.flags=dFe(h);const d=e.indexOf(0,n.tell()+1)-n.tell();if(d<1)throw new st(`Got a path length of: ${d}`);if(u.path=n.toString("utf8",d),u.path.includes("..\\")||u.path.includes("../"))throw new wh(u.path);let f=8-(n.tell()-12)%8;for(f===0&&(f=8);f--;){const g=n.readUInt8();if(g!==0)throw new st(`Expected 1-8 null characters but got '${g}' after ${u.path}`);if(n.eof())throw new st("Unexpected end of file")}u.stages=[],r._addEntry(u),c++}return r}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(tW)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(e=>e.stages.length>1?e.stages.filter(r=>r):e)}*[Symbol.iterator](){for(const e of this.entries)yield e}insert({filepath:e,stats:r,oid:n,stage:s=0}){r||(r={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),r=Uu(r);const i=Ue.from(e),o={ctimeSeconds:r.ctimeSeconds,ctimeNanoseconds:r.ctimeNanoseconds,mtimeSeconds:r.mtimeSeconds,mtimeNanoseconds:r.mtimeNanoseconds,dev:r.dev,ino:r.ino,mode:r.mode||33188,uid:r.uid,gid:r.gid,size:r.size,path:e,oid:n,flags:{assumeValid:!1,extended:!1,stage:s,nameLength:i.length<4095?i.length:4095},stages:[]};this._addEntry(o),this._dirty=!0}delete({filepath:e}){if(this._entries.has(e))this._entries.delete(e);else for(const r of this._entries.keys())r.startsWith(e+"/")&&this._entries.delete(r);this._unmergedPaths.has(e)&&this._unmergedPaths.delete(e),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:e}){return this._entries.has(e)}render(){return this.entries.map(e=>`${e.mode.toString(8)} ${e.oid}    ${e.path}`).join(`
`)}static async _entryToBuffer(e){const r=Ue.from(e.path),n=Math.ceil((62+r.length+1)/8)*8,s=Ue.alloc(n),i=new Ti(s),o=Uu(e);return i.writeUInt32BE(o.ctimeSeconds),i.writeUInt32BE(o.ctimeNanoseconds),i.writeUInt32BE(o.mtimeSeconds),i.writeUInt32BE(o.mtimeNanoseconds),i.writeUInt32BE(o.dev),i.writeUInt32BE(o.ino),i.writeUInt32BE(o.mode),i.writeUInt32BE(o.uid),i.writeUInt32BE(o.gid),i.writeUInt32BE(o.size),i.write(e.oid,20,"hex"),i.writeUInt16BE(fFe(e)),i.write(e.path,r.length,"utf8"),s}async toObject(){const e=Ue.alloc(12),r=new Ti(e);r.write("DIRC",4,"utf8"),r.writeUInt32BE(2),r.writeUInt32BE(this.entriesFlat.length);let n=[];for(const a of this.entries)if(n.push(cl._entryToBuffer(a)),a.stages.length>1)for(const l of a.stages)l&&l!==a&&n.push(cl._entryToBuffer(l));n=await Promise.all(n);const s=Ue.concat(n),i=Ue.concat([e,s]),o=await Io(i);return Ue.concat([i,Ue.from(o,"hex")])}}function _y(t,e,r=!0,n=!0){const s=Uu(t),i=Uu(e);return r&&s.mode!==i.mode||s.mtimeSeconds!==i.mtimeSeconds||s.ctimeSeconds!==i.ctimeSeconds||s.uid!==i.uid||s.gid!==i.gid||n&&s.ino!==i.ino||s.size!==i.size}let P1=null;const Ac=Symbol("IndexCache");function pFe(){return{map:new Map,stats:new Map}}async function mFe(t,e,r){const n=await t.lstat(e),s=await t.read(e),i=await cl.from(s);r.map.set(e,i),r.stats.set(e,n)}async function gFe(t,e,r){const n=r.stats.get(e);if(n===void 0)return!0;const s=await t.lstat(e);return n===null||s===null?!1:_y(n,s)}class $r{static async acquire({fs:e,gitdir:r,cache:n,allowUnmerged:s=!0},i){n[Ac]||(n[Ac]=pFe());const o=`${r}/index`;P1===null&&(P1=new fy({maxPending:1/0}));let a,l=[];return await P1.acquire(o,async()=>{await gFe(e,o,n[Ac])&&await mFe(e,o,n[Ac]);const c=n[Ac].map.get(o);if(l=c.unmergedPaths,l.length&&!s)throw new Zp(l);if(a=await i(c),c._dirty){const u=await c.toObject();await e.write(o,u),n[Ac].stats.set(o,await e.lstat(o)),c._dirty=!1}}),a}}function yy(t){const e=Math.max(t.lastIndexOf("/"),t.lastIndexOf("\\"));return e>-1&&(t=t.slice(e+1)),t}function $u(t){const e=Math.max(t.lastIndexOf("/"),t.lastIndexOf("\\"));return e===-1?".":e===0?"/":t.slice(0,e)}function sW(t){const e=new Map,r=function(s){if(!e.has(s)){const i={type:"tree",fullpath:s,basename:yy(s),metadata:{},children:[]};e.set(s,i),i.parent=r($u(s)),i.parent&&i.parent!==i&&i.parent.children.push(i)}return e.get(s)},n=function(s,i){if(!e.has(s)){const o={type:"blob",fullpath:s,basename:yy(s),metadata:i,parent:r($u(s)),children:[]};o.parent&&o.parent.children.push(o),e.set(s,o)}return e.get(s)};r(".");for(const s of t)n(s.path,s);return e}function _Fe(t){switch(t){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new st(`Unexpected GitTree entry mode: ${t.toString(8)}`)}class yFe{constructor({fs:e,gitdir:r,cache:n}){this.treePromise=$r.acquire({fs:e,gitdir:r,cache:n},async function(i){return sW(i.entries)});const s=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(e){const r=e._fullpath,s=(await this.treePromise).get(r);if(!s||s.type==="blob")return null;if(s.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${r}'`);const i=s.children.map(o=>o.fullpath);return i.sort(ev),i}async type(e){return e._type===!1&&await e.stat(),e._type}async mode(e){return e._mode===!1&&await e.stat(),e._mode}async stat(e){if(e._stat===!1){const n=(await this.treePromise).get(e._fullpath);if(!n)throw new Error(`ENOENT: no such file or directory, lstat '${e._fullpath}'`);const s=n.type==="tree"?{}:Uu(n.metadata);e._type=n.type==="tree"?"tree":_Fe(s.mode),e._mode=s.mode,n.type==="tree"?e._stat=void 0:e._stat=s}return e._stat}async content(e){}async oid(e){if(e._oid===!1){const n=(await this.treePromise).get(e._fullpath);e._oid=n.metadata.oid}return e._oid}}const tv=Symbol("GitWalkSymbol");function rv(){const t=Object.create(null);return Object.defineProperty(t,tv,{value:function({fs:e,gitdir:r,cache:n}){return new yFe({fs:e,gitdir:r,cache:n})}}),Object.freeze(t),t}class Vt extends St{constructor(e){super(`Could not find ${e}.`),this.code=this.name=Vt.code,this.data={what:e}}}Vt.code="NotFoundError";class xn extends St{constructor(e,r,n,s){super(`Object ${e} ${s?`at ${s}`:""}was anticipated to be a ${n} but it is a ${r}.`),this.code=this.name=xn.code,this.data={oid:e,actual:r,expected:n,filepath:s}}}xn.code="ObjectTypeError";class Ba extends St{constructor(e){super(`Expected a 40-char hex object id but saw "${e}".`),this.code=this.name=Ba.code,this.data={value:e}}}Ba.code="InvalidOidError";class Jp extends St{constructor(e){super(`Could not find a fetch refspec for remote "${e}". Make sure the config file has an entry like the following:
[remote "${e}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=Jp.code,this.data={remote:e}}}Jp.code="NoRefspecError";class by{constructor(e){if(this.refs=new Map,this.parsedConfig=[],e){let r=null;this.parsedConfig=e.trim().split(`
`).map(n=>{if(/^\s*#/.test(n))return{line:n,comment:!0};const s=n.indexOf(" ");if(n.startsWith("^")){const i=n.slice(1);return this.refs.set(r+"^{}",i),{line:n,ref:r,peeled:i}}else{const i=n.slice(0,s);return r=n.slice(s+1),this.refs.set(r,i),{line:n,ref:r,oid:i}}})}return this}static from(e){return new by(e)}delete(e){this.parsedConfig=this.parsedConfig.filter(r=>r.ref!==e),this.refs.delete(e)}toString(){return this.parsedConfig.map(({line:e})=>e).join(`
`)+`
`}}class vy{constructor({remotePath:e,localPath:r,force:n,matchPrefix:s}){Object.assign(this,{remotePath:e,localPath:r,force:n,matchPrefix:s})}static from(e){const[r,n,s,i,o]=e.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),a=r==="+",l=s==="*";if(l!==(o==="*"))throw new st("Invalid refspec");return new vy({remotePath:n,localPath:i,force:a,matchPrefix:l})}translate(e){if(this.matchPrefix){if(e.startsWith(this.remotePath))return this.localPath+e.replace(this.remotePath,"")}else if(e===this.remotePath)return this.localPath;return null}reverseTranslate(e){if(this.matchPrefix){if(e.startsWith(this.localPath))return this.remotePath+e.replace(this.localPath,"")}else if(e===this.localPath)return this.remotePath;return null}}class e2{constructor(e=[]){this.rules=e}static from(e){const r=[];for(const n of e)r.push(vy.from(n));return new e2(r)}add(e){const r=vy.from(e);this.rules.push(r)}translate(e){const r=[];for(const n of this.rules)for(const s of e){const i=n.translate(s);i&&r.push([s,i])}return r}translateOne(e){let r=null;for(const n of this.rules){const s=n.translate(e);s&&(r=s)}return r}localNamespaces(){return this.rules.filter(e=>e.matchPrefix).map(e=>e.localPath.replace(/\/$/,""))}}function bFe(t,e){const r=t.replace(/\^\{\}$/,""),n=e.replace(/\^\{\}$/,""),s=-(r<n)||+(r>n);return s===0?t.endsWith("^{}")?1:-1:s}const vFe=t=>{t=t.toLowerCase();let e=parseInt(t);return t.endsWith("k")&&(e*=1024),t.endsWith("m")&&(e*=1024*1024),t.endsWith("g")&&(e*=1024*1024*1024),e},Xh=t=>{if(t=t.trim().toLowerCase(),t==="true"||t==="yes"||t==="on")return!0;if(t==="false"||t==="no"||t==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${t}`)},UM={core:{filemode:Xh,bare:Xh,logallrefupdates:Xh,symlinks:Xh,ignorecase:Xh,bigFileThreshold:vFe}},wFe=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,EFe=/^[A-Za-z0-9-.]+$/,xFe=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,SFe=/^[A-Za-z][A-Za-z-]*$/,TFe=/^(.*?)( *[#;].*)$/,CFe=t=>{const e=wFe.exec(t);if(e!=null){const[r,n]=e.slice(1);return[r,n]}return null},kFe=t=>{const e=xFe.exec(t);if(e!=null){const[r,n="true"]=e.slice(1),s=AFe(n),i=RFe(s);return[r,i]}return null},AFe=t=>{const e=TFe.exec(t);if(e==null)return t;const[r,n]=e.slice(1);return $M(r)&&$M(n)?`${r}${n}`:r},$M=t=>(t.match(/(?:^|[^\\])"/g)||[]).length%2!==0,RFe=t=>t.split("").reduce((e,r,n,s)=>{const i=r==='"'&&s[n-1]!=="\\",o=r==="\\"&&s[n+1]==='"';return i||o?e:e+r},""),HM=t=>t!=null?t.toLowerCase():null,cT=(t,e,r)=>[HM(t),e,HM(r)].filter(n=>n!=null).join("."),zM=t=>{const e=t.split("."),r=e.shift(),n=e.pop(),s=e.length?e.join("."):void 0;return{section:r,subsection:s,name:n,path:cT(r,s,n),sectionPath:cT(r,s,null)}},IFe=(t,e)=>t.reduce((r,n,s)=>e(n)?s:r,-1);class t2{constructor(e){let r=null,n=null;this.parsedConfig=e?e.split(`
`).map(s=>{let i=null,o=null;const a=s.trim(),l=CFe(a),c=l!=null;if(c)[r,n]=l;else{const h=kFe(a);h!=null&&([i,o]=h)}const u=cT(r,n,i);return{line:s,isSection:c,section:r,subsection:n,name:i,value:o,path:u}}):[]}static from(e){return new t2(e)}async get(e,r=!1){const n=zM(e).path,s=this.parsedConfig.filter(i=>i.path===n).map(({section:i,name:o,value:a})=>{const l=UM[i]&&UM[i][o];return l?l(a):a});return r?s:s.pop()}async getall(e){return this.get(e,!0)}async getSubsections(e){return this.parsedConfig.filter(r=>r.section===e&&r.isSection).map(r=>r.subsection)}async deleteSection(e,r){this.parsedConfig=this.parsedConfig.filter(n=>!(n.section===e&&n.subsection===r))}async append(e,r){return this.set(e,r,!0)}async set(e,r,n=!1){const{section:s,subsection:i,name:o,path:a,sectionPath:l}=zM(e),c=IFe(this.parsedConfig,u=>u.path===a);if(r==null)c!==-1&&this.parsedConfig.splice(c,1);else if(c!==-1){const u=this.parsedConfig[c],h=Object.assign({},u,{name:o,value:r,modified:!0});n?this.parsedConfig.splice(c+1,0,h):this.parsedConfig[c]=h}else{const u=this.parsedConfig.findIndex(d=>d.path===l),h={section:s,subsection:i,name:o,value:r,modified:!0,path:a};if(EFe.test(s)&&SFe.test(o))if(u>=0)this.parsedConfig.splice(u+1,0,h);else{const d={section:s,subsection:i,modified:!0,path:l};this.parsedConfig.push(d,h)}}}toString(){return this.parsedConfig.map(({line:e,section:r,subsection:n,name:s,value:i,modified:o=!1})=>o?s!=null&&i!=null?typeof i=="string"&&/[#;]/.test(i)?`	${s} = "${i}"`:`	${s} = ${i}`:n!=null?`[${r} "${n}"]`:`[${r}]`:e).join(`
`)}}class ur{static async get({fs:e,gitdir:r}){const n=await e.read(`${r}/config`,{encoding:"utf8"});return t2.from(n)}static async save({fs:e,gitdir:r,config:n}){await e.write(`${r}/config`,n.toString(),{encoding:"utf8"})}}const Ng=t=>[`${t}`,`refs/${t}`,`refs/tags/${t}`,`refs/heads/${t}`,`refs/remotes/${t}`,`refs/remotes/${t}/HEAD`],PFe=["config","description","index","shallow","commondir"];let O1;async function $o(t,e){return O1===void 0&&(O1=new fy),O1.acquire(t,e)}class je{static async updateRemoteRefs({fs:e,gitdir:r,remote:n,refs:s,symrefs:i,tags:o,refspecs:a=void 0,prune:l=!1,pruneTags:c=!1}){for(const m of s.values())if(!m.match(/[0-9a-f]{40}/))throw new Ba(m);const u=await ur.get({fs:e,gitdir:r});if(!a){if(a=await u.getall(`remote.${n}.fetch`),a.length===0)throw new Jp(n);a.unshift(`+HEAD:refs/remotes/${n}/HEAD`)}const h=e2.from(a),d=new Map;if(c){const m=await je.listRefs({fs:e,gitdir:r,filepath:"refs/tags"});await je.deleteRefs({fs:e,gitdir:r,refs:m.map(p=>`refs/tags/${p}`)})}if(o){for(const m of s.keys())if(m.startsWith("refs/tags")&&!m.endsWith("^{}")&&!await je.exists({fs:e,gitdir:r,ref:m})){const p=s.get(m);d.set(m,p)}}const f=h.translate([...s.keys()]);for(const[m,p]of f){const y=s.get(m);d.set(p,y)}const g=h.translate([...i.keys()]);for(const[m,p]of g){const y=i.get(m),b=h.translateOne(y);b&&d.set(p,`ref: ${b}`)}const _=[];if(l){for(const m of h.localNamespaces()){const p=(await je.listRefs({fs:e,gitdir:r,filepath:m})).map(y=>`${m}/${y}`);for(const y of p)d.has(y)||_.push(y)}_.length>0&&await je.deleteRefs({fs:e,gitdir:r,refs:_})}for(const[m,p]of d)await $o(m,async()=>e.write(Pe.join(r,m),`${p.trim()}
`,"utf8"));return{pruned:_}}static async writeRef({fs:e,gitdir:r,ref:n,value:s}){if(!s.match(/[0-9a-f]{40}/))throw new Ba(s);await $o(n,async()=>e.write(Pe.join(r,n),`${s.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:e,gitdir:r,ref:n,value:s}){await $o(n,async()=>e.write(Pe.join(r,n),`ref: ${s.trim()}
`,"utf8"))}static async deleteRef({fs:e,gitdir:r,ref:n}){return je.deleteRefs({fs:e,gitdir:r,refs:[n]})}static async deleteRefs({fs:e,gitdir:r,refs:n}){await Promise.all(n.map(a=>e.rm(Pe.join(r,a))));let s=await $o("packed-refs",async()=>e.read(`${r}/packed-refs`,{encoding:"utf8"}));const i=by.from(s),o=i.refs.size;for(const a of n)i.refs.has(a)&&i.delete(a);i.refs.size<o&&(s=i.toString(),await $o("packed-refs",async()=>e.write(`${r}/packed-refs`,s,{encoding:"utf8"})))}static async resolve({fs:e,gitdir:r,ref:n,depth:s=void 0}){if(s!==void 0&&(s--,s===-1))return n;if(n.startsWith("ref: "))return n=n.slice(5),je.resolve({fs:e,gitdir:r,ref:n,depth:s});if(n.length===40&&/[0-9a-f]{40}/.test(n))return n;const i=await je.packedRefs({fs:e,gitdir:r}),o=Ng(n).filter(a=>!PFe.includes(a));for(const a of o){const l=await $o(a,async()=>await e.read(`${r}/${a}`,{encoding:"utf8"})||i.get(a));if(l)return je.resolve({fs:e,gitdir:r,ref:l.trim(),depth:s})}throw new Vt(n)}static async exists({fs:e,gitdir:r,ref:n}){try{return await je.expand({fs:e,gitdir:r,ref:n}),!0}catch{return!1}}static async expand({fs:e,gitdir:r,ref:n}){if(n.length===40&&/[0-9a-f]{40}/.test(n))return n;const s=await je.packedRefs({fs:e,gitdir:r}),i=Ng(n);for(const o of i)if(await $o(o,async()=>e.exists(`${r}/${o}`))||s.has(o))return o;throw new Vt(n)}static async expandAgainstMap({ref:e,map:r}){const n=Ng(e);for(const s of n)if(await r.has(s))return s;throw new Vt(e)}static resolveAgainstMap({ref:e,fullref:r=e,depth:n=void 0,map:s}){if(n!==void 0&&(n--,n===-1))return{fullref:r,oid:e};if(e.startsWith("ref: "))return e=e.slice(5),je.resolveAgainstMap({ref:e,fullref:r,depth:n,map:s});if(e.length===40&&/[0-9a-f]{40}/.test(e))return{fullref:r,oid:e};const i=Ng(e);for(const o of i){const a=s.get(o);if(a)return je.resolveAgainstMap({ref:a.trim(),fullref:o,depth:n,map:s})}throw new Vt(e)}static async packedRefs({fs:e,gitdir:r}){const n=await $o("packed-refs",async()=>e.read(`${r}/packed-refs`,{encoding:"utf8"}));return by.from(n).refs}static async listRefs({fs:e,gitdir:r,filepath:n}){const s=je.packedRefs({fs:e,gitdir:r});let i=null;try{i=await e.readdirDeep(`${r}/${n}`),i=i.map(o=>o.replace(`${r}/${n}/`,""))}catch{i=[]}for(let o of(await s).keys())o.startsWith(n)&&(o=o.replace(n+"/",""),i.includes(o)||i.push(o));return i.sort(bFe),i}static async listBranches({fs:e,gitdir:r,remote:n}){return n?je.listRefs({fs:e,gitdir:r,filepath:`refs/remotes/${n}`}):je.listRefs({fs:e,gitdir:r,filepath:"refs/heads"})}static async listTags({fs:e,gitdir:r}){return(await je.listRefs({fs:e,gitdir:r,filepath:"refs/tags"})).filter(s=>!s.endsWith("^{}"))}}function OFe(t,e){return ev(VM(t),VM(e))}function VM(t){return t.mode==="040000"?t.path+"/":t.path}function iW(t){switch(t){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new st(`Unexpected GitTree entry mode: ${t}`)}function DFe(t){const e=[];let r=0;for(;r<t.length;){const n=t.indexOf(32,r);if(n===-1)throw new st(`GitTree: Error parsing buffer at byte location ${r}: Could not find the next space character.`);const s=t.indexOf(0,r);if(s===-1)throw new st(`GitTree: Error parsing buffer at byte location ${r}: Could not find the next null character.`);let i=t.slice(r,n).toString("utf8");i==="40000"&&(i="040000");const o=iW(i),a=t.slice(n+1,s).toString("utf8");if(a.includes("\\")||a.includes("/"))throw new wh(a);const l=t.slice(s+1,s+21).toString("hex");r=s+21,e.push({mode:i,path:a,oid:l,type:o})}return e}function LFe(t){if(typeof t=="number"&&(t=t.toString(8)),t.match(/^0?4.*/))return"040000";if(t.match(/^1006.*/))return"100644";if(t.match(/^1007.*/))return"100755";if(t.match(/^120.*/))return"120000";if(t.match(/^160.*/))return"160000";throw new st(`Could not understand file mode: ${t}`)}function NFe(t){return!t.oid&&t.sha&&(t.oid=t.sha),t.mode=LFe(t.mode),t.type||(t.type=iW(t.mode)),t}class Bn{constructor(e){if(Ue.isBuffer(e))this._entries=DFe(e);else if(Array.isArray(e))this._entries=e.map(NFe);else throw new st("invalid type passed to GitTree constructor");this._entries.sort(tW)}static from(e){return new Bn(e)}render(){return this._entries.map(e=>`${e.mode} ${e.type} ${e.oid}    ${e.path}`).join(`
`)}toObject(){const e=[...this._entries];return e.sort(OFe),Ue.concat(e.map(r=>{const n=Ue.from(r.mode.replace(/^0/,"")),s=Ue.from(" "),i=Ue.from(r.path,"utf8"),o=Ue.from([0]),a=Ue.from(r.oid,"hex");return Ue.concat([n,s,i,o,a])}))}entries(){return this._entries}*[Symbol.iterator](){for(const e of this._entries)yield e}}class Eh{static wrap({type:e,object:r}){return Ue.concat([Ue.from(`${e} ${r.byteLength.toString()}\0`),Ue.from(r)])}static unwrap(e){const r=e.indexOf(32),n=e.indexOf(0),s=e.slice(0,r).toString("utf8"),i=e.slice(r+1,n).toString("utf8"),o=e.length-(n+1);if(parseInt(i)!==o)throw new st(`Length mismatch: expected ${i} bytes but got ${o} instead.`);return{type:s,object:Ue.from(e.slice(n+1))}}}async function MFe({fs:t,gitdir:e,oid:r}){const n=`objects/${r.slice(0,2)}/${r.slice(2)}`,s=await t.read(`${e}/${n}`);return s?{object:s,format:"deflated",source:n}:null}function BFe(t,e){const r=new Ti(t),n=GM(r);if(n!==e.byteLength)throw new st(`applyDelta expected source buffer to be ${n} bytes but the provided buffer was ${e.length} bytes`);const s=GM(r);let i;const o=qM(r,e);if(o.byteLength===s)i=o;else{i=Ue.alloc(s);const a=new Ti(i);for(a.copy(o);!r.eof();)a.copy(qM(r,e));const l=a.tell();if(s!==l)throw new st(`applyDelta expected target buffer to be ${s} bytes but the resulting buffer was ${l} bytes`)}return i}function GM(t){let e=0,r=0,n=null;do n=t.readUInt8(),e|=(n&127)<<r,r+=7;while(n&128);return e}function WM(t,e,r){let n=0,s=0;for(;r--;)e&1&&(n|=t.readUInt8()<<s),e>>=1,s+=8;return n}function qM(t,e){const r=t.readUInt8(),n=128,s=15,i=112;if(r&n){const o=WM(t,r&s,4);let a=WM(t,(r&i)>>4,3);return a===0&&(a=65536),e.slice(o,o+a)}else return t.slice(r)}function FFe(t){let e=[t];return{next(){return Promise.resolve({done:e.length===0,value:e.pop()})},return(){return e=[],{}},[Symbol.asyncIterator](){return this}}}function oW(t){return t[Symbol.asyncIterator]?t[Symbol.asyncIterator]():t[Symbol.iterator]?t[Symbol.iterator]():t.next?t:FFe(t)}class aW{constructor(e){if(typeof Ue>"u")throw new Error("Missing Buffer dependency");this.stream=oW(e),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(e){if(!this.eof())return this.started||await this._init(),this.cursor+e>this.buffer.length&&(this._trim(),await this._accumulate(e)),this._moveCursor(e),this.buffer.slice(this.undoCursor,this.cursor)}async skip(e){this.eof()||(this.started||await this._init(),this.cursor+e>this.buffer.length&&(this._trim(),await this._accumulate(e)),this._moveCursor(e))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:e,value:r}=await this.stream.next();return e&&(this._ended=!0,!r)?Ue.alloc(0):(r&&(r=Ue.from(r)),r)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(e){this.undoCursor=this.cursor,this.cursor+=e,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(e){if(this._ended)return;const r=[this.buffer];for(;this.cursor+e>jFe(r);){const n=await this._next();if(this._ended)break;r.push(n)}this.buffer=Ue.concat(r)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function jFe(t){return t.reduce((e,r)=>e+r.length,0)}async function UFe(t,e){const r=new aW(t);let n=await r.read(4);if(n=n.toString("utf8"),n!=="PACK")throw new st(`Invalid PACK header '${n}'`);let s=await r.read(4);if(s=s.readUInt32BE(0),s!==2)throw new st(`Invalid packfile version: ${s}`);let i=await r.read(4);if(i=i.readUInt32BE(0),!(i<1))for(;!r.eof()&&i--;){const o=r.tell(),{type:a,length:l,ofs:c,reference:u}=await $Fe(r),h=new JA.Inflate;for(;!h.result;){const d=await r.chunk();if(!d)break;if(h.push(d,!1),h.err)throw new st(`Pako error: ${h.msg}`);if(h.result){if(h.result.length!==l)throw new st("Inflated object size is different from that stated in packfile.");await r.undo(),await r.read(d.length-h.strm.avail_in);const f=r.tell();await e({data:h.result,type:a,num:i,offset:o,end:f,reference:u,ofs:c})}}}}async function $Fe(t){let e=await t.byte();const r=e>>4&7;let n=e&15;if(e&128){let o=4;do e=await t.byte(),n|=(e&127)<<o,o+=7;while(e&128)}let s,i;if(r===6){let o=0;s=0;const a=[];do e=await t.byte(),s|=(e&127)<<o,o+=7,a.push(e);while(e&128);i=Ue.from(a)}return r===7&&(i=await t.read(20)),{type:r,length:n,ofs:s,reference:i}}async function lW(t){return JA.inflate(t)}function HFe(t){const e=[];let r=0,n=0;do{r=t.readUInt8();const s=r&127;e.push(s),n=r&128}while(n);return e.reduce((s,i)=>s+1<<7|i,-1)}function zFe(t,e){let r=e,n=4,s=null;do s=t.readUInt8(),r|=(s&127)<<n,n+=7;while(s&128);return r}class Hu{constructor(e){Object.assign(this,e),this.offsetCache={}}static async fromIdx({idx:e,getExternalRefDelta:r}){const n=new Ti(e);if(n.slice(4).toString("hex")!=="ff744f63")return;const i=n.readUInt32BE();if(i!==2)throw new st(`Unable to read version ${i} packfile IDX. (Only version 2 supported)`);if(e.byteLength>2048*1024*1024)throw new st("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");n.seek(n.tell()+4*255);const o=n.readUInt32BE(),a=[];for(let u=0;u<o;u++){const h=n.slice(20).toString("hex");a[u]=h}n.seek(n.tell()+4*o);const l=new Map;for(let u=0;u<o;u++)l.set(a[u],n.readUInt32BE());const c=n.slice(20).toString("hex");return new Hu({hashes:a,crcs:{},offsets:l,packfileSha:c,getExternalRefDelta:r})}static async fromPack({pack:e,getExternalRefDelta:r,onProgress:n}){const s={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},i={},o=e.slice(-20).toString("hex"),a=[],l={},c=new Map;let u=null,h=null;await UFe([e],async({data:m,type:p,reference:y,offset:b,num:v})=>{u===null&&(u=v);const w=Math.floor((u-v)*100/u);w!==h&&n&&await n({phase:"Receiving objects",loaded:u-v,total:u}),h=w,p=s[p],["commit","tree","blob","tag"].includes(p)?i[b]={type:p,offset:b}:p==="ofs-delta"?i[b]={type:p,offset:b}:p==="ref-delta"&&(i[b]={type:p,offset:b})});const d=Object.keys(i).map(Number);for(const[m,p]of d.entries()){const y=m+1===d.length?e.byteLength-20:d[m+1],b=i[p],v=FBe.buf(e.slice(p,y))>>>0;b.end=y,b.crc=v}const f=new Hu({pack:Promise.resolve(e),packfileSha:o,crcs:l,hashes:a,offsets:c,getExternalRefDelta:r});h=null;let g=0;const _=[0,0,0,0,0,0,0,0,0,0,0,0];for(let m in i){m=Number(m);const p=Math.floor(g*100/u);p!==h&&n&&await n({phase:"Resolving deltas",loaded:g,total:u}),g++,h=p;const y=i[m];if(!y.oid)try{f.readDepth=0,f.externalReadDepth=0;const{type:b,object:v}=await f.readSlice({start:m});_[f.readDepth]+=1;const w=await Io(Eh.wrap({type:b,object:v}));y.oid=w,a.push(w),c.set(w,m),l[w]=y.crc}catch{continue}}return a.sort(),f}async toBuffer(){const e=[],r=(c,u)=>{e.push(Ue.from(c,u))};r("ff744f63","hex"),r("00000002","hex");const n=new Ti(Ue.alloc(256*4));for(let c=0;c<256;c++){let u=0;for(const h of this.hashes)parseInt(h.slice(0,2),16)<=c&&u++;n.writeUInt32BE(u)}e.push(n.buffer);for(const c of this.hashes)r(c,"hex");const s=new Ti(Ue.alloc(this.hashes.length*4));for(const c of this.hashes)s.writeUInt32BE(this.crcs[c]);e.push(s.buffer);const i=new Ti(Ue.alloc(this.hashes.length*4));for(const c of this.hashes)i.writeUInt32BE(this.offsets.get(c));e.push(i.buffer),r(this.packfileSha,"hex");const o=Ue.concat(e),a=await Io(o),l=Ue.alloc(20);return l.write(a,"hex"),Ue.concat([o,l])}async load({pack:e}){this.pack=e}async unload(){this.pack=null}async read({oid:e}){if(!this.offsets.get(e)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(e);throw new st(`Could not read object ${e} from packfile`)}const r=this.offsets.get(e);return this.readSlice({start:r})}async readSlice({start:e}){if(this.offsetCache[e])return Object.assign({},this.offsetCache[e]);this.readDepth++;const r={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new st("Tried to read from a GitPackIndex with no packfile loaded into memory");const n=(await this.pack).slice(e),s=new Ti(n),i=s.readUInt8(),o=i&112;let a=r[o];if(a===void 0)throw new st("Unrecognized type: 0b"+o.toString(2));const l=i&15;let c=l;i&128&&(c=zFe(s,l));let h=null,d=null;if(a==="ofs_delta"){const g=HFe(s),_=e-g;({object:h,type:a}=await this.readSlice({start:_}))}if(a==="ref_delta"){const g=s.slice(20).toString("hex");({object:h,type:a}=await this.read({oid:g}))}const f=n.slice(s.tell());if(d=Ue.from(await lW(f)),d.byteLength!==c)throw new st(`Packfile told us object would have length ${c} but it had length ${d.byteLength}`);return h&&(d=Ue.from(BFe(d,h))),this.readDepth>3&&(this.offsetCache[e]={type:a,object:d}),{type:a,format:"content",object:d}}}const Mg=Symbol("PackfileCache");async function VFe({fs:t,filename:e,getExternalRefDelta:r,emitter:n,emitterPrefix:s}){const i=await t.read(e);return Hu.fromIdx({idx:i,getExternalRefDelta:r})}function r2({fs:t,cache:e,filename:r,getExternalRefDelta:n,emitter:s,emitterPrefix:i}){e[Mg]||(e[Mg]=new Map);let o=e[Mg].get(r);return o||(o=VFe({fs:t,filename:r,getExternalRefDelta:n,emitter:s,emitterPrefix:i}),e[Mg].set(r,o)),o}async function GFe({fs:t,cache:e,gitdir:r,oid:n,format:s="content",getExternalRefDelta:i}){let o=await t.readdir(Pe.join(r,"objects/pack"));o=o.filter(a=>a.endsWith(".idx"));for(const a of o){const l=`${r}/objects/pack/${a}`,c=await r2({fs:t,cache:e,filename:l,getExternalRefDelta:i});if(c.error)throw new st(c.error);if(c.offsets.has(n)){if(!c.pack){const h=l.replace(/idx$/,"pack");c.pack=t.read(h)}const u=await c.read({oid:n,getExternalRefDelta:i});return u.format="content",u.source=`objects/pack/${a.replace(/idx$/,"pack")}`,u}}return null}async function tr({fs:t,cache:e,gitdir:r,oid:n,format:s="content"}){const i=u=>tr({fs:t,cache:e,gitdir:r,oid:u});let o;if(n==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(o={format:"wrapped",object:Ue.from("tree 0\0")}),o||(o=await MFe({fs:t,gitdir:r,oid:n})),!o){if(o=await GFe({fs:t,cache:e,gitdir:r,oid:n,getExternalRefDelta:i}),!o)throw new Vt(n);return o}if(s==="deflated"||(o.format==="deflated"&&(o.object=Ue.from(await lW(o.object)),o.format="wrapped"),s==="wrapped"))return o;const a=await Io(o.object);if(a!==n)throw new st(`SHA check failed! Expected ${n}, computed ${a}`);const{object:l,type:c}=Eh.unwrap(o.object);if(o.type=c,o.object=l,o.format="content",s==="content")return o;throw new st(`invalid requested format "${s}"`)}class Xs extends St{constructor(e,r,n=!0){super(`Failed to create ${e} at ${r} because it already exists.${n?` (Hint: use 'force: true' parameter to overwrite existing ${e}.)`:""}`),this.code=this.name=Xs.code,this.data={noun:e,where:r,canForce:n}}}Xs.code="AlreadyExistsError";class Qp extends St{constructor(e,r,n){super(`Found multiple ${e} matching "${r}" (${n.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=Qp.code,this.data={nouns:e,short:r,matches:n}}}Qp.code="AmbiguousError";class em extends St{constructor(e){super(`Your local changes to the following files would be overwritten by checkout: ${e.join(", ")}`),this.code=this.name=em.code,this.data={filepaths:e}}}em.code="CheckoutConflictError";class tm extends St{constructor(e,r){super(`Failed to checkout "${e}" because commit ${r} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=tm.code,this.data={ref:e,oid:r}}}tm.code="CommitNotFetchedError";class rm extends St{constructor(){super("Empty response from git server."),this.code=this.name=rm.code,this.data={}}}rm.code="EmptyServerResponseError";class nm extends St{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=nm.code,this.data={}}}nm.code="FastForwardError";class sm extends St{constructor(e,r){super(`One or more branches were not updated: ${e}`),this.code=this.name=sm.code,this.data={prettyDetails:e,result:r}}}sm.code="GitPushError";class zu extends St{constructor(e,r,n){super(`HTTP Error: ${e} ${r}`),this.code=this.name=zu.code,this.data={statusCode:e,statusMessage:r,response:n}}}zu.code="HttpError";class Fa extends St{constructor(e){let r="invalid filepath";e==="leading-slash"||e==="trailing-slash"?r='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':e==="directory"&&(r='"filepath" should not be a directory.'),super(r),this.code=this.name=Fa.code,this.data={reason:e}}}Fa.code="InvalidFilepathError";class Po extends St{constructor(e,r){super(`"${e}" would be an invalid git reference. (Hint: a valid alternative would be "${r}".)`),this.code=this.name=Po.code,this.data={ref:e,suggestion:r}}}Po.code="InvalidRefNameError";class im extends St{constructor(e){super(`Maximum search depth of ${e} exceeded.`),this.code=this.name=im.code,this.data={depth:e}}}im.code="MaxDepthError";class xh extends St{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=xh.code,this.data={}}}xh.code="MergeNotSupportedError";class Sh extends St{constructor(e,r,n,s){super(`Automatic merge failed with one or more merge conflicts in the following files: ${e.toString()}. Fix conflicts then commit the result.`),this.code=this.name=Sh.code,this.data={filepaths:e,bothModified:r,deleteByUs:n,deleteByTheirs:s}}}Sh.code="MergeConflictError";class yn extends St{constructor(e){super(`No name was provided for ${e} in the argument or in the .git/config file.`),this.code=this.name=yn.code,this.data={role:e}}}yn.code="MissingNameError";class Ln extends St{constructor(e){super(`The function requires a "${e}" parameter but none was provided.`),this.code=this.name=Ln.code,this.data={parameter:e}}}Ln.code="MissingParameterError";class om extends St{constructor(e){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=om.code,this.data={errors:e},this.errors=e}}om.code="MultipleGitError";class dc extends St{constructor(e,r){super(`Expected "${e}" but received "${r}".`),this.code=this.name=dc.code,this.data={expected:e,actual:r}}}dc.code="ParseError";class Vu extends St{constructor(e){let r="";e==="not-fast-forward"?r=" because it was not a simple fast-forward":e==="tag-exists"&&(r=" because tag already exists"),super(`Push rejected${r}. Use "force: true" to override.`),this.code=this.name=Vu.code,this.data={reason:e}}}Vu.code="PushRejectedError";class pa extends St{constructor(e,r){super(`Remote does not support the "${e}" so the "${r}" parameter cannot be used.`),this.code=this.name=pa.code,this.data={capability:e,parameter:r}}}pa.code="RemoteCapabilityError";class am extends St{constructor(e,r){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${e}`),this.code=this.name=am.code,this.data={preview:e,response:r}}}am.code="SmartHttpError";class lm extends St{constructor(e,r,n){super(`Git remote "${e}" uses an unrecognized transport protocol: "${r}"`),this.code=this.name=lm.code,this.data={url:e,transport:r,suggestion:n}}}lm.code="UnknownTransportError";class cm extends St{constructor(e){super(`Cannot parse remote URL: "${e}"`),this.code=this.name=cm.code,this.data={url:e}}}cm.code="UrlParseError";class Th extends St{constructor(){super("The operation was canceled."),this.code=this.name=Th.code,this.data={}}}Th.code="UserCanceledError";class um extends St{constructor(e){super(`Could not merge index: Entry for '${e}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=um.code,this.data={filepath:e}}}um.code="IndexResetError";class hm extends St{constructor(e){super(`"${e}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=hm.code,this.data={ref:e}}}hm.code="NoCommitError";var WFe=Object.freeze({__proto__:null,AlreadyExistsError:Xs,AmbiguousError:Qp,CheckoutConflictError:em,CommitNotFetchedError:tm,EmptyServerResponseError:rm,FastForwardError:nm,GitPushError:sm,HttpError:zu,InternalError:st,InvalidFilepathError:Fa,InvalidOidError:Ba,InvalidRefNameError:Po,MaxDepthError:im,MergeNotSupportedError:xh,MergeConflictError:Sh,MissingNameError:yn,MissingParameterError:Ln,MultipleGitError:om,NoRefspecError:Jp,NotFoundError:Vt,ObjectTypeError:xn,ParseError:dc,PushRejectedError:Vu,RemoteCapabilityError:pa,SmartHttpError:am,UnknownTransportError:lm,UnsafeFilepathError:wh,UrlParseError:cm,UserCanceledError:Th,UnmergedPathsError:Zp,IndexResetError:um,NoCommitError:hm});function uT({name:t,email:e,timestamp:r,timezoneOffset:n}){return n=qFe(n),`${t} <${e}> ${r} ${n}`}function qFe(t){const e=KFe(YFe(t));t=Math.abs(t);const r=Math.floor(t/60);t-=r*60;let n=String(r),s=String(t);return n.length<2&&(n="0"+n),s.length<2&&(s="0"+s),(e===-1?"-":"+")+n+s}function KFe(t){return Math.sign(t)||(Object.is(t,-0)?-1:1)}function YFe(t){return t===0?t:-t}function to(t){return t=t.replace(/\r/g,""),t=t.replace(/^\n+/,""),t=t.replace(/\n+$/,"")+`
`,t}function wy(t){const[,e,r,n,s]=t.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:e,email:r,timestamp:Number(n),timezoneOffset:XFe(s)}}function XFe(t){let[,e,r,n]=t.match(/(\+|-)(\d\d)(\d\d)/);return n=(e==="+"?1:-1)*(Number(r)*60+Number(n)),ZFe(n)}function ZFe(t){return t===0?t:-t}class gn{constructor(e){if(typeof e=="string")this._tag=e;else if(Ue.isBuffer(e))this._tag=e.toString("utf8");else if(typeof e=="object")this._tag=gn.render(e);else throw new st("invalid type passed to GitAnnotatedTag constructor")}static from(e){return new gn(e)}static render(e){return`object ${e.object}
type ${e.type}
tag ${e.tag}
tagger ${uT(e.tagger)}

${e.message}
${e.gpgsig?e.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const e=this.withoutSignature();return e.slice(e.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const e=this.justHeaders().split(`
`),r=[];for(const s of e)s[0]===" "?r[r.length-1]+=`
`+s.slice(1):r.push(s);const n={};for(const s of r){const i=s.slice(0,s.indexOf(" ")),o=s.slice(s.indexOf(" ")+1);Array.isArray(n[i])?n[i].push(o):n[i]=o}return n.tagger&&(n.tagger=wy(n.tagger)),n.committer&&(n.committer=wy(n.committer)),n}withoutSignature(){const e=to(this._tag);return e.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?e:e.slice(0,e.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const e=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return to(e)}payload(){return this.withoutSignature()+`
`}toObject(){return Ue.from(this._tag,"utf8")}static async sign(e,r,n){const s=e.payload();let{signature:i}=await r({payload:s,secretKey:n});i=to(i);const o=s+i;return gn.from(o)}}function D1(t){return t.trim().split(`
`).map(e=>" "+e).join(`
`)+`
`}function JFe(t){return t.split(`
`).map(e=>e.replace(/^ /,"")).join(`
`)}class Yt{constructor(e){if(typeof e=="string")this._commit=e;else if(Ue.isBuffer(e))this._commit=e.toString("utf8");else if(typeof e=="object")this._commit=Yt.render(e);else throw new st("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:e,signature:r}){const n=Yt.justHeaders(e),s=Yt.justMessage(e),i=to(n+`
gpgsig`+D1(r)+`
`+s);return new Yt(i)}static from(e){return new Yt(e)}toObject(){return Ue.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return Yt.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(e){return to(e.slice(e.indexOf(`

`)+2))}static justHeaders(e){return e.slice(0,e.indexOf(`

`))}parseHeaders(){const e=Yt.justHeaders(this._commit).split(`
`),r=[];for(const s of e)s[0]===" "?r[r.length-1]+=`
`+s.slice(1):r.push(s);const n={parent:[]};for(const s of r){const i=s.slice(0,s.indexOf(" ")),o=s.slice(s.indexOf(" ")+1);Array.isArray(n[i])?n[i].push(o):n[i]=o}return n.author&&(n.author=wy(n.author)),n.committer&&(n.committer=wy(n.committer)),n}static renderHeaders(e){let r="";if(e.tree?r+=`tree ${e.tree}
`:r+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,e.parent){if(e.parent.length===void 0)throw new st("commit 'parent' property should be an array");for(const i of e.parent)r+=`parent ${i}
`}const n=e.author;r+=`author ${uT(n)}
`;const s=e.committer||e.author;return r+=`committer ${uT(s)}
`,e.gpgsig&&(r+="gpgsig"+D1(e.gpgsig)),r}static render(e){return Yt.renderHeaders(e)+`
`+to(e.message)}render(){return this._commit}withoutSignature(){const e=to(this._commit);if(e.indexOf(`
gpgsig`)===-1)return e;const r=e.slice(0,e.indexOf(`
gpgsig`)),n=e.slice(e.indexOf(`-----END PGP SIGNATURE-----
`)+28);return to(r+`
`+n)}isolateSignature(){const e=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return JFe(e)}static async sign(e,r,n){const s=e.withoutSignature(),i=Yt.justMessage(e._commit);let{signature:o}=await r({payload:s,secretKey:n});o=to(o);const l=Yt.justHeaders(e._commit)+`
gpgsig`+D1(o)+`
`+i;return Yt.from(l)}}async function Gu({fs:t,cache:e,gitdir:r,oid:n}){if(n==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:Bn.from([]),oid:n};const{type:s,object:i}=await tr({fs:t,cache:e,gitdir:r,oid:n});if(s==="tag")return n=gn.from(i).parse().object,Gu({fs:t,cache:e,gitdir:r,oid:n});if(s==="commit")return n=Yt.from(i).parse().tree,Gu({fs:t,cache:e,gitdir:r,oid:n});if(s!=="tree")throw new xn(n,s,"tree");return{tree:Bn.from(i),oid:n}}class QFe{constructor({fs:e,gitdir:r,ref:n,cache:s}){this.fs=e,this.cache=s,this.gitdir=r,this.mapPromise=(async()=>{const o=new Map;let a;try{a=await je.resolve({fs:e,gitdir:r,ref:n})}catch(c){c instanceof Vt&&(a="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const l=await Gu({fs:e,cache:this.cache,gitdir:r,oid:a});return l.type="tree",l.mode="40000",o.set(".",l),o})();const i=this;this.ConstructEntry=class{constructor(a){this._fullpath=a,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(e){const r=e._fullpath,{fs:n,cache:s,gitdir:i}=this,o=await this.mapPromise,a=o.get(r);if(!a)throw new Error(`No obj for ${r}`);const l=a.oid;if(!l)throw new Error(`No oid for obj ${JSON.stringify(a)}`);if(a.type!=="tree")return null;const{type:c,object:u}=await tr({fs:n,cache:s,gitdir:i,oid:l});if(c!==a.type)throw new xn(l,c,a.type);const h=Bn.from(u);for(const d of h)o.set(Pe.join(r,d.path),d);return h.entries().map(d=>Pe.join(r,d.path))}async type(e){if(e._type===!1){const r=await this.mapPromise,{type:n}=r.get(e._fullpath);e._type=n}return e._type}async mode(e){if(e._mode===!1){const r=await this.mapPromise,{mode:n}=r.get(e._fullpath);e._mode=rW(parseInt(n,8))}return e._mode}async stat(e){}async content(e){if(e._content===!1){const r=await this.mapPromise,{fs:n,cache:s,gitdir:i}=this,a=r.get(e._fullpath).oid,{type:l,object:c}=await tr({fs:n,cache:s,gitdir:i,oid:a});l!=="blob"?e._content=void 0:e._content=new Uint8Array(c)}return e._content}async oid(e){if(e._oid===!1){const n=(await this.mapPromise).get(e._fullpath);e._oid=n.oid}return e._oid}}function ma({ref:t="HEAD"}={}){const e=Object.create(null);return Object.defineProperty(e,tv,{value:function({fs:r,gitdir:n,cache:s}){return new QFe({fs:r,gitdir:n,ref:t,cache:s})}}),Object.freeze(e),e}class e5e{constructor({fs:e,dir:r,gitdir:n,cache:s}){this.fs=e,this.cache=s,this.dir=r,this.gitdir=n;const i=this;this.ConstructEntry=class{constructor(a){this._fullpath=a,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(e){const r=e._fullpath,{fs:n,dir:s}=this,i=await n.readdir(Pe.join(s,r));return i===null?null:i.map(o=>Pe.join(r,o))}async type(e){return e._type===!1&&await e.stat(),e._type}async mode(e){return e._mode===!1&&await e.stat(),e._mode}async stat(e){if(e._stat===!1){const{fs:r,dir:n}=this;let s=await r.lstat(`${n}/${e._fullpath}`);if(!s)throw new Error(`ENOENT: no such file or directory, lstat '${e._fullpath}'`);let i=s.isDirectory()?"tree":"blob";i==="blob"&&!s.isFile()&&!s.isSymbolicLink()&&(i="special"),e._type=i,s=Uu(s),e._mode=s.mode,s.size===-1&&e._actualSize&&(s.size=e._actualSize),e._stat=s}return e._stat}async content(e){if(e._content===!1){const{fs:r,dir:n,gitdir:s}=this;if(await e.type()==="tree")e._content=void 0;else{const o=await(await ur.get({fs:r,gitdir:s})).get("core.autocrlf"),a=await r.read(`${n}/${e._fullpath}`,{autocrlf:o});e._actualSize=a.length,e._stat&&e._stat.size===-1&&(e._stat.size=e._actualSize),e._content=new Uint8Array(a)}}return e._content}async oid(e){if(e._oid===!1){const{fs:r,gitdir:n,cache:s}=this;let i;await $r.acquire({fs:r,gitdir:n,cache:s},async function(o){const a=o.entriesMap.get(e._fullpath),l=await e.stat(),u=await(await ur.get({fs:r,gitdir:n})).get("core.filemode"),h=typeof Dt<"u"?Dt.platform!=="win32":!0;!a||_y(l,a,u,h)?await e.content()===void 0?i=void 0:(i=await Io(Eh.wrap({type:"blob",object:await e.content()})),a&&i===a.oid&&(!u||l.mode===a.mode)&&_y(l,a,u,h)&&o.insert({filepath:e._fullpath,stats:l,oid:i})):i=a.oid}),e._oid=i}return e._oid}}function nv(){const t=Object.create(null);return Object.defineProperty(t,tv,{value:function({fs:e,dir:r,gitdir:n,cache:s}){return new e5e({fs:e,dir:r,gitdir:n,cache:s})}}),Object.freeze(t),t}function t5e(t,e){const r=e-t;return Array.from({length:r},(n,s)=>t+s)}const cW=typeof Array.prototype.flat>"u"?t=>t.reduce((e,r)=>e.concat(r),[]):t=>t.flat();class r5e{constructor(){this.value=null}consider(e){e!=null&&(this.value===null?this.value=e:e<this.value&&(this.value=e))}reset(){this.value=null}}function*n5e(t){const e=new r5e;let r;const n=[],s=t.length;for(let i=0;i<s;i++)n[i]=t[i].next().value,n[i]!==void 0&&e.consider(n[i]);if(e.value!==null)for(;;){const i=[];r=e.value,e.reset();for(let o=0;o<s;o++)n[o]!==void 0&&n[o]===r?(i[o]=n[o],n[o]=t[o].next().value):i[o]=null,n[o]!==void 0&&e.consider(n[o]);if(yield i,e.value===null)return}}async function Wu({fs:t,cache:e,dir:r,gitdir:n,trees:s,map:i=async(l,c)=>c,reduce:o=async(l,c)=>{const u=cW(c);return l!==void 0&&u.unshift(l),u},iterate:a=(l,c)=>Promise.all([...c].map(l))}){const l=s.map(f=>f[tv]({fs:t,dir:r,gitdir:n,cache:e})),c=new Array(l.length).fill("."),u=t5e(0,l.length),h=async f=>{u.map(m=>{f[m]=f[m]&&new l[m].ConstructEntry(f[m])});const _=(await Promise.all(u.map(m=>f[m]?l[m].readdir(f[m]):[]))).map(m=>m===null?[]:m).map(m=>m[Symbol.iterator]());return{entries:f,children:n5e(_)}},d=async f=>{const{entries:g,children:_}=await h(f),m=g.find(y=>y&&y._fullpath)._fullpath,p=await i(m,g);if(p!==null){let y=await a(d,_);return y=y.filter(b=>b!==void 0),o(p,y)}};return d(c)}async function hT(t,e){const r=await t.readdir(e);r==null?await t.rm(e):r.length?await Promise.all(r.map(n=>{const s=Pe.join(e,n);return t.lstat(s).then(i=>{if(i)return i.isDirectory()?hT(t,s):t.rm(s)})})).then(()=>t.rmdir(e)):await t.rmdir(e)}function s5e(t){return i5e(t)&&KM(t.then)&&KM(t.catch)}function i5e(t){return t&&typeof t=="object"}function KM(t){return typeof t=="function"}function YM(t){return s5e((r=>{try{return r.readFile().catch(n=>n)}catch(n){return n}})(t))}const XM=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function ZM(t,e){if(YM(e))for(const r of XM)t[`_${r}`]=e[r].bind(e);else for(const r of XM)t[`_${r}`]=k1(e[r].bind(e));YM(e)?e.rm?t._rm=e.rm.bind(e):e.rmdir.length>1?t._rm=e.rmdir.bind(e):t._rm=hT.bind(null,t):e.rm?t._rm=k1(e.rm.bind(e)):e.rmdir.length>2?t._rm=k1(e.rmdir.bind(e)):t._rm=hT.bind(null,t)}class Xe{constructor(e){if(typeof e._original_unwrapped_fs<"u")return e;const r=Object.getOwnPropertyDescriptor(e,"promises");r&&r.enumerable?ZM(this,e.promises):ZM(this,e),this._original_unwrapped_fs=e}async exists(e,r={}){try{return await this._stat(e),!0}catch(n){if(n.code==="ENOENT"||n.code==="ENOTDIR")return!1;throw console.log('Unhandled error in "FileSystem.exists()" function',n),n}}async read(e,r={}){try{let n=await this._readFile(e,r);if(r.autocrlf==="true")try{n=new TextDecoder("utf8",{fatal:!0}).decode(n),n=n.replace(/\r\n/g,`
`),n=new TextEncoder().encode(n)}catch{}return typeof n!="string"&&(n=Ue.from(n)),n}catch{return null}}async write(e,r,n={}){try{await this._writeFile(e,r,n);return}catch{await this.mkdir($u(e)),await this._writeFile(e,r,n)}}async mkdir(e,r=!1){try{await this._mkdir(e);return}catch(n){if(n===null||n.code==="EEXIST")return;if(r)throw n;if(n.code==="ENOENT"){const s=$u(e);if(s==="."||s==="/"||s===e)throw n;await this.mkdir(s),await this.mkdir(e,!0)}}}async rm(e){try{await this._unlink(e)}catch(r){if(r.code!=="ENOENT")throw r}}async rmdir(e,r){try{r&&r.recursive?await this._rm(e,r):await this._rmdir(e)}catch(n){if(n.code!=="ENOENT")throw n}}async readdir(e){try{const r=await this._readdir(e);return r.sort(ev),r}catch(r){return r.code==="ENOTDIR"?null:[]}}async readdirDeep(e){const r=await this._readdir(e);return(await Promise.all(r.map(async s=>{const i=e+"/"+s;return(await this._stat(i)).isDirectory()?this.readdirDeep(i):i}))).reduce((s,i)=>s.concat(i),[])}async lstat(e){try{return await this._lstat(e)}catch(r){if(r.code==="ENOENT")return null;throw r}}async readlink(e,r={encoding:"buffer"}){try{const n=await this._readlink(e,r);return Ue.isBuffer(n)?n:Ue.from(n)}catch(n){if(n.code==="ENOENT")return null;throw n}}async writelink(e,r){return this._symlink(r.toString("utf8"),e)}}function pe(t,e){if(e===void 0)throw new Ln(t)}async function Ey(t,e){return!t&&!e?!1:t&&!e||!t&&e?!0:!(await t.type()==="tree"&&await e.type()==="tree"||await t.type()===await e.type()&&await t.mode()===await e.mode()&&await t.oid()===await e.oid())}async function o5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),commit:n="HEAD",cache:s={}}){try{pe("fs",t),pe("dir",e),pe("gitdir",r);const i=new Xe(t),o=[ma({ref:n}),nv(),rv()];let a=[];await $r.acquire({fs:i,gitdir:r,cache:s},async function(c){a=c.unmergedPaths});const l=await Wu({fs:i,cache:s,dir:e,gitdir:r,trees:o,map:async function(c,[u,h,d]){const f=!await Ey(h,d),g=a.includes(c),_=!await Ey(d,u);if(f||g)return u?{path:c,mode:await u.mode(),oid:await u.oid(),type:await u.type(),content:await u.content()}:void 0;if(_)return!1;throw new um(c)}});await $r.acquire({fs:i,gitdir:r,cache:s},async function(c){for(const u of l)if(u!==!1){if(!u){await i.rmdir(`${e}/${u.path}`,{recursive:!0}),c.delete({filepath:u.path});continue}if(u.type==="blob"){const h=new TextDecoder().decode(u.content);await i.write(`${e}/${u.path}`,h,{mode:u.mode}),c.insert({filepath:u.path,oid:u.oid,stage:0})}}})}catch(i){throw i.caller="git.abortMerge",i}}class sv{static async isIgnored({fs:e,dir:r,gitdir:n=Pe.join(r,".git"),filepath:s}){if(yy(s)===".git")return!0;if(s===".")return!1;let i="";const o=Pe.join(n,"info","exclude");await e.exists(o)&&(i=await e.read(o,"utf8"));const a=[{gitignore:Pe.join(r,".gitignore"),filepath:s}],l=s.split("/").filter(Boolean);for(let u=1;u<l.length;u++){const h=l.slice(0,u).join("/"),d=l.slice(u).join("/");a.push({gitignore:Pe.join(r,h,".gitignore"),filepath:d})}let c=!1;for(const u of a){let h;try{h=await e.read(u.gitignore,"utf8")}catch(g){if(g.code==="NOENT")continue}const d=J4e().add(i);d.add(h);const f=$u(u.filepath);if(f!=="."&&d.ignores(f))return!0;c?c=!d.test(u.filepath).unignored:c=d.test(u.filepath).ignored}return c}}async function a5e({fs:t,gitdir:e,object:r,format:n,oid:s}){if(n!=="deflated")throw new st("GitObjectStoreLoose expects objects to write to be in deflated format");const i=`objects/${s.slice(0,2)}/${s.slice(2)}`,o=`${e}/${i}`;await t.exists(o)||await t.write(o,r)}let L1=null;async function uW(t){return L1===null&&(L1=c5e()),L1?l5e(t):JA.deflate(t)}async function l5e(t){const e=new CompressionStream("deflate"),r=new Blob([t]).stream().pipeThrough(e);return new Uint8Array(await new Response(r).arrayBuffer())}function c5e(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function is({fs:t,gitdir:e,type:r,object:n,format:s="content",oid:i=void 0,dryRun:o=!1}){return s!=="deflated"&&(s!=="wrapped"&&(n=Eh.wrap({type:r,object:n})),i=await Io(n),n=Ue.from(await uW(n))),o||await a5e({fs:t,gitdir:e,object:n,format:"deflated",oid:i}),i}function u5e(t){let e;for(;~(e=t.indexOf(92));)t[e]=47;return t}async function h5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),filepath:n,cache:s={},force:i=!1,parallel:o=!0}){try{pe("fs",t),pe("dir",e),pe("gitdir",r),pe("filepath",n);const a=new Xe(t);await $r.acquire({fs:a,gitdir:r,cache:s},async l=>dT({dir:e,gitdir:r,fs:a,filepath:n,index:l,force:i,parallel:o}))}catch(a){throw a.caller="git.add",a}}async function dT({dir:t,gitdir:e,fs:r,filepath:n,index:s,force:i,parallel:o}){n=Array.isArray(n)?n:[n];const a=n.map(async h=>{if(!i&&await sv.isIgnored({fs:r,dir:t,gitdir:e,filepath:h}))return;const d=await r.lstat(Pe.join(t,h));if(!d)throw new Vt(h);if(d.isDirectory()){const f=await r.readdir(Pe.join(t,h));if(o){const g=f.map(_=>dT({dir:t,gitdir:e,fs:r,filepath:[Pe.join(h,_)],index:s,force:i,parallel:o}));await Promise.all(g)}else for(const g of f)await dT({dir:t,gitdir:e,fs:r,filepath:[Pe.join(h,g)],index:s,force:i,parallel:o})}else{const g=await(await ur.get({fs:r,gitdir:e})).get("core.autocrlf"),_=d.isSymbolicLink()?await r.readlink(Pe.join(t,h)).then(u5e):await r.read(Pe.join(t,h),{autocrlf:g});if(_===null)throw new Vt(h);const m=await is({fs:r,gitdir:e,type:"blob",object:_});s.insert({filepath:h,stats:d,oid:m})}}),l=await Promise.allSettled(a),c=l.filter(h=>h.status==="rejected").map(h=>h.reason);if(c.length>1)throw new om(c);if(c.length===1)throw c[0];return l.filter(h=>h.status==="fulfilled"&&h.value).map(h=>h.value)}async function ep({fs:t,gitdir:e,path:r}){return(await ur.get({fs:t,gitdir:e})).get(r)}function hW(t,...e){for(const r of e)if(r)for(const n of Object.keys(r)){const s=r[n];s!==void 0&&(t[n]=s)}return t}async function tc({fs:t,gitdir:e,author:r,commit:n}){const s=Math.floor(Date.now()/1e3),i={name:await ep({fs:t,gitdir:e,path:"user.name"}),email:await ep({fs:t,gitdir:e,path:"user.email"})||"",timestamp:s,timezoneOffset:new Date(s*1e3).getTimezoneOffset()},o=hW({},i,n?n.author:void 0,r);if(o.name!==void 0)return o}async function qu({fs:t,gitdir:e,author:r,committer:n,commit:s}){const i=Math.floor(Date.now()/1e3),o={name:await ep({fs:t,gitdir:e,path:"user.name"}),email:await ep({fs:t,gitdir:e,path:"user.email"})||"",timestamp:i,timezoneOffset:new Date(i*1e3).getTimezoneOffset()},a=hW({},o,s?s.committer:void 0,r,n);if(a.name!==void 0)return a}async function dW({fs:t,cache:e,gitdir:r,oid:n}){const{type:s,object:i}=await tr({fs:t,cache:e,gitdir:r,oid:n});if(s==="tag")return n=gn.from(i).parse().object,dW({fs:t,cache:e,gitdir:r,oid:n});if(s!=="commit")throw new xn(n,s,"commit");return{commit:Yt.from(i),oid:n}}async function xy({fs:t,cache:e,gitdir:r,oid:n}){const{commit:s,oid:i}=await dW({fs:t,cache:e,gitdir:r,oid:n});return{oid:i,commit:s.parse(),payload:s.withoutSignature()}}async function iv({fs:t,cache:e,onSign:r,gitdir:n,message:s,author:i,committer:o,signingKey:a,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:h,parent:d,tree:f}){let g=!1;h||(h=await je.resolve({fs:t,gitdir:n,ref:"HEAD",depth:2}));let _,m;try{_=await je.resolve({fs:t,gitdir:n,ref:h}),m=await xy({fs:t,gitdir:n,oid:_,cache:{}})}catch{g=!0}if(l&&g)throw new hm(h);const p=l?await tc({fs:t,gitdir:n,author:i,commit:m.commit}):await tc({fs:t,gitdir:n,author:i});if(!p)throw new yn("author");const y=l?await qu({fs:t,gitdir:n,author:p,committer:o,commit:m.commit}):await qu({fs:t,gitdir:n,author:p,committer:o});if(!y)throw new yn("committer");return $r.acquire({fs:t,gitdir:n,cache:e,allowUnmerged:!1},async function(b){const w=sW(b.entries).get(".");if(f||(f=await fW({fs:t,gitdir:n,inode:w,dryRun:c})),d?d=await Promise.all(d.map(x=>je.resolve({fs:t,gitdir:n,ref:x}))):l?d=m.commit.parent:d=_?[_]:[],!s)if(l)s=m.commit.message;else throw new Ln("message");let E=Yt.from({tree:f,parent:d,author:p,committer:y,message:s});a&&(E=await Yt.sign(E,r,a));const S=await is({fs:t,gitdir:n,type:"commit",object:E.toObject(),dryRun:c});return!u&&!c&&await je.writeRef({fs:t,gitdir:n,ref:h,value:S}),S})}async function fW({fs:t,gitdir:e,inode:r,dryRun:n}){const s=r.children;for(const l of s)l.type==="tree"&&(l.metadata.mode="040000",l.metadata.oid=await fW({fs:t,gitdir:e,inode:l,dryRun:n}));const i=s.map(l=>({mode:l.metadata.mode,path:l.basename,oid:l.metadata.oid,type:l.type})),o=Bn.from(i);return await is({fs:t,gitdir:e,type:"tree",object:o.toObject(),dryRun:n})}async function dm({fs:t,cache:e,gitdir:r,oid:n,filepath:s}){if(s.startsWith("/"))throw new Fa("leading-slash");if(s.endsWith("/"))throw new Fa("trailing-slash");const i=n,o=await Gu({fs:t,cache:e,gitdir:r,oid:n}),a=o.tree;if(s==="")n=o.oid;else{const l=s.split("/");n=await pW({fs:t,cache:e,gitdir:r,tree:a,pathArray:l,oid:i,filepath:s})}return n}async function pW({fs:t,cache:e,gitdir:r,tree:n,pathArray:s,oid:i,filepath:o}){const a=s.shift();for(const l of n)if(l.path===a){if(s.length===0)return l.oid;{const{type:c,object:u}=await tr({fs:t,cache:e,gitdir:r,oid:l.oid});if(c!=="tree")throw new xn(i,c,"tree",o);return n=Bn.from(u),pW({fs:t,cache:e,gitdir:r,tree:n,pathArray:s,oid:i,filepath:o})}}throw new Vt(`file or directory found at "${i}:${o}"`)}async function Ch({fs:t,cache:e,gitdir:r,oid:n,filepath:s=void 0}){s!==void 0&&(n=await dm({fs:t,cache:e,gitdir:r,oid:n,filepath:s}));const{tree:i,oid:o}=await Gu({fs:t,cache:e,gitdir:r,oid:n});return{oid:o,tree:i.entries()}}async function n2({fs:t,gitdir:e,tree:r}){const n=Bn.from(r).toObject();return await is({fs:t,gitdir:e,type:"tree",object:n,format:"content"})}async function d5e({fs:t,cache:e,onSign:r,gitdir:n,ref:s,oid:i,note:o,force:a,author:l,committer:c,signingKey:u}){let h;try{h=await je.resolve({gitdir:n,fs:t,ref:s})}catch(p){if(!(p instanceof Vt))throw p}let f=(await Ch({fs:t,cache:e,gitdir:n,oid:h||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(a)f=f.filter(p=>p.path!==i);else for(const p of f)if(p.path===i)throw new Xs("note",i);typeof o=="string"&&(o=Ue.from(o,"utf8"));const g=await is({fs:t,gitdir:n,type:"blob",object:o,format:"content"});f.push({mode:"100644",path:i,oid:g,type:"blob"});const _=await n2({fs:t,gitdir:n,tree:f});return await iv({fs:t,cache:e,onSign:r,gitdir:n,ref:s,tree:_,parent:h&&[h],message:`Note added by 'isomorphic-git addNote'
`,author:l,committer:c,signingKey:u})}async function f5e({fs:t,onSign:e,dir:r,gitdir:n=Pe.join(r,".git"),ref:s="refs/notes/commits",oid:i,note:o,force:a,author:l,committer:c,signingKey:u,cache:h={}}){try{pe("fs",t),pe("gitdir",n),pe("oid",i),pe("note",o),u&&pe("onSign",e);const d=new Xe(t),f=await tc({fs:d,gitdir:n,author:l});if(!f)throw new yn("author");const g=await qu({fs:d,gitdir:n,author:f,committer:c});if(!g)throw new yn("committer");return await d5e({fs:new Xe(d),cache:h,onSign:e,gitdir:n,ref:s,oid:i,note:o,force:a,author:f,committer:g,signingKey:u})}catch(d){throw d.caller="git.addNote",d}}async function mW({fs:t,gitdir:e,remote:r,url:n,force:s}){if(r!==Ii.clean(r))throw new Po(r,Ii.clean(r));const i=await ur.get({fs:t,gitdir:e});if(!s&&(await i.getSubsections("remote")).includes(r)&&n!==await i.get(`remote.${r}.url`))throw new Xs("remote",r);await i.set(`remote.${r}.url`,n),await i.set(`remote.${r}.fetch`,`+refs/heads/*:refs/remotes/${r}/*`),await ur.save({fs:t,gitdir:e,config:i})}async function p5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),remote:n,url:s,force:i=!1}){try{return pe("fs",t),pe("gitdir",r),pe("remote",n),pe("url",s),await mW({fs:new Xe(t),gitdir:r,remote:n,url:s,force:i})}catch(o){throw o.caller="git.addRemote",o}}async function m5e({fs:t,cache:e,onSign:r,gitdir:n,ref:s,tagger:i,message:o=s,gpgsig:a,object:l,signingKey:c,force:u=!1}){if(s=s.startsWith("refs/tags/")?s:`refs/tags/${s}`,!u&&await je.exists({fs:t,gitdir:n,ref:s}))throw new Xs("tag",s);const h=await je.resolve({fs:t,gitdir:n,ref:l||"HEAD"}),{type:d}=await tr({fs:t,cache:e,gitdir:n,oid:h});let f=gn.from({object:h,type:d,tag:s.replace("refs/tags/",""),tagger:i,message:o,gpgsig:a});c&&(f=await gn.sign(f,r,c));const g=await is({fs:t,gitdir:n,type:"tag",object:f.toObject()});await je.writeRef({fs:t,gitdir:n,ref:s,value:g})}async function g5e({fs:t,onSign:e,dir:r,gitdir:n=Pe.join(r,".git"),ref:s,tagger:i,message:o=s,gpgsig:a,object:l,signingKey:c,force:u=!1,cache:h={}}){try{pe("fs",t),pe("gitdir",n),pe("ref",s),c&&pe("onSign",e);const d=new Xe(t),f=await tc({fs:d,gitdir:n,author:i});if(!f)throw new yn("tagger");return await m5e({fs:d,cache:h,onSign:e,gitdir:n,ref:s,tagger:f,message:o,gpgsig:a,object:l,signingKey:c,force:u})}catch(d){throw d.caller="git.annotatedTag",d}}async function _5e({fs:t,gitdir:e,ref:r,object:n,checkout:s=!1,force:i=!1}){if(r!==Ii.clean(r))throw new Po(r,Ii.clean(r));const o=`refs/heads/${r}`;if(!i&&await je.exists({fs:t,gitdir:e,ref:o}))throw new Xs("branch",r,!1);let a;try{a=await je.resolve({fs:t,gitdir:e,ref:n||"HEAD"})}catch{}a&&await je.writeRef({fs:t,gitdir:e,ref:o,value:a}),s&&await je.writeSymbolicRef({fs:t,gitdir:e,ref:"HEAD",value:o})}async function y5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n,object:s,checkout:i=!1,force:o=!1}){try{return pe("fs",t),pe("gitdir",r),pe("ref",n),await _5e({fs:new Xe(t),gitdir:r,ref:n,object:s,checkout:i,force:o})}catch(a){throw a.caller="git.branch",a}}const gW=(t,e)=>t==="."||e==null||e.length===0||e==="."?!0:e.length>=t.length?e.startsWith(t):t.startsWith(e);async function s2({fs:t,cache:e,onProgress:r,onPostCheckout:n,dir:s,gitdir:i,remote:o,ref:a,filepaths:l,noCheckout:c,noUpdateHead:u,dryRun:h,force:d,track:f=!0}){let g;if(n)try{g=await je.resolve({fs:t,gitdir:i,ref:"HEAD"})}catch{g="0000000000000000000000000000000000000000"}let _;try{_=await je.resolve({fs:t,gitdir:i,ref:a})}catch(m){if(a==="HEAD")throw m;const p=`${o}/${a}`;if(_=await je.resolve({fs:t,gitdir:i,ref:p}),f){const y=await ur.get({fs:t,gitdir:i});await y.set(`branch.${a}.remote`,o),await y.set(`branch.${a}.merge`,`refs/heads/${a}`),await ur.save({fs:t,gitdir:i,config:y})}await je.writeRef({fs:t,gitdir:i,ref:`refs/heads/${a}`,value:_})}if(!c){let m;try{m=await b5e({fs:t,cache:e,onProgress:r,dir:s,gitdir:i,ref:a,force:d,filepaths:l})}catch(w){throw w instanceof Vt&&w.data.what===_?new tm(a,_):w}const p=m.filter(([w])=>w==="conflict").map(([w,E])=>E);if(p.length>0)throw new em(p);const y=m.filter(([w])=>w==="error").map(([w,E])=>E);if(y.length>0)throw new st(y.join(", "));if(h){n&&await n({previousHead:g,newHead:_,type:l!=null&&l.length>0?"file":"branch"});return}let b=0;const v=m.length;await $r.acquire({fs:t,gitdir:i,cache:e},async function(w){await Promise.all(m.filter(([E])=>E==="delete"||E==="delete-index").map(async function([E,S]){const x=`${s}/${S}`;E==="delete"&&await t.rm(x),w.delete({filepath:S}),r&&await r({phase:"Updating workdir",loaded:++b,total:v})}))}),await $r.acquire({fs:t,gitdir:i,cache:e},async function(w){for(const[E,S]of m)if(E==="rmdir"||E==="rmdir-index"){const x=`${s}/${S}`;try{E==="rmdir-index"&&w.delete({filepath:S}),await t.rmdir(x),r&&await r({phase:"Updating workdir",loaded:++b,total:v})}catch(C){if(C.code==="ENOTEMPTY")console.log(`Did not delete ${S} because directory is not empty`);else throw C}}}),await Promise.all(m.filter(([w])=>w==="mkdir"||w==="mkdir-index").map(async function([w,E]){const S=`${s}/${E}`;await t.mkdir(S),r&&await r({phase:"Updating workdir",loaded:++b,total:v})})),await $r.acquire({fs:t,gitdir:i,cache:e},async function(w){await Promise.all(m.filter(([E])=>E==="create"||E==="create-index"||E==="update"||E==="mkdir-index").map(async function([E,S,x,C,A]){const M=`${s}/${S}`;try{if(E!=="create-index"&&E!=="mkdir-index"){const{object:D}=await tr({fs:t,cache:e,gitdir:i,oid:x});if(A&&await t.rm(M),C===33188)await t.write(M,D);else if(C===33261)await t.write(M,D,{mode:511});else if(C===40960)await t.writelink(M,D);else throw new st(`Invalid mode 0o${C.toString(8)} detected in blob ${x}`)}const P=await t.lstat(M);C===33261&&(P.mode=493),E==="mkdir-index"&&(P.mode=57344),w.insert({filepath:S,stats:P,oid:x}),r&&await r({phase:"Updating workdir",loaded:++b,total:v})}catch(P){console.log(P)}}))}),n&&await n({previousHead:g,newHead:_,type:l!=null&&l.length>0?"file":"branch"})}if(!u){const m=await je.expand({fs:t,gitdir:i,ref:a});m.startsWith("refs/heads")?await je.writeSymbolicRef({fs:t,gitdir:i,ref:"HEAD",value:m}):await je.writeRef({fs:t,gitdir:i,ref:"HEAD",value:_})}}async function b5e({fs:t,cache:e,onProgress:r,dir:n,gitdir:s,ref:i,force:o,filepaths:a}){let l=0;return Wu({fs:t,cache:e,dir:n,gitdir:s,trees:[ma({ref:i}),nv(),rv()],map:async function(c,[u,h,d]){if(c===".")return;if(a&&!a.some(g=>gW(c,g)))return null;switch(r&&await r({phase:"Analyzing workdir",loaded:++l}),[!!d,!!u,!!h].map(Number).join("")){case"000":return;case"001":return o&&a&&a.includes(c)?["delete",c]:void 0;case"010":switch(await u.type()){case"tree":return["mkdir",c];case"blob":return["create",c,await u.oid(),await u.mode()];case"commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`new entry Unhandled type ${await u.type()}`]}case"011":switch(`${await u.type()}-${await h.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",c];case"blob-blob":return await u.oid()!==await h.oid()?o?["update",c,await u.oid(),await u.mode(),await u.mode()!==await h.mode()]:["conflict",c]:await u.mode()!==await h.mode()?o?["update",c,await u.oid(),await u.mode(),!0]:["conflict",c]:["create-index",c,await u.oid(),await u.mode()];case"commit-tree":return;case"commit-blob":return["conflict",c];default:return["error",`new entry Unhandled type ${u.type}`]}case"100":return["delete-index",c];case"101":switch(await d.type()){case"tree":return["rmdir",c];case"blob":return await d.oid()!==await h.oid()?o?["delete",c]:["conflict",c]:["delete",c];case"commit":return["rmdir-index",c];default:return["error",`delete entry Unhandled type ${await d.type()}`]}case"110":case"111":switch(`${await d.type()}-${await u.type()}`){case"tree-tree":return;case"blob-blob":{if(await d.oid()===await u.oid()&&await d.mode()===await u.mode()&&!o)return;if(h){if(await h.oid()!==await d.oid()&&await h.oid()!==await u.oid())return o?["update",c,await u.oid(),await u.mode(),await u.mode()!==await h.mode()]:["conflict",c]}else if(o)return["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()];return await u.mode()!==await d.mode()?["update",c,await u.oid(),await u.mode(),!0]:await u.oid()!==await d.oid()?["update",c,await u.oid(),await u.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",c,await u.oid()];case"blob-tree":return["update-blob-to-tree",c];case"commit-commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`update entry Unhandled type ${await d.type()}-${await u.type()}`]}}},reduce:async function(c,u){return u=cW(u),c?c&&c[0]==="rmdir"?(u.push(c),u):(u.unshift(c),u):u}})}async function v5e({fs:t,onProgress:e,onPostCheckout:r,dir:n,gitdir:s=Pe.join(n,".git"),remote:i="origin",ref:o,filepaths:a,noCheckout:l=!1,noUpdateHead:c=o===void 0,dryRun:u=!1,force:h=!1,track:d=!0,cache:f={}}){try{pe("fs",t),pe("dir",n),pe("gitdir",s);const g=o||"HEAD";return await s2({fs:new Xe(t),cache:f,onProgress:e,onPostCheckout:r,dir:n,gitdir:s,remote:i,ref:g,filepaths:a,noCheckout:l,noUpdateHead:c,dryRun:u,force:h,track:d})}catch(g){throw g.caller="git.checkout",g}}const w5e=new RegExp("^refs/(heads/|tags/|remotes/)?(.*)");function El(t){const e=w5e.exec(t);return e?e[1]==="remotes/"&&t.endsWith("/HEAD")?e[2].slice(0,-5):e[2]:t}async function fc({fs:t,gitdir:e,fullname:r=!1,test:n=!1}){const s=await je.resolve({fs:t,gitdir:e,ref:"HEAD",depth:2});if(n)try{await je.resolve({fs:t,gitdir:e,ref:s})}catch{return}if(s.startsWith("refs/"))return r?s:El(s)}function E5e(t){return t=t.replace(/^git@([^:]+):/,"https://$1/"),t=t.replace(/^ssh:\/\//,"https://"),t}function _W({username:t="",password:e=""}){return`Basic ${Ue.from(`${t}:${e}`).toString("base64")}`}async function fm(t,e){const r=oW(t);for(;;){const{value:n,done:s}=await r.next();if(n&&await e(n),s)break}r.return&&r.return()}async function Sy(t){let e=0;const r=[];await fm(t,i=>{r.push(i),e+=i.byteLength});const n=new Uint8Array(e);let s=0;for(const i of r)n.set(i,s),s+=i.byteLength;return n}function JM(t){let e=t.match(/^https?:\/\/([^/]+)@/);if(e==null)return{url:t,auth:{}};e=e[1];const[r,n]=e.split(":");return t=t.replace(`${e}@`,""),{url:t,auth:{username:r,password:n}}}function fT(t,e){const r=e.toString(16);return"0".repeat(t-r.length)+r}class ar{static flush(){return Ue.from("0000","utf8")}static delim(){return Ue.from("0001","utf8")}static encode(e){typeof e=="string"&&(e=Ue.from(e));const r=e.length+4,n=fT(4,r);return Ue.concat([Ue.from(n,"utf8"),e])}static streamReader(e){const r=new aW(e);return async function(){try{let s=await r.read(4);if(s==null)return!0;if(s=parseInt(s.toString("utf8"),16),s===0||s===1)return null;const i=await r.read(s-4);return i??!0}catch(s){return e.error=s,!0}}}}async function QM(t){const e={};let r;for(;r=await t(),r!==!0;){if(r===null)continue;r=r.toString("utf8").replace(/\n$/,"");const n=r.indexOf("=");if(n>-1){const s=r.slice(0,n),i=r.slice(n+1);e[s]=i}else e[r]=!0}return{protocolVersion:2,capabilities2:e}}async function e3(t,{service:e}){const r=new Set,n=new Map,s=new Map,i=ar.streamReader(t);let o=await i();for(;o===null;)o=await i();if(o===!0)throw new rm;if(o.includes("version 2"))return QM(i);if(o.toString("utf8").replace(/\n$/,"")!==`# service=${e}`)throw new dc(`# service=${e}\\n`,o.toString("utf8"));let a=await i();for(;a===null;)a=await i();if(a===!0)return{capabilities:r,refs:n,symrefs:s};if(a=a.toString("utf8"),a.includes("version 2"))return QM(i);const[l,c]=N1(a,"\0","\\x00");if(c.split(" ").map(u=>r.add(u)),l!=="0000000000000000000000000000000000000000 capabilities^{}"){const[u,h]=N1(l," "," ");for(n.set(h,u);;){const d=await i();if(d===!0)break;if(d!==null){const[f,g]=N1(d.toString("utf8")," "," ");n.set(g,f)}}}for(const u of r)if(u.startsWith("symref=")){const h=u.match(/symref=([^:]+):(.*)/);h.length===3&&s.set(h[1],h[2])}return{protocolVersion:1,capabilities:r,refs:n,symrefs:s}}function N1(t,e,r){const n=t.trim().split(e);if(n.length!==2)throw new dc(`Two strings separated by '${r}'`,t.toString("utf8"));return n}const t3=(t,e)=>t.endsWith("?")?`${t}${e}`:`${t}/${e.replace(/^https?:\/\//,"")}`,r3=(t,e)=>{(e.username||e.password)&&(t.Authorization=_W(e)),e.headers&&Object.assign(t,e.headers)},M1=async t=>{try{const e=Ue.from(await Sy(t.body)),r=e.toString("utf8");return{preview:r.length<256?r:r.slice(0,256)+"...",response:r,data:e}}catch{return{}}};class Ty{static async capabilities(){return["discover","connect"]}static async discover({http:e,onProgress:r,onAuth:n,onAuthSuccess:s,onAuthFailure:i,corsProxy:o,service:a,url:l,headers:c,protocolVersion:u}){let{url:h,auth:d}=JM(l);const f=o?t3(o,h):h;(d.username||d.password)&&(c.Authorization=_W(d)),u===2&&(c["Git-Protocol"]="version=2");let g,_,m=!1;do if(g=await e.request({onProgress:r,method:"GET",url:`${f}/info/refs?service=${a}`,headers:c}),_=!1,g.statusCode===401||g.statusCode===203){const p=m?i:n;if(p){if(d=await p(h,{...d,headers:{...c}}),d&&d.cancel)throw new Th;d&&(r3(c,d),m=!0,_=!0)}}else g.statusCode===200&&m&&s&&await s(h,d);while(_);if(g.statusCode!==200){const{response:p}=await M1(g);throw new zu(g.statusCode,g.statusMessage,p)}if(g.headers["content-type"]===`application/x-${a}-advertisement`){const p=await e3(g.body,{service:a});return p.auth=d,p}else{const{preview:p,response:y,data:b}=await M1(g);try{const v=await e3([b],{service:a});return v.auth=d,v}catch{throw new am(p,y)}}}static async connect({http:e,onProgress:r,corsProxy:n,service:s,url:i,auth:o,body:a,headers:l}){const c=JM(i);c&&(i=c.url),n&&(i=t3(n,i)),l["content-type"]=`application/x-${s}-request`,l.accept=`application/x-${s}-result`,r3(l,o);const u=await e.request({onProgress:r,method:"POST",url:`${i}/${s}`,body:a,headers:l});if(u.statusCode!==200){const{response:h}=M1(u);throw new zu(u.statusCode,u.statusMessage,h)}return u}}function x5e({url:t}){if(t.startsWith("git@"))return{transport:"ssh",address:t};const e=t.match(/(\w+)(:\/\/|::)(.*)/);if(e!==null){if(e[2]==="://")return{transport:e[1],address:e[0]};if(e[2]==="::")return{transport:e[1],address:e[3]}}}class ov{static getRemoteHelperFor({url:e}){const r=new Map;r.set("http",Ty),r.set("https",Ty);const n=x5e({url:e});if(!n)throw new cm(e);if(r.has(n.transport))return r.get(n.transport);throw new lm(e,n.transport,n.transport==="ssh"?E5e(e):void 0)}}let Qa=null;class tp{static async read({fs:e,gitdir:r}){Qa===null&&(Qa=new fy);const n=Pe.join(r,"shallow"),s=new Set;return await Qa.acquire(n,async function(){const i=await e.read(n,{encoding:"utf8"});if(i===null||i.trim()==="")return s;i.trim().split(`
`).map(o=>s.add(o))}),s}static async write({fs:e,gitdir:r,oids:n}){Qa===null&&(Qa=new fy);const s=Pe.join(r,"shallow");if(n.size>0){const i=[...n].join(`
`)+`
`;await Qa.acquire(s,async function(){await e.write(s,i,{encoding:"utf8"})})}else await Qa.acquire(s,async function(){await e.rm(s)})}}async function S5e({fs:t,gitdir:e,oid:r}){const n=`objects/${r.slice(0,2)}/${r.slice(2)}`;return t.exists(`${e}/${n}`)}async function T5e({fs:t,cache:e,gitdir:r,oid:n,getExternalRefDelta:s}){let i=await t.readdir(Pe.join(r,"objects/pack"));i=i.filter(o=>o.endsWith(".idx"));for(const o of i){const a=`${r}/objects/pack/${o}`,l=await r2({fs:t,cache:e,filename:a,getExternalRefDelta:s});if(l.error)throw new st(l.error);if(l.offsets.has(n))return!0}return!1}async function n3({fs:t,cache:e,gitdir:r,oid:n,format:s="content"}){const i=a=>tr({fs:t,cache:e,gitdir:r,oid:a});let o=await S5e({fs:t,gitdir:r,oid:n});return o||(o=await T5e({fs:t,cache:e,gitdir:r,oid:n,getExternalRefDelta:i})),o}function C5e(t){const s="5041434b"+"00000002"+"00000000";return t.slice(0,12).toString("hex")===s}function yW(t,e){const r=t.map(n=>n.split("=",1)[0]);return e.filter(n=>{const s=n.split("=",1)[0];return r.includes(s)})}const av={name:"isomorphic-git",version:"1.27.2",agent:"git/isomorphic-git@1.27.2"};class v0{constructor(){this._queue=[]}write(e){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const r=this._waiting;this._waiting=null,r({value:e})}else this._queue.push(e)}end(){if(this._ended=!0,this._waiting){const e=this._waiting;this._waiting=null,e({done:!0})}}destroy(e){this.error=e,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(e=>{this._waiting=e})}}function k5e(t){const e=t.indexOf("\r"),r=t.indexOf(`
`);return e===-1&&r===-1?-1:e===-1?r+1:r===-1?e+1:r===e+1?r+1:Math.min(e,r)+1}function bW(t){const e=new v0;let r="";return(async()=>(await fm(t,n=>{for(n=n.toString("utf8"),r+=n;;){const s=k5e(r);if(s===-1)break;e.write(r.slice(0,s)),r=r.slice(s)}}),r.length>0&&e.write(r),e.end()))(),e}class vW{static demux(e){const r=ar.streamReader(e),n=new v0,s=new v0,i=new v0,o=async function(){const a=await r();if(a===null)return o();if(a===!0){n.end(),i.end(),e.error?s.destroy(e.error):s.end();return}switch(a[0]){case 1:{s.write(a.slice(1));break}case 2:{i.write(a.slice(1));break}case 3:{const l=a.slice(1);i.write(l),n.end(),i.end(),s.destroy(new Error(l.toString("utf8")));return}default:n.write(a)}o()};return o(),{packetlines:n,packfile:s,progress:i}}}async function A5e(t){const{packetlines:e,packfile:r,progress:n}=vW.demux(t),s=[],i=[],o=[];let a=!1,l=!1;return new Promise((c,u)=>{fm(e,h=>{const d=h.toString("utf8").trim();if(d.startsWith("shallow")){const f=d.slice(-41).trim();f.length!==40&&u(new Ba(f)),s.push(f)}else if(d.startsWith("unshallow")){const f=d.slice(-41).trim();f.length!==40&&u(new Ba(f)),i.push(f)}else if(d.startsWith("ACK")){const[,f,g]=d.split(" ");o.push({oid:f,status:g}),g||(l=!0)}else d.startsWith("NAK")?(a=!0,l=!0):(l=!0,a=!0);l&&(t.error?u(t.error):c({shallows:s,unshallows:i,acks:o,nak:a,packfile:r,progress:n}))}).finally(()=>{l||(t.error?u(t.error):c({shallows:s,unshallows:i,acks:o,nak:a,packfile:r,progress:n}))})})}function R5e({capabilities:t=[],wants:e=[],haves:r=[],shallows:n=[],depth:s=null,since:i=null,exclude:o=[]}){const a=[];e=[...new Set(e)];let l=` ${t.join(" ")}`;for(const c of e)a.push(ar.encode(`want ${c}${l}
`)),l="";for(const c of n)a.push(ar.encode(`shallow ${c}
`));s!==null&&a.push(ar.encode(`deepen ${s}
`)),i!==null&&a.push(ar.encode(`deepen-since ${Math.floor(i.valueOf()/1e3)}
`));for(const c of o)a.push(ar.encode(`deepen-not ${c}
`));a.push(ar.flush());for(const c of r)a.push(ar.encode(`have ${c}
`));return a.push(ar.encode(`done
`)),a}async function i2({fs:t,cache:e,http:r,onProgress:n,onMessage:s,onAuth:i,onAuthSuccess:o,onAuthFailure:a,gitdir:l,ref:c,remoteRef:u,remote:h,url:d,corsProxy:f,depth:g=null,since:_=null,exclude:m=[],relative:p=!1,tags:y=!1,singleBranch:b=!1,headers:v={},prune:w=!1,pruneTags:E=!1}){const S=c||await fc({fs:t,gitdir:l,test:!0}),x=await ur.get({fs:t,gitdir:l}),C=h||S&&await x.get(`branch.${S}.remote`)||"origin",A=d||await x.get(`remote.${C}.url`);if(typeof A>"u")throw new Ln("remote OR url");const M=u||S&&await x.get(`branch.${S}.merge`)||c||"HEAD";f===void 0&&(f=await x.get("http.corsProxy"));const P=ov.getRemoteHelperFor({url:A}),D=await P.discover({http:r,onAuth:i,onAuthSuccess:o,onAuthFailure:a,corsProxy:f,service:"git-upload-pack",url:A,headers:v,protocolVersion:1}),R=D.auth,G=D.refs;if(G.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(g!==null&&!D.capabilities.has("shallow"))throw new pa("shallow","depth");if(_!==null&&!D.capabilities.has("deepen-since"))throw new pa("deepen-since","since");if(m.length>0&&!D.capabilities.has("deepen-not"))throw new pa("deepen-not","exclude");if(p===!0&&!D.capabilities.has("deepen-relative"))throw new pa("deepen-relative","relative");const{oid:ee,fullref:q}=je.resolveAgainstMap({ref:M,map:G});for(const me of G.keys())me===q||me==="HEAD"||me.startsWith("refs/heads/")||y&&me.startsWith("refs/tags/")||G.delete(me);const re=yW([...D.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${av.agent}`]);p&&re.push("deepen-relative");const N=b?[ee]:G.values(),B=b?[S]:await je.listRefs({fs:t,gitdir:l,filepath:"refs"});let $=[];for(let me of B)try{me=await je.expand({fs:t,gitdir:l,ref:me});const ve=await je.resolve({fs:t,gitdir:l,ref:me});await n3({fs:t,cache:e,gitdir:l,oid:ve})&&$.push(ve)}catch{}$=[...new Set($)];const H=await tp.read({fs:t,gitdir:l}),U=D.capabilities.has("shallow")?[...H]:[],Q=R5e({capabilities:re,wants:N,haves:$,shallows:U,depth:g,since:_,exclude:m}),ne=Ue.from(await Sy(Q)),ge=await P.connect({http:r,onProgress:n,corsProxy:f,service:"git-upload-pack",url:A,auth:R,body:[ne],headers:v}),J=await A5e(ge.body);ge.headers&&(J.headers=ge.headers);for(const me of J.shallows)if(!H.has(me))try{const{object:ve}=await tr({fs:t,cache:e,gitdir:l,oid:me}),L=new Yt(ve),oe=await Promise.all(L.headers().parent.map(W=>n3({fs:t,cache:e,gitdir:l,oid:W})));oe.length===0||oe.every(W=>W)||H.add(me)}catch{H.add(me)}for(const me of J.unshallows)H.delete(me);if(await tp.write({fs:t,gitdir:l,oids:H}),b){const me=new Map([[q,ee]]),ve=new Map;let L=10,oe=q;for(;L--;){const K=D.symrefs.get(oe);if(K===void 0)break;ve.set(oe,K),oe=K}const ie=G.get(oe);ie&&me.set(oe,ie);const{pruned:W}=await je.updateRemoteRefs({fs:t,gitdir:l,remote:C,refs:me,symrefs:ve,tags:y,prune:w});w&&(J.pruned=W)}else{const{pruned:me}=await je.updateRemoteRefs({fs:t,gitdir:l,remote:C,refs:G,symrefs:D.symrefs,tags:y,prune:w,pruneTags:E});w&&(J.pruned=me)}if(J.HEAD=D.symrefs.get("HEAD"),J.HEAD===void 0){const{oid:me}=je.resolveAgainstMap({ref:"HEAD",map:G});for(const[ve,L]of G.entries())if(ve!=="HEAD"&&L===me){J.HEAD=ve;break}}const V=q.startsWith("refs/tags")?"tag":"branch";if(J.FETCH_HEAD={oid:ee,description:`${V} '${El(q)}' of ${A}`},n||s){const me=bW(J.progress);fm(me,async ve=>{if(s&&await s(ve),n){const L=ve.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);L&&await n({phase:L[1].trim(),loaded:parseInt(L[2],10),total:parseInt(L[3],10)})}})}const fe=Ue.from(await Sy(J.packfile));if(ge.body.error)throw ge.body.error;const de=fe.slice(-20).toString("hex"),be={defaultBranch:J.HEAD,fetchHead:J.FETCH_HEAD.oid,fetchHeadDescription:J.FETCH_HEAD.description};if(J.headers&&(be.headers=J.headers),w&&(be.pruned=J.pruned),de!==""&&!C5e(fe)){be.packfile=`objects/pack/pack-${de}.pack`;const me=Pe.join(l,be.packfile);await t.write(me,fe);const ve=oe=>tr({fs:t,cache:e,gitdir:l,oid:oe}),L=await Hu.fromPack({pack:fe,getExternalRefDelta:ve,onProgress:n});await t.write(me.replace(/\.pack$/,".idx"),await L.toBuffer())}return be}async function wW({fs:t,bare:e=!1,dir:r,gitdir:n=e?r:Pe.join(r,".git"),defaultBranch:s="master"}){if(await t.exists(n+"/config"))return;let i=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];i=i.map(o=>n+"/"+o);for(const o of i)await t.mkdir(o);await t.write(n+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${e}
`+(e?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await t.write(n+"/HEAD",`ref: refs/heads/${s}
`)}async function I5e({fs:t,cache:e,http:r,onProgress:n,onMessage:s,onAuth:i,onAuthSuccess:o,onAuthFailure:a,onPostCheckout:l,dir:c,gitdir:u,url:h,corsProxy:d,ref:f,remote:g,depth:_,since:m,exclude:p,relative:y,singleBranch:b,noCheckout:v,noTags:w,headers:E}){try{if(await wW({fs:t,gitdir:u}),await mW({fs:t,gitdir:u,remote:g,url:h,force:!1}),d){const C=await ur.get({fs:t,gitdir:u});await C.set("http.corsProxy",d),await ur.save({fs:t,gitdir:u,config:C})}const{defaultBranch:S,fetchHead:x}=await i2({fs:t,cache:e,http:r,onProgress:n,onMessage:s,onAuth:i,onAuthSuccess:o,onAuthFailure:a,gitdir:u,ref:f,remote:g,corsProxy:d,depth:_,since:m,exclude:p,relative:y,singleBranch:b,headers:E,tags:!w});if(x===null)return;f=f||S,f=f.replace("refs/heads/",""),await s2({fs:t,cache:e,onProgress:n,onPostCheckout:l,dir:c,gitdir:u,ref:f,remote:g,noCheckout:v})}catch(S){throw await t.rmdir(u,{recursive:!0,maxRetries:10}).catch(()=>{}),S}}async function P5e({fs:t,http:e,onProgress:r,onMessage:n,onAuth:s,onAuthSuccess:i,onAuthFailure:o,onPostCheckout:a,dir:l,gitdir:c=Pe.join(l,".git"),url:u,corsProxy:h=void 0,ref:d=void 0,remote:f="origin",depth:g=void 0,since:_=void 0,exclude:m=[],relative:p=!1,singleBranch:y=!1,noCheckout:b=!1,noTags:v=!1,headers:w={},cache:E={}}){try{return pe("fs",t),pe("http",e),pe("gitdir",c),b||pe("dir",l),pe("url",u),await I5e({fs:new Xe(t),cache:E,http:e,onProgress:r,onMessage:n,onAuth:s,onAuthSuccess:i,onAuthFailure:o,onPostCheckout:a,dir:l,gitdir:c,url:u,corsProxy:h,ref:d,remote:f,depth:g,since:_,exclude:m,relative:p,singleBranch:y,noCheckout:b,noTags:v,headers:w})}catch(S){throw S.caller="git.clone",S}}async function O5e({fs:t,onSign:e,dir:r,gitdir:n=Pe.join(r,".git"),message:s,author:i,committer:o,signingKey:a,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:h,parent:d,tree:f,cache:g={}}){try{pe("fs",t),l||pe("message",s),a&&pe("onSign",e);const _=new Xe(t);return await iv({fs:_,cache:g,onSign:e,gitdir:n,message:s,author:i,committer:o,signingKey:a,amend:l,dryRun:c,noUpdateBranch:u,ref:h,parent:d,tree:f})}catch(_){throw _.caller="git.commit",_}}async function D5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),fullname:n=!1,test:s=!1}){try{return pe("fs",t),pe("gitdir",r),await fc({fs:new Xe(t),gitdir:r,fullname:n,test:s})}catch(i){throw i.caller="git.currentBranch",i}}async function L5e({fs:t,gitdir:e,ref:r}){if(r=r.startsWith("refs/heads/")?r:`refs/heads/${r}`,!await je.exists({fs:t,gitdir:e,ref:r}))throw new Vt(r);const s=await je.expand({fs:t,gitdir:e,ref:r}),i=await fc({fs:t,gitdir:e,fullname:!0});if(s===i){const l=await je.resolve({fs:t,gitdir:e,ref:s});await je.writeRef({fs:t,gitdir:e,ref:"HEAD",value:l})}await je.deleteRef({fs:t,gitdir:e,ref:s});const o=El(r),a=await ur.get({fs:t,gitdir:e});await a.deleteSection("branch",o),await ur.save({fs:t,gitdir:e,config:a})}async function N5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n}){try{return pe("fs",t),pe("ref",n),await L5e({fs:new Xe(t),gitdir:r,ref:n})}catch(s){throw s.caller="git.deleteBranch",s}}async function M5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n}){try{pe("fs",t),pe("ref",n),await je.deleteRef({fs:new Xe(t),gitdir:r,ref:n})}catch(s){throw s.caller="git.deleteRef",s}}async function B5e({fs:t,gitdir:e,remote:r}){const n=await ur.get({fs:t,gitdir:e});await n.deleteSection("remote",r),await ur.save({fs:t,gitdir:e,config:n})}async function F5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),remote:n}){try{return pe("fs",t),pe("remote",n),await B5e({fs:new Xe(t),gitdir:r,remote:n})}catch(s){throw s.caller="git.deleteRemote",s}}async function j5e({fs:t,gitdir:e,ref:r}){r=r.startsWith("refs/tags/")?r:`refs/tags/${r}`,await je.deleteRef({fs:t,gitdir:e,ref:r})}async function U5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n}){try{return pe("fs",t),pe("ref",n),await j5e({fs:new Xe(t),gitdir:r,ref:n})}catch(s){throw s.caller="git.deleteTag",s}}async function $5e({fs:t,gitdir:e,oid:r}){const n=r.slice(0,2);return(await t.readdir(`${e}/objects/${n}`)).map(i=>`${n}${i}`).filter(i=>i.startsWith(r))}async function H5e({fs:t,cache:e,gitdir:r,oid:n,getExternalRefDelta:s}){const i=[];let o=await t.readdir(Pe.join(r,"objects/pack"));o=o.filter(a=>a.endsWith(".idx"));for(const a of o){const l=`${r}/objects/pack/${a}`,c=await r2({fs:t,cache:e,filename:l,getExternalRefDelta:s});if(c.error)throw new st(c.error);for(const u of c.offsets.keys())u.startsWith(n)&&i.push(u)}return i}async function z5e({fs:t,cache:e,gitdir:r,oid:n}){const s=a=>tr({fs:t,cache:e,gitdir:r,oid:a}),i=await $5e({fs:t,gitdir:r,oid:n}),o=await H5e({fs:t,cache:e,gitdir:r,oid:n,getExternalRefDelta:s});for(const a of o)i.indexOf(a)===-1&&i.push(a);if(i.length===1)return i[0];throw i.length>1?new Qp("oids",n,i):new Vt(`an object matching "${n}"`)}async function V5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),oid:n,cache:s={}}){try{return pe("fs",t),pe("gitdir",r),pe("oid",n),await z5e({fs:new Xe(t),cache:s,gitdir:r,oid:n})}catch(i){throw i.caller="git.expandOid",i}}async function G5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n}){try{return pe("fs",t),pe("gitdir",r),pe("ref",n),await je.expand({fs:new Xe(t),gitdir:r,ref:n})}catch(s){throw s.caller="git.expandRef",s}}async function o2({fs:t,cache:e,gitdir:r,oids:n}){const s={},i=n.length;let o=n.map((a,l)=>({index:l,oid:a}));for(;o.length;){const a=new Set;for(const{oid:c,index:u}of o)s[c]||(s[c]=new Set),s[c].add(u),s[c].size===i&&a.add(c);if(a.size>0)return[...a];const l=new Map;for(const{oid:c,index:u}of o)try{const{object:h}=await tr({fs:t,cache:e,gitdir:r,oid:c}),d=Yt.from(h),{parent:f}=d.parseHeaders();for(const g of f)(!s[g]||!s[g].has(u))&&l.set(g+":"+u,{oid:g,index:u})}catch{}o=Array.from(l.values())}return[]}const B1=/^.*(\r?\n|$)/gm;function W5e({branches:t,contents:e}){const r=t[1],n=t[2],s=e[0],i=e[1],o=e[2],a=i.match(B1),l=s.match(B1),c=o.match(B1),u=lFe(a,l,c),h=7;let d="",f=!0;for(const g of u)g.ok&&(d+=g.ok.join("")),g.conflict&&(f=!1,d+=`${"<".repeat(h)} ${r}
`,d+=g.conflict.a.join(""),d+=`${"=".repeat(h)}
`,d+=g.conflict.b.join(""),d+=`${">".repeat(h)} ${n}
`);return{cleanMerge:f,mergedText:d}}async function q5e({fs:t,cache:e,dir:r,gitdir:n=Pe.join(r,".git"),index:s,ourOid:i,baseOid:o,theirOid:a,ourName:l="ours",baseName:c="base",theirName:u="theirs",dryRun:h=!1,abortOnConflict:d=!0,mergeDriver:f}){const g=ma({ref:i}),_=ma({ref:o}),m=ma({ref:a}),p=[],y=[],b=[],v=[],w=await Wu({fs:t,cache:e,dir:r,gitdir:n,trees:[g,_,m],map:async function(E,[S,x,C]){const A=yy(E),M=await Ey(S,x),P=await Ey(C,x);switch(`${M}-${P}`){case"false-false":return{mode:await x.mode(),path:A,oid:await x.oid(),type:await x.type()};case"false-true":return C?{mode:await C.mode(),path:A,oid:await C.oid(),type:await C.type()}:void 0;case"true-false":return S?{mode:await S.mode(),path:A,oid:await S.oid(),type:await S.type()}:void 0;case"true-true":{if(S&&x&&C&&await S.type()==="blob"&&await x.type()==="blob"&&await C.type()==="blob")return K5e({fs:t,gitdir:n,path:A,ours:S,base:x,theirs:C,ourName:l,baseName:c,theirName:u,mergeDriver:f}).then(async D=>{if(D.cleanMerge)d||s.insert({filepath:E,oid:D.mergeResult.oid,stage:0});else if(p.push(E),y.push(E),!d){const R=await x.oid(),G=await S.oid(),ee=await C.oid();s.delete({filepath:E}),s.insert({filepath:E,oid:R,stage:1}),s.insert({filepath:E,oid:G,stage:2}),s.insert({filepath:E,oid:ee,stage:3})}return D.mergeResult});if(x&&!S&&C&&await x.type()==="blob"&&await C.type()==="blob"){if(p.push(E),b.push(E),!d){const D=await x.oid(),R=await C.oid();s.delete({filepath:E}),s.insert({filepath:E,oid:D,stage:1}),s.insert({filepath:E,oid:R,stage:3})}return{mode:await C.mode(),oid:await C.oid(),type:"blob",path:A}}if(x&&S&&!C&&await x.type()==="blob"&&await S.type()==="blob"){if(p.push(E),v.push(E),!d){const D=await x.oid(),R=await S.oid();s.delete({filepath:E}),s.insert({filepath:E,oid:D,stage:1}),s.insert({filepath:E,oid:R,stage:2})}return{mode:await S.mode(),oid:await S.oid(),type:"blob",path:A}}if(x&&!S&&!C&&await x.type()==="blob")return;throw new xh}}},reduce:p.length!==0&&(!r||d)?void 0:async(E,S)=>{const x=S.filter(Boolean);if(E&&!(E&&E.type==="tree"&&x.length===0)){if(x.length>0){const A=new Bn(x).toObject(),M=await is({fs:t,gitdir:n,type:"tree",object:A,dryRun:h});E.oid=M}return E}}});return p.length!==0?(r&&!d&&await Wu({fs:t,cache:e,dir:r,gitdir:n,trees:[ma({ref:w.oid})],map:async function(E,[S]){const x=`${r}/${E}`;if(await S.type()==="blob"){const C=await S.mode(),A=new TextDecoder().decode(await S.content());await t.write(x,A,{mode:C})}return!0}}),new Sh(p,y,b,v)):w.oid}async function K5e({fs:t,gitdir:e,path:r,ours:n,base:s,theirs:i,ourName:o,theirName:a,baseName:l,dryRun:c,mergeDriver:u=W5e}){const h="blob",d=await s.mode()===await n.mode()?await i.mode():await n.mode();if(await n.oid()===await i.oid())return{cleanMerge:!0,mergeResult:{mode:d,path:r,oid:await n.oid(),type:h}};if(await n.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:d,path:r,oid:await i.oid(),type:h}};if(await i.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:d,path:r,oid:await n.oid(),type:h}};const f=Ue.from(await n.content()).toString("utf8"),g=Ue.from(await s.content()).toString("utf8"),_=Ue.from(await i.content()).toString("utf8"),{mergedText:m,cleanMerge:p}=await u({branches:[l,o,a],contents:[g,f,_],path:r}),y=await is({fs:t,gitdir:e,type:"blob",object:Ue.from(m,"utf8"),dryRun:c});return{cleanMerge:p,mergeResult:{mode:d,path:r,oid:y,type:h}}}async function EW({fs:t,cache:e,dir:r,gitdir:n,ours:s,theirs:i,fastForward:o=!0,fastForwardOnly:a=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:h,author:d,committer:f,signingKey:g,onSign:_,mergeDriver:m}){s===void 0&&(s=await fc({fs:t,gitdir:n,fullname:!0})),s=await je.expand({fs:t,gitdir:n,ref:s}),i=await je.expand({fs:t,gitdir:n,ref:i});const p=await je.resolve({fs:t,gitdir:n,ref:s}),y=await je.resolve({fs:t,gitdir:n,ref:i}),b=await o2({fs:t,cache:e,gitdir:n,oids:[p,y]});if(b.length!==1)throw new xh;const v=b[0];if(v===y)return{oid:p,alreadyMerged:!0};if(o&&v===p)return!l&&!c&&await je.writeRef({fs:t,gitdir:n,ref:s,value:y}),{oid:y,fastForward:!0};{if(a)throw new nm;const w=await $r.acquire({fs:t,gitdir:n,cache:e,allowUnmerged:!1},async S=>q5e({fs:t,cache:e,dir:r,gitdir:n,index:S,ourOid:p,theirOid:y,baseOid:v,ourName:El(s),baseName:"base",theirName:El(i),dryRun:l,abortOnConflict:u,mergeDriver:m}));if(w instanceof Sh)throw w;return h||(h=`Merge branch '${El(i)}' into ${El(s)}`),{oid:await iv({fs:t,cache:e,gitdir:n,message:h,ref:s,tree:w,parent:[p,y],author:d,committer:f,signingKey:g,onSign:_,dryRun:l,noUpdateBranch:c}),tree:w,mergeCommit:!0}}}async function xW({fs:t,cache:e,http:r,onProgress:n,onMessage:s,onAuth:i,onAuthSuccess:o,onAuthFailure:a,dir:l,gitdir:c,ref:u,url:h,remote:d,remoteRef:f,prune:g,pruneTags:_,fastForward:m,fastForwardOnly:p,corsProxy:y,singleBranch:b,headers:v,author:w,committer:E,signingKey:S}){try{if(!u){const A=await fc({fs:t,gitdir:c});if(!A)throw new Ln("ref");u=A}const{fetchHead:x,fetchHeadDescription:C}=await i2({fs:t,cache:e,http:r,onProgress:n,onMessage:s,onAuth:i,onAuthSuccess:o,onAuthFailure:a,gitdir:c,corsProxy:y,ref:u,url:h,remote:d,remoteRef:f,singleBranch:b,headers:v,prune:g,pruneTags:_});await EW({fs:t,cache:e,gitdir:c,ours:u,theirs:x,fastForward:m,fastForwardOnly:p,message:`Merge ${C}`,author:w,committer:E,signingKey:S,dryRun:!1,noUpdateBranch:!1}),await s2({fs:t,cache:e,onProgress:n,dir:l,gitdir:c,ref:u,remote:d,noCheckout:!1})}catch(x){throw x.caller="git.pull",x}}async function Y5e({fs:t,http:e,onProgress:r,onMessage:n,onAuth:s,onAuthSuccess:i,onAuthFailure:o,dir:a,gitdir:l=Pe.join(a,".git"),ref:c,url:u,remote:h,remoteRef:d,corsProxy:f,singleBranch:g,headers:_={},cache:m={}}){try{pe("fs",t),pe("http",e),pe("gitdir",l);const p={name:"",email:"",timestamp:Date.now(),timezoneOffset:0};return await xW({fs:new Xe(t),cache:m,http:e,onProgress:r,onMessage:n,onAuth:s,onAuthSuccess:i,onAuthFailure:o,dir:a,gitdir:l,ref:c,url:u,remote:h,remoteRef:d,fastForwardOnly:!0,corsProxy:f,singleBranch:g,headers:_,author:p,committer:p})}catch(p){throw p.caller="git.fastForward",p}}async function X5e({fs:t,http:e,onProgress:r,onMessage:n,onAuth:s,onAuthSuccess:i,onAuthFailure:o,dir:a,gitdir:l=Pe.join(a,".git"),ref:c,remote:u,remoteRef:h,url:d,corsProxy:f,depth:g=null,since:_=null,exclude:m=[],relative:p=!1,tags:y=!1,singleBranch:b=!1,headers:v={},prune:w=!1,pruneTags:E=!1,cache:S={}}){try{return pe("fs",t),pe("http",e),pe("gitdir",l),await i2({fs:new Xe(t),cache:S,http:e,onProgress:r,onMessage:n,onAuth:s,onAuthSuccess:i,onAuthFailure:o,gitdir:l,ref:c,remote:u,remoteRef:h,url:d,corsProxy:f,depth:g,since:_,exclude:m,relative:p,tags:y,singleBranch:b,headers:v,prune:w,pruneTags:E})}catch(x){throw x.caller="git.fetch",x}}async function Z5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),oids:n,cache:s={}}){try{return pe("fs",t),pe("gitdir",r),pe("oids",n),await o2({fs:new Xe(t),cache:s,gitdir:r,oids:n})}catch(i){throw i.caller="git.findMergeBase",i}}async function SW({fs:t,filepath:e}){if(await t.exists(Pe.join(e,".git")))return e;{const r=$u(e);if(r===e)throw new Vt(`git root for ${e}`);return SW({fs:t,filepath:r})}}async function J5e({fs:t,filepath:e}){try{return pe("fs",t),pe("filepath",e),await SW({fs:new Xe(t),filepath:e})}catch(r){throw r.caller="git.findRoot",r}}async function Q5e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),path:n}){try{return pe("fs",t),pe("gitdir",r),pe("path",n),await ep({fs:new Xe(t),gitdir:r,path:n})}catch(s){throw s.caller="git.getConfig",s}}async function e8e({fs:t,gitdir:e,path:r}){return(await ur.get({fs:t,gitdir:e})).getall(r)}async function t8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),path:n}){try{return pe("fs",t),pe("gitdir",r),pe("path",n),await e8e({fs:new Xe(t),gitdir:r,path:n})}catch(s){throw s.caller="git.getConfigAll",s}}async function r8e({http:t,onAuth:e,onAuthSuccess:r,onAuthFailure:n,corsProxy:s,url:i,headers:o={},forPush:a=!1}){try{pe("http",t),pe("url",i);const c=await ov.getRemoteHelperFor({url:i}).discover({http:t,onAuth:e,onAuthSuccess:r,onAuthFailure:n,corsProxy:s,service:a?"git-receive-pack":"git-upload-pack",url:i,headers:o,protocolVersion:1}),u={capabilities:[...c.capabilities]};for(const[h,d]of c.refs){const f=h.split("/"),g=f.pop();let _=u;for(const m of f)_[m]=_[m]||{},_=_[m];_[g]=d}for(const[h,d]of c.symrefs){const f=h.split("/"),g=f.pop();let _=u;for(const m of f)_[m]=_[m]||{},_=_[m];_[g]=d}return u}catch(l){throw l.caller="git.getRemoteInfo",l}}function TW(t,e,r,n){const s=[];for(const[i,o]of t.refs){if(e&&!i.startsWith(e))continue;if(i.endsWith("^{}")){if(n){const l=i.replace("^{}",""),c=s[s.length-1],u=c.ref===l?c:s.find(h=>h.ref===l);if(u===void 0)throw new Error("I did not expect this to happen");u.peeled=o}continue}const a={ref:i,oid:o};r&&t.symrefs.has(i)&&(a.target=t.symrefs.get(i)),s.push(a)}return s}async function n8e({http:t,onAuth:e,onAuthSuccess:r,onAuthFailure:n,corsProxy:s,url:i,headers:o={},forPush:a=!1,protocolVersion:l=2}){try{pe("http",t),pe("url",i);const u=await ov.getRemoteHelperFor({url:i}).discover({http:t,onAuth:e,onAuthSuccess:r,onAuthFailure:n,corsProxy:s,service:a?"git-receive-pack":"git-upload-pack",url:i,headers:o,protocolVersion:l});if(u.protocolVersion===2)return{protocolVersion:u.protocolVersion,capabilities:u.capabilities2};const h={};for(const d of u.capabilities){const[f,g]=d.split("=");g?h[f]=g:h[f]=!0}return{protocolVersion:1,capabilities:h,refs:TW(u,void 0,!0,!0)}}catch(c){throw c.caller="git.getRemoteInfo2",c}}async function s8e({type:t,object:e,format:r="content",oid:n=void 0}){return r!=="deflated"&&(r!=="wrapped"&&(e=Eh.wrap({type:t,object:e})),n=await Io(e)),{oid:n,object:e}}async function i8e({object:t}){try{pe("object",t),typeof t=="string"?t=Ue.from(t,"utf8"):t=Ue.from(t);const e="blob",{oid:r,object:n}=await s8e({type:"blob",format:"content",object:t});return{oid:r,type:e,object:new Uint8Array(n),format:"wrapped"}}catch(e){throw e.caller="git.hashBlob",e}}async function o8e({fs:t,cache:e,onProgress:r,dir:n,gitdir:s,filepath:i}){try{i=Pe.join(n,i);const o=await t.read(i),a=c=>tr({fs:t,cache:e,gitdir:s,oid:c}),l=await Hu.fromPack({pack:o,getExternalRefDelta:a,onProgress:r});return await t.write(i.replace(/\.pack$/,".idx"),await l.toBuffer()),{oids:[...l.hashes]}}catch(o){throw o.caller="git.indexPack",o}}async function a8e({fs:t,onProgress:e,dir:r,gitdir:n=Pe.join(r,".git"),filepath:s,cache:i={}}){try{return pe("fs",t),pe("dir",r),pe("gitdir",r),pe("filepath",s),await o8e({fs:new Xe(t),cache:i,onProgress:e,dir:r,gitdir:n,filepath:s})}catch(o){throw o.caller="git.indexPack",o}}async function l8e({fs:t,bare:e=!1,dir:r,gitdir:n=e?r:Pe.join(r,".git"),defaultBranch:s="master"}){try{return pe("fs",t),pe("gitdir",n),e||pe("dir",r),await wW({fs:new Xe(t),bare:e,dir:r,gitdir:n,defaultBranch:s})}catch(i){throw i.caller="git.init",i}}async function CW({fs:t,cache:e,gitdir:r,oid:n,ancestor:s,depth:i}){const o=await tp.read({fs:t,gitdir:r});if(!n)throw new Ln("oid");if(!s)throw new Ln("ancestor");if(n===s)return!1;const a=[n],l=new Set;let c=0;for(;a.length;){if(c++===i)throw new im(i);const u=a.shift(),{type:h,object:d}=await tr({fs:t,cache:e,gitdir:r,oid:u});if(h!=="commit")throw new xn(u,h,"commit");const f=Yt.from(d).parse();for(const g of f.parent)if(g===s)return!0;if(!o.has(u))for(const g of f.parent)l.has(g)||(a.push(g),l.add(g))}return!1}async function c8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),oid:n,ancestor:s,depth:i=-1,cache:o={}}){try{return pe("fs",t),pe("gitdir",r),pe("oid",n),pe("ancestor",s),await CW({fs:new Xe(t),cache:o,gitdir:r,oid:n,ancestor:s,depth:i})}catch(a){throw a.caller="git.isDescendent",a}}async function u8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),filepath:n}){try{return pe("fs",t),pe("dir",e),pe("gitdir",r),pe("filepath",n),sv.isIgnored({fs:new Xe(t),dir:e,gitdir:r,filepath:n})}catch(s){throw s.caller="git.isIgnored",s}}async function h8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),remote:n}){try{return pe("fs",t),pe("gitdir",r),je.listBranches({fs:new Xe(t),gitdir:r,remote:n})}catch(s){throw s.caller="git.listBranches",s}}async function d8e({fs:t,gitdir:e,ref:r,cache:n}){if(r){const s=await je.resolve({gitdir:e,fs:t,ref:r}),i=[];return await kW({fs:t,cache:n,gitdir:e,oid:s,filenames:i,prefix:""}),i}else return $r.acquire({fs:t,gitdir:e,cache:n},async function(s){return s.entries.map(i=>i.path)})}async function kW({fs:t,cache:e,gitdir:r,oid:n,filenames:s,prefix:i}){const{tree:o}=await Ch({fs:t,cache:e,gitdir:r,oid:n});for(const a of o)a.type==="tree"?await kW({fs:t,cache:e,gitdir:r,oid:a.oid,filenames:s,prefix:Pe.join(i,a.path)}):s.push(Pe.join(i,a.path))}async function f8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n,cache:s={}}){try{return pe("fs",t),pe("gitdir",r),await d8e({fs:new Xe(t),cache:s,gitdir:r,ref:n})}catch(i){throw i.caller="git.listFiles",i}}async function p8e({fs:t,cache:e,gitdir:r,ref:n}){let s;try{s=await je.resolve({gitdir:r,fs:t,ref:n})}catch(a){if(a instanceof Vt)return[]}return(await Ch({fs:t,cache:e,gitdir:r,oid:s})).tree.map(a=>({target:a.path,note:a.oid}))}async function m8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n="refs/notes/commits",cache:s={}}){try{return pe("fs",t),pe("gitdir",r),pe("ref",n),await p8e({fs:new Xe(t),cache:s,gitdir:r,ref:n})}catch(i){throw i.caller="git.listNotes",i}}async function g8e({fs:t,gitdir:e}){const r=await ur.get({fs:t,gitdir:e}),n=await r.getSubsections("remote");return Promise.all(n.map(async i=>{const o=await r.get(`remote.${i}.url`);return{remote:i,url:o}}))}async function _8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git")}){try{return pe("fs",t),pe("gitdir",r),await g8e({fs:new Xe(t),gitdir:r})}catch(n){throw n.caller="git.listRemotes",n}}async function y8e(t){const e=ar.streamReader(t),r=[];let n;for(;n=await e(),n!==!0;){if(n===null)continue;n=n.toString("utf8").replace(/\n$/,"");const[s,i,...o]=n.split(" "),a={ref:i,oid:s};for(const l of o){const[c,u]=l.split(":");c==="symref-target"?a.target=u:c==="peeled"&&(a.peeled=u)}r.push(a)}return r}async function b8e({prefix:t,symrefs:e,peelTags:r}){const n=[];return n.push(ar.encode(`command=ls-refs
`)),n.push(ar.encode(`agent=${av.agent}
`)),(r||e||t)&&n.push(ar.delim()),r&&n.push(ar.encode("peel")),e&&n.push(ar.encode("symrefs")),t&&n.push(ar.encode(`ref-prefix ${t}`)),n.push(ar.flush()),n}async function v8e({http:t,onAuth:e,onAuthSuccess:r,onAuthFailure:n,corsProxy:s,url:i,headers:o={},forPush:a=!1,protocolVersion:l=2,prefix:c,symrefs:u,peelTags:h}){try{pe("http",t),pe("url",i);const d=await Ty.discover({http:t,onAuth:e,onAuthSuccess:r,onAuthFailure:n,corsProxy:s,service:a?"git-receive-pack":"git-upload-pack",url:i,headers:o,protocolVersion:l});if(d.protocolVersion===1)return TW(d,c,u,h);const f=await b8e({prefix:c,symrefs:u,peelTags:h}),g=await Ty.connect({http:t,auth:d.auth,headers:o,corsProxy:s,service:a?"git-receive-pack":"git-upload-pack",url:i,body:f});return y8e(g.body)}catch(d){throw d.caller="git.listServerRefs",d}}async function w8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git")}){try{return pe("fs",t),pe("gitdir",r),je.listTags({fs:new Xe(t),gitdir:r})}catch(n){throw n.caller="git.listTags",n}}function E8e(t,e){return t.committer.timestamp-e.committer.timestamp}const x8e="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function s3({fs:t,cache:e,gitdir:r,oid:n,fileId:s}){if(s===x8e)return;const i=n;let o;const a=await Gu({fs:t,cache:e,gitdir:r,oid:n}),l=a.tree;return s===a.oid?o=a.path:(o=await AW({fs:t,cache:e,gitdir:r,tree:l,fileId:s,oid:i}),Array.isArray(o)&&(o.length===0?o=void 0:o.length===1&&(o=o[0]))),o}async function AW({fs:t,cache:e,gitdir:r,tree:n,fileId:s,oid:i,filepaths:o=[],parentPath:a=""}){const l=n.entries().map(function(c){let u;return c.oid===s?(u=Pe.join(a,c.path),o.push(u)):c.type==="tree"&&(u=tr({fs:t,cache:e,gitdir:r,oid:c.oid}).then(function({object:h}){return AW({fs:t,cache:e,gitdir:r,tree:Bn.from(h),fileId:s,oid:i,filepaths:o,parentPath:Pe.join(a,c.path)})})),u});return await Promise.all(l),o}async function S8e({fs:t,cache:e,gitdir:r,filepath:n,ref:s,depth:i,since:o,force:a,follow:l}){const c=typeof o>"u"?void 0:Math.floor(o.valueOf()/1e3),u=[],h=await tp.read({fs:t,gitdir:r}),d=await je.resolve({fs:t,gitdir:r,ref:s}),f=[await xy({fs:t,cache:e,gitdir:r,oid:d})];let g,_,m;function p(y){m&&n&&u.push(y)}for(;f.length>0;){const y=f.pop();if(c!==void 0&&y.commit.committer.timestamp<=c)break;if(n){let b;try{b=await dm({fs:t,cache:e,gitdir:r,oid:y.commit.tree,filepath:n}),_&&g!==b&&u.push(_),g=b,_=y,m=!0}catch(v){if(v instanceof Vt){let w=l&&g;if(w&&(w=await s3({fs:t,cache:e,gitdir:r,oid:y.commit.tree,fileId:g}),w))if(Array.isArray(w)){if(_){const E=await s3({fs:t,cache:e,gitdir:r,oid:_.commit.tree,fileId:g});if(Array.isArray(E))if(w=w.filter(S=>E.indexOf(S)===-1),w.length===1)w=w[0],n=w,_&&u.push(_);else{w=!1,_&&u.push(_);break}}}else n=w,_&&u.push(_);if(!w){if(m&&g&&(u.push(_),!a))break;if(!a&&!l)throw v}_=y,m=!1}else throw v}}else u.push(y);if(i!==void 0&&u.length===i){p(y);break}if(!h.has(y.oid))for(const b of y.commit.parent){const v=await xy({fs:t,cache:e,gitdir:r,oid:b});f.map(w=>w.oid).includes(v.oid)||f.push(v)}f.length===0&&p(y),f.sort((b,v)=>E8e(b.commit,v.commit))}return u}async function T8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),filepath:n,ref:s="HEAD",depth:i,since:o,force:a,follow:l,cache:c={}}){try{return pe("fs",t),pe("gitdir",r),pe("ref",s),await S8e({fs:new Xe(t),cache:c,gitdir:r,filepath:n,ref:s,depth:i,since:o,force:a,follow:l})}catch(u){throw u.caller="git.log",u}}async function C8e({fs:t,onSign:e,dir:r,gitdir:n=Pe.join(r,".git"),ours:s,theirs:i,fastForward:o=!0,fastForwardOnly:a=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:h,author:d,committer:f,signingKey:g,cache:_={},mergeDriver:m}){try{pe("fs",t),g&&pe("onSign",e);const p=new Xe(t),y=await tc({fs:p,gitdir:n,author:d});if(!y&&(!a||!o))throw new yn("author");const b=await qu({fs:p,gitdir:n,author:y,committer:f});if(!b&&(!a||!o))throw new yn("committer");return await EW({fs:p,cache:_,dir:r,gitdir:n,ours:s,theirs:i,fastForward:o,fastForwardOnly:a,dryRun:l,noUpdateBranch:c,abortOnConflict:u,message:h,author:y,committer:b,signingKey:g,onSign:e,mergeDriver:m})}catch(p){throw p.caller="git.merge",p}}const k8e={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function RW({fs:t,cache:e,dir:r,gitdir:n=Pe.join(r,".git"),oids:s}){const i=new cG,o=[];function a(u,h){const d=Ue.from(u,h);o.push(d),i.update(d)}async function l({stype:u,object:h}){const d=k8e[u];let f=h.length,g=f>15?128:0;const _=f&15;f=f>>>4;let m=(g|d|_).toString(16);for(a(m,"hex");g;)g=f>127?128:0,m=g|f&127,a(fT(2,m),"hex"),f=f>>>7;a(Ue.from(await uW(h)))}a("PACK"),a("00000002","hex"),a(fT(8,s.length),"hex");for(const u of s){const{type:h,object:d}=await tr({fs:t,cache:e,gitdir:n,oid:u});await l({write:a,object:d,stype:h})}const c=i.digest();return o.push(c),o}async function A8e({fs:t,cache:e,gitdir:r,oids:n,write:s}){const i=await RW({fs:t,cache:e,gitdir:r,oids:n}),o=Ue.from(await Sy(i)),l=`pack-${o.slice(-20).toString("hex")}.pack`;return s?(await t.write(Pe.join(r,`objects/pack/${l}`),o),{filename:l}):{filename:l,packfile:new Uint8Array(o)}}async function R8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),oids:n,write:s=!1,cache:i={}}){try{return pe("fs",t),pe("gitdir",r),pe("oids",n),await A8e({fs:new Xe(t),cache:i,gitdir:r,oids:n,write:s})}catch(o){throw o.caller="git.packObjects",o}}async function I8e({fs:t,http:e,onProgress:r,onMessage:n,onAuth:s,onAuthSuccess:i,onAuthFailure:o,dir:a,gitdir:l=Pe.join(a,".git"),ref:c,url:u,remote:h,remoteRef:d,prune:f=!1,pruneTags:g=!1,fastForward:_=!0,fastForwardOnly:m=!1,corsProxy:p,singleBranch:y,headers:b={},author:v,committer:w,signingKey:E,cache:S={}}){try{pe("fs",t),pe("gitdir",l);const x=new Xe(t),C=await tc({fs:x,gitdir:l,author:v});if(!C)throw new yn("author");const A=await qu({fs:x,gitdir:l,author:C,committer:w});if(!A)throw new yn("committer");return await xW({fs:x,cache:S,http:e,onProgress:r,onMessage:n,onAuth:s,onAuthSuccess:i,onAuthFailure:o,dir:a,gitdir:l,ref:c,url:u,remote:h,remoteRef:d,fastForward:_,fastForwardOnly:m,corsProxy:p,singleBranch:y,headers:b,author:C,committer:A,signingKey:E,prune:f,pruneTags:g})}catch(x){throw x.caller="git.pull",x}}async function P8e({fs:t,cache:e,dir:r,gitdir:n=Pe.join(r,".git"),start:s,finish:i}){const o=await tp.read({fs:t,gitdir:n}),a=new Set,l=new Set;for(const h of s)a.add(await je.resolve({fs:t,gitdir:n,ref:h}));for(const h of i)try{const d=await je.resolve({fs:t,gitdir:n,ref:h});l.add(d)}catch{}const c=new Set;async function u(h){c.add(h);const{type:d,object:f}=await tr({fs:t,cache:e,gitdir:n,oid:h});if(d==="tag"){const _=gn.from(f).headers().object;return u(_)}if(d!=="commit")throw new xn(h,d,"commit");if(!o.has(h)){const _=Yt.from(f).headers().parent;for(h of _)!l.has(h)&&!c.has(h)&&await u(h)}}for(const h of a)await u(h);return c}async function F1({fs:t,cache:e,dir:r,gitdir:n=Pe.join(r,".git"),oids:s}){const i=new Set;async function o(a){if(i.has(a))return;i.add(a);const{type:l,object:c}=await tr({fs:t,cache:e,gitdir:n,oid:a});if(l==="tag"){const h=gn.from(c).headers().object;await o(h)}else if(l==="commit"){const h=Yt.from(c).headers().tree;await o(h)}else if(l==="tree"){const u=Bn.from(c);for(const h of u)h.type==="blob"&&i.add(h.oid),h.type==="tree"&&await o(h.oid)}}for(const a of s)await o(a);return i}async function O8e(t){const e={};let r="";const n=ar.streamReader(t);let s=await n();for(;s!==!0;)s!==null&&(r+=s.toString("utf8")+`
`),s=await n();const i=r.toString("utf8").split(`
`);if(s=i.shift(),!s.startsWith("unpack "))throw new dc('unpack ok" or "unpack [error message]',s);e.ok=s==="unpack ok",e.ok||(e.error=s.slice(7)),e.refs={};for(const o of i){if(o.trim()==="")continue;const a=o.slice(0,2),l=o.slice(3);let c=l.indexOf(" ");c===-1&&(c=l.length);const u=l.slice(0,c),h=l.slice(c+1);e.refs[u]={ok:a==="ok",error:h}}return e}async function D8e({capabilities:t=[],triplets:e=[]}){const r=[];let n=`\0 ${t.join(" ")}`;for(const s of e)r.push(ar.encode(`${s.oldoid} ${s.oid} ${s.fullRef}${n}
`)),n="";return r.push(ar.flush()),r}async function L8e({fs:t,cache:e,http:r,onProgress:n,onMessage:s,onAuth:i,onAuthSuccess:o,onAuthFailure:a,onPrePush:l,gitdir:c,ref:u,remoteRef:h,remote:d,url:f,force:g=!1,delete:_=!1,corsProxy:m,headers:p={}}){const y=u||await fc({fs:t,gitdir:c});if(typeof y>"u")throw new Ln("ref");const b=await ur.get({fs:t,gitdir:c});d=d||await b.get(`branch.${y}.pushRemote`)||await b.get("remote.pushDefault")||await b.get(`branch.${y}.remote`)||"origin";const v=f||await b.get(`remote.${d}.pushurl`)||await b.get(`remote.${d}.url`);if(typeof v>"u")throw new Ln("remote OR url");const w=h||await b.get(`branch.${y}.merge`);if(typeof v>"u")throw new Ln("remoteRef");m===void 0&&(m=await b.get("http.corsProxy"));const E=await je.expand({fs:t,gitdir:c,ref:y}),S=_?"0000000000000000000000000000000000000000":await je.resolve({fs:t,gitdir:c,ref:E}),x=ov.getRemoteHelperFor({url:v}),C=await x.discover({http:r,onAuth:i,onAuthSuccess:o,onAuthFailure:a,corsProxy:m,service:"git-receive-pack",url:v,headers:p,protocolVersion:1}),A=C.auth;let M;if(!w)M=E;else try{M=await je.expandAgainstMap({ref:w,map:C.refs})}catch(H){if(H instanceof Vt)M=w.startsWith("refs/")?w:`refs/heads/${w}`;else throw H}const P=C.refs.get(M)||"0000000000000000000000000000000000000000";if(l&&!await l({remote:d,url:v,localRef:{ref:_?"(delete)":E,oid:S},remoteRef:{ref:M,oid:P}}))throw new Th;const D=!C.capabilities.has("no-thin");let R=new Set;if(!_){const H=[...C.refs.values()];let U=new Set;if(P!=="0000000000000000000000000000000000000000"){const Q=await o2({fs:t,cache:e,gitdir:c,oids:[S,P]});for(const ne of Q)H.push(ne);D&&(U=await F1({fs:t,cache:e,gitdir:c,oids:Q}))}if(!H.includes(S)){const Q=await P8e({fs:t,cache:e,gitdir:c,start:[S],finish:H});R=await F1({fs:t,cache:e,gitdir:c,oids:Q})}if(D){try{const Q=await je.resolve({fs:t,gitdir:c,ref:`refs/remotes/${d}/HEAD`,depth:2}),{oid:ne}=await je.resolveAgainstMap({ref:Q.replace(`refs/remotes/${d}/`,""),fullref:Q,map:C.refs}),ge=[ne];for(const J of await F1({fs:t,cache:e,gitdir:c,oids:ge}))U.add(J)}catch{}for(const Q of U)R.delete(Q)}if(S===P&&(g=!0),!g){if(E.startsWith("refs/tags")&&P!=="0000000000000000000000000000000000000000")throw new Vu("tag-exists");if(S!=="0000000000000000000000000000000000000000"&&P!=="0000000000000000000000000000000000000000"&&!await CW({fs:t,cache:e,gitdir:c,oid:S,ancestor:P,depth:-1}))throw new Vu("not-fast-forward")}}const G=yW([...C.capabilities],["report-status","side-band-64k",`agent=${av.agent}`]),ee=await D8e({capabilities:G,triplets:[{oldoid:P,oid:S,fullRef:M}]}),q=_?[]:await RW({fs:t,cache:e,gitdir:c,oids:[...R]}),re=await x.connect({http:r,onProgress:n,corsProxy:m,service:"git-receive-pack",url:v,auth:A,headers:p,body:[...ee,...q]}),{packfile:N,progress:B}=await vW.demux(re.body);if(s){const H=bW(B);fm(H,async U=>{await s(U)})}const $=await O8e(N);if(re.headers&&($.headers=re.headers),d&&$.ok&&$.refs[M].ok&&!E.startsWith("refs/tags")){const H=`refs/remotes/${d}/${M.replace("refs/heads","")}`;_?await je.deleteRef({fs:t,gitdir:c,ref:H}):await je.writeRef({fs:t,gitdir:c,ref:H,value:S})}if($.ok&&Object.values($.refs).every(H=>H.ok))return $;{const H=Object.entries($.refs).filter(([U,Q])=>!Q.ok).map(([U,Q])=>`
  - ${U}: ${Q.error}`).join("");throw new sm(H,$)}}async function N8e({fs:t,http:e,onProgress:r,onMessage:n,onAuth:s,onAuthSuccess:i,onAuthFailure:o,onPrePush:a,dir:l,gitdir:c=Pe.join(l,".git"),ref:u,remoteRef:h,remote:d="origin",url:f,force:g=!1,delete:_=!1,corsProxy:m,headers:p={},cache:y={}}){try{return pe("fs",t),pe("http",e),pe("gitdir",c),await L8e({fs:new Xe(t),cache:y,http:e,onProgress:r,onMessage:n,onAuth:s,onAuthSuccess:i,onAuthFailure:o,onPrePush:a,gitdir:c,ref:u,remoteRef:h,remote:d,url:f,force:g,delete:_,corsProxy:m,headers:p})}catch(b){throw b.caller="git.push",b}}async function IW({fs:t,cache:e,gitdir:r,oid:n}){const{type:s,object:i}=await tr({fs:t,cache:e,gitdir:r,oid:n});if(s==="tag")return n=gn.from(i).parse().object,IW({fs:t,cache:e,gitdir:r,oid:n});if(s!=="blob")throw new xn(n,s,"blob");return{oid:n,blob:new Uint8Array(i)}}async function PW({fs:t,cache:e,gitdir:r,oid:n,filepath:s=void 0}){return s!==void 0&&(n=await dm({fs:t,cache:e,gitdir:r,oid:n,filepath:s})),await IW({fs:t,cache:e,gitdir:r,oid:n})}async function M8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),oid:n,filepath:s,cache:i={}}){try{return pe("fs",t),pe("gitdir",r),pe("oid",n),await PW({fs:new Xe(t),cache:i,gitdir:r,oid:n,filepath:s})}catch(o){throw o.caller="git.readBlob",o}}async function B8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),oid:n,cache:s={}}){try{return pe("fs",t),pe("gitdir",r),pe("oid",n),await xy({fs:new Xe(t),cache:s,gitdir:r,oid:n})}catch(i){throw i.caller="git.readCommit",i}}async function F8e({fs:t,cache:e,gitdir:r,ref:n="refs/notes/commits",oid:s}){const i=await je.resolve({gitdir:r,fs:t,ref:n}),{blob:o}=await PW({fs:t,cache:e,gitdir:r,oid:i,filepath:s});return o}async function j8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n="refs/notes/commits",oid:s,cache:i={}}){try{return pe("fs",t),pe("gitdir",r),pe("ref",n),pe("oid",s),await F8e({fs:new Xe(t),cache:i,gitdir:r,ref:n,oid:s})}catch(o){throw o.caller="git.readNote",o}}async function U8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),oid:n,format:s="parsed",filepath:i=void 0,encoding:o=void 0,cache:a={}}){try{pe("fs",t),pe("gitdir",r),pe("oid",n);const l=new Xe(t);i!==void 0&&(n=await dm({fs:l,cache:a,gitdir:r,oid:n,filepath:i}));const u=await tr({fs:l,cache:a,gitdir:r,oid:n,format:s==="parsed"?"content":s});if(u.oid=n,s==="parsed")switch(u.format="parsed",u.type){case"commit":u.object=Yt.from(u.object).parse();break;case"tree":u.object=Bn.from(u.object).entries();break;case"blob":o?u.object=u.object.toString(o):(u.object=new Uint8Array(u.object),u.format="content");break;case"tag":u.object=gn.from(u.object).parse();break;default:throw new xn(u.oid,u.type,"blob|commit|tag|tree")}else(u.format==="deflated"||u.format==="wrapped")&&(u.type=u.format);return u}catch(l){throw l.caller="git.readObject",l}}async function $8e({fs:t,cache:e,gitdir:r,oid:n}){const{type:s,object:i}=await tr({fs:t,cache:e,gitdir:r,oid:n,format:"content"});if(s!=="tag")throw new xn(n,s,"tag");const o=gn.from(i);return{oid:n,tag:o.parse(),payload:o.payload()}}async function H8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),oid:n,cache:s={}}){try{return pe("fs",t),pe("gitdir",r),pe("oid",n),await $8e({fs:new Xe(t),cache:s,gitdir:r,oid:n})}catch(i){throw i.caller="git.readTag",i}}async function z8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),oid:n,filepath:s=void 0,cache:i={}}){try{return pe("fs",t),pe("gitdir",r),pe("oid",n),await Ch({fs:new Xe(t),cache:i,gitdir:r,oid:n,filepath:s})}catch(o){throw o.caller="git.readTree",o}}async function V8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),filepath:n,cache:s={}}){try{pe("fs",t),pe("gitdir",r),pe("filepath",n),await $r.acquire({fs:new Xe(t),gitdir:r,cache:s},async function(i){i.delete({filepath:n})})}catch(i){throw i.caller="git.remove",i}}async function G8e({fs:t,cache:e,onSign:r,gitdir:n,ref:s="refs/notes/commits",oid:i,author:o,committer:a,signingKey:l}){let c;try{c=await je.resolve({gitdir:n,fs:t,ref:s})}catch(g){if(!(g instanceof Vt))throw g}let h=(await Ch({fs:t,gitdir:n,oid:c||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;h=h.filter(g=>g.path!==i);const d=await n2({fs:t,gitdir:n,tree:h});return await iv({fs:t,cache:e,onSign:r,gitdir:n,ref:s,tree:d,parent:c&&[c],message:`Note removed by 'isomorphic-git removeNote'
`,author:o,committer:a,signingKey:l})}async function W8e({fs:t,onSign:e,dir:r,gitdir:n=Pe.join(r,".git"),ref:s="refs/notes/commits",oid:i,author:o,committer:a,signingKey:l,cache:c={}}){try{pe("fs",t),pe("gitdir",n),pe("oid",i);const u=new Xe(t),h=await tc({fs:u,gitdir:n,author:o});if(!h)throw new yn("author");const d=await qu({fs:u,gitdir:n,author:h,committer:a});if(!d)throw new yn("committer");return await G8e({fs:u,cache:c,onSign:e,gitdir:n,ref:s,oid:i,author:h,committer:d,signingKey:l})}catch(u){throw u.caller="git.removeNote",u}}async function q8e({fs:t,gitdir:e,oldref:r,ref:n,checkout:s=!1}){if(n!==Ii.clean(n))throw new Po(n,Ii.clean(n));if(r!==Ii.clean(r))throw new Po(r,Ii.clean(r));const i=`refs/heads/${r}`,o=`refs/heads/${n}`;if(await je.exists({fs:t,gitdir:e,ref:o}))throw new Xs("branch",n,!1);const l=await je.resolve({fs:t,gitdir:e,ref:i,depth:1});await je.writeRef({fs:t,gitdir:e,ref:o,value:l}),await je.deleteRef({fs:t,gitdir:e,ref:i});const u=await fc({fs:t,gitdir:e,fullname:!0})===i;(s||u)&&await je.writeSymbolicRef({fs:t,gitdir:e,ref:"HEAD",value:o})}async function K8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n,oldref:s,checkout:i=!1}){try{return pe("fs",t),pe("gitdir",r),pe("ref",n),pe("oldref",s),await q8e({fs:new Xe(t),gitdir:r,ref:n,oldref:s,checkout:i})}catch(o){throw o.caller="git.renameBranch",o}}async function OW({gitdir:t,type:e,object:r}){return Io(Eh.wrap({type:e,object:r}))}async function Y8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),filepath:n,ref:s,cache:i={}}){try{pe("fs",t),pe("gitdir",r),pe("filepath",n);const o=new Xe(t);let a,l;try{a=await je.resolve({fs:o,gitdir:r,ref:s||"HEAD"})}catch(h){if(s)throw h}if(a)try{a=await dm({fs:o,cache:i,gitdir:r,oid:a,filepath:n})}catch{a=null}let c={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const u=e&&await o.read(Pe.join(e,n));u&&(l=await OW({gitdir:r,type:"blob",object:u}),a===l&&(c=await o.lstat(Pe.join(e,n)))),await $r.acquire({fs:o,gitdir:r,cache:i},async function(h){h.delete({filepath:n}),a&&h.insert({filepath:n,stats:c,oid:a})})}catch(o){throw o.caller="git.reset",o}}async function X8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n,depth:s}){try{return pe("fs",t),pe("gitdir",r),pe("ref",n),await je.resolve({fs:new Xe(t),gitdir:r,ref:n,depth:s})}catch(i){throw i.caller="git.resolveRef",i}}async function Z8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),path:n,value:s,append:i=!1}){try{pe("fs",t),pe("gitdir",r),pe("path",n);const o=new Xe(t),a=await ur.get({fs:o,gitdir:r});i?await a.append(n,s):await a.set(n,s),await ur.save({fs:o,gitdir:r,config:a})}catch(o){throw o.caller="git.setConfig",o}}async function J8e({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),filepath:n,cache:s={}}){try{pe("fs",t),pe("gitdir",r),pe("filepath",n);const i=new Xe(t);if(await sv.isIgnored({fs:i,gitdir:r,dir:e,filepath:n}))return"ignored";const a=await Q8e({fs:i,cache:s,gitdir:r}),l=await DW({fs:i,cache:s,gitdir:r,tree:a,path:n}),c=await $r.acquire({fs:i,gitdir:r,cache:s},async function(_){for(const m of _)if(m.path===n)return m;return null}),u=await i.lstat(Pe.join(e,n)),h=l!==null,d=c!==null,f=u!==null,g=async()=>{if(d&&!_y(c,u))return c.oid;{const _=await i.read(Pe.join(e,n)),m=await OW({gitdir:r,type:"blob",object:_});return d&&c.oid===m&&u.size!==-1&&$r.acquire({fs:i,gitdir:r,cache:s},async function(p){p.insert({filepath:n,stats:u,oid:m})}),m}};if(!h&&!f&&!d)return"absent";if(!h&&!f&&d)return"*absent";if(!h&&f&&!d)return"*added";if(!h&&f&&d)return await g()===c.oid?"added":"*added";if(h&&!f&&!d)return"deleted";if(h&&!f&&d)return l===c.oid,"*deleted";if(h&&f&&!d)return await g()===l?"*undeleted":"*undeletemodified";if(h&&f&&d){const _=await g();return _===l?_===c.oid?"unmodified":"*unmodified":_===c.oid?"modified":"*modified"}}catch(i){throw i.caller="git.status",i}}async function DW({fs:t,cache:e,gitdir:r,tree:n,path:s}){typeof s=="string"&&(s=s.split("/"));const i=s.shift();for(const o of n)if(o.path===i){if(s.length===0)return o.oid;const{type:a,object:l}=await tr({fs:t,cache:e,gitdir:r,oid:o.oid});if(a==="tree"){const c=Bn.from(l);return DW({fs:t,cache:e,gitdir:r,tree:c,path:s})}if(a==="blob")throw new xn(o.oid,a,"blob",s.join("/"))}return null}async function Q8e({fs:t,cache:e,gitdir:r}){let n;try{n=await je.resolve({fs:t,gitdir:r,ref:"HEAD"})}catch(i){if(i instanceof Vt)return[]}const{tree:s}=await Ch({fs:t,cache:e,gitdir:r,oid:n});return s}async function eje({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n="HEAD",filepaths:s=["."],filter:i,cache:o={},ignored:a=!1}){try{pe("fs",t),pe("gitdir",r),pe("ref",n);const l=new Xe(t);return await Wu({fs:l,cache:o,dir:e,gitdir:r,trees:[ma({ref:n}),nv(),rv()],map:async function(c,[u,h,d]){if(!u&&!d&&h&&!a&&await sv.isIgnored({fs:l,dir:e,filepath:c})||!s.some(E=>gW(c,E)))return null;if(i&&!i(c))return;const[f,g,_]=await Promise.all([u&&u.type(),h&&h.type(),d&&d.type()]),m=[f,g,_].includes("blob");if((f==="tree"||f==="special")&&!m)return;if(f==="commit")return null;if((g==="tree"||g==="special")&&!m)return;if(_==="commit")return null;if((_==="tree"||_==="special")&&!m)return;const p=f==="blob"?await u.oid():void 0,y=_==="blob"?await d.oid():void 0;let b;f!=="blob"&&g==="blob"&&_!=="blob"?b="42":g==="blob"&&(b=await h.oid());const v=[void 0,p,b,y],w=v.map(E=>v.indexOf(E));return w.shift(),[c,...w]}})}catch(l){throw l.caller="git.statusMatrix",l}}async function tje({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n,object:s,force:i=!1}){try{pe("fs",t),pe("gitdir",r),pe("ref",n);const o=new Xe(t);if(n===void 0)throw new Ln("ref");n=n.startsWith("refs/tags/")?n:`refs/tags/${n}`;const a=await je.resolve({fs:o,gitdir:r,ref:s||"HEAD"});if(!i&&await je.exists({fs:o,gitdir:r,ref:n}))throw new Xs("tag",n);await je.writeRef({fs:o,gitdir:r,ref:n,value:a})}catch(o){throw o.caller="git.tag",o}}async function rje({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),cache:n={},filepath:s,oid:i,mode:o,add:a,remove:l,force:c}){try{pe("fs",t),pe("gitdir",r),pe("filepath",s);const u=new Xe(t);if(l)return await $r.acquire({fs:u,gitdir:r,cache:n},async function(d){let f;if(!c&&(f=await u.lstat(Pe.join(e,s)),f)){if(f.isDirectory())throw new Fa("directory");return}d.has({filepath:s})&&d.delete({filepath:s})});let h;if(!i){if(h=await u.lstat(Pe.join(e,s)),!h)throw new Vt(`file at "${s}" on disk and "remove" not set`);if(h.isDirectory())throw new Fa("directory")}return await $r.acquire({fs:u,gitdir:r,cache:n},async function(d){if(!a&&!d.has({filepath:s}))throw new Vt(`file at "${s}" in index and "add" not set`);let f={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:o,uid:0,gid:0,size:0};if(!i){f=h;const g=f.isSymbolicLink()?await u.readlink(Pe.join(e,s)):await u.read(Pe.join(e,s));i=await is({fs:u,gitdir:r,type:"blob",format:"content",object:g})}return d.insert({filepath:s,oid:i,stats:f}),i})}catch(u){throw u.caller="git.updateIndex",u}}function nje(){try{return av.version}catch(t){throw t.caller="git.version",t}}async function sje({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),trees:n,map:s,reduce:i,iterate:o,cache:a={}}){try{return pe("fs",t),pe("gitdir",r),pe("trees",n),await Wu({fs:new Xe(t),cache:a,dir:e,gitdir:r,trees:n,map:s,reduce:i,iterate:o})}catch(l){throw l.caller="git.walk",l}}async function ije({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),blob:n}){try{return pe("fs",t),pe("gitdir",r),pe("blob",n),await is({fs:new Xe(t),gitdir:r,type:"blob",object:n,format:"content"})}catch(s){throw s.caller="git.writeBlob",s}}async function oje({fs:t,gitdir:e,commit:r}){const n=Yt.from(r).toObject();return await is({fs:t,gitdir:e,type:"commit",object:n,format:"content"})}async function aje({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),commit:n}){try{return pe("fs",t),pe("gitdir",r),pe("commit",n),await oje({fs:new Xe(t),gitdir:r,commit:n})}catch(s){throw s.caller="git.writeCommit",s}}async function lje({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),type:n,object:s,format:i="parsed",oid:o,encoding:a=void 0}){try{const l=new Xe(t);if(i==="parsed"){switch(n){case"commit":s=Yt.from(s).toObject();break;case"tree":s=Bn.from(s).toObject();break;case"blob":s=Ue.from(s,a);break;case"tag":s=gn.from(s).toObject();break;default:throw new xn(o||"",n,"blob|commit|tag|tree")}i="content"}return o=await is({fs:l,gitdir:r,type:n,object:s,oid:o,format:i}),o}catch(l){throw l.caller="git.writeObject",l}}async function cje({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),ref:n,value:s,force:i=!1,symbolic:o=!1}){try{pe("fs",t),pe("gitdir",r),pe("ref",n),pe("value",s);const a=new Xe(t);if(n!==Ii.clean(n))throw new Po(n,Ii.clean(n));if(!i&&await je.exists({fs:a,gitdir:r,ref:n}))throw new Xs("ref",n);o?await je.writeSymbolicRef({fs:a,gitdir:r,ref:n,value:s}):(s=await je.resolve({fs:a,gitdir:r,ref:s}),await je.writeRef({fs:a,gitdir:r,ref:n,value:s}))}catch(a){throw a.caller="git.writeRef",a}}async function uje({fs:t,gitdir:e,tag:r}){const n=gn.from(r).toObject();return await is({fs:t,gitdir:e,type:"tag",object:n,format:"content"})}async function hje({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),tag:n}){try{return pe("fs",t),pe("gitdir",r),pe("tag",n),await uje({fs:new Xe(t),gitdir:r,tag:n})}catch(s){throw s.caller="git.writeTag",s}}async function dje({fs:t,dir:e,gitdir:r=Pe.join(e,".git"),tree:n}){try{return pe("fs",t),pe("gitdir",r),pe("tree",n),await n2({fs:new Xe(t),gitdir:r,tree:n})}catch(s){throw s.caller="git.writeTree",s}}var fje={Errors:WFe,STAGE:rv,TREE:ma,WORKDIR:nv,add:h5e,abortMerge:o5e,addNote:f5e,addRemote:p5e,annotatedTag:g5e,branch:y5e,checkout:v5e,clone:P5e,commit:O5e,getConfig:Q5e,getConfigAll:t8e,setConfig:Z8e,currentBranch:D5e,deleteBranch:N5e,deleteRef:M5e,deleteRemote:F5e,deleteTag:U5e,expandOid:V5e,expandRef:G5e,fastForward:Y5e,fetch:X5e,findMergeBase:Z5e,findRoot:J5e,getRemoteInfo:r8e,getRemoteInfo2:n8e,hashBlob:i8e,indexPack:a8e,init:l8e,isDescendent:c8e,isIgnored:u8e,listBranches:h8e,listFiles:f8e,listNotes:m8e,listRemotes:_8e,listServerRefs:v8e,listTags:w8e,log:T8e,merge:C8e,packObjects:R8e,pull:I8e,push:N8e,readBlob:M8e,readCommit:B8e,readNote:j8e,readObject:U8e,readTag:H8e,readTree:z8e,remove:V8e,removeNote:W8e,renameBranch:K8e,resetIndex:Y8e,updateIndex:rje,resolveRef:X8e,status:J8e,statusMatrix:eje,tag:tje,version:nje,walk:sje,writeBlob:ije,writeCommit:aje,writeObject:lje,writeRef:cje,writeTag:hje,writeTree:dje};function pje(t){let e=[t];return{next(){return Promise.resolve({done:e.length===0,value:e.pop()})},return(){return e=[],{}},[Symbol.asyncIterator](){return this}}}function mje(t){return t[Symbol.asyncIterator]?t[Symbol.asyncIterator]():t[Symbol.iterator]?t[Symbol.iterator]():t.next?t:pje(t)}async function gje(t,e){const r=mje(t);for(;;){const{value:n,done:s}=await r.next();if(n&&await e(n),s)break}r.return&&r.return()}async function _je(t){let e=0;const r=[];await gje(t,i=>{r.push(i),e+=i.byteLength});const n=new Uint8Array(e);let s=0;for(const i of r)n.set(i,s),s+=i.byteLength;return n}function yje(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{next(){return e.read()},return(){return e.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function bje({onProgress:t,url:e,method:r="GET",headers:n={},body:s}){s&&(s=await _je(s));const i=await fetch(e,{method:r,headers:n,body:s}),o=i.body&&i.body.getReader?yje(i.body):[new Uint8Array(await i.arrayBuffer())];n={};for(const[a,l]of i.headers.entries())n[a]=l;return{url:i.url,method:i.method,statusCode:i.status,statusMessage:i.statusText,body:o,headers:n}}var vje={request:bje};const i3=t=>{const e=t.split("/")[2],r=Ke.get(`git:${e}`);if(!r)return null;try{const{username:n,password:s}=JSON.parse(r||"{}");return{username:n,password:s}}catch(n){return console.log(`Failed to parse Git Cookie ${n}`),null}},wje=(t,e)=>{const r=t.split("/")[2];Ke.set(`git:${r}`,JSON.stringify(e))};function Eje(){const[t,e]=I.useState(!1),[r,n]=I.useState(),[s,i]=I.useState(),o=I.useRef({});I.useEffect(()=>{ol.then(l=>{o.current={},n(l),i(LW(l,o)),e(!0)})},[]);const a=I.useCallback(async l=>{if(!r||!s||!t)throw"Webcontainer not initialized";o.current={};const c={"User-Agent":"Terretacode.diy"},u=i3(l);u&&(c.Authorization=`Basic ${Ue.from(`${u.username}:${u.password}`).toString("base64")}`);try{await fje.clone({fs:s,http:vje,dir:r.workdir,url:l,depth:1,singleBranch:!0,corsProxy:"/api/git-proxy",headers:c,onAuth:d=>{let f=i3(d);return f||(confirm("This repo is password protected. Ready to enter a username & password?")?(f={username:prompt("Enter username"),password:prompt("Enter password")},f):{cancel:!0})},onAuthFailure:(d,f)=>{Ne.error(`Error Authenticating with ${d.split("/")[2]}`)},onAuthSuccess:(d,f)=>{wje(d,f)}});const h={};for(const[d,f]of Object.entries(o.current))h[d]=f;return{workdir:r.workdir,data:h}}catch(h){throw console.error("Git clone error:",h),h}},[r,s,t]);return{ready:t,gitClone:a}}const LW=(t,e)=>({promises:{readFile:async(r,n)=>{const s=n?.encoding,i=ci.relative(t.workdir,r);try{return await t.fs.readFile(i,s)}catch(o){throw o}},writeFile:async(r,n,s)=>{const i=s.encoding,o=ci.relative(t.workdir,r);e.current&&(e.current[o]={data:n,encoding:i});try{return await t.fs.writeFile(o,n,{...s,encoding:i})}catch(a){throw a}},mkdir:async(r,n)=>{const s=ci.relative(t.workdir,r);try{return await t.fs.mkdir(s,{...n,recursive:!0})}catch(i){throw i}},readdir:async(r,n)=>{const s=ci.relative(t.workdir,r);try{return await t.fs.readdir(s,n)}catch(i){throw i}},rm:async(r,n)=>{const s=ci.relative(t.workdir,r);try{return await t.fs.rm(s,{...n||{}})}catch(i){throw i}},rmdir:async(r,n)=>{const s=ci.relative(t.workdir,r);try{return await t.fs.rm(s,{recursive:!0,...n})}catch(i){throw i}},unlink:async r=>{const n=ci.relative(t.workdir,r);try{return await t.fs.rm(n,{recursive:!1})}catch(s){throw s}},stat:async r=>{try{const n=ci.relative(t.workdir,r),s=await t.fs.readdir(ci.dirname(n),{withFileTypes:!0}),i=ci.basename(n),o=s.find(a=>a.name==i);if(!o)throw new Error(`ENOENT: no such file or directory, stat '${r}'`);return{isFile:()=>o.isFile(),isDirectory:()=>o.isDirectory(),isSymbolicLink:()=>!1,size:1,mode:438,mtimeMs:Date.now(),uid:1e3,gid:1e3}}catch(n){console.log(n?.message);const s=new Error(`ENOENT: no such file or directory, stat '${r}'`);throw s.code="ENOENT",s.errno=-2,s.syscall="stat",s.path=r,s}},lstat:async r=>await LW(t,e).promises.stat(r),readlink:async r=>{throw new Error(`EINVAL: invalid argument, readlink '${r}'`)},symlink:async(r,n)=>{throw new Error(`EPERM: operation not permitted, symlink '${r}' -> '${n}'`)},chmod:async(r,n)=>await Promise.resolve()}}),ci={dirname:t=>!t||!t.includes("/")?".":(t=t.replace(/\/+$/,""),t.split("/").slice(0,-1).join("/")||"/"),basename:(t,e)=>{t=t.replace(/\/+$/,"");const r=t.split("/").pop()||"";return e&&r.endsWith(e)?r.slice(0,-e.length):r},relative:(t,e)=>{if(!t||!e)return".";const r=u=>u.replace(/\/+$/,"").split("/").filter(Boolean),n=r(t),s=r(e);let i=0;const o=Math.min(n.length,s.length);for(let u=0;u<o&&n[u]===s[u];u++)i++;const a=n.length-i,l=s.slice(i),c=[...Array(a).fill(".."),...l];return c.length===0?".":c.join("/")}},xje=({message:t="Cargando...",progress:e,progressText:r})=>T.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/80 z-50 backdrop-blur-sm",children:T.jsxs("div",{className:"relative flex flex-col items-center gap-4 p-8 rounded-lg bg-Terretacode-elements-background-depth-2 shadow-lg",children:[T.jsx("div",{className:"i-svg-spinners:90-ring-with-bg text-Terretacode-elements-loader-progress",style:{fontSize:"2rem"}}),T.jsx("p",{className:"text-lg text-Terretacode-elements-textTertiary",children:t}),e!==void 0&&T.jsxs("div",{className:"w-64 flex flex-col gap-2",children:[T.jsx("div",{className:"w-full h-2 bg-Terretacode-elements-background-depth-1 rounded-full overflow-hidden",children:T.jsx("div",{className:"h-full bg-Terretacode-elements-loader-progress transition-all duration-300 ease-out rounded-full",style:{width:`${Math.min(100,Math.max(0,e))}%`}})}),r&&T.jsx("p",{className:"text-sm text-Terretacode-elements-textTertiary text-center",children:r})]})]})}),Sje=["node_modules/**",".git/**",".github/**",".vscode/**","**/*.jpg","**/*.jpeg","**/*.png","dist/**","build/**",".next/**","coverage/**",".cache/**",".vscode/**",".idea/**","**/*.log","**/.DS_Store","**/npm-debug.log*","**/yarn-debug.log*","**/yarn-error.log*","**/*lock.json","**/*lock.yaml"],Tje=VA().add(Sje);function Cje({importChat:t}){const{ready:e,gitClone:r}=Eje(),[n,s]=I.useState(!1),i=async o=>{if(!e)return;const a=prompt("Enter the Git url");if(a){s(!0);try{const{workdir:l,data:c}=await r(a);if(t){const u=Object.keys(c).filter(p=>!Tje.ignores(p));console.log(u);const h=new TextDecoder("utf-8"),d=u.map(p=>{const{data:y,encoding:b}=c[p];return{path:p,content:b==="utf8"?y:y instanceof Uint8Array?h.decode(y):""}}).filter(p=>p.content),f=await sG(d),g=iG(f),m=[{role:"assistant",content:`Cloning the repo ${a} into ${l}
<TerretacodeArtifact id="imported-files" title="Git Cloned Files" type="bundled">
${d.map(p=>`<TerretacodeAction type="file" filePath="${p.path}">
${p.content}
</TerretacodeAction>`).join(`
`)}
</TerretacodeArtifact>`,id:dy(),createdAt:new Date}];g&&m.push(g),await t(`Git Project:${a.split("/").slice(-1)[0]}`,m)}}catch(l){console.error("Error during import:",l),Ne.error("Failed to import repository")}finally{s(!1)}}};return T.jsxs(T.Fragment,{children:[T.jsxs("button",{onClick:i,title:"Clonar Repositorio de Git",className:"px-4 py-2 rounded-lg border border-Terretacode-elements-borderColor bg-Terretacode-elements-prompt-background text-Terretacode-elements-textPrimary hover:bg-Terretacode-elements-background-depth-3 transition-all flex items-center gap-2",children:[T.jsx("span",{className:"i-ph:git-branch"}),"Clonar Repositorio de Git"]}),n&&T.jsx(xje,{message:"Please wait while we clone the repository..."})]})}const kje=({files:t,imageDataList:e,onRemove:r})=>!t||t.length===0?null:T.jsx("div",{className:"flex flex-row overflow-x-auto -mt-2",children:t.map((n,s)=>T.jsx("div",{className:"mr-2 relative",children:e[s]&&T.jsxs("div",{className:"relative pt-4 pr-4",children:[T.jsx("img",{src:e[s],alt:n.name,className:"max-h-20"}),T.jsx("button",{onClick:()=>r(s),className:"absolute top-1 right-1 z-10 bg-black rounded-full w-5 h-5 shadow-md hover:bg-gray-900 transition-colors flex items-center justify-center",children:T.jsx("div",{className:"i-ph:x w-3 h-3 text-gray-200"})})]})},n.name+n.size))}),Aje=({model:t,setModel:e,provider:r,setProvider:n,modelList:s,providerList:i,modelLoading:o})=>(I.useEffect(()=>{if(i.length!=0&&r&&!i.map(a=>a.name).includes(r.name)){const a=i[0];n?.(a);const l=s.find(c=>c.provider===a.name);l&&e?.(l.name)}},[i,r,n,s,e]),i.length===0?T.jsx("div",{className:"mb-2 p-4 rounded-lg border border-Terretacode-elements-borderColor bg-Terretacode-elements-prompt-background text-Terretacode-elements-textPrimary",children:T.jsx("p",{className:"text-center",children:"No providers are currently enabled. Please enable at least one provider in the settings to start using the chat."})}):T.jsxs("div",{className:"mb-2 flex gap-2 flex-col sm:flex-row",children:[T.jsx("select",{value:r?.name??"",onChange:a=>{const l=i.find(u=>u.name===a.target.value);l&&n&&n(l);const c=[...s].find(u=>u.provider===a.target.value);c&&e&&e(c.name)},className:"flex-1 p-2 rounded-lg border border-Terretacode-elements-borderColor bg-Terretacode-elements-prompt-background text-Terretacode-elements-textPrimary focus:outline-none focus:ring-2 focus:ring-Terretacode-elements-focus transition-all",children:i.map(a=>T.jsx("option",{value:a.name,children:a.name},a.name))}),T.jsx("select",{value:t,onChange:a=>e?.(a.target.value),className:"flex-1 p-2 rounded-lg border border-Terretacode-elements-borderColor bg-Terretacode-elements-prompt-background text-Terretacode-elements-textPrimary focus:outline-none focus:ring-2 focus:ring-Terretacode-elements-focus transition-all lg:max-w-[70%]",disabled:o==="all"||o===r?.name,children:o=="all"||o==r?.name?T.jsx("option",{value:"",children:"Cargando..."},0):[...s].filter(a=>a.provider==r?.name&&a.name).map((a,l)=>T.jsx("option",{value:a.name,children:a.label},l))},r?.name)]})),Rje=({isListening:t,onStart:e,onStop:r,disabled:n})=>T.jsx(cr,{title:t?"Stop listening":"Start speech recognition",disabled:n,className:qe("transition-all",{"text-Terretacode-elements-item-contentAccent":t}),onClick:t?r:e,children:t?T.jsx("div",{className:"i-ph:microphone-slash text-xl"}):T.jsx("div",{className:"i-ph:microphone text-xl"})}),Ije=({setUploadedFiles:t,setImageDataList:e,uploadedFiles:r,imageDataList:n})=>(I.useEffect(()=>(t&&e&&(window.__Terretacode_SET_UPLOADED_FILES__=t,window.__Terretacode_SET_IMAGE_DATA_LIST__=e,window.__Terretacode_UPLOADED_FILES__=r,window.__Terretacode_IMAGE_DATA_LIST__=n),()=>{delete window.__Terretacode_SET_UPLOADED_FILES__,delete window.__Terretacode_SET_IMAGE_DATA_LIST__,delete window.__Terretacode_UPLOADED_FILES__,delete window.__Terretacode_IMAGE_DATA_LIST__}),[t,e,r,n]),null),Pje=({template:t})=>T.jsx("a",{href:`/git?url=https://github.com/${t.githubRepo}.git`,"data-state":"closed","data-discover":"true",className:"items-center justify-center ",children:T.jsx("div",{className:`inline-block ${t.icon} w-8 h-8 text-4xl transition-theme opacity-25 hover:opacity-75 transition-all`})}),Oje=()=>T.jsxs("div",{className:"flex flex-col items-center gap-4",children:[T.jsx("span",{className:"text-sm text-gray-500",children:"o inicia una aplicación en blanco con tu stack favorito"}),T.jsx("div",{className:"flex justify-center",children:T.jsx("div",{className:"flex w-70 flex-wrap items-center justify-center gap-4",children:XC.map(t=>T.jsx(Pje,{template:t},t.name))})})]});function Dje({alert:t,clearAlert:e,postMessage:r}){const{description:n,content:s,source:i}=t,o=i==="preview",a=o?"Preview Error":"Terminal Error",l=o?"We encountered an error while running the preview. Would you like Terretacode to analyze and help resolve this issue?":"We encountered an error while running terminal commands. Would you like Terretacode to analyze and help resolve this issue?";return T.jsx(Zd,{children:T.jsx(yr.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"rounded-lg border border-Terretacode-elements-borderColor bg-Terretacode-elements-background-depth-2 p-4",children:T.jsxs("div",{className:"flex items-start",children:[T.jsx(yr.div,{className:"flex-shrink-0",initial:{scale:0},animate:{scale:1},transition:{delay:.2},children:T.jsx("div",{className:"i-ph:warning-duotone text-xl text-Terretacode-elements-button-danger-text"})}),T.jsxs("div",{className:"ml-3 flex-1",children:[T.jsx(yr.h3,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.1},className:"text-sm font-medium text-Terretacode-elements-textPrimary",children:a}),T.jsxs(yr.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"mt-2 text-sm text-Terretacode-elements-textSecondary",children:[T.jsx("p",{children:l}),n&&T.jsxs("div",{className:"text-xs text-Terretacode-elements-textSecondary p-2 bg-Terretacode-elements-background-depth-3 rounded mt-4 mb-4",children:["Error: ",n]})]}),T.jsx(yr.div,{className:"mt-4",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:T.jsxs("div",{className:qe(" flex gap-2"),children:[T.jsxs("button",{onClick:()=>r(`*Fix this ${o?"preview":"terminal"} error* 
\`\`\`${o?"js":"sh"}
${s}
\`\`\`
`),className:qe("px-2 py-1.5 rounded-md text-sm font-medium","bg-Terretacode-elements-button-primary-background","hover:bg-Terretacode-elements-button-primary-backgroundHover","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-Terretacode-elements-button-danger-background","text-Terretacode-elements-button-primary-text","flex items-center gap-1.5"),children:[T.jsx("div",{className:"i-ph:chat-circle-duotone"}),"Ask Terretacode"]}),T.jsx("button",{onClick:e,className:qe("px-2 py-1.5 rounded-md text-sm font-medium","bg-Terretacode-elements-button-secondary-background","hover:bg-Terretacode-elements-button-secondary-backgroundHover","focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-Terretacode-elements-button-secondary-background","text-Terretacode-elements-button-secondary-text"),children:"Dismiss"})]})})]})]})})})}const o3={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};var a3={};const Lje=76,Nje=at.forwardRef(({textareaRef:t,messageRef:e,scrollRef:r,showChat:n=!0,chatStarted:s=!1,isStreaming:i=!1,model:o,setModel:a,provider:l,setProvider:c,providerList:u,input:h="",enhancingPrompt:d,handleInputChange:f,enhancePrompt:g,sendMessage:_,handleStop:m,importChat:p,exportChat:y,uploadedFiles:b=[],setUploadedFiles:v,imageDataList:w=[],setImageDataList:E,messages:S,actionAlert:x,clearAlert:C},A)=>{const M=s?400:200,[P,D]=I.useState(uy()),[R,G]=I.useState(ux),[ee,q]=I.useState(!1),[re,N]=I.useState(!1),[B,$]=I.useState(null),[H,U]=I.useState(""),[Q,ne]=I.useState("all"),ge=I.useCallback(()=>{let L;try{const oe=Ke.get("providers");if(oe){const ie=JSON.parse(oe);typeof ie=="object"&&ie!==null&&(L=ie)}}catch(oe){console.error("Error loading Provider Settings from cookies:",oe),Ke.remove("providers")}return L},[]);I.useEffect(()=>{console.log(H)},[H]),I.useEffect(()=>{if(typeof window<"u"&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window)){const L=window.SpeechRecognition||window.webkitSpeechRecognition,oe=new L;oe.continuous=!0,oe.interimResults=!0,oe.onresult=ie=>{const W=Array.from(ie.results).map(K=>K[0]).map(K=>K.transcript).join("");U(W),f&&f({target:{value:W}})},oe.onerror=ie=>{console.error("Speech recognition error:",ie.error),N(!1)},$(oe)}},[]),I.useEffect(()=>{if(typeof window<"u"){const L=ge();let oe={};try{oe=uy(),D(oe)}catch(ie){console.error("Error loading API keys from cookies:",ie),Ke.remove("apiKeys")}ne("all"),Hde({apiKeys:oe,providerSettings:L}).then(ie=>{G(ie)}).catch(ie=>{console.error("Error initializing model list:",ie)}).finally(()=>{ne(void 0)})}},[u,l]);const J=async(L,oe)=>{const ie={...P,[L]:oe};D(ie),Ke.set("apiKeys",JSON.stringify(ie));const W=aa.getInstance(o3||a3||{}).getProvider(L);if(W&&W.getDynamicModels){ne(L);try{const K=ge(),ae=W.staticModels,xe=await W.getDynamicModels(ie,K,o3||a3||{});G(Te=>[...Te.filter(Se=>Se.provider!==L),...ae,...xe])}catch(K){console.error("Error loading dynamic models:",K)}ne(void 0)}},V=()=>{B&&(B.start(),N(!0))},fe=()=>{B&&(B.stop(),N(!1))},de=(L,oe)=>{_&&(_(L,oe),B&&(B.abort(),U(""),N(!1),f&&f({target:{value:""}})))},be=()=>{const L=document.createElement("input");L.type="file",L.accept="image/*",L.onchange=async oe=>{const ie=oe.target.files?.[0];if(ie){const W=new FileReader;W.onload=K=>{const ae=K.target?.result;v?.([...b,ie]),E?.([...w,ae])},W.readAsDataURL(ie)}},L.click()},me=async L=>{const oe=L.clipboardData?.items;if(oe){for(const ie of oe)if(ie.type.startsWith("image/")){L.preventDefault();const W=ie.getAsFile();if(W){const K=new FileReader;K.onload=ae=>{const xe=ae.target?.result;v?.([...b,W]),E?.([...w,xe])},K.readAsDataURL(W)}break}}},ve=T.jsxs("div",{ref:A,className:qe(Kh.BaseChat,"relative flex h-full w-full overflow-hidden"),"data-chat-visible":n,children:[T.jsx(Ji,{children:()=>T.jsx(Txe,{})}),T.jsxs("div",{ref:r,className:"flex flex-col lg:flex-row overflow-y-auto w-full h-full",children:[T.jsxs("div",{className:qe(Kh.Chat,"flex flex-col flex-grow lg:min-w-[var(--chat-min-width)] h-full"),children:[!s&&T.jsxs("div",{id:"intro",className:"mt-[16vh] max-w-chat mx-auto text-center px-4 lg:px-0",children:[T.jsx("h1",{className:"text-3xl lg:text-6xl font-bold text-Terretacode-elements-textPrimary mb-4 animate-fade-in",children:"Crea tus propias ideas"}),T.jsx("p",{className:"text-md lg:text-xl mb-8 text-Terretacode-elements-textSecondary animate-fade-in animation-delay-200",children:"Haga realidad sus ideas en segundos u obtenga ayuda en proyectos existentes con Terretacode."})]}),T.jsxs("div",{className:qe("pt-6 px-2 sm:px-6",{"h-full flex flex-col":s}),children:[T.jsx(Ji,{children:()=>s?T.jsx(j3e,{ref:e,className:"flex flex-col w-full flex-1 max-w-chat pb-6 mx-auto z-1",messages:S,isStreaming:i}):null}),T.jsxs("div",{className:qe("flex flex-col gap-4 w-full max-w-chat mx-auto z-prompt mb-6",{"sticky bottom-2":s}),children:[T.jsx("div",{className:"bg-Terretacode-elements-background-depth-2",children:x&&T.jsx(Dje,{alert:x,clearAlert:()=>C?.(),postMessage:L=>{_?.({},L),C?.()}})}),T.jsxs("div",{className:qe("bg-Terretacode-elements-background-depth-2 p-3 rounded-lg border border-Terretacode-elements-borderColor relative w-full max-w-chat mx-auto z-prompt"),children:[T.jsxs("svg",{className:qe(Kh.PromptEffectContainer),children:[T.jsxs("defs",{children:[T.jsxs("linearGradient",{id:"line-gradient",x1:"20%",y1:"0%",x2:"-14%",y2:"10%",gradientUnits:"userSpaceOnUse",gradientTransform:"rotate(-45)",children:[T.jsx("stop",{offset:"0%",stopColor:"#b44aff",stopOpacity:"0%"}),T.jsx("stop",{offset:"40%",stopColor:"#b44aff",stopOpacity:"80%"}),T.jsx("stop",{offset:"50%",stopColor:"#b44aff",stopOpacity:"80%"}),T.jsx("stop",{offset:"100%",stopColor:"#b44aff",stopOpacity:"0%"})]}),T.jsxs("linearGradient",{id:"shine-gradient",children:[T.jsx("stop",{offset:"0%",stopColor:"white",stopOpacity:"0%"}),T.jsx("stop",{offset:"40%",stopColor:"#ffffff",stopOpacity:"80%"}),T.jsx("stop",{offset:"50%",stopColor:"#ffffff",stopOpacity:"80%"}),T.jsx("stop",{offset:"100%",stopColor:"white",stopOpacity:"0%"})]})]}),T.jsx("rect",{className:qe(Kh.PromptEffectLine),pathLength:"100",strokeLinecap:"round"}),T.jsx("rect",{className:qe(Kh.PromptShine),x:"48",y:"24",width:"70",height:"1"})]}),T.jsx("div",{children:T.jsx(Ji,{children:()=>T.jsxs("div",{className:ee?"hidden":"",children:[T.jsx(Aje,{model:o,setModel:a,modelList:R,provider:l,setProvider:c,providerList:u||sb,apiKeys:P,modelLoading:Q},l?.name+":"+R.length),(u||[]).length>0&&l&&T.jsx(H3e,{provider:l,apiKey:P[l.name]||"",setApiKey:L=>{J(l.name,L)}})]})})}),T.jsx(kje,{files:b,imageDataList:w,onRemove:L=>{v?.(b.filter((oe,ie)=>ie!==L)),E?.(w.filter((oe,ie)=>ie!==L))}}),T.jsx(Ji,{children:()=>T.jsx(Ije,{setUploadedFiles:v,setImageDataList:E,uploadedFiles:b,imageDataList:w})}),T.jsxs("div",{className:qe("relative shadow-xs border border-Terretacode-elements-borderColor backdrop-blur rounded-lg"),children:[T.jsx("textarea",{ref:t,className:qe("w-full pl-4 pt-4 pr-16 outline-none resize-none text-Terretacode-elements-textPrimary placeholder-Terretacode-elements-textTertiary bg-transparent text-sm","transition-all duration-200","hover:border-Terretacode-elements-focus"),onDragEnter:L=>{L.preventDefault(),L.currentTarget.style.border="2px solid #1488fc"},onDragOver:L=>{L.preventDefault(),L.currentTarget.style.border="2px solid #1488fc"},onDragLeave:L=>{L.preventDefault(),L.currentTarget.style.border="1px solid var(--Terretacode-elements-borderColor)"},onDrop:L=>{L.preventDefault(),L.currentTarget.style.border="1px solid var(--Terretacode-elements-borderColor)",Array.from(L.dataTransfer.files).forEach(ie=>{if(ie.type.startsWith("image/")){const W=new FileReader;W.onload=K=>{const ae=K.target?.result;v?.([...b,ie]),E?.([...w,ae])},W.readAsDataURL(ie)}})},onKeyDown:L=>{if(L.key==="Enter"){if(L.shiftKey)return;if(L.preventDefault(),i){m?.();return}if(L.nativeEvent.isComposing)return;de?.(L)}},value:h,onChange:L=>{f?.(L)},onPaste:me,style:{minHeight:Lje,maxHeight:M},placeholder:"¿Como puede ayudarte Terretacode hoy??",translate:"no"}),T.jsx(Ji,{children:()=>T.jsx($3e,{show:h.length>0||i||b.length>0,isStreaming:i,disabled:!u||u.length===0,onClick:L=>{if(i){m?.();return}(h.length>0||b.length>0)&&de?.(L)}})}),T.jsxs("div",{className:"flex justify-between items-center text-sm p-4 pt-2",children:[T.jsxs("div",{className:"flex gap-1 items-center",children:[T.jsx(cr,{title:"Upload file",className:"transition-all",onClick:()=>be(),children:T.jsx("div",{className:"i-ph:paperclip text-xl"})}),T.jsx(cr,{title:"Enhance prompt",disabled:h.length===0||d,className:qe("transition-all",d?"opacity-100":""),onClick:()=>{g?.(),Ne.success("Prompt enhanced!")},children:d?T.jsx("div",{className:"i-svg-spinners:90-ring-with-bg text-Terretacode-elements-loader-progress text-xl animate-spin"}):T.jsx("div",{className:"i-Terretacode:stars text-xl"})}),T.jsx(Rje,{isListening:re,onStart:V,onStop:fe,disabled:i}),s&&T.jsx(Ji,{children:()=>T.jsx(K3e,{exportChat:y})}),T.jsxs(cr,{title:"Model Settings",className:qe("transition-all flex items-center gap-1",{"bg-Terretacode-elements-item-backgroundAccent text-Terretacode-elements-item-contentAccent":ee,"bg-Terretacode-elements-item-backgroundDefault text-Terretacode-elements-item-contentDefault":!ee}),onClick:()=>q(!ee),disabled:!u||u.length===0,children:[T.jsx("div",{className:`i-ph:caret-${ee?"right":"down"} text-lg`}),ee?T.jsx("span",{className:"text-xs",children:o}):T.jsx("span",{})]})]}),h.length>3?T.jsxs("div",{className:"text-xs text-Terretacode-elements-textTertiary",children:["Use"," ",T.jsx("kbd",{className:"kdb px-1.5 py-0.5 rounded bg-Terretacode-elements-background-depth-2",children:"Shift"})," ","+"," ",T.jsx("kbd",{className:"kdb px-1.5 py-0.5 rounded bg-Terretacode-elements-background-depth-2",children:"Return"})," ","a new line"]}):null]})]})]})]})]}),T.jsxs("div",{className:"flex flex-col justify-center gap-5",children:[!s&&T.jsxs("div",{className:"flex justify-center gap-2",children:[wBe(p),T.jsx(Cje,{importChat:p})]}),!s&&xBe((L,oe)=>{if(i){m?.();return}de?.(L,oe)}),!s&&T.jsx(Oje,{})]})]}),T.jsx(Ji,{children:()=>T.jsx(eOe,{chatStarted:s,isStreaming:i})})]})]});return T.jsx(V1e,{delayDuration:200,children:ve})});var NW="vercel.ai.error",Mje=Symbol.for(NW),MW,Bje=class BW extends Error{constructor({name:e,message:r,cause:n}){super(r),this[MW]=!0,this.name=e,this.cause=n}static isInstance(e){return BW.hasMarker(e,NW)}static hasMarker(e,r){const n=Symbol.for(r);return e!=null&&typeof e=="object"&&n in e&&typeof e[n]=="boolean"&&e[n]===!0}};MW=Mje;var Ku=Bje;function FW(t){return t==null?"unknown error":typeof t=="string"?t:t instanceof Error?t.message:JSON.stringify(t)}var jW="AI_InvalidArgumentError",UW=`vercel.ai.error.${jW}`,Fje=Symbol.for(UW),$W,jje=class extends Ku{constructor({message:t,cause:e,argument:r}){super({name:jW,message:t,cause:e}),this[$W]=!0,this.argument=r}static isInstance(t){return Ku.hasMarker(t,UW)}};$W=Fje;var HW="AI_JSONParseError",zW=`vercel.ai.error.${HW}`,Uje=Symbol.for(zW),VW,l3=class extends Ku{constructor({text:t,cause:e}){super({name:HW,message:`JSON parsing failed: Text: ${t}.
Error message: ${FW(e)}`,cause:e}),this[VW]=!0,this.text=t}static isInstance(t){return Ku.hasMarker(t,zW)}};VW=Uje;var GW="AI_TypeValidationError",WW=`vercel.ai.error.${GW}`,$je=Symbol.for(WW),qW,Hje=class pT extends Ku{constructor({value:e,cause:r}){super({name:GW,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${FW(r)}`,cause:r}),this[qW]=!0,this.value=e}static isInstance(e){return Ku.hasMarker(e,WW)}static wrap({value:e,cause:r}){return pT.isInstance(r)&&r.value===e?r:new pT({value:e,cause:r})}};qW=$je;var c3=Hje;function N9e(t){return new ReadableStream({async pull(e){try{const{value:r,done:n}=await t.next();n?e.close():e.enqueue(r)}catch(r){e.error(r)}},cancel(){}})}var zje=({prefix:t,size:e=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:n="-"}={})=>{const s=EC(r,e);if(t==null)return s;if(r.includes(n))throw new jje({argument:"separator",message:`The separator "${n}" must not be part of the alphabet "${r}".`});return i=>`${t}${n}${s(i)}`},KW=zje(),Cy=Symbol.for("vercel.ai.validator");function Vje(t){return{[Cy]:!0,validate:t}}function Gje(t){return typeof t=="object"&&t!==null&&Cy in t&&t[Cy]===!0&&"validate"in t}function Wje(t){return Gje(t)?t:qje(t)}function qje(t){return Vje(e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}})}function Kje({value:t,schema:e}){const r=Wje(e);try{if(r.validate==null)return{success:!0,value:t};const n=r.validate(t);return n.success?n:{success:!1,error:c3.wrap({value:t,cause:n.error})}}catch(n){return{success:!1,error:c3.wrap({value:t,cause:n})}}}function u3({text:t,schema:e}){try{const r=Ws.parse(t);return e==null?{success:!0,value:r}:Kje({value:r,schema:e})}catch(r){return{success:!1,error:l3.isInstance(r)?r:new l3({text:t,cause:r})}}}const Yje=Symbol("Let zodToJsonSchema decide on which parser to use"),Xje={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},Zje=t=>({...Xje,...t}),Jje=t=>{const e=Zje(t),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([n,s])=>[s._def,{def:s._def,path:[...e.basePath,e.definitionPath,n],jsonSchema:void 0}]))}};function YW(t,e,r,n){n?.errorMessages&&r&&(t.errorMessage={...t.errorMessage,[e]:r})}function Nt(t,e,r,n,s){t[e]=r,YW(t,e,n,s)}function Qje(){return{}}function eUe(t,e){const r={type:"array"};return t.type?._def&&t.type?._def?.typeName!==Fe.ZodAny&&(r.items=Pt(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&Nt(r,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&Nt(r,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(Nt(r,"minItems",t.exactLength.value,t.exactLength.message,e),Nt(r,"maxItems",t.exactLength.value,t.exactLength.message,e)),r}function tUe(t,e){const r={type:"integer",format:"int64"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"min":e.target==="jsonSchema7"?n.inclusive?Nt(r,"minimum",n.value,n.message,e):Nt(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),Nt(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?Nt(r,"maximum",n.value,n.message,e):Nt(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),Nt(r,"maximum",n.value,n.message,e));break;case"multipleOf":Nt(r,"multipleOf",n.value,n.message,e);break}return r}function rUe(){return{type:"boolean"}}function XW(t,e){return Pt(t.type._def,e)}const nUe=(t,e)=>Pt(t.innerType._def,e);function ZW(t,e,r){const n=r??e.dateStrategy;if(Array.isArray(n))return{anyOf:n.map((s,i)=>ZW(t,e,s))};switch(n){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return sUe(t,e)}}const sUe=(t,e)=>{const r={type:"integer",format:"unix-time"};if(e.target==="openApi3")return r;for(const n of t.checks)switch(n.kind){case"min":Nt(r,"minimum",n.value,n.message,e);break;case"max":Nt(r,"maximum",n.value,n.message,e);break}return r};function iUe(t,e){return{...Pt(t.innerType._def,e),default:t.defaultValue()}}function oUe(t,e){return e.effectStrategy==="input"?Pt(t.schema._def,e):{}}function aUe(t){return{type:"string",enum:t.values}}const lUe=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function cUe(t,e){const r=[Pt(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Pt(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(i=>!!i);let n=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return r.forEach(i=>{if(lUe(i))s.push(...i.allOf),i.unevaluatedProperties===void 0&&(n=void 0);else{let o=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:a,...l}=i;o=l}else n=void 0;s.push(o)}}),s.length?{allOf:s,...n}:void 0}function uUe(t,e){const r=typeof t.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[t.value]}:{type:r==="bigint"?"integer":r,const:t.value}}let j1;const el={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(j1===void 0&&(j1=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),j1),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function JW(t,e){const r={type:"string"};function n(s){return e.patternStrategy==="escape"?hUe(s):s}if(t.checks)for(const s of t.checks)switch(s.kind){case"min":Nt(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,s.value):s.value,s.message,e);break;case"max":Nt(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,s.value):s.value,s.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Is(r,"email",s.message,e);break;case"format:idn-email":Is(r,"idn-email",s.message,e);break;case"pattern:zod":Ps(r,el.email,s.message,e);break}break;case"url":Is(r,"uri",s.message,e);break;case"uuid":Is(r,"uuid",s.message,e);break;case"regex":Ps(r,s.regex,s.message,e);break;case"cuid":Ps(r,el.cuid,s.message,e);break;case"cuid2":Ps(r,el.cuid2,s.message,e);break;case"startsWith":Ps(r,RegExp(`^${n(s.value)}`),s.message,e);break;case"endsWith":Ps(r,RegExp(`${n(s.value)}$`),s.message,e);break;case"datetime":Is(r,"date-time",s.message,e);break;case"date":Is(r,"date",s.message,e);break;case"time":Is(r,"time",s.message,e);break;case"duration":Is(r,"duration",s.message,e);break;case"length":Nt(r,"minLength",typeof r.minLength=="number"?Math.max(r.minLength,s.value):s.value,s.message,e),Nt(r,"maxLength",typeof r.maxLength=="number"?Math.min(r.maxLength,s.value):s.value,s.message,e);break;case"includes":{Ps(r,RegExp(n(s.value)),s.message,e);break}case"ip":{s.version!=="v6"&&Is(r,"ipv4",s.message,e),s.version!=="v4"&&Is(r,"ipv6",s.message,e);break}case"emoji":Ps(r,el.emoji,s.message,e);break;case"ulid":{Ps(r,el.ulid,s.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Is(r,"binary",s.message,e);break}case"contentEncoding:base64":{Nt(r,"contentEncoding","base64",s.message,e);break}case"pattern:zod":{Ps(r,el.base64,s.message,e);break}}break}case"nanoid":Ps(r,el.nanoid,s.message,e)}return r}const hUe=t=>Array.from(t).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),Is=(t,e,r,n)=>{t.format||t.anyOf?.some(s=>s.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&n.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...r&&n.errorMessages&&{errorMessage:{format:r}}})):Nt(t,"format",e,r,n)},Ps=(t,e,r,n)=>{t.pattern||t.allOf?.some(s=>s.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&n.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:h3(e,n),...r&&n.errorMessages&&{errorMessage:{pattern:r}}})):Nt(t,"pattern",h3(e,n),r,n)},h3=(t,e)=>{const r=typeof t=="function"?t():t;if(!e.applyRegexFlags||!r.flags)return r.source;const n={i:r.flags.includes("i"),m:r.flags.includes("m"),s:r.flags.includes("s")},s=n.i?r.source.toLowerCase():r.source;let i="",o=!1,a=!1,l=!1;for(let c=0;c<s.length;c++){if(o){i+=s[c],o=!1;continue}if(n.i){if(a){if(s[c].match(/[a-z]/)){l?(i+=s[c],i+=`${s[c-2]}-${s[c]}`.toUpperCase(),l=!1):s[c+1]==="-"&&s[c+2]?.match(/[a-z]/)?(i+=s[c],l=!0):i+=`${s[c]}${s[c].toUpperCase()}`;continue}}else if(s[c].match(/[a-z]/)){i+=`[${s[c]}${s[c].toUpperCase()}]`;continue}}if(n.m){if(s[c]==="^"){i+=`(^|(?<=[\r
]))`;continue}else if(s[c]==="$"){i+=`($|(?=[\r
]))`;continue}}if(n.s&&s[c]==="."){i+=a?`${s[c]}\r
`:`[${s[c]}\r
]`;continue}i+=s[c],s[c]==="\\"?o=!0:a&&s[c]==="]"?a=!1:!a&&s[c]==="["&&(a=!0)}try{const c=new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),r.source}return i};function QW(t,e){if(e.target==="openApi3"&&t.keyType?._def.typeName===Fe.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((n,s)=>({...n,[s]:Pt(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",s]})??{}}),{}),additionalProperties:!1};const r={type:"object",additionalProperties:Pt(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return r;if(t.keyType?._def.typeName===Fe.ZodString&&t.keyType._def.checks?.length){const{type:n,...s}=JW(t.keyType._def,e);return{...r,propertyNames:s}}else{if(t.keyType?._def.typeName===Fe.ZodEnum)return{...r,propertyNames:{enum:t.keyType._def.values}};if(t.keyType?._def.typeName===Fe.ZodBranded&&t.keyType._def.type._def.typeName===Fe.ZodString&&t.keyType._def.type._def.checks?.length){const{type:n,...s}=XW(t.keyType._def,e);return{...r,propertyNames:s}}}return r}function dUe(t,e){if(e.mapStrategy==="record")return QW(t,e);const r=Pt(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},n=Pt(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[r,n],minItems:2,maxItems:2}}}function fUe(t){const e=t.values,n=Object.keys(t.values).filter(i=>typeof e[e[i]]!="number").map(i=>e[i]),s=Array.from(new Set(n.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:n}}function pUe(){return{not:{}}}function mUe(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const ky={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function gUe(t,e){if(e.target==="openApi3")return d3(t,e);const r=t.options instanceof Map?Array.from(t.options.values()):t.options;if(r.every(n=>n._def.typeName in ky&&(!n._def.checks||!n._def.checks.length))){const n=r.reduce((s,i)=>{const o=ky[i._def.typeName];return o&&!s.includes(o)?[...s,o]:s},[]);return{type:n.length>1?n:n[0]}}else if(r.every(n=>n._def.typeName==="ZodLiteral"&&!n.description)){const n=r.reduce((s,i)=>{const o=typeof i._def.value;switch(o){case"string":case"number":case"boolean":return[...s,o];case"bigint":return[...s,"integer"];case"object":if(i._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(n.length===r.length){const s=n.filter((i,o,a)=>a.indexOf(i)===o);return{type:s.length>1?s:s[0],enum:r.reduce((i,o)=>i.includes(o._def.value)?i:[...i,o._def.value],[])}}}else if(r.every(n=>n._def.typeName==="ZodEnum"))return{type:"string",enum:r.reduce((n,s)=>[...n,...s._def.values.filter(i=>!n.includes(i))],[])};return d3(t,e)}const d3=(t,e)=>{const r=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((n,s)=>Pt(n._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(n=>!!n&&(!e.strictUnions||typeof n=="object"&&Object.keys(n).length>0));return r.length?{anyOf:r}:void 0};function _Ue(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:ky[t.innerType._def.typeName],nullable:!0}:{type:[ky[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const n=Pt(t.innerType._def,{...e,currentPath:[...e.currentPath]});return n&&"$ref"in n?{allOf:[n],nullable:!0}:n&&{...n,nullable:!0}}const r=Pt(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return r&&{anyOf:[r,{type:"null"}]}}function yUe(t,e){const r={type:"number"};if(!t.checks)return r;for(const n of t.checks)switch(n.kind){case"int":r.type="integer",YW(r,"type",n.message,e);break;case"min":e.target==="jsonSchema7"?n.inclusive?Nt(r,"minimum",n.value,n.message,e):Nt(r,"exclusiveMinimum",n.value,n.message,e):(n.inclusive||(r.exclusiveMinimum=!0),Nt(r,"minimum",n.value,n.message,e));break;case"max":e.target==="jsonSchema7"?n.inclusive?Nt(r,"maximum",n.value,n.message,e):Nt(r,"exclusiveMaximum",n.value,n.message,e):(n.inclusive||(r.exclusiveMaximum=!0),Nt(r,"maximum",n.value,n.message,e));break;case"multipleOf":Nt(r,"multipleOf",n.value,n.message,e);break}return r}function bUe(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":Pt(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":Pt(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function vUe(t,e){const r={type:"object",...Object.entries(t.shape()).reduce((n,[s,i])=>{if(i===void 0||i._def===void 0)return n;const o=Pt(i._def,{...e,currentPath:[...e.currentPath,"properties",s],propertyPath:[...e.currentPath,"properties",s]});return o===void 0?n:{properties:{...n.properties,[s]:o},required:i.isOptional()?n.required:[...n.required,s]}},{properties:{},required:[]}),additionalProperties:bUe(t,e)};return r.required.length||delete r.required,r}const wUe=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return Pt(t.innerType._def,e);const r=Pt(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return r?{anyOf:[{not:{}},r]}:{}},EUe=(t,e)=>{if(e.pipeStrategy==="input")return Pt(t.in._def,e);if(e.pipeStrategy==="output")return Pt(t.out._def,e);const r=Pt(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),n=Pt(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",r?"1":"0"]});return{allOf:[r,n].filter(s=>s!==void 0)}};function xUe(t,e){return Pt(t.type._def,e)}function SUe(t,e){const n={type:"array",uniqueItems:!0,items:Pt(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&Nt(n,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&Nt(n,"maxItems",t.maxSize.value,t.maxSize.message,e),n}function TUe(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((r,n)=>Pt(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[]),additionalItems:Pt(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((r,n)=>Pt(r._def,{...e,currentPath:[...e.currentPath,"items",`${n}`]})).reduce((r,n)=>n===void 0?r:[...r,n],[])}}function CUe(){return{not:{}}}function kUe(){return{}}const AUe=(t,e)=>Pt(t.innerType._def,e);function Pt(t,e,r=!1){const n=e.seen.get(t);if(e.override){const o=e.override?.(t,e,n,r);if(o!==Yje)return o}if(n&&!r){const o=RUe(n,e);if(o!==void 0)return o}const s={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,s);const i=PUe(t,t.typeName,e);return i&&OUe(t,e,i),s.jsonSchema=i,i}const RUe=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:IUe(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((r,n)=>e.currentPath[n]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},IUe=(t,e)=>{let r=0;for(;r<t.length&&r<e.length&&t[r]===e[r];r++);return[(t.length-r).toString(),...e.slice(r)].join("/")},PUe=(t,e,r)=>{switch(e){case Fe.ZodString:return JW(t,r);case Fe.ZodNumber:return yUe(t,r);case Fe.ZodObject:return vUe(t,r);case Fe.ZodBigInt:return tUe(t,r);case Fe.ZodBoolean:return rUe();case Fe.ZodDate:return ZW(t,r);case Fe.ZodUndefined:return CUe();case Fe.ZodNull:return mUe(r);case Fe.ZodArray:return eUe(t,r);case Fe.ZodUnion:case Fe.ZodDiscriminatedUnion:return gUe(t,r);case Fe.ZodIntersection:return cUe(t,r);case Fe.ZodTuple:return TUe(t,r);case Fe.ZodRecord:return QW(t,r);case Fe.ZodLiteral:return uUe(t,r);case Fe.ZodEnum:return aUe(t);case Fe.ZodNativeEnum:return fUe(t);case Fe.ZodNullable:return _Ue(t,r);case Fe.ZodOptional:return wUe(t,r);case Fe.ZodMap:return dUe(t,r);case Fe.ZodSet:return SUe(t,r);case Fe.ZodLazy:return Pt(t.getter()._def,r);case Fe.ZodPromise:return xUe(t,r);case Fe.ZodNaN:case Fe.ZodNever:return pUe();case Fe.ZodEffects:return oUe(t,r);case Fe.ZodAny:return Qje();case Fe.ZodUnknown:return kUe();case Fe.ZodDefault:return iUe(t,r);case Fe.ZodBranded:return XW(t,r);case Fe.ZodReadonly:return AUe(t,r);case Fe.ZodCatch:return nUe(t,r);case Fe.ZodPipeline:return EUe(t,r);case Fe.ZodFunction:case Fe.ZodVoid:case Fe.ZodSymbol:return;default:return(n=>{})()}},OUe=(t,e,r)=>(t.description&&(r.description=t.description,e.markdownDescription&&(r.markdownDescription=t.description)),r),DUe=(t,e)=>{const r=Jje(e),n=void 0,s=e?.name,i=Pt(t._def,r,!1)??{},o=s===void 0?n?{...i,[r.definitionPath]:n}:i:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,s].join("/"),[r.definitionPath]:{...n,[s]:i}};return r.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":r.target==="jsonSchema2019-09"&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};var rp={code:"0",name:"text",parse:t=>{if(typeof t!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:t}}},np={code:"3",name:"error",parse:t=>{if(typeof t!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:t}}},sp={code:"4",name:"assistant_message",parse:t=>{if(t==null||typeof t!="object"||!("id"in t)||!("role"in t)||!("content"in t)||typeof t.id!="string"||typeof t.role!="string"||t.role!=="assistant"||!Array.isArray(t.content)||!t.content.every(e=>e!=null&&typeof e=="object"&&"type"in e&&e.type==="text"&&"text"in e&&e.text!=null&&typeof e.text=="object"&&"value"in e.text&&typeof e.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:t}}},ip={code:"5",name:"assistant_control_data",parse:t=>{if(t==null||typeof t!="object"||!("threadId"in t)||!("messageId"in t)||typeof t.threadId!="string"||typeof t.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:t.threadId,messageId:t.messageId}}}},op={code:"6",name:"data_message",parse:t=>{if(t==null||typeof t!="object"||!("role"in t)||!("data"in t)||typeof t.role!="string"||t.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:t}}},LUe=[rp,np,sp,ip,op];rp.code+"",np.code+"",sp.code+"",ip.code+"",op.code+"";rp.name+"",rp.code,np.name+"",np.code,sp.name+"",sp.code,ip.name+"",ip.code,op.name+"",op.code;LUe.map(t=>t.code);function NUe(t){const e=["ROOT"];let r=-1,n=null;function s(l,c,u){switch(l){case'"':{r=c,e.pop(),e.push(u),e.push("INSIDE_STRING");break}case"f":case"t":case"n":{r=c,n=c,e.pop(),e.push(u),e.push("INSIDE_LITERAL");break}case"-":{e.pop(),e.push(u),e.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{r=c,e.pop(),e.push(u),e.push("INSIDE_NUMBER");break}case"{":{r=c,e.pop(),e.push(u),e.push("INSIDE_OBJECT_START");break}case"[":{r=c,e.pop(),e.push(u),e.push("INSIDE_ARRAY_START");break}}}function i(l,c){switch(l){case",":{e.pop(),e.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{r=c,e.pop();break}}}function o(l,c){switch(l){case",":{e.pop(),e.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{r=c,e.pop();break}}}for(let l=0;l<t.length;l++){const c=t[l];switch(e[e.length-1]){case"ROOT":s(c,l,"FINISH");break;case"INSIDE_OBJECT_START":{switch(c){case'"':{e.pop(),e.push("INSIDE_OBJECT_KEY");break}case"}":{r=l,e.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(c){case'"':{e.pop(),e.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(c){case'"':{e.pop(),e.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(c){case":":{e.pop(),e.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{s(c,l,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{i(c,l);break}case"INSIDE_STRING":{switch(c){case'"':{e.pop(),r=l;break}case"\\":{e.push("INSIDE_STRING_ESCAPE");break}default:r=l}break}case"INSIDE_ARRAY_START":{switch(c){case"]":{r=l,e.pop();break}default:{r=l,s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(c){case",":{e.pop(),e.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{r=l,e.pop();break}default:{r=l;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{e.pop(),r=l;break}case"INSIDE_NUMBER":{switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{r=l;break}case"e":case"E":case"-":case".":break;case",":{e.pop(),e[e.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&o(c,l),e[e.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"}":{e.pop(),e[e.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"]":{e.pop(),e[e.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&o(c,l);break}default:{e.pop();break}}break}case"INSIDE_LITERAL":{const h=t.substring(n,l+1);!"false".startsWith(h)&&!"true".startsWith(h)&&!"null".startsWith(h)?(e.pop(),e[e.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?i(c,l):e[e.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&o(c,l)):r=l;break}}}let a=t.slice(0,r+1);for(let l=e.length-1;l>=0;l--)switch(e[l]){case"INSIDE_STRING":{a+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{a+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{a+="]";break}case"INSIDE_LITERAL":{const u=t.substring(n,t.length);"true".startsWith(u)?a+="true".slice(u.length):"false".startsWith(u)?a+="false".slice(u.length):"null".startsWith(u)&&(a+="null".slice(u.length))}}return a}function MUe(t){if(t===void 0)return{value:void 0,state:"undefined-input"};let e=u3({text:t});return e.success?{value:e.value,state:"successful-parse"}:(e=u3({text:NUe(t)}),e.success?{value:e.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var ap={code:"0",name:"text",parse:t=>{if(typeof t!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:t}}},lp={code:"2",name:"data",parse:t=>{if(!Array.isArray(t))throw new Error('"data" parts expect an array value.');return{type:"data",value:t}}},cp={code:"3",name:"error",parse:t=>{if(typeof t!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:t}}},up={code:"8",name:"message_annotations",parse:t=>{if(!Array.isArray(t))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:t}}},hp={code:"9",name:"tool_call",parse:t=>{if(t==null||typeof t!="object"||!("toolCallId"in t)||typeof t.toolCallId!="string"||!("toolName"in t)||typeof t.toolName!="string"||!("args"in t)||typeof t.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:t}}},dp={code:"a",name:"tool_result",parse:t=>{if(t==null||typeof t!="object"||!("toolCallId"in t)||typeof t.toolCallId!="string"||!("result"in t))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:t}}},fp={code:"b",name:"tool_call_streaming_start",parse:t=>{if(t==null||typeof t!="object"||!("toolCallId"in t)||typeof t.toolCallId!="string"||!("toolName"in t)||typeof t.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:t}}},pp={code:"c",name:"tool_call_delta",parse:t=>{if(t==null||typeof t!="object"||!("toolCallId"in t)||typeof t.toolCallId!="string"||!("argsTextDelta"in t)||typeof t.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:t}}},mp={code:"d",name:"finish_message",parse:t=>{if(t==null||typeof t!="object"||!("finishReason"in t)||typeof t.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const e={finishReason:t.finishReason};return"usage"in t&&t.usage!=null&&typeof t.usage=="object"&&"promptTokens"in t.usage&&"completionTokens"in t.usage&&(e.usage={promptTokens:typeof t.usage.promptTokens=="number"?t.usage.promptTokens:Number.NaN,completionTokens:typeof t.usage.completionTokens=="number"?t.usage.completionTokens:Number.NaN}),{type:"finish_message",value:e}}},gp={code:"e",name:"finish_step",parse:t=>{if(t==null||typeof t!="object"||!("finishReason"in t)||typeof t.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const e={finishReason:t.finishReason,isContinued:!1};return"usage"in t&&t.usage!=null&&typeof t.usage=="object"&&"promptTokens"in t.usage&&"completionTokens"in t.usage&&(e.usage={promptTokens:typeof t.usage.promptTokens=="number"?t.usage.promptTokens:Number.NaN,completionTokens:typeof t.usage.completionTokens=="number"?t.usage.completionTokens:Number.NaN}),"isContinued"in t&&typeof t.isContinued=="boolean"&&(e.isContinued=t.isContinued),{type:"finish_step",value:e}}},eq=[ap,lp,cp,up,hp,dp,fp,pp,mp,gp],BUe={[ap.code]:ap,[lp.code]:lp,[cp.code]:cp,[up.code]:up,[hp.code]:hp,[dp.code]:dp,[fp.code]:fp,[pp.code]:pp,[mp.code]:mp,[gp.code]:gp};ap.name+"",ap.code,lp.name+"",lp.code,cp.name+"",cp.code,up.name+"",up.code,hp.name+"",hp.code,dp.name+"",dp.code,fp.name+"",fp.code,pp.name+"",pp.code,mp.name+"",mp.code,gp.name+"",gp.code;var FUe=eq.map(t=>t.code),jUe=t=>{const e=t.indexOf(":");if(e===-1)throw new Error("Failed to parse stream string. No separator found.");const r=t.slice(0,e);if(!FUe.includes(r))throw new Error(`Failed to parse stream string. Invalid code ${r}.`);const n=r,s=t.slice(e+1),i=JSON.parse(s);return BUe[n].parse(i)};function M9e(t,e){const r=eq.find(n=>n.name===t);if(!r)throw new Error(`Invalid stream part type: ${t}`);return`${r.code}:${JSON.stringify(e)}
`}var UUe=10;function $Ue(t,e){const r=new Uint8Array(e);let n=0;for(const s of t)r.set(s,n),n+=s.length;return t.length=0,r}async function HUe({stream:t,onTextPart:e,onDataPart:r,onErrorPart:n,onToolCallStreamingStartPart:s,onToolCallDeltaPart:i,onToolCallPart:o,onToolResultPart:a,onMessageAnnotationsPart:l,onFinishMessagePart:c,onFinishStepPart:u}){const h=t.getReader(),d=new TextDecoder,f=[];let g=0;for(;;){const{value:_}=await h.read();if(_&&(f.push(_),g+=_.length,_[_.length-1]!==UUe))continue;if(f.length===0)break;const m=$Ue(f,g);g=0;const p=d.decode(m,{stream:!0}).split(`
`).filter(y=>y!=="").map(jUe);for(const{type:y,value:b}of p)switch(y){case"text":await e?.(b);break;case"data":await r?.(b);break;case"error":await n?.(b);break;case"message_annotations":await l?.(b);break;case"tool_call_streaming_start":await s?.(b);break;case"tool_call_delta":await i?.(b);break;case"tool_call":await o?.(b);break;case"tool_result":await a?.(b);break;case"finish_message":await c?.(b);break;case"finish_step":await u?.(b);break;default:{const v=y;throw new Error(`Unknown stream part type: ${v}`)}}}}function zUe({promptTokens:t,completionTokens:e}){return{promptTokens:t,completionTokens:e,totalTokens:t+e}}async function VUe({stream:t,update:e,onToolCall:r,onFinish:n,generateId:s=KW,getCurrentDate:i=()=>new Date}){const o=i();let a,l=!0;const c=[],u=[];let h;const d={};let f={completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},g="unknown";function _(){const p=[...u];if(a==null){e(c,p);return}h?.length&&(a.annotations=h);const y={...JSON.parse(JSON.stringify(a)),revisionId:s(),createdAt:a.createdAt};e([...c,y],p)}function m(){return(l||a==null)&&(a!=null&&c.push(a),l=!1,a={id:s(),role:"assistant",content:"",createdAt:o}),a}await HUe({stream:t,onTextPart(p){const y=m();a={...y,content:y.content+p},_()},onToolCallStreamingStartPart(p){const y=m();y.toolInvocations==null&&(y.toolInvocations=[]),d[p.toolCallId]={text:"",toolName:p.toolName,index:y.toolInvocations.length},y.toolInvocations.push({state:"partial-call",toolCallId:p.toolCallId,toolName:p.toolName,args:void 0}),_()},onToolCallDeltaPart(p){const y=m(),b=d[p.toolCallId];b.text+=p.argsTextDelta;const{value:v}=MUe(b.text);y.toolInvocations[b.index]={state:"partial-call",toolCallId:p.toolCallId,toolName:b.toolName,args:v},_()},async onToolCallPart(p){const y=m();if(d[p.toolCallId]!=null?y.toolInvocations[d[p.toolCallId].index]={state:"call",...p}:(y.toolInvocations==null&&(y.toolInvocations=[]),y.toolInvocations.push({state:"call",...p})),r){const b=await r({toolCall:p});b!=null&&(y.toolInvocations[y.toolInvocations.length-1]={state:"result",...p,result:b})}_()},onToolResultPart(p){const b=m().toolInvocations;if(b==null)throw new Error("tool_result must be preceded by a tool_call");const v=b.findIndex(w=>w.toolCallId===p.toolCallId);if(v===-1)throw new Error("tool_result must be preceded by a tool_call with the same toolCallId");b[v]={...b[v],state:"result",...p},_()},onDataPart(p){u.push(...p),_()},onMessageAnnotationsPart(p){h==null?h=[...p]:h.push(...p),_()},onFinishStepPart(p){l=!p.isContinued},onFinishMessagePart(p){g=p.finishReason,p.usage!=null&&(f=zUe(p.usage))},onErrorPart(p){throw new Error(p)}}),n?.({message:a,finishReason:g,usage:f})}async function GUe({stream:t,onTextPart:e}){const r=t.pipeThrough(new TextDecoderStream).getReader();for(;;){const{done:n,value:s}=await r.read();if(n)break;await e(s)}}var WUe=()=>fetch;async function qUe({api:t,body:e,streamProtocol:r="data",credentials:n,headers:s,abortController:i,restoreMessagesOnFailure:o,onResponse:a,onUpdate:l,onFinish:c,onToolCall:u,generateId:h,fetch:d=WUe()}){var f,g;const _=await d(t,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json",...s},signal:(f=i?.())==null?void 0:f.signal,credentials:n}).catch(m=>{throw o(),m});if(a)try{await a(_)}catch(m){throw m}if(!_.ok)throw o(),new Error((g=await _.text())!=null?g:"Failed to fetch the chat response.");if(!_.body)throw new Error("The response body is empty.");switch(r){case"text":{const m={id:h(),createdAt:new Date,role:"assistant",content:""};await GUe({stream:_.body,onTextPart:p=>{m.content+=p,l([{...m}],[])}}),c?.(m,{usage:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},finishReason:"unknown"});return}case"data":{await VUe({stream:_.body,update:l,onToolCall:u,onFinish({message:m,finishReason:p,usage:y}){c&&m!=null&&c(m,{usage:y,finishReason:p})},generateId:h});return}default:{const m=r;throw new Error(`Unknown stream protocol: ${m}`)}}}async function f3(t){if(!t)return[];if(t instanceof FileList)return Promise.all(Array.from(t).map(async e=>{const{name:r,type:n}=e,s=await new Promise((i,o)=>{const a=new FileReader;a.onload=l=>{var c;i((c=l.target)==null?void 0:c.result)},a.onerror=l=>o(l),a.readAsDataURL(e)});return{name:r,contentType:n,url:s}}));if(Array.isArray(t))return t;throw new Error("Invalid attachments type")}var mT=Symbol.for("vercel.ai.schema");function KUe(t,{validate:e}={}){return{[mT]:!0,_type:void 0,[Cy]:!0,jsonSchema:t,validate:e}}function YUe(t){return typeof t=="object"&&t!==null&&mT in t&&t[mT]===!0&&"jsonSchema"in t&&"validate"in t}function B9e(t){return YUe(t)?t:XUe(t)}function XUe(t){return KUe(DUe(t),{validate:e=>{const r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}})}var tq={exports:{}},rq={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yu=I;function ZUe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var JUe=typeof Object.is=="function"?Object.is:ZUe,QUe=Yu.useState,e$e=Yu.useEffect,t$e=Yu.useLayoutEffect,r$e=Yu.useDebugValue;function n$e(t,e){var r=e(),n=QUe({inst:{value:r,getSnapshot:e}}),s=n[0].inst,i=n[1];return t$e(function(){s.value=r,s.getSnapshot=e,U1(s)&&i({inst:s})},[t,r,e]),e$e(function(){return U1(s)&&i({inst:s}),t(function(){U1(s)&&i({inst:s})})},[t]),r$e(r),r}function U1(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!JUe(t,r)}catch{return!0}}function s$e(t,e){return e()}var i$e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?s$e:n$e;rq.useSyncExternalStore=Yu.useSyncExternalStore!==void 0?Yu.useSyncExternalStore:i$e;tq.exports=rq;var o$e=tq.exports;const ga=()=>{},Pn=ga(),$1=Object,kt=t=>t===Pn,Ci=t=>typeof t=="function",ja=(t,e)=>({...t,...e}),a$e=t=>Ci(t.then),Bg=new WeakMap;let l$e=0;const _p=t=>{const e=typeof t,r=t&&t.constructor,n=r==Date;let s,i;if($1(t)===t&&!n&&r!=RegExp){if(s=Bg.get(t),s)return s;if(s=++l$e+"~",Bg.set(t,s),r==Array){for(s="@",i=0;i<t.length;i++)s+=_p(t[i])+",";Bg.set(t,s)}if(r==$1){s="#";const o=$1.keys(t).sort();for(;!kt(i=o.pop());)kt(t[i])||(s+=i+":"+_p(t[i])+",");Bg.set(t,s)}}else s=n?t.toJSON():e=="symbol"?t.toString():e=="string"?JSON.stringify(t):""+t;return s},co=new WeakMap,H1={},Fg={},a2="undefined",lv=typeof window!=a2,gT=typeof document!=a2,c$e=()=>lv&&typeof window.requestAnimationFrame!=a2,nq=(t,e)=>{const r=co.get(t);return[()=>!kt(e)&&t.get(e)||H1,n=>{if(!kt(e)){const s=t.get(e);e in Fg||(Fg[e]=s),r[5](e,ja(s,n),s||H1)}},r[6],()=>!kt(e)&&e in Fg?Fg[e]:!kt(e)&&t.get(e)||H1]};let _T=!0;const u$e=()=>_T,[yT,bT]=lv&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[ga,ga],h$e=()=>{const t=gT&&document.visibilityState;return kt(t)||t!=="hidden"},d$e=t=>(gT&&document.addEventListener("visibilitychange",t),yT("focus",t),()=>{gT&&document.removeEventListener("visibilitychange",t),bT("focus",t)}),f$e=t=>{const e=()=>{_T=!0,t()},r=()=>{_T=!1};return yT("online",e),yT("offline",r),()=>{bT("online",e),bT("offline",r)}},p$e={isOnline:u$e,isVisible:h$e},m$e={initFocus:d$e,initReconnect:f$e},p3=!at.useId,yp=!lv||"Deno"in window,g$e=t=>c$e()?window.requestAnimationFrame(t):setTimeout(t,1),z1=yp?I.useEffect:I.useLayoutEffect,V1=typeof navigator<"u"&&navigator.connection,m3=!yp&&V1&&(["slow-2g","2g"].includes(V1.effectiveType)||V1.saveData),l2=t=>{if(Ci(t))try{t=t()}catch{t=""}const e=t;return t=typeof t=="string"?t:(Array.isArray(t)?t.length:t)?_p(t):"",[t,e]};let _$e=0;const vT=()=>++_$e,sq=0,iq=1,oq=2,y$e=3;var Zh={__proto__:null,ERROR_REVALIDATE_EVENT:y$e,FOCUS_EVENT:sq,MUTATE_EVENT:oq,RECONNECT_EVENT:iq};async function aq(...t){const[e,r,n,s]=t,i=ja({populateCache:!0,throwOnError:!0},typeof s=="boolean"?{revalidate:s}:s||{});let o=i.populateCache;const a=i.rollbackOnError;let l=i.optimisticData;const c=d=>typeof a=="function"?a(d):a!==!1,u=i.throwOnError;if(Ci(r)){const d=r,f=[],g=e.keys();for(const _ of g)!/^\$(inf|sub)\$/.test(_)&&d(e.get(_)._k)&&f.push(_);return Promise.all(f.map(h))}return h(r);async function h(d){const[f]=l2(d);if(!f)return;const[g,_]=nq(e,f),[m,p,y,b]=co.get(e),v=()=>{const D=m[f];return(Ci(i.revalidate)?i.revalidate(g().data,d):i.revalidate!==!1)&&(delete y[f],delete b[f],D&&D[0])?D[0](oq).then(()=>g().data):g().data};if(t.length<3)return v();let w=n,E;const S=vT();p[f]=[S,0];const x=!kt(l),C=g(),A=C.data,M=C._c,P=kt(M)?A:M;if(x&&(l=Ci(l)?l(P,A):l,_({data:l,_c:P})),Ci(w))try{w=w(P)}catch(D){E=D}if(w&&a$e(w))if(w=await w.catch(D=>{E=D}),S!==p[f][0]){if(E)throw E;return w}else E&&x&&c(E)&&(o=!0,_({data:P,_c:Pn}));if(o&&!E)if(Ci(o)){const D=o(w,P);_({data:D,error:Pn,_c:Pn})}else _({data:w,error:Pn,_c:Pn});if(p[f][1]=vT(),Promise.resolve(v()).then(()=>{_({_c:Pn})}),E){if(u)throw E;return}return w}}const g3=(t,e)=>{for(const r in t)t[r][0]&&t[r][0](e)},b$e=(t,e)=>{if(!co.has(t)){const r=ja(m$e,e),n={},s=aq.bind(Pn,t);let i=ga;const o={},a=(u,h)=>{const d=o[u]||[];return o[u]=d,d.push(h),()=>d.splice(d.indexOf(h),1)},l=(u,h,d)=>{t.set(u,h);const f=o[u];if(f)for(const g of f)g(h,d)},c=()=>{if(!co.has(t)&&(co.set(t,[n,{},{},{},s,l,a]),!yp)){const u=r.initFocus(setTimeout.bind(Pn,g3.bind(Pn,n,sq))),h=r.initReconnect(setTimeout.bind(Pn,g3.bind(Pn,n,iq)));i=()=>{u&&u(),h&&h(),co.delete(t)}}};return c(),[t,s,c,i]}return[t,co.get(t)[4]]},v$e=(t,e,r,n,s)=>{const i=r.errorRetryCount,o=s.retryCount,a=~~((Math.random()+.5)*(1<<(o<8?o:8)))*r.errorRetryInterval;!kt(i)&&o>i||setTimeout(n,a,s)},w$e=(t,e)=>_p(t)==_p(e),[lq,E$e]=b$e(new Map),x$e=ja({onLoadingSlow:ga,onSuccess:ga,onError:ga,onErrorRetry:v$e,onDiscarded:ga,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:m3?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:m3?5e3:3e3,compare:w$e,isPaused:()=>!1,cache:lq,mutate:E$e,fallback:{}},p$e),S$e=(t,e)=>{const r=ja(t,e);if(e){const{use:n,fallback:s}=t,{use:i,fallback:o}=e;n&&i&&(r.use=n.concat(i)),s&&o&&(r.fallback=ja(s,o))}return r},T$e=I.createContext({}),C$e="$inf$",cq=lv&&window.__SWR_DEVTOOLS_USE__,k$e=cq?window.__SWR_DEVTOOLS_USE__:[],A$e=()=>{cq&&(window.__SWR_DEVTOOLS_REACT__=at)},R$e=t=>Ci(t[1])?[t[0],t[1],t[2]||{}]:[t[0],null,(t[1]===null?t[2]:t[1])||{}],I$e=()=>ja(x$e,I.useContext(T$e)),P$e=t=>(e,r,n)=>t(e,r&&((...i)=>{const[o]=l2(e),[,,,a]=co.get(lq);if(o.startsWith(C$e))return r(...i);const l=a[o];return kt(l)?r(...i):(delete a[o],l)}),n),O$e=k$e.concat(P$e),D$e=t=>function(...r){const n=I$e(),[s,i,o]=R$e(r),a=S$e(n,o);let l=t;const{use:c}=a,u=(c||[]).concat(O$e);for(let h=u.length;h--;)l=u[h](l);return l(s,i||a.fetcher||null,a)},L$e=(t,e,r)=>{const n=e[t]||(e[t]=[]);return n.push(r),()=>{const s=n.indexOf(r);s>=0&&(n[s]=n[n.length-1],n.pop())}};A$e();const _3=at.use||(t=>{if(t.status==="pending")throw t;if(t.status==="fulfilled")return t.value;throw t.status==="rejected"?t.reason:(t.status="pending",t.then(e=>{t.status="fulfilled",t.value=e},e=>{t.status="rejected",t.reason=e}),t)}),G1={dedupe:!0},N$e=(t,e,r)=>{const{cache:n,compare:s,suspense:i,fallbackData:o,revalidateOnMount:a,revalidateIfStale:l,refreshInterval:c,refreshWhenHidden:u,refreshWhenOffline:h,keepPreviousData:d}=r,[f,g,_,m]=co.get(n),[p,y]=l2(t),b=I.useRef(!1),v=I.useRef(!1),w=I.useRef(p),E=I.useRef(e),S=I.useRef(r),x=()=>S.current,C=()=>x().isVisible()&&x().isOnline(),[A,M,P,D]=nq(n,p),R=I.useRef({}).current,G=kt(o)?r.fallback[p]:o,ee=(me,ve)=>{for(const L in R){const oe=L;if(oe==="data"){if(!s(me[oe],ve[oe])&&(!kt(me[oe])||!s(ne,ve[oe])))return!1}else if(ve[oe]!==me[oe])return!1}return!0},q=I.useMemo(()=>{const me=!p||!e?!1:kt(a)?x().isPaused()||i?!1:kt(l)?!0:l:a,ve=ae=>{const xe=ja(ae);return delete xe._k,me?{isValidating:!0,isLoading:!0,...xe}:xe},L=A(),oe=D(),ie=ve(L),W=L===oe?ie:ve(oe);let K=ie;return[()=>{const ae=ve(A());return ee(ae,K)?(K.data=ae.data,K.isLoading=ae.isLoading,K.isValidating=ae.isValidating,K.error=ae.error,K):(K=ae,ae)},()=>W]},[n,p]),re=o$e.useSyncExternalStore(I.useCallback(me=>P(p,(ve,L)=>{ee(L,ve)||me()}),[n,p]),q[0],q[1]),N=!b.current,B=f[p]&&f[p].length>0,$=re.data,H=kt($)?G:$,U=re.error,Q=I.useRef(H),ne=d?kt($)?Q.current:$:H,ge=B&&!kt(U)?!1:N&&!kt(a)?a:x().isPaused()?!1:i?kt(H)?!1:l:kt(H)||l,J=!!(p&&e&&N&&ge),V=kt(re.isValidating)?J:re.isValidating,fe=kt(re.isLoading)?J:re.isLoading,de=I.useCallback(async me=>{const ve=E.current;if(!p||!ve||v.current||x().isPaused())return!1;let L,oe,ie=!0;const W=me||{},K=!_[p]||!W.dedupe,ae=()=>p3?!v.current&&p===w.current&&b.current:p===w.current,xe={isValidating:!1,isLoading:!1},Te=()=>{M(xe)},le=()=>{const Oe=_[p];Oe&&Oe[1]===oe&&delete _[p]},Se={isValidating:!0};kt(A().data)&&(Se.isLoading=!0);try{if(K&&(M(Se),r.loadingTimeout&&kt(A().data)&&setTimeout(()=>{ie&&ae()&&x().onLoadingSlow(p,r)},r.loadingTimeout),_[p]=[ve(y),vT()]),[L,oe]=_[p],L=await L,K&&setTimeout(le,r.dedupingInterval),!_[p]||_[p][1]!==oe)return K&&ae()&&x().onDiscarded(p),!1;xe.error=Pn;const Oe=g[p];if(!kt(Oe)&&(oe<=Oe[0]||oe<=Oe[1]||Oe[1]===0))return Te(),K&&ae()&&x().onDiscarded(p),!1;const Ce=A().data;xe.data=s(Ce,L)?Ce:L,K&&ae()&&x().onSuccess(L,p,r)}catch(Oe){le();const Ce=x(),{shouldRetryOnError:he}=Ce;Ce.isPaused()||(xe.error=Oe,K&&ae()&&(Ce.onError(Oe,p,Ce),(he===!0||Ci(he)&&he(Oe))&&(!x().revalidateOnFocus||!x().revalidateOnReconnect||C())&&Ce.onErrorRetry(Oe,p,Ce,ke=>{const Ie=f[p];Ie&&Ie[0]&&Ie[0](Zh.ERROR_REVALIDATE_EVENT,ke)},{retryCount:(W.retryCount||0)+1,dedupe:!0})))}return ie=!1,Te(),!0},[p,n]),be=I.useCallback((...me)=>aq(n,w.current,...me),[]);if(z1(()=>{E.current=e,S.current=r,kt($)||(Q.current=$)}),z1(()=>{if(!p)return;const me=de.bind(Pn,G1);let ve=0;const oe=L$e(p,f,(ie,W={})=>{if(ie==Zh.FOCUS_EVENT){const K=Date.now();x().revalidateOnFocus&&K>ve&&C()&&(ve=K+x().focusThrottleInterval,me())}else if(ie==Zh.RECONNECT_EVENT)x().revalidateOnReconnect&&C()&&me();else{if(ie==Zh.MUTATE_EVENT)return de();if(ie==Zh.ERROR_REVALIDATE_EVENT)return de(W)}});return v.current=!1,w.current=p,b.current=!0,M({_k:y}),ge&&(kt(H)||yp?me():g$e(me)),()=>{v.current=!0,oe()}},[p]),z1(()=>{let me;function ve(){const oe=Ci(c)?c(A().data):c;oe&&me!==-1&&(me=setTimeout(L,oe))}function L(){!A().error&&(u||x().isVisible())&&(h||x().isOnline())?de(G1).then(ve):ve()}return ve(),()=>{me&&(clearTimeout(me),me=-1)}},[c,u,h,p]),I.useDebugValue(ne),i&&kt(H)&&p){if(!p3&&yp)throw new Error("Fallback data is required when using suspense in SSR.");E.current=e,S.current=r,v.current=!1;const me=m[p];if(!kt(me)){const ve=be(me);_3(ve)}if(kt(U)){const ve=de(G1);kt(ne)||(ve.status="fulfilled",ve.value=!0),_3(ve)}else throw U}return{mutate:be,get data(){return R.data=!0,ne},get error(){return R.error=!0,U},get isValidating(){return R.isValidating=!0,V},get isLoading(){return R.isLoading=!0,fe}}},jg=D$e(N$e);function M$e(t,e){if(typeof t!="function")throw new TypeError(`Expected the first argument to be a \`function\`, got \`${typeof t}\`.`);let r,n=0;return function(...i){clearTimeout(r);const o=Date.now(),a=o-n,l=e-a;l<=0?(n=o,t.apply(this,i)):r=setTimeout(()=>{n=Date.now(),t.apply(this,i)},l)}}var B$e=M$e;const F$e=rs(B$e);function y3(t,e){return e!=null?F$e(t,e):t}var j$e=async(t,e,r,n,s,i,o,a,l,c,u,h,d,f,g,_,m)=>{var p;const y=o.current;r(e.messages,!1);const b=f?e.messages:e.messages.map(({role:w,content:E,experimental_attachments:S,data:x,annotations:C,toolInvocations:A})=>({role:w,content:E,...S!==void 0&&{experimental_attachments:S},...x!==void 0&&{data:x},...C!==void 0&&{annotations:C},...A!==void 0&&{toolInvocations:A}})),v=s.current;return await qUe({api:t,body:(p=g?.({messages:e.messages,requestData:e.data,requestBody:e.body}))!=null?p:{messages:b,data:e.data,...i.current.body,...e.body},streamProtocol:c,credentials:i.current.credentials,headers:{...i.current.headers,...e.headers},abortController:()=>a.current,restoreMessagesOnFailure(){m||r(y,!1)},onResponse:h,onUpdate(w,E){r([...e.messages,...w],!1),E?.length&&n([...v??[],...E],!1)},onToolCall:d,onFinish:u,generateId:l,fetch:_})};function U$e({api:t="/api/chat",id:e,initialMessages:r,initialInput:n="",sendExtraMessageFields:s,onToolCall:i,experimental_prepareRequestBody:o,maxSteps:a=1,streamProtocol:l="data",onResponse:c,onFinish:u,onError:h,credentials:d,headers:f,body:g,generateId:_=KW,fetch:m,keepLastMessageOnError:p=!0,experimental_throttle:y}={}){const b=I.useId(),v=e??b,w=typeof t=="string"?[t,v]:v,[E]=I.useState([]),{data:S,mutate:x}=jg([w,"messages"],null,{fallbackData:r??E}),C=I.useRef(S||[]);I.useEffect(()=>{C.current=S||[]},[S]);const{data:A,mutate:M}=jg([w,"streamData"],null),P=I.useRef(A);I.useEffect(()=>{P.current=A},[A]);const{data:D=!1,mutate:R}=jg([w,"loading"],null),{data:G=void 0,mutate:ee}=jg([w,"error"],null),q=I.useRef(null),re=I.useRef({credentials:d,headers:f,body:g});I.useEffect(()=>{re.current={credentials:d,headers:f,body:g}},[d,f,g]);const N=I.useCallback(async de=>{const be=C.current.length;try{R(!0),ee(void 0);const L=new AbortController;q.current=L,await j$e(t,de,y3(x,y),y3(M,y),P,re,C,q,_,l,u,c,i,s,o,m,p),q.current=null}catch(L){if(L.name==="AbortError")return q.current=null,null;h&&L instanceof Error&&h(L),ee(L)}finally{R(!1)}const me=C.current,ve=me[me.length-1];me.length>be&&ve!=null&&a>1&&b3(ve)&&$$e(me)<a&&await N({messages:me})},[x,R,t,re,c,u,h,ee,M,P,l,s,o,i,a,C,q,_,m,p,y]),B=I.useCallback(async(de,{data:be,headers:me,body:ve,experimental_attachments:L}={})=>{var oe,ie;const W=await f3(L),K=C.current.concat({...de,id:(oe=de.id)!=null?oe:_(),createdAt:(ie=de.createdAt)!=null?ie:new Date,experimental_attachments:W.length>0?W:void 0});return N({messages:K,headers:me,body:ve,data:be})},[N,_]),$=I.useCallback(async({data:de,headers:be,body:me}={})=>{const ve=C.current;if(ve.length===0)return null;const L=ve[ve.length-1];return N({messages:L.role==="assistant"?ve.slice(0,-1):ve,headers:be,body:me,data:de})},[N]),H=I.useCallback(()=>{q.current&&(q.current.abort(),q.current=null)},[]),U=I.useCallback(de=>{typeof de=="function"&&(de=de(C.current)),x(de,!1),C.current=de},[x]),Q=I.useCallback(de=>{typeof de=="function"&&(de=de(P.current)),M(de,!1),P.current=de},[M]),[ne,ge]=I.useState(n),J=I.useCallback(async(de,be={},me)=>{var ve;if((ve=de?.preventDefault)==null||ve.call(de),!ne&&!be.allowEmptySubmit)return;me&&(re.current={...re.current,...me});const L=await f3(be.experimental_attachments),ie={messages:!ne&&!L.length&&be.allowEmptySubmit?C.current:C.current.concat({id:_(),createdAt:new Date,role:"user",content:ne,experimental_attachments:L.length>0?L:void 0}),headers:be.headers,body:be.body,data:be.data};N(ie),ge("")},[ne,_,N]);return{messages:S||[],setMessages:U,data:A,setData:Q,error:G,append:B,reload:$,stop:H,input:ne,setInput:ge,handleInputChange:de=>{ge(de.target.value)},handleSubmit:J,isLoading:D,addToolResult:({toolCallId:de,result:be})=>{const me=C.current.map((L,oe,ie)=>oe===ie.length-1&&L.role==="assistant"&&L.toolInvocations?{...L,toolInvocations:L.toolInvocations.map(W=>W.toolCallId===de?{...W,result:be,state:"result"}:W)}:L);x(me,!1);const ve=me[me.length-1];b3(ve)&&N({messages:me})}}}function b3(t){return t.role==="assistant"&&t.toolInvocations&&t.toolInvocations.length>0&&t.toolInvocations.every(e=>"result"in e)}function $$e(t){let e=0;for(let r=t.length-1;r>=0&&t[r].role==="assistant";r--)e++;return e}var H$e=U$e;const uo=rc({started:!1,aborted:!1,showChat:!0}),z$e=t=>`
You are an experienced developer who helps people choose the best starter template for their projects.

Available templates:
<template>
  <name>blank</name>
  <description>Empty starter for simple scripts and trivial tasks that don't require a full template setup</description>
  <tags>basic, script</tags>
</template>
${t.map(e=>`
<template>
  <name>${e.name}</name>
  <description>${e.description}</description>
  ${e.tags?`<tags>${e.tags.join(", ")}</tags>`:""}
</template>
`).join(`
`)}

Response Format:
<selection>
  <templateName>{selected template name}</templateName>
  <title>{a proper title for the project}</title>
</selection>

Examples:

<example>
User: I need to build a todo app
Response:
<selection>
  <templateName>react-basic-starter</templateName>
  <title>Simple React todo application</title>
</selection>
</example>

<example>
User: Write a script to generate numbers from 1 to 100
Response:
<selection>
  <templateName>blank</templateName>
  <title>script to generate numbers from 1 to 100</title>
</selection>
</example>

Instructions:
1. For trivial tasks and simple scripts, always recommend the blank template
2. For more complex projects, recommend templates from the provided list
3. Follow the exact XML format
4. Consider both technical requirements and tags
5. If no perfect match exists, recommend the closest option

Important: Provide only the selection tags in your response, no additional text.
`,V$e=XC.filter(t=>!t.name.includes("shadcn")),G$e=t=>{try{const e=t.match(/<templateName>(.*?)<\/templateName>/),r=t.match(/<title>(.*?)<\/title>/);return e?{template:e[1].trim(),title:r?.[1].trim()||"Untitled Project"}:null}catch(e){return console.error("Error parsing template selection:",e),null}},W$e=async t=>{const{message:e,model:r,provider:n}=t,s={message:e,model:r,provider:n,system:z$e(V$e)},o=await(await fetch("/api/llmcall",{method:"POST",body:JSON.stringify(s)})).json();console.log(o);const{text:a}=o,l=G$e(a);return l||(console.log("No template selected, using blank template"),{template:"blank",title:""})},uq=async(t,e="")=>{const r="https://api.github.com";try{const n=Ke.get("githubToken")||void 0,s={Accept:"application/vnd.github.v3+json"};n&&(s.Authorization="token "+n);const i=await fetch(`${r}/repos/${t}/contents/${e}`,{headers:s});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.json();if(!Array.isArray(o)&&o.type==="file"){const l=atob(o.content);return[{name:o.name,path:o.path,content:l}]}return(await Promise.all(o.map(async l=>{if(l.type==="dir")return await uq(t,l.path);if(l.type==="file"){const u=await(await fetch(l.url,{headers:s})).json(),h=atob(u.content);return[{name:l.name,path:l.path,content:h}]}return[]}))).flat()}catch(n){throw console.error("Error fetching repo contents:",n),n}};async function q$e(t,e){const r=XC.find(d=>d.name==t);if(!r)return null;const n=r.githubRepo,s=await uq(n);let i=s;i=i.filter(d=>d.path.startsWith(".git")==!1);const o=["package-lock.json","yarn.lock","pnpm-lock.yaml"];i=i.filter(d=>o.includes(d.name)==!1),i=i.filter(d=>d.path.startsWith(".Terretacode")==!1);const a=s.find(d=>d.path.startsWith(".Terretacode")&&d.name=="ignore"),l={files:i,ignoreFile:[]};if(a){const d=a.content.split(`
`).map(_=>_.trim()),f=VA().add(d),g=i.filter(_=>f.ignores(_.path));l.files=i,l.ignoreFile=g}const c=`
<TerretacodeArtifact id="imported-files" title="${e||"Importing Starter Files"}" type="bundled">
${l.files.map(d=>`<TerretacodeAction type="file" filePath="${d.path}">
${d.content}
</TerretacodeAction>`).join(`
`)}
</TerretacodeArtifact>
`;let u="";const h=s.filter(d=>d.path.startsWith(".Terretacode")).find(d=>d.name=="prompt");return h&&(u=`
TEMPLATE INSTRUCTIONS:
${h.content}

IMPORTANT: Dont Forget to install the dependencies before running the app
---
`),l.ignoreFile.length>0&&(u=u+`
STRICT FILE ACCESS RULES - READ CAREFULLY:

The following files are READ-ONLY and must never be modified:
${l.ignoreFile.map(d=>`- ${d.path}`).join(`
`)}

Permitted actions:
✓ Import these files as dependencies
✓ Read from these files
✓ Reference these files

Strictly forbidden actions:
❌ Modify any content within these files
❌ Delete these files
❌ Rename these files
❌ Move these files
❌ Create new versions of these files
❌ Suggest changes to these files

Any attempt to modify these protected files will result in immediate termination of the operation.

If you need to make changes to functionality, create new files instead of modifying the protected ones listed above.
---
`),u+=`
---
template import is done, and you can now use the imported files,
edit only the files that need to be changed, and you can create new files as needed.
NO NOT EDIT/WRITE ANY FILES THAT ALREADY EXIST IN THE PROJECT AND DOES NOT NEED TO BE MODIFIED
---
Now that the Template is imported please continue with my original request
`,{assistantMessage:c,userMessage:u}}const K$e=wp({enter:"animated fadeInRight",exit:"animated fadeOutRight"}),v3=Fn("Chat");function F9e(){Xu.trace("Chat");const{ready:t,initialMessages:e,storeMessageHistory:r,importChat:n,exportChat:s}=cj(),i=wt(po);return I.useEffect(()=>{Ze.setReloadedMessages(e.map(o=>o.id))},[e]),T.jsxs(T.Fragment,{children:[t&&T.jsx(X$e,{description:i,initialMessages:e,exportChat:s,storeMessageHistory:r,importChat:n}),T.jsx(pJ,{closeButton:({closeToast:o})=>T.jsx("button",{className:"Toastify__close-button",onClick:o,children:T.jsx("div",{className:"i-ph:x text-lg"})}),icon:({type:o})=>{switch(o){case"success":return T.jsx("div",{className:"i-ph:check-bold text-Terretacode-elements-icon-success text-2xl"});case"error":return T.jsx("div",{className:"i-ph:warning-circle-bold text-Terretacode-elements-icon-error text-2xl"})}},position:"bottom-right",pauseOnFocusLoss:!0,transition:K$e})]})}const Y$e=uj(t=>{const{messages:e,initialMessages:r,isLoading:n,parseMessages:s,storeMessageHistory:i}=t;s(e,n),e.length>r.length&&i(e).catch(o=>Ne.error(o.message))},50),X$e=I.memo(({description:t,initialMessages:e,storeMessageHistory:r,importChat:n,exportChat:s})=>{sEe();const i=I.useRef(null),[o,a]=I.useState(e.length>0),[l,c]=I.useState([]),[u,h]=I.useState([]),[d,f]=S3(),[g,_]=I.useState(!1),m=wt(Ze.files),p=wt(Ze.alert),{activeProviders:y,promptId:b,autoSelectTemplate:v,contextOptimizationEnabled:w}=rh(),[E,S]=I.useState(()=>Ke.get("selectedModel")||jde),[x,C]=I.useState(()=>{const le=Ke.get("selectedProvider");return sb.find(Se=>Se.name===le)||Ude}),{showChat:A}=wt(uo),[M,P]=rJ(),[D,R]=I.useState({}),{messages:G,isLoading:ee,input:q,handleInputChange:re,setInput:N,stop:B,append:$,setMessages:H,reload:U,error:Q}=H$e({api:"/api/chat",body:{apiKeys:D,files:m,promptId:b,contextOptimization:w},sendExtraMessageFields:!0,onError:le=>{v3.error(`Request failed

`,le,Q),Ne.error("There was an error processing your request: "+(le.message?le.message:"No details were returned"))},onFinish:(le,Se)=>{const Oe=Se.usage;Oe&&console.log("Token usage:",Oe),v3.debug("Finished streaming")},initialMessages:e,initialInput:Ke.get(ew)||""});I.useEffect(()=>{const le=d.get("prompt");le&&(f({}),L(),$({role:"user",content:[{type:"text",text:`[Model: ${E}]

[Provider: ${x.name}]

${le}`}]}))},[E,x,d]);const{enhancingPrompt:ne,promptEnhanced:ge,enhancePrompt:J,resetEnhancer:V}=rEe(),{parsedMessages:fe,parseMessages:de}=tEe(),be=o?400:200;I.useEffect(()=>{uo.setKey("started",e.length>0)},[]),I.useEffect(()=>{Y$e({messages:G,initialMessages:e,isLoading:ee,parseMessages:de,storeMessageHistory:r})},[G,ee,de]);const me=()=>{const le=i.current;le&&(le.scrollTop=le.scrollHeight)},ve=()=>{B(),uo.setKey("aborted",!0),Ze.abortAllActions()};I.useEffect(()=>{const le=i.current;if(le){le.style.height="auto";const Se=le.scrollHeight;le.style.height=`${Math.min(Se,be)}px`,le.style.overflowY=Se>be?"auto":"hidden"}},[q,i]);const L=async()=>{o||(await Promise.all([P("#examples",{opacity:0,display:"none"},{duration:.1}),P("#intro",{opacity:0,flex:1},{duration:.2,ease:Ss})]),uo.setKey("started",!0),a(!0))},oe=async(le,Se)=>{const Oe=Se||q;if(Oe.length===0||ee)return;await Ze.saveAllFiles(),Q!=null&&H(G.slice(0,-1));const Ce=Ze.getFileModifcations();if(uo.setKey("aborted",!1),L(),!o&&Se&&v){_(!0),H([{id:`${new Date().getTime()}`,role:"user",content:[{type:"text",text:`[Model: ${E}]

[Provider: ${x.name}]

${Oe}`},...u.map(Ie=>({type:"image",image:Ie}))]}]);const{template:he,title:ke}=await W$e({message:Se,model:E,provider:x});if(he!=="blank"){const Ie=await q$e(he,ke).catch(Ye=>(Ye.message.includes("rate limit")?Ne.warning(`Rate limit exceeded. Skipping starter template
 Continuing with blank template`):Ne.warning(`Failed to import starter template
 Continuing with blank template`),null));if(Ie){const{assistantMessage:Ye,userMessage:z}=Ie;H([{id:`${new Date().getTime()}`,role:"user",content:Se},{id:`${new Date().getTime()}`,role:"assistant",content:Ye},{id:`${new Date().getTime()}`,role:"user",content:`[Model: ${E}]

[Provider: ${x.name}]

${z}`,annotations:["hidden"]}]),U(),_(!1);return}else{H([{id:`${new Date().getTime()}`,role:"user",content:[{type:"text",text:`[Model: ${E}]

[Provider: ${x.name}]

${Oe}`},...u.map(Ye=>({type:"image",image:Ye}))]}]),U(),_(!1);return}}else{H([{id:`${new Date().getTime()}`,role:"user",content:[{type:"text",text:`[Model: ${E}]

[Provider: ${x.name}]

${Oe}`},...u.map(Ie=>({type:"image",image:Ie}))]}]),U(),_(!1);return}}Ce!==void 0?($({role:"user",content:[{type:"text",text:`[Model: ${E}]

[Provider: ${x.name}]

${Oe}`},...u.map(he=>({type:"image",image:he}))]}),Ze.resetAllFileModifications()):$({role:"user",content:[{type:"text",text:`[Model: ${E}]

[Provider: ${x.name}]

${Oe}`},...u.map(he=>({type:"image",image:he}))]}),N(""),Ke.remove(ew),c([]),h([]),V(),i.current?.blur()},ie=le=>{re(le)},W=I.useCallback(Cb(le=>{const Se=le.target.value.trim();Ke.set(ew,Se,{expires:30})},1e3),[]),[K,ae]=iEe();I.useEffect(()=>{const le=Ke.get("apiKeys");le&&R(JSON.parse(le))},[]);const xe=le=>{S(le),Ke.set("selectedModel",le,{expires:30})},Te=le=>{C(le),Ke.set("selectedProvider",le.name,{expires:30})};return T.jsx(Nje,{ref:M,textareaRef:i,input:q,showChat:A,chatStarted:o,isStreaming:ee||g,enhancingPrompt:ne,promptEnhanced:ge,sendMessage:oe,model:E,setModel:xe,provider:x,setProvider:Te,providerList:y,messageRef:K,scrollRef:ae,handleInputChange:le=>{ie(le),W(le)},handleStop:ve,description:t,importChat:n,exportChat:s,messages:G.map((le,Se)=>le.role==="user"?le:{...le,content:fe[Se]||""}),enhancePrompt:()=>{J(q,le=>{N(le),me()},E,x,D)},uploadedFiles:l,setUploadedFiles:c,imageDataList:u,setImageDataList:h,actionAlert:p,clearAlert:()=>Ze.clearAlert()})});function Z$e({}){const t=wt(Ze.showWorkbench),{showChat:e}=wt(uo),r=I$(1024),n=t||!e;return T.jsx("div",{className:"flex",children:T.jsxs("div",{className:"flex border border-Terretacode-elements-borderColor rounded-md overflow-hidden",children:[T.jsx(w3,{active:e,disabled:!n||r,onClick:()=>{n&&uo.setKey("showChat",!e)},children:T.jsx("div",{className:"i-Terretacode:chat text-sm"})}),T.jsx("div",{className:"w-[1px] bg-Terretacode-elements-borderColor"}),T.jsx(w3,{active:t,onClick:()=>{t&&!e&&uo.setKey("showChat",!0),Ze.showWorkbench.set(!t)},children:T.jsx("div",{className:"i-ph:code-bold"})})]})})}function w3({active:t=!1,disabled:e=!1,children:r,onClick:n}){return T.jsx("button",{className:qe("flex items-center p-1.5",{"bg-Terretacode-elements-item-backgroundDefault hover:bg-Terretacode-elements-item-backgroundActive text-Terretacode-elements-textTertiary hover:text-Terretacode-elements-textPrimary":!t,"bg-Terretacode-elements-item-backgroundAccent text-Terretacode-elements-item-contentAccent":t&&!e,"bg-Terretacode-elements-item-backgroundDefault text-alpha-gray-20 dark:text-alpha-white-20 cursor-not-allowed":e}),onClick:n,children:r})}function J$e(){const t=wt(po),{editing:e,handleChange:r,handleBlur:n,handleSubmit:s,handleKeyDown:i,currentDescription:o,toggleEditMode:a}=R$({initialDescription:t,syncWithGlobalStore:!0});return t?T.jsx("div",{className:"flex items-center justify-center",children:e?T.jsxs("form",{onSubmit:s,className:"flex items-center justify-center",children:[T.jsx("input",{type:"text",className:"bg-Terretacode-elements-background-depth-1 text-Terretacode-elements-textPrimary rounded px-2 mr-2 w-fit",autoFocus:!0,value:o,onChange:r,onBlur:n,onKeyDown:i,style:{width:`${Math.max(o.length*8,100)}px`}}),T.jsx(w_,{children:T.jsx(Ou,{tooltip:"Save title",children:T.jsx("div",{className:"flex justify-between items-center p-2 rounded-md bg-Terretacode-elements-item-backgroundAccent",children:T.jsx("button",{type:"submit",className:"i-ph:check-bold scale-110 hover:text-Terretacode-elements-item-contentAccent",onMouseDown:s})})})})]}):T.jsxs(T.Fragment,{children:[o,T.jsx(w_,{children:T.jsx(Ou,{tooltip:"Rename chat",children:T.jsx("div",{className:"flex justify-between items-center p-2 rounded-md bg-Terretacode-elements-item-backgroundAccent ml-2",children:T.jsx("button",{type:"button",className:"i-ph:pencil-fill scale-110 hover:text-Terretacode-elements-item-contentAccent",onClick:l=>{l.preventDefault(),a()}})})})})]})}):null}function j9e(){const t=wt(uo);return T.jsxs("header",{className:qe("flex items-center p-5 border-b h-[var(--header-height)]",{"border-transparent":!t.started,"border-Terretacode-elements-borderColor":t.started}),children:[T.jsxs("div",{className:"flex items-center gap-2 z-logo text-Terretacode-elements-textPrimary cursor-pointer",children:[T.jsx("div",{className:"i-ph:sidebar-simple-duotone text-xl"}),T.jsxs("a",{href:"/",className:"text-2xl font-semibold text-accent flex items-center",children:[T.jsx("img",{src:"/logo-light-styled.png",alt:"logo",className:"w-[90px] inline-block dark:hidden"}),T.jsx("img",{src:"/logo-dark-styled.png",alt:"logo",className:"w-[90px] inline-block hidden dark:block"})]})]}),t.started&&T.jsxs(T.Fragment,{children:[T.jsx("span",{className:"flex-1 px-4 truncate text-center text-Terretacode-elements-textPrimary",children:T.jsx(Ji,{children:()=>T.jsx(J$e,{})})}),T.jsx(Ji,{children:()=>T.jsx("div",{className:"mr-1",children:T.jsx(Z$e,{})})})]})]})}const Q$e="_",eHe="a",tHe="b",rHe="c",nHe="d",sHe="e",iHe="f",oHe="g",aHe="h",lHe="i",cHe="j",uHe="k",hHe="l",dHe="m",fHe="n",pHe="o",mHe="p",gHe="q",_He="r",Or={rayContainer:Q$e,fadeIn:eHe,lightRay:tHe,ray1:rHe,float1:nHe,ray2:sHe,float2:iHe,ray3:oHe,float3:aHe,ray4:lHe,float4:cHe,ray5:uHe,float5:hHe,ray6:dHe,float6:fHe,ray7:pHe,float7:mHe,ray8:gHe,float8:_He},U9e=()=>T.jsxs("div",{className:`${Or.rayContainer} `,children:[T.jsx("div",{className:`${Or.lightRay} ${Or.ray1}`}),T.jsx("div",{className:`${Or.lightRay} ${Or.ray2}`}),T.jsx("div",{className:`${Or.lightRay} ${Or.ray3}`}),T.jsx("div",{className:`${Or.lightRay} ${Or.ray4}`}),T.jsx("div",{className:`${Or.lightRay} ${Or.ray5}`}),T.jsx("div",{className:`${Or.lightRay} ${Or.ray6}`}),T.jsx("div",{className:`${Or.lightRay} ${Or.ray7}`}),T.jsx("div",{className:`${Or.lightRay} ${Or.ray8}`})]});export{Nje as $,Ge as A,g9e as B,T9 as C,QTe as D,Re as E,d9e as F,SCe as G,m9e as H,er as I,dke as J,o9e as K,_S as L,j as M,c9 as N,zje as O,oCe as P,B9e as Q,u3 as R,Kje as S,wr as T,Ku as U,M9e as V,N9e as W,cj as X,Eje as Y,Ne as Z,Ji as _,u9e as a,F9e as a0,xje as a1,VA as a2,sG as a3,iG as a4,KW as a5,U9e as a6,j9e as a7,p9e as b,Mn as c,h9e as d,mt as e,FCe as f,Dt as g,f9e as h,ACe as i,ps as j,zr as k,kb as l,Va as m,Ob as n,vt as o,a9e as p,Ns as q,fh as r,yCe as s,ue as t,xCe as u,Gc as v,BCe as w,Lr as x,M_ as y,ike as z};
